<html>
<head>
<title>Call RESTful APIs | Web Services using Angular and RxJS.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Angular和RxJS调用RESTful APIs | Web服务。</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/call-rest-api-web-services-using-angular-and-rxjs-4f00e833a65?source=collection_archive---------0-----------------------#2020-01-24">https://javascript.plainenglish.io/call-rest-api-web-services-using-angular-and-rxjs-4f00e833a65?source=collection_archive---------0-----------------------#2020-01-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="d3ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">调用并缓存从<code class="fe ki kj kk kl b">HttpClient</code>返回的数据。缓存数据将加速你的网络/应用程序。我们来了解一下如何！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/124cb85b1beab59b11419483b5e4c803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHs_cw53sYQ2Jl6122t6CA.png"/></div></div></figure><p id="32e5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe ki kj kk kl b">HttpClient</code>返回一个可观察值。为了进行缓存，我们需要将可观察到的内容与<code class="fe ki kj kk kl b">shareReplay</code>和<code class="fe ki kj kk kl b">catchError</code>结合起来。我们使用缓存来避免对服务器的过多请求。</p><h1 id="137c" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">让我们深入了解HTTP API调用的细节:</h1><p id="587b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated"><strong class="jm io"> 1。</strong>不使用缓存。<br/> <strong class="jm io"> 2。</strong>带有缓存值。<br/> <strong class="jm io"> 3。</strong>带缓存可观察。</p><h1 id="5b43" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">调用API之前</h1><p id="36e5" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">你必须有API，按照本文创建API使用<strong class="jm io"> Node.js和Express.js </strong> : <a class="ae mb" href="https://medium.com/@AnkitMaheshwariIn/create-rest-api-web-services-using-node-js-and-express-js-with-crud-operations-ff790d6ae030" rel="noopener"> <strong class="jm io">链接创建Rest API </strong>👆</a></p><div class="mc md gp gr me mf"><a href="https://medium.com/javascript-in-plain-english/create-rest-api-web-services-using-node-js-and-express-js-with-crud-operations-ff790d6ae030" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd io gy z fp mk fr fs ml fu fw im bi translated">用Node和Express.js创建CRUD Rest API</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">为了在Node.js中构建API，我们将使用Express.js框架。也可以使用任何其他框架，但是Express.js非常…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt kw mf"/></div></div></a></div><h1 id="8de0" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">1.不使用缓存的API调用。</h1><p id="57a3" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">现在假设我们有一个API端点，它返回一个条目列表——每个条目都是一个JSON对象。</p><p id="f4f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">API端点:<a class="ae mb" href="http://localhost:3000/items" rel="noopener ugc nofollow" target="_blank"> localhost:3000/items </a>(返回对象列表，见下图👇)(创建API遵循:<a class="ae mb" href="https://medium.com/@AnkitMaheshwariIn/create-rest-api-web-services-using-node-js-and-express-js-with-crud-operations-ff790d6ae030" rel="noopener">链接创建Rest API👆</a>)</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mu"><img src="../Images/6299622eac519ec1f611126205695e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eh1sJ8-Ms8dIoouM.png"/></div></div></figure><p id="8085" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们为我们的项目创建一个服务，如下所示:</p><p id="2971" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将在这个服务文件中编写代码，返回一个项目列表。<br/>(确保在你的项目根目录下运行下面的命令👇)</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="d4c9" class="mz kz in kl b gy na nb l nc nd">ng g service service/items</span></pre><p id="9b92" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个命令将生成两个类型脚本文件——请看下面👇</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ne"><img src="../Images/48be4a5361922d91a5e6d184e12a69e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RSnU0MPQaGjHytjQ.png"/></div></div></figure><p id="16b2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，打开<code class="fe ki kj kk kl b">src/app/service/items.service.ts</code>文件并更新代码:</p><h2 id="b0b9" class="mz kz in bd la nf ng dn le nh ni dp li jv nj nk lm jz nl nm lq kd nn no lu np bi translated">使用HTTP GET方法:</h2><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="29ca" class="mz kz in kl b gy na nb l nc nd">import { Injectable } from '@angular/core';<br/>import { HttpClient } from '@angular/common/http';<br/>import { Observable } from 'rxjs';<br/><br/>@Injectable({<br/>  providedIn: 'root'<br/>})<br/>export class ItemsService {<br/><br/>  // URL which returns list of JSON items (API end-point URL)<br/>  private readonly URL = 'http://localhost:3000/items';<br/><br/>  constructor(private http: HttpClient) { }<br/><br/>  // create a method named: resolveItems()<br/>  // this method returns list-of-items in form of Observable<br/>  // every HTTTP call returns Observable object<br/>  resolveItems(): Observable&lt;any&gt; {<br/>    console.log('Request is sent!');<br/>    // this.http is a HttpClient library provide by @angular/common<br/>    // we are calling .get() method over this.http object<br/>    // this .get() method takes URL to call API<br/>    return this.http.get(this.URL);<br/>  }<br/>}</span></pre><h2 id="64e8" class="mz kz in bd la nf ng dn le nh ni dp li jv nj nk lm jz nl nm lq kd nn no lu np bi translated">使用HTTP POST方法:</h2><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="7c56" class="mz kz in kl b gy na nb l nc nd">import { Injectable } from '<a class="ae mb" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { HttpClient } from '<a class="ae mb" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>/http';<br/>import { Observable } from 'rxjs';</span><span id="4dba" class="mz kz in kl b gy nq nb l nc nd"><a class="ae mb" href="http://twitter.com/Injectable" rel="noopener ugc nofollow" target="_blank">@Injectable</a>({<br/>  providedIn: 'root'<br/>})<br/>export class ItemsService {</span><span id="23f7" class="mz kz in kl b gy nq nb l nc nd">// URL which returns list of JSON items (API end-point URL)<br/>  private readonly URL = '<a class="ae mb" href="http://localhost:3000/items'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/items'</a>;</span><span id="f6bd" class="mz kz in kl b gy nq nb l nc nd">constructor(private http: HttpClient) { }</span><span id="186f" class="mz kz in kl b gy nq nb l nc nd">// create a method named: resolveItems()<br/>  // this method returns list-of-items in form of Observable<br/>  // every HTTTP call returns Observable object<br/>  resolveItems(): Observable&lt;any&gt; {<br/>    console.log('Request is sent!');<br/>    // Using the POST method<br/>    const headers =  {<br/>      headers: new  HttpHeaders({ <br/>        'Content-Type': 'application/x-www-form-urlencoded'})<br/>    };<br/>    return this.http.post(this.URL,<br/>    {<br/>      'email' : '<a class="ae mb" href="mailto:ankit.codechintan@gmail.com" rel="noopener ugc nofollow" target="_blank">ankit.codechintan@gmail.com</a>',<br/>      'phone' : 910950xxxxx<br/>    },<br/>    headers)<br/>  }<br/>}</span></pre><p id="ceaa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，我们将在<strong class="jm io">组件中测试这个API。为此，我们将使用我们在<code class="fe ki kj kk kl b">items.service.ts</code>中创建的方法。</strong></p><p id="bedd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们为我们的项目创建一个组件如下:<br/>(确保在你的项目根目录下运行下面的命令)</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="ddbd" class="mz kz in kl b gy na nb l nc nd">ng g component items</span></pre><p id="388b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个命令将生成四个类型脚本文件——请看下面👇</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nr"><img src="../Images/1ecf95c8f4804043af9e4d7eb096896a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FBjWhKv2ai4DYZNU.png"/></div></div></figure><h1 id="5138" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">重要的</h1><p id="6393" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">不要忘记对这个新的<code class="fe ki kj kk kl b">ItemsComponent</code>进行布线。<br/> <strong class="jm io">分两步做:</strong> <br/> <strong class="jm io"> #1。</strong>在<code class="fe ki kj kk kl b">app-routing.module.ts</code>文件中定义您的<code class="fe ki kj kk kl b">component</code>路线。<br/> <strong class="jm io"> #2。在<code class="fe ki kj kk kl b">app.module.ts</code>文件中声明你的<code class="fe ki kj kk kl b">component</code>。</strong></p><h1 id="4ecb" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">让我们这样做…</h1><p id="b0fc" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated"><strong class="jm io"> #1。</strong>打开您的<code class="fe ki kj kk kl b">src/app/app-routing.module.ts</code>文件，更新如下:</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="9bce" class="mz kz in kl b gy na nb l nc nd">...<br/><br/>import { ItemsComponent } from './items/items.component';<br/><br/>const routes: Routes = [<br/>  ...<br/>  {<br/>    path: 'items',<br/>    component: ItemsComponent<br/>  }<br/>];<br/><br/>...</span></pre><p id="162b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> #2。</strong>打开您的<code class="fe ki kj kk kl b">src/app/app.module.ts</code>文件，并更新如下:</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="0653" class="mz kz in kl b gy na nb l nc nd">...<br/><br/>import { ItemsComponent } from './items/items.component';<br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent,<br/>    ItemsComponent<br/>  ],<br/>  ...<br/>})<br/><br/>...</span></pre><p id="f5df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">更深入地了解一个角形组件</strong>  <strong class="jm io"> ' </strong> <br/> ( <a class="ae mb" href="https://medium.com/@AnkitMaheshwariIn/routing-of-an-angular-component-angular-routing-2b7e53046542" rel="noopener">点击此处)👆</a>)</p><p id="78c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">最后</strong>，打开<code class="fe ki kj kk kl b">src/app/items/items.component.ts</code>文件，更新如下:</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="7e73" class="mz kz in kl b gy na nb l nc nd">import { Component, OnInit, Input } from '@angular/core';<br/>import { Observable } from 'rxjs';<br/>import { ItemsService } from '../service/items.service';<br/><br/>@Component({<br/>  selector: 'app-items',<br/>  templateUrl: './items.component.html',<br/>  styleUrls: ['./items.component.scss'],<br/>})<br/>export class ItemsComponent implements OnInit {<br/><br/>  @Input()<br/>  result$: Observable&lt;any&gt;;<br/><br/>  constructor(private itemsService: ItemsService) {<br/>    this.result$ = itemsService.resolveItems();<br/>  }<br/><br/>  ngOnInit() {}<br/><br/>}</span></pre><p id="036c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，打开<code class="fe ki kj kk kl b">src/app/items/items.component.html</code>文件，并按如下方式更新它:</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="7f81" class="mz kz in kl b gy na nb l nc nd">&lt;pre *ngIf="code"&gt; {{(result$|async)|json}} &lt;/pre&gt;</span></pre><p id="b065" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，让我们在<code class="fe ki kj kk kl b">AppComponent</code>中使用<code class="fe ki kj kk kl b">ItemsComponent</code>。打开<code class="fe ki kj kk kl b">src/app/app.component.html</code>文件并添加以下代码:</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="0260" class="mz kz in kl b gy na nb l nc nd">&lt;!-- This tag is a selector of src/app/items/items.component.ts file to be added anywhere in src/app/app.component.html file --&gt;<br/>&lt;app-items&gt;&lt;/app-items&gt;</span></pre><p id="58bd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">完成的🤩代码的输出在这里👇👇数据以JSON对象的形式加载。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ns"><img src="../Images/dcb821c8b3f4f4a0ac930f10e9412075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ygD2DIcSava03RIJ.png"/></div></div></figure></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><h1 id="d5be" class="ky kz in bd la lb oa ld le lf ob lh li lj oc ll lm ln od lp lq lr oe lt lu lv bi translated">结论</h1><p id="2dbf" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated"><strong class="jm io">我们已经看到HTTP API调用有以下几种方式:</strong> <br/> #1)不使用缓存。<br/> #2)带有缓存值。<br/> #3)带缓存可观察。</p></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><h1 id="42c3" class="ky kz in bd la lb oa ld le lf ob lh li lj oc ll lm ln od lp lq lr oe lt lu lv bi translated">搞定了。🤩使用Angular和RxJS调用Rest API/Web服务就是这么简单。</h1><p id="f1ac" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">再见👋👋</p><blockquote class="of"><p id="be4a" class="og oh in bd oi oj ok ol om on oo kh dk translated">欢迎在评论框中发表评论…如果我错过了什么，或者什么是不正确的，或者什么对你不起作用:)<br/>继续关注更多文章。</p><p id="d776" class="og oh in bd oi oj ok ol om on oo kh dk translated">更多文章敬请关注:<br/>https://medium.com/@AnkitMaheshwariIn</p></blockquote><p id="4d26" class="pw-post-body-paragraph jk jl in jm b jn op jp jq jr oq jt ju jv or jx jy jz os kb kc kd ot kf kg kh ig bi translated">如果你不介意给它一些掌声👏 👏因为它有帮助，我将非常感激它。:)帮别人找文章，这样就能帮到他们！</p><p id="67fc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">永远鼓掌…</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/2f4712882de180d90c9dcdb0cb91ae69.png" data-original-src="https://miro.medium.com/v2/resize:fit:156/1*ZyakciENSuUWo7tqu84tXQ.gif"/></div></figure></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><p id="2234" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ov">最初发表于2020年1月24日</em><a class="ae mb" href="https://www.codewithchintan.com/call-rest-api-web-services-using-angular-and-rxjs/" rel="noopener ugc nofollow" target="_blank"><em class="ov">https://www.codewithchintan.com</em></a><em class="ov">。</em></p><h1 id="17a5" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">了解更多信息</h1><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ow ox l"/></div></figure></div></div>    
</body>
</html>