<html>
<head>
<title>How to build a User Search App in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中构建用户搜索App</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-user-search-app-in-react-5bf1eff63657?source=collection_archive---------4-----------------------#2020-05-16">https://javascript.plainenglish.io/how-to-build-user-search-app-in-react-5bf1eff63657?source=collection_archive---------4-----------------------#2020-05-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7ede" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">创建具有高效排序和过滤功能的应用程序</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/2f5ea014e907ba0cd3406f2fcb665fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQ0gDyivSloOG_naa51V_g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Search App</figcaption></figure><p id="5c73" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在本文中，我们将使用React创建一个添加了排序和过滤功能的搜索应用程序。</p><p id="2c16" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你可以在这里看到应用程序<a class="ae lo" href="https://user-search-app.now.sh/" rel="noopener ugc nofollow" target="_blank">的现场演示</a></p><p id="52cf" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="lp">我们将在本文中使用React钩子，如果你不熟悉它，请查看本文</em><a class="ae lo" href="https://levelup.gitconnected.com/an-introduction-to-react-hooks-50281fd961fe?source=friends_link&amp;sk=89baff89ec8bc637e7c13b7554904e54" rel="noopener ugc nofollow" target="_blank"><em class="lp"/></a><em class="lp">以获得React钩子的介绍。</em></p><h2 id="7dc5" class="lq lr in bd ls lt lu dn lv lw lx dp ly lb lz ma mb lf mc md me lj mf mg mh mi bi translated">我们开始吧</h2><p id="37ff" class="pw-post-body-paragraph ks kt in ku b kv mj jo kx ky mk jr la lb ml ld le lf mm lh li lj mn ll lm ln ig bi translated">通过运行以下命令创建一个新的React项目</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="35ce" class="lq lr in mp b gy mt mu l mv mw">create-react-app user-search-app</span></pre><p id="984d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">项目创建完成后，删除<code class="fe mx my mz mp b">src</code>文件夹中的所有文件，并在<code class="fe mx my mz mp b">src</code>文件夹中创建<code class="fe mx my mz mp b">index.js</code>文件。同样，在<code class="fe mx my mz mp b">src</code>文件夹中创建<code class="fe mx my mz mp b">css</code>、<code class="fe mx my mz mp b">components,</code>、<code class="fe mx my mz mp b">reducers,</code>、<code class="fe mx my mz mp b">store</code>文件夹。</p><p id="0c26" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">安装所需的npm软件包</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="75c2" class="lq lr in mp b gy mt mu l mv mw">yarn add axios@0.19.2 bootstrap@4.5.0 react-bootstrap@1.0.1 lodash@4.17.15 node-sass@4.14.1 react-redux@7.2.0 react-select@3.1.0 redux@4.0.5 redux-thunk@2.3.0</span></pre><p id="7927" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">css</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">styles.scss</code>，并添加以下代码</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="b0c1" class="lq lr in mp b gy mt mu l mv mw">$body-background-color: #212a38;<br/>$body-color: #949ca5;<br/>$border-color: #080a0e;<br/><br/>html {<br/>  font-size: 62.5%;<br/>}<br/><br/>body {<br/>  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,<br/>    Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;<br/>  font-size: 1.6rem;<br/>  background-color: $body-background-color;<br/>  color: $body-color;<br/>  min-height: 100vh;<br/>  letter-spacing: 1px;<br/>}<br/><br/>.header {<br/>  padding: 2rem;<br/>  display: flex;<br/>  justify-content: center;<br/>  align-items: center;<br/>  margin-bottom: 2rem;<br/><br/>  &amp;__title {<br/>    font-weight: 600;<br/>    font-size: 3rem;<br/>    color: #fff;<br/>  }<br/><br/>  &amp;__search {<br/>    input {<br/>      background: lighten($body-background-color, 10%);<br/>      margin-left: 10rem;<br/>      border: 1px solid lighten($body-background-color, 10%);<br/>      padding: 1rem 2rem;<br/>      border-radius: 10rem;<br/>      width: 25rem;<br/>      outline: none;<br/>      color: $body-color;<br/>    }<br/>  }<br/>}<br/><br/>.sortBy {<br/>  border: 2px solid #566273;<br/>  padding: 1rem;<br/>  max-width: 25rem;<br/>  margin: auto;<br/><br/>  .select-filter {<br/>    margin-top: 1rem;<br/>  }<br/>}<br/><br/>.loading {<br/>  text-align: center;<br/>  margin-top: 10rem;<br/>  font-size: 2rem;<br/>}<br/><br/>.users-list {<br/>  display: flex;<br/>  flex-wrap: wrap;<br/>  justify-content: center;<br/>  margin-top: 2rem;<br/><br/>  .user {<br/>    width: 30rem;<br/>    margin: 1rem;<br/>    background: $body-background-color;<br/>    padding: 0.8rem;<br/>    box-shadow: 0 2px 7px 3px $body-color;<br/><br/>    &amp;__name {<br/>      font-size: 2rem;<br/>      color: #fff;<br/>      letter-spacing: 1px;<br/>    }<br/><br/>    &amp;__image {<br/>      width: 100%;<br/>      height: auto;<br/>      border: none;<br/>      margin-bottom: 2rem;<br/>    }<br/><br/>    &amp;__details {<br/>      span {<br/>        display: block;<br/>        padding: 0;<br/>        margin: 0;<br/>        line-height: 1.5;<br/>      }<br/>    }<br/>  }<br/>}<br/><br/>@media only screen and (max-width: 600px) {<br/>  .header {<br/>    flex-direction: column;<br/><br/>    &amp;__title {<br/>      margin-bottom: 1rem;<br/>    }<br/><br/>    &amp;__search {<br/>      input {<br/>        margin-left: 0;<br/>        margin-top: 1rem;<br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="846a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">public</code>文件夹中添加新的<code class="fe mx my mz mp b">users.json</code>文件，代码来自<a class="ae lo" href="https://github.com/myogeshchavan97/user-search-app/blob/master/public/users.json" rel="noopener ugc nofollow" target="_blank">这里的</a></p><p id="bed8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">actions</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">users.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="74ab" class="lq lr in mp b gy mt mu l mv mw">import axios from 'axios';<br/><br/>export const loadUsers = () =&gt; {<br/>  return async (dispatch) =&gt; {<br/>    try {<br/>      const users = await axios.get('./users.json');<br/>      return dispatch(setUsers(users.data));<br/>    } catch (error) {<br/>      console.log('error:', error);<br/>    }<br/>  };<br/>};<br/><br/>export const setUsers = (users) =&gt; ({<br/>  type: 'SET_USERS',<br/>  users<br/>});</span></pre><p id="082a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">components</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">Header.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="5fb0" class="lq lr in mp b gy mt mu l mv mw">import React from 'react';<br/><br/>const Header = ({ handleSearch }) =&gt; {<br/>  return (<br/>    &lt;header className="header"&gt;<br/>      &lt;div className="header__title"&gt;User Search App&lt;/div&gt;<br/>      &lt;div className="header__search"&gt;<br/>        &lt;input<br/>          type="search"<br/>          placeholder="Search users by country"<br/>          onChange={handleSearch}<br/>        /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/header&gt;<br/>  );<br/>};<br/><br/>export default Header;</span></pre><p id="3636" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">components</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">Filters.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="d65c" class="lq lr in mp b gy mt mu l mv mw">import React from 'react';<br/>import Select from 'react-select';<br/><br/>const Filters = ({ handleSort, sortOrder }) =&gt; {<br/>  const options = [<br/>    { value: '', label: 'None' },<br/>    { value: 'asc', label: 'Ascending' },<br/>    { value: 'desc', label: 'Descending' }<br/>  ];<br/><br/>  return (<br/>    &lt;div className="sortBy"&gt;<br/>      Sort by age<br/>      &lt;Select<br/>        value={sortOrder}<br/>        className="select-filter"<br/>        onChange={handleSort}<br/>        options={options}<br/>      /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};<br/><br/>export default Filters;</span></pre><p id="b6ea" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">components</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">UserItem.js</code>并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="cb66" class="lq lr in mp b gy mt mu l mv mw">import React from 'react';<br/>import { Card } from 'react-bootstrap';<br/><br/>const UserItem = ({ name, email, country, photo, gender, age }) =&gt; {<br/>  return (<br/>    &lt;Card className="user"&gt;<br/>      &lt;Card.Img variant="top" src={photo} className="user__image" alt={name} /&gt;<br/>      &lt;Card.Body&gt;<br/>        &lt;Card.Title className="user__name"&gt;{name}&lt;/Card.Title&gt;<br/>        &lt;Card.Text className="user__details"&gt;<br/>          &lt;span&gt;<br/>            &lt;strong&gt;Email:&lt;/strong&gt; {email}<br/>          &lt;/span&gt;<br/>          &lt;span&gt;<br/>            &lt;strong&gt;Country:&lt;/strong&gt; {country}<br/>          &lt;/span&gt;<br/>          &lt;span&gt;<br/>            &lt;strong&gt;Gender:&lt;/strong&gt; {gender}<br/>          &lt;/span&gt;<br/>          &lt;span&gt;<br/>            &lt;strong&gt;Age:&lt;/strong&gt; {age}<br/>          &lt;/span&gt;<br/>        &lt;/Card.Text&gt;<br/>      &lt;/Card.Body&gt;<br/>    &lt;/Card&gt;<br/>  );<br/>};<br/><br/>export default UserItem;</span></pre><p id="f1ed" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">components</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">UsersList.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="b060" class="lq lr in mp b gy mt mu l mv mw">import React from 'react';<br/>import UserItem from './UserItem';<br/><br/>const UsersList = ({ users, isLoading }) =&gt; {<br/>  return (<br/>    &lt;div className="users-list"&gt;<br/>      {isLoading ? (<br/>        &lt;p className="loading"&gt;Loading...&lt;/p&gt;<br/>      ) : (<br/>        &lt;React.Fragment&gt;<br/>          {users.map((user, index) =&gt; (<br/>            &lt;UserItem key={index} {...user} /&gt;<br/>          ))}<br/>        &lt;/React.Fragment&gt;<br/>      )}<br/>    &lt;/div&gt;<br/>  );<br/>};<br/><br/>export default UsersList;</span></pre><p id="2cca" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">components</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">HomePage.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="c0ac" class="lq lr in mp b gy mt mu l mv mw">/* eslint-disable react-hooks/exhaustive-deps */<br/>import React, { useState, useEffect, useRef } from 'react';<br/>import _ from 'lodash';<br/>import { connect } from 'react-redux';<br/>import { loadUsers } from '../actions/users';<br/>import UsersList from './UsersList';<br/>import Header from './Header';<br/>import Filters from './Filters';<br/><br/>const HomePage = (props) =&gt; {<br/>  const [users, setUsers] = useState(props.users);<br/>  const [sortOrder, setSortOrder] = useState('');<br/>  const [isLoading, setIsLoading] = useState(false);<br/>  const inputRef = useRef();<br/><br/>  // call api to get list of users<br/>  useEffect(() =&gt; {<br/>    setIsLoading(true);<br/>    props.dispatch(loadUsers());<br/><br/>    // initialize debounce function to search once user has stopped typing every half second<br/>    inputRef.current = _.debounce(onSearchText, 500);<br/>  }, []);<br/><br/>  useEffect(() =&gt; {<br/>    if (props.users.length &gt; 0) {<br/>      setUsers(props.users);<br/>      setIsLoading(false);<br/>    }<br/>  }, [props.users]);<br/><br/>  function onSearchText(text, props) {<br/>    let filtered;<br/>    if (text) {<br/>      filtered = props.users.filter((user) =&gt;<br/>        user.country.toLowerCase().includes(text.toLowerCase())<br/>      );<br/>    } else {<br/>      filtered = props.users;<br/>    }<br/>    setUsers(filtered);<br/>    setSortOrder('');<br/>  }<br/><br/>  function handleSearch(event) {<br/>    inputRef.current(event.target.value, props);<br/>  }<br/><br/>  function handleSort(sortOrder) {<br/>    setSortOrder(sortOrder);<br/>    if (sortOrder.value) {<br/>      setUsers(_.orderBy(users, ['age'], [sortOrder.value]));<br/>    }<br/>  }<br/><br/>  return (<br/>    &lt;React.Fragment&gt;<br/>      &lt;Header handleSearch={handleSearch} /&gt;<br/>      &lt;Filters handleSort={handleSort} sortOrder={sortOrder} /&gt;<br/>      &lt;UsersList users={users} isLoading={isLoading} /&gt;<br/>    &lt;/React.Fragment&gt;<br/>  );<br/>};<br/><br/>const mapStateToProps = (state) =&gt; ({<br/>  users: state.users<br/>});<br/><br/>export default connect(mapStateToProps)(HomePage);</span></pre><p id="d0d1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">reducers</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">users.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="e19a" class="lq lr in mp b gy mt mu l mv mw">const usersReducer = (state = [], action) =&gt; {<br/>  switch (action.type) {<br/>    case 'SET_USERS':<br/>      return [...state, ...action.users];<br/>    default:<br/>      return state;<br/>  }<br/>};<br/><br/>export default usersReducer;</span></pre><p id="2c8c" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">store</code>文件夹中创建一个新文件<code class="fe mx my mz mp b">store.js</code>，并添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="66b3" class="lq lr in mp b gy mt mu l mv mw">import { createStore, combineReducers, applyMiddleware, compose } from 'redux';<br/>import thunk from 'redux-thunk';<br/>import usersReducer from '../reducers/users';<br/><br/>const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;<br/>const store = createStore(<br/>  combineReducers({<br/>    users: usersReducer<br/>  }),<br/>  composeEnhancers(applyMiddleware(thunk))<br/>);<br/><br/>export default store;</span></pre><p id="95b2" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">src/index.js</code>内部添加以下代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="02e8" class="lq lr in mp b gy mt mu l mv mw">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import { Provider } from 'react-redux';<br/>import store from './store/store';<br/>import HomePage from './components/HomePage';<br/>import 'bootstrap/dist/css/bootstrap.min.css';<br/>import './css/styles.scss';<br/><br/>ReactDOM.render(<br/>  &lt;Provider store={store}&gt;<br/>    &lt;HomePage /&gt;<br/>  &lt;/Provider&gt;,<br/>  document.getElementById('root')<br/>);</span></pre><p id="b5e0" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在，通过从终端运行<code class="fe mx my mz mp b">yarn start</code>命令来启动应用程序，一切就绪</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/8057eec3b01d3ce2d64eaf734000f791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40Rq27Fxtlod34qHmoBywA.png"/></div></div></figure><p id="cf12" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在让我们来理解代码。</p><p id="3c0a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">HomePage.js</code>中，在第一个<code class="fe mx my mz mp b">useEffect</code>调用中，我们调用<code class="fe mx my mz mp b">loadUsers</code>动作生成器方法来获取用户列表。</p><p id="ce0d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">因为我们已经通过传递<code class="fe mx my mz mp b">mapStateToProps</code>将<code class="fe mx my mz mp b">HomePage</code>组件附加到了<code class="fe mx my mz mp b">react-redux</code>的<code class="fe mx my mz mp b">connect</code>方法，所以每当redux存储发生变化时，<code class="fe mx my mz mp b">users</code>对象将被填充一个用户列表，我们可以使用<code class="fe mx my mz mp b">props.users</code>在组件中访问该列表</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="ad3c" class="lq lr in mp b gy mt mu l mv mw">const mapStateToProps = (state) =&gt; ({<br/> users: state.users<br/>});</span></pre><p id="f38e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">因此，第二个<code class="fe mx my mz mp b">useEffect</code>将被调用，因为<code class="fe mx my mz mp b">users</code>属性已经更改，它将使用用户列表更新状态</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="4dee" class="lq lr in mp b gy mt mu l mv mw">useEffect(() =&gt; {<br/> if (props.users.length &gt; 0) {<br/>  setUsers(props.users);<br/>  setIsLoading(false);<br/> }<br/>}, [props.users]);</span></pre><p id="d728" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">Filters.js</code>中，我们正在使用<code class="fe mx my mz mp b">react-select</code>库中的<code class="fe mx my mz mp b">Select</code>组件来显示下拉列表，以便按年龄排序，并且一旦use从下拉列表中选择了任何值，我们就调用在<code class="fe mx my mz mp b">HomePage.js</code>中定义的作为道具传递的<code class="fe mx my mz mp b">handleSort</code>方法</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="44fb" class="lq lr in mp b gy mt mu l mv mw">function handleSort(sortOrder) {<br/> setSortOrder(sortOrder);<br/> if (sortOrder.value) {<br/>  setUsers(_.orderBy(users, ['age'], [sortOrder.value]));<br/> }<br/>}</span></pre><p id="14f2" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这里，<code class="fe mx my mz mp b">sortOrder</code>参数将包含格式为<code class="fe mx my mz mp b">{ value: ‘asc’, label: ‘Ascending’ }</code>的对象</p><p id="51a7" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们通过调用<code class="fe mx my mz mp b">setSortOrder</code>方法将这个值设置为<code class="fe mx my mz mp b">sortOrder</code>状态对象。如果选择的值不为空，那么我们调用由<code class="fe mx my mz mp b">lodash</code>提供的<code class="fe mx my mz mp b">orderBy</code>方法。<code class="fe mx my mz mp b">orderBy</code>方法接受</p><p id="b505" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">1.我们要排序的那个<code class="fe mx my mz mp b">collection(array or object)</code></p><p id="3cbb" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">2.应该用于排序的字段</p><p id="b887" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">3.升序排序顺序<code class="fe mx my mz mp b">asc</code>和降序排序顺序<code class="fe mx my mz mp b">desc</code>如下</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="6e83" class="lq lr in mp b gy mt mu l mv mw">_.orderBy(users, ['age'], ['asc'])</span></pre><p id="d472" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所有的<code class="fe mx my mz mp b">lodash</code>方法都针对性能进行了优化，因此与手动排序相比，排序总是更快。</p><p id="3657" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果我们在不使用<code class="fe mx my mz mp b">lodash</code>库的情况下编写排序功能，排序将如下所示</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="5775" class="lq lr in mp b gy mt mu l mv mw">function handleSort(sortOrder) {<br/>    setSortOrder(sortOrder);<br/>    const order = sortOrder.value;<br/>    if (order == 'asc') {<br/>      setUsers(<br/>        users.slice().sort((firstUser, secondUser) =&gt; {<br/>          if (firstUser.age &lt; secondUser.age) return -1;<br/>          if (firstUser.age &gt; secondUser.age) return 1;<br/>          return 0;<br/>        })<br/>      );<br/>    } else if (order == 'desc') {<br/>      setUsers(<br/>        users.slice().sort((firstUser, secondUser) =&gt; {<br/>          if (firstUser.age &lt; secondUser.age) return 1;<br/>          if (firstUser.age &gt; secondUser.age) return -1;<br/>          return 0;<br/>        })<br/>      );<br/>    }<br/>  }</span></pre><p id="c2dd" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这是更多的代码，也可能没有<code class="fe mx my mz mp b">lodash</code>的<code class="fe mx my mz mp b">orderBy</code>方法快。</p><p id="a333" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果你想了解更多关于数组排序的知识，请查阅我的前一篇文章。</p><p id="65c4" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">搜索功能:</strong></p><p id="e4b9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果我们正在进行API请求，那么为了避免对每个键入的字符进行API请求，我们可以使用由<code class="fe mx my mz mp b">lodash</code>提供的<code class="fe mx my mz mp b">debounce</code>方法。</p><p id="9e4e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><code class="fe mx my mz mp b">debounce</code>方法允许我们在几毫秒后调用一个函数。如果有大量数据，这将避免应用程序变慢。因此，一旦用户停止输入，我们将在500毫秒后进行API调用。</p><p id="3631" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">为了通过演示了解普通搜索和去抖搜索的区别，请点击这里查看我以前的文章<a class="ae lo" href="https://levelup.gitconnected.com/extremely-useful-lodash-methods-b38f121fea7e#68c9" rel="noopener ugc nofollow" target="_blank"/></p><p id="94ca" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe mx my mz mp b">HomePage.js</code>中，当组件在<code class="fe mx my mz mp b">useEffect</code>调用中被挂载时，我们只初始化了一次<code class="fe mx my mz mp b">debounce</code>方法，因为空数组<code class="fe mx my mz mp b">[]</code>作为第二个参数被传递。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="d18a" class="lq lr in mp b gy mt mu l mv mw">inputRef.current = _.debounce(onSearchText, 500);</span></pre><p id="cd86" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><code class="fe mx my mz mp b">debounce</code>方法返回一个我们存储在<code class="fe mx my mz mp b">inputRef.current</code>中的函数，并在<code class="fe mx my mz mp b">handleSearch</code>处理程序中调用它，当用户在输入搜索文本框中键入时，这个处理程序就会被调用。当我们调用<code class="fe mx my mz mp b">inputRef.current</code>方法时，它在内部调用<code class="fe mx my mz mp b">onSearchText</code>方法，在那里我们基于输入搜索过滤掉用户。</p><p id="50c7" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你可以在这里找到这篇文章<a class="ae lo" href="https://github.com/myogeshchavan97/user-search-app" rel="noopener ugc nofollow" target="_blank">的完整源代码，在这里</a>找到现场演示<a class="ae lo" href="https://user-search-app.now.sh/" rel="noopener ugc nofollow" target="_blank"/></p><p id="3323" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">今天到此为止。我希望你学到了新东西。</p><p id="1786" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">不要忘记订阅我的每周简讯，里面有惊人的技巧、窍门和文章，直接在这里的收件箱里。T29】</p></div></div>    
</body>
</html>