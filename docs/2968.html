<html>
<head>
<title>How I resolved issues while setting up Jest and Enzyme in a React app created using Webpack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何在使用Webpack创建的React应用程序中设置Jest和Enzyme时解决问题</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-i-solved-issues-while-setting-up-jest-and-enzyme-in-a-react-app-created-using-webpack-7e321647f080?source=collection_archive---------0-----------------------#2020-08-12">https://javascript.plainenglish.io/how-i-solved-issues-while-setting-up-jest-and-enzyme-in-a-react-app-created-using-webpack-7e321647f080?source=collection_archive---------0-----------------------#2020-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c37cf0770d0beffa89180bf038d1aace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFbCE_Gv0lxlf6IgB1TZXA.jpeg"/></div></div></figure><p id="6196" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">写这篇博客的主要原因是，我在React项目中设置测试环境时面临许多错误。如果你使用的是CRA，那就简单多了，但是如果项目是用Webpack配置的，那就麻烦了。我不希望我的开发伙伴经历同样的麻烦。</p><p id="bc22" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw">注</em> </strong> <em class="kw">:本文不是为了从头开始设置Webpack、Jest或Enzyme。为此，我会分享其他人的精彩文章的链接。这只是为了帮助开发人员修复他们在这样做时可能面临的错误。</em></p><p id="0290" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基本上，我遇到了两个花了很长时间才解决的错误:</p><ol class=""><li id="8d8b" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><strong class="ka ir"> Jest遇到意外令牌</strong></li></ol><pre class="lg lh li lj gt lk ll lm ln aw lo bi"><span id="d834" class="lp lq iq ll b gy lr ls l lt lu">Jest encountered an unexpected token<br/><br/>    This usually means that you are trying to import a file which Jest cannot parse, e.g. it's not plain JavaScript.This usually means that you are trying to import a file which Jest cannot parse, e.g. it's not plain JavaScript.<br/><br/>    By default, if Jest sees a Babel config, it will use that to transform your files, ignoring "node_modules".<br/><br/>    Here's what you can do:<br/>     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.<br/>     • If you need a custom transformation specify a "transform" option in your config.<br/>     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.     <br/><br/>    You'll find more details and examples of these config options in the docs:<br/>    <a class="ae lv" href="https://jestjs.io/docs/en/configuration.html" rel="noopener ugc nofollow" target="_blank">https://jestjs.io/docs/en/configuration.html</a></span></pre><p id="065f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我一使用Jest运行测试，这个错误就出现了。</p><p id="b270" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在做了大量的调试之后，我意识到我在。一点也不好。我漏掉的是“预设环境”。为此，我安装了<strong class="ka ir"> @babel/preset-env。</strong></p><pre class="lg lh li lj gt lk ll lm ln aw lo bi"><span id="ce84" class="lp lq iq ll b gy lr ls l lt lu">npm i -D <a class="ae lv" href="http://twitter.com/babel/preset-env" rel="noopener ugc nofollow" target="_blank">@babel/preset-env</a></span></pre><p id="4938" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我将<code class="fe lw lx ly ll b">.babelrc</code>文件更新为:</p><pre class="lg lh li lj gt lk ll lm ln aw lo bi"><span id="2042" class="lp lq iq ll b gy lr ls l lt lu">{ <br/>  "presets": ["@babel/react", "@babel/env"]<br/>}</span></pre><p id="202e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这个，我能够成功地运行测试，使用:</p><pre class="lg lh li lj gt lk ll lm ln aw lo bi"><span id="e70c" class="lp lq iq ll b gy lr ls l lt lu">npm run test</span></pre><p id="f589" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">PS:我已经修改了相同的<strong class="ka ir">“脚本”</strong>键。</p><p id="32b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.<strong class="ka ir">未定义再生运行时间</strong></p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/9c92e77faa9adef2669fc088184ec4e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqv-E9m0Fgw58j_fJkjALQ.png"/></div></div></figure><p id="4cf9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我面临的第二个错误。因此，我的测试现在运行良好，但是我的应用程序开始崩溃。当我点击网址时，我得到了上面的错误。</p><p id="6f5e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，在做了大量的调试和谷歌搜索后，我了解到我需要的东西是<strong class="ka ir"> @babel/polyfill。</strong></p><p id="6787" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要安装，只需运行:</p><pre class="lg lh li lj gt lk ll lm ln aw lo bi"><span id="92aa" class="lp lq iq ll b gy lr ls l lt lu">npm install --save @babel/polyfill</span></pre><p id="e309" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">是的，这不是开发依赖性，因为它是一个多填充。</p><p id="839a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装完成后，只需将其添加到<strong class="ka ir"><em class="kw">web pack . config . js</em></strong>中的<code class="fe lw lx ly ll b">"entry"</code>中即可:</p><pre class="lg lh li lj gt lk ll lm ln aw lo bi"><span id="a0c6" class="lp lq iq ll b gy lr ls l lt lu">entry: ['@babel/polyfill', './src/js/index.js'],</span></pre><p id="814f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已。有了这个，我的应用程序和测试，现在都运行得相当顺利。如果你遇到这些错误或者遇到新错误，请告诉我你是否能够修复它们。</p><p id="2daa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">资源:</strong></p><div class="ma mb gp gr mc md"><a href="https://medium.com/@imranhsayed/set-up-react-app-with-webpack-webpack-dev-server-and-babel-from-scratch-df398174446d" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">从头开始使用Webpack、Webpack开发服务器和Babel设置React应用程序。</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">在这篇博客中，你将学习如何设置一个React应用程序:</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr jw md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://medium.com/codeclan/testing-react-with-jest-and-enzyme-20505fec4675" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">测试与Jest和酶I的反应</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">这篇文章将介绍如何设置和使用Jest和Enzyme来测试用Create React App创建的React应用程序…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="ms l mo mp mq mm mr jw md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://jestjs.io/docs/en/tutorial-react" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">测试React应用Jest</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">在脸书，我们使用Jest来测试React应用程序。如果您是React新手，我们建议您使用Create React App。它…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">jet js . io</p></div></div><div class="mm l"><div class="mt l mo mp mq mm mr jw md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://www.toptal.com/react/tdd-react-unit-testing-enzyme-jest" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd ir gy z fp mi fr fs mj fu fw ip bi translated">测试驱动的React.js开发:用Enzyme和Jest进行React.js单元测试</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">根据Michael Feathers的说法，任何没有经过测试的代码都是遗留代码。因此，其中一个…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">www.toptal.com</p></div></div><div class="mm l"><div class="mu l mo mp mq mm mr jw md"/></div></div></a></div></div></div>    
</body>
</html>