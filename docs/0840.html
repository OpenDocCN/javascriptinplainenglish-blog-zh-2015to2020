<html>
<head>
<title>How to add Firebase Authentication to PWA or Angular project using AngularFire.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用AngularFire为PWA或Angular项目添加Firebase认证？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-add-firebase-authentication-to-pwa-or-angular-project-using-angularfire-83a8f61d367c?source=collection_archive---------0-----------------------#2019-12-20">https://javascript.plainenglish.io/how-to-add-firebase-authentication-to-pwa-or-angular-project-using-angularfire-83a8f61d367c?source=collection_archive---------0-----------------------#2019-12-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="fd9c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">学习使用Firebase认证服务在你的PWA ( <a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-build-pwas-progressive-web-apps-using-angular-ionic-framework-and-firebase-hosting-bfe43e025eba" rel="noopener">渐进式网络应用</a>)或<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-build-pwas-progressive-web-apps-using-angular-ionic-framework-and-firebase-hosting-bfe43e025eba" rel="noopener"> Angular应用</a>中实现注册/登录——它支持使用密码、电话、谷歌、脸书、Twitter等其他提供商的<strong class="jm io"><em class="kj"/></strong>认证。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/017c573d593fa96be73005e199e325f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4NL81I4g7SYwVC9spGgzg.png"/></div></div></figure><blockquote class="kw kx ky"><p id="60be" class="jk jl kj jm b jn jo jp jq jr js jt ju kz jw jx jy la ka kb kc lb ke kf kg kh ig bi translated"><strong class="jm io"> <em class="in">了解AngularFireAuth</em></strong><em class="in">:<br/>我们将使用AngularFireAuth进行认证——AngularFireAuth是AngularFire的一个库，官方支持AngularJS绑定Firebase。</em></p></blockquote><p id="31b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lc ld le lf b">AngularFireAuth.user</code>为我们提供了一个<code class="fe lc ld le lf b">Observable&lt;User|null&gt;</code>来监控我们的应用程序的认证状态。</p><p id="0583" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe lc ld le lf b">AngularFireAuth.auth</code>返回一个初始化的<code class="fe lc ld le lf b">firebase.auth.Auth</code>实例，允许我们让用户登录、退出等。<a class="ae ki" href="https://firebase.google.com/docs/reference/js/firebase.auth.Auth" rel="noopener ugc nofollow" target="_blank">有关可用方法的更多信息，请参见Firebase文档。</a></p><p id="7f43" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">如果你已经有了自己的项目，那很好。</strong> <br/>如果没有，请跟随<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-build-pwas-progressive-web-apps-using-angular-ionic-framework-and-firebase-hosting-bfe43e025eba" rel="noopener">链接</a>。<br/> <a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-build-pwas-progressive-web-apps-using-angular-ionic-framework-and-firebase-hosting-bfe43e025eba" rel="noopener">点击此处👆</a>创建您的<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-build-pwas-progressive-web-apps-using-angular-ionic-framework-and-firebase-hosting-bfe43e025eba" rel="noopener">新PWA/Angular项目</a>。</p><blockquote class="lg"><p id="2c89" class="lh li in bd lj lk ll lm ln lo lp kh dk translated">在第一步中，我们将添加Firebase到一个角度项目(#1)</p><p id="a96b" class="lh li in bd lj lk ll lm ln lo lp kh dk translated">然后启用电子邮件/密码登录方法(#2)</p><p id="efcf" class="lh li in bd lj lk ll lm ln lo lp kh dk translated">跟我来，我会告诉你我们如何做...</p></blockquote><h1 id="2ae1" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">#1将Firebase添加到Angular项目中。</h1><p id="4627" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">在开始之前，我们需要通过添加Firebase在我们的项目中设置Firebase配置。点击链接添加Firebase —点击此处👇👇</p><div class="mt mu gp gr mv mw"><a href="https://medium.com/@AnkitMaheshwariIn/how-to-add-firebase-in-pwa-or-angular-project-using-angularfire-b0379c08249d" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd io gy z fp nb fr fs nc fu fw im bi translated">如何使用AngularFire在PWA或Angular project中添加Firebase？</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">使用AngularFire在PWA/ion/Angular项目中设置Firebase配置。</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">medium.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk ku mw"/></div></div></a></div><p id="1235" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">将Firebase/AngularFire添加到项目中后，请遵循#2。</p></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><h1 id="ec0c" class="lq lr in bd ls lt ns lv lw lx nt lz ma mb nu md me mf nv mh mi mj nw ml mm mn bi translated">#2在Firebase控制台的身份验证部分启用电子邮件/密码登录方法。</h1><p id="c85c" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated"><a class="ae ki" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank">点击这里打开Firebase控制台</a>然后在你的Firebase项目下点击<code class="fe lc ld le lf b">Authentication</code>然后点击<code class="fe lc ld le lf b">Sign-in method</code>然后在<code class="fe lc ld le lf b">Sign-in providers</code>下T25【启用邮箱/密码】状态。</p><p id="3d8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来…我们将使用<code class="fe lc ld le lf b">AngularFireAuthModule</code>模块配置我们的应用程序模块。让我们通过在我们的<code class="fe lc ld le lf b">app.module.ts</code>文件中导入相应的AngularFireAuthModule(AngularFireAuthModule)来完成这个:</p><p id="475c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">(还要注意，我们正在导入并提供一个<code class="fe lc ld le lf b">AuthService</code>。接下来我们将创建该服务。我们还需要导入<code class="fe lc ld le lf b">FormsModule</code>来使用<code class="fe lc ld le lf b">ngModel</code> <a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/angular-template-syntax-directive-interpolation-property-binding-event-binding-part-4-547e2512d8fe" rel="noopener">指令</a>，我们将在本文后面使用它。)</p><pre class="kl km kn ko gt nx lf ny nz aw oa bi"><span id="eb5b" class="ob lr in lf b gy oc od l oe of">import { AngularFireModule } from '@angular/fire';<br/>import { AngularFireAuthModule } from '@angular/fire/auth';<br/>import { FormsModule } from '@angular/forms';<br/>import { AuthService } from './auth.service';<br/>...<br/>imports: [<br/>    BrowserModule,<br/>    AngularFireModule.initializeApp(environment.firebase),<br/>    AngularFireAuthModule,<br/>    FormsModule<br/>  ],<br/>providers: [<br/>    ...<br/>    AuthService<br/>],<br/>...</span></pre></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><h1 id="2ad0" class="lq lr in bd ls lt ns lv lw lx nt lz ma mb nu md me mf nv mh mi mj nw ml mm mn bi translated">#3创建授权服务。</h1><p id="622e" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">我们的服务将是一个允许我们<code class="fe lc ld le lf b">login</code>、<code class="fe lc ld le lf b">signup</code>或<code class="fe lc ld le lf b">logout</code>用户的中心位置，因此我们将为这3个动作定义方法。所有的认证逻辑都在<code class="fe lc ld le lf b">AuthService</code>中，这将允许我们创建不需要实现任何认证逻辑的组件，并有助于保持组件的简单性。</p><p id="8845" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以使用Angular CLI为服务创建框架，运行以下命令:</p><pre class="kl km kn ko gt nx lf ny nz aw oa bi"><span id="51a3" class="ob lr in lf b gy oc od l oe of">ng g s service/auth</span></pre><p id="8861" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">(其中<code class="fe lc ld le lf b">g</code> <em class="kj"> →生成，</em> <code class="fe lc ld le lf b"><em class="kj">s</em></code> <em class="kj"> →服务，</em> <code class="fe lc ld le lf b"><em class="kj">auth</em></code> <em class="kj"> →服务名，</em> <code class="fe lc ld le lf b"><em class="kj">service/auth</em></code> <em class="kj">表示将</em> <code class="fe lc ld le lf b">AuthService</code>创建到<code class="fe lc ld le lf b">service</code>文件夹中)</p><p id="aff7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">接下来，打开您的<code class="fe lc ld le lf b">src/app/service/<strong class="jm io">auth.service.ts</strong></code>文件并添加以下代码:</p><pre class="kl km kn ko gt nx lf ny nz aw oa bi"><span id="e964" class="ob lr in lf b gy oc od l oe of">// auth.service.ts<br/>import { Injectable } from '@angular/core';<br/>import { AngularFireAuth } from '@angular/fire/auth';<br/>import { Observable } from 'rxjs';<br/><br/>@Injectable({<br/>  providedIn: 'root'<br/>})<br/>export class AuthService {<br/>  user: Observable&lt;firebase.User&gt;;<br/><br/>  constructor(private firebaseAuth: AngularFireAuth) {<br/>    this.user = firebaseAuth.authState;<br/>  }<br/><br/>  signup(email: string, password: string) {<br/>    this.firebaseAuth<br/>      .createUserWithEmailAndPassword(email, password)<br/>      .then(value =&gt; {<br/>        console.log('Success!', value);<br/>      })<br/>      .catch(err =&gt; {<br/>        console.log('Something went wrong:',err.message);<br/>      });<br/>  }<br/><br/>  login(email: string, password: string) {<br/>    this.firebaseAuth<br/>      .signInWithEmailAndPassword(email, password)<br/>      .then(value =&gt; {<br/>        console.log('Nice, it worked!');<br/>      })<br/>      .catch(err =&gt; {<br/>        console.log('Something went wrong:',err.message);<br/>      });<br/>  }<br/><br/>  logout() {<br/>    this.firebaseAuth.signOut();<br/>  }<br/>}</span></pre><p id="4cc9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你会注意到<code class="fe lc ld le lf b"><strong class="jm io">AngularFireAuth.auth</strong></code>(<code class="fe lc ld le lf b">auth.service.ts</code>的第18、30行)上可用的方法都返回承诺，所以我们可以使用<code class="fe lc ld le lf b">then</code>和<code class="fe lc ld le lf b">catch</code>分别处理成功和错误状态。</p><p id="c3af" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们使用<code class="fe lc ld le lf b">createUserWithEmailAndPassword</code>(<code class="fe lc ld le lf b">auth.service.ts</code>的第18行)和<code class="fe lc ld le lf b">signInWithEmailAndPassword</code>(<code class="fe lc ld le lf b">auth.service.ts</code>的第30行)在这里我们设置了电子邮件/密码认证——等同的方法也可用于Twitter、脸书和谷歌的认证。</p></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><h1 id="48ef" class="lq lr in bd ls lt ns lv lw lx nt lz ma mb nu md me mf nv mh mi mj nw ml mm mn bi translated">#4组件类和模板。</h1><p id="8a67" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">现在我们已经准备好了身份验证服务，创建一个允许我们登录、注册或注销组件非常简单:</p><p id="6d05" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开您的<code class="fe lc ld le lf b">src/app/<strong class="jm io">app.component.ts</strong></code>文件并添加以下代码:</p><pre class="kl km kn ko gt nx lf ny nz aw oa bi"><span id="1b07" class="ob lr in lf b gy oc od l oe of">/*<br/>  file-name: app.component.ts<br/>  *****<br/>  The important code for logging-in, signing-up or logging-out are:<br/>  — import 'AuthService'<br/>  — declare variable 'email' and 'password'<br/>  — inject service 'authService' at constructor<br/>  — method for signup()<br/>  — method for login()<br/>  — method for logout()<br/>*/<br/><br/>...<br/>import { AuthService } from './service/auth.service';<br/><br/>@Component({<br/>  selector: 'app-root',<br/>  templateUrl: 'app.component.html',<br/>  styleUrls: ['app.component.scss']<br/>})<br/>export class AppComponent {<br/>  email: string;<br/>  password: string;<br/>  ...<br/><br/>  constructor(public authService: AuthService) {<br/>    ...<br/>  }<br/><br/><br/>  signup() {<br/>    this.authService.signup(this.email, this.password);<br/>    this.email = this.password = '';<br/>  }<br/><br/>  login() {<br/>    this.authService.login(this.email, this.password);<br/>    this.email = this.password = '';    <br/>  }<br/><br/>  logout() {<br/>    this.authService.logout();<br/>  }<br/>}</span></pre><p id="c917" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们在组件的构造函数中注入服务(<code class="fe lc ld le lf b">authService</code> at constructor)，然后定义调用auth服务上的等效方法的本地方法。</p><p id="eafb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们用关键字<code class="fe lc ld le lf b">public</code>而不是<code class="fe lc ld le lf b">private</code>注入服务(<code class="fe lc ld le lf b">authService</code>，这样我们也可以直接从模板中访问服务属性。</p><p id="fc0e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该模板非常简单，使用authService的用户对象上的<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/use-promises-async-await-in-place-of-javascript-callbacks-5460ee7aa260" rel="noopener"><strong class="jm io"/></a><strong class="jm io">(</strong><a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/use-promises-async-await-in-place-of-javascript-callbacks-5460ee7aa260" rel="noopener"><strong class="jm io">单击此处</strong> </a> <strong class="jm io"> ) </strong>来确定用户是否登录:</p><p id="f200" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开您的<code class="fe lc ld le lf b">src/app/<strong class="jm io">app.component.html</strong></code>文件并更新代码:</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="39bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的输入字段有双向绑定<strong class="jm io"> ( </strong> <a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/use-promises-async-await-in-place-of-javascript-callbacks-5460ee7aa260" rel="noopener"> <strong class="jm io">点击这里</strong> </a> <strong class="jm io"> ) </strong>到我们的组件类中的email和密码值，使用<code class="fe lc ld le lf b">ngModel</code>和box of bananas [ <code class="fe lc ld le lf b"><strong class="jm io">(</strong></code> ngModel <code class="fe lc ld le lf b"><strong class="jm io">)</strong></code>。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi oi"><img src="../Images/d0de9d535e463695762796a3f067f5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DlIj36kBpQZMC_0J.png"/></div></div></figure><h1 id="2139" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb oj md me mf ok mh mi mj ol ml mm mn bi translated">搞定了。🤩添加Firebase身份验证就是这么简单。</h1><p id="ed2c" class="pw-post-body-paragraph jk jl in jm b jn mo jp jq jr mp jt ju jv mq jx jy jz mr kb kc kd ms kf kg kh ig bi translated">再见👋👋</p><h1 id="a401" class="lq lr in bd ls lt lu lv lw lx ly lz ma mb oj md me mf ok mh mi mj ol ml mm mn bi translated">接下来，您可以涵盖:</h1><ol class=""><li id="eabe" class="om on in jm b jn mo jr mp jv oo jz op kd oq kh or os ot ou bi translated">如何使用Firestore在Firebase 中进行<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-do-crud-query-operations-in-firebase-with-firestore-angular-ionic-web-cfd662165fd7" rel="noopener"> CRUD操作。(</a><a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/how-to-do-crud-query-operations-in-firebase-with-firestore-angular-ionic-web-cfd662165fd7" rel="noopener">点击这里👆</a>)</li><li id="ec9c" class="om on in jm b jn ov jr ow jv ox jz oy kd oz kh or os ot ou bi translated"><a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/deploy-project-to-firebase-hosting-ce6acbd06435" rel="noopener">将项目</a>部署到Firebase主机。(<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn/deploy-project-to-firebase-hosting-ce6acbd06435" rel="noopener">点击这里👆</a>)</li></ol></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><blockquote class="lg"><p id="89c9" class="lh li in bd lj lk ll lm ln lo lp kh dk translated">请在评论框中随意评论…如果我错过了什么，或者什么是不正确的，或者什么对你不起作用:)</p><p id="9bb6" class="lh li in bd lj lk ll lm ln lo lp kh dk translated">更多文章敬请关注:【https://medium.com/@AnkitMaheshwariIn】<a class="ae ki" href="https://medium.com/@AnkitMaheshwariIn" rel="noopener"/></p></blockquote></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><p id="1b66" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi pa translated">如果你不介意给它一些掌声👏 👏既然有帮助，我会非常感谢:)帮助别人找到这篇文章，所以它可以帮助他们！</p><p id="d1b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">永远鼓掌…</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/2f4712882de180d90c9dcdb0cb91ae69.png" data-original-src="https://miro.medium.com/v2/resize:fit:156/1*ZyakciENSuUWo7tqu84tXQ.gif"/></div></figure></div><div class="ab cl nl nm hr nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ig ih ii ij ik"><p id="1fd9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="kj">原载于2019年12月20日</em><a class="ae ki" href="https://www.codewithchintan.com/how-to-add-firebase-authentication-to-pwa-or-angular-project-using-angularfire-with-ionic4-and-angular/" rel="noopener ugc nofollow" target="_blank"><em class="kj">https://www.codewithchintan.com</em></a><em class="kj">。</em></p><p id="2cd1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">【JavaScript用简单英语写的一句话:我们总是对帮助推广优质内容感兴趣。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到submissions@javascriptinplainenglish.com，我们会把你添加为作者。</p></div></div>    
</body>
</html>