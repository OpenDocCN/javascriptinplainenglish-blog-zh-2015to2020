<html>
<head>
<title>Organize Your Tests Better With jest-in-case</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用案例笑话更好地组织你的测试</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/organize-your-tests-better-with-jest-in-case-19ea1ce86905?source=collection_archive---------6-----------------------#2020-11-19">https://javascript.plainenglish.io/organize-your-tests-better-with-jest-in-case-19ea1ce86905?source=collection_archive---------6-----------------------#2020-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bb3869d0055683ddba7a9a073dc47089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7s4_d_gJ6jgfXN64"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@azhar93?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Azharul Islam</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ba18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章讨论了我如何使用<a class="ae kc" href="https://github.com/atlassian/jest-in-case" rel="noopener ugc nofollow" target="_blank">案例笑话库</a>来编写更有组织的测试。然而，使用这个库有一个先决条件，你可能猜对了。</p><p id="fc78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你使用Jest来编写测试，那么这篇文章可能会对你有所帮助。</p><h2 id="91ee" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">问题背景</h2><p id="225b" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我不知道你是怎么想的，但是很多时候，当我写一些非常普通的函数时，我会有很多测试用例，这些测试用例基本上是用不同的值反复进行的相同的测试—杰米·凯尔</p><p id="9706" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的陈述让我产生了很大的共鸣，尤其是当我开始面对这样的情况，我编写的单元测试代码是我最初代码变更的三倍或四倍。更糟糕的是，大多数单元测试代码都是重复的。</p><p id="55d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事不宜迟，让我们看看下面的案例研究。</p><h1 id="3ff7" class="ma lc iq bd ld mb mc md lg me mf mg lj mh mi mj lm mk ml mm lp mn mo mp ls mq bi translated">个案研究</h1><p id="7b3f" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">下面的函数是一个简单的重定向函数，我们将</p><ol class=""><li id="dadb" class="mr ms iq kf b kg kh kk kl ko mt ks mu kw mv la mw mx my mz bi translated">检查交易状态</li><li id="f718" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la mw mx my mz bi translated">根据交易状态将用户重定向到不同的状态页面</li></ol><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="d01c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们试着为上面的函数写一个单元测试。上面的典型Jest单元测试如下所示。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="d37b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在上面写了4个测试用例来涵盖以下场景:</p><ul class=""><li id="d66f" class="mr ms iq kf b kg kh kk kl ko mt ks mu kw mv la nl mx my mz bi translated">当交易状态为“待定”时，重定向至“存款待定Url”</li><li id="b46c" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la nl mx my mz bi translated">当交易状态为“已批准”时，重定向至“存款成功Url”</li><li id="4922" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la nl mx my mz bi translated">重定向至“交易状态为“失败”时存放失败的Url”诊断树</li><li id="bca6" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la nl mx my mz bi translated">重定向至“交易状态为“失败”时存放失败的Url”诊断树</li></ul><p id="6070" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面的测试用例中，我们意识到所有的测试用例都有彼此非常接近和相似的代码。唯一的区别是</p><p id="55c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的测试用例有什么问题？</p><ul class=""><li id="d9ad" class="mr ms iq kf b kg kh kk kl ko mt ks mu kw mv la nl mx my mz bi translated"><strong class="kf ir">难以维持。</strong>举一个简单的例子，如果我要将<code class="fe nm nn no np b"><strong class="kf ir">findTransaction</strong></code> <strong class="kf ir"> </strong>函数重命名为<code class="fe nm nn no np b"><strong class="kf ir">findTansactions</strong></code> <strong class="kf ir"> </strong>，我大概要用transaction service . find transaction&amp;来查找所有的行，更新每个测试用例。</li><li id="111f" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la nl mx my mz bi translated"><strong class="kf ir">无聊&amp;不思进取</strong>。当你不得不编写如此多的测试用例场景并重复相同的代码库时，你会感到厌烦，不太可能去编写它们，最终会变得没有生产力。</li></ul><h1 id="8bac" class="ma lc iq bd ld mb mc md lg me mf mg lj mh mi mj lm mk ml mm lp mn mo mp ls mq bi translated">使用案例笑话编写测试用例</h1><p id="94e6" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">现在让我们使用库<code class="fe nm nn no np b">jest-in-case</code>为上面测试的类似场景编写测试用例。</p><figure class="nf ng nh ni gt jr"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="585d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用<code class="fe nm nn no np b">jest-in-case</code>，我只需编写一次测试用例逻辑，并通过选项提供不同的输入和预期结果。测试用例最终减少了2倍的代码，更加清晰易读。更重要的是，它使开发人员更容易维护测试用例。</p><h1 id="f031" class="ma lc iq bd ld mb mc md lg me mf mg lj mh mi mj lm mk ml mm lp mn mo mp ls mq bi translated">结论</h1><p id="16d4" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">从这篇文章中，我们知道<code class="fe nm nn no np b">jest-in-case</code>是一个很好的库，它使我们能够:</p><ul class=""><li id="5a69" class="mr ms iq kf b kg kh kk kl ko mt ks mu kw mv la nl mx my mz bi translated">编写更简洁的测试用例。这也提高了编写测试用例的效率。</li><li id="68ad" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la nl mx my mz bi translated">当您的测试用例基于不同的输入有多个场景时，这是非常有用的。</li></ul><h1 id="9891" class="ma lc iq bd ld mb mc md lg me mf mg lj mh mi mj lm mk ml mm lp mn mo mp ls mq bi translated">参考</h1><ul class=""><li id="601d" class="mr ms iq kf b kg lu kk lv ko nq ks nr kw ns la nl mx my mz bi translated">笑话<a class="ae kc" href="https://github.com/atlassian/jest-in-case" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="2c4b" class="mr ms iq kf b kg na kk nb ko nc ks nd kw ne la nl mx my mz bi translated">詹姆斯·凯尔<a class="ae kc" href="https://jamie.build/jest-in-case.html" rel="noopener ugc nofollow" target="_blank">网站</a></li></ul><blockquote class="nt"><p id="fc38" class="nu nv iq bd nw nx ny nz oa ob oc la dk translated"><em class="od">原文章发表在我的</em> <a class="ae kc" href="https://tekloon.dev/how-to-write-well-organized-unit-test" rel="noopener ugc nofollow" target="_blank"> <em class="od">博客</em> </a> <em class="od">。</em></p></blockquote></div></div>    
</body>
</html>