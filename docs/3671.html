<html>
<head>
<title>Tic Tac Toe: React, TypeScript, XState, fp-ts &amp; CSS Grid</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">井字游戏脚趾:反应，打字脚本，XState，fp-ts &amp; CSS网格</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/tic-tac-toe-react-typescript-xstate-fp-ts-css-grid-cbbb6455cbf7?source=collection_archive---------6-----------------------#2020-10-16">https://javascript.plainenglish.io/tic-tac-toe-react-typescript-xstate-fp-ts-css-grid-cbbb6455cbf7?source=collection_archive---------6-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b7d6" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">一系列井字游戏</h2><div class=""/><div class=""><h2 id="341b" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">第一部分</h2></div><p id="7873" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">嗨！我正在用我能想到的最简单的领域，井字游戏探索技术，看看这个系列:</p><ol class=""><li id="0d32" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lp lq lr ls bi translated">井字游戏脚趾:反应，打字脚本，XState，fp-ts &amp; CSS网格(本文)-<a class="ae lt" href="https://medium.com/codingedgar/tes-en-l%C3%ADnea-react-typescript-xstate-fp-ts-css-grid-esp-1373236189d1?source=friends_link&amp;sk=acd495a60f69e43c68e3f6970fa9da60" rel="noopener">西班牙语</a></li><li id="6570" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj lp lq lr ls bi translated"><a class="ae lt" href="https://medium.com/javascript-in-plain-english/html-canvas-is-fire-1320b2b40c37?source=friends_link&amp;sk=ac1326ad70cbc7ff71128bb341477e20" rel="noopener">HTML Canvas is fire</a>——espa ol</li></ol><p id="69bb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在本文中，我们将使用<a class="ae lt" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">reactor</a>、<a class="ae lt" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> Typescript </a>、<a class="ae lt" href="http://xstate.js.org/" rel="noopener ugc nofollow" target="_blank">xsstate</a>、<a class="ae lt" href="https://gcanti.github.io/fp-ts/" rel="noopener ugc nofollow" target="_blank"> fp-ts </a>和<a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout" rel="noopener ugc nofollow" target="_blank"> CSS Grid </a>来构建井字游戏。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/ece5f8d13be876d9f7cc8390d8b37489.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/1*BnODmW3XWTmSfKPBiYL52Q.gif"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk">demo</figcaption></figure><h1 id="f581" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">0.先决条件</h1><ul class=""><li id="cc60" class="lk ll iq kq b kr nd ku ne kx nf lb ng lf nh lj ni lq lr ls bi translated"><a class="ae lt" href="https://en.wikipedia.org/wiki/JavaScript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>和<a class="ae lt" href="https://en.wikipedia.org/wiki/TypeScript" rel="noopener ugc nofollow" target="_blank">type script</a>t的概念。</li><li id="cb6b" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/HTML" rel="noopener ugc nofollow" target="_blank"> HTML </a>和<a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Reference" rel="noopener ugc nofollow" target="_blank"> CSS </a>的概念。</li><li id="cbe9" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><a class="ae lt" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>安装完毕。</li><li id="58f1" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><a class="ae lt" href="https://www.npmjs.com/get-npm" rel="noopener ugc nofollow" target="_blank"> npm </a>或<a class="ae lt" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank">纱线</a>安装完毕。</li><li id="1a06" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><a class="ae lt" href="https://www.quora.com/q/ukcyqvwilydvkdpe/What-is-Terminal" rel="noopener ugc nofollow" target="_blank">端子</a>的概念。</li><li id="4983" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">安装了代码编辑器(如<a class="ae lt" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> vscode </a>)。</li><li id="410d" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">任何绘图程序。</li></ul><h1 id="6d39" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">1.资产</h1><p id="b5bc" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">首先，我们需要一些<a class="ae lt" href="https://www.quora.com/q/ukcyqvwilydvkdpe/What-are-assets-in-game-development" rel="noopener ugc nofollow" target="_blank">资产</a>来制作我们的小游戏。我们需要一个<strong class="kq ja">棋盘</strong>、<strong class="kq ja">玩家</strong> ( <strong class="kq ja"> X </strong>和<strong class="kq ja"> O </strong>)，以及胜利者的<strong class="kq ja">线</strong>(水平、垂直和对角线)。</p><p id="12a3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">使用任何绘图程序，在我的情况下，我会使用Photoshop。</p><p id="1b88" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">制作一个1080x1080 px的画布，画一些线，每条线在各自的图层中，导出每张图片。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/dd9a18b6791f197b3f9ba9638599f0da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGHYciDw0kp0i0qJ-L3e4Q.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk">Assets in Photoshop</figcaption></figure><h2 id="105e" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">格子</h2><p id="78de" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">将<strong class="kq ja">板</strong>导出为1080x1080 px的图像。</p><h2 id="711c" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">演员</h2><p id="dfb1" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">一定要导出每个<strong class="kq ja">玩家</strong>的字母<strong class="kq ja"> X </strong>和<strong class="kq ja"> O </strong>的大小(大约250x250 px)，以编程的方式将他们放置在网格中，</p><h2 id="61a8" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">线</h2><p id="9fa9" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">将每一行导出为1080x1080像素的图像。</p><p id="79c4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我的第一次尝试中，我分别导出了每个图层，但是这使得图像的大小与形状相同，例如，水平线不是1080x1080 px，而是1080x10 px，然后需要放置。</p><p id="4c89" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们不想过多关注<strong class="kq ja">线条</strong>的放置，所以一定要导出整个图像，切换每个图层的可见性，这样，每个图像都是1080x1080，当在屏幕上可见时，它被完美地放置，现在我们可以专注于打开和关闭图像。</p><h1 id="ff2a" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">2.引导反应和类型脚本</h1><p id="9273" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">现在我们有了资产，我们可以开始编码了。</p><p id="f2f7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，让我们用<a class="ae lt" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank"> Create React App </a>引导React项目，在您的终端中写入:</p><pre class="ma mb mc md gt oc od oe of aw og bi"><span id="bd15" class="nr mm iq od b gy oh oi l oj ok">mkdir example1 <br/>cd example1<br/>yarn global add create-react-app<br/>create-react-app frontend --template typescript<br/>yarn start</span></pre><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/dc7ef27fcdf805744ee0585a5cd807f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*ig7VhTrQqQwVlAg7HUMhqA.gif"/></div></figure><p id="2a1d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这需要一段时间，但是很简单，现在您已经有了一个在<code class="fe om on oo od b">localhost:3000</code>中运行Typescript的React项目。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi op"><img src="../Images/3b57e5ec419265e2bfb231bb01679b20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*y0hNQBOzcm5FcDzOXp413Q.gif"/></div></div></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/66a966252c5b5627afe2777209c77440.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*UJlwsc4s0GaAoh_iFTZ_SQ.png"/></div></figure><h1 id="f591" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">3.域和状态机类型</h1><p id="b208" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">现在让我们从领域建模开始，我将首先向您展示要点，然后我将逐行分解它。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="6ab5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们从模拟我们的基本类型开始:</p><ul class=""><li id="9e8b" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj ni lq lr ls bi translated"><code class="fe om on oo od b">1</code>选手:<code class="fe om on oo od b">X</code> &amp; <code class="fe om on oo od b">O</code>的<code class="fe om on oo od b"><a class="ae lt" href="https://www.typescriptlang.org/docs/handbook/unions-and-intersections.html#union-types" rel="noopener ugc nofollow" target="_blank">Union</a></code>。</li><li id="58da" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">3</code>坐标:<code class="fe om on oo od b">1</code>、<code class="fe om on oo od b">2</code>、<code class="fe om on oo od b">3</code>中的<code class="fe om on oo od b">Union</code>，而不是<code class="fe om on oo od b">number</code>来限制可能情况的数量。</li><li id="3cc5" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">5</code>坐标:行列记录。</li><li id="40b1" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">7</code>单元格状态:<code class="fe om on oo od b">Playable</code>和<code class="fe om on oo od b">Played</code>中的<code class="fe om on oo od b">Union</code>，<code class="fe om on oo od b">Playable</code>描述可能被点击的单元格，以及<code class="fe om on oo od b">Played</code>播放该单元格的模特。</li><li id="155f" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">9</code> Cell:是<code class="fe om on oo od b">Coordinates</code>和<code class="fe om on oo od b">CellState</code>的<code class="fe om on oo od b"><a class="ae lt" href="https://www.typescriptlang.org/docs/handbook/unions-and-intersections.html#intersection-types" rel="noopener ugc nofollow" target="_blank">Intersection</a></code>。</li><li id="f18d" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">11</code>板:我们可以将我们的<code class="fe om on oo od b">Board</code>建模为一个<code class="fe om on oo od b">Cells</code>的数组，但是让我们利用元组来建模有限数量的单元，9。</li><li id="ac0d" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">13</code> ResultType:这是游戏所有可能的结果。</li><li id="d377" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">24</code>结果:<code class="fe om on oo od b">Result</code>将是匹配的结果，在8个可能的位置中的任何一个位置，它要么是一个<code class="fe om on oo od b">Draw</code>要么是连续的3个。</li></ul><h2 id="dee9" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">x状态</h2><p id="57e0" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">我们可以将XState简化为一个状态管理库(是的，这意味着它可以替代<a class="ae lt" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>，但是它能做的更多。)</p><p id="47c0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你了解有限状态机，那么理解这个库就容易多了，我推荐你去看看他们的文档，里面很好地解释了它背后的概念，以及它需要解决的问题。</p><blockquote class="ot ou ov"><p id="c2fa" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">形式上，有限状态机有五个部分:</p><p id="382a" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">-有限数量的状态</p><p id="e304" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">-有限数量的事件</p><p id="d2ea" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">-初始状态</p><p id="8b48" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">-在给定当前状态和事件的情况下确定下一个状态的转移函数</p><p id="5d83" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">-一组(可能是空的)最终状态</p></blockquote><p id="8c39" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">XState不仅仅是有限状态机，它是状态图和Actor模型的实现，但是我们将只使用它的有限状态机部分。</p><p id="aca3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在我们有了基本类型，让我们构建我们的状态机类型，它们是3个:<a class="ae lt" href="https://xstate.js.org/docs/guides/context.html#context" rel="noopener ugc nofollow" target="_blank">上下文</a>、<a class="ae lt" href="https://xstate.js.org/docs/guides/states.html#states" rel="noopener ugc nofollow" target="_blank">状态模式</a>和<a class="ae lt" href="https://xstate.js.org/docs/guides/events.html#sending-events" rel="noopener ugc nofollow" target="_blank">事件</a>。</p><h2 id="2045" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">事件</h2><p id="f282" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">我们的机器将接受两个事件，<code class="fe om on oo od b">Played</code>和<code class="fe om on oo od b">Restarted</code>，每个事件都非常详细地描述了它们所做的事情。</p><ul class=""><li id="c379" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj ni lq lr ls bi translated"><code class="fe om on oo od b">Played</code>事件应将单元状态从<code class="fe om on oo od b">Playable</code>更改为<code class="fe om on oo od b">Played</code>。</li><li id="bb3d" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><code class="fe om on oo od b">Restarted</code>事件应该会重启游戏。</li></ul><h2 id="d26e" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">语境</h2><p id="41af" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">上下文代表了我们机器的无界的一面，就像Redux Store一样。</p><p id="b0bf" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将有3个属性，<code class="fe om on oo od b">matchScore</code>，<code class="fe om on oo od b">board</code>，<code class="fe om on oo od b">result</code>。</p><p id="cf0e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将使用<code class="fe om on oo od b">matchScore</code>来代表每个<code class="fe om on oo od b">ResultTypes</code>分数，就像游戏的9种可能结局中的每一种的累加器，当任何累加器达到3时，游戏结束，或者如果<code class="fe om on oo od b">Draw</code>累加器达到9。</p><p id="af35" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe om on oo od b">board</code>表示9个单元格的状态，<code class="fe om on oo od b">result</code>是一个<code class="fe om on oo od b"><a class="ae lt" href="https://gcanti.github.io/fp-ts/modules/Option.ts.html" rel="noopener ugc nofollow" target="_blank">Option</a></code>类型(可空类型的容器)，表示游戏结束后结果的存在(或不存在)。</p><p id="bfa5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">那么<code class="fe om on oo od b">Result</code>要么是<code class="fe om on oo od b">Draw</code>要么不是一个玩家获胜的<code class="fe om on oo od b">Draw</code>。</p><h2 id="2ce6" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">(计划或理论的)纲要</h2><p id="e69c" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">最后，我们的状态模式，它将模拟我们机器的有限部分(Redux所缺少的)。</p><p id="4558" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们会有三种状态:</p><ul class=""><li id="1bc7" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj ni lq lr ls bi translated"><strong class="kq ja"> X </strong> : <strong class="kq ja">玩家X </strong>轮到出场。</li><li id="0b03" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><strong class="kq ja"> O </strong> : <strong class="kq ja">玩家O </strong>轮到玩了。</li><li id="922e" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated"><strong class="kq ja">完成</strong>:游戏完成。</li></ul><h1 id="c62e" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">4.状态机</h1><p id="ff1c" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">现在让我们为我们的机器行为建模，看看要点，然后检查深入的描述。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="00d8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这是我们机器的配置，<code class="fe om on oo od b">strict</code>使我们的机器在一个状态和其他更严格的行为中没有处理一个事件时抛出。</p><p id="c05e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe om on oo od b">initial</code>代表我们机器初始状态的名称，我们放置了<code class="fe om on oo od b">X</code>，意思是<strong class="kq ja">玩家X </strong>总是先开始。</p><p id="a75d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe om on oo od b">context</code>与<code class="fe om on oo od b">const</code> <code class="fe om on oo od b">DEFAULT_CONTEXT</code>相同，我们可以内联编写我们机器的默认上下文，但是我们在两个地方需要它，这里和当我们重启游戏时，所以让我们在不同的机器中编写它。</p><p id="5bc0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在有趣的是，美国:</p><h2 id="5550" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">X &amp; O状态</h2><p id="a304" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">这些状态几乎是相同的，所以我将它们描述为相同的。</p><p id="df7a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">状态可以有很多属性，但是我们只使用两个<code class="fe om on oo od b"><a class="ae lt" href="https://xstate.js.org/docs/guides/transitions.html#eventless-transitions" rel="noopener ugc nofollow" target="_blank">always</a></code>和<code class="fe om on oo od b"><a class="ae lt" href="https://xstate.js.org/docs/guides/transitions.html#selecting-enabled-transitions" rel="noopener ugc nofollow" target="_blank">on</a></code>。</p><blockquote class="ot ou ov"><p id="d406" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated">无事件转换是指当机器处于定义的状态，且其<code class="fe om on oo od b">cond</code>保护评估为<code class="fe om on oo od b">true</code>时，<strong class="kq ja">总是</strong>发生的转换。在处理任何其他事件之前，总是在第一次进入状态时检查它们。无事件转换是在状态节点的<code class="fe om on oo od b">always</code>属性上定义的。</p></blockquote><p id="2002" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我们的例子中，<code class="fe om on oo od b">always</code>检查条件<code class="fe om on oo od b">IS_DONE</code>，如果是，它转换到<code class="fe om on oo od b">DONE</code>状态。</p><p id="bf79" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们定义的另一个转换在我们接收到<code class="fe om on oo od b">PLAYED</code>事件时被评估，并且仅当播放有效时(单元格不是<code class="fe om on oo od b">PLAYED</code>)；如果有效，那么我们将更新我们的<code class="fe om on oo od b">Context</code>的<code class="fe om on oo od b">matchScore</code>、<code class="fe om on oo od b">board</code>和<code class="fe om on oo od b">result</code>，并过渡到另一个玩家回合。</p><h2 id="aaea" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">完成状态</h2><p id="8bb7" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">如果机器进入<code class="fe om on oo od b">DONE</code>状态，那么我们将只对<code class="fe om on oo od b">RESTARTED</code>事件做出反应，分配一个默认上下文(与机器的初始化相同)，并返回到<strong class="kq ja">玩家X </strong>回合。</p><h1 id="f9a9" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">5.用户界面</h1><p id="db49" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">现在我们已经定义了我们的行为，我们可以开始做我们的UI了！</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="c654" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们使用<a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout" rel="noopener ugc nofollow" target="_blank"> CSS网格</a>来构建我们的UI。</p><p id="54c4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，我们将定义我们的网格，3列，棋盘的每列一个，5行，1行显示回合或赢家，3行显示棋盘的行，1行显示结果按钮。</p><h2 id="39e7" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">标题</h2><p id="1a34" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">我们的标题依赖于<code class="fe om on oo od b">result</code>值，让我们记住，它的类型是<code class="fe om on oo od b">Option&lt;Result&gt;</code>。</p><p id="adcb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了决定显示什么值，我们将<code class="fe om on oo od b">fold</code>这个值，你问<code class="fe om on oo od b">fold</code>什么？</p><blockquote class="ot ou ov"><p id="03fd" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated"><a class="ae lt" href="https://gcanti.github.io/fp-ts/modules/Option.ts.html#fold" rel="noopener ugc nofollow" target="_blank"> Fold </a>:取一个默认值、一个函数和一个<code class="fe om on oo od b">Option</code>值，如果<code class="fe om on oo od b">Option</code>值为<code class="fe om on oo od b">None</code>则返回默认值，否则函数应用于<code class="fe om on oo od b">Some</code>内的值并返回结果。</p></blockquote><p id="d60e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">所以，默认值，意味着，“没有结果的时候怎么办”，在我们的例子中，我们将显示玩家的回合(<code class="fe om on oo od b">22</code>)。</p><p id="7505" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">当我们有一个<code class="fe om on oo od b">result</code>的时候，那就要看它是不是一个<code class="fe om on oo od b">Draw</code>，如果是我们显示<code class="fe om on oo od b">'Draw'</code>T3，否则，我们就显示哪个玩家赢了<code class="fe om on oo od b">25</code>。</p><h2 id="f3ee" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">格子</h2><p id="8c34" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">电网是我们的第一资产；我们将始终把它显示为图像，而不是可拖动的。</p><h2 id="0bd4" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">细胞</h2><p id="d720" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">下一部分是细胞。</p><p id="dbe7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">单元格是9 <code class="fe om on oo od b">divs</code>，它将发送<code class="fe om on oo od b">PLAYED</code>的事件，如果单元格被播放，那么它将显示玩家谁播放了资产。</p><blockquote class="pa"><p id="04c7" class="pb pc iq bd pd pe pf pg ph pi pj lj dk translated">一个观察:我们不需要运行验证来确定我们是否应该发送<code class="fe om on oo od b">PLAYED</code>事件，这要感谢我们在机器中描述的所有逻辑。</p></blockquote><h2 id="0431" class="nr mm iq bd mn ns pk dn mr nu pl dp mv kx pm nx mx lb pn nz mz lf po ob nb iw bi translated">结果行</h2><p id="bfc0" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">现在让我们渲染我们的线条。</p><p id="508a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">和我们处理标题一样，我们将<code class="fe om on oo od b">fold</code>第<code class="fe om on oo od b">result</code>个，但是首先，让我们考虑结果。</p><p id="6012" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">当比赛抽签时，没有线显示，所以我们可以认为<code class="fe om on oo od b">Draw</code>没有结果。</p><p id="31d2" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们需要一个只在有<code class="fe om on oo od b">some</code>值时运行的函数，并且允许我们在有<code class="fe om on oo od b">Draw</code>时返回<code class="fe om on oo od b">none</code>，在有<code class="fe om on oo od b">Draw</code>以外的值时返回<code class="fe om on oo od b">some</code>。</p><p id="bfbb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们需要类似于<code class="fe om on oo od b"><a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap" rel="noopener ugc nofollow" target="_blank">flatMap</a></code>的东西，但是对于<code class="fe om on oo od b">Option</code>类型，谢天谢地，fp-ts有<code class="fe om on oo od b">chain</code>:</p><blockquote class="ot ou ov"><p id="19ba" class="ko kp ow kq b kr ks ka kt ku kv kd kw ox ky kz la oy lc ld le oz lg lh li lj ij bi translated"><a class="ae lt" href="https://gcanti.github.io/fp-ts/modules/Option.ts.html#chain" rel="noopener ugc nofollow" target="_blank">链</a>:按顺序组合计算，使用一个计算的返回值来确定下一个计算。</p></blockquote><p id="f588" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">有点神秘，你不觉得吗？让我再试一次:</p><p id="14ad" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">当我想只在成功分支中运行一个函数并返回一个相同类型容器的新值时，我使用<code class="fe om on oo od b">chain</code>，但不是嵌套的(不是<code class="fe om on oo od b">Option&lt;Option&lt;T&gt;&gt;</code>而是<code class="fe om on oo od b">Option&lt;T&gt;</code>)。</p><p id="58f8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果<code class="fe om on oo od b">result</code>是<code class="fe om on oo od b">none</code>或者<code class="fe om on oo od b">result</code>是<code class="fe om on oo od b">some({result: 'Draw',...})</code>(将通过<code class="fe om on oo od b">chain</code>操作转换为<code class="fe om on oo od b">none</code>)，那么我们返回<code class="fe om on oo od b">null</code>，不渲染任何线条。</p><p id="0756" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果结果不是这些值，我们将结果类型映射到我们的行(<code class="fe om on oo od b">diagonal1</code>、<code class="fe om on oo od b">column1</code>等)。).</p><h2 id="51f9" class="nr mm iq bd mn ns nt dn mr nu nv dp mv kx nw nx mx lb ny nz mz lf oa ob nb iw bi translated">重新开始</h2><p id="723a" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">最后，只玩一个游戏太无聊了，所以我们展示了重启按钮！</p><p id="7bea" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">就像我们以前做过的那样，我们将<code class="fe om on oo od b">fold</code>越过<code class="fe om on oo od b">result</code> : <code class="fe om on oo od b">none</code>？然后<code class="fe om on oo od b">null</code>、<code class="fe om on oo od b">some</code>？然后是我们的按钮。</p><p id="8d8e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我们的按钮内部，我们将发送<code class="fe om on oo od b">RESTARTED</code>事件<code class="fe om on oo od b">onClick</code>，我们的机器将完成所有的魔术，然后React将重新呈现我们的功能组件，并显示与开始时相同的匹配。</p><h1 id="7eb2" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">7.参考</h1><p id="f0bc" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">检查整个结果文件<code class="fe om on oo od b">App.tsx</code>:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="669a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果想看完整个项目，还可以访问:<a class="ae lt" href="https://github.com/codingedgar/TicTacToe" rel="noopener ugc nofollow" target="_blank">https://github.com/codingedgar/TicTacToe</a>，搜索<code class="fe om on oo od b">Example1</code>。</p><h1 id="227a" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">8.反思我们的良好做法</h1><p id="a50c" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">我希望您观察到了一些好的实践:</p><ol class=""><li id="a084" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lp lq lr ls bi translated">我们用过去时态宣布我们的事件，因为它们发生了(<code class="fe om on oo od b">PLAYED</code>，<code class="fe om on oo od b">RESTARTED</code>)。</li><li id="e683" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj lp lq lr ls bi translated">我们声明了我们所有的行为，并且在一个地方声明了我们的状态机，而不是用<code class="fe om on oo od b">UI</code>来分散逻辑。</li><li id="06e9" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj lp lq lr ls bi translated">我们试图约束我们的领域建模，以尽可能避免不可能的状态。</li><li id="b053" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj lp lq lr ls bi translated">你能找到其他的吗？</li></ol><h1 id="9784" class="ml mm iq bd mn mo mp mq mr ms mt mu mv kf mw kg mx ki my kj mz kl na km nb nc bi translated">9.其他考虑</h1><p id="fbae" class="pw-post-body-paragraph ko kp iq kq b kr nd ka kt ku ne kd kw kx nj kz la lb nk ld le lf nl lh li lj ij bi translated">我想实现井字游戏一百万种探索技术的方法；这是我能想到的最简单的型号。</p><p id="1b44" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在下一个例子中，让我知道您想要我使用哪些库或技术，我已经考虑了一些不同的挑战:</p><ul class=""><li id="6831" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj ni lq lr ls bi translated">如果每个细胞本身就是一个状态机会怎么样？</li><li id="de08" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">使用<a class="ae lt" href="https://www.learnrxjs.io/" rel="noopener ugc nofollow" target="_blank"> rxjs </a>会是什么样子？</li><li id="8959" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">那么<a class="ae lt" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank">棱角</a>、<a class="ae lt" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue </a>、<a class="ae lt" href="https://svelte.dev/" rel="noopener ugc nofollow" target="_blank">苗条</a>和<a class="ae lt" href="https://emberjs.com/" rel="noopener ugc nofollow" target="_blank">余烬</a>呢？</li><li id="c021" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">编译成js langs、<a class="ae lt" href="https://elm-lang.org/" rel="noopener ugc nofollow" target="_blank"> Elm </a>、<a class="ae lt" href="https://fable.io/" rel="noopener ugc nofollow" target="_blank">寓言</a>、<a class="ae lt" href="https://www.purescript.org/" rel="noopener ugc nofollow" target="_blank"> PureScript </a>、<a class="ae lt" href="https://www.scala-js.org/" rel="noopener ugc nofollow" target="_blank"> Scala.js </a>怎么样？</li><li id="d88e" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">为什么要创造资产？那么<a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API" rel="noopener ugc nofollow" target="_blank"> canvas </a>和<a class="ae lt" href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API" rel="noopener ugc nofollow" target="_blank"> WebGL </a>呢？</li><li id="9cee" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">在线服务器用<a class="ae lt" href="https://deno.land/" rel="noopener ugc nofollow" target="_blank">号</a>🤩、<a class="ae lt" href="https://fsharp.org/" rel="noopener ugc nofollow" target="_blank"> F# </a>、<a class="ae lt" href="https://www.scala-lang.org/" rel="noopener ugc nofollow" target="_blank"> scala </a>？</li><li id="5b3e" class="lk ll iq kq b kr lu ku lv kx lw lb lx lf ly lj ni lq lr ls bi translated">那deploy呢，<a class="ae lt" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>，<a class="ae lt" href="https://www.digitalocean.com/" rel="noopener ugc nofollow" target="_blank">数字海洋</a>，<a class="ae lt" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS </a>，<a class="ae lt" href="https://azure.microsoft.com/" rel="noopener ugc nofollow" target="_blank"> Azure </a>，<a class="ae lt" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Cloud </a>？</li></ul><p id="c625" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我渴望为你制作所有这些技术的例子，让我知道你接下来想看哪一个🔥。</p></div><div class="ab cl pp pq hu pr" role="separator"><span class="ps bw bk pt pu pv"/><span class="ps bw bk pt pu pv"/><span class="ps bw bk pt pu"/></div><div class="ij ik il im in"><p id="0419" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你喜欢这篇文章，也许你会喜欢<a class="ae lt" href="http://eepurl.com/hg7AeP" rel="noopener ugc nofollow" target="_blank">订阅我的时事通讯</a>和我的更多作品:<a class="ae lt" href="https://medium.com/javascript-in-plain-english/the-6tools-that-changed-javascript-for-me-3ee1faf40585" rel="noopener">为我改变JavaScript的6个工具</a>、<a class="ae lt" href="https://medium.com/javascript-in-plain-english/you-should-never-use-an-arrow-function-in-any-of-these-two-situations-8bc2fbbc39b8" rel="noopener">永远不要使用箭头函数的两种情况</a>，以及<a class="ae lt" href="https://medium.com/javascript-in-plain-english/how-f-made-me-appreciate-javascript-227260796b70" rel="noopener">F #如何让我欣赏JavaScript </a>，希望我的故事能给你带来一些价值。</p></div></div>    
</body>
</html>