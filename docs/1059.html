<html>
<head>
<title>JavaScript Events Handlers — onanimationstart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript事件处理程序— onanimationstart</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-events-handlers-onanimationstart-bdcbe19b8ffa?source=collection_archive---------7-----------------------#2020-01-22">https://javascript.plainenglish.io/javascript-events-handlers-onanimationstart-bdcbe19b8ffa?source=collection_archive---------7-----------------------#2020-01-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn js jt ju jv gh gi paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gh gi jr"><img src="../Images/9e5bea95bdc97429be921a26cb99652a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3aS9ACemtEhNKKJj"/></div></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">Photo by <a class="ae kg" href="https://unsplash.com/@thenightstxlker?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tamara Gore</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="faad" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在JavaScript中，事件是应用程序中发生的动作。它们是由各种事情触发的，比如输入、提交表单、调整大小等元素变化，或者应用程序运行时发生的错误等。我们可以分配一个事件处理器来处理这些事件。发生在DOM元素上的事件可以通过为相应事件的DOM对象的属性分配一个事件处理程序来处理。在这一部分，我们仔细看看<code class="fe jn jo jp jq b">onanimationstart</code>事件处理程序和<code class="fe jn jo jp jq b">animationstart</code>事件。</p><h1 id="9f18" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">onanimationstart</h1><p id="0111" class="pw-post-body-paragraph kh ki iq kj b kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le ij bi translated">如果我们想处理CSS动画开始播放时的情况，也就是当<code class="fe jn jo jp jq b">animationstart</code>事件被触发时，我们可以给<code class="fe jn jo jp jq b">onanimation</code>属性分配我们自己的事件处理函数。我们可以使用CSS创建一个动画，通过首先创建HTML元素来动画化一个盒子，这些元素将像下面的代码一样被动画化:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="3803" class="mq lg iq jq b gy mr ms l mt mu">&lt;div id='container'&gt;<br/>  &lt;div id='box'&gt;</span><span id="5d1a" class="mq lg iq jq b gy mv ms l mt mu">  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="d1c3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后，我们向元素添加一些样式，并用CSS创建动画，如以下代码所示:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="7815" class="mq lg iq jq b gy mr ms l mt mu">#box {<br/>  width: 100px;<br/>  height: 100px;<br/>  left: 0;<br/>  top: 0;<br/>  border: 1px solid red;<br/>  margin: 0;<br/>  position: relative;<br/>  background-color: red;<br/>  display: block;<br/>  justify-content: center;<br/>  animation: 5s resizeBox;<br/>}</span><span id="7696" class="mq lg iq jq b gy mv ms l mt mu">#container {<br/>  height: 500px;<br/>}</span><span id="48b1" class="mq lg iq jq b gy mv ms l mt mu"><a class="ae kg" href="http://twitter.com/keyframes" rel="noopener ugc nofollow" target="_blank">@keyframes</a> resizeBox {<br/>  from {<br/>    transform: translateX(100%) scaleX(3);<br/>  }</span><span id="8b53" class="mq lg iq jq b gy mv ms l mt mu">  to {<br/>    transform: translateX(0) scaleX(1);<br/>  }<br/>}</span></pre><p id="7278" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在上面的代码中，我们将框的大小改为100像素乘100像素。，将填充颜色更改为红色，然后将框放在我们页面的左上角。然后我们创建了<code class="fe jn jo jp jq b">resizeBox</code>动画，将盒子水平缩放3倍，然后缩小到原始尺寸。我们重复这个动作5秒钟。在CSS代码中创建动画后，我们可以使用以下代码将事件处理程序设置为<code class="fe jn jo jp jq b">onanimationstart</code>属性:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="2938" class="mq lg iq jq b gy mr ms l mt mu">document.onanimationstart = (event) =&gt; {<br/>  console.log(event);<br/>  console.log('Animation starts');<br/>};</span></pre><p id="720b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">当上面的事件处理函数运行时，我们在事件处理函数的参数中得到<code class="fe jn jo jp jq b">AnimationEvent</code>对象。它从具有以下属性的<code class="fe jn jo jp jq b">Event</code>对象继承属性:</p><ul class=""><li id="6ed1" class="mw mx iq kj b kk kl ko kp ks my kw mz la na le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">bubbles</code> —是一个只读布尔属性，指示事件是否在DOM树中冒泡。</li><li id="ca22" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">cancelBubble </code> —是<code class="fe jn jo jp jq b">stopPropagation</code>方法的历史别名。在从事件处理程序返回之前将其值设置为<code class="fe jn jo jp jq b">true</code>可以防止事件的传播。</li><li id="33da" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">cancelable</code> —只读布尔属性，表示事件是否可以取消。</li><li id="a7b5" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">composed </code> —是一个只读布尔属性，指示事件是否可以跨越阴影DOM和常规DOM之间的边界。</li><li id="c0e0" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">currentTarget</code> —只读属性，引用当前注册的事件目标。这是当前计划将事件发送到的对象，但有可能在重定目标的过程中已经发生了变化。</li><li id="ea89" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">deepPath</code> —是事件冒泡通过的DOM节点数组。</li><li id="324e" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">defaultPrevented</code> —是一个只读的布尔属性，指示是否在事件上调用了<code class="fe jn jo jp jq b">event.preventDefault()</code>。</li><li id="80f3" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">eventPhase</code> —只读属性，表示正在处理事件流的哪个阶段。</li><li id="0d14" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">explicitOriginalTarget </code> —是只读属性，具有事件的显式原始目标。该属性仅在Mozilla浏览器中可用。</li><li id="6791" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">originalTarget </code> —是一个只读属性，在任何重定目标之前具有事件的原始目标。该属性仅在Mozilla浏览器中可用。</li><li id="3efa" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">returnValue </code> —是由Internet Explorer引入的历史属性，最终被纳入DOM规范，以确保现有站点继续工作。理想情况下，您应该尝试使用<code class="fe jn jo jp jq b">preventDefault()</code>和<code class="fe jn jo jp jq b">defaultPrevented </code>来取消事件并检查事件是否被取消，但是如果您选择这样做，也可以使用returnValue。</li><li id="e514" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">srcElement </code> —是旧版本Microsoft Internet Explorer中用于<code class="fe jn jo jp jq b">target</code>的非标准别名，出于web兼容性目的，其他一些浏览器也开始支持该别名。</li><li id="04d7" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">target </code> —只读属性，引用事件最初调度到的目标。</li><li id="acab" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">timeStamp </code> —只读，包含事件的创建时间(以毫秒为单位)。根据规范，该值是自1970年1月1日以来的时间，但实际上浏览器的定义各不相同。</li><li id="b192" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">type </code> —只读属性，具有事件的名称(不区分大小写)。</li><li id="fca6" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">isTrusted </code> —是一个只读属性，指示事件是由用户交互后的浏览器发起的，还是由使用类似<code class="fe jn jo jp jq b">initEvent</code>的事件创建方法的脚本发起的。</li></ul><figure class="mi mj mk ml gt jv gh gi paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gh gi nk"><img src="../Images/31d3f82a5aa4c035ba614b0674e98ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wxjMriZYczdTDqUF"/></div></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">Photo by <a class="ae kg" href="https://unsplash.com/@uh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matt Popovich</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="24f5" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">上面的列表是部分属性。它只包含<code class="fe jn jo jp jq b">Event</code>对象的值属性。<code class="fe jn jo jp jq b">AnimationEvent</code>继承属性并添加自己的属性，如下所示:</p><ul class=""><li id="3fc0" class="mw mx iq kj b kk kl ko kp ks my kw mz la na le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">animationName</code> —只读属性，返回包含CSS动画的动画名称值的字符串。</li><li id="e9ad" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">elapsedTime</code> —只读浮点属性，具有从事件被触发时起动画已经运行的时间量(以秒为单位)。对于<code class="fe jn jo jp jq b">animationstart</code>事件，<code class="fe jn jo jp jq b">elapsedTime</code>为0.0，除非<code class="fe jn jo jp jq b">animation-delay</code> CSS属性为负值，在这种情况下，事件将被触发，而<code class="fe jn jo jp jq b">elapsedTime</code>为负一乘以延迟。</li><li id="cafb" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">pseudoElement</code> —以<code class="fe jn jo jp jq b">::</code>开头的字符串只读属性，包含运行动画的伪元素的名称。如果动画不是在伪元素中运行，那么这个属性的值将是一个空字符串。</li></ul><p id="a8f2" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">如果我们运行上面的代码，我们应该会记录下面的<code class="fe jn jo jp jq b">AnimationEvent</code>对象:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="3cd6" class="mq lg iq jq b gy mr ms l mt mu">animationName: "resizeBox"<br/>bubbles: true<br/>​cancelBubble: false<br/>​cancelable: false<br/>​composed: false<br/>​currentTarget: null<br/>​defaultPrevented: false<br/>​elapsedTime: 0<br/>​eventPhase: 0<br/>​explicitOriginalTarget: &lt;div id="box"&gt;<br/>​isTrusted: true<br/>​originalTarget: &lt;div id="box"&gt;<br/>​pseudoElement: ""<br/>​returnValue: true<br/>​srcElement: &lt;div id="box"&gt;​target: &lt;div id="box"&gt;<br/>​timeStamp: 297<br/>​type: "animationstart"</span></pre><p id="a031" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">正如我们看到的,<code class="fe jn jo jp jq b">animationName</code>是<code class="fe jn jo jp jq b">“resizeBox”</code>,这是我们CSS动画的名字。因为我们在一个<code class="fe jn jo jp jq b">onanimationstart</code>事件处理器中记录这个<code class="fe jn jo jp jq b">Event</code>对象，所以<code class="fe jn jo jp jq b">elapsedTime</code>为0，并且我们的动画没有负延迟。<code class="fe jn jo jp jq b">pseudoElement</code>是一个空字符串，因为我们没有在任何伪元素中运行我们的动画。</p><p id="ce46" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">该属性和<code class="fe jn jo jp jq b">animationstart</code>正在进行中。事件处理程序只在Firefox中运行。它不能在Chrome或其他流行的现代浏览器中运行。这意味着如果我们想让它在Firefox之外的任何东西上工作，就不应该在生产环境中依赖它。</p><p id="8ff6" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">CSS动画开始时会触发<code class="fe jn jo jp jq b">animationstart</code>事件。到目前为止，它只在Firefox中触发，标准化该事件的工作正在进行中。这对于获取动画开始运行时的开始事件和经过时间以及正在运行的动画的名称非常方便。</p></div></div>    
</body>
</html>