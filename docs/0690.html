<html>
<head>
<title>A guide to var, let and const in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的var、let和const指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-guide-to-var-let-and-const-in-js-25c23e7859fe?source=collection_archive---------6-----------------------#2019-11-26">https://javascript.plainenglish.io/a-guide-to-var-let-and-const-in-js-25c23e7859fe?source=collection_archive---------6-----------------------#2019-11-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8b05fe1b030dcd11ba7549d87d1d8aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NgXa6MkqwQpQa1Bi"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@cgower?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christopher Gower</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2e8e" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">介绍</h1><p id="eb10" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在Javascript中有三种方法来声明变量:<code class="fe lz ma mb mc b">var</code>、<code class="fe lz ma mb mc b">let</code>和<code class="fe lz ma mb mc b">const</code>——但是为什么呢？为了理解这一点，我们应该先快速浏览一下这门语言的历史。</p><h1 id="678c" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">一堂非常简短的历史课</h1><p id="502a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">那是1995年，web是完全静态的，每次交互都需要重新加载整个页面。计算机最多只能配备最高时钟速度为<code class="fe lz ma mb mc b">450Mhz</code>的单核<code class="fe lz ma mb mc b">Pentium II</code>处理器。</p><p id="c644" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">Java小程序刚刚出现，看起来似乎是一条出路，但它们需要大量的专业知识才能获得最佳结果。</p><p id="ffe2" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">网景公司是第一个开发浏览器的公司，它认为网络需要一种更简单的语言，来做像<code class="fe lz ma mb mc b">DOM</code>操作、动画和一般交互这样的事情——供低层程序员和设计师使用。</p><p id="2b71" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">时间是至关重要的，这种语言仅用了六个月就被创造出来，吸收了来自<a class="ae kc" href="https://en.wikipedia.org/wiki/Scheme_(programming_language)\" rel="noopener ugc nofollow" target="_blank"> Scheme </a>、<a class="ae kc" href="https://en.wikipedia.org/wiki/Self_(programming_language)" rel="noopener ugc nofollow" target="_blank"> Self </a>的影响，使它看起来像Java。它简单、动态、易于掌握，并且很好地完成了它的任务。</p><p id="0463" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">考虑到这一点，让我们转移到手头的主题..</p><h1 id="0bb1" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">var来了</h1><p id="5247" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">乍看之下，声明变量的历史方法似乎很简单，就像任何其他语言一样，但是当你开始使用它时，你迟早会遇到让你挠头的情况:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="c07e" class="mq ke iq mc b gy mr ms l mt mu">for(var i=0; i&lt;5; i++) {<br/>    setTimeout(() =&gt; {<br/>        console.log(i);<br/>    }, 100);<br/>}</span><span id="4b24" class="mq ke iq mc b gy mv ms l mt mu">// The output is 5, 5, 5, 5, 5</span></pre><p id="df70" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">出现这种行为是因为<code class="fe lz ma mb mc b">var</code>如果在函数中声明，那么它就是函数范围的，否则就是全局的。在这种情况下——它是全局的，如果我们想让它每个超时都有自己的值，我们必须把它放在一个闭包里:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="dd71" class="mq ke iq mc b gy mr ms l mt mu">for(var i=0; i&lt;5; i++) {<br/>    ((i) =&gt; {<br/>        setTimeout(() =&gt; {<br/>           console.log(i)<br/>        }, 100);<br/>    })(i);<br/>}</span></pre><p id="fa8e" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">我们创建一个新函数并立即执行它，将<code class="fe lz ma mb mc b">i</code>的当前值作为参数传递。由于数字是一个原语，新函数获得了该值的副本，我们得到了预期的结果，尽管语法上看起来有点混乱。</p><p id="5579" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">还有更多这方面的来源:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="b6bc" class="mq ke iq mc b gy mr ms l mt mu">var x = 4;<br/>{<br/>    var x = 5;<br/>    {<br/>        var x = 7;<br/>    }<br/> <br/>    var x = 10;<br/>}</span><span id="aac5" class="mq ke iq mc b gy mv ms l mt mu">console.log(x);</span></pre><p id="ccab" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">输出会是什么？会是<code class="fe lz ma mb mc b">10</code>，因为没有块作用域，只有函数作用域。</p><p id="285e" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">如果我们愿意，我们甚至可以重新声明变量:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="439a" class="mq ke iq mc b gy mr ms l mt mu">var x = 5;<br/>var x = 6;</span><span id="0293" class="mq ke iq mc b gy mv ms l mt mu">console.log(x); // The output is 6</span></pre><p id="8a4d" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">您甚至可以不声明变量，这将使它成为全局变量，并可能覆盖某些内容:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="13a0" class="mq ke iq mc b gy mr ms l mt mu">function func() {<br/>    y = 1;<br/>}</span><span id="bbfb" class="mq ke iq mc b gy mv ms l mt mu">func();</span><span id="53e9" class="mq ke iq mc b gy mv ms l mt mu">console.log(y); // The output is: 1</span></pre><p id="bc9b" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">这些<code class="fe lz ma mb mc b">var</code>语句在任何代码运行之前被执行，这导致了一个被称为<code class="fe lz ma mb mc b">hoisting</code>的行为，这意味着将所有的声明移动到顶部:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="096e" class="mq ke iq mc b gy mr ms l mt mu">console.log(tongueBender);<br/>var tongueBender = "She sells seashells by the sea shore";</span></pre><p id="8f95" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">输出将是<code class="fe lz ma mb mc b">undefined</code>，因为只有声明被上移，赋值停留在原来的位置。</p><p id="6407" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">在较新版本的Javascript(从ECMAScript第5版开始)中，可以用<code class="fe lz ma mb mc b">use strict</code>来执行它，这将不允许使用未声明的变量，但仍将<code class="fe lz ma mb mc b">hoist</code>并允许您重新声明变量。它还做其他事情，比如不允许写入不可写的全局变量，抛出错误，而不是在某些情况下保持沉默，完整的描述可以在这里找到<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="fa5f" class="mq ke iq mc b gy mr ms l mt mu">"use strict"<br/>console.log(fancyNumber);<br/>fancyNumber = 42; // ReferenceError: fancyNumber is not defined</span></pre><h1 id="0658" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">与时俱进</h1><p id="9080" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">考虑到所有这些问题，ECMAScript version 5中出现了两种声明变量的新方法:<code class="fe lz ma mb mc b">let</code>和<code class="fe lz ma mb mc b">const</code>——这让Javascript开发人员的生活变得更加愉快。</p><p id="5d6a" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">用这些关键字声明或初始化的变量有:</p><ul class=""><li id="3fde" class="mw mx iq ld b le md li me lm my lq mz lu na ly nb nc nd ne bi translated">块范围</li><li id="1382" class="mw mx iq ld b le nf li ng lm nh lq ni lu nj ly nb nc nd ne bi translated">不允许重新声明</li><li id="3723" class="mw mx iq ld b le nf li ng lm nh lq ni lu nj ly nb nc nd ne bi translated">未悬挂</li></ul><p id="3775" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">这意味着我们可以预测其他语言的行为:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="05a4" class="mq ke iq mc b gy mr ms l mt mu">for(let i=0; i&lt;5; i++) {<br/>    console.log(i)<br/>}</span><span id="b3c4" class="mq ke iq mc b gy mv ms l mt mu">// The output is: 0, 1, 2, 3, 4</span><span id="ff19" class="mq ke iq mc b gy mv ms l mt mu">let x = 5;<br/>let x = 6;</span><span id="7b7a" class="mq ke iq mc b gy mv ms l mt mu">// SyntaxError: Identifier 'x' has already been declared</span><span id="5f67" class="mq ke iq mc b gy mv ms l mt mu">let y = 4;<br/>{<br/>    let y = 5;<br/>    {<br/>        let y = 7;<br/>    }<br/>}</span><span id="24bd" class="mq ke iq mc b gy mv ms l mt mu">console.log(y) // The output is: 4</span></pre><p id="495d" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">顾名思义，<code class="fe lz ma mb mc b">const</code>关键字声明了一个常量，这意味着它的值以后不能更改。</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="63f9" class="mq ke iq mc b gy mr ms l mt mu">const a = 4;<br/>a = 5;</span><span id="89a7" class="mq ke iq mc b gy mv ms l mt mu">// TypeError: Assignment to constant variable.</span></pre><p id="d7b7" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">不过，在处理对象时，要记住一件事:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="54ce" class="mq ke iq mc b gy mr ms l mt mu">const obj = {};<br/>obj.a = 5; // Will work just fine<br/>obj = {};  // TypeError</span></pre><p id="76e1" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">您仍然可以修改对象，该对象被声明为<code class="fe lz ma mb mc b">const</code>，因为它仍然是同一个对象。如果使用<code class="fe lz ma mb mc b">Object.defineProperty</code>，属性也可以保持不变:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="2cf5" class="mq ke iq mc b gy mr ms l mt mu">const obj = {};</span><span id="c0ae" class="mq ke iq mc b gy mv ms l mt mu">Object.defineProperty(obj, "a", {<br/>    value: 4,<br/>    writable: false,<br/>});</span><span id="44af" class="mq ke iq mc b gy mv ms l mt mu">obj.a = "5"</span><span id="09d4" class="mq ke iq mc b gy mv ms l mt mu">console.log(obj); // The output is: {}</span></pre><p id="da13" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">如果<code class="fe lz ma mb mc b">use strict</code>被设置为这个代码片段，就会引发一个类型错误:<code class="fe lz ma mb mc b">TypeError: Cannot assign to read only property ‘a’ of object</code></p><h1 id="7bcd" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论</h1><p id="5c3b" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">Java小程序已经过时很久了，Javascript现在可以用于更多可以想象到的事情，谢天谢地，随着时间的推移，它的缺点已经得到解决，新的特性还在不断出现，<code class="fe lz ma mb mc b">private</code>class field有人知道吗？</p><p id="5e7c" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">那么，应该用什么来声明一个变量呢？这个问题的答案很简单——如果可以，总是使用<code class="fe lz ma mb mc b">const</code>，否则使用<code class="fe lz ma mb mc b">let</code>。通过使用<code class="fe lz ma mb mc b">const</code>,代码库变得更加可预测，甚至可以通过编译器优化来提高性能(在其他语言中也是如此)。</p><p id="2281" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">千万不要用<code class="fe lz ma mb mc b">var</code>，除非你喜欢危险的生活。严格模式也是首选。</p><p id="cf9b" class="pw-post-body-paragraph lb lc iq ld b le md lg lh li me lk ll lm mf lo lp lq mg ls lt lu mh lw lx ly ij bi translated">我推荐在这里阅读Javascript的全部历史，这是一本非常有趣的书。让你想知道接下来会发生什么:)</p></div></div>    
</body>
</html>