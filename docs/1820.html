<html>
<head>
<title>Improvements coming with TypeScript 3.9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript 3.9带来的改进</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-coolest-improvements-coming-with-typescript-3-9-90977bd73a24?source=collection_archive---------6-----------------------#2020-04-26">https://javascript.plainenglish.io/the-coolest-improvements-coming-with-typescript-3-9-90977bd73a24?source=collection_archive---------6-----------------------#2020-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3459" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TypeScript继续以闪电般的速度前进。<a class="ae kl" href="https://www.amazon.com/Learn-TypeScript-Building-Applications-understanding-ebook/dp/B081FB89BL/" rel="noopener ugc nofollow" target="_blank">我关于TS 3.x </a>的书已经在12月份发布，现在3.9已经在眼前了！唷！</p><p id="3788" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TS 3.9计划在五月在<a class="ae kl" href="https://github.com/microsoft/TypeScript/issues/37198" rel="noopener ugc nofollow" target="_blank">发布，但是</a><a class="ae kl" href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-9-beta/" rel="noopener ugc nofollow" target="_blank">的测试版已经出来</a>供我们试用。让我们看看这个新版本会给我们带来什么！</p><h1 id="0581" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">速度！</h1><p id="a13a" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">正如测试版发行说明中所述，3.9将带来许多<a class="ae kl" href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-9-beta/#speed-improvements" rel="noopener ugc nofollow" target="_blank">性能改进</a>。TypeScript团队和各种贡献者已经修复了围绕这个问题的多个问题。</p><p id="20a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们已经解决了大型并集/交集/条件类型以及映射类型的问题。查看测试版发行说明，获得相关的拉请求的一个小列表(不出所料，许多请求是由Anders自己发起的:p)。</p><p id="6b6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TypeScript的项目经理Daniel Rosenwasser 宣布material-ui的编译时间减少了约40%,这是一个相当大的项目，其构建时间很慢。我不知道你怎么想，但这听起来很棒。</p><p id="70c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Daniel还提到TS 3.9解决了文件重命名的问题。以前，在文件重命名操作之后，需要花费相当长的时间来确定哪些导入语句必须更新。我目睹了很多次这种情况，这确实很烦人；少了一个需要担心的问题！</p><p id="caf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近切换到测试版，我确实可以确认编译时间更好了；尽管我的项目没有<em class="lp">那么</em>大！</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="4e07" class="km kn iq bd ko kp lx kr ks kt ly kv kw kx lz kz la lb ma ld le lf mb lh li lj bi translated">@ts-expect-error</h1><p id="0703" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">有时候，在编写测试代码时，我们需要测试TypeScript编译器不让我们测试的东西。</p><p id="9672" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，如果您编写的API将被用JavaScript编写的客户端使用，您的代码可能会被错误地调用，测试这种情况也是有用的。</p><p id="4767" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看一个取自我当前项目的具体例子:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="fb4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的Jest测试中，我确保认证服务优雅地处理无效输入。</p><p id="f2aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第3行，如果我没有使用“未知程度”这个小技巧，TypeScript编译器就会拒绝编译我的代码。</p><p id="203b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前，这是让编译器满意的一种方式。事情是这样的，在将某个东西强制转换为未知的东西之后，我们可以将它再次强制转换为其他任何东西，编译器根本不会介意。即使不完美，这也是可行的，并且在测试环境中是有用的。</p><p id="cadc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一种方法是在相关行的上方添加一个<em class="lp"> ts-ignore </em>注释:</p><pre class="mc md me mf gt mj mk ml mm aw mn bi"><span id="9077" class="mo kn iq mk b gy mp mq l mr ms"><em class="lp">// @ts-ignore</em></span></pre><p id="f6c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题是，这只是告诉编译器忽略整行，在这种情况下甚至更糟，因为其他错误可能会悄悄出现，不会被TypeScript注意到。</p><p id="762b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了TypeScript 3.9，我们将多了一个选项:在代码行上方添加一个<em class="lp"> ts-expect-error </em>注释:</p><pre class="mc md me mf gt mj mk ml mm aw mn bi"><span id="6a07" class="mo kn iq mk b gy mp mq l mr ms"><em class="lp">// @ts-expect-error</em></span></pre><p id="7146" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个新的“取消注释”告诉TypeScript不要报告错误(如果有错误的话)，而是在实际上没有错误的情况下警告我们。</p><p id="e07d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这在我的场景中非常有用，因为我可以避免使用“未知”的技巧，而只需这样做:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="5d78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不过，需要注意的是如何使用这个特性。在上面的例子中，我可能打错了服务变量的名称、handleError方法的名称或subscribe方法的名称，在所有这些情况下，编译器都不会太介意。</p><p id="be0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以最好把这一行分开，这样编译器就能准确地知道哪里会出错。这里有一个更安全的版本:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="c28a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，编译器只希望handleError方法参数出错，这正是我在这个测试中想要的。</p><p id="0222" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想我会停止使用“像…一样不为人知”的伎俩，而是使用这个整洁的新功能，因为它对我来说感觉更安全。</p><p id="de85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，我将继续不惜一切代价避免使用ts-ignore；-)</p><h1 id="9c7d" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">条件表达式中未调用的函数检查</h1><p id="8c6e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">显然，当TS 3.7检测到我们忘记在if语句中调用函数时，它已经开始报告错误。</p><p id="8996" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是发行说明中的示例:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="e2ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在上面看到的，在if语句中，一个可怜的人忘记了实际调用hasImportantPermissions函数。因为函数确实被定义了，所以它总是真的。幸运的是，在TypeScript 3.7及更高版本中，编译器会注意到这一点并排除错误。干净利落。</p><p id="d481" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实际上，我在发行说明中并没有注意到这一点，并且很幸运从来没有遇到过这个问题。</p><p id="5ee9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在TypeScript 3.9中，对检测这种讨厌问题的支持已经扩展到了三元条件。厉害！</p><p id="f7f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很少忘记调用我的函数，但现在我放心了，即使它发生在我身上，TypeScript会帮我修复它！:)</p><h1 id="9cca" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">编辑器改进</h1><p id="3ff7" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">正如我在<a class="ae kl" href="https://medium.com/@dSebastien/typescript-non-goals-43f47c1ecd84" rel="noopener">我的上一篇文章</a>中解释的，TypeScript编译器的架构已经被设计成使得代码编辑器和ide能够轻而易举地包含TypeScript支持。事实上，也正是由于这一点，像VSCode这样的编辑器提供了出色的JavaScript支持，帮助修复JavaScript代码的问题，即使没有使用TypeScript编码。</p><p id="21d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TypeScript 3.9带来了新的改进。</p><p id="a6ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，VSCode现在支持<a class="ae kl" href="https://code.visualstudio.com/docs/typescript/typescript-compiling#_using-the-workspace-version-of-typescript" rel="noopener ugc nofollow" target="_blank">在类型脚本版本</a>之间切换。如发行说明所述，请注意还有一个TypeScript扩展的夜间版本，您可以使用它从最新的改进中受益。</p><p id="ab8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顺便问一下，你知道我<a class="ae kl" href="https://medium.com/@dSebastien/vs-code-extension-packs-to-boost-productivity-fa1ba44dfc2e" rel="noopener">有一套VSCode扩展包</a>吗？当然有一个是用于JavaScript/TypeScript开发的；-)</p><p id="415a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于编辑器改进的所有细节，你最好<a class="ae kl" href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-9-beta/#editor-improvements" rel="noopener ugc nofollow" target="_blank">看一下发布说明</a>。</p><p id="a537" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总结一下:</p><ul class=""><li id="2c79" class="mt mu iq jp b jq jr ju jv jy mv kc mw kg mx kk my mz na nb bi translated">更好/更同质的CommonJS汽车进口(耶！)</li><li id="0bd7" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">现在保留换行符的代码动作(这个很好，但是我有我可爱的<a class="ae kl" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">更漂亮的</a>来处理所有代码格式化的废话)</li><li id="92d4" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">支持“解决方案风格”的tsconfig.json文件</li></ul><h1 id="f282" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">重大变化</h1><p id="686b" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">虽然听起来很悲伤，但TS 3.9也包含了一些突破性的变化。我不会在本文中涉及这些，但如果有兴趣的话，我可能会写一篇后续文章。就我而言，我很幸运，因为看起来我不需要修改我的项目。</p><p id="7efc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论如何，如果你想了解这些，一定要查看一下<a class="ae kl" href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-9-beta/#breaking-changes" rel="noopener ugc nofollow" target="_blank">测试版发布说明</a>！</p><h1 id="5a0a" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">结论</h1><p id="d514" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在本文中，我简要解释了我认为即将发布的TypeScript版本中最有趣的新特性。</p><p id="b39e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我一直在愉快地使用测试版。此外，更新是轻而易举的。所以，去尝试一下吧！如果你很谨慎，那没关系，它很快就会被释放。</p><p id="9ef6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天到此为止！</p><h2 id="6d9c" class="mo kn iq bd ko nh ni dn ks nj nk dp kw jy nl nm la kc nn no le kg np nq li nr bi translated">喜欢这篇文章吗？点击下面“喜欢”按钮查看更多内容，并确保其他人也能看到！</h2><p id="252f" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">PS:如果你想学习大量关于软件/Web开发、TypeScript、Angular、React、Vue、Kotlin、Java、Docker/Kubernetes和其他很酷的主题的其他很酷的东西，那么不要犹豫<a class="ae kl" href="https://www.amazon.com/Learn-TypeScript-Building-Applications-understanding-ebook/dp/B081FB89BL" rel="noopener ugc nofollow" target="_blank">去拿一本我的书</a>并订阅<a class="ae kl" href="https://mailchi.mp/fb661753d54a/developassion-newsletter" rel="noopener ugc nofollow" target="_blank">我的简讯</a>！</p><h2 id="59e6" class="mo kn iq bd ko nh ni dn ks nj nk dp kw jy nl nm la kc nn no le kg np nq li nr bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="aba9" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物:<a class="ae kl" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="jp ir">AI in Plain English</strong></a><a class="ae kl" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="jp ir">UX in Plain English</strong></a><a class="ae kl" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="jp ir">Python in Plain English</strong></a><strong class="jp ir"/>——谢谢，继续学习！</p><p id="e4c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kl" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">submissions @ plain English . io</strong></a><strong class="jp ir"/>，并附上您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>