<html>
<head>
<title>Start Using forEach() and map() with DOM Selections</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始对DOM选择使用forEach()和map()</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/start-using-foreach-and-map-with-dom-selections-754616f8e7a7?source=collection_archive---------3-----------------------#2020-06-16">https://javascript.plainenglish.io/start-using-foreach-and-map-with-dom-selections-754616f8e7a7?source=collection_archive---------3-----------------------#2020-06-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="57c3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">避免这个容易犯的错误。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/55039d82eacd4cf6bd3da7e27521adf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t2gEyYWkttMqEll2XVCTjw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@mroz?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Filip Mroz</a> on <a class="ae kv" href="https://unsplash.com/s/photos/loop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="f03f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">试图脱离for循环</h1><p id="b100" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="mk">给自己的备忘录</em>:我正在使用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction" rel="noopener ugc nofollow" target="_blank"> DOM </a>(文档对象模型)。我需要选择文档中所有的&lt;部分&gt;元素。然后我需要迭代结果，以某种方式改变每个元素。我以前做过这个。我的第一反应是伸手去拿那个可靠的老虎机…</p><p id="bc04" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">但是等等，也许是时候尝试一下<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank"> map() </a>方法了？</p><p id="04d6" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">为什么不呢！所以我做出选择，并尝试使用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank">地图(</a>)。并收到一个错误…</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="8beb" class="mv kx iq mr b gy mw mx l my mz">let x = document.getElementsByTagName('section');</span><span id="8da7" class="mv kx iq mr b gy na mx l my mz">let newArray = x.map(el =&gt; el.textContent = 'new content');</span></pre><p id="9111" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated"><em class="mk">未捕获的类型错误:x.map不是函数… </em>😨</p><p id="c105" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">啊！现在回到for循环并把这个错误远远抛在后面是很诱人的，但是我不会那么容易放弃。我要去试试<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>。无论如何，我不需要返回一组新的结果。我只需要对每个元素进行修改。但是我收到了相同类型的错误…</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="53a2" class="mv kx iq mr b gy mw mx l my mz">x.forEach(el =&gt; el.textContent = 'new content');</span></pre><p id="8746" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated"><em class="mk">未捕获的类型错误:x.forEach不是函数… </em>😨 😨</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/b954fc8bbdc1bb423daf6672d137ad41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYTd1a62qS887JyQqPzG9Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Array methods will not work with an HTMLCollection.</figcaption></figure><h1 id="d288" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">那么问题出在哪里？</h1><p id="22b7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">问题是我没有一个数组与<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank"> map() </a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>一起使用。<em class="mk">我有一个</em><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection" rel="noopener ugc nofollow" target="_blank"><em class="mk">html collection</em></a>。</p><p id="c098" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">使用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByTagName" rel="noopener ugc nofollow" target="_blank">document . getelementsbytagname()</a>返回一个<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection" rel="noopener ugc nofollow" target="_blank"> HTMLCollection </a>。for循环将迭代一个<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection" rel="noopener ugc nofollow" target="_blank"> HTMLCollection </a>。没有像<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank"> map() </a>这样的内置方法可用。</p><p id="4827" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll" rel="noopener ugc nofollow" target="_blank">document . queryselectorall()</a>怎么样？问得好，答案是有和没有。我仍然没有一个数组。这个方法将返回一个<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList" rel="noopener ugc nofollow" target="_blank">节点列表</a>。节点列表确实有一些内置方法，包括<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>，但是它们不支持map()。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/ba741ff72753be8e92e75468dce851bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gfOFIVd1-D1BHqMrRxJ7Mw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Node Lists do have a forEach() method available, but not map().</figcaption></figure><h1 id="2017" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">传播语法来拯救！</h1><p id="7148" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">好消息是:我可以通过一行代码从我的<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection" rel="noopener ugc nofollow" target="_blank"> HTMLCollection </a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList" rel="noopener ugc nofollow" target="_blank">节点列表</a>中轻松创建一个新数组。它只需要使用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" rel="noopener ugc nofollow" target="_blank">展开语法</a>！</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="d548" class="mv kx iq mr b gy mw mx l my mz">let spreadArray = [...x];</span></pre><p id="0f43" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">现在，我可以在新数组上使用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank"> map() </a>。😎</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/edd064e0d6833840cd12fc8f62346a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVyNVoGuYdDuyJ10pU1HJA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Use the spread operator to easily make a new array from an HTMLCollection or Node List.</figcaption></figure><h1 id="2c77" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="c457" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">综上所述，记得用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByTagName" rel="noopener ugc nofollow" target="_blank">document . getelementsbytagname()</a>、<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName" rel="noopener ugc nofollow" target="_blank">document . getelementsbyclassname()</a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll" rel="noopener ugc nofollow" target="_blank">document . query selectorall()</a>从<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction" rel="noopener ugc nofollow" target="_blank"> DOM </a>中选择不会返回结果数组。然而，利用<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" rel="noopener ugc nofollow" target="_blank"> spread语法</a>的一行快速代码将从这些结果中创建一个数组。而且数组有这么多方法可以选择，包括<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank"> map() </a>和<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach() </a>。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="d75b" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在LinkedIn或Twitter上随时联系我。如果你喜欢这篇文章，给它一些掌声。我将真诚地感谢它。</p><p id="bfd7" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated"><a class="ae kv" href="https://www.linkedin.com/in/davidagray/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/davidagray/</a></p><div class="nl nm gp gr nn no"><a href="https://twitter.com/yesdavidgray" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">戴夫·格雷</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">戴夫·格雷的最新推文(@ yesdavidgray)。解决方案架构师*讲师*音乐家*企业家*上瘾…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">twitter.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kp no"/></div></div></a></div></div></div>    
</body>
</html>