# å¦‚ä½•åœ¨ React Native ä¸­åˆ›å»ºè‡ªå®šä¹‰æ‹‰åŠ¨ä»¥åˆ·æ–°åŠ¨ç”»

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/react-native-how-to-create-custom-pull-to-refresh-animations-aa0d14329dc0?source=collection_archive---------1----------------------->

## â€¦é€šè¿‡ä½¿ç”¨æ´›è’‚åŠ¨ç”»

# ä»€ä¹ˆæ˜¯æ‹‰åˆ·æ–°ï¼Ÿ

æˆ‘ä¸€ç›´ç€è¿·äºä¸åŒçš„ UI äº¤äº’ï¼Œä»¥åŠå¦‚æ­¤ç‹¬ç‰¹å’Œä¸åŒçš„ä¸œè¥¿æ˜¯å¦‚ä½•å˜å¾—å¦‚æ­¤ç†Ÿæ‚‰å’Œæ˜“äºä½¿ç”¨çš„ã€‚ä»Šå¤©å¹¿æ³›ä½¿ç”¨çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯**æ‹‰è‡³åˆ·æ–°**ã€‚

![](img/8d29749d8630729a375ced75894a93fc.png)

Pull to refresh on iOS

è¿™ç§äº’åŠ¨å‡ ä¹å¯ä»¥åœ¨æ¯ä¸ªç§»åŠ¨åº”ç”¨ç¨‹åºä¸­æ‰¾åˆ°ï¼Œä½†æˆ‘å‘ä½ ä¿è¯ï¼Œ99.99%çš„äººä»æœªå¬è¯´è¿‡ [Loren Brichter](https://en.wikipedia.org/wiki/Loren_Brichter) ï¼Œå³ä½¿æˆ‘ä»¬æ¯å¤©éƒ½åœ¨ä½¿ç”¨ä»–çš„ä½œå“ã€‚ç‚¹å‡»è¿™é‡Œæ‚¨å¯ä»¥äº†è§£æ›´å¤šå…³äºæ‹‰è‡³åˆ·æ–°å¦‚ä½•è¯ç”Ÿçš„ä¿¡æ¯[ã€‚](https://en.wikipedia.org/wiki/Pull-to-refresh)

ä»é‚£æ—¶èµ·ï¼Œè®¸å¤šäººæƒ³å‡ºäº†ä¸åŒç§ç±»çš„è‡ªå®šä¹‰æ‹‰åˆ·æ–°åŠ¨ç”»ã€‚

![](img/b90f0c7b3fb03b02eaefb75550bb5a94.png)

Credits: [https://dribbble.com/shots/3026988-Pull-To-Refresh-Airbnb](https://dribbble.com/shots/3026988-Pull-To-Refresh-Airbnb)

![](img/e3cb5923abdd62ebe4db6d3478169634.png)

Credits: [https://dribbble.com/shots/2242263--1-Pull-to-refresh-Freebie-Weather-Concept](https://dribbble.com/shots/2242263--1-Pull-to-refresh-Freebie-Weather-Concept)

![](img/4e41eb7021afc5c56b3e429de32fbab8.png)

This oneâ€™s my favorite. Stacking burgers! Credits: [https://dribbble.com/shots/10733383-Pull-to-refresh](https://dribbble.com/shots/10733383-Pull-to-refresh)

åœ¨å››å¤„æŒ–æ˜ä¹‹åï¼Œæˆ‘æ„è¯†åˆ°æ²¡æœ‰ä»»ä½•ç®€å•çš„æ–¹æ³•æ¥ç”¨ React Native åˆ›å»ºè¿™äº›å¾ˆé…·çš„åŠ¨ç”»ï¼Œæ‰€ä»¥æˆ‘å†³å®šæå‡ºè‡ªå·±çš„è§£å†³æ–¹æ¡ˆã€‚

# æˆ‘ä»¬å¼€å§‹å§

æˆ‘æƒ³åˆ›é€ ä¸€äº›å¯¹å¼€å‘è€…æ›´å‹å¥½çš„ä¸œè¥¿ï¼Œå› ä¸ºå¾ˆå¤šè§£å†³æ–¹æ¡ˆåªé€‚ç”¨äºç‰¹å®šçš„åŠ¨ç”»ã€‚ä»‹ç»[æ´›è’‚](https://lottiefiles.com/)

> ä¸€ä¸ª **Lottie** æ˜¯ä¸€ä¸ªåŸºäº JSON çš„åŠ¨ç”»æ–‡ä»¶æ ¼å¼ï¼Œå®ƒä½¿è®¾è®¡è€…èƒ½å¤Ÿåœ¨ä»»ä½•å¹³å°ä¸Šå‘å¸ƒåŠ¨ç”»ï¼Œå°±åƒå‘å¸ƒé™æ€èµ„äº§ä¸€æ ·å®¹æ˜“ã€‚å®ƒä»¬æ˜¯å¯ä»¥åœ¨ä»»ä½•è®¾å¤‡ä¸Šå·¥ä½œçš„å°æ–‡ä»¶ï¼Œå¯ä»¥åœ¨æ²¡æœ‰åƒç´ åŒ–çš„æƒ…å†µä¸‹æ”¾å¤§æˆ–ç¼©å°ã€‚

ä½¿ç”¨ Lottie å¯ä»¥è®©æˆ‘ä»¬å¿«é€Ÿåœ°å°†ä¸€ä¸ªåŠ¨ç”»æ”¾å…¥åˆ°æˆ‘ä»¬çš„åˆ·æ–°ç»„ä»¶ä¸­ï¼Œå¹¶ä¸”è‡ªåŠ¨è¿è¡Œã€‚

è¿™æ˜¯æˆ‘ä»¬ä»Šå¤©è¦å»ºé€ çš„ä¸œè¥¿:

![](img/668e002ec6c199316d30bf9a98c45e4a.png)

Custom pull to refresh animation using Lottie

# æ­¥éª¤ 1:æ·»åŠ æ´›è’‚åŠ¨ç”»

ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘å‡è®¾ä½ ä»¬å·²ç»çŸ¥é“å¦‚ä½•ä½¿ç”¨`FlatList`ã€‚å¯¹äºé‚£äº›æƒ³ç»§ç»­å­¦ä¹ çš„äººï¼Œæˆ‘ä¸ºè¿™ä¸ªæ•™ç¨‹åˆ›å»ºäº†ä¸€ä¸ªå…¥é—¨æ¨¡æ¿ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ[ä¸‹è½½](https://github.com/Groftware/pulltorefreshtutorial)ã€‚ä¸‹è½½åä¸è¦å¿˜è®°è¿è¡Œé¡¹ç›®ä¸­çš„`yarn install`æˆ–`npm install`ï¼Œä»¥ç¡®ä¿å®‰è£…äº†æ‰€æœ‰çš„ä¾èµ–é¡¹ã€‚

ä½ æƒ³åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å¾—åˆ°ä¸€ä¸ªæ´›è’‚åŠ¨ç”»ã€‚æµè§ˆ [Lottie æ–‡ä»¶](https://lottiefiles.com/)ï¼ŒæŒ‘é€‰ä¸€ä¸ªä½ å–œæ¬¢çš„åŠ¨ç”»ï¼Œç„¶åä¸‹è½½æˆ **Lottie JSON æ ¼å¼**ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨è¿™ä¸ª:

![](img/9e6211b0d974f975493714217023b1c0.png)

Credits to Alex Martov: [https://lottiefiles.com/9258-bouncing-fruits](https://lottiefiles.com/9258-bouncing-fruits)

ä¸‹è½½ä½ æƒ³è¦çš„ Lottie åŠ¨ç”»åï¼Œæ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œå°†åŠ¨ç”»æ–‡ä»¶ç§»åŠ¨åˆ°`assets/`æ–‡ä»¶å¤¹ã€‚åŒæ ·ï¼Œç¡®ä¿åŠ¨ç”»æ˜¯ä¸€ä¸ª`.json`æ–‡ä»¶ï¼å¦‚æœæ²¡æœ‰ï¼Œå›åˆ° Lottiefilesï¼Œä¸‹è½½ JSON ç‰ˆæœ¬ã€‚

![](img/1550f2909ab573c12d38cfa84f49a2d3.png)

Iâ€™ve renamed my animation to â€œbouncing-fruits.jsonâ€

ç°åœ¨æ‚¨å·²ç»è·å¾—äº†åŠ¨ç”»æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯åŠ è½½å®ƒå¹¶æ˜¾ç¤ºåŠ¨ç”»ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ [**æ´›è’‚**](https://www.npmjs.com/package/lottie-react-native)**-**[**react-native**](https://www.npmjs.com/package/lottie-react-native)ã€‚é€šè¿‡è¿è¡Œ`yarn add lottie-react-native`(æˆ–ä½¿ç”¨`npm install lottie-react-native`)è¿›è¡Œå®‰è£…

å¯¼èˆªåˆ°`FruitList.jsx`ï¼Œåœ¨å¯¼å…¥è¯­å¥çš„æ­£ä¸‹æ–¹ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹:

ç°åœ¨åœ¨`styles`é‡Œé¢ï¼Œè®©æˆ‘ä»¬åˆ›å»ºå¦ä¸€ç§é£æ ¼ï¼Œå«åš`lottieView`

æœ€åï¼Œæ¿€åŠ¨äººå¿ƒçš„éƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬å°†ç°æœ‰çš„`FlatList`å’Œ`LottieView`åŒ…è£…æˆä¸€ä¸ªæ–°çš„`View`ã€‚ä¸‹é¢æ˜¯`FruitList.jsx`çš„å®Œæ•´ä»£ç ã€‚

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹

![](img/35845dc8b1f182aaff4e2176393fbe6e.png)

Bouncing fruits animation

å‰å®³ï¼åªä¸è¿‡ï¼Œå½“æˆ‘ä»¬æ‰“å¼€åº”ç”¨ç¨‹åºæ—¶ï¼ŒåŠ¨ç”»ä¼šç«‹å³è¿è¡Œã€‚è¿™å¹¶ä¸å®Œå…¨æ˜¯æˆ‘ä»¬æ‰€å¯»æ±‚çš„â€¦è®©æˆ‘ä»¬å¼„æ¸…æ¥šå¦‚ä½•çœŸæ­£å°†å®ƒè½¬åŒ–ä¸ºä¸€ç§æ›´æ–°çš„æ¨åŠ¨åŠ›ã€‚

# æ­¥éª¤ 2:åœ¨å¹³é¢åˆ—è¡¨åé¢â€œéšè—â€åŠ¨ç”»

*å®ç°æ‹‰åŠ¨åˆ·æ–°æ•ˆæœçš„æƒ³æ³•å¾ˆç®€å•*

1.  å°†åŠ¨ç”»éšè—åœ¨`FlatList`åé¢ã€‚
2.  éšç€`FlatList`å‘ä¸‹æ»šåŠ¨ï¼Œè·Ÿè¸ª y åç§»çš„å˜åŒ–(ä»–ä»¬å‘ä¸‹æ»šåŠ¨äº†å¤šå°‘)ï¼Œå¹¶ä¸”*é€‚å½“åœ°ä½¿*åŠ¨ç”»åŒ–ã€‚
3.  å½“ç”¨æˆ·é‡Šæ”¾æ»šåŠ¨è§†å›¾(`onResponderRelease`)æ—¶ï¼Œæ£€æŸ¥åç§»æ˜¯å¦è¶³ä»¥è§¦å‘åˆ·æ–°ã€‚
4.  åŠ¨ç”»åœ¨æ•´ä¸ªåˆ·æ–°è¿‡ç¨‹ä¸­ä¿æŒå¯è§ã€‚
5.  å½“åˆ·æ–°ç»“æŸæ—¶ï¼Œåœæ­¢åŠ¨ç”»ï¼Œç„¶å`FlatList`å‘ä¸Šæ»šåŠ¨éšè—åŠ¨ç”»ã€‚

ä¸ºäº†éšè—`Flatlist`åé¢çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯å›åˆ°`FruitList.jsx`å¹¶æ›´æ–°`LottieView`çš„æ ·å¼ã€‚

> å¯¹äºé‚£äº›æ²¡æœ‰ä½¿ç”¨ starter é¡¹ç›®çš„äººæ¥è¯´,`FlatList`å¿…é¡»æœ‰ä¸€ä¸ªé€æ˜çš„èƒŒæ™¯è‰²(æˆ–è€…æ²¡æœ‰èƒŒæ™¯è‰²),æ¯è¡Œéƒ½åº”è¯¥æœ‰ä¸€ä¸ªèƒŒæ™¯è‰²ã€‚åªæœ‰è¿™æ ·åšï¼Œæˆ‘ä»¬æ‰èƒ½è®©`FlatList`å‘ä¸‹æ»šåŠ¨æ—¶åŠ¨ç”»å¯è§ã€‚

# ç¬¬ä¸‰æ­¥:è·Ÿè¸ªæ»šåŠ¨åç§»

ä¸ºäº†è·Ÿè¸ªæ»šåŠ¨åç§»ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`onScroll`é“å…·ï¼Œç„¶åå°†å…¶å­˜å‚¨åˆ°åä¸º`offsetY`çš„çŠ¶æ€ä¸­ã€‚

åœ¨`FruitList.jsx`çš„æœ€é¡¶éƒ¨ï¼Œä¿®æ”¹å¯¼å…¥è¯­å¥ä»¥åŒ…æ‹¬`useState`ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåä¸º`offsetY`çš„æ–°çŠ¶æ€ã€‚

åˆ›å»ºä¸€ä¸ªæ¥æ”¶æ»šåŠ¨äº‹ä»¶çš„åŠŸèƒ½`onScroll`ï¼Œç„¶åå°† y åç§»é‡è®¾ç½®ä¸ºçŠ¶æ€ã€‚

ç„¶åè®°ä½å°†`onScroll`åŠŸèƒ½åˆ†é…ç»™ oncroll`FlatList`é“å…·ã€‚

ç§ï¼æˆ‘ä»¬ç°åœ¨èƒ½å¤Ÿè·Ÿè¸ª`Flatlist`çš„ y åç§»ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ©ç”¨åç§» yï¼Œç„¶å*æ ¹æ®åç§»åˆ¶ä½œåŠ¨ç”»*ã€‚å¯¹æˆ‘ä»¬æ¥è¯´å¹¸è¿çš„æ˜¯ï¼Œ`LottieView`ç»™äº†æˆ‘ä»¬æ”¯æŸ±`progress`ã€‚ä»¥ä¸‹æ˜¯æ–‡æ¡£å¿…é¡»è¯´æ˜çš„å†…å®¹:

> **è¿›ç¨‹:**0-1 ä¹‹é—´çš„æ•°å­—ï¼Œæˆ– 0-1 ä¹‹é—´çš„`Animated`æ•°å­—ã€‚è¿™ä¸ªæ•°å­—è¡¨ç¤ºåŠ¨ç”»çš„æ ‡å‡†åŒ–è¿›åº¦ã€‚å¦‚æœæ‚¨æ›´æ–°è¿™ä¸ªé“å…·ï¼ŒåŠ¨ç”»å°†ç›¸åº”åœ°æ›´æ–°åˆ°è¯¥è¿›åº¦å€¼çš„å¸§ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯å‘½ä»¤å¼ APIï¼Œåˆ™ä¸éœ€è¦è¯¥å±æ€§ã€‚

å—¯â€¦â€¦æœ‰è¶£ã€‚æ‰€ä»¥`progress`æ˜¯å†³å®šåŠ¨ç”»å¸§çš„ç™¾åˆ†æ¯”ã€‚ç›®å‰ï¼Œæˆ‘ä»¬æœ‰`yOffset`ï¼Œå¦‚æœæ‚¨åš`console.log(yOffset)`å¹¶å‘ä¸‹æ»šåŠ¨ï¼Œæ‚¨ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹:

> -0.5
> -15.5
> -75.5
> -101.5
> â€¦

è¦å°†å…¶è½¬æ¢ä¸ºç™¾åˆ†æ¯”(0 åˆ° 1 ä¹‹é—´çš„å€¼)ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ·æ–°å‘ç”Ÿçš„é«˜åº¦ã€‚

æ–¹ä¾¿çš„æ˜¯ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ã€‚çœ‹çœ‹`lottieView`æ¬¾å¼ï¼Œä½ ä¼šæ³¨æ„åˆ°`height`è¢«è®¾ä¸º`100`ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„èº«é«˜ã€‚è®©æˆ‘ä»¬é€šè¿‡åœ¨æ ·å¼ä¹‹ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º`refreshingHeight`çš„æ–°å˜é‡æ¥é‡æ„å®ƒã€‚

ç°åœ¨è¦å–å¾—è¿›å±•ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯`-offsetY / refreshingHeight`

åœ¨`onScroll`å‡½æ•°ä¹‹åï¼Œæˆ‘ä»¬å°†åˆ›å»º`progress`å˜é‡ï¼Œå¹¶å°†å…¶èµ‹ç»™`LottieView`é“å…·ã€‚

å¦‚æœä½ ç°åœ¨è¿è¡Œåº”ç”¨ç¨‹åºï¼Œä½ åº”è¯¥èƒ½å¤Ÿå‘ä¸‹æ»šåŠ¨ï¼Œçœ‹åˆ°åŠ¨ç”»è·Ÿéšä½ çš„æ»šåŠ¨ï¼

![](img/d60064a307c027c788a72ace130af0ee.png)

# æ­¥éª¤ 4:åˆ·æ–°æ—¶

è¿˜è®°å¾—**ç¬¬äºŒæ­¥**ä¸­è¯¦è¿°çš„è®¡åˆ’å—ï¼Ÿè¿™æ˜¯æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„ã€‚

1.  hÌ¶iÌ¶dÌ¶eÌ¶Ì¶tÌ¶hÌ¶eÌ¶Ì¶aÌ¶nÌ¶iÌ¶mÌ¶aÌ¶tÌ¶iÌ¶oÌ¶nÌ¶Ì¶bÌ¶eÌ¶hÌ¶iÌ¶nÌ¶dÌ¶Ì¶tÌ¶hÌ¶eÌ¶Ì¶`FÌ¶lÌ¶aÌ¶tÌ¶LÌ¶iÌ¶sÌ¶tÌ¶`.Ì¶
2.  aÌ¶sÌ¶Ì¶tÌ¶hÌ¶eÌ¶Ì¶`FÌ¶lÌ¶aÌ¶tÌ¶LÌ¶iÌ¶sÌ¶tÌ¶`Ì¶sÌ¶cÌ¶rÌ¶oÌ¶lÌ¶lÌ¶sÌ¶Ì¶dÌ¶oÌ¶wÌ¶nÌ¶,Ì¶Ì¶tÌ¶rÌ¶aÌ¶cÌ¶kÌ¶Ì¶tÌ¶hÌ¶eÌ¶Ì¶cÌ¶hÌ¶aÌ¶nÌ¶gÌ¶eÌ¶sÌ¶Ì¶iÌ¶nÌ¶Ì¶yÌ¶-Ì¶oÌ¶fÌ¶fÌ¶sÌ¶eÌ¶tÌ¶Ì¶(Ì¶hÌ¶oÌ¶wÌ¶Ì¶mÌ¶uÌ¶cÌ¶hÌ¶Ì¶dÌ¶iÌ¶dÌ¶Ì¶tÌ¶hÌ¶eÌ¶yÌ¶Ì¶sÌ¶cÌ¶rÌ¶oÌ¶lÌ¶lÌ¶Ì¶dÌ¶oÌ¶wÌ¶nÌ¶)Ì¶,Ì¶Ì¶aÌ¶nÌ¶dÌ¶Ì¶aÌ¶nÌ¶iÌ¶mÌ¶aÌ¶tÌ¶eÌ¶Ì¶tÌ¶hÌ¶eÌ¶Ì¶aÌ¶nÌ¶iÌ¶mÌ¶aÌ¶tÌ¶iÌ¶oÌ¶nÌ¶Ì¶aÌ¶pÌ¶pÌ¶rÌ¶oÌ¶pÌ¶rÌ¶iÌ¶aÌ¶tÌ¶eÌ¶lÌ¶yÌ¶.Ì¶
3.  å½“ç”¨æˆ·é‡Šæ”¾æ»šåŠ¨è§†å›¾(`onResponderRelease`)æ—¶ï¼Œæ£€æŸ¥åç§»é‡æ˜¯å¦è¶³ä»¥è§¦å‘åˆ·æ–°ã€‚
4.  åŠ¨ç”»åœ¨æ•´ä¸ªåˆ·æ–°è¿‡ç¨‹ä¸­ä¿æŒå¯è§ã€‚
5.  å½“åˆ·æ–°ç»“æŸæ—¶ï¼Œåœæ­¢åŠ¨ç”»ï¼Œç„¶å`FlatList`å‘ä¸Šæ»šåŠ¨éšè—åŠ¨ç”»ã€‚

è®©æˆ‘ä»¬ä»åˆ›å»ºå¦ä¸€ä¸ªæ–°çŠ¶æ€`isRefreshing`å¼€å§‹ã€‚è¿™å°†ç”¨äºè·Ÿè¸ªåˆ—è¡¨æ˜¯å¦æ­£åœ¨åˆ·æ–°ã€‚åœ¨`offsetY`çŠ¶æ€ä¸‹æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚

ç„¶ååœ¨`onScroll`å‡½æ•°ä¹‹ååˆ›å»ºå‡½æ•°`onRelease`ã€‚ç„¶åå°†å…¶åˆ†é…ç»™ FlatList prop `onResponderRelease`ã€‚

# æ­¥éª¤ 5:åˆ·æ–°æ—¶åŠ¨ç”»ä¿æŒå¯è§

ä¸ºäº†ç¡®ä¿åŠ¨ç”»å¯è§ï¼Œæˆ‘ä»¬å°†å‘ç°æœ‰çš„`FlatList`æ·»åŠ ä¸€ä¸ªç©ºçš„`ListHeaderComponent`ï¼Œå…¶ä¸­çš„`paddingTop`ç›¸å½“äº`refreshingHeight`ã€‚

åœ¨`isRefreshing`ä¸‹é¢ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€`extraPaddingTop`ã€‚è¿™å°†ä¸ºæˆ‘ä»¬çš„ä¸å¯è§çš„`ListHeaderComponent`ä¿å­˜å¡«å……å€¼ã€‚ç„¶ååœ¨`onRelease`å‡½æ•°ä¸­ï¼Œåˆ·æ–°æ—¶å°†`extraPaddingTop`ç½®ä¸º`refreshingHeight`ï¼Œåˆ·æ–°å®Œæ¯•ç½®ä¸º 0ã€‚

æˆ‘ä»¬å¿«åˆ°äº†ï¼ç°åœ¨è¿è¡Œè¯¥åº”ç”¨ç¨‹åºå°†æ˜¾ç¤ºå¦‚ä¸‹å†…å®¹

![](img/9d19e0c31d4f84b4b5b6da2c7492ddcc.png)

æœ‰å‡ ä»¶äº‹ä¼¼ä¹ä¸å¤ªå¯¹åŠ²ã€‚åŠ¨ç”»åœ¨åˆ·æ–°æ—¶ä¸åŠ¨ï¼Œå½“åˆ·æ–°å®Œæˆæ—¶ï¼Œ`FlatList`çªç„¶è·³å›åŸä½ã€‚ä½†æ˜¯åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šè§£å†³è¿™äº›é—®é¢˜ã€‚

# æ­¥éª¤ 6:åˆ·æ–°æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼Œåˆ·æ–°ç»“æŸæ—¶éšè—

æˆ‘ä»¬å°†ä»åˆ·æ–°ç»“æŸæ—¶ä¼˜é›…åœ°æŠ˜å `FlatList`å¼€å§‹ã€‚ä½†åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç¨å¾®é‡æ„ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç ã€‚æ¯å½“`isRefreshing`è¢«æ›´æ–°æ—¶ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`useEffect`æ¥æ›´æ–°å…¶ä»–çŠ¶æ€ã€‚

ç°åœ¨æˆ‘ä»¬åœ¨`onRelease`ä¸­è¦åšçš„å°±æ˜¯`setIsRefreshing`ï¼Œæˆ‘ä»¬çš„`useEffect`é’©å­ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬è®¾ç½®å¡«å……ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨åŠ¨ç”»æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„`ref`ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°`LottieView`ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨åˆ·æ–°æ—¶è§¦å‘`play`åŠŸèƒ½ã€‚å‚è€ƒä¸‹é¢çš„ä»£ç ã€‚

æœ€åï¼Œè®©æˆ‘ä»¬åœ¨åŠ¨ç”»ç»“æŸæ—¶è®©å¹³é¢åˆ—è¡¨ä¼˜é›…åœ°æŠ˜å ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨ React Native çš„[åŠ¨ç”»](https://reactnative.dev/docs/animated) APIï¼Œå¹¶å°†`extraPaddingTop`ä»å›ºå®šå€¼æ›´æ–°ä¸ºåŠ¨ç”»å€¼ã€‚

# æˆ‘ä»¬å®Œäº‹äº†ã€‚

![](img/0e593f463a52b96395ee480d88349e75.png)

Your newly completed pull to refresh animation

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å·²å®Œæˆçš„é¡¹ç›®[ã€‚æˆ–è€…åœ¨ starter é¡¹ç›®ä¸­ï¼Œå¯ä»¥æ£€å‡ºåˆ°åˆ†æ”¯`completed`æ¥æŸ¥çœ‹å®Œæˆçš„ç‰ˆæœ¬ã€‚](https://github.com/Groftware/pulltorefreshtutorial/tree/completed)

> ç¼–è¾‘:å¯¹äºé‚£äº›å¯¹ä½¿ç”¨ä½œä¸ºç»„ä»¶æ„Ÿå…´è¶£çš„äººï¼Œæˆ‘ä¹ŸæŠŠå®ƒä½œä¸ºä¸€ä¸ª npm åŒ…æä¾›äº†ã€‚åœ¨è¿™é‡ŒæŸ¥çœ‹ã€‚

[](http://eepurl.com/gZEdtb) [## è½¯ä»¶å¼€å‘

### ä½ å‡†å¤‡å¥½è¿›å…¥ä¸‹ä¸€å…³äº†å—ï¼ŸğŸš€ç«‹å³æ³¨å†Œæˆ‘ä»¬çš„æ—¶äº‹é€šè®¯ï¼Œæ¥æ”¶æ–°é²œå‡ºç‚‰çš„è½¯ä»¶å¼€å‘â€¦

eepurl.com](http://eepurl.com/gZEdtb) 

# é“¾æ¥

*   æ´›ä¼¦Â·å¸ƒé‡Œåˆ‡ç‰¹
*   [æ‹‰è‡³åˆ·æ–°](https://en.wikipedia.org/wiki/Pull-to-refresh)
*   [æ´›è’‚æ¡£æ¡ˆ](https://lottiefiles.com/)
*   [æ´›è’‚-ååº”-åŸç”Ÿ](https://www.npmjs.com/package/lottie-react-native)
*   [React åŸç”ŸåŠ¨ç”» API](https://reactnative.dev/docs/animated)
*   [é¦–å‘é¡¹ç›®](https://github.com/Groftware/pulltorefreshtutorial)
*   [å·²å®Œæˆé¡¹ç›®](https://github.com/Groftware/pulltorefreshtutorial/tree/completed)