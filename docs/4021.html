<html>
<head>
<title>How To Embed VSCode Into A Browser With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用React将VSCode嵌入浏览器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/embed-a-runnable-vs-code-clone-with-react-882173be2aae?source=collection_archive---------3-----------------------#2020-11-11">https://javascript.plainenglish.io/embed-a-runnable-vs-code-clone-with-react-882173be2aae?source=collection_archive---------3-----------------------#2020-11-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d5da980b47507680cf14c73b5be88957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EVzQD4a0tR63lP4I6HHwmQ.gif"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><a class="ae jz" href="https://github.com/Open-EdTech/react-run-code" rel="noopener ugc nofollow" target="_blank">https://github.com/Open-EdTech/react-run-code</a></figcaption></figure><h1 id="5f92" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">为什么我想要一个可运行的VSCode克隆</h1><p id="5d41" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">要解释为什么TypeScript很重要，您需要解释为什么开发人员工具很重要。为了解释为什么开发人员工具很重要，您需要一个代码编辑环境。幸运的是，VSCode的编辑器(monaco editor)是开源的，感觉就像VSCode。通过在我的网页中嵌入monaco编辑器，我可以比任何其他网站更好地解释TypeScript。</p><p id="5c78" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">此外，monaco编辑器可以将TypeScript转换为JavaScript，我们可以在浏览器中运行JavaScript并输出结果以获得交互式教育体验。</p><h2 id="bb9b" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">嵌入摩纳哥编辑器</h2><p id="c94a" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">Monaco editor不是react组件，你需要把它带入react。值得庆幸的是，有人编写了一个库<a class="ae jz" href="https://github.com/suren-atoyan/monaco-react" rel="noopener ugc nofollow" target="_blank"/>，以优雅的方式做到了这一点(并避免了其他可用库的一些webpack问题)。</p><h1 id="d174" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">运行代码</h1><p id="5960" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">默认情况下，monaco编辑器不运行代码。它有语法高亮、自动完成、红色曲线、悬停信息等功能。那么我们如何运行代码呢？</p><p id="42c9" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">基本上我们是这样做的:</p><figure class="mn mo mp mq gt jo"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="f4a3" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">运行TypeScript</h2><p id="d931" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我很确定不能像那样运行TypeScript代码，我们需要像JavaScript一样运行它。monaco编辑器有一个TypeScript编译器，用于检查您的TypeScript代码。您可以使用它来发出单个模型的输出，模型基本上只是VSCode中的一个文件。</p><figure class="mn mo mp mq gt jo"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="128a" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">然后获取发出的JavaScript并运行它。</p><h1 id="d7bc" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">构建控制台</h1><p id="bec7" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><a class="ae jz" href="https://github.com/samdenty/console-feed" rel="noopener ugc nofollow" target="_blank">控制台进料</a>反应组件是这样一个时间节省(它看起来真棒！)</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/b71891ba0d4a1ddf4bdc071260620748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sndBzbVFfLr5wsrbaTEP5g.gif"/></div></div></figure><p id="9db6" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">该组件读取控制台的消息，并输出gif中显示的格式。我们修改了这个组件，在每次运行时清除日志，以防止日志无休止地堆积。</p><h2 id="3f32" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">支持多个控制台</h2><p id="0bc2" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我们希望每个页面有多个编辑器，默认情况下，他们的控制台都会打印相同的消息，因为我们只是从控制台读取日志。我们如何通过发送消息的编辑器隔离控制台消息？</p><p id="f881" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我们让每个编辑器输出它们唯一的编辑器ID作为被覆盖的<code class="fe mu mv mw mx b">console.log </code>中的最后一个参数，以区分消息源。</p><figure class="mn mo mp mq gt jo"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="6f6e" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">只有当提供的最后一个参数与控制台组件的ID匹配时，我们才会将消息记录到控制台组件中。</p><h2 id="cace" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">分级用户输入</h2><p id="6232" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我有一个想法，那就是用一种不涉及任何服务器调用的方式来“分级”用户代码可能是有用的。问题是您将很难从运行在<code class="fe mu mv mw mx b">Function(code)()</code>内部的代码中调用API。此外，由于评分过程完全发生在客户端，因此无法使评分“不可破解”。</p><p id="03e2" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">所以我们做一些简单的事情。如果来自控制台的消息是“问题已解决”，则问题已解决。通过解决我的意思是网站的所有者可以使用一个回调函数，当这个消息被记录时执行自定义逻辑。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi my"><img src="../Images/2e51d647b0b25450ab4d629dd43264cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Z4Oo8DHbewOlooF9oMTisw.gif"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">console.log(“Problem solved”) executes user defined function.</figcaption></figure><h1 id="bcff" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">支持多个文件</h1><h2 id="61e5" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">制表符</h2><p id="a7eb" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">摩纳哥编辑器没有标签。我设计了选项卡的样式，并实现了选项卡的创建和删除。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mz"><img src="../Images/1e20bd7471143565778412f6226dc7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HOVgXsUMB9Qb6_3-qMkZkQ.gif"/></div></div></figure><p id="8d2d" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">我还使用React-Dnd重新排列标签，就像在VSCode中一样。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/4b57df5c3e5dcf5763e7918fe5811beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*D0j3sb8vsKTR2EqGkhcnRw.gif"/></div></div></figure><h2 id="bd4e" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">进出口</h2><p id="a9a9" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我采用了一种非常粗糙的方法来进行模块捆绑(这是已知的错误)。我使用正则表达式生成依赖图。</p><figure class="mn mo mp mq gt jo"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="9870" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">然后执行拓扑排序，将文件堆叠在一起。我开始使用一些非常好的(并且经过良好测试的！)代码来自<a class="ae jz" href="https://leetcode.com/problems/course-schedule-ii/" rel="noopener ugc nofollow" target="_blank">这个LeetCode问题</a>的讨论部分。</p><figure class="mn mo mp mq gt jo"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="acc3" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">模型在页面上共享，所以我可以在同一个页面上从不同的编辑器导入。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nb"><img src="../Images/c02d5508601eb09240aa4749803f7f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pmdMfsEV898Ik5yIDEOFTA.gif"/></div></div></figure><p id="03cc" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">粗暴的做事方式并不总是奏效。如果你打开一个名为“0.ts”的文件，它会显示生成的代码，这样你就可以诊断问题。这里我们被一个重复的声明搞砸了。</p><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nc"><img src="../Images/4558f5898199fd13707aef4c19348ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uVMJy_X2-ayxN62eAwS24A.gif"/></div></div></figure><h2 id="c7e6" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">自定义文件</h2><p id="77ee" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我为文件提供了一些不同的选项，您可以自定义来决定最初选择哪个选项卡，文件是否应该是只读的，文件是否应该显示，等等。</p><figure class="mn mo mp mq gt jo"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="5637" class="mb kb in bd kc mc md dn kg me mf dp kk lj mg mh ko ln mi mj ks lr mk ml kw mm bi translated">快速编写交互式内容</h2><p id="542e" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">要创建编辑器的初始状态，您可以创建一个空编辑器，创建一个新文件，并使用绿色的<code class="fe mu mv mw mx b">&lt;&gt;</code>将<code class="fe mu mv mw mx b">modelsInfo</code>的配置复制到剪贴板。</p><pre class="mn mo mp mq gt nd mx ne nf aw ng bi"><span id="c4e2" class="mb kb in mx b gy nh ni l nj nk">import React from "react";<br/>import Editor from "react-run-code";<br/><br/>function App() {<br/>  return &lt;Editor id="10" modelsInfo={[]} /&gt;;<br/>}<br/><br/>export default App;</span></pre><figure class="mn mo mp mq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/937974bbbbc14d782ce5474e0b718fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LMe2Y_UsNRxiZCqDBqiEXw.gif"/></div></div></figure><p id="1658" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">你现在可以进入你的源代码，粘贴<code class="fe mu mv mw mx b">[{"value":"console.log(\"make a new file\")","filename":"new.ts","language":"typescript"}]</code>来代替道具<code class="fe mu mv mw mx b">modelsInfo={[]}</code>的<code class="fe mu mv mw mx b">[]</code>。</p><h1 id="d505" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">后续步骤</h1><p id="ddfd" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我已经手动测试了这个组件很多次，但是我需要学习Jest并运行一些测试！我仍然在争论我是否应该尝试实现运行时捆绑，我看到了一篇关于这个主题的很好的博客文章。</p><h1 id="a552" class="ka kb in bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">摘要</h1><p id="48c1" class="pw-post-body-paragraph ky kz in la b lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">仅仅是另一个博客和真正特别的东西(教育平台)之间的距离？)正是您投入构建内部工具以快速创建内容丰富的交互式组件的时间。该组件并不完美，但它已经足够好，让我开始使用它。</p><p id="a8ee" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">在npm上试试吧。</p></div><div class="ab cl nm nn hr no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ig ih ii ij ik"><p id="9319" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">NPM:<a class="ae jz" href="https://www.npmjs.com/package/react-run-code" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/react-run-code</a></p><p id="0a97" class="pw-post-body-paragraph ky kz in la b lb lw ld le lf lx lh li lj ly ll lm ln lz lp lq lr ma lt lu lv ig bi translated">GitHub:<a class="ae jz" href="https://github.com/MatthewCaseres/react-run-code" rel="noopener ugc nofollow" target="_blank">https://github.com/Open-EdTech/react-run-code</a></p></div></div>    
</body>
</html>