<html>
<head>
<title>Adding Tailwind support to a Nrwl NX workspace with Angular and Storybook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Angular和Storybook为Nrwl NX工作区添加顺风支持</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-tailwind-support-to-a-nrwl-nx-workspace-with-angular-and-storybook-bf890ea882e?source=collection_archive---------2-----------------------#2020-03-26">https://javascript.plainenglish.io/adding-tailwind-support-to-a-nrwl-nx-workspace-with-angular-and-storybook-bf890ea882e?source=collection_archive---------2-----------------------#2020-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/798c91afedf73f9d53611698d64df578.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*xI_uIGBhgiMJMfNw.png"/></div></figure><p id="e5f1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在本文中，我将解释如何向现有的<a class="ae ks" href="https://nx.dev" rel="noopener ugc nofollow" target="_blank"> Nrwl NX </a>工作区(已经配置了Angular apps/libs和<a class="ae ks" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank"> Storybook </a>)添加<a class="ae ks" href="https://tailwindcss.com/" rel="noopener ugc nofollow" target="_blank"> Tailwind </a>支持。</p><p id="c28f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">本文将<em class="kt">而非</em>帮助你安装Nx、Angular或Storybook。如果你正在寻找，那么<a class="ae ks" href="https://nx.dev/angular/getting-started/what-is-nx" rel="noopener ugc nofollow" target="_blank">去别处</a><a class="ae ks" href="https://nx.dev/angular/guides/modernize-storybook-angular" rel="noopener ugc nofollow" target="_blank"/>:)</p><h1 id="2403" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">安装顺风</h1><p id="2fb9" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated"><a class="ae ks" href="https://tailwindcss.com/docs/installation/" rel="noopener ugc nofollow" target="_blank">安装顺风</a>相当简单。</p><p id="703a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，将以下依赖项添加到您的工作区:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="aca1" class="mg kv iq mc b gy mh mi l mj mk">npm install tailwindcss --save-dev</span></pre><p id="7f5e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">(顺便说一句，官方文档建议将Tailwind安装为一个依赖项，而不是devDependency，但我并不太喜欢<a class="ae ks" href="https://github.com/tailwindcss/discuss/issues/358" rel="noopener ugc nofollow" target="_blank"> Adam的基本原理</a>，尽管其中有些道理:p)。</p><p id="d07b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，假设您使用的是SCSS文件，编辑应用程序的主样式表(通常在apps/ <app_name> /src/styles.scss下)，并在顶部添加以下内容:</app_name></p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="0814" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请注意，这些导入并不像现有导入那样以“~”字符开头。我没有时间深入细节，但它对我来说是这样的:)</p><p id="256f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，使用以下命令创建初始顺风配置文件:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="3669" class="mg kv iq mc b gy mh mi l mj mk">npx tailwindcss init</span></pre><p id="4567" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如官方安装指南中所解释的，这将创建一个空的配置文件，稍后您将<a class="ae ks" href="https://tailwindcss.com/docs/configuration/" rel="noopener ugc nofollow" target="_blank">按照您认为合适的方式</a>对其进行定制。</p><p id="d64d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">顺风现在装上了，太好了！</p><p id="0c08" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">就这样吗？不完全是。如果你试图在这一点上使用一些顺风类，不会发生什么…</p><p id="0332" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">那么少了什么呢？嗯，Tailwind需要一个构建步骤，所以我们需要将它集成到我们的构建系统中。</p><h1 id="a98f" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">给角形建筑增加顺风支撑</h1><p id="3a6c" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">现在Tailwind已经在Nx工作区中可用了，您需要修改angular.json文件，以便将Tailwind集成到构建管道中。</p><p id="c229" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最好的方法是使用自定义的Webpack配置。这是Angular支持的，也很容易做到，但是如果Angular脱离Webpack，将来可能会有问题..不管怎样…</p><p id="cbb2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如顺风的<a class="ae ks" href="https://tailwindcss.com/docs/installation/#webpack" rel="noopener ugc nofollow" target="_blank">官方文档中所解释的，可以通过使用</a><a class="ae ks" href="https://postcss.org/" rel="noopener ugc nofollow" target="_blank"> PostCSS </a>和<a class="ae ks" href="https://github.com/postcss/postcss-loader" rel="noopener ugc nofollow" target="_blank"> postcss-loader </a>与Webpack集成。</p><p id="49af" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">补充说明:PostCSS是一个复杂的东西，我不会在这里讨论它，但是如果你还不了解它，去看看吧，你可能会喜欢它能为你做的事情。</p><p id="a139" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，安装以下依赖项:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="0d32" class="mg kv iq mc b gy mh mi l mj mk">npm install <a class="ae ks" href="http://twitter.com/angular" rel="noopener ugc nofollow" target="_blank">@angular</a>-builders/custom-webpack postcss-loader postcss-import postcss-scss autoprefixer --save-dev</span></pre><p id="3c7b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">第一个是<a class="ae ks" href="https://www.npmjs.com/package/@angular-builders/custom-webpack" rel="noopener ugc nofollow" target="_blank">Angular的库，增加了对使用定制Webpack配置进行构建的支持</a>，其他的是PostCSS的必要元素。</p><p id="658d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后一个(<a class="ae ks" href="https://github.com/postcss/autoprefixer" rel="noopener ugc nofollow" target="_blank"> autoprefixer </a>)是一个很好的PostCSS插件，它将负责在生成的CSS代码中添加所有必要的供应商前缀，这样您就不必这么做了。鉴于官方的顺风安装文档中提到了它，我假设它是强制性的，但我可能错了。</p><p id="87e2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这种方法的好消息是，它补充了Angular CLI的原始Webpack版本，但并没有完全取代它(否则这将是一场噩梦！).</p><p id="3a12" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，打开angular.json，修改应用程序的“架构师”部分，如下所示:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="318e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如您所见，您只需替换应用程序配置的“构建”和“服务”部分中的“构建器”设置。你可以让其余的保持原样。</p><p id="0a1b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">完成后，在构建应用程序时，构建将考虑我们的Webpack配置。</p><p id="6793" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，您需要创建Webpack配置。</p><p id="bc10" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">继续在工作区的根目录下创建一个“webpack.config.js”文件，其内容如下:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="2aa2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个Webpack配置中，您可以看到我们已经定义了从另一个文件导入的单个<a class="ae ks" href="https://webpack.js.org/configuration/module/#rule" rel="noopener ugc nofollow" target="_blank">规则</a>。我这样做是为了能够在Storybook的上下文中重用相同的顺风配置。</p><p id="67c2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为此，您还需要在工作区的根目录下创建“webpack-common.config.js”文件:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="bffe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个JS模块中，我们定义并导出了一个Webpack规则(基于官方的Tailwind文档)。这条规则只是告诉Webpack。scss”文件应由<a class="ae ks" href="https://github.com/postcss/postcss-loader" rel="noopener ugc nofollow" target="_blank">post CSS-loader</a>web pack loader处理。最后，加载程序配置了一些插件，包括Tailwind！</p><p id="7849" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，当应用程序的Angular build启动时，它将调用自定义webpack配置，这将让postcss-loader处理scss文件，这又会让Tailwind在将它们传递给autoprefixer插件之前进行处理。</p><p id="d6f0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当然，你可以疯狂地使用PostCSS配置，因为它确实是一个强大的工具(这个名字选得很糟糕，因为它实际上可以对你的文件进行预处理和后处理)，但那是另外一个故事了。</p><p id="7514" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要完成这一部分，您还需要一个文件:“helpers.js”，这是一个简单的模块，导出一个我们在webpack-common.config.js中使用的实用函数:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="538f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个“root”函数只是返回您需要的任何文件的根目录相对路径。当我们将Tailwind与Storybook集成时，以及在任何其他需要根目录相对路径的情况下(当您摆弄构建系统时，这是非常常见的)，这将很快被证明是有用的。</p><p id="1fef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此时，你可以开始了，你的应用程序中应该有顺风，你可以利用它。</p><h1 id="0b7e" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">给Nx的故事书版本增加顺风支持</h1><p id="9f83" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">既然Tailwind已经正确地集成到您的Nx工作空间中，那么向Storybook版本添加相同的支持就非常简单了。</p><p id="65dd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当Storybook通过Nx CLI添加到Nx工作空间中时，Nx会添加一个“.”。storybook”文件夹。然后，一旦故事书被添加到某个库中，Nx也会在那里添加一个. Storybook文件夹；因此，有两个故事书配置级别。</p><p id="e3ac" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在每一个里面”。故事书”文件夹中，您会发现多个元素:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="4c0f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如您所见，这里有一个“webpack.config.js”文件。这很酷，这意味着Storybook是使用Webpack构建的，我们可以对它进行定制，以包含我们之前添加到“webpack.config.js”文件中的Webpack规则！</p><p id="9bb8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">中的“webpack.config.js”文件。storybook”文件夹加载工作空间根文件夹中的“webpack.config.js”文件。storybook”文件夹(即，库本地配置加载/扩展工作空间根配置)</p><p id="c613" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">了解了这一点，您就可以决定将定制放在您喜欢的地方。或者通过工作区中Storybook的根webpack配置进行全局配置，或者在您认为合适的每个库中进行本地配置。选择权在你。如果您计划在所有“支持故事书”的库中使用Tailwind，那么您可能应该将修改放在根目录下。</p><p id="a67c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你想只为一个特定的库添加Tailwind支持，那么编辑它的”。storybook/webpack.config.js "文件如下:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="f338" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">上面，我们简单地加载根配置并将我们的规则推入规则数组。干净简单。不过，要注意目录结构中的向上路径；根据库的嵌套情况，它可能需要一些修改；-)</p><p id="a7df" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者(最好是！)，您可以简单地在您的工作区的根目录下修改一下Storybook的Webpack配置。/.storybook/webpack.config.js”如下:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="4c7a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">瞧，Tailwind现在也可以在你的故事书故事里工作了，不是很棒吗？:)</p><p id="c2df" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这种方法的优势(无论是在全局还是本地应用)在于，您可以集中管理您的Tailwind和PostCSS配置，而不是到处复制。</p><p id="67f6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">今天就到这里吧！</p><h2 id="fd5e" class="mg kv iq bd kw mn mo dn la mp mq dp le kf mr ms li kj mt mu lm kn mv mw lq mx bi translated"><strong class="ak">来自JavaScript的简单英语注释</strong></h2><p id="c7bd" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">我们推出了三种新的出版物！通过以下方式表达对我们新出版物的热爱:<a class="ae ks" href="https://medium.com/ai-in-plain-english" rel="noopener"> <strong class="jw ir">通俗易懂的AI</strong></a>、<a class="ae ks" href="https://medium.com/ux-in-plain-english" rel="noopener">、<strong class="jw ir">通俗易懂的UX</strong>、</a>、<a class="ae ks" href="https://medium.com/python-in-plain-english" rel="noopener">、<strong class="jw ir">通俗易懂的Python</strong>、</a>、<strong class="jw ir">、</strong>——谢谢您，继续学习！</p><p id="0758" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们也一直对帮助推广高质量内容感兴趣。如果您有一篇文章想提交给我们的任何出版物，请用您的Medium用户名在<a class="ae ks" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">submissions @ plain English . io</strong></a><strong class="jw ir"/>发邮件给我们，我们会将您添加为作家。另外，请告诉我们您想添加到哪个出版物中。</p></div></div>    
</body>
</html>