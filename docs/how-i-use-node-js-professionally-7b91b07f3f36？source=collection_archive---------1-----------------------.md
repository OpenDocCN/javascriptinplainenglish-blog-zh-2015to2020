# 我如何专业地使用 Node.js

> 原文：<https://javascript.plainenglish.io/how-i-use-node-js-professionally-7b91b07f3f36?source=collection_archive---------1----------------------->

## 它切片了！它是骰子！但是等等！还有呢！

![](img/1fde4a3a0d2eb8a00a7851d31531d153.png)

Photo by [Caspar Camille Rubin](https://unsplash.com/@casparrubin?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

使用合适的工具完成工作。但是，当我们发现一个工具可以在许多不同的方面有效地使用时，这是令人敬畏的。

我使用 Node 为我的客户开发解决方案。这些解决方案可能只是一个 API，或者通过 REST 接口与前端框架集成。但这些解决方案有时涉及设置 WebSocket 服务器、命令行脚本、一次性数据操作任务、创建或访问作业队列，甚至是以模块化方式完成所有事情的综合包。

下面是我如何分解我的任务

*   数据访问。当我处理关系数据库时，我使用 [**Knex.js**](http://knexjs.org/) 来[创建我的数据模型](https://medium.com/javascript-in-plain-english/node-js-and-relational-databases-2198152732b6)。对于非关系数据库，我将使用适当的库。无论采用哪种方式，我都将对数据存储的访问封装到有意义的数据对象中，这些对象可以独立于应用程序使用。这使我可以毫不费力地从批处理文件或其他应用程序中调用我的数据项。
*   商业逻辑。我喜欢将应用程序逻辑隔离到一个单独的层中，尤其是对于非平凡的应用程序。将我们想要做的事情与我们要求它如何发生以及数据如何存储分开是很方便的。我发现这种分离给了我更大的灵活性来响应应用程序不断发展的需求，而不会在通信方法上陷入困境。这也使得将应用程序分解成更小的模块变得更加容易。
*   API。我用快递。JS 在需要时快速构建接入点。那些接入点被设计得非常轻。我更喜欢从请求中提取我需要的信息，然后调用特定于解决方案的逻辑层来进行任何数据处理或检索。该逻辑层又调用与数据库交互的数据对象，以从持久存储中存储/检索数据。我将在有意义的地方创建 REST 端点，但是我也将为更复杂的请求创建 POST 端点。
*   Websockets。当有意义时，我将使用`ws`模块创建一个套接字服务器。我也可以设置`express-ws`来创建一个 HTTP/HTTPS 端点来访问套接字服务器。如果可能的话，我尽量使用 API 调用的相同业务逻辑对象。
*   报道。我将数据的表示留给专用系统——比如 Tableau 或图表工具。我使用 Node 为这些系统准备数据。
*   文件管理。有时候我们只需要移动一个文件，或者删除它，或者读取它的内容。我使用本机的`**fs**`模块，或 [**fs-extra**](https://www.npmjs.com/package/fs-extra) 模块来执行这些步骤。当我使用流来处理大型数据集并且需要将结构化数据传送到下一个步骤时，我使用 [**到 2**](https://www.npmjs.com/package/through2) 。我还将使用 [**fast-csv**](https://www.npmjs.com/package/fast-csv) 来处理 csv 文件。
*   部署前处理。实际上，这通常是运行 [**Webpack**](https://webpack.js.org/) 、[**package**](https://parceljs.org/)或另一个反代码捆绑器系统。尽管有时在部署下一组代码时要做准备工作——应用数据库结构变更、修改任何动态模板、收集文件等。在这些情况下，我编写一个脚本来完成 bundler 系统无法处理的任何其他步骤。本质上它是批处理。
*   计划任务。我创建执行特定任务的 JS 文件。这可能是清除过时的日志、处理作业队列、带外批量发送电子邮件等。我编写每个脚本时都有一个目的，然后使用 CRON 以合理的时间间隔调用该脚本。这些任务通常是处理量更大的事情，在网页中无法很好地执行。或者是做家务以保持应用程序快速运行。
*   批量处理。我经常创建一个界面来方便数据获取。然后，管理层希望进行批量输入，但不希望在应用程序界面中公开批量输入流程。这可能是用多年的数据或所有产品预先填充应用程序，或者一次更新 100 个或用户记录。这些任务可能是一次性的，也可能是定期重复的。无论哪种方式，要做的工作都差不多。读取源数据，以某种方式对其进行处理，然后用这些数据做一些事情。
*   命令行脚本。类似于批处理，但批处理脚本的使用模式要窄得多。命令行脚本可以接受参数来定义源数据的位置、输出的理想位置以及调整处理方式的其他设置。我使用 [**yargs**](https://www.npmjs.com/package/yargs) 或[**minimit**](https://www.npmjs.com/package/minimist)来解析命令行参数。从这里开始，它就像批处理一样。

对于一次性脚本，我只是用`node path/to/my_script.js`来调用它们。对于循环任务，我在 package.json 文件中添加了一个脚本属性，这样我就可以用`npm run mytask`类型的语句执行命令。

你用 Node 吗？JS 换一种方式？如果有，留下评论让我知道。如果能听到我可以探索的其他方法，那就太好了。