<html>
<head>
<title>How to use Chart.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Chart.js</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/exploring-chart-js-e3ba70b07aa4?source=collection_archive---------2-----------------------#2018-10-08">https://javascript.plainenglish.io/exploring-chart-js-e3ba70b07aa4?source=collection_archive---------2-----------------------#2018-10-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/137f1c7354b3415e48420b958501b690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CPSTzfUTCCpUbllyiPvl_A.jpeg"/></div></div></figure><p id="259f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae kt" href="https://www.chartjs.org/" rel="noopener ugc nofollow" target="_blank"> Chart.js </a>是一个流行的开源库，帮助我们在web应用程序中绘制数据。它是高度可定制的，但是配置它的所有选项对一些人来说仍然是一个挑战。让我们从一个简单的例子开始，并在此基础上进行探索。</p><p id="f1a5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">基本实现:</strong> <br/>为了简单起见，我打算用CDN版的库。然而，如果你打算将它与React或Angular一起使用，我建议你使用<a class="ae kt" href="https://www.npmjs.com/package/chartjs" rel="noopener ugc nofollow" target="_blank"> npm包</a>并通过<code class="fe ku kv kw kx b">npm install chart.js --save</code>安装它。</p><p id="479c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还将使用jQuery来发出ajax请求。<br/>我们的基本实现将绘制一家餐馆一周中每天的收入数据。</p><p id="6ff5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们从<strong class="jx io">index.html</strong>开始</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="f016" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">还有<strong class="jx io"> myChart.js </strong></p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="62aa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">设置<code class="fe ku kv kw kx b">type</code> <em class="le"> </em>变量，我们可以将折线图变成条形图，甚至饼图。所有不同类型的图表都可以在这里看到<a class="ae kt" href="http://www.chartjs.org/samples/latest/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8b2a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">可以看到，<code class="fe ku kv kw kx b">datasets</code>是一个数组。这意味着我们可以在同一个图表中绘制两个或更多的数据系列。我们将在本文的后面回到这种可能性。</p><p id="3db6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">到目前为止，我们项目的成果是:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/924bad7e11bede22e215a712d9c33705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/0*dXiwKGxGJ-mPju_g"/></div></figure><p id="53ed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">我不喜欢它的地方:</strong><br/>-Y轴不是从0开始的。它从12000开始，是系列中的最低值；<br/> -是灰色，我想要其他颜色；<br/> -不显示货币形式的数据:20000-&gt;20，000.00美元</p><p id="8b2f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，我做了一些修改:</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="e05d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第1行:<br/> <code class="fe ku kv kw kx b">float2dollar</code>是一个函数，它将一个浮点数格式化成一个货币字符串:<br/> 18000 - &gt; U$ 18，000.00</p><p id="6e18" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第14行:<br/> <code class="fe ku kv kw kx b"><em class="le">boderColor</em></code>和<code class="fe ku kv kw kx b">backgroundColor</code> <em class="le"> </em>是改变线条和区域颜色的属性。</p><p id="ff1b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第22行:<br/> <em class="le"> </em> <code class="fe ku kv kw kx b"><em class="le">beginAtZero: true</em></code>强制坐标轴从0开始，而不是从12000开始。</p><p id="6f45" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第23行:<br/> <code class="fe ku kv kw kx b">callback</code>轴的<code class="fe ku kv kw kx b">ticks</code>在每次渲染一个刻度时被调用。<code class="fe ku kv kw kx b">value</code>变量是显示的默认值。当我们覆盖这个回调时，我们可以改变显示在轴上的文本。在这里，我们调用我们的<code class="fe ku kv kw kx b">float2dollar</code>函数。</p><p id="fc41" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们已经可以看到变化:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lg"><img src="../Images/ffba00e9af8f35e88d419c43e33841ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*7YTYwXJjAJ86gcNUIpvB-g.png"/></div></div></figure><p id="dea5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">从Ajax请求中加载数据:</strong></p><p id="e049" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了有一个允许我们不做太多工作就发出GET请求的后端，我们将使用包<a class="ae kt" href="https://www.npmjs.com/package/json-server" rel="noopener ugc nofollow" target="_blank"> json-server </a>。它可以从JSON文件模拟REST服务器。</p><pre class="ky kz la lb gt lh kx li lj aw lk bi"><span id="10d4" class="ll lm in kx b gy ln lo l lp lq">npm install json-server -save</span></pre><p id="2bfc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我们的node package.json上，我们将npm启动脚本设置为以2秒的延迟运行json-server。因为数据都是本地的，所以我们会有即时的响应。人工延迟将帮助我们模拟真实的互联网连接。</p><pre class="ky kz la lb gt lh kx li lj aw lk bi"><span id="8816" class="ll lm in kx b gy ln lo l lp lq">“start”: “json-server data.json --delay 2000”,</span></pre><p id="d3c7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我们运行npm启动脚本时，服务将在端口3000上可用。</p><p id="3e73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为此，我们需要创建data.json文件。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="0fd9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还需要html上的一个新的div来显示一个“正在加载”的gif和一个错误消息。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="41ec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了使事情更有条理，我们将创建一个函数<code class="fe ku kv kw kx b">getChartData()</code>来将ajax请求与按钮点击分开。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="2ae3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">之后，我们有我们的加载gif。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lr"><img src="../Images/4dda2aefc00f36530a03fbc4a842e4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7HaVj4i5fQfAbZa8Zbi6AA.png"/></div></div></figure><p id="77c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">现在，让我们试一个有两个数据系列的图表:</strong> <br/>假设我们想比较本周和上周的收入。让我们用蓝色显示本周的系列，用灰色显示上周的系列。</p><p id="3ffa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们首先需要更新的是我们的data.json</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="08b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，我们需要更改myChart.js文件:</p><p id="08bb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们发送给renderChart函数的数据将是一个包含两个数组的数组。第一个(<code class="fe ku kv kw kx b">data[0]</code>)是本周的收入数据，第二个(<code class="fe ku kv kw kx b">data[1]</code>)是上周的数据。</p><p id="d8dd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，图表中的数据集将有第二个对象:上周的系列。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="70b3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">结果非常好，很容易直观地比较这两个星期。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/1de2687e0a5d0ce0fbada6af8bd81202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*xCsu-FqwftPbBZdaZadISQ.png"/></div></figure><p id="156b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">其他类型的图表:</strong> <br/>如前所述，Chart.js提供了种类繁多的图表类型。</p><p id="63f0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在这里研究的属性在不同类型的图形之间是共享的，只是有一些不同。例如，在饼图中，不是每个系列只传递一种颜色，而是传递一个颜色数组，因为饼图的不同部分应该有不同的颜色。</p><p id="11ce" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们使用<code class="fe ku kv kw kx b">title</code>的<code class="fe ku kv kw kx b">text</code>属性给图表添加一个标题。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="9421" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">结果是:</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/20e123afe3e916b6f6f3b31c7ae0109a.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*nF3hk-d8JmFVyVb1n0PbwQ.png"/></div></figure><p id="bd8c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">混合图表类型</strong> <br/> Chart.js允许我们在同一个画布上混合两种图表类型。让我们回到餐馆的例子。现在，我们希望分析我们每天有多少客户，但仍能看到收入。</p><p id="6c9c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本例中，我们可以将客户的条形图与收入的折线图混合使用。</p><p id="52b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">需要指出的是，在这种情况下，我们需要使用第二个Y轴。这是因为收入在数字上比客户多，因此条形在收入规模上非常小。</p><p id="5e84" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为此，我们将创建另一个文件，<strong class="jx io"> mixChart.js </strong></p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="e62c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要混合类型，您必须为图表定义一个主<code class="fe ku kv kw kx b">type</code>，对于您想要更改的图表，您必须在单个数据集中重新定义变量<code class="fe ku kv kw kx b">type</code>。对于我们的例子，我们将主类型设置为<code class="fe ku kv kw kx b">type: “bar"</code>，但是在第一个数据集中，我们重新定义了<code class="fe ku kv kw kx b">type: “line"</code>。</p><p id="ff92" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ku kv kw kx b">yAxes</code>是<code class="fe ku kv kw kx b">scales</code>的属性，是<code class="fe ku kv kw kx b">options</code>的对象。这个<code class="fe ku kv kw kx b">yAxes</code>实际上是一个数组，允许我们对不同的系列使用多个刻度。在这个例子中，我们使用两个Y轴。为此，我们需要为每一个都赋予一个<code class="fe ku kv kw kx b">id</code>。第一个Y轴有<code class="fe ku kv kw kx b">id:"revenues"</code>，第二个有<code class="fe ku kv kw kx b">id:"clients"</code>。</p><p id="a676" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在客户端轴上使用了<code class="fe ku kv kw kx b">position: 'right'</code>来显示图表右侧的刻度。为了提高可读性，我们还在每个轴上添加了一个<code class="fe ku kv kw kx b">labelString</code>，这样人们就可以知道左边的轴是收入，右边的轴是客户数量。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/c1da435410d1f5229da4a4522ffad1ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*_sWvvVWvLDD1lVd_NHb2XQ.png"/></div></figure><p id="a7aa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">现在怎么办？</strong> <br/>其实很多！正如你所看到的，Chart.js是非常可定制的，我们仍然需要看到许多主题来涵盖所有的可能性。</p><p id="15b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一些例子有:<br/> -显示堆叠数据；<br/> -自定义图例；<br/> -自定义工具提示；<br/> -二维数据类型；<br/> -交互事件(如点击)；<br/>——对数标度；<br/>还有更多…</p><p id="08c6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">还有就是改进Chart.js使用的插件，我觉得<a class="ae kt" href="https://github.com/chartjs/chartjs-plugin-datalabels" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">chart js-plugin-data labels</strong></a>特别有用，推荐大家看看。</p><p id="1098" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以在我们的<a class="ae kt" href="https://github.com/andregardi/exploring-chartjs" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中查看本文使用的文件。</p><p id="edfb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你想在未来阅读更多关于chart.js的内容，请在评论中告诉我们。</p></div></div>    
</body>
</html>