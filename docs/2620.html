<html>
<head>
<title>JavaScript Tips — Type Checks, Durations, and Promise Errors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript提示—类型检查、持续时间和承诺错误</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-tips-type-checks-durations-and-promise-errors-60e524b419ee?source=collection_archive---------11-----------------------#2020-07-09">https://javascript.plainenglish.io/javascript-tips-type-checks-durations-and-promise-errors-60e524b419ee?source=collection_archive---------11-----------------------#2020-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e09264b1c265e643f1609dea38881e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JNNjSpHAuM3BAAFX"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@johannsiemens?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Johann Siemens</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="364e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="99e8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">typeof和instanceof之间的区别</h1><p id="b451" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">instanceof</code>应该用于检查一个对象是否是一个构造函数的实例。</p><p id="47e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f2bd" class="mq lc iq mh b gy mr ms l mt mu">foo instanceof Foo;</span></pre><p id="33d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查<code class="fe me mf mg mh b">foo</code>是否是<code class="fe me mf mg mh b">Foo</code>构造函数的实例。</p><p id="6938" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">typeof</code>应该用于检查原语类型和函数。</p><p id="da35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b2dd" class="mq lc iq mh b gy mr ms l mt mu">typeof 1 === 'number'</span></pre><p id="048e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="89ce" class="mq lc iq mh b gy mr ms l mt mu">typeof () =&gt; {} === 'function'</span></pre><p id="ca05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们都回到了<code class="fe me mf mg mh b">true</code>。</p><p id="b418" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是<code class="fe me mf mg mh b">typeof null</code>返回<code class="fe me mf mg mh b">'object'</code>，所以我们不能用<code class="fe me mf mg mh b">typeof</code>来检查<code class="fe me mf mg mh b">null</code>。</p><h1 id="7203" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将HTMLCollection转换为数组</h1><p id="2f57" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要将HTMLCollection转换为数组，我们可以使用<code class="fe me mf mg mh b">Array.from</code>方法或spread操作符将HTMLCollection转换为数组。</p><p id="c3f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2743" class="mq lc iq mh b gy mr ms l mt mu">const arr = Array.from(htmlCollection);</span></pre><p id="572d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1670" class="mq lc iq mh b gy mr ms l mt mu">const arr = [...htmlCollection];</span></pre><p id="ba96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两种方法也适用于节点列表。</p><h1 id="af58" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从JavaScript对象中移除项目</h1><p id="a46b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要从JavaScript对象中移除一个项目，我们可以使用<code class="fe me mf mg mh b">delete</code>操作符。</p><p id="e7e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4466" class="mq lc iq mh b gy mr ms l mt mu">const obj = { foo: 1, bar: 2 };<br/>delete obj.foo;</span></pre><p id="c57d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后从<code class="fe me mf mg mh b">obj</code>中移除<code class="fe me mf mg mh b">foo</code>属性。</p><h1 id="34c7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">打开新窗口或标签</h1><p id="bfee" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要打开一个新窗口或标签，我们可以使用<code class="fe me mf mg mh b">window.open</code>方法。</p><p id="b717" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3bf8" class="mq lc iq mh b gy mr ms l mt mu">window.open('http://example.com', '_blank');</span></pre><p id="123f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">'_blank'</code>使<code class="fe me mf mg mh b">window.open</code>打开一个新窗口。</p><h1 id="ecb1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">JavaScript警告框中的换行符</h1><p id="e4d1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了在JavaScript警告框中显示一个新行，我们可以将新行字符添加到我们传递给<code class="fe me mf mg mh b">alert</code>的字符串中。</p><p id="4937" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="17c7" class="mq lc iq mh b gy mr ms l mt mu">alert("line 1\nline 2");</span></pre><p id="f8da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们显示2行文本，因为我们有了<code class="fe me mf mg mh b">\n</code>换行符。</p><h1 id="599b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在JavaScript中更改span元素的文本</h1><p id="324b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过改变<code class="fe me mf mg mh b">textContent</code>属性来改变span元素的文本。</p><p id="4085" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="eb7d" class="mq lc iq mh b gy mr ms l mt mu">document.getElementById("aSpan").textContent = "new stuff";</span></pre><p id="47f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需获取跨度并将<code class="fe me mf mg mh b">textContent</code>属性设置为一个新的字符串。</p><h1 id="fe05" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">检查用户是否正在使用IE</h1><p id="4e7e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要检查用户是否在使用IE，我们可以检查用户代理。</p><p id="855d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="00af" class="mq lc iq mh b gy mr ms l mt mu">const ua = window.navigator.userAgent;<br/>const ieIndex = ua.indexOf("MSIE");</span><span id="bccf" class="mq lc iq mh b gy mv ms l mt mu">if (ieIndex &gt;= 0 || !!ua.match(/Trident.*rv\:11\./))  {<br/>  console.log('is IE');<br/>}<br/>else {<br/>  console.log('not IE');<br/>}</span></pre><p id="f495" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">window.navigator.userAgent</code>得到用户代理。</p><p id="64a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在用户代理中获取<code class="fe me mf mg mh b">'MSIE'</code>字符串的索引，看看它是否在那里。</p><p id="2ed8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还会检查其中是否有单词<code class="fe me mf mg mh b">'Trident'</code>作为另一项检查。</p><p id="0b53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">两者结合起来，我们就可以检查一个浏览器是不是IE了。</p><h1 id="de6c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">获取Moment.js中两个日期之间的时差</h1><p id="c0fd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要获得moment.js中两个日期之间的小时差异，我们可以使用<code class="fe me mf mg mh b">duration</code>和<code class="fe me mf mg mh b">diff</code>方法。</p><p id="ec6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e00d" class="mq lc iq mh b gy mr ms l mt mu">const duration = moment.duration(end.diff(start));<br/>const hours = duration.asHours();</span></pre><p id="5146" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe me mf mg mh b">duration</code>方法从<code class="fe me mf mg mh b">start</code>减去<code class="fe me mf mg mh b">end</code>得到持续时间，这两个都是矩对象。</p><p id="4111" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">duration</code>上的<code class="fe me mf mg mh b">asHours</code>将持续时间转换为小时。</p><h1 id="fcc0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在JavaScript对象中以字符串形式通过名称访问变量属性</h1><p id="94db" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用括号nation来访问带有变量的JavaScript属性。</p><p id="0e6f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b2a5" class="mq lc iq mh b gy mr ms l mt mu">const foo = obj['foo'];</span></pre><p id="9f5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来获取<code class="fe me mf mg mh b">obj</code>的<code class="fe me mf mg mh b">foo</code>属性。</p><p id="6abb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嵌套属性可以用多个括号来访问。</p><p id="4a88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5fc6" class="mq lc iq mh b gy mr ms l mt mu">const obj = { a: 1, b: { x: 2 }};</span></pre><p id="3cba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下内容来访问<code class="fe me mf mg mh b">x</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="768a" class="mq lc iq mh b gy mr ms l mt mu">const foo = obj['b']['x'];</span></pre><h1 id="e3ed" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">JavaScript承诺——拒绝还是放弃</h1><p id="cc96" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在承诺回调中使用<code class="fe me mf mg mh b">throw</code>。</p><p id="30b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们使用<code class="fe me mf mg mh b">reject</code>。</p><p id="25a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fdd2" class="mq lc iq mh b gy mr ms l mt mu">new Promise(() =&gt; {<br/>  throw 'error';<br/>})</span></pre><p id="8d3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在传递给<code class="fe me mf mg mh b">Promise</code>构造函数的回调中使用<code class="fe me mf mg mh b">throw</code>。</p><p id="95a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">throw</code>也终止控制流程。</p><p id="d202" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在那里或其他任何地方使用<code class="fe me mf mg mh b">reject</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="38f8" class="mq lc iq mh b gy mr ms l mt mu">new Promise((resolve, reject) =&gt; {<br/>  reject('error');<br/>})</span></pre><p id="7042" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe me mf mg mh b">reject</code>，但是它后面的东西如果在的话还是可以运行的。</p><p id="926d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们都可以用<code class="fe me mf mg mh b">catch</code>方法抓住。</p><h1 id="49ce" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="79bb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">typeof</code>和<code class="fe me mf mg mh b">instanceof</code>用于检查不同的东西。</p><p id="900b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用moment.js得到两次约会之间的持续时间。</p><p id="ed98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">html集合和节点列表可以转换为数组。</p><p id="3361" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以检查用户代理来检查用户是否在使用IE。</p><h2 id="8c96" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">简单英语的JavaScript</h2><p id="a117" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>