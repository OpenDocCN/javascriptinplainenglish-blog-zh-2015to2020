<html>
<head>
<title>JavaScript Best Practices — Arrays and Exceptions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—数组和异常</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-arrays-and-exceptions-87cb2fd104d5?source=collection_archive---------5-----------------------#2020-08-07">https://javascript.plainenglish.io/javascript-best-practices-arrays-and-exceptions-87cb2fd104d5?source=collection_archive---------5-----------------------#2020-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b3bf0e2ad9f966d18f0f121a65367102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DBczKvqB4fOkZpy5"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@lucabravo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Luca Bravo</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="141b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些在编写JavaScript代码时应该遵循的最佳实践。</p><h1 id="66a7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免对数组使用for-in循环</h1><p id="5f22" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该避免对数组使用for-in循环。</p><p id="52c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c6aa" class="mn lc iq mj b gy mo mp l mq mr">let sum = 0;  <br/>for (let i in arrayNumbers) {  <br/>  sum += arrayNumbers[i];  <br/>}</span></pre><p id="5912" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用for循环或for-of循环:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="283f" class="mn lc iq mj b gy mo mp l mq mr">let sum = 0;  <br/>for (let a of arrayNumbers) {  <br/>  sum += a;  <br/>}</span></pre><p id="0989" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="632e" class="mn lc iq mj b gy mo mp l mq mr">let sum = 0;<br/>for (let i = 0, len = arrayNumbers.length; i &lt; len; i++) {  <br/>  sum += arrayNumbers[i];  <br/>}</span></pre><p id="1b49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">for-in循环用于遍历常规对象，而不是数组。</p><h1 id="8ae8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">向setTimeout()和setInterval()传递函数，而不是字符串</h1><p id="31c6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该总是将功能传递给<code class="fe ms mt mu mj b">setTimeout</code>和<code class="fe ms mt mu mj b">setInterval</code>。</p><p id="43d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不要写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f7d0" class="mn lc iq mj b gy mo mp l mq mr">setInterval('doSomething()', 1000);  <br/>setTimeout('doSomething()', 5000);</span></pre><p id="249a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="650c" class="mn lc iq mj b gy mo mp l mq mr">setInterval(doSomething, 1000);  <br/>setTimeout(doSomething, 5000);</span></pre><h1 id="da23" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用switch/case语句代替一系列if/else语句</h1><p id="0e29" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe ms mt mu mj b">switch</code>和<code class="fe ms mt mu mj b">case</code>比一系列的<code class="fe ms mt mu mj b">if</code>和<code class="fe ms mt mu mj b">else</code>要短。</p><p id="e0bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比如，我们可以写；</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="44b7" class="mn lc iq mj b gy mo mp l mq mr">switch (val) {<br/>  case 1:<br/>    //...<br/>    break;<br/>  case 2:<br/>    //...<br/>    break;<br/>  case 3:<br/>    //...<br/>    break;<br/>  case 4:<br/>    //...<br/>    break;<br/>  default:<br/>    //...<br/>}</span></pre><p id="463f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这比以下组织得更好:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0139" class="mn lc iq mj b gy mo mp l mq mr">if (val === 1) {<br/>  //...<br/>}<br/>else if (val === 2) {<br/>  //...<br/>}<br/>else if (val === 3) {<br/>  //...<br/>}<br/>else if (val === 4) {<br/>  //...<br/>}<br/>else {<br/>  //...<br/>}</span></pre><p id="b465" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有超过10个案例，我们应该避免一系列的<code class="fe ms mt mu mj b">if</code>和<code class="fe ms mt mu mj b">else</code>。</p><h1 id="ef18" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用带有数值范围的switch/case语句</h1><p id="ef8e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将<code class="fe ms mt mu mj b">switch</code>和<code class="fe ms mt mu mj b">case</code>用于数值范围。</p><p id="b05c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="17b6" class="mn lc iq mj b gy mo mp l mq mr">switch (true) {<br/>  case isNaN(age):<br/>    category = "not an age";<br/>    break;<br/>  case (age &gt;= 50):<br/>    category = "old";<br/>    break;<br/>  case (age &lt;= 20):<br/>    category = "kid";<br/>    break;<br/>  default:<br/>    category = "young";<br/>    break;<br/>};</span></pre><p id="3901" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入的不是变量<code class="fe ms mt mu mj b">switch</code>，而是<code class="fe ms mt mu mj b">true</code>。</p><p id="ddcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，<code class="fe ms mt mu mj b">case</code>有表达式而不是值。</p><h1 id="dd7f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建一个原型是给定对象的对象</h1><p id="39b4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe ms mt mu mj b">Object.create</code>方法创建一个对象，其原型是gin对象。</p><p id="4724" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3ef3" class="mn lc iq mj b gy mo mp l mq mr">const obj = Object.create(proto);</span></pre><p id="3b58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<code class="fe ms mt mu mj b">proto</code>是<code class="fe ms mt mu mj b">obj</code>的原型对象。</p><h1 id="b83a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">一个HTML转义函数</h1><p id="2bb5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用一些正则表达式来转义HTML。</p><p id="f44c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9407" class="mn lc iq mj b gy mo mp l mq mr">function escapeHTML(text) {<br/>  const replacements = {<br/>    "&lt;": "&amp;lt;",<br/>    "&gt;": "&amp;gt;",<br/>    "&amp;": "&amp;amp;",<br/>    "\"": "&amp;quot"<br/>  };<br/>  return text.replace(/[&lt;&gt;&amp;"]/g, (character) =&gt; {<br/>    return replacements[character];<br/>  });<br/>}</span></pre><p id="1a53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用正则表达式搜索括号、与号和引号，然后从<code class="fe ms mt mu mj b">replacements</code>对象中获取替换字符。</p><h1 id="7ea0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免在循环中使用try-catch-finally</h1><p id="2e23" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每次运行<code class="fe ms mt mu mj b">catch</code>子句时，try-catch-finally都会在运行时在当前范围内创建一个新变量。</p><p id="6d28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以与其写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0cfc" class="mn lc iq mj b gy mo mp l mq mr">let arr = ['foo', 'bar'], i;<br/>for (i = 0, len = arr.length; i &lt; len; i++) {<br/>  try {<br/>    // ...<br/>  } catch (e) {<br/>    // ...<br/>  }<br/>}</span></pre><p id="d408" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3d8a" class="mn lc iq mj b gy mo mp l mq mr">let arr = ['foo', 'bar'],  i;<br/>try {<br/>  for (i = 0, len = arr.length; i &lt; len; i++) {<br/>    // ...<br/>  }<br/>} catch (e) {<br/>  // ...<br/>}</span></pre><p id="89d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在第二个例子中的<code class="fe ms mt mu mj b">catch</code>子句只能运行一次。</p><p id="0cc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以那里的变量只能创建一次。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/0fc699595ee54a1b76e1ea87937b7032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oclgTWMiz6qnJF5Z"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@peter_mc_greats?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Pietro De Grandi</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="6850" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="2636" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该在数组中使用for-in循环。</p><p id="8212" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以用原型和<code class="fe ms mt mu mj b">Object.create</code>创建对象。</p><p id="3e7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于数组，还有很多事情需要注意。</p><h2 id="c56c" class="mn lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">简单英语的JavaScript</h2><p id="a1c6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码获得更多类似内容，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>