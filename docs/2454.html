<html>
<head>
<title>React Patterns — Higher-Order Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应模式—高阶组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-patterns-higher-order-components-f7d069da07ac?source=collection_archive---------5-----------------------#2020-06-25">https://javascript.plainenglish.io/react-patterns-higher-order-components-f7d069da07ac?source=collection_archive---------5-----------------------#2020-06-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b600b71800c53a7ce175d4d06f9039b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xTOhf8BYl39CkNLA"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@henry_be?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Henry Be</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ac81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何组合React组件。</p><h1 id="30a4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">高阶组件</h1><p id="73cc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">高阶组件是接受其他组件作为参数并在修改后返回它们的组件。</p><p id="67d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">高阶组件如下所示:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d4ca" class="mn lc iq mj b gy mo mp l mq mr">const HoC = Component =&gt; EnhancedComponent</span></pre><p id="7f26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们接受一个组件并返回一个增强的组件。</p><p id="da56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="24c1" class="mn lc iq mj b gy mo mp l mq mr">const withClassName = Component =&gt; props =&gt; (<br/>  &lt;Component {...props} className="foo" /&gt;<br/>)</span></pre><p id="8b3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以返回一个添加了类名属性的组件。</p><p id="d200" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不直接使用它，而是写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e6d7" class="mn lc iq mj b gy mo mp l mq mr">const ComponentWithClassName = withClassName(Component)</span></pre><p id="0719" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们总是以<code class="fe ms mt mu mj b">with</code>开始高阶分量，以便区分它们。</p><p id="2e08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了更高阶的组件，我们可以创建不同的彼此相似，但基本相同的组件。</p><h1 id="dde1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">重写</h1><p id="f253" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">重组包有各种高阶组件，我们可以单独使用或组合使用。</p><p id="b676" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们可以运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7b6f" class="mn lc iq mj b gy mo mp l mq mr">npm install recompose --save</span></pre><p id="e775" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ffd2" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { withState } from "recompose";</span><span id="429d" class="mn lc iq mj b gy mv mp l mq mr">const enhance = withState("count", "setCount", 0);<br/>const Counter = enhance(({ count, setCount }) =&gt; (<br/>  &lt;div&gt;<br/>    Count: {count}<br/>    &lt;button onClick={() =&gt; setCount(n =&gt; n + 1)}&gt;Increment&lt;/button&gt;<br/>  &lt;/div&gt;<br/>));</span><span id="1f93" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return &lt;Counter /&gt;;<br/>}</span></pre><p id="a677" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">withState</code>函数创建了一个<code class="fe ms mt mu mj b">Counter</code>组件来保存状态，而不是使用<code class="fe ms mt mu mj b">useState</code>钩子。</p><p id="c9cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将组件传递给<code class="fe ms mt mu mj b">enhance</code>函数，这样我们就可以得到我们需要的道具。</p><p id="1443" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设置它的状态和功能可以作为道具使用。</p><p id="e653" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这使得我们的状态可以在多个组件中使用。</p><p id="210b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以使用许多其他功能。</p><p id="5522" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a605" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";<br/>import { withProps, flattenProp, compose } from "recompose";<br/>const enhance = compose(<br/>  withProps({<br/>    obj: { a: "a", b: "b" },<br/>    c: "c"<br/>  }),<br/>  flattenProp("obj")<br/>);</span><span id="5f59" class="mn lc iq mj b gy mv mp l mq mr">const Foo = enhance(({ a, b, c }) =&gt; (<br/>  &lt;div&gt;<br/>    {a} {b} {c}<br/>  &lt;/div&gt;<br/>));</span><span id="b9ea" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return &lt;Foo /&gt;;<br/>}</span></pre><p id="9da9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe ms mt mu mj b">compose</code>将多个高阶分量合并成一个。</p><p id="c2cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要<code class="fe ms mt mu mj b">withProps</code>来传递一些道具。</p><p id="78dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe ms mt mu mj b">flattenProp</code>来展平嵌套的<code class="fe ms mt mu mj b">obj</code>道具。</p><p id="c43b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，为了创建<code class="fe ms mt mu mj b">Foo</code>，我们将一个组件传递到<code class="fe ms mt mu mj b">enhance</code>函数中，并显示道具的值。</p><p id="86a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在<code class="fe ms mt mu mj b">App</code>中显示<code class="fe ms mt mu mj b">Foo</code>。</p><h1 id="d38b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">像孩子一样生活</h1><p id="de79" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">函数可以作为另一个组件的子属性传入。</p><p id="49ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="550f" class="mn lc iq mj b gy mo mp l mq mr">const FunctionAsChild = ({ children }) =&gt; children()</span></pre><p id="8413" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用它，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0c35" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";</span><span id="435a" class="mn lc iq mj b gy mv mp l mq mr">const FunctionAsChild = ({ children }) =&gt; children();</span><span id="e716" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return &lt;FunctionAsChild&gt;{() =&gt; &lt;div&gt;hello/div&gt;}&lt;/FunctionAsChild&gt;;<br/>}</span></pre><p id="7d01" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在标签之间传递了一个函数，这样它就可以在<code class="fe ms mt mu mj b">FunctionAsChild</code>中被调用。</p><p id="8d60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以传入参数。例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6b75" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";</span><span id="3c73" class="mn lc iq mj b gy mv mp l mq mr">const Greeting = ({ children }) =&gt; children("james");</span><span id="febd" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return &lt;Greeting&gt;{name =&gt; &lt;div&gt;Hello, {name}!&lt;/div&gt;}&lt;/Greeting&gt;;<br/>}</span></pre><p id="b8f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个<code class="fe ms mt mu mj b">Greeting</code>组件，我们称之为<code class="fe ms mt mu mj b">children</code>，它位于标签之间。</p><p id="0b98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe ms mt mu mj b">App</code>中，我们传入一个在<code class="fe ms mt mu mj b">Greeting</code>中调用的函数。</p><p id="82e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这使得我们的功能更加灵活。</p><h1 id="dd62" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据流</h1><p id="7ad4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">React具有单向数据流。</p><p id="7b25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它总是从父母流向孩子。</p><p id="793a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让孩子和父母交流，我们必须调用一个从父母传给孩子的函数。</p><p id="5a06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7dfd" class="mn lc iq mj b gy mo mp l mq mr">import React from "react";</span><span id="d15e" class="mn lc iq mj b gy mv mp l mq mr">const Greeting = ({ greeter }) =&gt; greeter("james");</span><span id="03f2" class="mn lc iq mj b gy mv mp l mq mr">export default function App() {<br/>  return &lt;Greeting greeter={name =&gt; &lt;div&gt;Hello, {name}!&lt;/div&gt;} /&gt;;<br/>}</span></pre><p id="3c15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个<code class="fe ms mt mu mj b">greeter</code>道具，这是一个从<code class="fe ms mt mu mj b">App</code>到<code class="fe ms mt mu mj b">Greeting</code>的函数，我们在那里调用它来呈现它返回的元素。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/e9f3b412f9294665ee22b6372f6e82b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T4ZObSewuRPILJNJ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@alvannee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alvan Nee</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="a87b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="8d3d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用高阶组件将逻辑从表示中分离出来。</p><p id="d269" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们可以拥有在多个组件中重用的逻辑。</p><p id="0d33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一些库可以帮助我们分离逻辑。</p><p id="64aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React的数据流是单向的，所以我们总是要把道具从父母传给孩子。</p><p id="8b0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是子组件可以调用父组件传递的函数。</p><h2 id="f920" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated">简单英语的JavaScript</h2><p id="eb9d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？在<a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> plainenglish.io </strong> </a>和<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">找到它们订阅我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>