<html>
<head>
<title>How I Automated My Job with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何使用Node.js实现工作自动化</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-i-made-my-own-youtube-downloader-2a59b44a93c5?source=collection_archive---------6-----------------------#2020-09-24">https://javascript.plainenglish.io/how-i-made-my-own-youtube-downloader-2a59b44a93c5?source=collection_archive---------6-----------------------#2020-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c620" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过自动化重复任务来提高性能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/43f38183e000b94bb06cfda4757f1e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Qcfp5abGRRzwugF0"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@joeel56?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nicole Wolf</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="575a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你知道你在工作中必须做的那些乏味的任务:更新配置文件，复制和粘贴文件，更新吉拉机票。</p><p id="da14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一段时间后，时间累积起来。2016年我在一家网络游戏公司工作时，情况就是如此。当我不得不为游戏构建可配置的模板时，这份工作有时会非常有益，但我大约70%的时间都花在了制作这些模板的副本和部署重新换肤的实现上。</p><h1 id="b524" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是Reskin？</h1><p id="5395" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该公司对reskin的定义是使用相同的游戏机制、屏幕和元素定位，但改变了视觉美学，如颜色和资产。因此，在一个简单的游戏如“石头剪子布”的背景下，我们将创建一个基本资产模板如下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/c0596c49833ea048f7d76078e20e8f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fNf-qWzjH2mWr9bs.jpeg"/></div></div></figure><p id="6c4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是当我们创建一个这样的皮肤时，我们会使用不同的资产，游戏仍然可以运行。如果你看看像糖果粉碎或愤怒的小鸟这样的游戏，你会发现他们有许多相同游戏的变种。通常在万圣节、圣诞节或复活节发行。从商业角度来看，这非常合理。现在…回到我们的实现。我们的每个游戏都将共享相同的捆绑JavaScript文件，并加载一个具有不同内容和资源路径的JSON文件。结果呢？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/fd425fcdbd22f987d68990f3cd8af545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*voIPit5Hw1olfEFT.jpeg"/></div></div></figure><p id="cce4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我和其他开发人员把每天的日程排得满满的，我的第一个想法是，“很多事情都可以自动化。”每当我创建一个新游戏时，我必须执行以下步骤:</p><ol class=""><li id="66e4" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">对模板存储库进行git提取，以确保它们是最新的。</li><li id="f6f6" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">创建一个新分支—由主分支中的吉拉票证ID标识。</li><li id="8982" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">复制一份我需要构建的模板。</li><li id="ec91" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">大口地跑。</li><li id="fd4e" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">更新<strong class="ky ir"> config.json </strong>文件中的内容。这将涉及资产路径、标题和段落以及数据服务请求。</li><li id="e85f" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">在本地构建并检查内容是否与涉众的word文档相匹配。<em class="ne">是的，我知道。</em></li><li id="a222" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">向设计师确认他们对外观是否满意。</li><li id="3cd7" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">合并到主分支，然后继续下一个。</li><li id="4cbf" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">更新吉拉票证的状态，并为相关利益方留下评论。</li><li id="1570" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">冲洗并重复。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/43509d5f0733c624218bf1cee15f5d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jJaZKHWvjs2i2PpO.jpeg"/></div></div></figure><p id="8d73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对我来说，这感觉更像是行政管理而不是实际的开发工作。我在以前的角色中接触过Bash脚本，并利用它创建了一些脚本来减少工作量。其中一个脚本更新了模板并创建了一个新的分支，另一个脚本执行了提交并将项目合并到了试运行和生产环境中。</p><p id="4e42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">手动设置一个项目会花费我三到十分钟的时间。可能需要5到10分钟来部署。根据游戏的复杂程度，可能需要十分钟到半天的时间。脚本很有帮助，但是很多时间还是花在了更新内容或者寻找丢失的信息上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/03f3a4976871f7a866237ea84a1ef28e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xtyzPLP2cwr53HHv"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@sincerelymedia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sincerely Media</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d96a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">编写代码来节省时间是不够的。我在想一个更好的方法来处理我们的工作流程，这样我就可以更多地利用脚本。将word文档中的内容移动到吉拉票证中，将其分解到相关的自定义字段中。设计者不发送指向公共驱动器上资产所在位置的链接，而是建立一个内容交付网络(CDN)存储库，该存储库具有指向资产的暂存和生产URL，这将更加实用。</p><h1 id="7ecd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">吉拉API</h1><p id="3da9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">像这样的事情可能需要一段时间来执行，但我们的过程确实随着时间的推移而改进。我对我们的项目管理工具吉拉的API做了一些研究，并对我正在处理的吉拉门票做了一些请求。我收集了大量有价值的数据。如此有价值，以至于我决定将它集成到我的Bash脚本中，以读取吉拉门票的值，并在完成后发布评论和标记利益相关者。</p><h1 id="4d7b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Bash转换到节点</h1><p id="ab4e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Bash脚本很好，但是如果有人在Windows机器上工作，它们就不能运行。在做了一些挖掘之后，我决定使用JavaScript将整个过程包装到一个定制的构建工具中。我把这个工具叫做<strong class="ky ir">梅森</strong>，它将改变一切。</p><h1 id="d70a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">硬币指示器 （coin-levelindicator的缩写）命令行界面（Command Line Interface for batch scripting）</h1><p id="a4b6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当您使用Git时，我假设您在终端中使用，您会注意到它有一个非常友好的命令行界面。如果你拼错或输入了一个错误的命令，它会礼貌地对你输入的内容提出建议。一个名为<strong class="ky ir"> commander </strong>的库应用了相同的行为，这是我使用的许多库之一。</p><p id="1517" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑下面的简化代码示例。它正在引导命令行界面(CLI)应用程序。</p><h1 id="7a7f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">src/梅森. js</h1><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="82f8" class="nl lt iq nh b gy nm nn l no np">#! /usr/bin/env node</span><span id="eff2" class="nl lt iq nh b gy nq nn l no np">const mason = require('commander');<br/>const { version } = require('./package.json');<br/>const console = require('console');</span><span id="33f5" class="nl lt iq nh b gy nq nn l no np">// commands<br/>const create = require('./commands/create');<br/>const setup = require('./commands/setup');</span><span id="9aa7" class="nl lt iq nh b gy nq nn l no np">mason<br/>    .version(version);</span><span id="35a8" class="nl lt iq nh b gy nq nn l no np">mason<br/>    .command('setup [env]')<br/>    .description('run setup commands for all envs')<br/>    .action(setup);</span><span id="dd42" class="nl lt iq nh b gy nq nn l no np">mason<br/>    .command('create &lt;ticketId&gt;')<br/>    .description('creates a new game')<br/>    .action(create);</span><span id="6297" class="nl lt iq nh b gy nq nn l no np">mason<br/>    .command('*')<br/>    .action(() =&gt; {<br/>        mason.help();<br/>    });</span><span id="9eb0" class="nl lt iq nh b gy nq nn l no np">mason.parse(process.argv);</span><span id="08ed" class="nl lt iq nh b gy nq nn l no np">if (!mason.args.length) {<br/>    mason.help();<br/>}</span></pre><p id="bce2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用npm，您可以从您的<strong class="ky ir"> package.json </strong>运行一个链接，它将创建一个全局别名。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="50c5" class="nl lt iq nh b gy nm nn l no np">...<br/>"bin": {<br/>  "mason": "src/mason.js"<br/>},<br/>...</span></pre><p id="9f6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我运行项目根目录下的npm链接时。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="c4aa" class="nl lt iq nh b gy nm nn l no np">npm link</span></pre><p id="d020" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将为我提供一个我可以调用的命令，称为mason。因此，每当我在终端中调用mason时，它都会运行那个<strong class="ky ir"> mason.js </strong>脚本。所有的任务都归属于一个名为mason的保护伞司令部，我每天都用它来构建游戏。我节省的时间是…难以置信的。</p><p id="786b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在下面一个假设的例子中看到我当时做的事情，我把一个吉拉的票号作为参数传递给命令。这将卷曲吉拉API，并获取更新游戏所需的所有信息。然后，它将继续构建和部署项目。然后，我会发表评论，并标记利益相关者和设计师，让他们知道已经完成了。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="f0d7" class="nl lt iq nh b gy nm nn l no np">$ mason create GS-234<br/>... calling Jira API <br/>... OK! got values!<br/>... creating a new branch from master called 'GS-234'<br/>... updating templates repository<br/>... copying from template 'pick-from-three'<br/>... injecting values into config JSON<br/>... building project<br/>... deploying game<br/>... Perfect! Here is the live link <br/>http://www.fake-studio.com/game/fire-water-earth<br/>... Posted comment 'Hey [~ben.smith], this has been released. Does the design look okay? [~jamie.lane]' on Jira.</span></pre><p id="398a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只需轻轻几下就能搞定！</p><p id="77a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我对整个项目非常满意。</p><h1 id="e3a5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">概念背后的想法</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/7afc3fe38bb70d8d2a617361f6e417f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B7UCyVWNMWsbPVL5"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@thisisengineering?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ThisisEngineering RAEng</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1d17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一部分是配方的集合，或者作为单个全局命令的指导性构建块。这些可以在你一天的工作中使用，并且可以在任何时候被调用来加速你的工作流程或者纯粹为了方便。</p><h1 id="ac6e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">开发方法</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/a7368093136446867fab1cea7e6dcd1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3yKHtHkBbX6f4vjB"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@edgarraw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Edgar Castrejon</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0c06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二部分是从头开始创建跨平台构建工具的演练。每一个完成特定任务的脚本都是它自己的命令，一个主要的总括命令通常是你的项目的名字，把它们都封装起来。</p><p id="6c5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我知道每个企业的情况和流程都不同，但你应该能够找到一些事情，即使是很小的事情，可以让你在办公室的一天变得轻松一些。</p><p id="e143" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">花更多时间开发，花更少时间管理。希望你会喜欢，我会在下一阶段做改进，直到那时见到你！</p></div></div>    
</body>
</html>