<html>
<head>
<title>How to Optimize your Angular Application for Production</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为生产优化您的角度应用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-optimize-your-angular-application-for-production-e80537f1c9e?source=collection_archive---------1-----------------------#2020-08-31">https://javascript.plainenglish.io/how-to-optimize-your-angular-application-for-production-e80537f1c9e?source=collection_archive---------1-----------------------#2020-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7e51" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为生产优化您的角度应用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/081e9fb825bb674ad1305cef88c7b7a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TE7-tMwS0pzSLwbc"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">chuttersnap</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b780" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">交付高质量的软件不仅仅是编写好的代码。为了实现高质量的用户体验，您运输和交付Angular应用程序的方式至关重要。</p><p id="f686" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本指南的主要目的是向您展示如何提供一个稳健且高质量的角度应用。您可以通过在构建过程中针对生产优化应用程序来实现这一点。</p><h1 id="da1c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">简介</strong></h1><p id="e18e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用Angular CLI构建您的Angular应用程序非常简单。只需从您的工作区目录运行以下命令。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="ecb7" class="mu lt iq mq b gy mv mw l mx my">ng build</span></pre><p id="97f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认情况下，<code class="fe mz na nb mq b">ng build</code>命令编译您的角度代码，并将其放在<strong class="ky ir"> <em class="nc"> dist </em> </strong>文件夹中。对于一个开发版本来说，这是可以的，但是，对于一个生产版本来说，这并不重要。</p><p id="fa52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mz na nb mq b">build</code> <strong class="ky ir"> <em class="nc"> </em> </strong>命令有几个选项，我们将在下面的章节中看看其中一些重要的选项。</p><h1 id="e0fe" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基本生产构建</h1><p id="4415" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">最基本的是，您应该使用<code class="fe mz na nb mq b">--prod</code>选项运行您的构建命令。<code class="fe mz na nb mq b">--prod</code>选项将执行以下操作:</p><ul class=""><li id="0375" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated">简单的摇树</li><li id="ad91" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">从应用程序中移除死代码</li><li id="bd8a" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">设置生产环境变量</li></ul><p id="d613" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong> <code class="fe mz na nb mq b">--prod</code>是<code class="fe mz na nb mq b">--configuration=production</code>的简称。因此，<code class="fe mz na nb mq b">--prod</code>会将您的应用程序设置为指向生产环境变量，默认情况下，这些变量位于<strong class="ky ir"><em class="nc">environment . prod . ts</em></strong>文件中。</p><p id="a358" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用下面的命令，通过基本的优化来构建您的生产应用程序。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="9864" class="mu lt iq mq b gy mv mw l mx my">ng build --prod </span></pre><h1 id="660d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">提前编译(AOT)</h1><p id="7eb3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当您构建Angular应用程序时，默认情况下它使用实时编译(JIT)。这意味着您的Angular应用程序是在运行时在浏览器内部编译的。你可以想象这可能会很慢。</p><p id="1d4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了让你的构建优化更进一步，你可以使用提前编译(AOT)来构建你的角度生产代码。使用AOT，您的Angular应用程序在构建时编译，也就是在它到达浏览器之前。以下是您应该使用AOT的一些原因。</p><h2 id="c435" class="mu lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">AOT的优势</h2><ul class=""><li id="93ce" class="nd ne iq ky b kz mk lc ml lf oc lj od ln oe lr ni nj nk nl bi translated">更快地呈现代码，因为编译是在构建时完成的，而不是在运行时在浏览器中完成的</li><li id="1bff" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">较小的Angular应用程序大小，因为Angular编译器没有随代码一起提供</li><li id="3ad7" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">更好的代码质量，因为模板解析错误在构建的早期就被检测到</li><li id="cdf7" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">安全可靠，因为模板不会在浏览器中动态评估</li></ul><p id="8060" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">AOT的一个小挫折是你的构建过程或CI/CD管道可能需要更长的时间来完成。</p><p id="39dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的<code class="fe mz na nb mq b">--aot=true</code>选项用AOT构建你的应用程序。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d162" class="mu lt iq mq b gy mv mw l mx my">ng build --prod --aot=true </span></pre><p id="8125" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong>:Angular的新版本在- prod标志中包含了AOT编译。</p><h1 id="c1b4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">角度构建优化器</h1><p id="a8dc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">您可以使用<code class="fe mz na nb mq b">--buildOptimizer</code>选项进一步优化您的生产角度应用</p><p id="f44d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">构建优化器移除了角度特定的装饰器、构造器参数，并使代码缩减器更容易移除未使用的代码。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="5ec4" class="mu lt iq mq b gy mv mw l mx my">ng build --prod --aot=true --buildOptimizer=true </span></pre><p id="9ff7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong>:<code class="fe mz na nb mq b">--buildOptimizer</code>选项只对AOT编译的代码有效。</p><h1 id="717b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">构建输出的分析</h1><p id="71d9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这一节中，我比较和分析了我一直在开发的一个应用程序的构建过程的输出。</p><p id="e80f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个数字是非优化生产版本的输出，而第二个数字是优化生产版本的输出。</p><p id="fdbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，在第一张图中，以红色突出显示的polyfill总计为<strong class="ky ir"><em class="nc"/></strong>，而优化构建的polyfill总计仅为<strong class="ky ir"><em class="nc"/></strong>165 KB。惊人的<strong class="ky ir"> <em class="nc">减少79%</em></strong>。</p><p id="3649" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于样式表，用橙色突出显示。在第一张图中，它们总计为<strong class="ky ir"> <em class="nc"> 2.5 MB </em> </strong>，而在优化构建中，它们总计为<strong class="ky ir"> <em class="nc"> 171 KB </em> </strong>。代表着<strong class="ky ir"> <em class="nc">下降93%</em></strong>。</p><p id="52a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们之前强调的，优化的构建需要更长的时间。两个图中的最后一行显示了构建花费的时间。完成非优化构建所需的时间<strong class="ky ir"> <em class="nc">比</em> </strong>少60%。</p><h2 id="127e" class="mu lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">1.非优化的生产版本</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/de747ba591efc894b0aa187d114ca792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhl7pKbjQYJ_R0VLfOBuKQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">non-optimized production build</figcaption></figure><h2 id="c96f" class="mu lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">2.优化的生产构建</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/5791387ae5847746b97cf498b7ee9285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QL7s-gXxsO6GKNxwYVc9Dg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">optimized production build</figcaption></figure><h1 id="0a02" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="b41d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">优化您的Angular应用程序构建不仅对良好的用户体验很重要，而且对安全性和交付高质量的应用程序也很重要。</p><h2 id="90fa" class="mu lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated"><strong class="ak">简单英语的JavaScript</strong></h2><p id="f22e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你知道我们有三份出版物和一个YouTube频道吗？在<a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">plain English . io</strong></a>找到一切的链接！</p></div></div>    
</body>
</html>