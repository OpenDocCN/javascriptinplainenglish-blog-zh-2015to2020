<html>
<head>
<title>You Need to Write Effective Unit Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你需要编写有效的单元测试</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/you-need-to-write-effective-unit-tests-954f60319f0a?source=collection_archive---------9-----------------------#2020-09-23">https://javascript.plainenglish.io/you-need-to-write-effective-unit-tests-954f60319f0a?source=collection_archive---------9-----------------------#2020-09-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6b63f5693bc2936ca0ea67dfb768e8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bvd0VX1jZw4QJfq6"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9985" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编写单元测试已经成为软件工程师的日常任务。编写单元测试有几个目的:</p><ul class=""><li id="cc38" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><strong class="kf ir">更好的产品体验&amp;品质</strong>。公司希望推出问题较少的产品。</li><li id="ac90" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">省时</strong>。确保开发的增强工作如期进行，减少<strong class="kf ir">叮咚游戏</strong>这样我们就可以减少修复bug的时间，即运行时间。例如，用于QA-&gt;Dev-&gt;QA-&gt;Dev-&gt;QA-&gt;部署。</li><li id="5c3d" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">提高工程师的信心</strong>。如果你编写单元测试，你可能会在开发和发布的过程中获得更多的信心。</li></ul><p id="2438" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然单元测试带来了这么多好处，但是为什么会有出错的可能性。例如，</p><blockquote class="lp"><p id="3cdb" class="lq lr iq bd ls lt lu lv lw lx ly la dk translated">经理:你好，德隆，你昨天工作的票有些问题。你能看一下吗？</p><p id="2f5d" class="lq lr iq bd ls lt lu lv lw lx ly la dk translated">我:当然。会调查的。</p><p id="5256" class="lq lr iq bd ls lt lu lv lw lx ly la dk translated">我(自言自语) :昨天所有的单元测试都通过了。为什么仍有问题提出？</p></blockquote><p id="e45c" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">这种情况你听起来熟悉吗？它确实在我身上发生了很多次。</p><p id="ab45" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我决定找出我可以做得更好，以减少这种情况，提高我的生产力。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="e828" class="mm mn iq bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">编写有效的测试</h1><p id="46ae" class="pw-post-body-paragraph kd ke iq kf b kg nk ki kj kk nl km kn ko nm kq kr ks nn ku kv kw no ky kz la ij bi translated">结果是我写的单元测试根本没有效果。准确地说，我写的单元测试不够具体。下面我们来看一些例子。</p><p id="ece8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们有一个名为<code class="fe np nq nr ns b">clientController</code>的文件。有一个<code class="fe np nq nr ns b">getClient</code>函数，我们可以在其中检索客户信息。</p><figure class="nt nu nv nw gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="59f0" class="nz mn iq bd mo oa ob dn ms oc od dp mw ko oe of na ks og oh ne kw oi oj ni ok bi translated">我为控制器编写的普通简单测试用例</h2><p id="0bc4" class="pw-post-body-paragraph kd ke iq kf b kg nk ki kj kk nl km kn ko nm kq kr ks nn ku kv kw no ky kz la ij bi translated">下面是我将编写的测试<code class="fe np nq nr ns b">getClient</code>功能的简单测试用例。</p><figure class="nt nu nv nw gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="5fff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以上测试用例通过。然而，这个测试用例并不<strong class="kf ir">有效</strong>，因为它不够<strong class="kf ir">具体</strong>。我刚刚验证了</p><ul class=""><li id="5aed" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">我们验证要调用的<code class="fe np nq nr ns b">res.json</code>。但是我从来不知道它返回了什么。是否返回了正确的客户信息？</li></ul><p id="a735" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，这里有什么需要特别说明的呢？</p><ul class=""><li id="c11a" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">期望<strong class="kf ir">返回的客户信息正确</strong>。</li></ul><p id="2cff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个更具体的单元测试应该是这样的。</p><h2 id="6383" class="nz mn iq bd mo oa ob dn ms oc od dp mw ko oe of na ks og oh ne kw oi oj ni ok bi translated">更好的单元测试(更具体)</h2><figure class="nt nu nv nw gt jr"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="a6a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">多了两行代码。现在单元测试被处理得更具体了，它是一个有效的单元测试。</p><h1 id="dae3" class="mm mn iq bd mo mp ol mr ms mt om mv mw mx on mz na nb oo nd ne nf op nh ni nj bi translated">结论</h1><p id="82eb" class="pw-post-body-paragraph kd ke iq kf b kg nk ki kj kk nl km kn ko nm kq kr ks nn ku kv kw no ky kz la ij bi translated">以下是这篇文章的要点。</p><ul class=""><li id="284d" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">编写单元测试是不够的，您需要编写有效的单元测试。</li><li id="f264" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">有效的单元测试总是由特异性贡献的。这意味着您期望的结果越具体，您的单元测试就越有效和准确。</li></ul><p id="e39f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读。下一篇文章再见。</p><p id="de77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="oq">原创文章发表在我的</em> <a class="ae kc" href="https://tekloon.dev/writing-effective-unit-test" rel="noopener ugc nofollow" target="_blank"> <em class="oq">博客</em> </a> <em class="oq">上。</em></p></div></div>    
</body>
</html>