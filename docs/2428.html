<html>
<head>
<title>Introduction to Unit Testing with Mocha &amp; Chai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mocha &amp; Chai单元测试简介</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/introduction-to-unit-testing-with-mocha-chai-4cc4c3578a77?source=collection_archive---------12-----------------------#2020-06-22">https://javascript.plainenglish.io/introduction-to-unit-testing-with-mocha-chai-4cc4c3578a77?source=collection_archive---------12-----------------------#2020-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="945c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用于测试的JavaScript测试框架和断言库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/729c988d8ab17ac0742df57175f86658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bUIOAE2mOtmsP554u8PUZg.png"/></div></div></figure><p id="1392" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">测试是开发的重要部分。如果你还没有读过，请看看我在Node.js 的<a class="ae ln" href="https://medium.com/javascript-in-plain-english/automated-testing-with-node-js-for-beginners-2e1fecd1ac68?source=friends_link&amp;sk=f21b0e1ab180b81d1d6157991ed141ee" rel="noopener">自动化测试上的帖子，我在那里讲述了JavaScript的基本测试过程，并讨论了为什么它对质量保证很重要。</a></p><p id="3316" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这一次，我将介绍一种叫做<strong class="kt ir">单元测试</strong>的新型测试。</p><h1 id="1bfc" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">单元测试</h1><p id="f430" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">测试一个应用程序的单个部分，如函数或方法，是否适合使用。一个单元可以被定义为一个应用程序的最小可测试部分。开发人员执行单元测试，以确保一个单元能够独立地执行<strong class="kt ir">它想要做的事情，而不会影响</strong>代码的其他区域。</p><p id="3d93" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">随着新函数、依赖项和类的出现，代码变得越来越复杂，在应用程序中进行单元测试以测试任何新代码是否会在应用程序中产生错误是非常重要的。这使得检测代码中的bug和错误更加有效。</p><p id="d7ca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在JavaScript中，我们可以使用<a class="ae ln" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">摩卡</a>和<a class="ae ln" href="https://www.chaijs.com/api/" rel="noopener ugc nofollow" target="_blank">柴</a>来编写单元测试用例。</p><h1 id="a0fb" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">摩卡和柴</h1><p id="3373" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">Mocha是一个可以用来运行测试的测试框架。Chai是一个断言库，它为我们的测试断言提供了描述性的、易于阅读的语法。</p><blockquote class="ml mm mn"><p id="0711" class="kr ks mo kt b ku kv jr kw kx ky ju kz mp lb lc ld mq lf lg lh mr lj lk ll lm ij bi translated"><em class="iq">在单元测试中，断言是指确认功能/测试的输出与预期输出完全相同的过程。</em></p></blockquote><h1 id="a493" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">步骤1:下载Node.js和npm</h1><p id="5019" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在<a class="ae ln" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en/download/</a>下载Node.js(带npm)</p><p id="b2b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装后，要检查它是否存在，请转到您的命令提示符:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="2400" class="mx lp iq mt b gy my mz l na nb">node -v<br/>npm -v</span></pre><h1 id="10dd" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">第二步:安装摩卡</h1><p id="b1c6" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">为了在我们的浏览器上进行测试，我们在项目文件中运行了以下内容:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="eaa5" class="mx lp iq mt b gy my mz l na nb">npm install mocha chai --save-dev</span></pre><p id="3f0d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">名为<code class="fe nc nd ne mt b">node_modules</code>的文件夹应该出现在您的项目中。</p><h1 id="8574" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">步骤3:创建一个测试页面</h1><p id="5699" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">让我们首先创建一个测试页面，在这里我们可以看到测试的结果。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="eb24" class="mx lp iq mt b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Unit Testing Tutorial&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="node_modules/mocha/mocha.css"&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="mocha"&gt;&lt;/div&gt;<br/>    &lt;script src="node_modules/mocha/mocha.js"&gt;&lt;/script&gt;<br/>    &lt;script src="node_modules/chai/chai.js"&gt;&lt;/script&gt;<br/>    &lt;script&gt;mocha.setup('bdd')&lt;/script&gt;<br/><br/>    &lt;!-- Test code here --&gt;<br/><br/>    &lt;script&gt;<br/>      mocha.run();<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="b5f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如你在代码中看到的，我们使用Mocha自己的CSS来设计页面样式，并将<code class="fe nc nd ne mt b">mocha.js</code>和<code class="fe nc nd ne mt b">chai.js</code> &lt;脚本&gt;加载到页面中。然后我们调用<code class="fe nc nd ne mt b">mocha.setup('bdd')</code>来加载它的<strong class="kt ir"> BDD(行为驱动开发)</strong>接口。</p><blockquote class="nf"><p id="173d" class="ng nh iq bd ni nj nk nl nm nn no lm dk translated"><em class="np"> BDD是一种技术，</em> <strong class="ak"> <em class="np">描述</em> </strong> <em class="np">一个功能，解释</em><strong class="ak"><em class="np"/></strong><em class="np">做什么，并使用测试用例对</em> <strong class="ak"> <em class="np">断言</em> </strong> <em class="np">按预期工作。</em></p></blockquote><p id="a514" class="pw-post-body-paragraph kr ks iq kt b ku nq jr kw kx nr ju kz la ns lc ld le nt lg lh li nu lk ll lm ij bi translated">在设置下面，我们将编写下面的测试代码，最后，我们将使用<script> &lt;code class="fe nc nd ne mt b"&gt;mocha.run()&lt;/code&gt;运行mocha。&lt;/root&gt;</script></p><h1 id="9831" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">步骤4:创建一个测试文件夹</h1><p id="0361" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">为了保持测试代码有组织，我们将通过在我们项目的根目录中创建一个<code class="fe nc nd ne mt b">/tests</code>文件夹，把所有的测试文件放在一个单独的目录中。</p><p id="0ec4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">稍后，我们可以将我们所有的测试文件(即testFunction1.js，testModule1.js)放在<code class="fe nc nd ne mt b">/tests</code>文件夹中。</p><h1 id="44ef" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">步骤5:样本测试</h1><p id="34c2" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">让我们创建一个样本测试。首先在您的<code class="fe nc nd ne mt b">/tests</code>文件夹中创建一个<code class="fe nc nd ne mt b">sumTest.js</code>，并创建一个测试:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="9617" class="mx lp iq mt b gy my mz l na nb">var assert = chai.assert;<br/><br/>describe("sum", function() {<br/>  it("adds numbers", function() {<br/>       assert.equal(sum(6, 3), 9);<br/>  });<br/>});</span></pre><p id="d957" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个测试是BDD技术的一个简单例子:</p><ul class=""><li id="29f3" class="nv nw iq kt b ku kv kx ky la nx le ny li nz lm oa ob oc od bi translated">首先我们<code class="fe nc nd ne mt b">describe</code>这个函数。它被称为“和”。</li><li id="54ee" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated">接下来我们解释一下<code class="fe nc nd ne mt b">it</code>的作用。在sum函数的例子中，它将数字相加。</li><li id="dd17" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated">最后，我们使用<code class="fe nc nd ne mt b">assert.equal()</code>给出一个测试用例，其中第一个参数是函数，第二个是函数的预期输出。</li></ul><h1 id="75b7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">第六步:求和函数</h1><p id="d898" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">所以我们创建了我们的测试。但是我们还没有创建求和函数。如果我们现在运行测试，它将给出错误。让我们在根目录下创建一个<code class="fe nc nd ne mt b">sum.js</code>，代码如下:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="8c05" class="mx lp iq mt b gy my mz l na nb">function sum(num1, num2){<br/>    return num1 + num2;<br/>}</span></pre><p id="b232" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">太好了！现在让我们运行我们的测试。</p><h1 id="75a2" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">运行测试</h1><p id="e3a3" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">首先将我们的<code class="fe nc nd ne mt b">sumTest.js</code>和<code class="fe nc nd ne mt b">sum.js</code>添加到我们的HTML页面。它应该看起来像:</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="f3ca" class="mx lp iq mt b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Unit Testing Tutorial&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="node_modules/mocha/mocha.css"&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="mocha"&gt;&lt;/div&gt;<br/>    &lt;script src="node_modules/mocha/mocha.js"&gt;&lt;/script&gt;<br/>    &lt;script src="node_modules/chai/chai.js"&gt;&lt;/script&gt;<br/>    &lt;script&gt;mocha.setup('bdd')&lt;/script&gt;<br/><br/>    <strong class="mt ir">&lt;script src="sum.js"&gt;&lt;/script&gt;<br/><br/>    &lt;script src="tests/sumTest.js"&gt;&lt;/script&gt;<br/></strong><br/>    &lt;script&gt;<br/>      mocha.run();<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5b12" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，如果我们在浏览器中运行我们的testPage.html，它应该看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/b7594fe0736b509b71aa021e029df0ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TRm3QemVwBB0qC2W"/></div></div></figure><p id="3003" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">耶！我们通过了测试！这意味着我们的功能应该如我们所愿。</p><blockquote class="ml mm mn"><p id="2f18" class="kr ks mo kt b ku kv jr kw kx ky ju kz mp lb lc ld mq lf lg lh mr lj lk ll lm ij bi translated"><em class="iq">注:实际上，在很多情况下，功能可能不正确，但测试通过。处理这一问题的正确方法是理解函数应该做什么，并针对特定用途进行测试。</em></p></blockquote><h1 id="8623" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">今天就到这里吧！</h1><p id="ecf0" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">有了单元测试，你可以用Mocha和Chai做更多的事情！这个简单的例子并不是测试函数的好方法。通常，会有更多的“it”和“assert”语句来检查函数必须满足的各种条件，以便按预期工作。我建议您在项目中进行自己的测试，以学习如何设计能够有效检测代码中的缺陷/错误的测试。</p><p id="42f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一些阅读材料可供参考:</p><ul class=""><li id="8a5d" class="nv nw iq kt b ku kv kx ky la nx le ny li nz lm oa ob oc od bi translated"><a class="ae ln" href="https://javascript.info/testing-mocha" rel="noopener ugc nofollow" target="_blank">https://javascript.info/testing-mocha</a></li><li id="c88f" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated"><a class="ae ln" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">https://mochajs.org/</a></li><li id="547a" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated">https://www.chaijs.com/api/bdd/<a class="ae ln" href="https://www.chaijs.com/api/bdd/" rel="noopener ugc nofollow" target="_blank"/></li><li id="98e4" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated"><a class="ae ln" href="https://www.freecodecamp.org/learn/information-security-and-quality-assurance/quality-assurance-and-testing-with-chai/" rel="noopener ugc nofollow" target="_blank">https://www . freecodecamp . org/learn/information-security-and-quality-assurance/quality-assurance-and-test-with-chai/</a></li></ul><p id="f56d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢阅读！请分享下面的任何评论或问题，祝单元测试好运！干杯！</p></div></div>    
</body>
</html>