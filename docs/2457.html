<html>
<head>
<title>Angular 10 in depth</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度为角度10</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-10-in-depth-a48a3a7dd1a7?source=collection_archive---------0-----------------------#2020-06-26">https://javascript.plainenglish.io/angular-10-in-depth-a48a3a7dd1a7?source=collection_archive---------0-----------------------#2020-06-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a5cd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Angular的最新主要版本Angular 10刚刚发布。是时候发现新的东西了！</h2></div><ul class=""><li id="f97e" class="kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="kh ir">更新#2 </strong> : Angular 12出了。看看我关于它的文章:<a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/angular-12-in-depth-7741e759c72">https://JavaScript . plain English . io/angular-12-in-depth-7741 e 759 c 72</a></li><li id="e01a" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated"><strong class="kh ir">更新#1 </strong> : <a class="ae kx" href="https://dsebastien.medium.com/angular-11-in-depth-9a7372b4a600" rel="noopener">角11出来了。查看我的文章，了解关于它的一切。</a></li></ul><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/248e6e622e8709349a265ea3e9255a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5Pl6zHi8s_bWPBBYUuV3sg.png"/></div></figure><p id="d18c" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">在本文中，我将(几乎)回顾这个全新版本中值得注意的一切。我还将重点介绍Angular的变化。</p><p id="a260" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">如果你想从直升机上看到包含的内容，那就去看看官方Angular博客。在这里，我将尝试更深入地研究发行说明。</p><p id="11f9" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">Angular 10已经在这里了，距离版本9仅仅四个月。当然，在这短暂的时间里，并没有太多的变化。尽管如此，除了这个版本带来的大量错误修复之外，还有相当多值得注意的特性。</p><p id="d798" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">提醒一下，Angular团队试图每年发布两个主要版本，所以Angular 11应该会在今年秋天发布。</p><h1 id="30a7" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">支持TypeScript 3.9.x</h1><p id="1c8f" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">我能说什么呢？你知道我的，<a class="ae kx" href="https://www.amazon.com/gp/product/B081FB89BL" rel="noopener ugc nofollow" target="_blank">我喜欢打字稿</a>。所以这个Angular版本让我高兴的第一件事是它支持<a class="ae kx" href="https://medium.com/@dSebastien/whats-new-with-typescript-3-9-9095ff9f68a5" rel="noopener"> TypeScript 3.9 </a>。</p><p id="7826" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">我已经发表了一篇关于TS 3.9 的<a class="ae kx" href="https://medium.com/@dSebastien/whats-new-with-typescript-3-9-9095ff9f68a5" rel="noopener">新特性的文章，所以如果你没有看过的话，</a><a class="ae kx" href="https://medium.com/@dSebastien/whats-new-with-typescript-3-9-9095ff9f68a5" rel="noopener">继续吧</a>尽快升级，真的很值得！我还写了另一篇关于TypeScript 4.0 的文章。</p><p id="476b" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">注意Angular 10已经掉了对TS 3.6，3.7，3.8的支持！我希望这不会阻碍你。</p><p id="3173" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">由于支持TS 3.9.x和编译器CLI中的其他改进，Angular 10中的类型检查比以往任何时候都快，这对大多数项目来说都是积极的；尤其是大的。</p><p id="1ba1" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">除此之外，Angular 10还升级到了<a class="ae kx" href="https://github.com/microsoft/tslib" rel="noopener ugc nofollow" target="_blank"> TSLib 2.0 </a>。对于那些不知道的人来说，TSLib是一个官方库，它提供了可以在运行时使用的TypeScript helper函数。TSLib与“tsconfig.json”的<code class="fe mw mx my mz b">importHelpers</code>标志结合使用；启用时，它允许编译器生成更精简/可读的代码。不管怎样，没什么好担心的；TSLib变化不大..</p><h1 id="0c64" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">可选的更严格的设置</h1><p id="cdd2" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">胜利的严格模式！</p><p id="0527" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">Angular 10带来了在创建时创建更严格的项目的可能性，这很好，当然应该用于所有的新项目。要创建具有更严格默认值的项目，请使用:</p><pre class="le lf lg lh gt na mz nb nc aw nd bi"><span id="45ce" class="ne ma iq mz b gy nf ng l nh ni">ng new --strict</span></pre><p id="1411" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">这将允许您更快地发现问题(在构建时发现错误比在运行时更好，对吗？).</p><p id="f361" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">这个新选项启用了TypeScript严格模式(您应该在您的项目中启用它！).</p><p id="a4ed" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">除此之外，它还支持严格的<a class="ae kx" href="https://medium.com/javascript-in-plain-english/angular-template-type-checking-e2c99c50f999" rel="noopener">角度模板类型检查</a>，我在上周<a class="ae kx" href="https://medium.com/javascript-in-plain-english/angular-template-type-checking-e2c99c50f999" rel="noopener">写了这个</a>。</p><p id="e244" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">它还大幅降低了“angular.json”的预算:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="b93d" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">这很好，因为它将鼓励新用户关注他们的应用程序的捆绑大小(关于这一点，我正在计划一篇关于如何分析你的应用程序的捆绑大小的文章)。</p><p id="83ae" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">它还实施了更严格的TSLint配置，禁止“any”(“no-any”被设置为<code class="fe mw mx my mz b">true</code>)，并且还启用了由<a class="ae kx" href="http://codelyzer.com/rules/" rel="noopener ugc nofollow" target="_blank"> codelyzer </a>提供的相当多的有趣规则。请注意，即使是严格的，您仍然可以使用TSLint走得更远。例如，<a class="ae kx" href="https://gist.github.com/dsebastien/19acb20bf30fc2f4a09b60d974f7097c" rel="noopener ugc nofollow" target="_blank">这是我的一个项目</a>的配置，你可以用它作为起点。</p><p id="591a" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">我认为这个新的“严格”选项很棒，但我有点难过，它不是默认的，而是一个可选的标志。我觉得更严格意味着更安全，那为什么要让更安全可选呢？我想基本原理是默认情况下更加宽松，Angular起初感觉不那么可怕？</p><p id="5e4d" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">不管怎样，如果你创建了一个新的项目，请启用它，甚至更进一步；你以后会感谢我的。</p><h1 id="819a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">新的TypeScript配置布局</h1><p id="2c17" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">在这个新版本中，新项目中默认提供的TypeScript配置发生了变化。现在除了“tsconfig.json”、“tsconfig.app.json”和“tsconfig.spec.json”之外，还有一个“tsconfig.base.json”文件。</p><p id="d917" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">那么为什么会有这些配置文件呢？为了更好地支持ide和构建工具查找类型和编译器配置的方式。</p><p id="284e" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">在新的设置下，“tsconfig.json”仅仅包含了基于所谓的<a class="ae kx" href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-9/#solution-style-tsconfig" rel="noopener ugc nofollow" target="_blank">“解决方案样式”</a> (Visual Studio又回来了？:p)由TypeScript 3.9带来，这对于缩短编译时间和在项目的各个部分之间实施更严格的分离非常有用:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="e7b3" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">在这种情况下，分离是为了将应用程序代码(由“tsconfig.app.json”处理)与测试(由“tsconfig.spec.json”处理)完全隔离开来。</p><p id="1847" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">如果您查看“tsconfig.base.json”文件，您会发现大部分的TypeScript配置:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="148f" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">注意，这个是使用上一节讨论的<code class="fe mw mx my mz b">strict</code>选项生成的。</p><p id="ca98" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">从上面可以看到，这个文件只配置了TypeScript编译器和Angular编译器选项；它没有列出/包含/排除要编译的文件。</p><p id="058c" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">答案确实在“tsconfig.app.json”文件中，该文件列出了“main.ts”和“polyfills.ts”:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="08b8" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">如果您有一个没有这种布局的现有项目，那么您可能应该检查您的TypeScript配置，以便保持一致并从中受益</p><p id="bffd" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">好了好了，关于TypeScript配置已经说得够多了。</p><h1 id="4a19" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">NGCC</h1><p id="49c8" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">如果您还没有这样做(NG9已经这样做了)，请确保您的“package.json”文件中有一个<code class="fe mw mx my mz b">postinstall</code>脚本，以便在安装后立即执行NGCC:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="877e" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">注意，在这个版本中，NGCC比T7更有弹性。以前，当它的一个工作进程崩溃时，它总是不能恢复。因此，如果你有时看到NGCC悬挂的问题，现在应该是固定的。</p><p id="4a94" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">NGCC也有相当多的改进，包括与性能相关的，这显然是我在NGCC最大的痛点；-)</p><h1 id="5a89" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">新的默认浏览器配置</h1><p id="3721" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">网络浏览器的速度比以往任何时候都快。Angular跟随航向，现在使用更新的<a class="ae kx" href="https://github.com/browserslist/browserslist" rel="noopener ugc nofollow" target="_blank">浏览器列表</a>文件(。browserslistrc)。</p><p id="b51f" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">正如官方博客中解释的那样，新配置的副作用是新项目默认禁用ES5构建。</p><p id="5456" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">当然，此时生成ES5代码已经没有多大意义了。现代网络浏览器至少支持ES2015。如果你还在用ie，那么显然是时候放下过去了！</p><p id="8429" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">要获得支持的Web浏览器的准确列表，只需在项目中执行以下命令:</p><pre class="le lf lg lh gt na mz nb nc aw nd bi"><span id="ede8" class="ne ma iq mz b gy nf ng l nh ni">npx browserslist</span></pre><p id="9101" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">输出是基于"的内容生成的。browserslistrc "文件的根目录；默认情况下，它现在看起来如下:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="88af" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">你可以在这里找到更多关于这个<a class="ae kx" href="https://angular.io/guide/browser-support" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h1 id="8a69" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">巴泽尔</h1><p id="9475" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">抱歉让你失望了，但是你知道吗<a class="ae kx" href="https://dev.to/bazel/angular-bazel-leaving-angular-labs-51ja" rel="noopener ugc nofollow" target="_blank">安格尔·巴泽尔已经离开了安格尔实验室</a>？Alex Eagle  <a class="ae kx" href="https://dev.to/bazel/angular-bazel-leaving-angular-labs-51ja" rel="noopener ugc nofollow" target="_blank">不久前在dev.to </a>上写了这篇文章。基本上，对Bazel的支持不再是Angular项目的一部分。</p><p id="9890" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">Bazel永远不会成为Angular CLI中的默认构建工具…</p><p id="a2a9" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">我不会在这里重复原因，但是一定要看看Alex的文章，因为它非常有趣(像往常一样)。</p><h1 id="a0a5" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">@ angular-dev kit/build-angular 0 . 1000 . 0)</h1><p id="904a" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">这个野蛮名字的背后(还有版本？？？！)，隐藏了Angular应用构建方式的一个重要部分。</p><p id="9e39" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">这个软件包的最新版本给我们带来了一些很酷的新功能。</p><p id="8081" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">最酷的一点(如果你使用SASS的话)是build-angular现在将资产的相对路径重新排序。</p><p id="8421" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">正如在<a class="ae kx" href="https://github.com/angular/angular-cli/commit/c034477dc5e64259fa1cff23a8d0646748a49521" rel="noopener ugc nofollow" target="_blank">提交</a>中所述，以前，在样式表中引用并在其他样式表中导入的类似<code class="fe mw mx my mz b">url(./foo.png)</code>的路径将保留确切的URL。这是有问题的，因为一旦导入的样式表不在同一个文件夹中，它就会中断。现在，将找到所有使用相对路径的资源。酷！</p><p id="0ca0" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">该版本中另一个隐藏的亮点是build-angular现在<a class="ae kx" href="https://github.com/angular/angular-cli/commit/a78d1c3ed14350bbe85bbf01ab30bcf6ad319f29" rel="noopener ugc nofollow" target="_blank">对</a><a class="ae kx" href="https://github.com/webpack/webpack/issues/5593" rel="noopener ugc nofollow" target="_blank"> Webpack不能处理的</a>重复模块进行重复数据删除。这是通过一个定制的Webpack解析插件完成的。</p><h1 id="b3bc" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">还有更多…</h1><h2 id="7f36" class="ne ma iq bd mb nl nm dn mf nn no dp mj km np nq ml ko nr ns mn kq nt nu mp nv bi translated">增量模板类型检查</h2><p id="6a36" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">在这个版本中，编译器CLI现在能够执行<a class="ae kx" href="https://medium.com/javascript-in-plain-english/angular-template-type-checking-e2c99c50f999" rel="noopener">模板类型检查</a> <a class="ae kx" href="https://github.com/angular/angular/commit/ecffc35" rel="noopener ugc nofollow" target="_blank">增量</a>。希望这将拯救相当多的树木(也许还有一两台笔记本电脑)！:)</p><h2 id="9326" class="ne ma iq bd mb nl nm dn mf nn no dp mj km np nq ml ko nr ns mn kq nt nu mp nv bi translated">罐头装载</h2><p id="c96b" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">以前<code class="fe mw mx my mz b">CanLoad</code>守卫<a class="ae kx" href="https://github.com/angular/angular/issues/28306" rel="noopener ugc nofollow" target="_blank">只能返回布尔</a>。现在，有可能返回一个<code class="fe mw mx my mz b">UrlTree</code>。这与<code class="fe mw mx my mz b">CanActivate</code>警卫的行为相符。</p><p id="15b4" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">请注意，这不会影响预加载。</p><h2 id="3160" class="ne ma iq bd mb nl nm dn mf nn no dp mj km np nq ml ko nr ns mn kq nt nu mp nv bi translated">I18N/L10N</h2><p id="7fef" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">以前，每个语言环境只支持一个翻译文件。现在，可以为每个地区指定多个文件。然后，所有这些都按照消息id进行合并。</p><p id="e7fe" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">关于这个我不能说太多，因为这些天我只使用ngx-translate &amp; transloco……查看这个<a class="ae kx" href="https://github.com/angular/angular/pull/36792" rel="noopener ugc nofollow" target="_blank">问题</a>了解更多细节。</p><h2 id="7673" class="ne ma iq bd mb nl nm dn mf nn no dp mj km np nq ml ko nr ns mn kq nt nu mp nv bi translated">服务人员</h2><p id="36d9" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">默认<code class="fe mw mx my mz b">SwRegistrationStrategy</code>已改进。以前，存在服务工作者<a class="ae kx" href="https://github.com/angular/angular/issues/34464" rel="noopener ugc nofollow" target="_blank">从未注册</a>的情况(例如，当有长时间运行的任务，如间隔和重复超时)。</p><p id="a8ab" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">同样，我不能多说什么，因为我使用的不是NGSW而是Workbox 。</p><h2 id="a356" class="ne ma iq bd mb nl nm dn mf nn no dp mj km np nq ml ko nr ns mn kq nt nu mp nv bi translated">角状材料</h2><p id="f3bd" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">像往常一样，Angular Material的发布遵循Angular的发布，所以Angular Material 10在这里，有很多变化。</p><p id="efd8" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">我不会在这篇文章中重复这些，因为它已经很长了，所以如果你感兴趣的话，去<a class="ae kx" href="https://github.com/angular/components/releases" rel="noopener ugc nofollow" target="_blank">看看发布说明</a>！</p><h1 id="9b09" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">大量错误修复</h1><p id="6c64" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">正如几周前提到的，Angular团队已经在bug修复和积压整理上投入了大量的时间和精力。他们已经减少了700期，这是相当可观的。</p><p id="0e3f" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">如果你是Angular以前版本中已知错误的受害者，那么可能是时候看看Angular 10是否没有修复这些错误了。</p><p id="6c67" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">有趣的是，启用<a class="ae kx" href="https://medium.com/javascript-in-plain-english/angular-template-type-checking-e2c99c50f999" rel="noopener">严格模板类型检查</a>会导致routerLinks出现问题，因为它们的底层类型不包含空/未定义的。另一个被修理的是<code class="fe mw mx my mz b">KeyValuePipe</code>，它<a class="ae kx" href="https://github.com/angular/angular/issues/35743" rel="noopener ugc nofollow" target="_blank">没有很好地配合</a>管子<code class="fe mw mx my mz b">async</code>。</p><p id="920d" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">当我们讨论模板时，请注意Angular <a class="ae kx" href="https://github.com/angular/angular/pull/36312" rel="noopener ugc nofollow" target="_blank">的语言服务现在支持</a>更多类似数组的对象，例如<code class="fe mw mx my mz b">ReadonlyArray</code>和<code class="fe mw mx my mz b">readonly</code>属性数组用于<code class="fe mw mx my mz b">*ngFor</code>循环。多酷啊。:)</p><h1 id="2a05" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">折旧和移除</h1><p id="e626" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">正如官方博客文章中所述，之前作为<a class="ae kx" href="https://g.co/ng/apf" rel="noopener ugc nofollow" target="_blank"> Angular Package Format </a>一部分的ESM5/FESM5捆绑包现在已经不存在了，因为向下升级到ES5已经在构建过程的最后完成了。如果您不使用Angular CLI来构建您的应用程序/库，并且仍然需要ES5包(可怜的灵魂..)，那么你就需要自己把角度代码降级到es5。</p><p id="be7f" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">不再支持IE 9、10和Internet Explorer Mobile。但是，如果你问我，你应该在这一点上完全抛弃IE。把丧尸留在身边简直是扯淡。</p><p id="9bba" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">有相当多的弃用成分，如带有反应形式的<code class="fe mw mx my mz b">ReflectiveInjector</code>、<code class="fe mw mx my mz b">CollectionChangeRecord</code>、<code class="fe mw mx my mz b">DefaultIterableDiffer</code>、<code class="fe mw mx my mz b">ReflectiveKey</code>、<code class="fe mw mx my mz b">RenderComponentType</code>、<code class="fe mw mx my mz b">ViewEncapsulation.Native</code>、<code class="fe mw mx my mz b">ngModel</code>、<code class="fe mw mx my mz b">preserveQueryParams</code>、<code class="fe mw mx my mz b">@angular/upgrade</code>、<code class="fe mw mx my mz b">defineInjectable</code>、<code class="fe mw mx my mz b">entryComponents</code>、<code class="fe mw mx my mz b">TestBed.get</code>等。</p><p id="d32c" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">你可以在这里查看完整的列表。</p><h1 id="8870" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">不再支持使用不带角度装饰器的角度特征的类</h1><p id="6cbf" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">直到版本9，在没有指定任何装饰器(@Component、@Directive等)的情况下，拥有一个使用角度特性的类是可以的。</p><p id="40ee" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">在Angular 10中，如果一个类使用角度特性，现在必须添加一个角度装饰器。这一变化影响了所有从基类扩展的组件，并且两者之一(即父类或子类)缺少角形装饰的情况。</p><p id="eb53" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">为什么这种改变是强制性的？简单来说，因为常春藤需要！</p><p id="1ef5" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">当一个类上没有Angular decorator时，Angular编译器不会为依赖注入添加额外的代码。</p><p id="4472" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">正如<a class="ae kx" href="https://next.angular.io/guide/migration-undecorated-classes" rel="noopener ugc nofollow" target="_blank">官方文档</a>中所述，当父类中缺少decorator时，子类将从编译器没有为其生成特殊构造函数信息的类中继承一个构造函数(因为它没有被修饰为指令)。当Angular试图创建子类时，它没有正确的信息来创建它。</p><p id="a3d8" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">在视图引擎中，编译器具有全局知识，因此它可以查找丢失的数据。然而，Ivy编译器只单独处理每个指令。这意味着编译可以更快，但编译器不能像以前一样自动推断出相同的信息。添加<code class="fe mw mx my mz b">@<a class="ae kx" href="https://next.angular.io/api/core/Directive" rel="noopener ugc nofollow" target="_blank">Directive</a>()</code>明确地提供了这个信息。</p><p id="1ebf" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">当子类缺少装饰器时，子类从父类继承，但没有自己的装饰器。没有装饰器，编译器无法知道这个类是<code class="fe mw mx my mz b">@<a class="ae kx" href="https://next.angular.io/api/core/Directive" rel="noopener ugc nofollow" target="_blank">Directive</a></code>还是<code class="fe mw mx my mz b">@<a class="ae kx" href="https://next.angular.io/api/core/Component" rel="noopener ugc nofollow" target="_blank">Component</a></code>，所以它不会为指令生成正确的指令。</p><p id="448b" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">这个变化的好处是它给角世界带来了更多的一致性(一致性是好的:p)。现在事情很简单:如果你使用角度特征，那么你必须添加一个装饰器。</p><p id="85d6" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">举个例子，下面的代码不能用Ivy编译:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="16d5" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">要解决这个问题，您需要向<code class="fe mw mx my mz b">Base</code>类添加一个装饰器。</p><p id="f3cb" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">你可以在这里了解更多关于这个变化的<a class="ae kx" href="https://next.angular.io/guide/migration-undecorated-classes" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="e115" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">ModuleWithProviders的强制泛型类型</h1><p id="ef0f" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">在以前的版本中，<a class="ae kx" href="https://angular.io/api/core/ModuleWithProviders" rel="noopener ugc nofollow" target="_blank"> ModuleWithProviders </a>已经接受了一个泛型类型，但是它不是强制的。对于NG 10，需要泛型参数。</p><p id="6152" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">无论如何，这对类型安全来说是件好事，所以希望您已经定义了参数:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="4ae2" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">如果您因为正在使用的库而偶然发现以下错误:</p><pre class="le lf lg lh gt na mz nb nc aw nd bi"><span id="a0a6" class="ne ma iq mz b gy nf ng l nh ni">error TS2314: Generic type 'ModuleWithProviders&lt;T&gt;' requires 1 type argument(s).</span></pre><p id="4f1b" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">然后你应该联系库的作者来修复它，因为ngcc在那里帮不上忙。一个解决方法是将<code class="fe mw mx my mz b">skipLibChecks</code>设置为假</p><h1 id="9a72" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">其他突破性变化</h1><p id="5e9c" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">以下是值得注意的突破性变化:</p><ul class=""><li id="664d" class="kf kg iq kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><a class="ae kx" href="https://angular.io/api/router/Resolve" rel="noopener ugc nofollow" target="_blank">解析器</a>表现不同；那些返回<code class="fe mw mx my mz b">EMPTY</code>的现在会取消导航。如果您想让导航继续，那么您需要确保您的解析器发出一个值；例如使用<code class="fe mw mx my mz b">defaultIfEmpty(...)</code>、<code class="fe mw mx my mz b">of(...)</code>等</li><li id="19ea" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">依赖于带有<code class="fe mw mx my mz b">Vary</code>头的资源的服务工作者实现将不会像以前那样工作。将忽略Vary标头。建议的“解决方案”是避免缓存这样的资源，因为它们往往会根据用户代理导致不可预测的行为。因此，即使资源的标头不同，也可以检索资源。注意<a class="ae kx" href="https://github.com/angular/angular/pull/34663" rel="noopener ugc nofollow" target="_blank">缓存匹配选项</a>现在可以在NGSW的配置文件中配置</li><li id="a341" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">如果<code class="fe mw mx my mz b">fubar</code>值与前一个值相同，诸如<code class="fe mw mx my mz b">[foo]=(bar$ | async).fubar</code>的属性绑定将不会触发变化检测。如果您依赖前面的行为，解决方法是手动订阅/强制更改检测或修改绑定，以确保引用确实发生了更改</li><li id="3e2e" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">以下<code class="fe mw mx my mz b">formatDate()</code>和<code class="fe mw mx my mz b">DatePipe</code>的格式代码发生变化；显然，前面的行为对于午夜过后的白天是不正确的</li><li id="5f5f" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">位于<code class="fe mw mx my mz b">UrlMatcher</code> <a class="ae kx" href="https://angular.io/api/router/UrlMatcher" rel="noopener ugc nofollow" target="_blank">实用程序类型</a>(函数别名)之后的函数现在可以正确地声明其返回类型可能是<code class="fe mw mx my mz b">null</code>。如果您有一个自定义的路由器或识别器类，那么您需要修改它们</li><li id="12c5" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">额外出现的<code class="fe mw mx my mz b">ExpressionChangedAfterItHasBeenChecked</code>现在可以由Angular引发，因为它以前没有检测到错误</li><li id="f60c" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">Angular现在会在发现模板中的未知元素/属性绑定时记录错误级别。这些是以前的警告</li><li id="96f6" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated">反应式表单的<code class="fe mw mx my mz b">valueChanges</code>有一个绑定到类型<code class="fe mw mx my mz b">number</code>输入的表单控件的bug(<a class="ae kx" href="https://github.com/angular/angular/issues/12540" rel="noopener ugc nofollow" target="_blank">他们自2016年以来触发了两次</a>！第一次是在输入域中键入之后，第二次是当输入域失去焦点时)。现在，数字输入不再听<code class="fe mw mx my mz b">change</code>事件，而是听<code class="fe mw mx my mz b">input</code>事件。不要忘记相应地调整你的测试。注意，这破坏了IE9的兼容性，但这对任何人来说都不是问题..对吗？；-)</li><li id="7568" class="kf kg iq kh b ki ky kk kz km la ko lb kq lc ks kt ku kv kw bi translated"><code class="fe mw mx my mz b">minLength</code>和<code class="fe mw mx my mz b">maxLength</code>验证器现在确保关联的表单控件值有一个数字<code class="fe mw mx my mz b">length</code>属性。如果不是这样，那么这些就不会被验证。以前，没有<code class="fe mw mx my mz b">length</code>属性(例如<code class="fe mw mx my mz b">false</code>或<code class="fe mw mx my mz b">0</code>)的falsy值会触发验证错误。如果您依赖于该行为，那么您应该添加其他验证器，如<a class="ae kx" href="https://angular.io/api/forms/Validators#min" rel="noopener ugc nofollow" target="_blank"> min </a>或<a class="ae kx" href="https://angular.io/api/forms/Validators#requiredTrue" rel="noopener ugc nofollow" target="_blank"> requiredTrue </a></li></ul><h1 id="a6fb" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">升级</h1><p id="22ee" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">像往常一样，有一个完整的<a class="ae kx" href="https://update.angular.io/#9.0:10.0l3" rel="noopener ugc nofollow" target="_blank">升级指南可用</a>和ng更新将帮助你:<a class="ae kx" href="https://update.angular.io/#9.0:10.0l3" rel="noopener ugc nofollow" target="_blank">https://update.angular.io/#9.0:10.0l3</a></p><p id="b1cc" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">如果你手动升级并且仍然使用量角器(以防万一)，那么不要忘记将量角器更新到7.0.0+,因为以前的版本有一个<a class="ae kx" href="https://www.npmjs.com/advisories/1500" rel="noopener ugc nofollow" target="_blank">漏洞</a>。</p><h1 id="f688" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="e174" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">在这篇文章中，我探索了Angular 10的新特性，以及不赞成、删除和突破性的变化。</p><p id="da76" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">总而言之，即使这不是一个惊天动地的版本，它显然是一个坚如磐石的版本，有大量的错误修复和一些宝石。</p><p id="8479" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">像往常一样，我们只能感谢Angular团队和围绕它的社区所做的一切努力！</p><p id="e173" class="pw-post-body-paragraph ll lm iq kh b ki kj jr ln kk kl ju lo km lp lq lr ko ls lt lu kq lv lw lx ks ij bi translated">今天到此为止。</p><h1 id="6b86" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">喜欢这篇文章吗？</h1><p id="ebc9" class="pw-post-body-paragraph ll lm iq kh b ki mr jr ln kk ms ju lo km mt lq lr ko mu lt lu kq mv lw lx ks ij bi translated">如果你想了解关于软件/Web开发、TypeScript、Angular、React、Vue、Kotlin、Java、Docker/Kubernetes和其他很酷的主题的大量其他很酷的东西，那么不要犹豫<a class="ae kx" href="https://www.amazon.com/Learn-TypeScript-Building-Applications-understanding-ebook/dp/B081FB89BL" rel="noopener ugc nofollow" target="_blank">拿一本我的书</a>并订阅<a class="ae kx" href="https://mailchi.mp/fb661753d54a/developassion-newsletter" rel="noopener ugc nofollow" target="_blank">我的简讯</a>！</p></div></div>    
</body>
</html>