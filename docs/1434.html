<html>
<head>
<title>Bcrypt vs BcryptJS Benchmark with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bcrypt与BcryptJS的Node.js基准测试</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-js-bcrypt-vs-bcryptjs-benchmark-69a9e8254cc2?source=collection_archive---------1-----------------------#2020-03-16">https://javascript.plainenglish.io/node-js-bcrypt-vs-bcryptjs-benchmark-69a9e8254cc2?source=collection_archive---------1-----------------------#2020-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/82f1583dfa6c464f74bad2a98df5e97a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T6XO37uYzGhOUD9l"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@marcsm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marc Sendra Martorell</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="d215" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">1.介绍</h1><p id="7f7e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><a class="ae kc" href="https://en.wikipedia.org/wiki/Bcrypt" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir"> Bcrypt </strong> </a>是最流行、最安全的单向密码散列函数之一。</p><p id="a166" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">对于<strong class="ld ir"> Node.js </strong>应用程序，我们有两个选项<strong class="ld ir"> bcrypt </strong>和<strong class="ld ir"> bcryptjs。</strong></p><blockquote class="me mf mg"><p id="a854" class="lb lc mh ld b le lz lg lh li ma lk ll mi mb lo lp mj mc ls lt mk md lw lx ly ij bi translated"><strong class="ld ir"> bcrypt </strong>用<strong class="ld ir"> C++ </strong>编写，在<a class="ae kc" href="https://www.npmjs.com/package/bcrypt" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir"> npm </strong> </a>每周下载超过40万次，在<a class="ae kc" href="http://github.com/kelektiv/node.bcrypt.js" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir"> github </strong> </a> <strong class="ld ir">有5.1k颗星。</strong></p><p id="139d" class="lb lc mh ld b le lz lg lh li ma lk ll mi mb lo lp mj mc ls lt mk md lw lx ly ij bi translated"><strong class="ld ir"> bcryptJS </strong>用<strong class="ld ir"> Javascript </strong>编写，在<a class="ae kc" href="https://www.npmjs.com/package/bcryptjs" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir"> npm </strong> </a>每周下载量超过56万，在<a class="ae kc" href="https://www.npmjs.com/package/bcryptjs" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir"> github </strong> </a> <strong class="ld ir">有2.3k颗星。</strong></p></blockquote><p id="9c05" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们将尝试在以下位置对这两个库进行基准测试:</p><ul class=""><li id="836c" class="ml mm iq ld b le lz li ma lm mn lq mo lu mp ly mq mr ms mt bi translated">同步生成哈希密码</li><li id="ab99" class="ml mm iq ld b le mu li mv lm mw lq mx lu my ly mq mr ms mt bi translated">异步比较哈希密码</li><li id="8619" class="ml mm iq ld b le mu li mv lm mw lq mx lu my ly mq mr ms mt bi translated">同步生成哈希密码</li><li id="7452" class="ml mm iq ld b le mu li mv lm mw lq mx lu my ly mq mr ms mt bi translated">异步比较哈希密码</li></ul><blockquote class="me mf mg"><p id="bcd9" class="lb lc mh ld b le lz lg lh li ma lk ll mi mb lo lp mj mc ls lt mk md lw lx ly ij bi translated">所有测试均在<a class="ae kc" href="https://www.digitalocean.com" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir">数字海洋</strong> </a>标准液滴下进行:</p><p id="f048" class="lb lc mh ld b le lz lg lh li ma lk ll mi mb lo lp mj mc ls lt mk md lw lx ly ij bi translated"><strong class="ld ir"> 1vCPU </strong>和<strong class="ld ir"> 1GB内存</strong></p></blockquote></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="6af0" class="kd ke iq bd kf kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la bi translated">2.生成和比较哈希密码</h1><p id="0b2c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">生成和比较密码的推荐方法是使用异步函数，但是在这个基准测试中，我们将同时测试异步和同步方法。</p><pre class="nl nm nn no gt np nq nr ns aw nt bi"><span id="0ae8" class="nu ke iq nq b gy nv nw l nx ny">mkdir bcryptBench<br/>cd bcryptBench<br/>npm init -y<br/>npm i bcrypt bcryptjs</span></pre><p id="b709" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们将测试bcrypt lib，创建一个新文件index.js并粘贴以下代码</p><pre class="nl nm nn no gt np nq nr ns aw nt bi"><span id="4625" class="nu ke iq nq b gy nv nw l nx ny">const bcrypt = require('bcrypt');</span><span id="4d2d" class="nu ke iq nq b gy nz nw l nx ny">const saltRounds = 8;</span><span id="9bf9" class="nu ke iq nq b gy nz nw l nx ny">const myPlaintextPassword = 'Mystr0ngP@SSW0RD';</span><span id="0c06" class="nu ke iq nq b gy nz nw l nx ny">var hashAsync;</span><span id="8e19" class="nu ke iq nq b gy nz nw l nx ny">var hashSync;</span><span id="ebef" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcrypt_Async Generate Hash');</span><span id="47e6" class="nu ke iq nq b gy nz nw l nx ny">bcrypt.hash(myPlaintextPassword, saltRounds).then(function (hash) {</span><span id="ec1d" class="nu ke iq nq b gy nz nw l nx ny">hashAsync = hash;</span><span id="43bd" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcrypt_Async Generate Hash');</span><span id="d467" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcrypt_Async Compare Hash');</span><span id="cbec" class="nu ke iq nq b gy nz nw l nx ny">bcrypt.compare(myPlaintextPassword, hashAsync).then(function (result) {</span><span id="a4b1" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcrypt_Async Compare Hash');</span><span id="7025" class="nu ke iq nq b gy nz nw l nx ny">});</span><span id="5d29" class="nu ke iq nq b gy nz nw l nx ny">});</span><span id="85c5" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcrypt_Sync Generate Hash');</span><span id="cd5e" class="nu ke iq nq b gy nz nw l nx ny">hashSync = bcrypt.hashSync(myPlaintextPassword, saltRounds);</span><span id="fe92" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcrypt_Sync Generate Hash')</span><span id="1b81" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcrypt_Sync Compare Hash');</span><span id="afc1" class="nu ke iq nq b gy nz nw l nx ny">bcrypt.compareSync(myPlaintextPassword, hashSync);</span><span id="8829" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcrypt_Sync Compare Hash');</span></pre><p id="f25c" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">运行代码</p><pre class="nl nm nn no gt np nq nr ns aw nt bi"><span id="944d" class="nu ke iq nq b gy nv nw l nx ny">node index.js</span></pre><figure class="nl nm nn no gt jr gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a49291ebbe2aa1ddae8263aa8a552adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*d28TJh5vT_3f_0BncFMCkw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Example output for bcrypt</figcaption></figure><p id="f86f" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们将测试bcryptjs库，创建一个新文件index2.js并粘贴以下代码</p><pre class="nl nm nn no gt np nq nr ns aw nt bi"><span id="d0bf" class="nu ke iq nq b gy nv nw l nx ny">var bcryptjs = require('bcryptjs');</span><span id="63d1" class="nu ke iq nq b gy nz nw l nx ny">const saltRounds = 8;</span><span id="83b2" class="nu ke iq nq b gy nz nw l nx ny">const myPlaintextPassword = 'Mystr0ngP@SSW0RD';</span><span id="378a" class="nu ke iq nq b gy nz nw l nx ny">var hashAsync;</span><span id="0631" class="nu ke iq nq b gy nz nw l nx ny">var hashSync;</span><span id="eab1" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcryptjs_Async Generate Hash');</span><span id="4adf" class="nu ke iq nq b gy nz nw l nx ny">bcryptjs.hash(myPlaintextPassword, saltRounds).then(function (hash) {</span><span id="0b84" class="nu ke iq nq b gy nz nw l nx ny">hashAsync = hash;</span><span id="ba75" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcryptjs_Async Generate Hash')</span><span id="cbd2" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcryptjs_Async Compare Hash');</span><span id="9cf7" class="nu ke iq nq b gy nz nw l nx ny">bcryptjs.compare(myPlaintextPassword, hashAsync).then(function (result) {</span><span id="fa96" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcryptjs_Async Compare Hash');</span><span id="59b9" class="nu ke iq nq b gy nz nw l nx ny">});</span><span id="0cca" class="nu ke iq nq b gy nz nw l nx ny">});</span><span id="6ead" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcryptjs_Sync Generate Hash');</span><span id="7779" class="nu ke iq nq b gy nz nw l nx ny">hashSync = bcryptjs.hashSync(myPlaintextPassword, saltRounds);</span><span id="fb1c" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcryptjs_Sync Generate Hash')</span><span id="0593" class="nu ke iq nq b gy nz nw l nx ny">console.time('bcryptjs_Sync Compare Hash');</span><span id="e988" class="nu ke iq nq b gy nz nw l nx ny">bcryptjs.compareSync(myPlaintextPassword, hashSync);</span><span id="629b" class="nu ke iq nq b gy nz nw l nx ny">console.timeEnd('bcryptjs_Sync Compare Hash');</span></pre><p id="ff90" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">运行代码</p><pre class="nl nm nn no gt np nq nr ns aw nt bi"><span id="3d65" class="nu ke iq nq b gy nv nw l nx ny">node index2.js</span></pre><figure class="nl nm nn no gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4395fe7eec529e537085c0cede699a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*yDoBtjh45wGfR8BGMezZ_Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Example output for bcryptjs</figcaption></figure><h1 id="c604" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">3.数字</h1><p id="e112" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">上面测试结果的条形图。时间越短，性能越好</p><figure class="nl nm nn no gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/1f9573ad1e84a089360a4fa87603c21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*pgHONWQPt4vyMJFqoEgDcQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">bcrypt vs bcryptjs bar chart</figcaption></figure><h1 id="8f0c" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">异步函数</h1><blockquote class="me mf mg"><p id="c082" class="lb lc mh ld b le lz lg lh li ma lk ll mi mb lo lp mj mc ls lt mk md lw lx ly ij bi translated"><strong class="ld ir"> Bcrypt </strong>生成哈希密码比<strong class="ld ir"> bcryptjs </strong>快<strong class="ld ir"> 1.8倍</strong>比<strong class="ld ir">快</strong>1.8倍。</p></blockquote><h1 id="b4dc" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">同步功能</h1><blockquote class="me mf mg"><p id="1979" class="lb lc mh ld b le lz lg lh li ma lk ll mi mb lo lp mj mc ls lt mk md lw lx ly ij bi translated"><strong class="ld ir"> Bcrypt </strong>生成哈希密码比<strong class="ld ir"> bcryptjs </strong>快<strong class="ld ir"> 3.1倍</strong> <strong class="ld ir">倍</strong>比<strong class="ld ir">快</strong>1.3倍。</p></blockquote><h1 id="9337" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">3.结论</h1><p id="d10d" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">Bcrypt比bcryptjs快得多，尽管用户在npm上更喜欢bcryptjs。这两个库都很优秀，很容易实现它们的目的。</p><h1 id="e93e" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">参考</h1><ul class=""><li id="0383" class="ml mm iq ld b le lf li lj lm od lq oe lu of ly mq mr ms mt bi translated"><a class="ae kc" href="https://www.npmjs.com/package/bcrypt" rel="noopener ugc nofollow" target="_blank"> bcrypt </a></li><li id="82c0" class="ml mm iq ld b le mu li mv lm mw lq mx lu my ly mq mr ms mt bi translated"><a class="ae kc" href="https://www.npmjs.com/package/bcryptjs" rel="noopener ugc nofollow" target="_blank"> bcryptjs </a></li><li id="1ebf" class="ml mm iq ld b le mu li mv lm mw lq mx lu my ly mq mr ms mt bi translated"><a class="ae kc" href="https://www.digitalocean.com" rel="noopener ugc nofollow" target="_blank">数字海洋</a></li><li id="365d" class="ml mm iq ld b le mu li mv lm mw lq mx lu my ly mq mr ms mt bi translated"><a class="ae kc" href="http://www.amcharts.com" rel="noopener ugc nofollow" target="_blank"> amcharts </a></li></ul></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="og oh l"/></div></figure></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="64ea" class="kd ke iq bd kf kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la bi translated">感谢你阅读我的故事</h1><p id="6105" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">请随时评论我的任何想法，变化等。</p><div class="oi oj gp gr ok ol"><a href="https://medium.com/swlh/master-ejs-template-engine-with-node-js-and-expressjs-979cc22b69be" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">具有Node.js和Expressjs的主EJS模板引擎</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">EJS是node.js和expressjs最受欢迎的模板视图引擎之一，在GitHub上有4.2k星级，超过550万…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz jw ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://medium.com/@pkoulianos/how-to-schedule-cron-jobs-and-set-health-checks-in-node-js-93cf88d2c247" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">如何在Node.js中调度Cron作业和设置健康检查</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">使用node.js中的Cron作业自动化您的任务</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz jw ol"/></div></div></a></div></div></div>    
</body>
</html>