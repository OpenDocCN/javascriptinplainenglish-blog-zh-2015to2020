<html>
<head>
<title>How to Set Up Nunjucks with Express.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Express.js设置Nunjucks</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-set-up-nunjucks-with-expressjs-30f52cdf275e?source=collection_archive---------13-----------------------#2020-12-16">https://javascript.plainenglish.io/how-to-set-up-nunjucks-with-expressjs-30f52cdf275e?source=collection_archive---------13-----------------------#2020-12-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8bde0f13b48231384e31b4d5ebeeda98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CnvyPg5Oe_dtuAWp.jpg"/></div></div></figure><p id="a14f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在没有ReactJS这样的专用前端框架的情况下构建web应用时，模板引擎(例如Blade、Nunjucks)非常有用。</p><p id="b3b1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">虽然它们不是完全必要的，但它们肯定有助于用更干净的HTML代码创建更动态的页面。</p><p id="0b6a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在进入JavaScript之前，Flask和Django是我构建web应用程序的首选。在这样的背景下，我非常习惯于Jinja2引擎。</p><p id="6439" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当我转而使用Express进行web应用程序开发时，我想要一个语法和特性与Jinja2相似的解决方案。幸运的是，Nunjucks正是如此。这是一个受Jinja2启发很大的模板引擎。</p><p id="ded7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本文中，我将带您完成ExpressJS的Nunjucks设置。这是一个相当简单直接的过程。</p><h1 id="7132" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">设置</h1><p id="d062" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">首先，创建一个空文件夹。导航到该文件夹并运行以下命令来初始化npm:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="d8ca" class="mf ku in mb b gy mg mh l mi mj">npm init</span></pre><p id="1df2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">按照所有提示设置您的项目。</p><p id="f498" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装过程完成后，您应该在项目的根目录下有一个package.json文件。</p><h1 id="6d40" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">安装软件包</h1><p id="f71c" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">接下来，运行以下命令来安装express和nunjucks。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="2bee" class="mf ku in mb b gy mg mh l mi mj">npm install express nunjucks</span></pre><h1 id="764e" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">定义入口点</h1><p id="8b1d" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">现在创建一个文件，作为我们应用程序的入口点。我将这个文件命名为index.js，并将其放在我的项目的根目录下。</p><p id="ed5a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">index.js的内容如下:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="f2cc" class="mf ku in mb b gy mg mh l mi mj">const express = require('express')<br/>const nunjucks = require('nunjucks')</span><span id="8e2d" class="mf ku in mb b gy mk mh l mi mj">var app = express()</span><span id="58de" class="mf ku in mb b gy mk mh l mi mj">nunjucks.configure('views', {<br/>  autoescape: true,<br/>  express: app<br/>})</span><span id="2ebf" class="mf ku in mb b gy mk mh l mi mj">app.set('view engine', 'html')</span><span id="0dc3" class="mf ku in mb b gy mk mh l mi mj">const PORT = '8000'</span><span id="8146" class="mf ku in mb b gy mk mh l mi mj">app.get('/', (req, res) =&amp;gt; {<br/>  res.render('home.html')<br/>})</span><span id="a2c0" class="mf ku in mb b gy mk mh l mi mj">app.listen(PORT, () =&amp;gt; {<br/>  console.log(`Listening on port ${PORT}...`)<br/>})</span></pre><ul class=""><li id="3f9a" class="ml mm in jx b jy jz kc kd kg mn kk mo ko mp ks mq mr ms mt bi translated">配置nunjucks:第一个参数是模板文件夹的路径。第二个参数是包含配置选项的对象。<a class="ae mu" href="https://mozilla.github.io/nunjucks/templating.html#autoescaping" rel="noopener ugc nofollow" target="_blank">自动转义</a>确保所有输出到模板的内容在显示前被转义(推荐)。您可以手动将输出标记为安全。express属性需要express应用程序的实例。</li><li id="800e" class="ml mm in jx b jy mv kc mw kg mx kk my ko mz ks mq mr ms mt bi translated">设置端口号。我们将在稍后启动应用程序时使用它。</li><li id="ba13" class="ml mm in jx b jy mv kc mw kg mx kk my ko mz ks mq mr ms mt bi translated">在“/”处创建一个“get”路由，并返回一个仅呈现模板home.html的响应。</li><li id="d45d" class="ml mm in jx b jy mv kc mw kg mx kk my ko mz ks mq mr ms mt bi translated">侦听指定端口上的连接。</li></ul><h1 id="a00e" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">创建模板</h1><p id="3dc7" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">此时，如果你试图加载应用程序，你会得到一个错误，因为我们还没有创建我们试图呈现的模板。</p><p id="3dd1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">请记住，我们将模板的路径设置为“视图”。Nunjucks将在运行配置的脚本所在的目录中查找“views”文件夹。</p><p id="b38c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果您的模板文件夹在另一个目录中，或者已将其命名为不同的名称，如“templates ”,请确保正确配置路径。</p><p id="ce08" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这种情况下，我们必须在项目的根目录下创建一个名为“views”的文件夹(因为这是index.js所在的位置)。</p><p id="97cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在“视图”文件夹中，创建一个base.html模板。这是将被其他模板继承的模板。它允许我们只定义一次特定的UI元素、样式和脚本，并在每个模板上显示/导入它们。</p><p id="5867" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我们定义导航栏和页脚的地方。</p><p id="89b7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">base.html的内容如下:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="efd3" class="mf ku in mb b gy mg mh l mi mj">&lt;!DOCTYPE html&gt;</span><span id="de30" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">&lt;html&gt;</strong></span><span id="791b" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">  &lt;head&gt;</strong></span><span id="7314" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;meta</strong> charset="utf-8"<strong class="mb io">&gt;</strong></span><span id="cb2d" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;meta</strong> http-equiv="X-UA-Compatible" content="IE=edge"<strong class="mb io">&gt;</strong></span><span id="e268" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;title&gt;</strong>{{ title }}<strong class="mb io">&lt;/title&gt;</strong></span><span id="fc6c" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;meta</strong> name="description" content=""<strong class="mb io">&gt;</strong></span><span id="6dd9" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;meta</strong> name="viewport" content="width=device-width, initial-scale=1"<strong class="mb io">&gt;</strong></span><span id="1586" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;link</strong> rel="stylesheet" href=""<strong class="mb io">&gt;</strong></span><span id="fdb1" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">  &lt;/head&gt;</strong></span><span id="9be2" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">  &lt;body&gt;</strong></span><span id="9fef" class="mf ku in mb b gy mk mh l mi mj">    {% block content %}{% endblock %}</span><span id="fd09" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">    &lt;script</strong> src="" async defer<strong class="mb io">&gt;&lt;/script&gt;</strong></span><span id="174f" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">  &lt;/body&gt;</strong></span><span id="65d2" class="mf ku in mb b gy mk mh l mi mj"><strong class="mb io">&lt;/html&gt;</strong></span></pre><p id="5291" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们已经定义了一个将被子模板覆盖的内容块。这是子模板放置各自内容的地方。</p><p id="190c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，创建一个扩展base.html的home.html模板，并在内容块中显示一个简单的标题。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="3686" class="mf ku in mb b gy mg mh l mi mj">{% extends 'base.html' %}</span><span id="d442" class="mf ku in mb b gy mk mh l mi mj">{% set title = 'Home' %} </span><span id="1e9b" class="mf ku in mb b gy mk mh l mi mj">{% block content %} <br/>  &lt;h1&gt;Welcome home!&lt;/h1&gt;<br/>{% endblock %}</span></pre><p id="c70b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们已经创建了模板，我们可以加载主页了。在指定的端口访问localhost，你应该会看到你的应用程序启动并运行！</p><h1 id="9ea2" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="41f8" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在本文中，我们介绍了如何使用express web应用程序设置nunjucks模板引擎。在下一篇文章中，我将讲述如何使用mongose将express应用程序连接到MongoDB，这样我们就可以持久化数据。</p><p id="0aa6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你可以在<a class="ae mu" href="https://github.com/kelvinmwinuka/express-tutorial" rel="noopener ugc nofollow" target="_blank"> Github </a>上跟踪这个项目的进展。</p><p id="355c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="na">如果你喜欢这篇文章，可以考虑关注我的</em> <a class="ae mu" href="https://kelvinmwinuka.com/" rel="noopener ugc nofollow" target="_blank"> <em class="na">个人网站</em> </a> <em class="na">，以便在我的内容在媒体上发布之前提前获得(别担心，它仍然是免费的，没有烦人的弹出广告！).另外，请随意评论这篇文章。我很想听听你们的想法！</em></p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><p id="7a23" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="na">原载于2020年12月16日https://kelvinmwinuka.com</em><a class="ae mu" href="https://kelvinmwinuka.com/how-to-set-up-nunjucks-with-expressjs/" rel="noopener ugc nofollow" target="_blank"><em class="na"/></a><em class="na">。</em></p></div></div>    
</body>
</html>