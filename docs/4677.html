<html>
<head>
<title>Create a Simple Authentication Form With React and Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React和Firebase创建一个简单的身份验证表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-simple-authentication-form-with-react-and-firebase-f29f723b341c?source=collection_archive---------2-----------------------#2020-12-30">https://javascript.plainenglish.io/create-a-simple-authentication-form-with-react-and-firebase-f29f723b341c?source=collection_archive---------2-----------------------#2020-12-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="00ed" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用现有技术简化事情</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bbce95c3ed105c8e49a556e74f220464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QTVEMCkM4BKUz6to.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://dzone.com/articles/react-apps-firebase" rel="noopener ugc nofollow" target="_blank">https://dzone.com/articles/react-apps-firebase</a></figcaption></figure><p id="3cab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您的web应用程序需要持久化用户数据，那么您可能需要他们注册或登录以显示更个性化的内容。</p><p id="bb88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如今，如果你希望你的应用程序更容易访问，你需要支持各种登录方式，如短信，电子邮件/密码，谷歌，脸书等。工作量很大。</p><p id="7452" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我想告诉你<strong class="ky ir"> Firebase </strong>和<strong class="ky ir"> Firebaseui </strong>如何简化事情。这些技术支持多种登录方法，将跟踪用户状态，并使我们作为开发人员的工作变得非常容易。</p><p id="df15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将创建一个注册和登录表单，支持电子邮件/密码和谷歌登录。该表单还将跟踪用户是否登录。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3070" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">在开始之前</h1><p id="3142" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在本教程中，我们将只使用Firebase的认证服务。</p><p id="84ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这项服务只处理注册和登录。如果你想让你的应用程序存储更多的用户相关数据，你需要把它连接到<a class="ae kv" href="https://firebase.google.com/docs/firestore" rel="noopener ugc nofollow" target="_blank"> Firestore </a>。</p><p id="babc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程将使用React钩子来完成。如果你还不太熟悉它们，请参考<a class="ae kv" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">官方React文档。</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="07fa" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">设置</h1><p id="1430" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我已经在GitHub 上创建了由表单的HTML和CSS组成的<a class="ae kv" href="https://github.com/mchigit/auth_form_react/tree/starter_code" rel="noopener ugc nofollow" target="_blank">起始代码。</a></p><p id="3379" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">克隆存储库后，运行以下命令安装依赖项并启动应用程序:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="0eec" class="nb ma iq mx b gy nc nd l ne nf">yarn install<br/>yarn start</span><span id="20f1" class="nb ma iq mx b gy ng nd l ne nf">// or npm</span><span id="f060" class="nb ma iq mx b gy ng nd l ne nf">npm install<br/>npm start</span></pre><p id="ff45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前，我们所有的是一个可以在登录和注册之间切换的表单。我们将在后面的章节中使用<code class="fe nh ni nj mx b">firebaseui </code>添加Google登录按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/a6f83b7b23008d37f2b1253e7b6616da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_tt-dyUruSDMokKv-kQz9Q.png"/></div></div></figure><p id="a598" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还设置了一些钩子来管理状态，比如输入值和跟踪登录/注册切换。</p><h2 id="c1be" class="nb ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">设置Firebase</h2><p id="1124" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated"><strong class="ky ir"> Firebase </strong>是一个构建web和移动应用的云平台。我们将使用身份验证服务，该服务为用户身份验证提供后端和SDK。</p><p id="ad39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要使用身份验证服务，我们需要一个Firebase项目。如果您已经登录到Firebase控制台，您应该会看到如下屏幕:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/64c264285cb3f13397eceac714b6b01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-PUSPcf-r7mGU2nykrtqPA.png"/></div></div></figure><p id="1a15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击“<strong class="ky ir">创建一个项目</strong>”并完成步骤。我们并不真的需要分析，所以您可以在创建步骤中禁用它们。</p><p id="f2bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将被带到项目概述页面，您可以通过单击此处创建应用程序:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/cfec202bb009a76d4178154498b40dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjqU3ut1F2Iv1_Tuifokug.png"/></div></div></figure><p id="ede5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成注册web应用程序的步骤，您将获得如下所示的代码片段:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/4f2f4c1249a6fd59a8885c0255e789fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSJyNLby8momWZtIXApS1g.png"/></div></div></figure><p id="0f2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这段代码将使用我们刚刚创建的应用程序的配置来初始化firebase。但是我们不需要全部，你应该记下的重要变量是<code class="fe nh ni nj mx b">firebaseConfig</code>。</p><p id="2143" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，单击此处为我们的应用启用身份验证:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/78e31927cb09fc9a6eae9f4eae6dffdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lubU27f8KpezT-N7S6AU7A.png"/></div></div></figure><p id="41ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击“开始”以启用该服务。然后点击<strong class="ky ir"> </strong>顶部的<strong class="ky ir">登录方式</strong>，设置您希望您的用户如何登录。你应该到达这里:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/5edd60140c95368a1742cfe78ccc2a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOUcGySc9BEXT8CoSlfHYg.png"/></div></div></figure><p id="5af7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要启用2个提供商:电子邮件/密码和谷歌。当您启用Google时，您需要输入支持电子邮件。</p><p id="bf3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">设置部分到此结束。现在我们可以写一些实际的代码了！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="87ce" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用Firebase创建用户并让他们登录</h1><p id="21d8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们可以在Firebase的“用户”选项卡中手动创建用户:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/f390f25fc6c543469f168981efeaac4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J3vxhMlLTqz7yBCbvMXBYw.png"/></div></div></figure><p id="5da9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是理想情况下，我们希望当用户想要注册时，前端表单请求这个动作。</p><p id="df58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们将需要使用Firebase SDK for Node。Firebase提供了许多不同语言的SDK与之交互。要在React应用程序中安装Firebase，请运行以下命令:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="45a9" class="nb ma iq mx b gy nc nd l ne nf">yarn add firebase</span><span id="5a6c" class="nb ma iq mx b gy ng nd l ne nf">// or using npm</span><span id="d5e1" class="nb ma iq mx b gy ng nd l ne nf">npm install firebase --save</span></pre><p id="4fdf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装好库之后，在<code class="fe nh ni nj mx b">src</code>文件夹中创建一个<code class="fe nh ni nj mx b">firebase.js</code>文件，代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="62c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这段代码将为我们刚刚创建的项目初始化Firebase。它通过调用<code class="fe nh ni nj mx b">firebase.auth()</code>导出Firebase Auth服务。</p><p id="baa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用户单击注册按钮时，在状态中捕获输入值。然后我们将使用Firebase的<code class="fe nh ni nj mx b">createUserWithEmailAndPassword</code>方法来创建用户。这个函数接受电子邮件和密码作为参数，并返回一个带有用户对象的承诺。</p><p id="9e24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">登录非常相似，但方法不同。我们可以使用接受相同参数的<code class="fe nh ni nj mx b">signInWithEmailAndPassword</code>方法。让我们创建一个函数来处理这两种情况:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="453a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在登录/注册按钮的onClick处理程序中使用这个函数:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="40b3" class="nb ma iq mx b gy nc nd l ne nf">// Previous code</span><span id="70ed" class="nb ma iq mx b gy ng nd l ne nf">// loginEmail, LoginPassword are input values stored in state</span><span id="1f90" class="nb ma iq mx b gy ng nd l ne nf">&lt;Button onClick={() =&gt; authenticateUser(loginEmail, loginPassword, true)}&gt;  Login &lt;/Button&gt;</span><span id="8781" class="nb ma iq mx b gy ng nd l ne nf">...</span><span id="1e15" class="nb ma iq mx b gy ng nd l ne nf">// Same with signupEmail and signupPassword</span><span id="9d87" class="nb ma iq mx b gy ng nd l ne nf">&lt;Button onClick={() =&gt; authenticateUser(signupEmail, signupPassword, false)}&gt;  Sign up &lt;/Button&gt;</span></pre><p id="d51c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果我们尝试使用电子邮件和密码注册，用户应该在Firebase中创建。因为我们添加了控制台日志，所以您也可以打开控制台窗口来查看用户对象:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/876441775a98caa23a88b2af592d20a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6seuHUFyAF3MLqqi2ggmag.png"/></div></div></figure><p id="3da4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Firebase的一个方便的流程是用户在创建时自动登录。</p><p id="abb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您输入的电子邮件没有通过验证或密码太弱，该方法将返回拒绝的承诺:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/63412f586172444da7f1563145d2fd0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMJLfkY4o8EoOzO5TxtIyQ.png"/></div></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0f29" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">跟踪授权状态</h1><p id="aa88" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们应该根据用户是否登录来显示不同的内容。Firebase有一个有用的方法，允许我们跟踪应用程序的身份验证状态。</p><p id="f7a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nh ni nj mx b">onAuthStateChanged</code>允许我们添加一个监听器，当认证状态改变时，该监听器将被触发。我们作为参数传入的函数可以访问用户变量。如果用户已注销，此变量将为null，否则将包含用户的信息。</p><p id="07a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nh ni nj mx b">AuthForm.jsx</code>中，在<code class="fe nh ni nj mx b">AuthForm</code>中的return语句之前添加以下代码:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="bd33" class="nb ma iq mx b gy nc nd l ne nf">auth.onAuthStateChanged((user) =&gt; setUser(user));</span></pre><p id="6e0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nh ni nj mx b">setUser</code>是一个钩子函数，设置用户对象的状态。我们可以根据这种状态呈现不同的内容。</p><p id="19f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建一个函数，在用户登录时呈现不同的内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="8a58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果用户已经登录，我们希望呈现一个标题文本来通知他们，并为他们提供一个注销按钮。现在让我们添加注销用户的功能。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="75b9" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">注销</h1><p id="dcc6" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">注销也非常简单。Auth有一个我们可以使用的<code class="fe nh ni nj mx b">signOut</code>方法:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="f434" class="nb ma iq mx b gy nc nd l ne nf">&lt;Button onClick={() =&gt; auth.signOut()} color="yellow"&gt; Log out &lt;/Button&gt;</span></pre><p id="8cd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从技术上来说，<code class="fe nh ni nj mx b">signOut </code>也回报承诺，但我们不必等待。该操作将触发auth状态的变化，导致我们设置的监听器运行，并将用户状态设置为null。这将导致组件重新呈现。</p><p id="c993" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一个功能认证表单，允许用户注册、登录和注销。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d2d4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">Google登录</h1><h2 id="8be6" class="nb ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">建立</h2><p id="123f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">要添加Google登录，我们可以在这里下载一个<a class="ae kv" href="https://developers.google.com/identity/branding-guidelines" rel="noopener ugc nofollow" target="_blank"> Google按钮资产</a>并使用Firebase方法来处理登录。</p><p id="15d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，谷歌登录有各种各样的用户流，可能很难管理。例如，我们需要考虑已经有Google帐户登录的情况，没有帐户登录的情况，以及用户可能需要创建新的Google帐户的情况。</p><p id="9b15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/firebase/firebaseui-web" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Firebaseui </strong> </a>是一个前端库，在Firebase SDK之上创建ui绑定。它将细节抽象化，设置起来超级简单。在您的终端中，运行以下命令来安装库:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="708c" class="nb ma iq mx b gy nc nd l ne nf">yarn add firebaseui</span><span id="a220" class="nb ma iq mx b gy ng nd l ne nf">// or using npm:</span><span id="7b8c" class="nb ma iq mx b gy ng nd l ne nf">npm install firebaseui --save</span></pre><p id="dc9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们需要在<code class="fe nh ni nj mx b">index.js</code>中导入CSS，这是我们的根JavaScript文件。这将允许我们使用库提供的样式:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="ef58" class="nb ma iq mx b gy nc nd l ne nf">// src/index.js</span><span id="61b2" class="nb ma iq mx b gy ng nd l ne nf">import 'firebaseui/dist/firebaseui.css'</span></pre><p id="fe5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nh ni nj mx b">src/firebase.js</code>中，我们需要用下面的代码初始化UI库:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="98ab" class="nb ma iq mx b gy nc nd l ne nf">export const authUI = new firebaseui.auth.AuthUI(auth);</span></pre><p id="c590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，auth变量是我们从Firebase初始化的认证服务。现在我们可以在组件中使用<code class="fe nh ni nj mx b">authUI</code>来创建Google登录。</p><blockquote class="og oh oi"><p id="1fa9" class="kw kx oj ky b kz la jr lb lc ld ju le ok lg lh li ol lk ll lm om lo lp lq lr ij bi translated">如果您在上一步中没有启用Google登录方法，您还需要启用它。</p></blockquote><h2 id="dc2d" class="nb ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">履行</h2><p id="e000" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在<code class="fe nh ni nj mx b">AuthForm.jsx</code>中，我们已经有了一个div，可以用作Google登录按钮的占位符:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="c1f7" class="nb ma iq mx b gy nc nd l ne nf">&lt;div className="google-login"&gt;&lt;/div&gt;</span></pre><p id="a07a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了呈现一个Google登录按钮，我们需要使用<code class="fe nh ni nj mx b">authUI.start</code>方法。第一个参数是一个HTML元素，它可以是一个CSS选择器或一个实际的元素。第二个参数是配置。</p><p id="e192" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们只想在用户注销时呈现Google登录。代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="dfb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用了<code class="fe nh ni nj mx b">useEffect</code>钩子，并使它依赖于用户状态。每当这种状态改变时，内部的功能就会被触发。我们检查用户是否为空，如果是，只调用<code class="fe nh ni nj mx b">start</code>方法。这是因为当用户登录时，我们不呈现占位符div，Firebaseui将无法找到该元素。</p><p id="773d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个参数用于选择div作为按钮的占位符。Firebaseui start方法将一直等到整个DOM加载完毕。</p><p id="a1b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二个对象是配置。在这里，我们需要定义支持的登录选项，我们将在这里添加谷歌提供商ID。如果您希望支持脸书或苹果等登录方式，可以在这里添加其他提供商。通过指定其他提供程序，相应的按钮也将被呈现。</p><p id="26c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果我们重新启动服务器，我们会在表单底部看到一个新的Google登录按钮:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/aba80423d798870fde5262a688931d77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQTAR8H17_kMwo-abz-R0Q.png"/></div></div></figure><p id="2f37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击该按钮将带您浏览谷歌的登录流程。您可以尝试创建一个新的Google用户，以现有用户的身份登录，或者选择一个已经登录的帐户。然后在控制台中，您应该会看到登录用户的相应信息。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="6c73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是使用Firebase创建基本身份验证表单的简单之处。你可以在这里查看<a class="ae kv" href="https://github.com/mchigit/auth_form_react/tree/finished" rel="noopener ugc nofollow" target="_blank">的完成代码</a>。</p><p id="5d11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成本教程后，您现在应该知道:</p><ul class=""><li id="e685" class="oo op iq ky b kz la lc ld lf oq lj or ln os lr ot ou ov ow bi translated">如何注册用户，使用Firebase登录和注销他们</li><li id="1eb0" class="oo op iq ky b kz ox lc oy lf oz lj pa ln pb lr ot ou ov ow bi translated">如何使用Firebaseui为其他登录方法创建ui绑定</li><li id="526a" class="oo op iq ky b kz ox lc oy lf oz lj pa ln pb lr ot ou ov ow bi translated">跟踪用户是否经过身份验证</li></ul><p id="6086" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这篇教程能对你有所帮助！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="0ab1" class="nb ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">资源</h2><ul class=""><li id="c8dc" class="oo op iq ky b kz mr lc ms lf pc lj pd ln pe lr ot ou ov ow bi translated"><a class="ae kv" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"> React钩子文档</a></li><li id="64d1" class="oo op iq ky b kz ox lc oy lf oz lj pa ln pb lr ot ou ov ow bi translated"><a class="ae kv" href="https://github.com/firebase/firebaseui-web" rel="noopener ugc nofollow" target="_blank"> Firebaseui </a></li><li id="4f52" class="oo op iq ky b kz ox lc oy lf oz lj pa ln pb lr ot ou ov ow bi translated"><a class="ae kv" href="https://firebase.google.com/docs/auth/web/start" rel="noopener ugc nofollow" target="_blank"> Firebase Auth </a></li><li id="5937" class="oo op iq ky b kz ox lc oy lf oz lj pa ln pb lr ot ou ov ow bi translated"><a class="ae kv" href="https://github.com/mchigit/auth_form_react" rel="noopener ugc nofollow" target="_blank"> GitHub代码</a></li></ul></div></div>    
</body>
</html>