<html>
<head>
<title>Exploring Internationalisation With Nextjs 10 and react-intl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Nextjs 10和react-intl探索国际化</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/exploring-internationalisation-with-nextjs-10-and-react-intl-b6b8ccac36c9?source=collection_archive---------4-----------------------#2020-11-07">https://javascript.plainenglish.io/exploring-internationalisation-with-nextjs-10-and-react-intl-b6b8ccac36c9?source=collection_archive---------4-----------------------#2020-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="io ip gp gr iq ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/29e49f47c9c5636d420624de86f8d263.png" data-original-src="https://miro.medium.com/v2/0*f49tAaWTEiFGFS5K"/></div></figure><div class=""/><p id="e997" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我们将深入探讨Next.js 10在<a class="ae ks" href="https://nextjs.org/docs/advanced-features/i18n-routing" rel="noopener ugc nofollow" target="_blank">国际化路由</a>中的一个新的高级特性，以及我们如何在<a class="ae ks" href="https://www.npmjs.com/package/react-intl" rel="noopener ugc nofollow" target="_blank"> react-intl </a>中使用它。</p><h2 id="421d" class="kt ku ix bd kv kw kx dn ky kz la dp lb kf lc ld le kj lf lg lh kn li lj lk ll bi translated">入门指南</h2><p id="c637" class="pw-post-body-paragraph ju jv ix jw b jx lm jz ka kb ln kd ke kf lo kh ki kj lp kl km kn lq kp kq kr ij bi translated">通过运行<code class="fe lr ls lt lu b">npx create-next-app i18n-example</code>创建一个新的项目名称<strong class="jw iy">i18n-示例</strong>，创建一个新的Next.js 10项目。</p><p id="6b02" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们将运行一些其他命令进行设置:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><blockquote class="mb mc md"><p id="b2f1" class="ju jv me jw b jx jy jz ka kb kc kd ke mf kg kh ki mg kk kl km mh ko kp kq kr ij bi translated">为了安装<code class="fe lr ls lt lu b">react-intl</code>,我使用了<code class="fe lr ls lt lu b">--legacy-peer-deps</code>,因为有一个<code class="fe lr ls lt lu b">react@^16.3.0</code>的对等依赖，我运行的是npm v7。</p></blockquote><p id="bfa8" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们已经有了一些文件，让我们从一些基本内容开始吧！</p><h2 id="a89e" class="kt ku ix bd kv kw kx dn ky kz la dp lb kf lc ld le kj lf lg lh kn li lj lk ll bi translated">设置Next.js i18n</h2><p id="d0a2" class="pw-post-body-paragraph ju jv ix jw b jx lm jz ka kb ln kd ke kf lo kh ki kj lp kl km kn lq kp kq kr ij bi translated">根据<a class="ae ks" href="https://nextjs.org/docs/advanced-features/i18n-routing" rel="noopener ugc nofollow" target="_blank">开始</a>的文档，我们需要更新<code class="fe lr ls lt lu b">next.config.js</code>:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="8a7c" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里我们用<a class="ae ks" href="https://nextjs.org/docs/advanced-features/i18n-routing#sub-path-routing" rel="noopener ugc nofollow" target="_blank">子路径路由</a>，所以TL；dr是指<code class="fe lr ls lt lu b">our-website.com</code>将是默认的语言环境(英语)，而<code class="fe lr ls lt lu b">our-website.com/fr</code>和<code class="fe lr ls lt lu b">our-website.com/es</code>将分别把我们导向法语和西班牙语网站。</p><p id="baa2" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们已经解决了这个问题，让我们更新一下<code class="fe lr ls lt lu b">pages/index.js</code>页面吧！</p><h2 id="2b5a" class="kt ku ix bd kv kw kx dn ky kz la dp lb kf lc ld le kj lf lg lh kn li lj lk ll bi translated">国际化我们的主页</h2><p id="259d" class="pw-post-body-paragraph ju jv ix jw b jx lm jz ka kb ln kd ke kf lo kh ki kj lp kl km kn lq kp kq kr ij bi translated">我们可以使用下一个路由器来获取我们所处的位置。</p><p id="25c7" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从Vercel的GitHub中有一个<a class="ae ks" href="https://github.com/vercel/next.js/blob/canary/examples/i18n-routing/pages/index.js" rel="noopener ugc nofollow" target="_blank">简单的例子</a>，我们可以从中获得灵感。</p><p id="cdb1" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">替换<code class="fe lr ls lt lu b">pages/index.js</code>如下图所示:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="f235" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有了这个，我们就可以开始我们的应用程序，并看到结果。</p><p id="337d" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">运行<code class="fe lr ls lt lu b">npm run dev</code>启动服务器，并转到本地主机特定端口(可能是<code class="fe lr ls lt lu b"><a class="ae ks" href="http://localhost:3000)." rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code> <a class="ae ks" href="http://localhost:3000)." rel="noopener ugc nofollow" target="_blank">)。</a></p><p id="72fb" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦你到了那里，你将会看到当前的英语语言环境以及配置了哪些语言环境！</p><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/9530d37e28d50e4acf7533c1fcea795d.png" data-original-src="https://miro.medium.com/v2/0*Kowr9YyTCOvID-2H"/></div></figure><p id="de50" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">考虑到我们之前提到的关于子路由的内容，我们现在可以转到<code class="fe lr ls lt lu b">/fr</code>和<code class="fe lr ls lt lu b">/es</code>并期待当前的语言环境发生变化。下图是<code class="fe lr ls lt lu b">/fr</code>路线，展示我们的子路线工作。</p><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/af8b380279311d19a33509d8dfd4f45a.png" data-original-src="https://miro.medium.com/v2/0*iFsi4KOv3Z6uwbgW"/></div></figure><p id="81f9" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">太神奇了！现在我们在这里完成了，我们可以用<code class="fe lr ls lt lu b">react-intl</code>来实现它。</p><h2 id="7bbf" class="kt ku ix bd kv kw kx dn ky kz la dp lb kf lc ld le kj lf lg lh kn li lj lk ll bi translated">使用react-intl切换拷贝</h2><p id="bc2a" class="pw-post-body-paragraph ju jv ix jw b jx lm jz ka kb ln kd ke kf lo kh ki kj lp kl km kn lq kp kq kr ij bi translated">我们将使用<code class="fe lr ls lt lu b">react-intl</code>运行一个简单的例子，但是我们首先需要做的是准备一些我们希望替换掉的内容！</p><p id="4028" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在<code class="fe lr ls lt lu b">content/locale/en.js</code>里面，让我们通过一些基本的JSON来代替我们的“Hello，world！”欢迎信息:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><blockquote class="mb mc md"><p id="9d00" class="ju jv me jw b jx jy jz ka kb kc kd ke mf kg kh ki mg kk kl km mh ko kp kq kr ij bi translated">这些文件的结构由您决定，但是我现在使用页面名称的顶级键和字符串中的标识符。我以前工作过的地方把它保存为JSON上传到像<a class="ae ks" href="https://www.smartling.com/" rel="noopener ugc nofollow" target="_blank"> Smartling </a>这样的地方，所以你可能想把JSON转换成我正在使用的上述ES6格式。</p></blockquote><p id="0086" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们复制粘贴到我们的西班牙语和法语文件，并使用一些可能不准确的谷歌翻译来帮助我们。</p><p id="7bef" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对法国人来说:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="fa15" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于西班牙人:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="e98a" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，我们想要更新我们的桶文件<code class="fe lr ls lt lu b">content/locale/index.js</code>:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="b4cd" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">太好了！现在我们在这里，让我们回到<code class="fe lr ls lt lu b">pages/_app.js</code>来添加我们需要的提供者。</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="897b" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们正在做一些事情:</p><ol class=""><li id="77bf" class="mi mj ix jw b jx jy kb kc kf mk kj ml kn mm kr mn mo mp mq bi translated">通过我们创建的桶文件导入所有的语言环境文件。</li><li id="749f" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated">从<code class="fe lr ls lt lu b">react-intl</code>导入<code class="fe lr ls lt lu b">IntlProvider</code>，作为应用程序的一部分用于我们的每个页面。</li><li id="b1eb" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated">使用Next.js路由器给出的<code class="fe lr ls lt lu b">pathname</code>来根据页面确定使用哪个区域设置副本。</li></ol><p id="50a6" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在让我们回到<code class="fe lr ls lt lu b">pages/index.js</code>并利用<code class="fe lr ls lt lu b">react-intl</code>。</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="ef9a" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个页面上，我导入了<code class="fe lr ls lt lu b">useIntl</code>钩子，从那个钩子中析构了<code class="fe lr ls lt lu b">formatMessage</code>，创建了一个帮助器函数<code class="fe lr ls lt lu b">f</code>，它抽象了总是传递一个带有id的对象的需求，并用我们在区域设置内容中的页面的键名替换了适当的代码。</p><p id="0383" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们用<code class="fe lr ls lt lu b">npm run dev</code>启动应用程序，看看会发生什么！</p><p id="30fb" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们检查<code class="fe lr ls lt lu b">/</code>、<code class="fe lr ls lt lu b">/fr</code>和<code class="fe lr ls lt lu b">/es</code>，我们分别得到以下结果:</p><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/36f27df46f79bae078de5ff4476c3cb0.png" data-original-src="https://miro.medium.com/v2/0*vNC-Rq3PxdMypxIs"/></div></figure><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/49b897ed368c99cb12ef41a30894161d.png" data-original-src="https://miro.medium.com/v2/0*qKfaDqVyXKOzWSkM"/></div></figure><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/b94d2693d6a84b32d27cb972eb53effb.png" data-original-src="https://miro.medium.com/v2/0*HXtwlsilvcWTJS-3"/></div></figure><p id="6ad7" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">成功！</p><p id="4aa5" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">作为一个额外的奖励，我们可以创建一个新的文件<code class="fe lr ls lt lu b">pages/alt.js</code>并添加类似的内容，以展示其他语言环境页面如何使用我们放在语言环境文件中的<code class="fe lr ls lt lu b">/alt</code> route关键字:</p><figure class="lv lw lx ly gt ir"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="5f38" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">打算分别给我们介绍一下<code class="fe lr ls lt lu b">/fr/alt</code>和<code class="fe lr ls lt lu b">/es/alt</code>:</p><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/5e4af38298469eeb1bb390ea133eec74.png" data-original-src="https://miro.medium.com/v2/0*4N7mG5S6vjooGD8a"/></div></figure><figure class="lv lw lx ly gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/817ec55424c0f3f6cfca1444ed31ec64.png" data-original-src="https://miro.medium.com/v2/0*UhR-8DTrWqa1Sa2W"/></div></figure><p id="9cbb" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请注意，我们在这个页面上也重复使用了<code class="fe lr ls lt lu b">hello</code>键，但是由于我们设置了区域设置和<code class="fe lr ls lt lu b">pages/_app.js</code>页面，所以没有发生冲突。非常方便。我不确定这是不是最好的布局方式(可能有一些问题我还没有大规模遇到)，但对于这个演示来说，它工作得相当好。</p><blockquote class="mb mc md"><p id="d452" class="ju jv me jw b jx jy jz ka kb kc kd ke mf kg kh ki mg kk kl km mh ko kp kq kr ij bi translated">注意:如果你在终端弹出一个关于缺少多填充的错误，请参考<a class="ae ks" href="https://formatjs.io/docs/react-intl/#runtime-requirements" rel="noopener ugc nofollow" target="_blank">格式文档</a>。TL；dr就是需要节点v13+或者可以安装包。</p></blockquote><h2 id="c3fc" class="kt ku ix bd kv kw kx dn ky kz la dp lb kf lc ld le kj lf lg lh kn li lj lk ll bi translated">摘要</h2><p id="cd2a" class="pw-post-body-paragraph ju jv ix jw b jx lm jz ka kb ln kd ke kf lo kh ki kj lp kl km kn lq kp kq kr ij bi translated">总之，我们已经探索了Next.js国际化，并使用了<code class="fe lr ls lt lu b">react-intl</code>包来帮助我们的语言环境变得生动起来！</p><p id="96cd" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里看最终项目(虽然缺乏美感)<a class="ae ks" href="https://hello-nextjs-i18n.vercel.app/" rel="noopener ugc nofollow" target="_blank">这里</a><a class="ae ks" href="https://github.com/okeeffed/hello-nextjs-i18n" rel="noopener ugc nofollow" target="_blank">看最终代码</a>。</p><h2 id="dcf9" class="kt ku ix bd kv kw kx dn ky kz la dp lb kf lc ld le kj lf lg lh kn li lj lk ll bi translated">资源和进一步阅读</h2><ol class=""><li id="de0e" class="mi mj ix jw b jx lm kb ln kf mw kj mx kn my kr mn mo mp mq bi translated"><a class="ae ks" href="https://www.npmjs.com/package/react-intl" rel="noopener ugc nofollow" target="_blank">反应国际</a></li><li id="f307" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated"><a class="ae ks" href="https://nextjs.org/docs/advanced-features/i18n-routing" rel="noopener ugc nofollow" target="_blank"> Next.js 10 — i18n路由</a></li><li id="ba46" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated"><a class="ae ks" href="https://hello-nextjs-i18n.vercel.app/" rel="noopener ugc nofollow" target="_blank">竣工工程</a></li><li id="c377" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated"><a class="ae ks" href="https://github.com/okeeffed/hello-nextjs-i18n" rel="noopener ugc nofollow" target="_blank">最终代码</a></li><li id="1f98" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated"><a class="ae ks" href="https://formatjs.io/docs/react-intl/#runtime-requirements" rel="noopener ugc nofollow" target="_blank"> react-intl运行时要求</a></li><li id="b2fa" class="mi mj ix jw b jx mr kb ms kf mt kj mu kn mv kr mn mo mp mq bi translated"><a class="ae ks" href="https://www.smartling.com/" rel="noopener ugc nofollow" target="_blank">耍滑头</a></li></ol><p id="9f43" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="me">图像功劳:</em> <a class="ae ks" href="https://unsplash.com/@drewbutler" rel="noopener ugc nofollow" target="_blank"> <em class="me">安德鲁·巴特勒</em> </a></p><p id="8c41" class="pw-post-body-paragraph ju jv ix jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="me">原贴于我的</em> <a class="ae ks" href="https://blog.dennisokeeffe.com/blog/2020-11-08-nextjs-intl-with-react-intl/" rel="noopener ugc nofollow" target="_blank"> <em class="me">博客</em> </a> <em class="me">。</em></p></div></div>    
</body>
</html>