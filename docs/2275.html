<html>
<head>
<title>Is mapStateToProps causing needless re-renders?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">mapStateToPropsä¼šå¯¼è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“å—ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/is-mapstatetoprops-causing-needless-re-renders-6d14346b3cb8?source=collection_archive---------6-----------------------#2020-06-06">https://javascript.plainenglish.io/is-mapstatetoprops-causing-needless-re-renders-6d14346b3cb8?source=collection_archive---------6-----------------------#2020-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b4fbbae850a4b49e971c446b90b996c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hQKZ70wmQKEM2Jr1NZpYQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Pictured: simple redux flow between connected components ğŸ˜«</figcaption></figure><p id="a7fd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">å¦‚æœæ‚¨æ˜¯ä¸€åReactå¼€å‘äººå‘˜ï¼Œä»äº‹çš„é¡¹ç›®å¹¶ä¸ç®€å•ï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½ä¼šä½¿ç”¨Reduxè¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚ç®€å•åœ°è¯´ï¼Œä½ è¿æ¥çš„ç»„ä»¶éƒ½åœ¨ç›‘å¬åº”ç”¨ç¨‹åºçš„å…¨å±€çŠ¶æ€<code class="fe la lb lc ld b">store</code>çš„ä»»ä½•æ›´æ–°ï¼Œä½ çš„<code class="fe la lb lc ld b">mapStateToProps</code>å‡½æ•°è·å–è¿™ä¸ªçŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å°†å…¶ä½œä¸ºé“å…·è¿”å›ç»™ä½ è¿æ¥çš„ç»„ä»¶ã€‚</p><p id="767e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">æˆ‘æœ€è¿‘åœ¨å¤„ç†ä¸€ä¸ªå¥‡æ€ªçš„bugï¼Œå®ƒæ¶‰åŠä¸€ä¸ªredux-connectedç»„ä»¶:ä¸€ä¸ªç”¨æˆ·å°†é¼ æ ‡æ‚¬åœåœ¨æˆ‘ä»¬é¥¼å›¾ç»„ä»¶çš„ä¸€éƒ¨åˆ†ä¸Šï¼Œæœ‰æ—¶é¥¼å›¾ä¸­å¿ƒçš„æ ‡ç­¾ä¼šæ¢å¤åˆ°é»˜è®¤æ ‡ç­¾â€¦å—¯ã€‚å‡ºäºæŸç§åŸå› ï¼Œæˆ‘ä»¬çš„é¥¼å›¾è¢«é‡æ–°å‘ˆç°ï¼Œå³ä½¿å®ƒçš„çŠ¶æ€æ²¡æœ‰æ›´æ–°ã€‚åŒhmmmâ€¦</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi le"><img src="../Images/3cc661493f5a9b24d6e4069d5a72179a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*8FNqmQdm_bey9FJk7tmFSQ.gif"/></div></figure><p id="dc24" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">è¿™ç§é—´æ­‡æ€§çš„é”™è¯¯å¾ˆéš¾é‡ç°ï¼Œä½†ä¸€æ—¦å®ƒä¸ä½¿ç”¨å®æ—¶å¥—æ¥å­—æ›´æ–°çš„å°éƒ¨ä»¶å…±äº«å•†åº—ï¼Œæˆ‘æ³¨æ„åˆ°æ¯æ¬¡æˆ‘ä»¬çš„å•†åº—æ”¶åˆ°å®æ—¶æ›´æ–°æ—¶éƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p><p id="f044" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ç»„ä»¶åº”è¯¥åœ¨æ¯æ¬¡å­˜å‚¨æ”¶åˆ°æ›´æ–°æ—¶é‡æ–°å‘ˆç°å—â€”â€”å³ä½¿å®ƒå¯¹çŠ¶æ€çš„ç‰¹å®šéƒ¨åˆ†ä¸æ„Ÿå…´è¶£ï¼Ÿä¸ï¼Œé‚£ä¸å¯èƒ½æ˜¯å¯¹çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„<code class="fe la lb lc ld b">mapStateToProps</code>å‡½æ•°å¦‚ä½•ç†è§£ä½•æ—¶åº”è¯¥è§¦å‘é‡æ–°æ¸²æŸ“å‘¢ï¼Ÿå—¯ï¼Œåœ¨å¼•æ“ç›–ä¸‹ï¼Œreduxé€šè¿‡å®ç°<code class="fe la lb lc ld b">shouldComponentUpdate</code>æ–¹æ³•å¯¹ä»<code class="fe la lb lc ld b">mapStateToProps</code>è¿”å›çš„çŠ¶æ€åšäº†ä¸€ä¸ªç®€å•çš„æ¯”è¾ƒã€‚æœ‰æ„æ€ã€‚ä½†è¿˜æ˜¯ä¸èƒ½è§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬çš„æ´¾ä¼šå˜å¾—æ€ªå¼‚ã€‚</p><p id="aca3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">ä¸‹é¢æ˜¯æˆ‘ä»¬çš„é¥¼çŠ¶å›¾ä»£ç çš„ç®€åŒ–ç‰ˆæœ¬:</p><pre class="lf lg lh li gt lj ld lk ll aw lm bi"><span id="677d" class="ln lo iq ld b gy lp lq l lr ls">import React from 'react';<br/>import { connect } from 'react-redux';<br/><br/>import PieChartWidget from './components/PieChartWidget';<br/><br/>const mergeProps = (stateProps, dispatchProps, ownProps) =&gt; {<br/>  return {...ownProps, ...dispatchProps, ...stateProps};<br/>};<br/><br/>const mapStateToProps = (state, ownProps) =&gt; {<br/>  const data = state.widgetData;<br/>  const apiArgs = { ...ownProps.apiArgs }; //OOPS!!!!</span><span id="bdcf" class="ln lo iq ld b gy lt lq l lr ls">  return {<br/>    data,<br/>    apiArgs<br/>  };<br/>};<br/><br/>const IssuesPieChart = ({<br/>  apiArgs,<br/>  data,<br/>}) =&gt; (<br/>  &lt;DataLoader<br/>    apiArgs={apiArgs}<br/>    {...others}<br/>  &gt;<br/>    &lt;PieChartWidget<br/>      data={data}<br/>    /&gt;<br/>  &lt;/Widget&gt;<br/>);<br/><br/>export default connect(mapStateToProps, mapWidgetDispatchToProps, mergeProps)(IssuesPieChart);</span></pre><p id="760b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬åœ¨<code class="fe la lb lc ld b">mapStateToProps</code>å‡½æ•°ä¸­çŠ¯äº†ä¸€ä¸ªè¯šå®çš„é”™è¯¯ï¼Œä½¿ç”¨spread <code class="fe la lb lc ld b">...</code>æ“ä½œç¬¦å¤åˆ¶çŠ¶æ€ã€‚å“¦ã€‚åƒ<code class="fe la lb lc ld b">slice, concat, filter</code>æˆ–<code class="fe la lb lc ld b">...</code>è¿™æ ·çš„å¸¸è§æ•°ç»„æ“ä½œåˆ›å»ºä¸€ä¸ªå¯¹å¯¹è±¡æˆ–æ•°ç»„çš„æ–°å¼•ç”¨ï¼Œå½“reduxåœ¨å†…éƒ¨æ¯”è¾ƒæ–°æ—§çŠ¶æ€æ—¶ï¼Œå®ƒå°†è§¦å‘ç»„ä»¶æ›´æ–°ã€‚</p><p id="ae9c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">è¿™é‡Œçš„å¿«é€Ÿè§£å†³æ–¹æ³•æ˜¯ç®€å•åœ°åƒè¿™æ ·åˆ†é…æˆ‘ä»¬çš„çŠ¶æ€:</p><pre class="lf lg lh li gt lj ld lk ll aw lm bi"><span id="069a" class="ln lo iq ld b gy lp lq l lr ls">const mapStateToProps = (state, ownProps) =&gt; {<br/>  const data = state.widgetData;<br/>  const apiArgs = ownProps.apiArgs;</span><span id="983d" class="ln lo iq ld b gy lt lq l lr ls"> return {<br/>    data,<br/>    apiArgs<br/>  };<br/>};</span></pre><p id="6f3f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">å¦‚æœæ‚¨çš„ç”¨ä¾‹æ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸”å¯¹æ‚¨å…³å¿ƒçš„çŠ¶æ€æ ‘çš„ä¸€éƒ¨åˆ†è¿›è¡Œäº†ä¸€äº›è¿‡æ»¤æˆ–é€‰æ‹©ï¼Œæ‚¨å¯èƒ½æƒ³è¦æ£€æŸ¥å†…å­˜åŒ–çš„é€‰æ‹©å™¨å‡½æ•°ï¼Œä»¥é¿å…æ˜‚è´µçš„æ¯”è¾ƒå’Œä¸å¿…è¦çš„é‡æ–°å‘ˆç°:<a class="ae lu" href="https://redux.js.org/recipes/computing-derived-data#creating-a-memoized-selector" rel="noopener ugc nofollow" target="_blank">https://redux . js . org/recipes/computing-derived-data # creating-a-memo ized-selector</a></p><h2 id="21ae" class="ln lo iq bd lv lw lx dn ly lz ma dp mb kn mc md me kr mf mg mh kv mi mj mk ml bi translated"><strong class="ak">ç®€å•è‹±è¯­çš„JavaScript</strong></h2><p id="87c6" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿå¦‚æœæœ‰ï¼Œé€šè¿‡<a class="ae lu" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir">è®¢é˜…æˆ‘ä»¬çš„YouTubeé¢‘é“</strong> </a> <strong class="ke ir">è·å–æ›´å¤šç±»ä¼¼å†…å®¹ï¼</strong></p></div></div>    
</body>
</html>