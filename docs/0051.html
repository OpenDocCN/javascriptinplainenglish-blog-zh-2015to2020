<html>
<head>
<title>Architectural Concerns of the Page Object in Automated Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化测试中页面对象的架构关注点</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-architectural-concerns-of-the-page-object-in-automated-testing-fea93de2430c?source=collection_archive---------7-----------------------#2018-11-19">https://javascript.plainenglish.io/the-architectural-concerns-of-the-page-object-in-automated-testing-fea93de2430c?source=collection_archive---------7-----------------------#2018-11-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="3fa9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">几个月前，我从一名开发人员变成了我正在从事的项目的测试人员。</p><p id="889d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在团队中，测试人员正在编写自动化套件以及手动测试回归，尽管后者更经常发生，因为应用程序中的更改比自动化中的更改更快。</p><p id="8c5f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在加入团队时，我的第一个角色是为自动化套件添加测试用例，以应对其中的一些变化，但在这样做的过程中，我发现套件难以跟上的原因有以下几个:</p><ul class=""><li id="5b3f" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">团队中没有人关注自动化套件的健康状况，它很久以前就已经变红了，但是更多的测试案例正在其上构建</li><li id="7e3a" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">自动化套件很难维护和保持绿色，因为代码是使用页面对象模型模式构建的，但没有清晰的架构规则来支持它</li><li id="dce8" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">没有正式的分支、合并和代码审查过程</li><li id="f15c" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">由于自动化套件的可维护性问题，没有一个开发人员愿意负责确保他们在更改应用程序的部分时进行更新</li></ul><p id="933c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在花了几年时间向我所在的团队灌输代码质量之后，我决定在测试团队内部召开一次会议，一起解决这些问题。</p><p id="6d1d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最初的会议产生了三个要点:</p><ol class=""><li id="e72b" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kw ko kp kq bi translated">为了重新获得应用健康状况的可见性，我们将关注一个较小的测试集，我们将保持绿色，并随着时间的推移重构失败的测试</li><li id="75f1" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kw ko kp kq bi translated">迫切需要对自动化套件进行重构</li><li id="32a4" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kw ko kp kq bi translated">关于在我们的ide中运行Cucumber场景或者只是测试失败，正在使用的自动化框架没有给我们带来我们所希望的灵活性</li></ol><p id="b904" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这些行动中，我们首先处理了第1点和第2点。通过在完成第2点的同时制定清晰的架构规则，我们可以更容易地转换到不同的框架(第3点)。</p><h1 id="9b24" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">明确的关注</h1><p id="0b5e" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">为了重构我向团队建议的代码，我们将代码(遵循WDIO教程中的页面对象模型模式)分解成具有各自关注点的更小的对象:</p><p id="0820" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">选择器对象</strong></p><ul class=""><li id="3949" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">关注访问不同组件的web元素所需的选择器</li><li id="37b1" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">选择器字符串将被抽象成函数。这允许对不同的选择器进行更多的语义命名，也允许我们将仅由一个索引选择器改变的多个选择器(例如<em class="mb">第n个孩子</em>)合并到一个具有索引参数的函数中</li></ul><p id="92e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">组件对象</strong></p><ul class=""><li id="9d4b" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">关注页面上的组件。不同的页面可能使用相同的组件</li><li id="9b1d" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">是唯一使用选择器获取web元素的点。这可以防止页面对象在访问元素时绕过组件</li><li id="9c15" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">任何web元素和web元素属性的getters和setters都将被抽象成函数。这允许对不同的操作进行更多的语义命名，并允许容易地改变内部实现</li></ul><p id="a10a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">页面对象</strong></p><ul class=""><li id="b3f9" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">关注与组成页面的不同组件的交互，在页面对象中没有对页面元素的直接调用</li><li id="7af2" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">复杂的动作被抽象成导致幂等运算的函数。例如，无论调用时登录表单是否打开，登录功能仍然会让您登录。</li></ul><p id="f83c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">步骤定义</strong></p><ul class=""><li id="0582" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">关注不同页面对象上的调用操作，以完成Gherkin步骤中定义的任务</li></ul><p id="e588" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这给了我们一个清晰的分工，并允许进行更有建设性的代码审查。</p><p id="f364" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这也允许将页面对象模型代码分解到它自己的库中，该库可以在自动化套件的代码库之外开发，在这一点上，它变成了各种步骤定义文件的迷宫，其中有不同的实现。</p><p id="cffb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的下一次冲刺中，我被分配了一些时间来做一个快速的尖峰来证明这个想法，它真的很好，所以我们决定继续下去，重构代码库。</p><p id="b9b7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">重构过程中的主要障碍是:</p><ul class=""><li id="db2b" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">什么被认为是组件，不同组件的边界是什么。这主要是因为围绕现有代码库的不同实现相互矛盾</li><li id="95fa" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">团队成员又回到了旧习惯，尽管这些已经通过代码审查解决了</li></ul><h1 id="3d72" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">变化是不可避免的</h1><p id="f996" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">一旦我们重构了自动化套件，项目的焦点就从集成一套系统转移到一套全新的系统。</p><p id="beba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">系统的这种变化意味着自动化套件中一半的代码在一夜之间变得多余。这被认为是从WebdriverIO迁移并使用CucumberJS和WebdriverJS的一个好借口。</p><p id="a3d8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">由于我们已经布置了清晰的架构边界，这个移植变得更加容易，因为我们可以重用页面对象，并且大多数组件对象不需要改变(除了从WebdriverIO和WebdriverJS语法的差异中转移)，大部分工作发生在新UI具有不同结构的选择器对象中。</p><p id="f4ca" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">几周后，我们决定扩展新的基于WebdriverJS的套件，以支持旧的WebdriverIO套件中的旧功能。</p><p id="c057" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在页面对象中包含两组不同的组件最初被认为是一个很难解决的问题，直到我们进行了一次快速的团队聊天，并意识到我们可以利用页面对象的构造函数上的策略模式在运行时分配相关的组件对象，这并没有打破原来的架构界限。</p><h1 id="a983" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">成果和经验教训</h1><p id="37cc" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">后退一步，思考每个步骤定义&amp;页面/组件/选择器对象，确保这些架构边界没有被严格的代码审查所跨越，并且对团队非常积极。</p><p id="813d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">像大多数变化一样，最初会有一点点倒退，团队成员只是做他们一直在做的事情，但是有了一致同意的方法，并且每个人都在坚持这种方法时保持一致，这些行为变化得足够快。</p><p id="a4c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">自从我们采用架构变化以来，我们至少已经看到了三次这些变化的好处，我相信它们还会再次出现。</p><p id="47d1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">从这次重构中吸取的经验教训:</p><ul class=""><li id="4888" class="ki kj in jm b jn jo jr js jv kk jz kl kd km kh kn ko kp kq bi translated">总是有足够的时间后退一步，解决阻碍团队发挥最佳水平的问题</li><li id="de75" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">团队应该像对待生产代码一样对待任何代码、测试或其他东西</li><li id="2073" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">有些人会退缩，因为他们看不到新方法的好处，但这可能只是因为他们在获得经验之前看不到这一点，一旦他们以自己的方式理解了规则，他们就会看到这些好处</li><li id="ac8b" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">倾听团队的意见，一起采取新的方法</li><li id="ca59" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">在快速变化的环境中，松散耦合是关键</li><li id="be03" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">作为一名测试人员，你不仅仅是自动化测试来使你的工作更容易。您这样做是为了确保您团队的所有成员从这些测试给出的反馈中获得价值</li><li id="5a57" class="ki kj in jm b jn kr jr ks jv kt jz ku kd kv kh kn ko kp kq bi translated">WebdriverIO从最终用户那里抽象出了很多基于承诺的操作，这也是我喜欢它的原因，但是Cucumber runner需要很多改进，以使测试人员更容易从中获得更多好处。</li></ul><h2 id="9eab" class="mc kz in bd la md me dn le mf mg dp li jv mh mi lm jz mj mk lq kd ml mm lu mn bi translated"><strong class="ak">简明英语团队的一份说明</strong></h2><p id="fc80" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">你知道我们有四种出版物吗？给他们一个关注来表达爱意:<a class="ae kx" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="jm io">JavaScript in Plain English</strong></a><a class="ae kx" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="jm io">AI in Plain English</strong></a><a class="ae kx" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="jm io">UX in Plain English</strong></a><a class="ae kx" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="jm io">Python in Plain English</strong></a><strong class="jm io"/>——谢谢，继续学习！</p><p id="0e3f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此外，我们总是有兴趣帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kx" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">submissions @ plain English . io</strong></a><strong class="jm io"/>，附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mo"><img src="../Images/a47b7fd6f776ed19075b836a0ffb65c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KP-npiUUiu6m9if2.jpg"/></div></div></figure></div></div>    
</body>
</html>