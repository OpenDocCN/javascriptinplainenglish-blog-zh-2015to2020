<html>
<head>
<title>Querying SQL Server with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js查询SQL Server</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/querying-sql-server-with-node-js-4197361c0fb1?source=collection_archive---------0-----------------------#2019-11-10">https://javascript.plainenglish.io/querying-sql-server-with-node-js-4197361c0fb1?source=collection_archive---------0-----------------------#2019-11-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9dc1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">添加节点Web服务器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4f8d85c656cd5b969e5f0d52e367afc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DjFzq_JcSPviXP4u5b60Vw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by fabio on <a class="ae kv" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="d5b2" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">我们正在做什么</h2><p id="93bf" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">我们把我在<a class="ae kv" href="https://link.medium.com/w1Y4GMvCh1" rel="noopener">之前的文章</a>中所做的工作提升了一个档次。在那篇文章中，我们用node.js查询了一个SQL Server数据库</p><p id="d29f" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi mq translated"><span class="l mr ms mt bm mu mv mw mx my di"> N </span>现在我们想添加一个节点web服务器，这样我们可以将数据发送到节点Web服务器，在数据库查询中使用它，并将结果返回到网页。</p><p id="f95a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">这将是一个“基本原则”练习(你以后会明白的。)</p><h2 id="3afe" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">我们想要完成的目标</strong></h2><ul class=""><li id="d09f" class="mz na iq lu b lv lw ly lz lf nb lj nc ln nd mk ne nf ng nh bi translated">创建一个节点Web服务器。</li><li id="88a3" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">发布网页上的数据，以便在我们的SQL Server数据库查询中使用。</li><li id="6d7b" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">将结果发送回网页。</li></ul><blockquote class="nn"><p id="e625" class="no np iq bd nq nr ns nt nu nv nw mk dk translated">全圈(基本全栈。)一旦你能做到这一点。你可以做任何事。</p><p id="32cf" class="no np iq bd nq nr nx ny nz oa ob mk dk translated">它开始让Vue、React和Angular之类的东西变得更有意义。</p></blockquote><h2 id="e29b" class="kw kx iq bd ky kz oc dn lb lc od dp le lf oe lh li lj of ll lm ln og lp lq lr bi translated">我们将使用什么</h2><p id="b574" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">除了现有的节点包和模块，我们只需要新的。</p><ul class=""><li id="6fbf" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">express——一个流行的web框架</li><li id="e43d" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">主体解析器——帮助从网页中获取表单数据。</li></ul><p id="5ed0" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">除此之外，我们将尽可能保持简单(普通)的JavaScript(基本原则)。</p><p id="fbf8" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">为什么要用普通的JavaScript呢？因为从“基本原则”看事情是如何完成的，这不仅让我们对其他模块、框架和库(React、Vue等)更加欣赏。)但也可能让我们意识到，“嘿，我真的不需要那些。”</p><p id="1842" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们可能最终想要React或Vue的能力，但如果我们不需要，为什么要背负这个重量呢？</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="c49b" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">没有必要先阅读<a class="ae kv" href="https://link.medium.com/w1Y4GMvCh1" rel="noopener">之前的文章</a>，因为我将检查我们需要的核心内容，但这可能是有益的。</p><blockquote class="or os ot"><p id="ac9e" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">如果没有别的，你可能想看看我的数据库设置。你可以完全不同，但我有免费下载一些有用工具的链接，如果你没有SQL Server的话。</p></blockquote></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h2 id="fc64" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">我们开始吧</h2><p id="033e" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">我假设你已经安装了node.js，如果没有，可以在这里下载。</p><p id="2c2c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们将从设置node.js Web服务器并测试它开始。然后像前面一样添加类似的代码来连接和查询我们的SQL Server数据库。</p><p id="b8e3" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们将使用node.js 、<a class="ae kv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank">、<strong class="lu ir"> Express </strong>、</a>的<strong class="lu ir">极简Web服务器框架。它作为<strong class="lu ir"> npm包</strong>安装。</strong></p><p id="bb73" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">正如许多事情一样，总有更多的东西需要学习，所以当我让你输入一个命令时，一定要多读一些关于这个命令及其选项的内容。</p><h2 id="d5b5" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">准备就绪</strong></h2><ol class=""><li id="afee" class="mz na iq lu b lv lw ly lz lf nb lj nc ln nd mk oy nf ng nh bi translated">对于项目，创建一个目录/文件夹。</li><li id="2bbd" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk oy nf ng nh bi translated">打开Visual Studio代码(VSCode)并打开文件夹。</li><li id="569b" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk oy nf ng nh bi translated">打开一个新的终端窗口，输入<br/> <code class="fe oz pa pb pc b">npm init</code> <br/>接受默认设置来创建你的<a class="ae kv" href="https://docs.npmjs.com/files/package.json" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> package.json </strong> </a>。</li></ol><p id="2601" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">4.在VSCode中创建一个文件，并将其保存为index.js。如果查看package.json文件，您会发现可以在哪里更改默认的“main”文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/28a330cc5842b69b3e9e8a9ffba3b03d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*I7t-JsVCY67ZyiNOLbTPqQ.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Basic starting point</figcaption></figure><p id="b60b" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">5.在终端窗口中键入<br/> <code class="fe oz pa pb pc b">start npm<br/></code>这将启动node.js服务器。</p><h2 id="fb3c" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">网络服务器</h2><p id="ca7a" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在终端窗口中键入<br/>、<code class="fe oz pa pb pc b">npm install express</code></p><p id="d1cf" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">这将安装Web框架。</p><p id="3597" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">我们准备好摇滚了！</strong></p><p id="af21" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">Web服务器的核心是<strong class="lu ir">请求</strong>express包并将其分配给持有者(变量或常量。)所有对Web服务器的引用都将通过此持有者。</p><p id="4ff4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们必须启动web服务器，并让它监听HTTP端口，我将选择5000。8080很常见，只是可用的东西。</p><p id="bbd0" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们希望Web服务器至少能够响应HTTP get方法。这将允许使用“踢轮胎”，并确保它的工作。MDN上的HTTP方法<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" rel="noopener ugc nofollow" target="_blank">中有更多内容。我们将使用GET和POST。</a></p><ul class=""><li id="332a" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">GET用于从资源中检索。</li><li id="1540" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">POST用于提交给资源。</li></ul><p id="e2d4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">输入下面的代码，我们来讨论一下。</p><h2 id="b309" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">Web服务器示例</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/0e066814ddfe8a8febaf7c15ad2da70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*opz5zu-dHsONvBWFXF6YtQ.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The core set up.</figcaption></figure><ul class=""><li id="d2ee" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">我们<strong class="lu ir">需要</strong>express包，按照惯例将引用存储在<em class="ou"> express </em>中，但是根据需要命名。</li><li id="aadc" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated"><strong class="lu ir">初始化</strong>express的一个实例，按照惯例将引用存储在<em class="ou"> app </em>中，但是根据需要命名。</li><li id="150c" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">在第11行，我们存储了一个引用，指向我们的web服务器将要监听的位置。端口5000。</li><li id="d52b" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">在第5行中，我们通过使用<strong class="lu ir"> app.get </strong>来使用web服务器的HTTP GET with out实例。默认情况下，这将从根目录('/')获取数据。回调函数非常重要，因为它包含了<strong class="lu ir">请求</strong> ( <strong class="lu ir"> req </strong>)和<strong class="lu ir">响应</strong> ( <strong class="lu ir"> res </strong>)对象。名称req和res是约定俗成的。</li></ul><h2 id="ee5d" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">请求和响应</h2><ul class=""><li id="51ee" class="mz na iq lu b lv lw ly lz lf nb lj nc ln nd mk ne nf ng nh bi translated"><strong class="lu ir">请求</strong>将来自我们浏览器的url。更多信息可在<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Request" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</li><li id="0106" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated"><strong class="lu ir">响应</strong>是对请求的响应。更多可以在这里找到<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><blockquote class="or os ot"><p id="25d2" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">简而言之，我们的浏览器将发出请求，我们将发回响应。</p></blockquote><p id="e3d9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir"> <em class="ou">旁注</em> </strong> <em class="ou">:我其实更喜欢上面第5行和第11行的ES6语法。我的意思是，我更喜欢箭头函数。例如，在第5行中，我通常不写</em> <strong class="lu ir"> <em class="ou"> app.get('/')，function(res，resp) </em> </strong> <em class="ou"> {…而是写</em> <strong class="lu ir"> <em class="ou"> app.get('/')，(res，resp)= &gt; {… </em> </strong> <em class="ou">，而不是第11行中的</em> <strong class="lu ir"> <em class="ou"> app.listen(5000，function() </em> </strong> <em class="ou"/></p><p id="5f47" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">踢轮胎</strong></p><ol class=""><li id="ba5d" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk oy nf ng nh bi translated">在VSCode中，在“调试”菜单中按F5(启动调试的缩写。)您的控制台应该如下所示。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/61273113f7eba842ee0e9ce4aed449b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*H5rMqmdbH9mGB3Sgra2hwA.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Look for the console message. The top has controls for stopping/refreshing, etc.</figcaption></figure><p id="96aa" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">2.在浏览器中输入LocalHost:5000，然后按回车键。您应该看到以下内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/8df1553650918edbe56d0524d01321f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*-LfXnGXG_jhKA6vAKVIHAA.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Yay!</figcaption></figure><blockquote class="or os ot"><p id="5971" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">您的浏览器发出了一个GET请求，我们使用<strong class="lu ir"> res.send </strong>发回了一个响应。</p></blockquote><h2 id="d883" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">节点SQL Server连接</h2><p id="f653" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">(如果之前已完成，则为可选。)在终端窗口中，键入<br/> <code class="fe oz pa pb pc b">npm install mssql</code> <strong class="lu ir"> <br/> </strong>这将安装SQL Server驱动程序。</p><h2 id="3a40" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">数据库示例</h2><p id="e0bc" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">这是与我的前一篇文章完全相同的<em class="ou">起始代码</em>，所以我不会详细讨论它。然而，它在<strong class="lu ir">应用程序</strong>对象中的位置很重要。</p><p id="63bd" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">有几件事情需要注意，在我们的初始测试之后<strong class="lu ir">将会与之前有所不同，</strong></p><ul class=""><li id="f925" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">我们员工的绩效评级将通过网页发送(张贴。)</li><li id="e78c" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">使用Response将查询的结果输出到网页。</li></ul><h2 id="a40d" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">数据库连接/查询示例</h2><p id="5699" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在下面输入代码。</p><blockquote class="or os ot"><p id="25a6" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">值得注意的是，我们有一个Web服务器和一个数据库连接和查询。<strong class="lu ir">但它们并不相互作用。还没！</strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/e95dde5bfc1870bd883af6d39bbdf5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FSS15KRhkn2Fvor2QhkxAg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Disconnected Web Server and Database Connection</figcaption></figure><p id="0370" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">通过停止并启动web服务器或刷新来运行它</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/bb72f73944b594162415df477ad886bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*Y0f9lzlEiTocM4UQddAO0g.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Refesh/Stop and other options</figcaption></figure><p id="107c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">您将看到web服务器正在运行，并且有来自查询的数据的控制台输出。但是我们没有从web服务器获得任何东西，也没有向网页发送任何东西。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/c9bf37ba356c8679f6d81cf5355a375e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*CAJUL966AeFmGe_tee75pw.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Our web server note and Database Query Output</figcaption></figure><h2 id="5d24" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">HTML</h2><p id="1f58" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">当用户访问我们的网站时，我们需要提供一个页面。该页面将允许他们发送可在数据库查询中使用的参数(PerformanceRating)。</p><blockquote class="or os ot"><p id="e38e" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">注意:我不会关心我们网页的样式。这将是简单而中肯的。</p><p id="9e61" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">我们也保存了根目录中的所有内容。最佳实践？不会吧！但是我们追求功能性。清理工作可以稍后进行。</p></blockquote><ol class=""><li id="5ad1" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk oy nf ng nh bi translated">创建以下网页，命名为<strong class="lu ir">index.html</strong>和<strong class="lu ir">Employees.html</strong>。</li></ol><ul class=""><li id="4d9d" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">index.html将是我们的主要来源页面。</li><li id="b3d0" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">Employees.html将是我们结果的终点。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/12de135f8b7d83ec4fc3d1ff91811643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*bjveDIjgfvFLlL9U7eWK1g.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Simple startup page, index.html</figcaption></figure><p id="f793" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">注意<form action="”/Employees…&lt;br/"> <strong class="lu ir">这是我们的输出要去的地方。</strong></form></p><p id="da48" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">将以下内容添加到Employees.html</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/60e99d56e1d64053ae17e6cf27bb0bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*QzUSUju2ZCDuZgf_-q9TPQ.jpeg"/></div></figure><p id="bb22" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">2.下一步需要几样东西。其中之一就是我选择如何为index.html服务。你阅读的其他来源可能会进入<a class="ae kv" href="https://expressjs.com/en/guide/routing.html" rel="noopener ugc nofollow" target="_blank">路线</a>。路由是一个非常重要的领域，但是超出了我们的范围。我们的方式只是众多方式中的一种。我们代码中的新内容将是，</p><ul class=""><li id="3c09" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated"><a class="ae kv" href="https://nodejs.org/api/path.html" rel="noopener ugc nofollow" target="_blank"> path </a> —这将帮助我们使用res.sendFile在访问者访问我们的网站时提供我们想要的文件。</li><li id="0a67" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated"><a class="ae kv" href="https://medium.com/@adamzerner/how-bodyparser-works-247897a93b90" rel="noopener"> bodyParser </a> —发布完成后使表单数据可用</li><li id="0a13" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated"><a class="ae kv" href="https://scotch.io/tutorials/use-expressjs-to-deliver-html-files" rel="noopener ugc nofollow" target="_blank">发送文件</a> —允许您提供所需的默认页面。</li></ul><p id="94c3" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">对您的代码进行以下更改，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/bb62aac3d66368f843f77ae553aeace3.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*aSJ3qyfh9xKs0NNYL-wSsQ.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">path, bodyParser and sendFile</figcaption></figure><p id="9d9b" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">通过停止并启动web服务器或刷新来运行它。在您的浏览器中，刷新浏览器后，您应该会看到，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/8db8abcacffd51c57bd8e53da6da7106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*NilKJaW9UMlKBq4Gw_RvGA.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">index.html served up by default</figcaption></figure><h2 id="5db7" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">在查询中使用HTML表单数据</h2><p id="6773" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">为此，我们需要添加一个<strong class="lu ir"> app.post </strong>。这将从事任何我们希望当index.html从网页上公布。</p><p id="b5f6" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">这是重要的一步。</strong>我们的数据库连接和查询需要在app.post回调函数里面。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi po"><img src="../Images/0cdd395d994fb2c7770169b7d3d4c687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kb-11CCUQdXZXvFeXPcrOg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Note how our Database components go in the app.get</figcaption></figure><ul class=""><li id="11c9" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">第13行启动app.post。回调的主体是我们的数据库组件。</li><li id="281a" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">第52行关闭app.post。</li></ul><p id="8887" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们可以用不同的方式构建这一切吗，是的。我这样做是为了给我们一个可行的基础。然后我们/你可以探索其他选择</p><h2 id="4f6a" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">使用表单数据</h2><p id="21b4" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">使用表单数据将会很容易。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pp"><img src="../Images/13c7414cf9ac4da4e89ef2d7e3cc9fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqt3FSgS9G_O-ZDY-NSR7w.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Lines 35, 37, 50 and 55</figcaption></figure><ul class=""><li id="c7c0" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">第35行，<strong class="lu ir">从选择元素</strong>中获取表单数据。bodyParser 正在帮助我们。<em class="ou">请求体元素名</em></li><li id="5d6a" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">第37行，查询，<strong class="lu ir">使用表单</strong>中的值。</li><li id="9406" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">50号线正在向Employees.html发送<strong class="lu ir">原始</strong>查询数据。</li></ul><p id="4ef2" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">通过停止并启动web服务器或刷新来运行它。</p><ol class=""><li id="4c28" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk oy nf ng nh bi translated">转到您的网页并刷新。</li></ol><p id="a2ad" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">2.从评分下拉列表中选择“平均”,然后单击“获取结果”</p><p id="5b76" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">3.你应该在Employees.html得到输出。不吸引人，但这是个开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/695a9872ebc50077f23590f0c81da271.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*GzYlv1xrV7fXvpGx_83LOg.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Json output from res.send</figcaption></figure><blockquote class="nn"><p id="f675" class="no np iq bd nq nr ns nt nu nv nw mk dk translated">我们现在有了一个从前端到后端再到前端的连接。这是一件大事。</p></blockquote><h2 id="37f4" class="kw kx iq bd ky kz oc dn lb lc od dp le lf oe lh li lj of ll lm ln og lp lq lr bi translated">最后一步—清理输出(一点点。)</h2><p id="2fe4" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">这是最容易也是最难的部分。最难是因为有太多的选择。我们将从最基本的开始，这样我们就能一瞥内心深处正在发生的事情。</p><p id="c04a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">这是一个你想要更详细地探索的领域。不仅仅是附加的方法<strong class="lu ir"> res </strong>，而是一个<a class="ae kv" href="https://colorlib.com/wp/top-templating-engines-for-javascript/" rel="noopener ugc nofollow" target="_blank">“视图引擎”</a>的想法。</p><blockquote class="or os ot"><p id="1b40" class="ls lt ou lu b lv ml jr lx ly mm ju ma ov mn mc md ow mo mf mg ox mp mi mj mk ij bi translated">我将在以后的文章中探讨其中的一些。尤其是我的最爱之一，<a class="ae kv" href="https://www.npmjs.com/package/express-handlebars" rel="noopener ugc nofollow" target="_blank">特快车把</a>。</p></blockquote><p id="da8c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">现在，我们将<strong class="lu ir">构造我们的输出</strong>。是的。我们自己建造。用代码建立一个数据表，然后发送出去！只需遍历我们的data.recordset并构建。</p><p id="67d6" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">请参见以下内容</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pq"><img src="../Images/b8b4ac4fc6ed1e8bcf28ca20c9527b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mOwu6RcSYerFE9Y_DRtGHQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Building our output</figcaption></figure><p id="2bc6" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">您将需要添加第50–57行。</p><p id="8fd0" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">查询“Average”时，输出如下</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/f3d299a0b041fc6e56e4670401a5d693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*89qAS2GiP-yuxOYFPqn9vw.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Built by us with code.</figcaption></figure><h2 id="585c" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">下一步做什么(是你)</h2><p id="b628" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">玩弄它，增加更多，改变结构。从基础做起，逐步提高。</p><h1 id="a294" class="ps kx iq bd ky pt pu pv lb pw px py le jw pz jx li jz qa ka lm kc qb kd lq qc bi translated">结论</h1><p id="c3b0" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">我们正在使用基本原则来帮助我们理解JavaScript模板、框架和库这些天来添加的一些层背后发生了什么。</p><p id="e965" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们自己构建了一个全栈系统。是的，信不信由你，我们有。</p><p id="cc1e" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">什么最需要工作，输出。但是这整个练习打开了一个探索和机会的世界。所以我们想扩展概念，</p><ul class=""><li id="1e13" class="mz na iq lu b lv ml ly mm lf oh lj oi ln oj mk ne nf ng nh bi translated">更多CRUD操作</li><li id="b788" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">按指定路线发送</li><li id="c889" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">查看引擎/模板</li></ul><p id="fa08" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">感谢您参与此次旅程，我们将探索更多内容。</p><p id="86e8" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">你也可以享受，</p><div class="qd qe gp gr qf qg"><a href="https://medium.com/javascript-in-plain-english/querying-sql-server-in-node-js-using-async-await-5cb68acf2144" rel="noopener follow" target="_blank"><div class="qh ab fo"><div class="qi ab qj cl cj qk"><h2 class="bd ir gy z fp ql fr fs qm fu fw ip bi translated">使用Async/Await在Node.js中查询SQL Server</h2><div class="qn l"><h3 class="bd b gy z fp ql fr fs qm fu fw dk translated">一种更简洁的数据库查询方式</h3></div><div class="qo l"><p class="bd b dl z fp ql fr fs qm fu fw dk translated">medium.com</p></div></div><div class="qp l"><div class="qq l qr qs qt qp qu kp qg"/></div></div></a></div></div></div>    
</body>
</html>