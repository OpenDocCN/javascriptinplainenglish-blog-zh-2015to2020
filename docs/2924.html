<html>
<head>
<title>JavaScript Best Practices — Performance Improvements</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—性能改进</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-performance-improvements-797dbed72a99?source=collection_archive---------5-----------------------#2020-08-06">https://javascript.plainenglish.io/javascript-best-practices-performance-improvements-797dbed72a99?source=collection_archive---------5-----------------------#2020-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b1cc8746f3988dae9f3ea5c90c3cdd5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CPVjzlYJPlSsthEA"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@annapelzer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Anna Pelzer</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ba31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些在编写JavaScript代码时应该遵循的最佳实践。</p><h1 id="8dbe" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过度优化</h1><p id="9cf7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该过度优化我们的代码。</p><p id="ea3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果没有明显的性能问题，那么我们可以不去管它。</p><p id="5f67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果它使我们的代码更难运行，我们就不应该做改变。</p><h1 id="d941" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">导致过多的文档重排</h1><p id="83d3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">DOM修改很慢，因为我们的浏览器必须重新构建DOM树并重新计算所有维度，以查看它们是如何组合在一起的。</p><p id="77e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果元素有默认的静态定位或相对定位，问题就更大了。</p><p id="2c76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们应该尽量减少对DOM的修改。</p><p id="5781" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了减少操作，我们应该批处理我们的DOM操作。</p><p id="1fe6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="19d4" class="mn lc iq mj b gy mo mp l mq mr">let div = $('&lt;div&gt;&lt;/div&gt;');</span><span id="6e74" class="mn lc iq mj b gy ms mp l mq mr">$('body').append(div);</span><span id="84fb" class="mn lc iq mj b gy ms mp l mq mr">for (let i = 0; i &lt; 10000; i++) {<br/>  $('div').append(<br/>    '&lt;p&gt;foo&lt;/p&gt;'<br/>  );<br/>}</span></pre><p id="9326" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe mt mu mv mj b">p</code>元素添加到div中1000次。</p><p id="fd55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这显然会非常慢。</p><p id="25ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相反，我们应该只调用身体上的<code class="fe mt mu mv mj b">append</code>一次:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1eaa" class="mn lc iq mj b gy mo mp l mq mr">let div = $('&lt;div&gt;&lt;/div&gt;');</span><span id="55ad" class="mn lc iq mj b gy ms mp l mq mr">for (let i = 0; i &lt; 10000; i++) {<br/>  $('div').append(<br/>    '&lt;p&gt;foo&lt;/p&gt;'<br/>  );<br/>}</span><span id="35fa" class="mn lc iq mj b gy ms mp l mq mr">$('body').append(div);</span></pre><p id="8341" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们调用<code class="fe mt mu mv mj b">append</code>将<code class="fe mt mu mv mj b">p</code>元素添加到div中，它还不在DOM中。</p><p id="d6c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们不会改变DOM 10000次。</p><p id="1c23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">唯一的变化是最后一行，我们将div附加到主体。</p><h1 id="ca46" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过度使用文件连接</h1><p id="41d3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该把所有的东西串联成一个大文件。</p><p id="fbea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个大的请求可能比多个小的请求要慢。</p><p id="9448" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为一旦对资源发出请求，它将被缓存，直到再次更新。</p><p id="de02" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拥有多个较小的文件可以利用这一点。</p><p id="5e97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一个大文件，那么我们就不能利用缓存。</p><p id="13b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">组合代码的最佳方式是拥有一个在任何地方都可以使用的公共文件。</p><p id="cf48" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们有特定于页面的文件，这些文件只在请求的页面上使用。</p><h1 id="a7c0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">非常长的函数链</h1><p id="43d3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">函数链可能很方便。</p><p id="8920" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但我们应该意识到，我们可能会在链的中间返回<code class="fe mt mu mv mj b">null</code>或<code class="fe mt mu mv mj b">undefined</code>。</p><p id="6339" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a444" class="mn lc iq mj b gy mo mp l mq mr">$('.el').click(handleClick).parents('.container')[0].slideDown();</span></pre><p id="9a60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么这些方法中的任何一个都可能返回这些值，导致我们的应用程序崩溃。</p><h1 id="9a17" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">由于晚加载JavaScript，未样式化的内容(FOUC)闪烁</h1><p id="cebc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在展示正确的设计之前，我们可能会在短时间内看到不确定的内容。</p><p id="ae5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">改善这种情况的最好方法是减少初始加载时的DOM操作量。</p><p id="3814" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们应该在HTML而不是JavaScript中指定页面的高度和宽度，这样我们就不必等待JavaScript加载来设置它们。</p><p id="adf2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一种处理方法是用CSS或JavaScript动画掩盖问题。</p><p id="1525" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以阻止呈现，直到页面上的所有内容都加载完毕。</p><p id="7acd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">违规的JavaScript可以被内联并放在受影响的DOM元素下面。</p><p id="bde6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，当加载元素时，代码会立即加载。</p><p id="a478" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，这很难维护，应该谨慎使用。</p><p id="6d00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="913d" class="mn lc iq mj b gy mo mp l mq mr">&lt;div class="fouc-element"&gt;<br/>  &lt;script&gt;<br/>    // ...<br/>  &lt;/script&gt;<br/>  ...<br/>&lt;/div&gt;</span></pre><p id="16c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了做到这一点。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/ae2c29b5cf55a7984febcc91aca523bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9XbqpjoZdTxHNex_"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@phaelnogueira?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Raphael Nogueira</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="6596" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="6547" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过各种优化来提高性能。</p><h2 id="c01b" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript</strong></h2><p id="a05a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>