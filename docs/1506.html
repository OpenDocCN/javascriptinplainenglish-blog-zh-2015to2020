<html>
<head>
<title>Learn how Asynchronous and Synchronous methods differ in JavaScript through file reading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过文件读取了解JavaScript中异步和同步方法的区别</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/understand-how-asynchronous-and-synchronous-methods-differ-in-javascript-through-file-reading-fa90134a990c?source=collection_archive---------3-----------------------#2020-03-25">https://javascript.plainenglish.io/understand-how-asynchronous-and-synchronous-methods-differ-in-javascript-through-file-reading-fa90134a990c?source=collection_archive---------3-----------------------#2020-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7fab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大多数JavaScript方法包括<code class="fe kl km kn ko b">setTimeout</code>、<code class="fe kl km kn ko b">process.nextTick</code>异步工作<strong class="jp ir">。</strong>不过，有些方法可以同时<strong class="jp ir">和</strong>使用(即fs模块)</p><blockquote class="kp"><p id="2a37" class="kq kr iq bd ks kt ku kv kw kx ky kk dk translated">让我们比较JavaScript中的异步和同步方法，以及何时使用异步和同步方法</p></blockquote><figure class="kz la lb lc ld le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi gj"><img src="../Images/68c9452029e00d1225bc2e0b5665b0fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2b2m8FgTeL01v4bihrNZcg.png"/></div></div></figure><h1 id="f372" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">&gt;首先，让我们使用fs模块读取一个文件</h1><ul class=""><li id="2d19" class="mj mk iq jp b jq ml ju mm jy mn kc mo kg mp kk mq mr ms mt bi translated">让我们来读一个名为<strong class="jp ir"> readme.txt </strong>的文件</li></ul><p id="3618" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mu"> readme.txt </em></p><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="bae7" class="nd lm iq ko b gy ne nf l ng nh">please read me many times!</span></pre><ul class=""><li id="dfcd" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">让我们制作一个<strong class="jp ir"> readFile.js </strong>文件来读取文件3次</li></ul><figure class="mv mw mx my gt le"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk">readFile.js</figcaption></figure><ul class=""><li id="28fb" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">让我们运行代码</li></ul><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="169a" class="nd lm iq ko b gy ne nf l ng nh">$ node readFile</span></pre><ul class=""><li id="6153" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">查看它的输出</li></ul><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="4a0b" class="nd lm iq ko b gy ne nf l ng nh">start<br/>end<br/>first please read me many times!<br/>third please read me many times!<br/>second please read me many times!</span></pre><blockquote class="kp"><p id="2366" class="kq kr iq bd ks kt nr ns nt nu nv kk dk">?????</p></blockquote><pre class="kz la lb lc ld mz ko na nb aw nc bi"><span id="8d90" class="nd lm iq ko b gy ne nf l ng nh">start<br/>end<br/>third please read me many times!<br/>first please read me many times!<br/>second please read me many times!</span></pre><blockquote class="kp"><p id="ae81" class="kq kr iq bd ks kt nr ns nt nu nv kk dk">?????</p></blockquote><pre class="kz la lb lc ld mz ko na nb aw nc bi"><span id="d7e5" class="nd lm iq ko b gy ne nf l ng nh">start<br/>end<br/>third please read me many times!<br/>second please read me many times!<br/>first please read me many times!</span></pre><p id="df4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mu">以上所有输出正确</em> </strong></p><ul class=""><li id="72a8" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">除了<code class="fe kl km kn ko b">start</code> &amp; <code class="fe kl km kn ko b">end</code>之外，输出的顺序可以不同</li><li id="bafe" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated">每次运行时，输出都不同</li></ul><h1 id="8c6c" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">异步读取文件</h1><figure class="mv mw mx my gt le gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/fbac2a67d1fb5b128a1f1ad8cc9c86aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/0*r0YdrCt3gi_543QZ.png"/></div></figure><ul class=""><li id="9ca6" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">输出是不同的，因为上面的代码使用异步方法</li><li id="a051" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated">异步方法要求<strong class="jp ir">后台</strong>读取文件并继续下一个任务。换句话说，它3次请求读取文件并执行<code class="fe kl km kn ko b">console.log('end')</code></li><li id="130b" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated">然后<strong class="jp ir">后台</strong>通知<strong class="jp ir">主线程</strong>，这时<strong class="jp ir">主线程</strong>最终执行注册的回调方法</li></ul><p id="3358" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">异步方法的优势</strong></p><ul class=""><li id="525d" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">异步方法有利于处理数百个I/O请求，因为<strong class="jp ir">主线程</strong>将其任务委托给<strong class="jp ir">后台</strong></li><li id="a7e4" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated"><strong class="jp ir">一旦<strong class="jp ir">后台</strong>完成每个I/O请求，主线程</strong>就可以完成它的工作</li></ul></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><h1 id="5183" class="ll lm iq bd ln lo oj lq lr ls ok lu lv lw ol ly lz ma om mc md me on mg mh mi bi translated">非阻塞、阻塞、异步、同步的定义</h1><figure class="mv mw mx my gt le gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/dc51ac31a1d140e8d754f1e7ce7fec1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*5jbDPnv70keKzfXS"/></div></figure><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="5900" class="nd lm iq ko b gy ne nf l ng nh">In node.js, </span><span id="5fb8" class="nd lm iq ko b gy op nf l ng nh">Sync method often pairs with Blocking method <strong class="ko ir">(Sync - Blocking)<br/></strong>Async method often pairs with NonBlocking method <strong class="ko ir">(Async - NonBlocking)</strong></span><span id="02a0" class="nd lm iq ko b gy op nf l ng nh">Sync - Blocking method keeps checking whether the background task is completed or not and returns <strong class="ko ir">only</strong> when the background work is done</span><span id="e915" class="nd lm iq ko b gy op nf l ng nh">Async - NonBlocking method does not care whether the background task is completed or not and a called function returns immediately to move on to the next task</span></pre></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><h1 id="e802" class="ll lm iq bd ln lo oj lq lr ls ok lu lv lw ol ly lz ma om mc md me on mg mh mi bi translated">同步读取文件</h1><p id="8fdb" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy oq ka kb kc or ke kf kg os ki kj kk ij bi translated">使用<strong class="jp ir">readfilesync()</strong>而不是<strong class="jp ir"> readFile() </strong>读取文件</p><figure class="mv mw mx my gt le"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk">readFile.js</figcaption></figure><ul class=""><li id="73ee" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">让我们运行代码</li></ul><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="498d" class="nd lm iq ko b gy ne nf l ng nh">$ node readFile</span></pre><ul class=""><li id="33bc" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">查看它的输出</li></ul><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="856e" class="nd lm iq ko b gy ne nf l ng nh">start<br/>first please read me many times!<br/>second please read me many times!<br/>third please read me many times!<br/>end</span></pre><p id="67f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">异步方法的区别</strong></p><ul class=""><li id="8ae6" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">使用readFileSync()而不是readFile()</li><li id="7ae4" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated"><strong class="jp ir"> console.log </strong>返回值代替使用回调函数</li><li id="eed9" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated">输出按顺序打印</li></ul><p id="a915" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">同步方法的问题</strong></p><ul class=""><li id="bd9b" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">对于数百个请求有一个性能问题，因为下一个任务需要<strong class="jp ir">等待</strong>前一个任务完成，并且只能在前一个任务完成后<strong class="jp ir">执行</strong></li><li id="54a4" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated">换句话说，<strong class="jp ir">主线程</strong>除了等待什么也不做，而<strong class="jp ir">后台</strong>在工作<strong class="jp ir">【低效】</strong></li></ul></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><figure class="mv mw mx my gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi ot"><img src="../Images/2ca13922cb9357985b860a53c244ebda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UFaoro2lfnfb2vXS"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk">Photo by <a class="ae ou" href="https://unsplash.com/@productschool?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Product School</a> on <a class="ae ou" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kp"><p id="6875" class="kq kr iq bd ks kt nr ns nt nu nv kk dk translated">您:我想使用异步方法提高效率，但也想按顺序打印(console.log)</p></blockquote><figure class="kz la lb lc ld le"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk">readFile.js</figcaption></figure><ul class=""><li id="3b98" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">让我们运行代码</li></ul><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="ca05" class="nd lm iq ko b gy ne nf l ng nh">$ node readFile</span></pre><ul class=""><li id="5e0a" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">查看它的输出</li></ul><pre class="mv mw mx my gt mz ko na nb aw nc bi"><span id="b718" class="nd lm iq ko b gy ne nf l ng nh">start<br/>end<br/>first please read me many times!<br/>second please read me many times!<br/>third please read me many times!</span></pre><figure class="mv mw mx my gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi ov"><img src="../Images/3ec4a0440ec0b7883300f8edb544208f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cbIdGUPyGRzMlo_Q.jpeg"/></div></div></figure><p id="6da1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">解决方案—回调</strong></p><ul class=""><li id="0f42" class="mj mk iq jp b jq jr ju jv jy ni kc nj kg nk kk mq mr ms mt bi translated">如你所料，解决方案是回调。放置下一个<strong class="jp ir"> readFile() </strong>作为对前一个<strong class="jp ir"> readFile() </strong>的回调</li><li id="d9ac" class="mj mk iq jp b jq nw ju nx jy ny kc nz kg oa kk mq mr ms mt bi translated">ES6引入<strong class="jp ir">承诺</strong> &amp; <strong class="jp ir">异步/等待</strong>解决回调地狱(左图)</li></ul></div></div>    
</body>
</html>