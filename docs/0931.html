<html>
<head>
<title>React Native: Animated TabBar using React-navigation(v5) and MobX (Part-III).</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native:使用React-navigation(v5)和MobX(第三部分)的动画TabBar。</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-native-animated-tabbar-using-react-navigation-v5-and-mobx-part-iii-a6e39ac699fe?source=collection_archive---------12-----------------------#2020-01-03">https://javascript.plainenglish.io/react-native-animated-tabbar-using-react-navigation-v5-and-mobx-part-iii-a6e39ac699fe?source=collection_archive---------12-----------------------#2020-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jk jl jm jn"><div class="bz fp l di"><div class="jo jp l"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">Animated Circular tab bar (react-native)</figcaption></figure><p id="299b" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">这是关于如何使用'<strong class="jw io"> react-navigation </strong>和'<strong class="jw io"> Mobx </strong>'制作自定义动画标签栏的3部分系列的第3部分。</p><p id="e326" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">这是链接到-</p><p id="dd1b" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated"><strong class="jw io">第一部</strong>:</p><div class="ks kt gp gr ku kv"><a href="https://medium.com/@ullasgupta/react-native-animated-tabbar-using-react-navigation-v5-and-mobx-part-i-18a7e2630203" rel="noopener follow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">React-native:使用React-navigation(v5)和MobX(第一部分)的动画TabBar。</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">最近，我偶然发现了在基于MobX和…的react-native应用程序上添加自定义Tabbar的问题</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">medium.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj lk kv"/></div></div></a></div><p id="0eca" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated"><strong class="jw io">第二部分</strong>:</p><div class="ks kt gp gr ku kv"><a href="https://medium.com/@ullasgupta/react-native-animated-tabbar-using-react-navigation-v5-and-mobx-part-ii-c7e1e2651de5" rel="noopener follow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">React-native:使用React-navigation(v5)和MobX(第二部分)的动画TabBar。</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">这是关于如何使用“反应-导航”和“MobX”制作自定义动画标签栏的3部分系列的第2部分。</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">medium.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj lk kv"/></div></div></a></div><p id="9e3d" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated"><strong class="jw io"> GitHub回购</strong>:</p><div class="ks kt gp gr ku kv"><a href="https://github.com/Samykills/react-native-circular-tab-bar" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">Samy kills/react-native-circular-tab-bar</h2><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">github.com</p></div></div><div class="le l"><div class="ll l lg lh li le lj lk kv"/></div></div></a></div></div><div class="ab cl lm ln hr lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ig ih ii ij ik"><h1 id="7d4b" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">第三部分:动画和互动。</h1><p id="cd54" class="pw-post-body-paragraph ju jv in jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ig bi translated">让我们开始吧。</p><p id="f9b4" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">在上一篇文章中，我们制作了一个自定义的标签栏，看起来像这样(没有动画) :</p><figure class="mx my mz na gt jn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/bb171a5747e0868001522c5203f37947.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/1*mjlPyHlWRMgyrz4YjhfEtA.gif"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">custom tab bar(without animations)</figcaption></figure><figure class="mx my mz na gt jn gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/8217464f2114e812aa828baab8e7431d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cn4aevgjWSHAkex96PWzeA.png"/></div></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">Animated custom tabBar(final)</figcaption></figure><p id="f7c5" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">现在让我们添加动画和声音，使它更加流畅和互动。</p><blockquote class="nh ni nj"><p id="868a" class="ju jv nk jw b jx jy jz ka kb kc kd ke nl kg kh ki nm kk kl km nn ko kp kq kr ig bi translated"><strong class="jw io">注意</strong>:继续本教程，我假设你对<strong class="jw io">动画api </strong>和<strong class="jw io">反应钩子</strong>有一些基本的了解。</p></blockquote><div class="ks kt gp gr ku kv"><a href="https://facebook.github.io/react-native/docs/animated" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">动画反应原生</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">动画库旨在使动画流畅、强大，并且易于构建和维护。动画…</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">facebook.github.io</p></div></div><div class="le l"><div class="no l lg lh li le lj lk kv"/></div></div></a></div><div class="ks kt gp gr ku kv"><a href="https://reactjs.org/docs/hooks-intro.html" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">介绍钩子-反应</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">钩子是React 16.8中的新增功能。它们允许您使用状态和其他React特性，而无需编写类。这个…</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">reactjs.org</p></div></div><div class="le l"><div class="np l lg lh li le lj lk kv"/></div></div></a></div><h1 id="18b2" class="lt lu in bd lv lw nq ly lz ma nr mc md me ns mg mh mi nt mk ml mm nu mo mp mq bi translated">动画片</h1><p id="f82d" class="pw-post-body-paragraph ju jv in jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ig bi translated">我们会使用react-native提供的非常牛逼的'<strong class="jw io"> <em class="nk">动画'</em> </strong> Api。有了开发人员掌握的api知识，许多事情都成为可能。</p><p id="a7dd" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">让我们移动到“<strong class="jw io"> tabBar.js </strong>”并尝试将指针移动到当前聚焦的选项卡:</p><figure class="mx my mz na gt jn"><div class="bz fp l di"><div class="nv jp l"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">tabbar v3 with pointer movement animations</figcaption></figure><p id="f030" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">刷新模拟器时，我们可以看到动画效果。</p><figure class="mx my mz na gt jn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/35946338602d85a0a7816b355bdbc175.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/1*saYe9JbECMtra342gNLioQ.gif"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">Animated tabBar v3</figcaption></figure><h2 id="0634" class="nx lu in bd lv ny nz dn lz oa ob dp md kf oc od mh kj oe of ml kn og oh mp oi bi translated">将显示和隐藏动画添加到标签栏:</h2><p id="4767" class="pw-post-body-paragraph ju jv in jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ig bi translated">现在我们有了指针移动，让我们通过隐藏不活动/不需要的标签栏来使标签栏更适合现代设计(节省空间)。</p><p id="ab8e" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">要做到这一点:<br/> 1。我们必须在每次滑动时显示标签栏，并在给定时间内点击和隐藏它。<br/> 2。当用户按下标签栏区域时显示标签栏。</p><p id="11cd" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">将当前tabBar.js中的代码替换为:</p><figure class="mx my mz na gt jn"><div class="bz fp l di"><div class="nv jp l"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">tabBar(final).js</figcaption></figure><p id="9c3f" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">为了提供淡入/淡出效果，我们在父选项卡栏视图上使用了一个动画值'<strong class="jw io">Animated tab capacity</strong>'。</p><p id="44c3" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated"><strong class="jw io">‘use effect’</strong>使用钩子，以便在每次重新呈现标签栏时正确清除超时，这样旧的超时就不会运行，从而防止任何内存泄漏。</p><p id="ee00" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">对于处理移动指针的动画，我们添加了<strong class="jw io">‘useNativeDriver:true’</strong>，以便它们由原生UI线程处理，导致颜色变化的动画由JS线程处理，也是可执行的。</p><p id="0752" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated"><strong class="jw io">‘Switch’</strong>语句根据当前聚焦的屏幕处理定时动画。</p><p id="56fd" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">生成的tabBar现在看起来更加平滑和整洁。</p><figure class="mx my mz na gt jn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/b0de70afce6d2a6f279db795522c6a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/1*tb1yFvDJDSEiFFgle74b7A.gif"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">the disappearing tab bar animation</figcaption></figure><h1 id="eff3" class="lt lu in bd lv lw nq ly lz ma nr mc md me ns mg mh mi nt mk ml mm nu mo mp mq bi translated">添加声音。</h1><p id="ef7f" class="pw-post-body-paragraph ju jv in jw b jx mr jz ka kb ms kd ke kf mt kh ki kj mu kl km kn mv kp kq kr ig bi translated">向应用程序中添加动画会使其在视觉上更具吸引力，但有时我们需要通过添加声音来为用户创造最佳体验。</p><p id="a568" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">不幸的是，React-native没有任何声音/音频api，因此我们必须依赖react-native-community来获得合适的Api。</p><p id="3498" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">幸运的是，react-native社区非常庞大，有许多开发人员已经发布了一些非常有用的库，可以为我们施展魔法。</p><p id="7415" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">我为这个项目考虑的一些库:</p><ol class=""><li id="4dcb" class="ok ol in jw b jx jy kb kc kf om kj on kn oo kr op oq or os bi translated">反应-自然-声音</li><li id="0fa9" class="ok ol in jw b jx ot kb ou kf ov kj ow kn ox kr op oq or os bi translated">反应-原生-音频</li><li id="c5ad" class="ok ol in jw b jx ot kb ou kf ov kj ow kn ox kr op oq or os bi translated">反应-本地-声音-播放器</li></ol><blockquote class="nh ni nj"><p id="6232" class="ju jv nk jw b jx jy jz ka kb kc kd ke nl kg kh ki nm kk kl km nn ko kp kq kr ig bi translated"><strong class="jw io">‘react-native-sound’</strong>和<strong class="jw io">‘react-native-audio’</strong>是非常棒的库，但是它们不再被积极维护了。</p></blockquote><div class="ks kt gp gr ku kv"><a href="https://github.com/jsierles/react-native-audio" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">jsierles/react-native-audio</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">React Native的录音机库。通过创建一个帐户来为jsierles/react-native-audio开发做贡献…</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">github.com</p></div></div><div class="le l"><div class="oy l lg lh li le lj lk kv"/></div></div></a></div><div class="ks kt gp gr ku kv"><a href="https://github.com/zmxv/react-native-sound" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">zmxv/react-native-sound</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">React本机模块，用于在iOS、Android和Windows上播放声音剪辑。请注意，这个软件是阿尔法质量和…</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">github.com</p></div></div><div class="le l"><div class="oz l lg lh li le lj lk kv"/></div></div></a></div><p id="6256" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">所以我选择了react-native-sound-player，很容易和react-native v 0.60+集成</p><div class="ks kt gp gr ku kv"><a href="https://github.com/johnsonsu/react-native-sound-player#readme" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd io gy z fp la fr fs lb fu fw im bi translated">约翰逊苏/反应-原生-声音-播放器</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">播放音频文件，从URL流音频，使用ReactNative。//纱纱添加react-native-sound-player //或npm npm…</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">github.com</p></div></div><div class="le l"><div class="pa l lg lh li le lj lk kv"/></div></div></a></div><p id="9235" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">我得到的声音文件来自网站<a class="ae pb" href="https://freesound.org/home/" rel="noopener ugc nofollow" target="_blank"><strong class="jw io">FreeSound.org</strong></a>。<br/>这里是 文件的<a class="ae pb" href="https://freesound.org/people/waveplay_old/sounds/201766/download/201766__waveplay-old__tick.wav" rel="noopener ugc nofollow" target="_blank"> <strong class="jw io">下载链接。</strong></a></p><p id="bb08" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">要在动画TabBar中使用该文件，我们需要将该文件添加到本地iOS和Android代码中:</p><ol class=""><li id="9317" class="ok ol in jw b jx jy kb kc kf om kj on kn oo kr op oq or os bi translated">在iOS上，将声音文件拖放到Xcode中的项目中。记住选中“如果需要，复制项目”选项和“添加到目标”。</li><li id="465f" class="ok ol in jw b jx ot kb ou kf ov kj ow kn ox kr op oq or os bi translated">在Android上，把声音文件放在<code class="fe pc pd pe pf b">{project_root}/android/app/src/main/res/raw/</code>里。如果文件夹不存在，就创建它。</li></ol><p id="68bc" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">为了保持我们的代码在iOS中的整洁，我添加了一个<strong class="jw io"> assets </strong>文件夹，并且符号链接了来自<code class="fe pc pd pe pf b">android/app/src/main/res/raw/</code>的res的文件</p><p id="951b" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">为了播放每次标签变化(滑动/点击)时的声音，我们需要添加SoundPlayer到tabbar store<strong class="jw io">setCurrentScene</strong>动作。</p><figure class="mx my mz na gt jn"><div class="bz fp l di"><div class="nv jp l"/></div><figcaption class="jq jr gj gh gi js jt bd b be z dk">TabBarStore.js(with sound)</figcaption></figure><p id="7802" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">在这里，我们加载声音文件，以便每当我们改变标签时，它总是准备好播放。</p><p id="7b3b" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">关于使用MobX和react-navigation创建动画TabBar的3部分系列到此结束。你可以在 这里找到教程<a class="ae pb" href="https://github.com/Samykills/react-native-circular-tab-bar" rel="noopener ugc nofollow" target="_blank"> <strong class="jw io">的完整代码。</strong></a></p><p id="763b" class="pw-post-body-paragraph ju jv in jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ig bi translated">希望这对你有帮助。</p></div></div>    
</body>
</html>