<html>
<head>
<title>Listen to any DOM Event using an Observable in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Angular中的可观察对象监听任何DOM事件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/listen-to-any-dom-event-using-an-observable-in-angular-342ffdb798a7?source=collection_archive---------8-----------------------#2020-10-19">https://javascript.plainenglish.io/listen-to-any-dom-event-using-an-observable-in-angular-342ffdb798a7?source=collection_archive---------8-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ebf6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用可观察对象监听Angular中的DOM事件</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/72e5bf6c9aa9fcb01059c522c28c2bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M-7E_zC8tmXzD9ny"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">QwsdtPhot<a class="ae kv" href="https://unsplash.com/@pabloheimplatz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">o by Pablo Heim</a>plat<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">z on Uns</a>plash</figcaption></figure><h1 id="5ecf" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="e860" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本指南中，我将向您展示如何使用Rxjs Observables来监听和响应各种HTML DOM事件。</p><p id="e90e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">HTML DOM事件允许JavaScript在HTML文档中的元素上注册不同的事件处理程序。</p><p id="4bbc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">可观察值是一个简单的函数，它随时间向观察者返回一系列值。基于这个定义，您可以将DOM事件看作是返回一些数据流的可观察对象。例如，当鼠标单击事件发生时，总是会发出一个事件。</p><h1 id="6179" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">创建角度应用程序</h1><p id="73da" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了说明如何监听DOM事件，我们将创建一个简单的Angular应用程序，并用它来监听一些DOM事件。您可以通过CLI使用以下命令来完成此操作。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f7d1" class="mu kx iq mq b gy mv mw l mx my">ng new dom-event-observer --defaults</span></pre><h1 id="f7a9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">创建可观察的事件</h1><p id="6b8a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Rxjs有<strong class="lq ir"> <em class="mz"> fromEvent </em> </strong>函数，我们可以用它将DOM事件转换成一个可观察的序列。fromEvent的格式如下<code class="fe na nb nc mq b">fromEvent (target, eventname: string)</code>，并带有两个参数。</p><ol class=""><li id="953b" class="nd ne iq lq b lr mk lu ml lx nf mb ng mf nh mj ni nj nk nl bi translated">第一个参数是事件目标，在我们的例子中，它是文档(DOM)。</li><li id="8547" class="nd ne iq lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated">第二个参数是我们想要监听的事件的名称，类型为string。</li></ol><p id="14da" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以监听的DOM事件有很多，但是为了方便起见，我们在这个例子中只使用四个，分别是:<em class="mz"> click </em>、<em class="mz"> auxclick </em>、<em class="mz"> mouseover </em>和<em class="mz"> wheel </em>。其他值得注意的DOM事件有<em class="mz">拖动</em>、<em class="mz">放下</em>、<em class="mz">聚焦</em>和<em class="mz"> keyup </em>。</p><p id="a12e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">要获得更全面的DOM事件列表，请点击这里查看w3schools <a class="ae kv" href="https://www.w3schools.com/jsref/dom_obj_event.asp" rel="noopener ugc nofollow" target="_blank">的参考文章。</a></p><p id="9723" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">复制并将以下代码粘贴到您的<strong class="lq ir"> <em class="mz"> app.component.ts文件</em> </strong> <em class="mz">中。</em></p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f281" class="mu kx iq mq b gy mv mw l mx my">import { Component, OnInit } from '@angular/core';<br/>import { fromEvent, Observable } from 'rxjs';</span><span id="35e4" class="mu kx iq mq b gy nr mw l mx my">@Component({<br/>    selector: 'app-root',<br/>    templateUrl: './app.component.html',<br/>    styleUrls: ['./app.component.css']</span><span id="3128" class="mu kx iq mq b gy nr mw l mx my">})</span><span id="3880" class="mu kx iq mq b gy nr mw l mx my">export class AppComponent implements OnInit {<br/>  title = 'dom-event-observer';</span><span id="2ba5" class="mu kx iq mq b gy nr mw l mx my">  click$: Observable&lt;any&gt; = fromEvent(document, 'click');<br/>  rightClick$: Observable&lt;any&gt; = fromEvent(document, 'auxclick');<br/>  mouseOver$: Observable&lt;any&gt; = fromEvent(document, 'mouseover');<br/>  wheel$: Observable&lt;any&gt; = fromEvent(document, 'wheel');</span><span id="712e" class="mu kx iq mq b gy nr mw l mx my"> private subscribeToObservables() {<br/>   this.click$.subscribe(()=&gt; console.log(`Mouse click event!`))<br/>   this.rightClick$.subscribe(() =&gt; console.log(`Right click event!`));<br/>  this.mouseOver$.subscribe(() =&gt; console.log(`Mouse over event!`));<br/>  this.wheel$.subscribe(() =&gt; console.log(`Mouse wheel event!`));<br/> }</span><span id="5783" class="mu kx iq mq b gy nr mw l mx my"> ngOnInit() {<br/>  this.subscribeToObservables();<br/> }</span><span id="ed8c" class="mu kx iq mq b gy nr mw l mx my">}</span></pre><p id="d981" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这基本上就是代码所做的。</p><ul class=""><li id="576d" class="nd ne iq lq b lr mk lu ml lx nf mb ng mf nh mj ns nj nk nl bi translated">从事件导入<strong class="lq ir">，从rxjs导入<strong class="lq ir">可观察</strong>。另外，我已经从Angular core导入了<strong class="lq ir"> OnInit </strong>。</strong></li><li id="1dba" class="nd ne iq lq b lr nm lu nn lx no mb np mf nq mj ns nj nk nl bi translated">我已经创建了四个可观察的属性，并给它们分配了各自的DOM事件。每当我们监听的事件发生时，我们只需记录到控制台。属性以<strong class="lq ir"> $ </strong>结尾，这是命名可观察属性的常见约定。</li><li id="652d" class="nd ne iq lq b lr nm lu nn lx no mb np mf nq mj ns nj nk nl bi translated">最后，当组件在ngOnInit()中初始化时，我们通过调用subscribeToObservables方法来订阅不同的观察值。</li></ul><p id="5792" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果您想监听其他DOM事件，您可以简单地创建一个Observable属性，并使用fromEvent操作符将它分配给正确的事件，就像我们在上面的代码中所做的那样。</p><h1 id="d65d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">行动中的可观察事物</h1><p id="9556" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在，应用程序代码已经连接好了，我们可以继续使用下面的命令为应用程序提供服务。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c22e" class="mu kx iq mq b gy mv mw l mx my">ng serve -o</span></pre><p id="01d9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">因为我们使用了<code class="fe na nb nc mq b">-o</code>标志，所以应用程序将自动在您的默认网络浏览器中打开。</p><p id="2222" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">打开你的浏览器开发者工具，通常情况下，按下<code class="fe na nb nc mq b">f12</code>键即可进入。</p><p id="f826" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在尝试我们正在收听的事件；将鼠标悬停在对象上，单击页面或使用鼠标滚轮。您可以看到，随着不同事件的发生，相应的消息被记录到控制台中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c8d290a20d5900bdeba96fe3fb8c4a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*F6FPs50EzHDeYIJO1azeSg.gif"/></div></figure></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><h1 id="a8fd" class="kw kx iq bd ky kz ob lb lc ld oc lf lg jw od jx li jz oe ka lk kc of kd lm ln bi translated">结论</h1><p id="2ec4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这就是使用Rxjs Observable和fromEvent函数监听HTML DOM事件的简单方法。</p><p id="6567" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">Observables非常擅长处理数据流，DOM事件就是可以用Observables很好地处理数据流的一个很好的例子。</p></div></div>    
</body>
</html>