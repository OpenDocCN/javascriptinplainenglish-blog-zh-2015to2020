<html>
<head>
<title>Deploying a Node JS App to Azure App Service using Azure Dev-ops (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Azure开发运营将节点JS应用程序部署到Azure应用程序服务(第1部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/deploying-node-js-app-using-azure-devops-part1-74cb13a6bd02?source=collection_archive---------0-----------------------#2019-05-27">https://javascript.plainenglish.io/deploying-node-js-app-using-azure-devops-part1-74cb13a6bd02?source=collection_archive---------0-----------------------#2019-05-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6af0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在Azure DevOps门户中创建azure web应用程序并为Node JS应用程序配置构建管道。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/057f4d35b26ea2d3990738754c2ad087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I7VmHjmIsy4oVBi-zt4sZA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">CI-CD for Node JS App using Azure Dev-Ops</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="kv kw l"/></div></figure><p id="3a93" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi lt translated"><span class="l lu lv lw bm lx ly lz ma mb di">在本由两部分组成的教程</span>中，我将讨论如何使用Azure dev-ops CI-CD 以非常简单的术语将<em class="mc"> Node JS应用程序部署到Azure web应用程序中，以便即使是没有多少DevOps经验的开发人员也可以在几分钟内部署代码。</em></p><blockquote class="md me mf"><p id="3430" class="kx ky mc kz b la lb jr lc ld le ju lf mg lh li lj mh ll lm ln mi lp lq lr ls ij bi translated"><em class="iq">此页上的说明假定您熟悉Azure门户和azure devops仪表板。如果您不知道如何在Azure Portal或Azure DevOps中添加项目，请在此处</em>   <strong class="kz ir"> <em class="iq">查看</em> <a class="ae mj" href="https://docs.microsoft.com/en-us/azure/app-service/environment/app-service-web-how-to-create-a-web-app-in-an-ase" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir">的教程。 </strong></a></strong></p></blockquote><h2 id="ca9c" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lg mt mu mv lk mw mx my lo mz na nb nc bi translated">第一步。创建Azure Web应用程序服务。</h2><p id="f91b" class="pw-post-body-paragraph kx ky iq kz b la nd jr lc ld ne ju lf lg nf li lj lk ng lm ln lo nh lq lr ls ij bi translated">第一步是使用以下配置在Azure门户上创建Azure web应用程序服务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/4350ab518ddae30aed11b64ceebb5438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikOaB5ilwPADcOqNZg9Dkw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Creating a new Web App Resource in the Azure portal with the above configurations.</figcaption></figure><p id="0277" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">部署web应用程序后，请登录到Azure开发运营门户。从仪表板添加新项目，然后转到“管道”。现在，让我们开始添加我们的管道任务，从git中提取节点js项目，并构建和部署它。</p><h2 id="01b7" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lg mt mu mv lk mw mx my lo mz na nb nc bi translated">第2步:创建构建管道</h2><p id="1ef8" class="pw-post-body-paragraph kx ky iq kz b la nd jr lc ld ne ju lf lg nf li lj lk ng lm ln lo nh lq lr ls ij bi translated">单击生成管道以添加新管道。现在为Node JS应用程序连接git存储库。Github有一个内置的集成，一旦你选择了它，它就会出现在一个新的标签上，这要感谢微软的75亿美元的交易，但是如果你的代码是在像Gitlab这样的外部或私有回购上，选择<strong class="kz ir"> <em class="mc">其他Git。</em> </strong>点击【增加连接】，输入回购的HTTP URL、用户名、令牌密钥或密码。</p><div class="kg kh ki kj gt ab cb"><figure class="nj kk nk nl nm nn no paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/a4d79c90421b8d0462f7c4450e1ea7a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*smWDmOEFiICEmm3R0w4Rag.png"/></div></figure><figure class="nj kk np nl nm nn no paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/2a3e920bd83dc658cc01768c291e3ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*F9qkItPpEkj2Z407fAYHXQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nq di nr ns">Connecting an external git repository to the pipeline.</figcaption></figure></div><p id="d8cf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦连接了git存储库，下一步就是将任务分配给构建作业。Azure为构建几乎所有类型的应用程序提供了一组模板。但在这里我们将选择一个空的工作来了解任务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/2bc789543886844da787238beba56de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYofr0gDYrxhnmzaOrkEZA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Select the start with an Empty job.</figcaption></figure><p id="0adf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">接下来，在“代理池”中，您可以选择是否要在Windows或Linux计算机上运行生成任务。在这里，我为windows机器选择了VS1017。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/2afba09f5fb2c060c20f241b9fec451b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LbBHSS0bgrVnQaWBy_ssdg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Agent Pool for build tasks</figcaption></figure><p id="2437" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在是这个过程中最重要的部分。按一下「代理程式工作」标题旁边的加号按钮，将下列工作新增至代理程式，并按指定编辑栏位。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/c210cfeed55a4e18651352f35d52772a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yK7RwkoIsN6l4mXm0-RdXw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Tasks under build agent.</figcaption></figure><ul class=""><li id="a037" class="nv nw iq kz b la lb ld le lg nx lk ny lo nz ls oa ob oc od bi translated"><strong class="kz ir">使用节点JS </strong> <br/>输入要使用的节点JS版本。<br/>使用节点10.15.3</li><li id="d50e" class="nv nw iq kz b la oe ld of lg og lk oh lo oi ls oa ob oc od bi translated"><strong class="kz ir"> Npm安装</strong> <br/>指定<code class="fe oj ok ol om b">npm install</code>命令安装节点模块。</li><li id="8ffd" class="nv nw iq kz b la oe ld of lg og lk oh lo oi ls oa ob oc od bi translated"><strong class="kz ir">存档</strong> <em class="mc">(参考截图2.6) </em> <br/>这个任务会将应用程序文件夹压缩。添加此任务并编辑以下字段:- <br/>根文件夹- <code class="fe oj ok ol om b">$(System.DefaultWorkingDirectory)</code> <br/>要创建的归档文件- <code class="fe oj ok ol om b">$(Build.ArtifactStagingDirectory)/node.zip<br/></code> <em class="mc">注意-确保选中替换现有归档复选框</em></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/5461970b376bb05e983828860edcba49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1FhMzmw1uzRGmdlQlCTNqQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot 2.6</figcaption></figure><ul class=""><li id="2793" class="nv nw iq kz b la lb ld le lg nx lk ny lo nz ls oa ob oc od bi translated"><strong class="kz ir">发布神器</strong> <em class="mc">(截图2.7) <br/> </em>该任务会将压缩后的项目文件夹推送到Azure Pipelines /TFS。<br/>发布路径— <code class="fe oj ok ol om b">$(Build.ArtifactStagingDirectory)</code></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/33912d39a522a0d717e51bedf05bd420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OGuT_PgAtQxQi2_AXQ1dQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot 2.7</figcaption></figure><h2 id="2c2b" class="mk ml iq bd mm mn mo dn mp mq mr dp ms lg mt mu mv lk mw mx my lo mz na nb nc bi translated">第四步:触发器</h2><p id="6e65" class="pw-post-body-paragraph kx ky iq kz b la nd jr lc ld ne ju lf lg nf li lj lk ng lm ln lo nh lq lr ls ij bi translated">您可以在这里定义希望azure dev-ops检查Gitlab(或任何外部git)存储库变更的频率。这不是一个很好的实践，但不幸的是，这是唯一的方法，除非你知道如何通过webhook建立触发器(以后会发布一篇关于这个的文章)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/4a9c5225904e31288d9bc00d2cec3b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-TPicNGIpKmHYUnJ6cRXg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Polling Interval for Git</figcaption></figure><blockquote class="md me mf"><p id="d382" class="kx ky mc kz b la lb jr lc ld le ju lf mg lh li lj mh ll lm ln mi lp lq lr ls ij bi translated">这都是在建设管道。我们将在第二部分<a class="ae mj" href="https://medium.com/@ispeakcode/deploying-node-js-app-using-azure-devops-part2-4567e4cf783b" rel="noopener"> <strong class="kz ir">中经历完成发布管道的步骤，这里</strong> </a> <strong class="kz ir">。</strong></p></blockquote></div></div>    
</body>
</html>