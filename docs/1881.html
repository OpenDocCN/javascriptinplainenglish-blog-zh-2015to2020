<html>
<head>
<title>How to use GraphQL in Angular without apollo-client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在没有apollo-client的情况下在Angular中使用GraphQL</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-graphql-in-angular-without-apollo-client-e34d13e0892f?source=collection_archive---------7-----------------------#2020-05-01">https://javascript.plainenglish.io/how-to-use-graphql-in-angular-without-apollo-client-e34d13e0892f?source=collection_archive---------7-----------------------#2020-05-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1726c3525f02b25c7758457a68965fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLtyoJr0rBK5489uN5P4Ig.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://burst.shopify.com/@sarahpflugphoto?utm_campaign=photo_credit&amp;utm_content=Free+Reference+Books+On+Shelves+Photo+%E2%80%94+High+Res+Pictures&amp;utm_medium=referral&amp;utm_source=credit" rel="noopener ugc nofollow" target="_blank">Sarah Pflug</a> from <a class="ae kc" href="https://burst.shopify.com/books?utm_campaign=photo_credit&amp;utm_content=Free+Reference+Books+On+Shelves+Photo+%E2%80%94+High+Res+Pictures&amp;utm_medium=referral&amp;utm_source=credit" rel="noopener ugc nofollow" target="_blank">Burst</a></figcaption></figure><p id="18eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可能会在应用程序中使用一些第三方库，原因如下:</p><ul class=""><li id="1a2a" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">我们需要的功能没有本地实现</li><li id="7243" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">靠我们自己很难实现</li><li id="caa2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">它很稳定，并且经过了很好的测试</li><li id="6863" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">它给了我们一些很好的API，所以我们可以使用它而不会有任何进一步的复杂性</li></ul><p id="a8ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">据我们所知，GraphQL客户端还没有正式实现，可能是因为脸书团队没有时间做这个(哈哈，真有趣)，或者根本不需要任何客户端实现。</p><p id="7783" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">只看简单的GraphQL请求(你可以在这里阅读更多关于<a class="ae kc" href="https://graphql.org/graphql-js/graphql-clients/" rel="noopener ugc nofollow" target="_blank">的内容)。</a></p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="6bc7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这只是一个本地HTTP请求。我们唯一要做的是，用变量创建一个查询参数，然后马上发送它。</p><p id="729b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除此之外，我们可以添加任意多的头，例如授权头。我的意思是我们可以使用标准Ajax请求可以拥有的所有属性。如果一切都这么简单，那为什么阿波罗客户端会存在？</p><h1 id="bc5c" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">阿波罗客户端</h1><p id="58c7" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">你可以把apollo-client想象成这个简单方法的巨大包装器。它在此基础上增加了一些特性，如状态管理、缓存、查询订阅、错误处理等。它给了你一个拥有单一库的机会，你可以用它来做任何与状态和API相关的事情。</p><p id="bb7d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还带来了一些有趣的概念，比如使用GraphQL查询从本地状态获取数据。</p><p id="b8d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它还附带了非常强大的开发工具。</p><p id="7536" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但凡事都有代价，对吗？。也有一些缺点。</p><h2 id="2a8a" class="my lw iq bd lx mz na dn mb nb nc dp mf ko nd ne mj ks nf ng mn kw nh ni mr nj bi translated">复杂性</h2><p id="8e84" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">apollo-client中最复杂的主题之一是配置，你必须配置几乎所有的东西。首先你必须安装6-7个依赖项，然后你需要用缓存和链接参数(最基本的)配置apollo-client。有一个中间件的概念，每当你想传递一些头，比如一个请求，你必须使用中间件。然后，如果你想有错误处理，你必须安装一个额外的依赖。此外，还有一个状态管理概念，默认情况下所有请求都被缓存。最令人恼火的是，为了弄清楚Apollo-client究竟是如何发送哪怕是一个简单的请求的，您必须大量阅读</p><h1 id="d0aa" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">额外功能</h1><p id="936d" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">还有一些很棒的状态管理库，比如<a class="ae kc" href="https://ngrx.io/" rel="noopener ugc nofollow" target="_blank"> ngrx </a>、<a class="ae kc" href="https://www.ngxs.io/concepts/state/" rel="noopener ugc nofollow" target="_blank"> ngxs </a>、<a class="ae kc" href="https://github.com/datorama/akita" rel="noopener ugc nofollow" target="_blank"> Akita </a>，有时候(几乎每次)你都想使用GraphQL作为Rest API的替代，只是为了发送请求和检索响应。在这种情况下，使用apollo客户端有点不知所措。apollo-client就像一个框架，大多数情况下，你只是想要一些效用函数。</p><h1 id="be21" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">使用本机实现还是apollo-client？</h1><p id="0aaa" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">这要看情况。如果您想简单地将GraphQL用于请求/响应，那么请使用本机实现。否则使用apollo-client。</p><p id="3c94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我开始在ngrx上使用apollo-client，几周后，我发现我在apollo上使用的方法只有<code class="fe nk nl nm nn b">query</code>和<code class="fe nk nl nm nn b">mutate</code>，所以我移除了apollo-client，开始使用原生的。如果有类似的情况，一定要使用本机实现。</p><h1 id="0c30" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">Angular中的本机实现</h1><p id="6d01" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">Angular中的本机实现和<code class="fe nk nl nm nn b">fetch</code>请求实现一样简单。我们所需要的是<code class="fe nk nl nm nn b">HttpClient</code>和一个包装GraphQL请求的服务</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="0650" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如你所见，我们有一个简单的服务，有两个方法<code class="fe nk nl nm nn b">mutate</code>和<code class="fe nk nl nm nn b">query</code>，它们所做的就是向服务器发送一个<code class="fe nk nl nm nn b">POST</code>请求，并映射响应</p></div></div>    
</body>
</html>