<html>
<head>
<title>Accessible Art Direction with Gatsby Images and React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">盖茨比形象和反应挂钩的无障碍艺术指导</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/accessible-art-direction-with-gatbsy-images-600b7b23eca8?source=collection_archive---------6-----------------------#2020-03-07">https://javascript.plainenglish.io/accessible-art-direction-with-gatbsy-images-600b7b23eca8?source=collection_archive---------6-----------------------#2020-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/22a2589d8c03c135bbb5ab23e1209aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cDu88cs688fNv0dhfA1ETA.jpeg"/></div></div></figure><p id="1096" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我最近在盖茨比纽约聚会上做了一个关于用盖茨比中的图像做艺术指导的演讲。</p><p id="645c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我以前在这个聚会上讲过如何处理《盖茨比》中的图像，以及盖茨比用你的现成图像做的所有很酷的事情。</p><p id="5d10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我开始探索艺术方向并为演讲建立一个示例网站时，我意识到没有一种明显的方式为我的图像提供替代文本。</p><p id="7449" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于制作不可访问的网站是坏开发人员做的事情(我想成为一个好的开发人员)，我想出了一个使用状态和自定义Graphql字段的解决方案。</p><p id="7550" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，我想我会分享给你:)</p><p id="9b55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想跳过这篇文章，直接进入<a class="ae kw" href="https://github.com/mrkutly/gatsby-nyc-talk-good-example" rel="noopener ugc nofollow" target="_blank">回购</a>，那也没问题。最后一个例子是<a class="ae kw" href="https://naughty-kare-c652c4.netlify.com/art/best/" rel="noopener ugc nofollow" target="_blank">这里主持</a>。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="a6e3" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">什么是艺术方向？</h1><p id="8044" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">不是所有的图片在任何尺寸下都好看。有些图片真的大的时候看起来很棒，小的时候就有点平淡无奇了。就像这广阔的冰岛风景:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/1931da972223f2f7bc138a790c4dadbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tG9l_LyUqa1RuuzDUmvBPg.jpeg"/></div></div></figure><p id="0d98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其他人可能看起来很小，但看起来很奇怪或变得粒状大。比如bjrk的这张照片:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/b6476bcaddaf336db75cdde62c5bdc60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7hbwkSoB1PLl3IAITrJWA.jpeg"/></div></div></figure><p id="2241" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你的网站根据<strong class="ka ir"><em class="mn"/></strong>不同的断点显示<strong class="ka ir"> <em class="mn">不同的图像</em> </strong>时，这就是所谓的艺术指导。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="0009" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">我们该如何对待盖茨比呢？</h1><p id="85b8" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">如果你之前和<code class="fe mo mp mq mr b">gatsby-image</code>合作过，这个你会很熟悉。如果没有，我建议按照这里的<a class="ae kw" href="https://www.gatsbyjs.org/docs/gatsby-image/" rel="noopener ugc nofollow" target="_blank">文档</a>进行设置，并学习如何在Gatsby中渲染单个图像。</p><p id="7fab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了让我们的图像与盖茨比艺术指导，我们将遵循以下步骤:</p><p id="9ce3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.用graphql查询我们的图像</p><p id="1df8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.创建图像源阵列</p><p id="02ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.将数组传递给gatsby <code class="fe mo mp mq mr b">&lt;Img /&gt;</code>组件</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="35bc" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">步骤1 -查询图像</h1><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c0e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，我们从文件系统中查询三个映像，并将结果命名为<code class="fe mo mp mq mr b">reynisfjara</code>、<code class="fe mo mp mq mr b">skogafoss</code>和<code class="fe mo mp mq mr b">bjork</code>。我们使用<code class="fe mo mp mq mr b">GatsbyImageSharpFluid </code> graphql片段来获取创建一些流动图像所需的一切。如果这部分对你来说是陌生的，我建议你浏览一下<a class="ae kw" href="https://www.gatsbyjs.org/docs/gatsby-image/" rel="noopener ugc nofollow" target="_blank">文档</a>并练习自己绘制一些图像。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="dc07" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">步骤2 -创建一个源数组</h1><p id="5db3" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">现在我们有了查询，我们的图像将在页面组件的props的“data”属性中可用。</p><p id="fe84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们把这些图像从道具中提取出来:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="0067" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然我们已经访问了需要提供给<code class="fe mo mp mq mr b">&lt;Img /&gt; </code>组件的所有图像数据，我们就可以创建图像源数组了。</p><p id="269d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每个源都是添加了<code class="fe mo mp mq mr b">media</code>属性的<code class="fe mo mp mq mr b">GatsbyImageSharpFluid</code>片段的结果。</p><p id="8daa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mo mp mq mr b">media</code>属性将是一个CSS媒体查询，告诉<code class="fe mo mp mq mr b">&lt;Img /&gt;</code>组件哪个图像需要在每个断点显示。</p><p id="ae18" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在以下断点显示这些图像:</p><p id="d959" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">- <strong class="ka ir">下方701px </strong> - <code class="fe mo mp mq mr b">bjork</code></p><p id="0db3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-<strong class="ka ir">701像素到1000像素</strong> - <code class="fe mo mp mq mr b">skogafoss</code></p><p id="edfe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-<strong class="ka ir">1000 px以上</strong> - <code class="fe mo mp mq mr b">reynisfjara</code></p><p id="b08c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们的源数组看起来像这样:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="bdaf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">太好了。现在我们有了源数组。让我们进入第三步！</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="e4d0" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">步骤3 —将数组传递给gatbsy-image</h1><p id="100c" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">代替将单个<code class="fe mo mp mq mr b">fluid</code>图像结果作为流体道具传递给<code class="fe mo mp mq mr b">&lt;Img /&gt;</code>组件(我们对单个图像所做的方式)，我们将把源数组传递给它。所以让我们从<code class="fe mo mp mq mr b">gatsby-image</code>导入<code class="fe mo mp mq mr b">&lt;Img /&gt;</code>组件来做吧！</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="0d94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">厉害！我们做到了。太神奇了。我们完了，对吧？</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="54c9" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">没有。没完成。你的替代文本呢？</h1><p id="8d77" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">糟糕。我们太花哨了，现在我们的网站坏了。因为我们不知道在任何给定的时间显示的是哪个图像，所以我们不能给它一个<code class="fe mo mp mq mr b">alt</code>属性。我们该如何处理这件事？</p><p id="d273" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">幸运的是，<code class="fe mo mp mq mr b">&lt;Img /&gt;</code>组件接受了一个非常有用的叫做<code class="fe mo mp mq mr b">onLoad</code>的道具。<code class="fe mo mp mq mr b">onLoad</code>是一个回调函数，它将在图像加载时被调用。</p><p id="03c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我们是超级聪明的React开发者，我打赌我们可以使用state来跟踪哪个图像正在被显示，并相应地更新alt文本。让我们开始吧！</p><p id="983d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们设置我们的状态并将其传递给<code class="fe mo mp mq mr b">&lt;Img /&gt;</code>组件的<code class="fe mo mp mq mr b">alt</code>属性:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="9a98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们将使用<code class="fe mo mp mq mr b">onLoad </code>回调来跟踪替换文本应该是什么。我们将通过检查视口的宽度来做到这一点。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="d07f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很好。危机解除。现在，我们的艺术指导图像有了替代文本。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="36f6" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">我们说完了吗？</h1><p id="3118" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">大概不会。我们解决了问题，但是如果我们想在项目的其他地方重用这些图像呢？</p><p id="8837" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所有的替代文本都被硬编码在我们的页面组件中。这意味着我们每次使用这些图像时都必须重写这些替代文本！</p><p id="2d7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果有什么方法可以让我们将alt文本附加到这些图片上就好了。这样，每当我们<strong class="ka ir"> <em class="mn">查询</em> </strong>图像时，alt文本就会随之出现。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="4a97" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在gatsby-node.js中创建自定义字段</h1><p id="2dcf" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">事实证明，我们可以使用<code class="fe mo mp mq mr b">gatsby-node.js</code>文件中的<code class="fe mo mp mq mr b">onCreateNode</code>函数来实现这一点。</p><p id="e8c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个函数将在我们的图上创建每个节点时运行一次。这意味着任何图像、markdown文件、json文件——作为我们数据层的一部分设置的任何东西——都将触发这个功能。</p><p id="1f9b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个<code class="fe mo mp mq mr b">onCreateNode</code>函数的一个非常方便的用途是将自定义字段附加到我们的节点上。因此，对于我们的图像，我们可以为它们附加替代文本，这些替代文本可以<strong class="ka ir"> <em class="mn">写一次</em></strong><strong class="ka ir"><em class="mn">在任何地方使用</em> </strong>。</p><p id="a6e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们为我们的图像创建一个基本的配置对象:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5699" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通常，我会把它放在自己的文件中，并导入到<code class="fe mo mp mq mr b">gatsby-node.js</code>中，但是为了简单起见，我们暂时把它放在这里。</p><p id="cfea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们可以使用<code class="fe mo mp mq mr b">onCreateNode</code>功能将这些配置附加到图像上:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="f35c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们的每个图像都有一个附加的alt文本。这意味着当我们用GraphQL查询图像时，alt文本可能会随之出现。</p><p id="d31d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们重写一下之前的<code class="fe mo mp mq mr b">icelandImagesQuery</code>:</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="fffe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">太好了！现在让我们用它来代替硬编码的替代文本。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="3e1f" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">谢谢:)</h1><p id="26e2" class="pw-post-body-paragraph jy jz iq ka b kb mc kd ke kf md kh ki kj me kl km kn mf kp kq kr mg kt ku kv ij bi translated">仅此而已。感谢阅读！米格韦希·❤</p></div></div>    
</body>
</html>