<html>
<head>
<title>Getting Started with React + TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React + TypeScript入门</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-typescript-813b02ff3672?source=collection_archive---------5-----------------------#2020-09-30">https://javascript.plainenglish.io/react-typescript-813b02ff3672?source=collection_archive---------5-----------------------#2020-09-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b54c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">结合两者的基本好处</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0226fba01d196638451948f4a056ffa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kIm7WtMPy7WLTlLjRtoQvg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><p id="8d2d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我们将通过几个例子来说明如何使用React &amp; TypeScript。我们看看道具、界面、一些钩子和表单处理。</p><p id="2a25" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，我们必须首先建立一个设置。最简单的方法就是使用<strong class="kx ir"> npx。</strong></p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="5acf" class="lw lx iq ls b gy ly lz l ma mb">npm install -g npx </span><span id="985f" class="lw lx iq ls b gy mc lz l ma mb">npx create-react-app my-app — template typescript</span><span id="28d7" class="lw lx iq ls b gy mc lz l ma mb">cd my-app/</span></pre><p id="3a9a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您已经有一个React.js项目，您可以在以后向它添加TypeScript支持。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="1a5c" class="lw lx iq ls b gy ly lz l ma mb">npm install — save typescript @types/node @types/react @types/react-dom @types/jest</span></pre><p id="7cd0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后只需将每个文件扩展名从“js”和“jsx”重命名为“tsx”。</p><p id="1c5c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好消息是TypeScript和JavaScript非常兼容。这意味着我们可以在。没有问题的tsx文件，其实就是普通的javascript。</p><p id="c2b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的app.tsx中有这样一个例子:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="add5" class="lw lx iq ls b gy ly lz l ma mb">function displayCount(userCount : number) : number {<br/>  <em class="md">return</em> userCount<br/>}</span><span id="4b4b" class="lw lx iq ls b gy mc lz l ma mb">function add(x) {<br/>  console.log(x)<br/>}</span><span id="4ca2" class="lw lx iq ls b gy mc lz l ma mb">function App() {<br/>  <em class="md">return</em> (<br/>    &lt;div className="App"&gt;<br/>      Current Users: {displayCount(24)}<br/>      &lt;button onClick={() =&gt; add(24)}&gt;Click me&lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="3e84" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">upper函数使用类型，这只有在TypeScript的帮助下才有可能。add-function只有在JavaScript中才能以同样的方式工作。然而，我们可以两者并用。</p><p id="a93f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可能需要在tsconfig.json: <code class="fe me mf mg ls b">"strict": false</code>中禁用严格模式</p><h1 id="f5e6" class="mh lx iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">创建第一个组件</h1><p id="83ab" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le na lg lh li nb lk ll lm nc lo lp lq ij bi translated">现在我们可以使用TypeScript为React.js编写一些代码，让我们创建一个基于函数的组件。</p><p id="3507" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，我们可以选择使用下面的语法。所以我们定义了一个React类型的组件。FC，代表功能组件。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="1f0f" class="lw lx iq ls b gy ly lz l ma mb">const UserInput : React.FC = () =&gt; {<br/>  <em class="md">return</em> &lt;input type=”text”/&gt;<br/>}</span></pre><p id="379b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">多亏了TypeScript，我们现在还可以定义我们的props需要哪些数据类型。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="ce33" class="lw lx iq ls b gy ly lz l ma mb">const UserInput : React.FC&lt;{text: string}&gt; = (props) =&gt; {<br/>  <em class="md">return</em> &lt;input type=”text” placeholder={props.text}/&gt;<br/>}</span><span id="ac69" class="lw lx iq ls b gy mc lz l ma mb">&lt;UserInput text="Please enter"/&gt;</span></pre><p id="4e09" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们现在将一个数字作为<em class="md">文本</em>传递，TypeScript将报告一个错误——因为我们期望一个名为<em class="md">文本</em>的字符串作为道具。</p><h1 id="2eea" class="mh lx iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">为道具使用接口</h1><p id="5d08" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le na lg lh li nb lk ll lm nc lo lp lq ij bi translated">但是我们也可以用一个<em class="md">接口</em>来实现整个事情。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="9da9" class="lw lx iq ls b gy ly lz l ma mb">interface Props {<br/>  text: string<br/>}</span><span id="4758" class="lw lx iq ls b gy mc lz l ma mb">const UserInput : React.FC&lt;Props&gt; = (props) =&gt; {<br/>  <em class="md">return</em> &lt;input type=”text” placeholder={props.text}/&gt;<br/>}</span></pre><p id="4fa1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们也可以组合接口。在这种情况下，我们指定我们期望作为道具的接口car，它由brand和speed组成，两者都分配了一个数据类型。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="76d1" class="lw lx iq ls b gy ly lz l ma mb">interface Car {<br/>  brand: string<br/>  speed: number<br/>}</span><span id="be75" class="lw lx iq ls b gy mc lz l ma mb">interface Props {<br/>  car: Car<br/>}</span><span id="1d07" class="lw lx iq ls b gy mc lz l ma mb">const CarSeller : React.FC&lt;Props&gt; = (props) =&gt; {<br/>  <em class="md">return</em> &lt;p&gt;The {props.car.brand} is {props.car.speed} fast &lt;/p&gt;<br/>}</span><span id="82b1" class="lw lx iq ls b gy mc lz l ma mb">&lt;CarSeller car={{brand: "Mercedes", speed: 150}}/&gt;</span></pre><h2 id="e10b" class="lw lx iq bd mi nd ne dn mm nf ng dp mq le nh ni ms li nj nk mu lm nl nm mw nn bi translated">使道具可选</h2><p id="5d4c" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le na lg lh li nb lk ll lm nc lo lp lq ij bi translated">可能对于汽车的潜在买家来说，速度并不感兴趣。在这种情况下，我们不必交出它，我们可以在界面中将它标记为可选的——这是可以用问号实现的。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="7e0f" class="lw lx iq ls b gy ly lz l ma mb">interface Car {<br/>  brand: string<br/>  speed?: number<br/>}</span></pre><p id="8ab8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过为我们的道具使用接口，我们可以创建一个清晰易懂的列表，列出组件需要和可选的道具。</p><p id="62b2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了稍微清理一下，使代码更容易阅读，我们当然可以不使用TSX中的props关键字:</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="4726" class="lw lx iq ls b gy ly lz l ma mb">const CarSeller : React.FC&lt;Props&gt; = ({car}) =&gt; {<br/>  <em class="md">return</em> &lt;p&gt;The {car.brand} is {car.speed} fast &lt;/p&gt;<br/>}</span></pre><p id="7196" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们也可以将接口分类到它们自己的文件中。在同一个文件中为每个组件提供一个接口是有意义的，这样你可以直接看到需要哪些道具。</p><p id="8497" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是对于我们的props接口，我们最终访问car接口，如果我们在其他几个组件中需要它，我们应该为它创建一个单独的文件。</p><p id="42be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> CarInterface.ts: </strong></p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="49ce" class="lw lx iq ls b gy ly lz l ma mb"><em class="md">export</em> <em class="md">default</em> interface Car {<br/>  brand: string<br/>  speed?: number<br/>}</span></pre><p id="7805" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">在App.tsx中导入:</strong></p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="2b68" class="lw lx iq ls b gy ly lz l ma mb"><em class="md">import</em> Car <em class="md">from</em> “./CarInterface”<br/>  interface Props {<br/>  car: Car<br/>}</span></pre><h1 id="a3fa" class="mh lx iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">钩住</h1><p id="3d0b" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le na lg lh li nb lk ll lm nc lo lp lq ij bi translated">对于钩子来说，使用TypeScripts特性(比如类型)也是完全可选的——但这是有意义的。但是我们不必为<em class="md"> useState </em>指定数据类型，如下例所示。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="13ab" class="lw lx iq ls b gy ly lz l ma mb">function App() {<br/>  const [count, changeCount] = useState&lt;number&gt;(0)<br/>  <em class="md">return</em> &lt;p&gt;{count}&lt;/p&gt;<br/>}</span></pre><p id="f5f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，我们可以使用接口来定义我们的数据类型。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="2151" class="lw lx iq ls b gy ly lz l ma mb">interface userInputInterface {<br/>  count: number<br/>}</span><span id="7627" class="lw lx iq ls b gy mc lz l ma mb">function App() {<br/>  const [userInput, changeInput] = <br/>  useState&lt;userInputInterface({count: 0})</span><span id="2170" class="lw lx iq ls b gy mc lz l ma mb">  <em class="md">return</em> &lt;p&gt;{userInput.count}&lt;/p&gt;<br/>}</span></pre><h2 id="9567" class="lw lx iq bd mi nd ne dn mm nf ng dp mq le nh ni ms li nj nk mu lm nl nm mw nn bi translated">使用引用</h2><p id="e94b" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le na lg lh li nb lk ll lm nc lo lp lq ij bi translated">要做到这一点，我们需要访问一些您在React或Vue等框架之外使用TypeScript时已经知道的东西。HTMLInputElement类型—因为我们现在使用的是refs。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="cd50" class="lw lx iq ls b gy ly lz l ma mb">const inputFieldRef = useRef&lt;HTMLInputElement&gt;(null)</span><span id="2352" class="lw lx iq ls b gy mc lz l ma mb">const getFocus = () =&gt; { inputFieldRef.current?.focus() }</span><span id="2c83" class="lw lx iq ls b gy mc lz l ma mb"><em class="md">return</em> &lt;&gt;<br/>  &lt;input type=”text” ref={inputFieldRef} /&gt;<br/>  &lt;button onClick={getFocus}&gt;Click me&lt;/button&gt;<br/>&lt;/&gt;</span></pre><p id="03fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将空值作为参数传递给T2 useRef T3，因为在执行时，输入标签还没有在DOM中呈现。这样，我们可以确保连接从我们的输入标签开始。</p><h1 id="2137" class="mh lx iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">用refs &amp; TypeScript处理表单</h1><p id="1dcd" class="pw-post-body-paragraph kv kw iq kx b ky my jr la lb mz ju ld le na lg lh li nb lk ll lm nc lo lp lq ij bi translated">我们刚刚让HTMLInputElement用ref访问DOM。现在让我们来看看在处理表单时使用引用的类型脚本。</p><p id="f9f3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">形状总是有一个“提交”按钮，它确保形状被发送。如果没有框架，表单会有一些属性，例如，数据应该发送到哪个URL以及使用哪种方法。</p><p id="a9f3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是我们想用JavaScript风格的React.js手动解决所有这些事情。因此，我们编写了一个函数，当表单被发送时触发这个函数，然后用<em class="md"> preventDefault() </em>阻止标准过程。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="017c" class="lw lx iq ls b gy ly lz l ma mb">const App : React.FC = () =&gt; {</span><span id="dde4" class="lw lx iq ls b gy mc lz l ma mb">  const submitHandler = (event: React.FormEvent) =&gt; {<br/>    event.preventDefault()<br/>  }  </span><span id="5826" class="lw lx iq ls b gy mc lz l ma mb">  return (<br/>    &lt;form onSubmit={submitHandler}&gt;<br/>      &lt;input type=”text” /&gt;<br/>      &lt;input type=”submit” value=”Submit”/&gt;<br/>   &lt;/form&gt;<br/>  )<br/>}</span></pre><p id="1b3e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为<em class="md"> submitHandler </em>函数的参数，我们传递事件，它必须是类型<em class="md"> FormEvent </em>，因为它是我们表单的一个动作。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="131c" class="lw lx iq ls b gy ly lz l ma mb">const App : React.FC = () =&gt; {<br/>  const textInputRef = useRef&lt;HTMLInputElement&gt;(null)</span><span id="92c0" class="lw lx iq ls b gy mc lz l ma mb">  const submitHandler = (event: React.FormEvent) =&gt; {<br/>    event.preventDefault()<br/>    const enteredText = textInputRef.current!.value<br/>    console.log(“submitted:”, enteredText)<br/>  }</span><span id="8a4b" class="lw lx iq ls b gy mc lz l ma mb">  <em class="md">return</em> (<br/>  &lt;form onSubmit={submitHandler}&gt;<br/>    &lt;input type=”text” ref={textInputRef} /&gt;<br/>    &lt;input type=”submit” value=”Submit”/&gt;<br/>   &lt;/form&gt;<br/>  )<br/>}</span></pre><p id="e547" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为<em class="md"> useRef、</em>的默认值，我们再次取<em class="md"> null </em>，作为类型，我们重新取HTMLInputElement。</p><p id="43c2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们处理提交的函数现在访问ref。利用电流！语法，我们告诉TypeScript如果值是<em class="md"> null </em>就没问题。最后，还没有输入任何内容。</p><p id="ee4a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在实际的输入字段中，我们只需要连接到ref，然后一切都准备好了。如果我们现在按submit，就会执行处理函数，从ref获取用户输入，并将其输出到控制台。</p><p id="2067" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们可以用TypeScript &amp; React来评估一个表单。</p></div></div>    
</body>
</html>