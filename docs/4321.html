<html>
<head>
<title>4 Common Mistakes When Using React to Avoid</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用反应避免时的4个常见错误</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/4-common-mistakes-when-using-react-to-avoid-ed9de4307de5?source=collection_archive---------0-----------------------#2020-12-03">https://javascript.plainenglish.io/4-common-mistakes-when-using-react-to-avoid-ed9de4307de5?source=collection_archive---------0-----------------------#2020-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d68c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你应该知道不要给你的代码库带来更多的问题</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e68281fd55345207ea383700238cff67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9i_qq9KXpukgk0hE"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@matscha?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Daniela Holzer</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fc74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">反应是当今一个伟大的图书馆。它简化了构建优美流畅的web应用程序的过程。</p><p id="3b95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是有一些常见的错误，如果你没有注意到，它会给你以后的项目带来负担。</p><p id="7ffe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有任何进一步的麻烦，让我们深入了解在使用reactor时应该避免哪些错误。</p><h1 id="01cd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.创建超人组件</h1><p id="8cc8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><em class="mp">超人</em>组件是可以做很多事情的组件。</p><p id="5ce1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我曾经从我的同事那里体验过这种成分。他将许多不相关的用户界面块放入一个组件中。然后，他使用一个属性来控制每个块的显示。类似于如果<code class="fe mq mr ms mt b">viewId=0</code>然后显示<code class="fe mq mr ms mt b">view_0</code>。</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="86ac" class="my lt iq mt b gy mz na l nb nc">class SupermanComponent extends React.Component {<br/>  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;div&gt;<br/>          /* UI Block 1 */<br/>        &lt;/div&gt;<br/>        &lt;div&gt;<br/>          /* UI Block 2 */<br/>        &lt;/div&gt;<br/>        &lt;div&gt;<br/>          /* UI Block 3 */<br/>        &lt;/div&gt;<br/>        &lt;div&gt;<br/>          /* UI Block 4 */<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span></pre><p id="24aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">起初你可能会认为它很方便。然而，当这个项目发展起来的时候，很快就会变得一团糟。更不用说在出现问题时进行调查需要时间。</p><p id="217f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个组件应该只关注一件事。为了可重用性和可伸缩性，不要给它太多处理大量任务的能力。</p><p id="e1cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，您应该限制导航栏组件的功能。应删除不相关的其他功能。通过这样做，您可以在任何需要的地方重用它。</p><p id="aa6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要因为将所有功能打包到一个组件中而偷懒。花时间想想你想要的组件应该是什么样子，并尽可能设计得独特。这些独特的组件更容易维护，在整个可组合系统中可以很好地协同工作。</p><p id="c5f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">块一组件:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="e940" class="my lt iq mt b gy mz na l nb nc">class BlockOne extends React.Component {<br/>  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        { /* Block 1 */ }<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="538b" class="my lt iq mt b gy nd na l nb nc">export default BlockOne;</span></pre><p id="35d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">块二组件:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="d223" class="my lt iq mt b gy mz na l nb nc">class BlockTwo extends React.Component {<br/>  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        { /* Block 2 */ }<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="e7d0" class="my lt iq mt b gy nd na l nb nc">export default BlockTwo;</span></pre><p id="bc7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">块三组件:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="e1a8" class="my lt iq mt b gy mz na l nb nc">class BlockThree extends React.Component {<br/>  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        { /* Block 3 */ }<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="02d2" class="my lt iq mt b gy nd na l nb nc">export default BlockThree;</span></pre><h1 id="05b5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.将数字作为字符串传递</h1><p id="a3eb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">看看下面的组件:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="44ea" class="my lt iq mt b gy mz na l nb nc">class UserDetails extends React.Component {<br/>  printGender() {<br/>    if (this.props.gender === 0) {<br/>      return ‘Male’;<br/>    }<br/>    <br/>    if (this.props.gender === 1) {<br/>      return ‘Female’;<br/>    }<br/> <br/>    return ‘Other’;<br/>  }</span><span id="adfb" class="my lt iq mt b gy nd na l nb nc">  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        Gender: {printGender()}<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span></pre><p id="b74e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们用<code class="fe mq mr ms mt b">gender</code>属性作为数字来决定性别。<code class="fe mq mr ms mt b">0</code>代表<code class="fe mq mr ms mt b">Male</code>、<code class="fe mq mr ms mt b">1</code>代表<code class="fe mq mr ms mt b">Female</code>，以及与<code class="fe mq mr ms mt b">0</code>和<code class="fe mq mr ms mt b">1</code>不同的任何东西代表<code class="fe mq mr ms mt b">Other</code>。</p><p id="e535" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们在某个地方使用<code class="fe mq mr ms mt b">UserDetails</code>组件:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="8b7d" class="my lt iq mt b gy mz na l nb nc">&lt;UserDetails gender=“0” /&gt;</span></pre><p id="578c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你期望性别会是<code class="fe mq mr ms mt b">Male</code>但事实并非如此。因为你把<code class="fe mq mr ms mt b">0</code>当作字符串而不是数字传递。因此，实际值将为<code class="fe mq mr ms mt b">Other</code>。</p><p id="b5aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">若要解决此问题，请在传递数字作为道具时使用花括号:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="e400" class="my lt iq mt b gy mz na l nb nc">&lt;UserDetails gender={0} /&gt;</span></pre><h1 id="a5f5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.直接修改状态</h1><p id="5b23" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">初学者最常见的错误之一是直接修改状态。像这样:</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="78da" class="my lt iq mt b gy mz na l nb nc">showButton() {<br/>  this.state.buttonVisibility = true;<br/>}</span></pre><p id="f699" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您直接更改状态，而反应系统并不知道。因此，它可能不会触发重新渲染。</p><p id="c096" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">反应状态应该是不可变的。如果您试图直接修改它，可能会出现错误或意外行为，就像在上面的示例中没有重新呈现UI一样。</p><p id="3fa5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要直接改变状态，应该用<code class="fe mq mr ms mt b">setState()</code>。它会告诉React，“嘿，伙计，我要改变一些东西。请注意。”然后，React将做好一切准备，以正确应对变化。</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="9222" class="my lt iq mt b gy mz na l nb nc">showButton() {<br/>  this.setState({ buttonVisibility: true });<br/>}</span></pre><h1 id="f222" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.在setState()之后使用状态的值</h1><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="ea30" class="my lt iq mt b gy mz na l nb nc">showAvatar() {<br/>  this.setState({avatarVisibility: true});</span><span id="21b6" class="my lt iq mt b gy nd na l nb nc">  if (this.state.avatarVisibility) {<br/>    // Do something<br/>  }<br/>}</span></pre><p id="c1c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你能指出上面片段的问题吗？</p><p id="d8f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那就是<code class="fe mq mr ms mt b">avatarVisibility</code>被<code class="fe mq mr ms mt b">setState()</code>更新后马上就用了。</p><p id="155f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么这是一个问题？</p><p id="b8d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个您可能没有注意到的细微错误，但是<code class="fe mq mr ms mt b">setState()</code>是异步工作的。</p><p id="a46a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着如果你使用<code class="fe mq mr ms mt b">setState()</code>来更新一个属性，改变可能不会立即生效。这就是为什么在更新后使用产权会导致意想不到的行为。</p><p id="d46b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，您可以通过使用<code class="fe mq mr ms mt b">setState()</code>的第二个参数来解决这个问题</p><pre class="kg kh ki kj gt mu mt mv mw aw mx bi"><span id="9c25" class="my lt iq mt b gy mz na l nb nc">showAvatar() {<br/>  this.setState({avatarVisibility: true}, () =&gt; {<br/>    if (this.state.avatarVisibility) {<br/>      // Do something<br/>    }<br/>  });<br/>}</span></pre><p id="9471" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过使用回调函数，您的计算将准确地工作，因为该回调函数将在状态更新后被调用。</p><h1 id="bb4b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="851c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">以上是您在使用React时可能会犯的常见错误。我希望这篇文章能帮助你避免所有这些错误，以确保一切工作正常。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="cbd8" class="ls lt iq bd lu lv nl lx ly lz nm mb mc jw nn jx me jz no ka mg kc np kd mi mj bi translated">进一步阅读</h1><div class="nq nr gp gr ns nt"><a href="https://medium.com/javascript-in-plain-english/9-helpful-github-repositories-for-web-development-you-should-follow-right-now-d3c9f84d7e2b" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">9个对Web开发有用的Github库，你应该马上关注</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">不要只是用Github来拉和推你的代码。</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kp nt"/></div></div></a></div><p id="56aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">加入我，了解更多关于编程的有用见解。T9】</p></div></div>    
</body>
</html>