<html>
<head>
<title>How to write tests for React in 2020 (Part One)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为2020年的React编写测试(第一部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-write-tests-for-react-in-2020-b27485e47a06?source=collection_archive---------0-----------------------#2020-06-02">https://javascript.plainenglish.io/how-to-write-tests-for-react-in-2020-b27485e47a06?source=collection_archive---------0-----------------------#2020-06-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8ed38605687da7d00af8a1503cfc48fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bsBVI4Ys_2mFqmgD"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kd ke kf"><p id="d71e" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">用react编写React测试推荐库— <a class="ae kc" href="https://jestjs.io/docs/en/tutorial-react" rel="noopener ugc nofollow" target="_blank"> Jest </a> &amp; <a class="ae kc" href="https://testing-library.com/docs/react-testing-library/intro" rel="noopener ugc nofollow" target="_blank"> React测试库</a>适合完全初学者。</p></blockquote><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/3beca0fa45a042e785e6e17068ed9574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eehiIZXjmqyrDo_QRjEgmQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="bd lk"><em class="ll">From </em></strong><a class="ae kc" href="https://reactjs.org/docs/test-utils.html#overview" rel="noopener ugc nofollow" target="_blank"><strong class="bd lk"><em class="ll">https://reactjs.org/docs/test-utils.html#overview</em></strong></a></figcaption></figure><p id="3a9e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated"><em class="ki">这篇文章的目标读者是那些刚刚开始学习React并且想知道如何用他们的React应用程序编写一些简单的测试的人。就像大多数人开始使用<code class="fe lp lq lr ls b">create-react-app</code>创建React应用一样，我也会开始使用它。</em></p><h1 id="a2bb" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">首先，让我们从默认的例子开始。</h1><p id="1412" class="pw-post-body-paragraph kg kh iq kj b kk mr km kn ko ms kq kr lm mt ku kv ln mu ky kz lo mv lc ld le ij bi translated"><strong class="kj ir">默认依赖</strong> <code class="fe lp lq lr ls b"><strong class="kj ir">create-react-app</strong></code> <strong class="kj ir"> (2020/05/22) </strong></p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="6364" class="na lu iq ls b gy nb nc l nd ne">"dependencies": {<br/>    "@testing-library/jest-dom": "^4.2.4",<br/>    "@testing-library/react": "^9.3.2",<br/>    "@testing-library/user-event": "^7.1.2",<br/>    "react": "^16.13.1",<br/>    "react-dom": "^16.13.1",<br/>    "react-scripts": "3.4.1"<br/>  }</span></pre><p id="a03b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">已经编写了一个测试来帮助您开始。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="d13a" class="na lu iq ls b gy nb nc l nd ne">// src/App.test.js<br/>import React from 'react';<br/>import { render } from '@testing-library/react';<br/>import App from './App';</span><span id="dca6" class="na lu iq ls b gy nf nc l nd ne">test('renders learn react link', () =&gt; {<br/>  const { getByText } = render(&lt;App /&gt;); //render is from @testing-library/react<br/>  const linkElement = getByText(/learn react/i);<br/>  expect(linkElement).toBeInTheDocument(); //expect assertion is from Jest<br/>});</span></pre><p id="9bb5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">如果您运行命令<code class="fe lp lq lr ls b">$ yarn test App</code>，您将会看到与下面类似的结果:</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/ac62ac3112d9382f977d05c73e43f7e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*jBpOs7fJN7ksulhMVUkaDw.png"/></div></figure><blockquote class="kd ke kf"><p id="9ed4" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">使用默认的<code class="fe lp lq lr ls b">create-react-app</code>设置，您可以开始编写一个测试，而不需要安装或配置任何东西。</p></blockquote><p id="daa7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">从上面的例子中，我们应该知道-</p><ul class=""><li id="400d" class="nh ni iq kj b kk kl ko kp lm nj ln nk lo nl le nm nn no np bi translated">我可以在哪里以及如何放置我的测试文件？——你可以看到在同一个文件夹中<code class="fe lp lq lr ls b">App.test.js</code>被放在<code class="fe lp lq lr ls b">App.js</code>的旁边，它在<code class="fe lp lq lr ls b">App</code>组件名后面加上<code class="fe lp lq lr ls b">.test.js</code>后缀作为文件名。这是<code class="fe lp lq lr ls b">create-react-app</code>团队建议的默认约定(<a class="ae kc" href="https://create-react-app.dev/docs/running-tests/#filename-conventions" rel="noopener ugc nofollow" target="_blank">链接此处</a>)。</li><li id="fdde" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><a class="ae kc" href="https://jestjs.io/docs/en/tutorial-react" rel="noopener ugc nofollow" target="_blank"> <strong class="kj ir"> Jest </strong> </a>和<a class="ae kc" href="https://testing-library.com/react" rel="noopener ugc nofollow" target="_blank"> <strong class="kj ir"> React测试库</strong> </a>是测试背后的工具链，默认都是自带create-react-app。</li></ul><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="c30a" class="na lu iq ls b gy nb nc l nd ne">// setupTests.js<br/>// Jest is importing from a global setup file if you wonder<br/>import '@testing-library/jest-dom/extend-expect';</span></pre></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="1d5b" class="lt lu iq bd lv lw oc ly lz ma od mc md me oe mg mh mi of mk ml mm og mo mp mq bi translated">其次，为NavBar组件编写一个测试。</h1><p id="10af" class="pw-post-body-paragraph kg kh iq kj b kk mr km kn ko ms kq kr lm mt ku kv ln mu ky kz lo mv lc ld le ij bi translated">我正在创建一个包含链接和标志的<code class="fe lp lq lr ls b">NavBar</code>组件。</p><p id="52d5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">首先，我将开始编写测试，而不编写实际的组件(测试驱动开发)。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="d9a6" class="na lu iq ls b gy nb nc l nd ne">// navBar.test.js<br/>import React from 'react'; <br/>// screen newer way to utilize query in 2020 <br/>import { render, screen } from '@testing-library/react'; <br/>import NavBar from './navBar'; // component to test</span><span id="7118" class="na lu iq ls b gy nf nc l nd ne">test('render about link', () =&gt; {<br/>  render(&lt;NavBar /&gt;);<br/>  expect(screen.getByText(/about/)).toBeInTheDocument();<br/>})</span></pre><p id="5a56" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">测试将首先失败，因为我还没有在<code class="fe lp lq lr ls b">navBar.js</code>组件中编写任何代码。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/b347b3836df1bdef81567620250ccd76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_FCL4b22BBRZEIDikaNUQ.png"/></div></div></figure><p id="03e8" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">然后让我们完成<code class="fe lp lq lr ls b">navBar.js</code>组件，现在测试应该通过了。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="d5c0" class="na lu iq ls b gy nb nc l nd ne">// navBar.js<br/>import React from 'react';</span><span id="c513" class="na lu iq ls b gy nf nc l nd ne">const NavBar = () =&gt; (<br/>  &lt;div className="navbar"&gt;<br/>    &lt;a href="#"&gt;<br/>      about<br/>    &lt;/a&gt;<br/>  &lt;/div&gt;<br/>);</span><span id="299d" class="na lu iq ls b gy nf nc l nd ne">export default NavBar;</span></pre><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/a2ee7f2634b4a5085cc83409e6144cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QSgMeQndHjoy6TOz5Wduuw.png"/></div></div></figure><p id="0347" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">现在，你应该学会:</p><ul class=""><li id="56e1" class="nh ni iq kj b kk kl ko kp lm nj ln nk lo nl le nm nn no np bi translated"><code class="fe lp lq lr ls b">expect( ... ).toBeInTheDocument()</code>断言出自戏言。</li><li id="af5c" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><code class="fe lp lq lr ls b">render(&lt;NavBar /&gt;);</code>和<code class="fe lp lq lr ls b">screen.getByText(/about/)</code>来自测试库。</li><li id="fbb4" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated">Jest和React测试库一起工作，使得在React中编写测试变得容易。</li><li id="d825" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><code class="fe lp lq lr ls b">screen.getByText(/about/)</code>使用“getByText”而不是通过类名选择是因为React测试库适应了关注用户体验而不是实现细节的思维模式。</li></ul><p id="9a4a" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">要了解更多关于扩展和改变测试的信息，您可以查看以下资源:</p><ul class=""><li id="1f50" class="nh ni iq kj b kk kl ko kp lm nj ln nk lo nl le nm nn no np bi translated"><a class="ae kc" href="https://jestjs.io/docs/en/tutorial-react" rel="noopener ugc nofollow" target="_blank">用React App测试Jest教程</a></li><li id="b505" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><a class="ae kc" href="https://testing-library.com/docs/react-testing-library/cheatsheet" rel="noopener ugc nofollow" target="_blank"> React测试库语法备忘单</a></li></ul><p id="0a33" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">现在让我们扩展测试和组件，使其更加真实-</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="1053" class="na lu iq ls b gy nb nc l nd ne">// navBar.test.js<br/>import React from 'react';<br/>import { render, screen } from '@testing-library/react';<br/>import NavBar from './navBar';</span><span id="9f04" class="na lu iq ls b gy nf nc l nd ne">// include as many test cases as you want here<br/>const links = [<br/>  { text: 'Home', location: "/" },<br/>  { text: 'Contact', location: "/contact" },<br/>  { text: 'About', location: "/about" },<br/>  { text: 'Search', location: "/search" },<br/>];</span><span id="379c" class="na lu iq ls b gy nf nc l nd ne">// I use test.each to iterate the test cases above<br/>test.each(links)(<br/>  "Check if Nav Bar have %s link.",<br/>  (link) =&gt; {<br/>    render(&lt;NavBar /&gt;);<br/>    //Ensure the text is in the dom, will throw error it can't find<br/>    const linkDom = screen.getByText(link.text); <br/>		<br/>    //use jest assertion to verify the link property<br/>    expect(linkDom).toHaveAttribute("href", link.location);<br/>  }<br/>);</span><span id="6cb3" class="na lu iq ls b gy nf nc l nd ne">test('Check if have logo and link to home page', () =&gt; {<br/>    render(&lt;NavBar /&gt;);<br/>    // get by TestId define in the navBar<br/>    const logoDom = screen.getByTestId(/company-logo/); <br/>    // check the link location<br/>    expect(logoDom).toHaveAttribute("href", "/"); <br/>    //check the logo image<br/>  expect(screen.getByAltText(/Company Logo/)).toBeInTheDocument(); <br/>});</span></pre><p id="f4fd" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">这是一个导航条组件通常的样子(可能需要添加一些样式)。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="c4ff" class="na lu iq ls b gy nb nc l nd ne">// navBar.js<br/>import React from 'react';</span><span id="94ca" class="na lu iq ls b gy nf nc l nd ne">const NavBar = () =&gt; (<br/>  &lt;div className="navbar"&gt;<br/>    &lt;a href="/" data-testid="company-logo"&gt;<br/>      &lt;img src="/logo.png" alt="Company Logo" /&gt;<br/>    &lt;/a&gt;</span><span id="f5f1" class="na lu iq ls b gy nf nc l nd ne">    &lt;ul&gt;<br/>      &lt;li&gt;<br/>        &lt;a href="/"&gt; Home &lt;/a&gt;<br/>      &lt;/li&gt;<br/>      &lt;li&gt;<br/>        &lt;a href="/about"&gt; About &lt;/a&gt;<br/>      &lt;/li&gt;<br/>      &lt;li&gt;<br/>        &lt;a href="/contact"&gt; Contact &lt;/a&gt;<br/>      &lt;/li&gt;<br/>      &lt;li&gt;<br/>        &lt;a href="/search"&gt; Search &lt;/a&gt;<br/>      &lt;/li&gt;<br/>    &lt;/ul&gt;<br/>  &lt;/div&gt;<br/>);</span><span id="1c0e" class="na lu iq ls b gy nf nc l nd ne">export default NavBar;</span></pre></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="dbc7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">好吧，写起来似乎很有趣，让我们写一个更复杂的。</p><h1 id="3db2" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">第三，编写一个注册表单组件测试。</h1><p id="a847" class="pw-post-body-paragraph kg kh iq kj b kk mr km kn ko ms kq kr lm mt ku kv ln mu ky kz lo mv lc ld le ij bi translated">在编写了静态内容的测试之后，让我们编写一个更动态内容的测试—注册表单。</p><p id="ec11" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">首先，让我们以TDD的方式思考——我们在这个注册表单中需要什么(不管它看起来如何):</p><ul class=""><li id="f274" class="nh ni iq kj b kk kl ko kp lm nj ln nk lo nl le nm nn no np bi translated">名称的输入字段，只允许3到30个长度的字符串。</li><li id="41dc" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated">电子邮件的输入字段，可以检查它是否是有效的电子邮件地址。</li><li id="2fad" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated">密码的输入字段，可以检查其复杂性(至少1个数字，1个小写字符串，1个大写字符串，1个特殊字符)</li><li id="b672" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated">提交按钮。</li><li id="d823" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated">以上3个输入都是必需的，不能为空。</li></ul><p id="b0cb" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">现在，让我们编写测试。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="8db5" class="na lu iq ls b gy nb nc l nd ne">/*  Prepare some test cases, ensure 90% edge cases are covered.<br/>    You can always change your test cases to fit your standard<br/>*/</span><span id="4666" class="na lu iq ls b gy nf nc l nd ne">const entries = [<br/>  { name: 'John', email: 'john_doe@yahoo', password: 'helloworld' },<br/>  { name: 'Jo', email: 'jo.msn.com', password: 'pa$$W0rd' },<br/>  { name: '', email: 'marry123@test.com', password: '123WX&amp;abcd' },<br/>  { name: 'kent'.repeat(10), email: 'kent@testing.com', password: 'w%oRD123yes' },<br/>  { name: 'Robert', email: 'robert_bell@example.com', password: 'r&amp;bsEc234E' },<br/>]</span></pre><p id="da7f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">接下来，建立测试的头骨。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="b485" class="na lu iq ls b gy nb nc l nd ne">// signupForm.test.js<br/>// this mostly a input validate test<br/>describe('Input validate', () =&gt; {<br/>/* <br/>   I use test.each to iterate every case again<br/>   I need use 'async' here because wait for <br/>   validation is await function <br/>*/ </span><span id="6219" class="na lu iq ls b gy nf nc l nd ne"> test.each(entries)('test with %s entry', async (entry) =&gt; { </span><span id="88be" class="na lu iq ls b gy nf nc l nd ne">    ...<br/> <br/>  })<br/>})</span></pre><p id="8ad4" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">接下来，让我们在测试中构建块。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="1aab" class="na lu iq ls b gy nb nc l nd ne">// signupForm.test.js<br/>...<br/>test.each(entries)('test with %s entry', async (entry) =&gt; { <br/>//render the component first (it will clean up for every iteration    <br/>render(&lt;SignupForm /&gt;); <br/>		<br/>/*  grab all the input elements. <br/>    I use 2 queries here because sometimes you can choose<br/>    how your UI look (with or without Label text) without<br/>    breaking the tests<br/>*/	 <br/>    const nameInput = screen.queryByLabelText(/name/i)<br/>      || screen.queryByPlaceholderText(/name/i);<br/>    const emailInput = screen.getByLabelText(/email/i)<br/>      || screen.queryByPlaceholderText(/email/i);<br/>    const passwordInput = screen.getByLabelText(/password/i)<br/>      || screen.queryByPlaceholderText(/password/i);<br/>		<br/>/* use fireEvent.change and fireEvent.blur <br/>   to change name input value<br/>   and trigger the validation<br/>*/<br/>    fireEvent.change(nameInput, { target: { value: entry.name } }); <br/>    fireEvent.blur(nameInput); </span><span id="d66a" class="na lu iq ls b gy nf nc l nd ne">/* first if-statement to check whether the name is input.<br/>   second if-statement to check whether the name is valid.<br/>   'checkName' is a utility function you can define by yourself.<br/>   I use console.log here to show what is being checked.  <br/>*/<br/>  if (entry.name.length === 0) {<br/>      expect(await screen.findByText(/name is required/i)).not.toBeNull();<br/>      console.log('name is required.');<br/>    }<br/>    else if (!checkName(entry.name)) {<br/>// if the name is invalid, error msg will showup somewhere<br/>    expect(await screen.findByText(/invalid name/i)).not.toBeNull();<br/>      console.log(entry.name + ' is invalid name.');<br/>    };<br/>		<br/>// With a similar structure, you can continue building the rest of the test.<br/>		...</span><span id="f4a2" class="na lu iq ls b gy nf nc l nd ne">/*  Remember to add this line at the end of your test to <br/>    avoid act wrapping warning.<br/>    More detail please checkout Kent C.Dodds's post:<br/>    (He is the creator of Testing Library)    &lt;https://kentcdodds.com/blog/fix-the-not-wrapped-in-act-warning&gt;<br/>*/<br/>  await act(() =&gt; Promise.resolve()); <br/>})<br/>...</span></pre><blockquote class="kd ke kf"><p id="3f61" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">完整的测试代码，请在这里找到<a class="ae kc" href="https://github.com/kelvin8773/react-test-examples/blob/master/src/components/signupForm.test.js" rel="noopener ugc nofollow" target="_blank">。</a></p></blockquote><p id="a73c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">好了，现在测试完成了(也许我们会回来做一些调整，但是现在让我们继续)，让我们写组件。</p><pre class="lg lh li lj gt mw ls mx my aw mz bi"><span id="8d03" class="na lu iq ls b gy nb nc l nd ne">// signupForm.js<br/>import React from 'react';<br/>/* <br/>I borrow the sample code from formik library with some adjustments<br/>&lt;https://jaredpalmer.com/formik/docs/overview#the-gist&gt;<br/>*/<br/>import { Formik } from 'formik';<br/>/* <br/>For validation check, I wrote 3 custom functions.<br/>(I use the same functions in test)<br/>*/<br/>import {<br/>  checkName,<br/>  checkEmail,<br/>  checkPassword,<br/>} from '../utilities/check';</span><span id="e17e" class="na lu iq ls b gy nf nc l nd ne">const SignupForm = () =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;Anywhere in your app!&lt;/h1&gt;<br/>    &lt;Formik<br/>      initialValues={{ name: '', email: '', password: '' }}<br/>      validate={values =&gt; {<br/>        const errors = {};<br/>        if (!values.name) {<br/>          errors.name = 'Name is Required'<br/>        } else if (!checkName(values.name)) {<br/>          errors.name = `invalid name`;<br/>        }</span><span id="e9cd" class="na lu iq ls b gy nf nc l nd ne">        if (!values.email) {<br/>          errors.email = 'Email is Required';<br/>        }<br/>        else if (!checkEmail(values.email)) {<br/>          errors.email = 'Invalid email address';<br/>        }</span><span id="b43c" class="na lu iq ls b gy nf nc l nd ne">        if (!values.password) {<br/>          errors.password = 'Password is Required';<br/>        } else if (!checkPassword(values.password)) {<br/>          errors.password = 'Password is too simple';<br/>        }</span><span id="7fb9" class="na lu iq ls b gy nf nc l nd ne">        return errors;<br/>      }}<br/>      onSubmit={(values, { setSubmitting }) =&gt; {<br/>        setTimeout(() =&gt; {<br/>          alert(JSON.stringify(values, null, 2));<br/>          setSubmitting(false);<br/>        }, 400);<br/>      }}<br/>    &gt;<br/>      {({<br/>        values,<br/>        errors,<br/>        touched,<br/>        handleChange,<br/>        handleBlur,<br/>        handleSubmit,<br/>        isSubmitting,<br/>        /* and other goodies */<br/>      }) =&gt; (<br/>          &lt;form onSubmit={handleSubmit}&gt;<br/>            &lt;label&gt;<br/>              Name:<br/>            &lt;input<br/>                type="text"<br/>                name="name"<br/>                placeholder="Enter your name here"<br/>                onChange={handleChange}<br/>                onBlur={handleBlur}<br/>                value={values.name}<br/>              /&gt;<br/>            &lt;/label&gt;</span><span id="6781" class="na lu iq ls b gy nf nc l nd ne">            &lt;p style={{ 'color': 'red' }}&gt;<br/>              {errors.name &amp;&amp; touched.name &amp;&amp; errors.name}<br/>            &lt;/p&gt;</span><span id="71fd" class="na lu iq ls b gy nf nc l nd ne">            &lt;label&gt;<br/>              Email:<br/>            &lt;input<br/>                type="email"<br/>                name="email"<br/>                placeholder="Your Email Address"<br/>                onChange={handleChange}<br/>                onBlur={handleBlur}<br/>                value={values.email}<br/>              /&gt;<br/>            &lt;/label&gt;<br/>            &lt;p style={{ 'color': 'red' }}&gt;<br/>              {errors.email &amp;&amp; touched.email &amp;&amp; errors.email}<br/>            &lt;/p&gt;</span><span id="94ac" class="na lu iq ls b gy nf nc l nd ne">            &lt;label&gt;<br/>              Password:<br/>            &lt;input<br/>                type="password"<br/>                name="password"<br/>                placeholder="password here"<br/>                onChange={handleChange}<br/>                onBlur={handleBlur}<br/>                value={values.password}<br/>              /&gt;<br/>            &lt;/label&gt;</span><span id="55e1" class="na lu iq ls b gy nf nc l nd ne">            &lt;p style={{ 'color': 'red' }}&gt;<br/>            {errors.password &amp;&amp; touched.password &amp;&amp; errors.password}<br/>            &lt;/p&gt;</span><span id="1a0c" class="na lu iq ls b gy nf nc l nd ne">            &lt;button type="submit" disabled={isSubmitting}&gt;<br/>              Submit<br/>          &lt;/button&gt;<br/>          &lt;/form&gt;<br/>        )}<br/>    &lt;/Formik&gt;<br/>  &lt;/div&gt;<br/>);</span><span id="6341" class="na lu iq ls b gy nf nc l nd ne">export default SignupForm;</span></pre><p id="b469" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">并且表单看起来类似于下图(没有太多的样式，但是对于我们的目的来说足够好了)。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/834ee5e3eb965fd7b9314c27750e409c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PgEgut8zpeqA4IeyQ14DWA.png"/></div></div></figure><p id="148d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">如果输入错误，错误信息将显示在输入下方:</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/5ecf93ebdbfc6fb4838e3fe844e9cd7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVORiBVkTm7TGiva2Ipf2Q.png"/></div></div></figure><p id="e536" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">如果您完成了上面的测试，现在测试应该全部通过，运行<code class="fe lp lq lr ls b">yarn test --verbose</code>，使用详细选项和console.log消息，您可以看到每个案例是如何被测试的，以及哪个是好案例，哪个不是。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/0552e48772d5f0851304921efaafc736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tlbVF9wesnwtH1n1qW1pLw.png"/></div></div></figure><p id="b5d0" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">如需更多测试代码示例和不同案例，请查看我的报告<a class="ae kc" href="https://github.com/kelvin8773/react-test-examples" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/830587e47fb3d4357eb4860179c3c0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zbsJOAK_yiZlJDEt"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@neonbrand?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">NeONBRAND</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="9cc6" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">最后的话。</h1><p id="6546" class="pw-post-body-paragraph kg kh iq kj b kk mr km kn ko ms kq kr lm mt ku kv ln mu ky kz lo mv lc ld le ij bi translated">对于初学者来说，一次学会所有的东西是很困难的，所以如果太难了，就慢下来。我至少花了整整一周的时间来学习基础知识，而这仅仅是为React应用程序编写测试的开始。</p><p id="a304" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">这是一个很难理解的话题，但是我相信如果你想成为一名专业的前端开发人员，花一些时间在这上面是值得的。</p><p id="fc34" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">好消息是，你已经有了一个良好的开端，你现在应该知道如何利用<strong class="kj ir"> Jest </strong>和<strong class="kj ir"> React测试库</strong>来围绕你的React组件编写测试，并且你可以在这个良好的基础上开始探索其他库和解决方案。</p><p id="ac93" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated">如果我对这篇文章得到了积极的反馈，我计划写另一篇文章来介绍更多的例子，再次感谢您的时间。</p><h2 id="2d86" class="na lu iq bd lv on oo dn lz op oq dp md lm or os mh ln ot ou ml lo ov ow mp ox bi translated">我在撰写本文时参考的资源</h2><ul class=""><li id="4a41" class="nh ni iq kj b kk mr ko ms lm oy ln oz lo pa le nm nn no np bi translated">【React测试的常见错误作者<a class="ae kc" href="https://kentcdodds.com/" rel="noopener ugc nofollow" target="_blank">肯特·c·多兹</a></li><li id="2ee3" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><a class="ae kc" href="https://kentcdodds.com/blog/fix-the-not-wrapped-in-act-warning" rel="noopener ugc nofollow" target="_blank">由<a class="ae kc" href="https://kentcdodds.com/" rel="noopener ugc nofollow" target="_blank">肯特·c·多兹</a>修复未包装动作警告</a></li><li id="3b00" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><a class="ae kc" href="https://medium.com/@boyney123/my-experience-moving-from-enzyme-to-react-testing-library-5ac65d992ce" rel="noopener">我从酶到反应测试库的经验</a>(关于反应测试使用哪个库的意见)</li><li id="7570" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><a class="ae kc" href="https://testing-library.com/docs/recipes" rel="noopener ugc nofollow" target="_blank">测试库配方</a>(许多了解库的好资源)</li><li id="f0ca" class="nh ni iq kj b kk nq ko nr lm ns ln nt lo nu le nm nn no np bi translated"><a class="ae kc" href="https://dev.to/jkettmann/inside-a-dev-s-mind-refactoring-and-debugging-a-react-test-2jap" rel="noopener ugc nofollow" target="_blank">在开发人员的头脑中——重构和调试React测试</a>作者<a class="ae kc" href="https://jkettmann.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kj ir">约翰尼斯·凯特曼</strong> </a> <strong class="kj ir"> </strong>(我是从这篇文章开始学习React测试的，但它要高级得多，我将在后面写更多)</li></ul><h2 id="6d81" class="na lu iq bd lv on oo dn lz op oq dp md lm or os mh ln ot ou ml lo ov ow mp ox bi translated">特别感谢<a class="ae kc" href="https://ooloo.io/" rel="noopener ugc nofollow" target="_blank"> ooloo.io </a>和<a class="ae kc" href="https://dev.to/jkettmann" rel="noopener ugc nofollow" target="_blank"> Johannes Kettmann </a></h2><blockquote class="kd ke kf"><p id="8308" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">对于想成为一名工作就绪的前端开发人员的人来说，我会推荐尝试一门来自<a class="ae kc" href="https://ooloo.io/" rel="noopener ugc nofollow" target="_blank"> ooloo.io </a>的课程。它介绍了一些概念，例如——创建像素级完美的设计、规划和实现复杂的UI组件、在ide中调试，以及<a class="ae kc" href="https://dev.to/jkettmann/inside-a-dev-s-mind-refactoring-and-debugging-a-react-test-2jap" rel="noopener ugc nofollow" target="_blank">编写集成测试</a>，这些在大多数在线教程或课程中是看不到的。是的，我从这门课中得到了很多启发，最终帮助我写下了这篇文章。</p></blockquote><p id="d676" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lm kt ku kv ln kx ky kz lo lb lc ld le ij bi translated"><strong class="kj ir"> <em class="ki">本文原帖</em></strong><a class="ae kc" href="https://dev.to/kelvin9877/how-to-write-tests-for-react-in-2020-4oai" rel="noopener ugc nofollow" target="_blank"><strong class="kj ir"><em class="ki">dev . to</em></strong></a></p></div></div>    
</body>
</html>