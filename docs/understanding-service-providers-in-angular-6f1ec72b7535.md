# 从角度理解服务提供商

> 原文：<https://javascript.plainenglish.io/understanding-service-providers-in-angular-6f1ec72b7535?source=collection_archive---------2----------------------->

## 看看在 Angular 中提供服务的不同方式

![](img/81b99671680c9ea633b15ca45c5c5edb.png)

Photo by [Erik Mclean](https://unsplash.com/@introspectivedsgn?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

在本指南中，我们将了解在 Angular 应用程序中提供服务的不同方式。您选择提供服务的方法将决定您的服务的范围和对其依赖者的可见性。

在 Angular 中，服务可以是您的应用程序需要的简单值、函数或特性。然而，在大多数情况下，Angular 中的服务是执行某些特定功能的类。

为了能够通过依赖注入使用服务，您必须至少向一个提供者注册它。

在 Angular 中，有三种主要的方法可以让您的服务对其依赖者可用。

# 在 Angular 中创建服务

要在 Angular 项目中创建服务，可以运行以下 CLI 命令。

```
ng generate service car-list 
```

其中 ***car-list*** 是我们想要用上面的命令创建的服务的名称。

上面的命令创建的典型服务如下所示。

现在，我们已经创建了一个服务，让我们看看如何使它对其依赖者可用。

# 通过根注入器提供服务

默认情况下，当您通过 CLI 创建一个 Angular 服务时，正如我们在上面所做的，它会注册到根注入器。

在上面的服务中，通过指定`providedIn:'root'`。我们告诉 Angular 在根级别提供服务。

下面是通过根注入器注册的服务的一些重要特征。

*   它们可用于任何通过依赖注入请求服务的类。
*   Angular 为整个应用程序创建一个共享的服务实例(singleton)。
*   此外，当服务没有被任何其他类请求时，会进行一些树抖动。

**注意**:要在一个组件中使用一个服务，只需简单地导入它，然后将它注入到构造函数中，如下所示。

但是，如果您想在应用程序中限制服务的范围，该怎么做呢？在下面的小节中，我将讨论如何在模块或组件级别提供服务。

# 提供模块级别的服务

提供服务的另一种方法是只在模块级别提供服务。这意味着除非您指定，否则该服务对应用程序的其他模块不可用。

例如，让我们在上面创建的 car-list 服务只在应用程序的 CarModule 中可用。首先，导入我们希望使服务在其中可用的模块。然后在服务元数据中，我们将提供如下的模块名称。

为了使服务在模块中可用，然后在`*@NgModule*`元数据的`*providers*`数组中注册服务，如下所示。另外，一定要记住导入您想要在模块中注册的服务。

惰性加载是 Angular 中的一个流行概念。使用延迟加载，你只在需要的时候加载一个模块，而不是在应用程序启动的时候。

从 Angular version 9 开始，您可以通过为每个延迟加载的模块提供一个新的 as 服务实例来充分利用延迟加载。要实现这一点，您可以使用带有`*providedIn*`属性的`*any*`关键字，如下所示。

当你使用`providedIn: 'any'`提供服务时，所有急切加载的模块共享一个单例实例；然而，惰性加载模块每个都有一个唯一的服务实例。

# 提供组件级别的服务

您还可以将服务的范围限制为某个特定的组件。

Angular 为创建的每个组件实例创建一个新的服务实例。

在组件中注册的服务仅对组件及其子代可用。

要将服务的范围仅限于其组件，您应该向组件的提供者数组注册它。

# 结论

大多数情况下，您会希望向根提供者注册您的服务，以使服务在整个应用程序中可用。

要限制角度服务的范围，可以考虑在模块或组件级别注册服务。