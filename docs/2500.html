<html>
<head>
<title>Solving Common Vue Problems — List Filtering, Global Libraries, Vuex, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决常见的Vue问题—列表过滤、全局库、Vuex等等</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/solving-common-vue-problems-list-filtering-global-libraries-vuex-and-more-73e14f0cd6be?source=collection_archive---------10-----------------------#2020-06-29">https://javascript.plainenglish.io/solving-common-vue-problems-list-filtering-global-libraries-vuex-and-more-73e14f0cd6be?source=collection_archive---------10-----------------------#2020-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6ea72633bc55133ba7382a2e3321158b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WtBqbv2uYv8N3qj5"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@thecreative_exchange?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">The Creative Exchange</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7ae0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="1fc1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过滤Vue组件中的列表</h1><p id="aad5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">筛选列表的正确方法是使用计算属性。</p><p id="0386" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为计算的属性在运行<code class="fe me mf mg mh b">v-for</code>之前返回值。</p><p id="0aa7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="88c6" class="mq lc iq mh b gy mr ms l mt mu">computed: {<br/>  filteredItems() {<br/>    return this.items.filter(item =&gt; item.type.toLowerCase().includes(this.search.toLowerCase()))<br/>  }<br/>}</span></pre><p id="666f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将过滤逻辑放在<code class="fe me mf mg mh b">filterItems</code>计算的属性中。</p><p id="6bd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下代码来遍历计算出的属性:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8bb5" class="mq lc iq mh b gy mr ms l mt mu">&lt;div v-for="item of filteredItems" &gt;<br/>  &lt;p&gt;{{item.name}}&lt;/p&gt;<br/>&lt;/div&gt;</span></pre><p id="bff3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是将<code class="fe me mf mg mh b">filteredItems</code>计算的属性作为变量传入模板。</p><h1 id="6113" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在Vue组件中进行HTTP调用</h1><p id="ed18" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用Fetch API或Axios等第三方HTTP客户端库在Vue组件中进行HTTP调用。</p><p id="efac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0373" class="mq lc iq mh b gy mr ms l mt mu">methods: {<br/>  async getData(){<br/>    const res = await fetch('/some/url')<br/>    const data = await res.json();<br/>    this.data = data;<br/>  }<br/>}</span></pre><p id="9e0c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">fetch</code>返回一个承诺，所以我们可以用<code class="fe me mf mg mh b">async </code>和<code class="fe me mf mg mh b">await </code>来表示。</p><h1 id="2e33" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从URL中删除哈希</h1><p id="a4e6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用历史模式从Vue路由器生成的URL中删除哈希。</p><p id="2962" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要启用它，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9905" class="mq lc iq mh b gy mr ms l mt mu">const router = new VueRouter({<br/>  mode: 'history'<br/>})</span></pre><p id="d164" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">mode</code>设置为<code class="fe me mf mg mh b">'history'</code>，这样我们就可以移除散列。</p><h1 id="03c4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">听道具变化</h1><p id="dd17" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用观察器来监听道具的变化。</p><p id="0d09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了给道具添加一个监视器，我们可以给<code class="fe me mf mg mh b">watch</code>属性添加一个方法。</p><p id="724f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="06d7" class="mq lc iq mh b gy mr ms l mt mu">{<br/>  ...<br/>  <!-- -->props: ['myProp'],<br/>  watch: { <br/>    myProp(newVal, oldVal) { <br/>      console.log(newVal, oldVal)<br/>    }<br/>  }<br/>  ...<br/>}</span></pre><p id="0d21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">watch</code>属性和<code class="fe me mf mg mh b">myProp</code>属性，如<code class="fe me mf mg mh b">props</code>属性的值所示。</p><p id="87cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是做了一个与prop同名的方法，带有一个分别接受新值和旧值的签名。</p><p id="23be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们获取<code class="fe me mf mg mh b">newVal</code>值以获得新值，获取<code class="fe me mf mg mh b">oldVal</code>值以获得旧值。</p><p id="0e16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了在设置了prop值时立即开始观察，我们可以添加<code class="fe me mf mg mh b">immediate</code>属性并将其设置为<code class="fe me mf mg mh b">true</code>。</p><p id="af1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6edf" class="mq lc iq mh b gy mr ms l mt mu">watch: {<br/>  myProp: {<br/>    immediate: true, <br/>    handler (val, oldVal) {<br/>      // ...<br/>    }<br/>  }<br/>}</span></pre><h1 id="4d89" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">跨任何组件的通信</h1><p id="80a9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">this.$dispatch</code>方法在任何组件之间进行通信，以分派一个传播到所有组件的事件。</p><p id="3add" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以使用<code class="fe me mf mg mh b">this.$on</code>来监听由<code class="fe me mf mg mh b">this.$dispatch</code>发送的事件。</p><p id="715a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以在一个组件中编写以下内容:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0df4" class="mq lc iq mh b gy mr ms l mt mu">export default {<br/>  ...<br/>  <!-- -->created() {<br/>    this.$dispatch('child-created', this)<br/>  }<br/>  ...<br/>}</span></pre><p id="b274" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在另一个组件中，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="05a4" class="mq lc iq mh b gy mr ms l mt mu">export default {<br/>  ...<br/>  <!-- -->created() {<br/>    this.$on('child-created', (child) =&gt; {<br/>      console.log(child)<br/>    })<br/>  }<br/>  ...<br/>}</span></pre><p id="43ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">created</code>钩子中发出事件，这样当组件被创建但DOM内容还没有被加载时，事件就会被发出。</p><p id="afd1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第二个组件中，我们在<code class="fe me mf mg mh b">created</code>钩子中添加了事件监听器，这样一旦组件代码被加载，我们就可以监听事件。</p><p id="e4e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">child-created</code>是事件名称。</p><p id="157c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">child</code>参数在<code class="fe me mf mg mh b">$dispatch</code>的第二个自变量中有事件数据。</p><h1 id="9db7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在Vue应用程序中全局使用Axios</h1><p id="a1c4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了使Axios全球可用，我们可以在创建<code class="fe me mf mg mh b">Vue</code>实例之前将其设置为<code class="fe me mf mg mh b">Vue.prototype</code>的属性。</p><p id="80fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，如果我们创建了<code class="fe me mf mg mh b">Vue</code>实例，它将与<code class="fe me mf mg mh b">Vue</code>实例一起返回。</p><p id="fca5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="04cb" class="mq lc iq mh b gy mr ms l mt mu">import Axios from 'axios'</span><span id="41ae" class="mq lc iq mh b gy mv ms l mt mu">Vue.prototype.$http = Axios;</span></pre><p id="4f5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的组件中，我们可以通过使用<code class="fe me mf mg mh b">this.$http</code>变量来访问它。</p><p id="2535" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们想发出一个get请求，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1744" class="mq lc iq mh b gy mr ms l mt mu">this.$http.get('https://example.com')</span></pre><h1 id="87f3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Vuex动作vs突变</h1><p id="911d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Vuex变异是同步代码，接受一个名称和一个处理程序。</p><p id="edb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它用于更新状态。</p><p id="1358" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="013b" class="mq lc iq mh b gy mr ms l mt mu">import Vuex from 'vuex'</span><span id="9ba3" class="mq lc iq mh b gy mv ms l mt mu">const store = new Vuex.Store({<br/>  state: {<br/>    count: 1<br/>  },<br/>  mutations: {<br/>    increment(state) {<br/>      state.count++<br/>    }<br/>  }<br/>})</span></pre><p id="20ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当我们调度<code class="fe me mf mg mh b">'increment'</code>动作时<code class="fe me mf mg mh b">state.count++</code>更新<code class="fe me mf mg mh b">count</code>状态。</p><p id="7a4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个动作就像一个突变，但是它可以调度多个突变。</p><p id="c86e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它也可以是异步的。</p><p id="320b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fa15" class="mq lc iq mh b gy mr ms l mt mu">incrementBy({ dispatch }, amount) {<br/>  dispatch('INCREMENT', amount)<br/>}</span></pre><p id="e3c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">dispatch</code>功能是调度突变的功能。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/92f6495e338856ac2cae784608f48900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RPxcRWZkeAm_zHu_"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@natthornley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Natalie Thornley</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5fb8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="71b3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Vuex动作和突变是有区别的。</p><p id="1a85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要过滤项目，我们应该在计算属性中进行。</p><p id="43b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以把东西放到<code class="fe me mf mg mh b">Vue.prototype</code>中，让它们在全球范围内可用。</p><h2 id="f154" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript</strong></h2><p id="db07" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>