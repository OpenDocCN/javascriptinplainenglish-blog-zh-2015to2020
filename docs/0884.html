<html>
<head>
<title>How to Add Graphs and Charts to an Angular App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向Angular应用程序添加图形和图表</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-add-graphs-and-charts-to-an-angular-app-508ac895067f?source=collection_archive---------4-----------------------#2019-12-28">https://javascript.plainenglish.io/how-to-add-graphs-and-charts-to-an-angular-app-508ac895067f?source=collection_archive---------4-----------------------#2019-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="65a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图形和图表是许多应用程序的常见功能。从零开始制作它们会非常困难，因为有这么多类型的图形和图表，你必须得到数据并把它们都画在屏幕上。还需要将它们缩放到不同的屏幕尺寸，这增加了从头制作图表的难度。</p><p id="1888" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，许多人已经走到一起解决这个问题。在Angular中，我们可以使用基于角度图表的图表库angular2-charts，位于<a class="ae kl" href="https://github.com/emn178/angular2-chartjs" rel="noopener ugc nofollow" target="_blank">https://github.com/emn178/angular2-chartjs</a>。</p><p id="04f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它基于许多web应用程序使用的流行的Chart.js库。它支持添加折线图、条形图、饼图、圆环图，以及不同种类的填充和颜色。完整的图表列表在https://www.chartjs.org/samples/latest/上。</p><p id="9029" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将构建一个有角度的比特币app，显示不同国家的货币与比特币之间的最新和历史汇率。我们将显示历史汇率的折线图。用户可以按不同的货币和日期范围过滤历史汇率。</p><p id="8019" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了获得货币列表，我们使用位于<a class="ae kl" href="https://docs.openexchangerates.org/docs/currencies-json" rel="noopener ugc nofollow" target="_blank">https://docs.openexchangerates.org/docs/currencies-json</a>的开放汇率API <code class="fe km kn ko kp b">currencies</code>端点。我们从位于https://www.coindesk.com/api的Coindesk API获取比特币数据。</p><p id="e898" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将通过运行以下命令创建一个Angular应用程序:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="7d74" class="ky kz iq kp b gy la lb l lc ld">ng new bitcoin-app</span></pre><p id="52ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当向导运行时，我们选择包含路由，并为CSS预处理程序选择SCSS。接下来，我们安装一些我们需要的包。我们需要<code class="fe km kn ko kp b">angular2-chartjs</code>用于图表，MobX用于状态管理，Ngx-Bootstrap用于样式化。要安装它们，我们运行:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="f15c" class="ky kz iq kp b gy la lb l lc ld">npm i angular2-chartjs mobx mobx-angular ngx-bootstrap</span></pre><p id="bc0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们准备开始构建应用程序。我们通过运行以下命令来创建组件、服务和MobX商店:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="5634" class="ky kz iq kp b gy la lb l lc ld">ng g component historicRatesPage<br/>ng g component homePage<br/>ng g service bitcoin<br/>ng g class currenciesStore</span></pre><p id="36a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建好一切后，我们准备添加一些代码。首先，我们转到<code class="fe km kn ko kp b">historic-rates-page.component.html</code>文件并添加:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="5c5a" class="ky kz iq kp b gy la lb l lc ld">&lt;form<br/>  (ngSubmit)="getHistoricRates(historicRateForm)"<br/>  #historicRateForm="ngForm"<br/>&gt;<br/>  &lt;h1 class="text-center"&gt;Historical Rates&lt;/h1&gt;<br/>  &lt;div class="form-group"&gt;<br/>    &lt;label&gt;Currency&lt;/label&gt;<br/>    &lt;select<br/>      class="form-control"<br/>      #currency="ngModel"<br/>      name="currency"<br/>      [(ngModel)]="form.currency"<br/>      required<br/>    &gt;<br/>      &lt;option *ngFor="let c of currencies" [value]="c.value"&gt;<br/>        {{ c.name }}<br/>      &lt;/option&gt;<br/>    &lt;/select&gt;<br/>    &lt;div *ngIf="currency?.invalid &amp;&amp; (currency.dirty || currency.touched)"&gt;<br/>      &lt;div *ngIf="currency.errors.required"&gt;<br/>        Currency is required.<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="31df" class="ky kz iq kp b gy le lb l lc ld">&lt;div class="form-group"&gt;<br/>    &lt;label&gt;Start Date&lt;/label&gt;<br/>    &lt;input<br/>      type="text"<br/>      class="form-control"<br/>      placeholder="Start Date"<br/>      #startDate="ngModel"<br/>      name="startDate"<br/>      [(ngModel)]="form.startDate"<br/>      required<br/>      pattern="([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))"<br/>    /&gt;<br/>    &lt;div *ngIf="startDate?.invalid &amp;&amp; (startDate.dirty || startDate.touched)"&gt;<br/>      &lt;div *ngIf="startDate.errors.required"&gt;<br/>        Start date is required.<br/>      &lt;/div&gt;<br/>      &lt;div *ngIf="startDate.invalid"&gt;<br/>        Start date is invalid.<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="f1d0" class="ky kz iq kp b gy le lb l lc ld">&lt;div class="form-group"&gt;<br/>    &lt;label&gt;End Date&lt;/label&gt;<br/>    &lt;input<br/>      type="text"<br/>      class="form-control"<br/>      placeholder="End Date"<br/>      #endDate="ngModel"<br/>      name="endDate"<br/>      [(ngModel)]="form.endDate"<br/>      required<br/>      pattern="([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))"<br/>    /&gt;<br/>    &lt;div *ngIf="endDate?.invalid &amp;&amp; (endDate.dirty || endDate.touched)"&gt;<br/>      &lt;div *ngIf="endDate.errors.required"&gt;<br/>        End date is required.<br/>      &lt;/div&gt;<br/>      &lt;div *ngIf="endDate.invalid"&gt;<br/>        End date is invalid.<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="be09" class="ky kz iq kp b gy le lb l lc ld">&lt;button class="btn btn-primary"&gt;Get Historic Rates&lt;/button&gt;<br/>&lt;/form&gt;</span><span id="dbe1" class="ky kz iq kp b gy le lb l lc ld">&lt;br /&gt;<br/>&lt;chart type="line" [data]="data" [options]="options"&gt;&lt;/chart&gt;</span></pre><p id="f763" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个文件的表单允许用户输入货币和日期范围，以便查找历史汇率。<code class="fe km kn ko kp b">chart</code>组件是我们用来显示折线图的<code class="fe km kn ko kp b">angular2-chartjs</code>组件。我们指定我们想要一个折线图。<code class="fe km kn ko kp b">data </code>和<code class="fe km kn ko kp b">options</code>在我们将要编写的组件代码中。</p><p id="2ed1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在表单中，我们在开始和结束日期输入中使用了该模式，以确保用户在提交日期之前以YYYY-MM-DD模式输入日期。我们还要求所有的表单字段。</p><p id="a934" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">historic-rates-page.component.ts</code>中，我们替换现有代码:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="a21c" class="ky kz iq kp b gy la lb l lc ld">import { Component, OnInit } from '<a class="ae kl" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { currenciesStore } from '../currencies-store';<br/>import { BitcoinService } from '../bitcoin.service';<br/>import { NgForm } from '<a class="ae kl" href="http://twitter.com/angular/forms" rel="noopener ugc nofollow" target="_blank">@angular/forms</a>';</span><span id="c3e0" class="ky kz iq kp b gy le lb l lc ld"><a class="ae kl" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-historic-rates-page',<br/>  templateUrl: './historic-rates-page.component.html',<br/>  styleUrls: ['./historic-rates-page.component.scss']<br/>})<br/>export class HistoricRatesPageComponent implements OnInit {<br/>  store = currenciesStore;<br/>  form: any = &lt;any&gt;{<br/>    currency: 'USD',<br/>    startDate: '',<br/>    endDate: ''<br/>  }<br/>  currencies: any[] = [];<br/>  data: any = &lt;any&gt;{<br/>    labels: [],<br/>    datasets: []<br/>  };<br/>  options = {<br/>    responsive: true,<br/>    maintainAspectRatio: false<br/>  };</span><span id="5f2d" class="ky kz iq kp b gy le lb l lc ld">  constructor(private bitcoinService: BitcoinService) { }</span><span id="a614" class="ky kz iq kp b gy le lb l lc ld">  ngOnInit() {<br/>    if (Object.keys(this.store.currencies).length == 0) {<br/>      this.getCurrencies();<br/>    }<br/>    else {<br/>      this.currencies = Object.keys(this.store.currencies).map(key =&gt; ({<br/>        name: this.store.currencies[key],<br/>        value: key<br/>      }))<br/>    }<br/>  }</span><span id="c014" class="ky kz iq kp b gy le lb l lc ld">  getCurrencies() {<br/>    this.bitcoinService.getCurrencies()<br/>      .subscribe(res =&gt; {<br/>        this.store.setCurrencies(res);<br/>        this.currencies = Object.keys(this.store.currencies).map(key =&gt; ({<br/>          name: this.store.currencies[key],<br/>          value: key<br/>        }))<br/>      }, err =&gt; {</span><span id="13ac" class="ky kz iq kp b gy le lb l lc ld">}, () =&gt; {</span><span id="e3de" class="ky kz iq kp b gy le lb l lc ld">})<br/>  }</span><span id="4d86" class="ky kz iq kp b gy le lb l lc ld">  getHistoricRates(historicRateForm: NgForm) {<br/>    if (historicRateForm.invalid) {<br/>      return;<br/>    }<br/>    const { currency, startDate, endDate } = this.form;<br/>    this.bitcoinService.getHistoricRates(currency, startDate, endDate)<br/>      .subscribe((res: any) =&gt; {<br/>        this.data = {<br/>          labels: Object.keys(res.bpi),<br/>          datasets: [<br/>            {<br/>              label: `${currency} to BTC - ${startDate} to ${endDate}`,<br/>              data: Object.keys(res.bpi).map(key =&gt; res.bpi[key]),<br/>              backgroundColor: 'green'<br/>            }<br/>          ]<br/>        }<br/>      })<br/>  }</span><span id="a477" class="ky kz iq kp b gy le lb l lc ld">}</span></pre><p id="5d6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们从我们的MobX商店获取货币，如果它们被加载的话。如果不是，我们会把它们拿到店里。我们将store对象映射到<code class="fe km kn ko kp b">this.currencies</code>,这样我们得到的是一个数组而不是一个对象，我们用它来填充货币下拉列表。</p><p id="3c07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果需要，我们运行<code class="fe km kn ko kp b">getCurrencies</code>函数来获取货币。当用户提交表单时，我们运行<code class="fe km kn ko kp b">getHistoricRates</code>函数来获取数据并对其进行处理，这样它们就可以用<code class="fe km kn ko kp b">angular2-chartjs.</code>显示出来。数据必须与我们在代码中的结构相同。</p><p id="d6b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">datasets</code>数组可以有多个条目，具有相同结构的对象显示多行。<code class="fe km kn ko kp b">backgroundColor</code>是可选的。</p><p id="f1bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们修改<code class="fe km kn ko kp b">home-page.component.html</code>，将现有代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="4f00" class="ky kz iq kp b gy la lb l lc ld">&lt;form&gt;<br/>  &lt;h1 class="text-center"&gt;Latest Rates&lt;/h1&gt;<br/>  &lt;div class="form-group"&gt;<br/>    &lt;label&gt;Currency&lt;/label&gt;<br/>    &lt;select<br/>      class="form-control"<br/>      #currency="ngModel"<br/>      name="currency"<br/>      [(ngModel)]="form.currency"<br/>      required<br/>      (change)="getLatestRates()"<br/>    &gt;<br/>      &lt;option *ngFor="let c of currencies" [value]="c.value"&gt;<br/>        {{ c.name }}<br/>      &lt;/option&gt;<br/>    &lt;/select&gt;<br/>    &lt;div *ngIf="currency?.invalid &amp;&amp; (currency.dirty || currency.touched)"&gt;<br/>      &lt;div *ngIf="currency.errors.required"&gt;<br/>        Currency is required.<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/form&gt;</span><span id="9528" class="ky kz iq kp b gy le lb l lc ld">&lt;div class="card" *ngIf="rate?.bpi"&gt;<br/>  &lt;div class="card-body"&gt;<br/>    &lt;h5 class="card-title"&gt;{{ form.currency }} to BTC&lt;/h5&gt;<br/>    &lt;p class="card-text"&gt;<br/>      {{ rate.bpi[form.currency].description }}<br/>    &lt;/p&gt;<br/>    &lt;p class="card-text"&gt;Rate: {{ rate.bpi[form.currency].rate }}&lt;/p&gt;<br/>    &lt;p class="card-text"&gt;<br/>      Rate Float: {{ rate.bpi[form.currency].rate_float }}<br/>    &lt;/p&gt;<br/>    &lt;p class="card-text"&gt;Updated: {{ rate.time.updated }}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="7d1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有一个货币下拉菜单，用户可以选择。当选择改变时，我们得到所选货币和比特币之间的最新汇率。价格显示在卡片上。</p><p id="6a49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">home-page.component.ts</code>中，我们将现有代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="14da" class="ky kz iq kp b gy la lb l lc ld">import { Component, OnInit } from '<a class="ae kl" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { currenciesStore } from '../currencies-store';<br/>import { BitcoinService } from '../bitcoin.service';</span><span id="2322" class="ky kz iq kp b gy le lb l lc ld"><a class="ae kl" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-home-page',<br/>  templateUrl: './home-page.component.html',<br/>  styleUrls: ['./home-page.component.scss']<br/>})<br/>export class HomePageComponent implements OnInit {<br/>  store = currenciesStore;<br/>  form: any = &lt;any&gt;{}<br/>  currencies: any[] = [];<br/>  rate: any = &lt;any&gt;{};</span><span id="0542" class="ky kz iq kp b gy le lb l lc ld">constructor(private bitcoinService: BitcoinService) { }</span><span id="d36d" class="ky kz iq kp b gy le lb l lc ld">  ngOnInit() {<br/>    this.form.currency = 'USD';<br/>    if (Object.keys(this.store.currencies).length == 0) {<br/>      this.getCurrencies();<br/>    }<br/>    else {<br/>      this.currencies = Object.keys(this.store.currencies).map(key =&gt; ({<br/>        name: this.store.currencies[key],<br/>        value: key<br/>      }))<br/>      this.getLatestRates();<br/>    }<br/>  }</span><span id="adf4" class="ky kz iq kp b gy le lb l lc ld">  getCurrencies() {<br/>    this.bitcoinService.getCurrencies()<br/>      .subscribe(res =&gt; {<br/>        this.store.setCurrencies(res);<br/>        this.currencies = Object.keys(this.store.currencies).map(key =&gt; ({<br/>          name: this.store.currencies[key],<br/>          value: key<br/>        }))<br/>      }, err =&gt; {</span><span id="88e6" class="ky kz iq kp b gy le lb l lc ld">}, () =&gt; {<br/>        this.getLatestRates()<br/>      })<br/>  }</span><span id="2af1" class="ky kz iq kp b gy le lb l lc ld">  getLatestRates() {<br/>    this.bitcoinService.getLatestRates(this.form.currency)<br/>      .subscribe(res =&gt; {<br/>        this.rate = res;<br/>      })<br/>  }</span><span id="9385" class="ky kz iq kp b gy le lb l lc ld">}</span></pre><p id="c950" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有与<code class="fe km kn ko kp b">historic-rates-page</code>组件工作方式相同的<code class="fe km kn ko kp b">getCurrencies</code>函数，以及我们在<code class="fe km kn ko kp b">change</code>事件的模板中引用的<code class="fe km kn ko kp b">getLatestRates</code>。</p><p id="3420" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">app-routing.module.ts</code>中，我们输入:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="4b8b" class="ky kz iq kp b gy la lb l lc ld">import { NgModule } from '<a class="ae kl" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { Routes, RouterModule } from '<a class="ae kl" href="http://twitter.com/angular/router" rel="noopener ugc nofollow" target="_blank">@angular/router</a>';<br/>import { HomePageComponent } from './home-page/home-page.component';<br/>import { HistoricRatesPageComponent } from './historic-rates-page/historic-rates-page.component';</span><span id="c4ea" class="ky kz iq kp b gy le lb l lc ld">const routes: Routes = [<br/>  { path: '', component: HomePageComponent },<br/>  { path: 'historicrates', component: HistoricRatesPageComponent },<br/>];</span><span id="521e" class="ky kz iq kp b gy le lb l lc ld"><a class="ae kl" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  imports: [RouterModule.forRoot(routes)],<br/>  exports: [RouterModule]<br/>})<br/>export class AppRoutingModule { }</span></pre><p id="c433" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，当用户点击链接或输入URL时，他们可以看到我们刚刚添加的页面。</p><p id="704f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">app.component.html</code>中，我们放入:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="044d" class="ky kz iq kp b gy la lb l lc ld">&lt;nav class="navbar navbar-expand-lg navbar-light bg-light"&gt;<br/>  &lt;a class="navbar-brand" routerLink="/"&gt;Bitcoin App&lt;/a&gt;<br/>  &lt;button<br/>    class="navbar-toggler"<br/>    type="button"<br/>    data-toggle="collapse"<br/>    data-target="#navbarSupportedContent"<br/>    aria-controls="navbarSupportedContent"<br/>    aria-expanded="false"<br/>    aria-label="Toggle navigation"<br/>  &gt;<br/>    &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;<br/>  &lt;/button&gt;</span><span id="930f" class="ky kz iq kp b gy le lb l lc ld">  &lt;div class="collapse navbar-collapse" id="navbarSupportedContent"&gt;<br/>    &lt;ul class="navbar-nav mr-auto"&gt;<br/>      &lt;li class="nav-item active"&gt;<br/>        &lt;a class="nav-link" routerLink="/"&gt;Home &lt;/a&gt;<br/>      &lt;/li&gt;<br/>      &lt;li class="nav-item active"&gt;<br/>        &lt;a class="nav-link" routerLink="/historicrates"&gt;Historic Rates &lt;/a&gt;<br/>      &lt;/li&gt;<br/>    &lt;/ul&gt;<br/>  &lt;/div&gt;<br/>&lt;/nav&gt;</span><span id="c02e" class="ky kz iq kp b gy le lb l lc ld">&lt;div class="page"&gt;<br/>  &lt;router-outlet&gt;&lt;/router-outlet&gt;<br/>&lt;/div&gt;</span></pre><p id="61e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向我们的页面添加链接，并暴露<code class="fe km kn ko kp b">router-outlet</code>以便用户可以看到我们的页面。</p><p id="cfc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在<code class="fe km kn ko kp b">app.component.scss</code>中，我们添加:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="a80e" class="ky kz iq kp b gy la lb l lc ld">.page {<br/>  padding: 20px;<br/>}</span><span id="741c" class="ky kz iq kp b gy le lb l lc ld">nav {<br/>  background-color: green !important;<br/>  .navbar-brand,<br/>  .nav-link,<br/>  .navbar-toggler-icon {<br/>    color: white !important;<br/>  }</span><span id="85f5" class="ky kz iq kp b gy le lb l lc ld">}</span></pre><p id="4863" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加填充到我们的页面，并改变我们的引导导航栏的颜色。</p><p id="4590" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">app.component.ts</code>中，我们放入:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="3c40" class="ky kz iq kp b gy la lb l lc ld">import { Component } from '<a class="ae kl" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';</span><span id="7a86" class="ky kz iq kp b gy le lb l lc ld"><a class="ae kl" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-root',<br/>  templateUrl: './app.component.html',<br/>  styleUrls: ['./app.component.scss']<br/>})<br/>export class AppComponent {<br/>  constructor() {<br/>    (window as any).Chart.defaults.global.defaultFontFamily = `<br/>    -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen",<br/>    "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue",<br/>    sans-serif`;<br/>  }<br/>}</span></pre><p id="6ac1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来改变我们的图表的字体，以匹配应用程序的其余部分。</p><p id="2823" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">app.module.ts</code>中，我们将现有代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="f065" class="ky kz iq kp b gy la lb l lc ld">import { BrowserModule } from '<a class="ae kl" href="http://twitter.com/angular/platform-browser" rel="noopener ugc nofollow" target="_blank">@angular/platform-browser</a>';<br/>import { NgModule } from '<a class="ae kl" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';</span><span id="8e08" class="ky kz iq kp b gy le lb l lc ld">import { AppRoutingModule } from './app-routing.module';<br/>import { AppComponent } from './app.component';<br/>import { HomePageComponent } from './home-page/home-page.component';<br/>import { HistoricRatesPageComponent } from './historic-rates-page/historic-rates-page.component';<br/>import { ModalModule } from 'ngx-bootstrap/modal';<br/>import { MobxAngularModule } from 'mobx-angular';<br/>import { BitcoinService } from './bitcoin.service';<br/>import { FormsModule } from '<a class="ae kl" href="http://twitter.com/angular/forms" rel="noopener ugc nofollow" target="_blank">@angular/forms</a>';<br/>import { HttpClientModule } from '<a class="ae kl" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>/http';<br/>import { ChartModule } from 'angular2-chartjs';</span><span id="4260" class="ky kz iq kp b gy le lb l lc ld"><a class="ae kl" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  declarations: [<br/>    AppComponent,<br/>    HomePageComponent,<br/>    HistoricRatesPageComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    AppRoutingModule,<br/>    FormsModule,<br/>    HttpClientModule,<br/>    ModalModule.forRoot(),<br/>    MobxAngularModule,<br/>    ChartModule<br/>  ],<br/>  providers: [<br/>    BitcoinService<br/>  ],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="e727" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们添加我们在应用中使用的组件、服务和库。</p><p id="cf54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">bitcoin.service.ts</code>中，我们将代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="a396" class="ky kz iq kp b gy la lb l lc ld">import { Injectable } from '<a class="ae kl" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { HttpClient } from '<a class="ae kl" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>/http';<br/>import { environment } from 'src/environments/environment';</span><span id="afde" class="ky kz iq kp b gy le lb l lc ld"><a class="ae kl" href="http://twitter.com/Injectable" rel="noopener ugc nofollow" target="_blank">@Injectable</a>({<br/>  providedIn: 'root'<br/>})<br/>export class BitcoinService {</span><span id="d168" class="ky kz iq kp b gy le lb l lc ld">  constructor(private http: HttpClient) { }</span><span id="5c8f" class="ky kz iq kp b gy le lb l lc ld">  getCurrencies() {<br/>    return this.http.get('<a class="ae kl" href="https://openexchangerates.org/api/currencies.json'" rel="noopener ugc nofollow" target="_blank">https://openexchangerates.org/api/currencies.json'</a>)<br/>  }</span><span id="e58a" class="ky kz iq kp b gy le lb l lc ld">  getLatestRates(code) {<br/>    return this.http.get(`${environment.coinDeskUrl}/currentprice/${code}.json`)<br/>  }</span><span id="7f74" class="ky kz iq kp b gy le lb l lc ld">  getHistoricRates(currency, startDate, endDate) {<br/>    return this.http.get(`${environment.coinDeskUrl}/historical/close.json?currency=${currency}&amp;start=${startDate}&amp;end=${endDate}`)<br/>  }<br/>}</span></pre><p id="ef58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在组件中发出请求以获取必要的数据。</p><p id="fc08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">currencies-store.ts</code>中，我们添加:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="cf0d" class="ky kz iq kp b gy la lb l lc ld">import { observable, action } from 'mobx-angular';</span><span id="48c3" class="ky kz iq kp b gy le lb l lc ld">class CurrenciesStore {<br/>    <a class="ae kl" href="http://twitter.com/observable" rel="noopener ugc nofollow" target="_blank">@observable</a> currencies = [];<br/>    <a class="ae kl" href="http://twitter.com/action" rel="noopener ugc nofollow" target="_blank">@action</a> setCurrencies(currencies) {<br/>        this.currencies = currencies;<br/>    }<br/>}</span><span id="a6a3" class="ky kz iq kp b gy le lb l lc ld">export const currenciesStore = new CurrenciesStore();</span></pre><p id="bee7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建MobX store来让我们的组件共享数据。每当我们在组件中调用<code class="fe km kn ko kp b">this.store.setCurrencies</code>时，我们就在这个存储中设置货币数据，因为我们在它之前添加了<code class="fe km kn ko kp b">@action</code>装饰器。当我们在组件代码中调用<code class="fe km kn ko kp b">this.store.cuurencies</code>时，我们总是从这个商店获得最新的值，因为它有<code class="fe km kn ko kp b">@observable</code>装饰器。</p><p id="9902" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">environment.ts</code>和<code class="fe km kn ko kp b">environment.prod.ts</code>中，我们将现有代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="25f5" class="ky kz iq kp b gy la lb l lc ld">export const environment = {<br/>  production: true,<br/>  coinDeskUrl: '<a class="ae kl" href="https://api.coindesk.com/v1/bpi'" rel="noopener ugc nofollow" target="_blank">https://api.coindesk.com/v1/bpi'</a><br/>};</span></pre><p id="3b89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">把我们的API URLs放在一个共享的地方。</p><p id="c615" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，在<code class="fe km kn ko kp b">index.html</code>中，我们将代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="95a3" class="ky kz iq kp b gy la lb l lc ld">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;title&gt;Bitcoin App&lt;/title&gt;<br/>    &lt;base href="/" /&gt;<br/>    &lt;link<br/>      href="<a class="ae kl" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css</a>"<br/>      rel="stylesheet"<br/>    /&gt;<br/>    &lt;script<br/>      src="<a class="ae kl" href="https://code.jquery.com/jquery-3.3.1.slim.min.js" rel="noopener ugc nofollow" target="_blank">https://code.jquery.com/jquery-3.3.1.slim.min.js</a>"<br/>      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"<br/>      crossorigin="anonymous"<br/>    &gt;&lt;/script&gt;<br/>    &lt;script<br/>      src="<a class="ae kl" href="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js</a>"<br/>      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"<br/>      crossorigin="anonymous"<br/>    &gt;&lt;/script&gt;<br/>    &lt;script<br/>      src="<a class="ae kl" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js</a>"<br/>      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"<br/>      crossorigin="anonymous"<br/>    &gt;&lt;/script&gt;</span><span id="2a6a" class="ky kz iq kp b gy le lb l lc ld">&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;link rel="icon" type="image/x-icon" href="favicon.ico" /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;app-root&gt;&lt;/app-root&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="8a07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将引导CSS和JavaScript依赖项添加到我们的应用程序中，并更改标题。</p><p id="e472" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">做完所有工作，我们就可以运行<code class="fe km kn ko kp b">ng serve</code>来运行app了。那么我们应该得到:</p><figure class="kq kr ks kt gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/80d23781e598650166171a192e82b08f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArtwZNUUu_GsqNBOvs8lmA.png"/></div></div></figure><figure class="kq kr ks kt gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/a21341ff4569487ea9946fe5dcae00e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24Gu4kNNbEYMjRkbfhD8cg.png"/></div></div></figure></div></div>    
</body>
</html>