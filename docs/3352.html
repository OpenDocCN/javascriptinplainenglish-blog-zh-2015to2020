<html>
<head>
<title>Maintainable JavaScript — Accidental Globals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可维护的JavaScript——意外的全局变量</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/maintainable-javascript-accidental-globals-3c1f68e6328b?source=collection_archive---------14-----------------------#2020-09-21">https://javascript.plainenglish.io/maintainable-javascript-accidental-globals-3c1f68e6328b?source=collection_archive---------14-----------------------#2020-09-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/58ab2dbf3e9b45b70018dfc1a273251a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cEOzRsCPsrV4zWAO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@louishansel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Louis Hansel @shotsoflouis</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5a7d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果想继续使用代码，创建可维护的JavaScript代码很重要。</p><p id="9221" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将通过避免意外创建全局变量来了解创建可维护JavaScript代码的基础。</p><h1 id="704d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免意外全局</h1><p id="4d49" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该避免意外的全局变量。</p><p id="f51c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们正在编写JavaScript脚本，那么如果我们在没有使用任何关键字的情况下给变量赋值，我们将默认创建全局变量。</p><p id="b372" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7da2" class="mn lc iq mj b gy mo mp l mq mr">count = 10;</span></pre><p id="3e18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe ms mt mu mj b">count</code>就是一个全局变量。</p><p id="85dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一个像JSHint或ESLint这样的linter，那么我们会看到一个警告。</p><p id="9aa1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，严格模式将防止我们意外地创建全局变量。</p><p id="9070" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果我们有:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a2fc" class="mn lc iq mj b gy mo mp l mq mr">'use strict';<br/>count = 10;</span></pre><p id="a4f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们会得到一个错误。</p><p id="b134" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们运行上面的代码，我们会得到“未捕获的引用错误:计数未定义”。</p><p id="c9c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">几乎所有现代浏览器都有严格模式，所以我们应该使用它。</p><p id="e7b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，模块有严格模式，所以如果我们试图创建新的全局变量，我们总是会得到错误。</p><p id="d2d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现有的全局变量应该被视为只读的。</p><p id="f8f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该添加任何新的属性，以避免错误。</p><p id="84f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们使用像<code class="fe ms mt mu mj b">window</code>或<code class="fe ms mt mu mj b">document</code>这样的全局变量，那么我们不应该给它们设置任何属性。</p><p id="f214" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们使用较旧的代码，我们应该尽可能地更新它们，并启用严格模式。</p><h1 id="d059" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">一个全局对象</h1><p id="52a8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">许多库为我们提供了它们自己的全局对象，我们可以在代码中使用它们。</p><p id="04e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">jQuery有<code class="fe ms mt mu mj b">$</code>和<code class="fe ms mt mu mj b">jQuery</code>对象。</p><p id="a150" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加后者是为了与其他使用<code class="fe ms mt mu mj b">$</code>的库兼容。</p><p id="d5cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue有一个<code class="fe ms mt mu mj b">Vue</code>全局变量让我们创建一个新的Vue实例。</p><p id="ab15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建一个具有唯一名称的全局对象，这样它就不太可能与应用程序中的其他库冲突。</p><p id="b376" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码来创建自己的构造函数:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e0ca" class="mn lc iq mj b gy mo mp l mq mr">function Person(name) {<br/>  this.name = name;<br/>}</span><span id="79bf" class="mn lc iq mj b gy mv mp l mq mr">Person.prototype.speak = function(speech) {<br/>  console.log(`${this.name}: ${speech}`)<br/>};</span><span id="68cd" class="mn lc iq mj b gy mv mp l mq mr">const james = new Person("james");<br/>const mary = new Person("mary");<br/>const jane = new Person("jane");</span></pre><p id="50c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe ms mt mu mj b">speak</code>原型方法创建了一个<code class="fe ms mt mu mj b">Person</code>构造函数。</p><p id="c9d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它接受<code class="fe ms mt mu mj b">name</code>参数并将其分配给<code class="fe ms mt mu mj b">this.name</code>。</p><p id="304e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它还有<code class="fe ms mt mu mj b">speak</code>实例方法。</p><p id="e2f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用<code class="fe ms mt mu mj b">new</code>操作符来使用它。</p><p id="a4d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这会创建许多全局范围的变量。</p><p id="4f5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们没有把它们都放在全局范围内，而是放在一个对象中，这样它们就不再是全局的了。</p><p id="67df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="007d" class="mn lc iq mj b gy mo mp l mq mr">const obj = {};</span><span id="c347" class="mn lc iq mj b gy mv mp l mq mr">obj.Person = function(name) {<br/>  this.name = name;<br/>}</span><span id="109a" class="mn lc iq mj b gy mv mp l mq mr">obj.Person.prototype.speak = function(speech) {<br/>  console.log(`${this.name}: ${speech}`)<br/>};</span><span id="71b5" class="mn lc iq mj b gy mv mp l mq mr">const james = new obj.Person("james");<br/>const mary = new obj.Person("mary");<br/>const jane = new obj.Person("jane");</span></pre><p id="e20e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">Person</code>构造函数放在<code class="fe ms mt mu mj b">obj</code>对象中，这样<code class="fe ms mt mu mj b">Person</code>构造函数就不在全局范围内。</p><p id="7aa4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就不会不小心更改或覆盖它。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/6599a211e0035836ad222f007f550c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xOjj31bZOQFOqHH0"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@drewbutler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andrew Butler</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="18a1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="a78a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们把代码放在一个对象中，这样它们就不会在全局范围内。</p><p id="a02d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，在严格模式下应该避免意外的全局变量。</p><h2 id="f3b5" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript</strong></h2><p id="c916" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>