<html>
<head>
<title>React Patterns — Events and Animations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应模式—事件和动画</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-patterns-events-and-animations-b3980a318588?source=collection_archive---------11-----------------------#2020-06-20">https://javascript.plainenglish.io/react-patterns-events-and-animations-b3980a318588?source=collection_archive---------11-----------------------#2020-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/18278f1e501ea803170ac588d6a374a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uJmRZVM-VA6Am-qg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jamie Street</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8432" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何使用React处理事件和创建简单的动画。</p><h1 id="27cd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">事件</h1><p id="0807" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">React抽象了事件在不同浏览器中的工作方式，以便我们有一个一致的接口来编写事件处理代码。</p><p id="5127" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它有一个合成事件的概念，合成事件是一个包装浏览器提供的原始事件的对象。</p><p id="e48a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论创建哪种浏览器，它都具有相同的属性。</p><p id="0f1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了将一个事件处理程序附加到一个节点，我们将一个camelCased prop传递到一个元素中。</p><p id="02da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们想要监听<code class="fe me mf mg mh b">keydown</code>事件，那么我们将一个事件处理函数传递给<code class="fe me mf mg mh b">onKeyDown</code>属性。</p><p id="8aad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下代码来创建一个按钮，在单击时执行某些操作:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ea39" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";</span><span id="1707" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return &lt;button onClick={() =&gt; alert("clicked")}&gt;click me&lt;/button&gt;;<br/>}</span></pre><p id="3cb5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入了一个在点击按钮时运行的函数。</p><p id="fd29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以处理一个元素的多个事件。</p><p id="678d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f44a" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";</span><span id="15c8" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;button<br/>      onDoubleClick={() =&gt; console.log("double clicked")}<br/>      onClick={() =&gt; console.log("clicked")}<br/>    &gt;<br/>      click me<br/>    &lt;/button&gt;<br/>  );<br/>}</span></pre><p id="5dc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该避免重复和减少样板文件，所以我们应该把两者合二为一。</p><p id="d658" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以提取这两个函数，并将它们合并为一个，然后检查所触发事件的类型。</p><p id="144d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9ccd" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";</span><span id="e71b" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  const handleEvent = event =&gt; {<br/>    switch (event.type) {<br/>      case "click":<br/>        console.log("clicked");<br/>        break;<br/>      case "dblclick":<br/>        console.log("double clicked");<br/>        break;<br/>      default:<br/>        console.log("unhandled", event.type);<br/>    }<br/>  };</span><span id="a6d9" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;button onClick={handleEvent} onDoubleClick={handleEvent}&gt;<br/>      click me<br/>    &lt;/button&gt;<br/>  );<br/>}</span></pre><p id="a6e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个接受<code class="fe me mf mg mh b">event</code>参数的<code class="fe me mf mg mh b">handleEvent</code>函数，它是事件对象。</p><p id="e798" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以检查一下<code class="fe me mf mg mh b">type</code>的财产。</p><p id="9d15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过检查值来做一些事情。</p><h1 id="478c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">参考文献</h1><p id="fd59" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们有时需要访问React呈现的DOM对象。</p><p id="83e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以给它分配一个ref，然后在返回的DOM对象中调用access和properties。</p><p id="1b35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7763" class="mq lc iq mh b gy mr ms l mt mu">import React, { useRef } from "react";</span><span id="9b65" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  const inputRef = useRef();</span><span id="8eca" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;&gt;<br/>      &lt;input ref={inputRef} /&gt;<br/>      &lt;button onClick={() =&gt; inputRef.current.focus()}&gt;focus&lt;/button&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="e1d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个输入，我们通过使用<code class="fe me mf mg mh b">useRef</code>钩子给它分配了一个ref。</p><p id="3205" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们有一个事件处理程序，当在输入元素上时调用<code class="fe me mf mg mh b">focus</code>。</p><p id="d586" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">inputRef.current</code>拥有输入元素DOM对象。</p><p id="264d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当有更好的方法处理元素时，我们应该尽量避免引用。</p><h1 id="7e60" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">动画片</h1><p id="9881" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以向React组件添加动画。为此，我们使用react-addons-CSS-transition-group包。</p><p id="8cd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们运行:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="371a" class="mq lc iq mh b gy mr ms l mt mu">react-addons-css-transition-group</span></pre><p id="7190" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d54c" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import CSSTransitionGroup from "react-addons-css-transition-group";<br/>import "./styles.css";</span><span id="e15e" class="mq lc iq mh b gy mv ms l mt mu">export default function App() {<br/>  return (<br/>    &lt;&gt;<br/>      &lt;CSSTransitionGroup<br/>        transitionName="fade"<br/>        transitionAppear<br/>        transitionAppearTimeout={500}<br/>      &gt;<br/>        &lt;p&gt;hello world&lt;/p&gt;<br/>      &lt;/CSSTransitionGroup&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="a391" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">styles.css</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f75b" class="mq lc iq mh b gy mr ms l mt mu">.fade-appear {<br/>  opacity: 0.01;<br/>}</span><span id="d64c" class="mq lc iq mh b gy mv ms l mt mu">.fade-appear.fade-appear-active {<br/>  opacity: 1;<br/>  transition: opacity 1.5s ease-in;<br/>}</span></pre><p id="fd27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们加载组件时，我们在“hello world”上得到一个淡入过渡。</p><p id="41d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">transitionName</code>道具为我们的动画设置类。</p><p id="0aa3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">transitionAppear</code>表示有东西显示时动画会运行。</p><p id="2863" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">transitionAppearTimeout</code>是动画开始前的延迟时间，单位为毫秒。</p><p id="6897" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的动画都是用CSS定义的。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/0a483a02d09b94bde0f9811f68dafc46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wVWB2_KYuHyXyOx_"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@pawel_czerwinski?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Paweł Czerwiński</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="025d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f9c4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">React提供了一种统一的方式来处理来自浏览器的事件。</p><p id="220e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用附加包将动画添加到React组件中。</p></div></div>    
</body>
</html>