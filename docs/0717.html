<html>
<head>
<title>You Need to Know Scope in JavaScript Before Programming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在编程之前，您需要了解JavaScript中的作用域</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/you-need-to-know-scope-in-javascript-before-programming-f3cfc2ce8a54?source=collection_archive---------1-----------------------#2019-12-01">https://javascript.plainenglish.io/you-need-to-know-scope-in-javascript-before-programming-f3cfc2ce8a54?source=collection_archive---------1-----------------------#2019-12-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0550" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">Java Script语言</h2><div class=""/><div class=""><h2 id="87e4" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">JavaScript范围的解释</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/ebdcdf2d8137c3f092c160b472d3fc43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*1xSRKCPNHMluYg0zZm1fBw.png"/></div></figure><p id="eb7b" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与块范围的C或C++语言不同，JavaScript天生就是函数范围的语言。所以许多开发人员过去不喜欢JavaScript，因为它与他们的语言大相径庭。但是，JavaScript的吸引力足以让我们做出选择！在这篇文章中，我将简单谈谈JavaScript中的作用域。</p><h1 id="5b77" class="ls lt iq bd lu lv lw lx ly lz ma mb mc kf md kg me ki mf kj mg kl mh km mi mj bi translated">什么是范围？</h1><p id="c09c" class="pw-post-body-paragraph kw kx iq ky b kz mk ka lb lc ml kd le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">JavaScript中的作用域指的是变量或方法所在的范围或边界。对此，更好的说法可能是“语境”。其他编程语言用花括号声明作用域。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="2a0c" class="mu lt iq mq b gy mv mw l mx my">// C language has block-scope<br/>int a = 1;<br/>{<br/>  int a = 2;<br/>  printf("%d", a); // 2<br/>}<br/>printf("%d", a); // 1</span></pre><p id="6147" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是在JavaScript中，结果略有不同。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="b341" class="mu lt iq mq b gy mv mw l mx my">var a = 1;<br/>{<br/> var a = 2;<br/> console.log(a); // 2<br/>} <br/>console.log(a) // 2</span></pre><p id="898f" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么会这样？因为JavaScript的作用域原则是基于函数的，而不是基于块的。所以在JavaScript中，那些代码在一个根函数作用域中，<code class="fe mz na nb mq b">window</code>。</p><p id="1b68" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JavaScript中的每个函数都有自己的作用域。它以左边的花括号(<code class="fe mz na nb mq b">{</code>)开始，以右边的花括号(<code class="fe mz na nb mq b">}</code>)结束。每个变量和方法只能在作用域内访问。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="5df4" class="mu lt iq mq b gy mv mw l mx my">var caller = 'window';<br/>function scope() {<br/>  var caller = 'scope';<br/>  console.log(caller);<br/>}</span><span id="8be3" class="mu lt iq mq b gy nc mw l mx my">console.log(caller); // window<br/>scope(); // scope</span></pre><p id="f212" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JavaScript关于变量的一个神秘特性是，当使用关键字声明变量时，实际上不需要键入<code class="fe mz na nb mq b">var</code>。为什么？因为如果一个变量没有关键字，默认情况下，JavaScript引擎会认为它属于<code class="fe mz na nb mq b">window</code>，不管变量在哪里。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="c62f" class="mu lt iq mq b gy mv mw l mx my">function a() {<br/>  function b() {<br/>    function c() {<br/>      a = 1;<br/>    }<br/>    c();<br/>  }<br/>  b();<br/>}<br/>a();<br/>console.log(a); // 1</span></pre><p id="d238" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看起来非常方便。但是请记住这是JavaScript的反模式。1)它破坏了JavaScript中的作用域系统，因为它直接绑定到根对象，2)如果您更改了<code class="fe mz na nb mq b">window</code>中的<code class="fe mz na nb mq b">a</code>，可能会导致副作用。</p><h1 id="1969" class="ls lt iq bd lu lv lw lx ly lz ma mb mc kf md kg me ki mf kj mg kl mh km mi mj bi translated">ES5和ES6+在范围上的区别</h1><p id="d3e3" class="pw-post-body-paragraph kw kx iq ky b kz mk ka lb lc ml kd le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">到目前为止，我介绍的所有例子都使用了<code class="fe mz na nb mq b">var</code>关键字。但是，从ECMAScript 2015开始有了新的关键词，换句话说就是ES6—<code class="fe mz na nb mq b">let</code>和<code class="fe mz na nb mq b">const</code>。<code class="fe mz na nb mq b">let</code>和<code class="fe mz na nb mq b">const</code>支撑块-范围。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="0365" class="mu lt iq mq b gy mv mw l mx my">let a = 'let a';</span><span id="6ae0" class="mu lt iq mq b gy nc mw l mx my">{<br/>  let a = 'let a in block';<br/>  console.log(a); // let a in block<br/>}</span><span id="65ad" class="mu lt iq mq b gy nc mw l mx my">console.log(a); // let a</span></pre><p id="af45" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你使用<code class="fe mz na nb mq b">let</code>和<code class="fe mz na nb mq b">const</code>时，还有一个注意事项你应该记住，尽管这个问题与作用域无关。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="64ce" class="mu lt iq mq b gy mv mw l mx my">console.log(a); <br/>let a = 1;<br/>// Uncaught ReferenceError: Cannot access 'a' before initialization</span></pre><p id="10ce" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是吊装问题。我建议您在使用变量之前声明它们。</p><h1 id="61a6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc kf md kg me ki mf kj mg kl mh km mi mj bi translated">范围链接</h1><p id="d88c" class="pw-post-body-paragraph kw kx iq ky b kz mk ka lb lc ml kd le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当JavaScript寻找一个变量时，JavaScript中有一个症状叫做作用域链接。我们举个例子。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0a9e" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JavaScript运行<code class="fe mz na nb mq b">a()</code>时，<code class="fe mz na nb mq b">x</code>和<code class="fe mz na nb mq b">y</code>被赋值为10和100。然后<code class="fe mz na nb mq b">console.log(x)</code>和<code class="fe mz na nb mq b">console.log(y)</code>打印出10和100。但是<code class="fe mz na nb mq b">z</code>呢？在<code class="fe mz na nb mq b">a()</code>中没有声明。当没有JavaScript一直在寻找的值时，它会自动转到<code class="fe mz na nb mq b">a()</code>的上部范围，并尝试查看是否有它正在寻找的值。在这种情况下，全局范围中有<code class="fe mz na nb mq b">z</code>，所以<code class="fe mz na nb mq b">a()</code>中的<code class="fe mz na nb mq b">console.log(z)</code>打印出1000。</p><p id="3cda" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后<code class="fe mz na nb mq b">b()</code>被执行，<code class="fe mz na nb mq b">b()</code>里面有<code class="fe mz na nb mq b">x</code>，是20。所以第一次印刷是20。第二个打印，<code class="fe mz na nb mq b">console.log(y)</code>在<code class="fe mz na nb mq b">b()</code>范围内寻找<code class="fe mz na nb mq b">y</code>但不存在。所以JavaScript在<code class="fe mz na nb mq b">a()</code>的范围内寻找<code class="fe mz na nb mq b">z</code>时采用了相同的过程。但是<code class="fe mz na nb mq b">b()</code>、<code class="fe mz na nb mq b">console.log(z)</code>最后一个呢？同样，它在<code class="fe mz na nb mq b">b()</code>和<code class="fe mz na nb mq b">a()</code>中并不存在。然后JavaScript再一次进入<code class="fe mz na nb mq b">a()</code>的上层范围，寻找它想要的东西。<code class="fe mz na nb mq b">window</code>中有<code class="fe mz na nb mq b">z</code>，是<code class="fe mz na nb mq b">a()</code>的上界。</p><p id="67b9" class="pw-post-body-paragraph kw kx iq ky b kz la ka lb lc ld kd le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JavaScript通过作用域寻找变量的过程被称为<strong class="ky ja">作用域链接</strong>。</p><h1 id="29c9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc kf md kg me ki mf kj mg kl mh km mi mj bi translated">结论</h1><p id="c1b3" class="pw-post-body-paragraph kw kx iq ky b kz mk ka lb lc ml kd le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">那么，那我应该用<code class="fe mz na nb mq b">var</code>还是<code class="fe mz na nb mq b">let</code>和<code class="fe mz na nb mq b">const</code>？大多数JavaScript开发者倾向于只使用<code class="fe mz na nb mq b">let</code>和<code class="fe mz na nb mq b">const</code>。就副作用而言，这是因为block-scope更具可读性和稳定性。但我不会告诉你<code class="fe mz na nb mq b">var</code>是我们应该在这个世界上摧毁的东西。但是更重要的是记住JavaScript作用域和作用域链接是如何工作的。</p></div></div>    
</body>
</html>