<html>
<head>
<title>3 Ways To Handle Errors in RxJs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RxJs中处理错误的3种方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/3-ways-to-handle-errors-in-rxjs-97a04f2ecdc?source=collection_archive---------3-----------------------#2020-09-18">https://javascript.plainenglish.io/3-ways-to-handle-errors-in-rxjs-97a04f2ecdc?source=collection_archive---------3-----------------------#2020-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="8ee8" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">反应式编程</h2><div class=""/><div class=""><h2 id="93de" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用catchError、retry和retryWhen运算符</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/7bd45f18ac7af2d4e307ac4e71c43224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*beVSPmr74q_dJKLl9ieIbw.jpeg"/></div></div></figure><h1 id="f603" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">介绍</h1><p id="446b" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">在<a class="ae mo" href="https://medium.com/javascript-in-plain-english/rxjs-explained-in-plain-english-9d2daa329f34?source=friends_link&amp;sk=35b463907a24785e81bc0067b1824a42" rel="noopener">上一篇文章</a>中，我们讨论了术语和一些你在RxJs中应该知道的常用运算符。所以如果你不确定术语或者不太理解剧中不同的角色，一定要先读一下。</p><p id="4805" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">这个帖子是关于在RxJs中处理错误的。我们将使用RxJs提供的以下三个操作符深入研究何时以及如何处理它们:</p><ul class=""><li id="4afd" class="mu mv iq lu b lv mp ly mq mb mw mf mx mj my mn mz na nb nc bi translated">捕捉错误</li><li id="d07e" class="mu mv iq lu b lv nd ly ne mb nf mf ng mj nh mn mz na nb nc bi translated">重试</li><li id="0782" class="mu mv iq lu b lv nd ly ne mb nf mf ng mj nh mn mz na nb nc bi translated">重试时间</li></ul><p id="fd26" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">不再拖延，让我们直接开始吧。</p><p id="e3a8" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated"><strong class="lu ja">注意:</strong> <em class="ni">你可以在</em> <a class="ae mo" href="https://github.com/Haseeb90/rxjs-error-handling" rel="noopener ugc nofollow" target="_blank"> <em class="ni">这个Git资源库</em> </a> <em class="ni">中找到所有的代码示例。</em></p><h1 id="a556" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">发生错误时会发生什么</h1><p id="eb38" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">正如我们在<a class="ae mo" href="https://medium.com/javascript-in-plain-english/rxjs-explained-in-plain-english-9d2daa329f34?source=friends_link&amp;sk=35b463907a24785e81bc0067b1824a42" rel="noopener">上一篇文章</a>中所提到的，一个可观察对象会发出一连串的值。在发出值时，可能会发生并发出错误。观察者应该能够处理发出的任何错误。</p><p id="2520" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">但是一旦可观察对象发出一个错误，该流将被终止，并且不会发出更多的项目。如果流被终止，应用程序将需要某种方式来处理它，否则它将崩溃。</p><p id="64bf" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">反应式编程的核心原则之一是应用程序应该具有弹性。也就是说，我们应该能够在错误到达观察者之前处理它们。因为，如果在观察器上调用了错误函数，就意味着流被终止。</p><p id="65e4" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">太晚了。</p><p id="d44c" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">那么，有没有一种方法可以在 错误到达观察者之前拦截错误<strong class="lu ja"> <em class="ni">并对其采取措施，使数据流不会被终止？或者，即使流被终止，有没有办法切换到一个可用的流？</em></strong></p><p id="190a" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">你猜对了。<code class="fe nj nk nl nm b">catchError()</code>、<code class="fe nj nk nl nm b">retry()</code>和<code class="fe nj nk nl nm b">retryWhen()</code>操作符允许我们以不同的方式处理错误，根据您的用例，您可以使用这些操作符中的一个或组合。</p><p id="623f" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">让我们详细看看每一个。</p><h1 id="c61d" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">catchError运算符</h1><p id="0410" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">在 观察者得到错误之前，在<strong class="lu ja"> <em class="ni">中截取错误。</em></strong></p><p id="16f4" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">这里有一个类比来帮助理解:</p><p id="a44b" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">我订阅了《网飞》。我按月付费。如果由于某种原因，网飞不能从我的信用卡中扣除费用，我会收到一封电子邮件，告诉我出了问题。</p><p id="48f1" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">网飞发出了一个错误。</p><p id="fae6" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">我，订户，可以在 之前处理那个错误<strong class="lu ja"> <em class="ni">我的家人，观察者，看到它并且不能<em class="ni">观察</em>他们的内容。</em></strong></p><p id="7038" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">这里有一个具体的例子，演示了如何在 到达观察者之前从一个流<strong class="lu ja"> <em class="ni">捕获错误，并切换到另一个流，以便观察者可以继续做它需要做的事情。</em></strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nn"><img src="../Images/895eec66586a9c3b3244010b18ebd9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*358wdf4Pjo7w4gjmEBv4Ag.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Example of how to use the catchError Operator in RxJs</figcaption></figure><p id="40e2" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated"><strong class="lu ja">注:</strong> <em class="ni">上面显示的代码示例称为捕捉和替换策略。</em></p><h1 id="009e" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">重试运算符</h1><p id="fb22" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">第三次是幸运符。</p><p id="b1b6" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">他们这么说。</p><p id="089c" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">真的是这样吗？或者他们，不管“他们”是谁，只是希望你继续努力，直到你得到你想要的东西。</p><p id="c1ef" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">但是一个人在放弃之前只能尝试这么多次。我忘了是谁说的了，但是他们把精神错乱定义为一遍又一遍地做同样的事情，却期望得到不同的结果。</p><p id="26c3" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated"><code class="fe nj nk nl nm b">retry</code>操作符允许我们在放弃之前将<em class="ni">重新订阅</em>到源可观测值的指定次数。</p><p id="1487" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">所以，你给它下的定义有多疯狂，它就有多疯狂😉</p><p id="bc06" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">让我们来看看在我们之前的例子中会是什么样子。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/ebc3361e91f625e0b994523b98e2ba59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkqHwWlr0FhZN9rkDD129A.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Example showing the retry Operator from RxJs</figcaption></figure><p id="9d43" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">在这个例子中，我使用了<code class="fe nj nk nl nm b">retry</code>操作符来捕捉错误，并使用<em class="ni">再次订阅</em>源可观察值两次。如果错误仍然出现，使用<code class="fe nj nk nl nm b">catchError</code>操作符切换到另一个流。</p><p id="f498" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated"><strong class="lu ja">注:</strong> <em class="ni">这将在</em>  <em class="ni">初次尝试失败后再重试两次</em> <strong class="lu ja"> <em class="ni">。</em></strong></p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><h1 id="2d33" class="la lb iq bd lc ld oa lf lg lh ob lj lk kf oc kg lm ki od kj lo kl oe km lq lr bi translated">retryWhen运算符</h1><p id="2aee" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated"><code class="fe nj nk nl nm b">retry</code>操作员不耐烦了。固执。它不能相信某个东西失败了，只想马上再试一次。</p><p id="ba84" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">另一方面,<code class="fe nj nk nl nm b">retryWhen</code>算子允许我们等待，重拾信心，然后再试一次。如果你知道你尝试的服务需要一段时间才能恢复，立即尝试<code class="fe nj nk nl nm b">retry</code>可能并不理想。</p><p id="790c" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">这就是所谓的延迟重试策略。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/045b2d68b21fbc9202c98070fc076f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtqADpCXsVXkWSR1sbJLDQ.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Example showing the retryWhen Operator in RxJs</figcaption></figure></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><h1 id="9586" class="la lb iq bd lc ld oa lf lg lh ob lj lk kf oc kg lm ki od kj lo kl oe km lq lr bi translated">结论</h1><p id="85fa" class="pw-post-body-paragraph ls lt iq lu b lv lw ka lx ly lz kd ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">这个帖子到此为止。</p><p id="52a1" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">现在，您应该对使用RxJs时如何以及何时进行错误处理有了一些了解。您还应该了解<code class="fe nj nk nl nm b">catchError</code>、<code class="fe nj nk nl nm b">retry</code>和<code class="fe nj nk nl nm b">retryWhen</code>操作符是如何工作的。</p><p id="7c87" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated"><strong class="lu ja">注意:</strong> <em class="ni">如果你想了解更多关于这些操作符的知识，一定要查看这篇文章的参考资料部分。</em></p><p id="4369" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">在RxJs的土地上还有更多的内容要介绍，但这应该会让您了解正在发生的事情。</p><p id="1e3d" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">如果您还没有阅读，请务必阅读本系列的第一部分:</p><div class="og oh gp gr oi oj"><a href="https://medium.com/javascript-in-plain-english/rxjs-explained-in-plain-english-9d2daa329f34" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ja gy z fp oo fr fs op fu fw iz bi translated">RxJs用简单的英语解释</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">您应该知道的7个最常用的运算符</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox ky oj"/></div></div></a></div><p id="7543" class="pw-post-body-paragraph ls lt iq lu b lv mp ka lx ly mq kd ma mb mr md me mf ms mh mi mj mt ml mm mn ij bi translated">下次再见，✌️和平</p><h1 id="3eae" class="la lb iq bd lc ld le lf lg lh li lj lk kf ll kg lm ki ln kj lo kl lp km lq lr bi translated">资源</h1><div class="og oh gp gr oi oj"><a href="https://rxjs-dev.firebaseapp.com/api/operators/catchError" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ja gy z fp oo fr fs op fu fw iz bi translated">RxJS</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">正式文档</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">rxjs-dev.firebaseapp.com</p></div></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://rxjs-dev.firebaseapp.com/api/operators/retry" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ja gy z fp oo fr fs op fu fw iz bi translated">RxJS</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">重试官方文档</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">rxjs-dev.firebaseapp.com</p></div></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://rxjs-dev.firebaseapp.com/api/operators/retryWhen" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ja gy z fp oo fr fs op fu fw iz bi translated">RxJS</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">正式文档时重试</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">rxjs-dev.firebaseapp.com</p></div></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://blog.angular-university.io/rxjs-error-handling/" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ja gy z fp oo fr fs op fu fw iz bi translated">RxJs错误处理:完全实用指南</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">错误处理是RxJs的重要组成部分，因为我们在编写的任何反应式程序中都需要它。错误…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">blog.angular-university.io</p></div></div><div class="os l"><div class="oy l ou ov ow os ox ky oj"/></div></div></a></div></div></div>    
</body>
</html>