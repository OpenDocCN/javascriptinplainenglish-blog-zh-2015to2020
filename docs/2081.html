<html>
<head>
<title>The biggest scandals of NPM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NPM最大的丑闻</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-biggest-scandals-of-npm-d739c11a2406?source=collection_archive---------2-----------------------#2020-05-18">https://javascript.plainenglish.io/the-biggest-scandals-of-npm-d739c11a2406?source=collection_archive---------2-----------------------#2020-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3110" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">JavaScript世界中巨大的依赖树使得开发变得非常愉快。但有时它会淹没整个社区。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d74e52ca1035e79495b20ae1bff9293a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBq67uzrDZqBzn1tGTpMGw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: the author</figcaption></figure><h1 id="d4ff" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">左图:互联网是如何被“破坏”的</h1><p id="9411" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Left-pad是一个极其简单的JavaScript库，它本身只包含几行代码。</p><p id="c20e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这个库的目的是从左边用空格填充一个字符串，为此，您将一个字符串传递到<strong class="lp ir"> leftPad() </strong>函数中，然后是该字符串应该包含的字符数，包括原始内容+空格。</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="5779" class="mt kw iq mp b gy mu mv l mw mx">leftPad("foo", 5)<br/>=&gt; "  foo"</span><span id="fb2f" class="mt kw iq mp b gy my mv l mw mx">leftPad("foo", 7)<br/>=&gt; "    foo"</span><span id="864c" class="mt kw iq mp b gy my mv l mw mx">leftPad("foooo", 5)<br/>=&gt; "foooo"</span></pre><p id="65c5" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">至少这曾经是这个小而出名的库背后的好处——因为现在它被弃用了，因为有一个JavaScript自带函数。</p><p id="9cde" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">但即使在left-pad具有巨大影响力的时候，它也引发了一场巨大的丑闻:2016年3月22日，在与信使Kik发生商标纠纷后，图书馆的所有者从NPM撤下了他所有的273个包裹。</p><p id="c1b9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">仅仅是为了抗议NPM，他决定给信使kik他们自己的开源项目的包名“Kik ”,这实际上是来自Azer Koç ulu的许多包中的一个，他也发布了left-pad。</p><p id="95cd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">由于NPM的这种行为，Koç ulu非常沮丧，他从NPM带走了他所有的包裹，包括left-pad。</p><p id="3139" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">但问题是，数以千计的其他NPM软件包都将-pad作为不依赖项，所以当普通JS开发人员想要安装他们的node_modules时，它不起作用。左垫最终丢失，因此反应和巴贝尔，以及其他人，也瘫痪了。</p><h1 id="79df" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">事件流</h1><p id="efec" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">因此，NPM从之前的案例中了解到，你不能简单地删除一个现有的流行软件包，否则其他各种软件包也会受到影响。</p><p id="6574" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">但是如果你只是简单地把你自己的包的权利转让给别人会怎么样呢？这就把我们带到了下一个案例:<strong class="lp ir">事件流</strong></p><p id="8dd6" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">当这个每周约有200万次下载的受欢迎的图书馆的实际所有者对它失去兴趣时，他通过邮件联系了一个名为“right9ctrl”的用户，并将其权利交给了他。</p><p id="016c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这位新主人所做的是添加了一个名为<strong class="lp ir">平面图流</strong>的依赖项。在官方的<a class="ae mz" href="https://www.npmjs.com/package/flatmap-stream" rel="noopener ugc nofollow" target="_blank"> NPM页面</a>上仍然可以看到一些不太对劲的地方。</p><p id="985b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这种新的依赖关系包含恶意代码，当它被包含在比特币钱包app <a class="ae mz" href="https://github.com/bitpay/copay" rel="noopener ugc nofollow" target="_blank"> Copay </a>的一个包中时，这些恶意代码就会变得活跃。恶意代码试图窃取钱包所有者的私钥，并将它们发送到攻击者的服务器。</p><p id="1a66" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这显然是一个GitHub用户发现的，他注意到了新的依赖性:<a class="ae mz" href="https://github.com/dominictarr/event-stream/issues/115" rel="noopener ugc nofollow" target="_blank">https://github.com/dominictarr/event-stream/issues/115</a></p><p id="0108" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在，用户right9ctrl是否故意包含了schad-dependency，或者只是偶然的，可能还不知道。</p><p id="d82b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然而，这一案例应该给我们以思考。众所周知，由于Node.js环境，NPM包可以轻松访问最终用户的文件系统、网络和更多内容。甚至shell命令也可以毫无问题地执行，正如我在<a class="ae mz" href="https://medium.com/javascript-in-plain-english/3-pretty-cool-built-in-node-js-modules-c2c3283276e6#712c" rel="noopener">这篇文章</a>中所展示的。</p><p id="f472" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">问题是，在NPM世界，成百上千的依赖是很常见的。仅event-stream就有1795个依赖项，这意味着还有许多其他包使用event-stream本身。</p><p id="8633" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">另一个突出的例子，<a class="ae mz" href="https://www.npmjs.com/package/express" rel="noopener ugc nofollow" target="_blank"> <strong class="lp ir">表达</strong> </a> <strong class="lp ir">，</strong>有30个从属关系。</p><h1 id="f774" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">is-promise:有错误吗？</h1><p id="d57a" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">是的，有一个。</p><p id="7c55" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">不久前，就在几周前，一行程序库应该得到更新，以使其能够作为ES6模块工作。但是这个新版本是错误的，并引起了一系列问题，巨大的软件包，甚至创建-反应-应用程序都受到了影响，正如我们在这里看到的。</p><p id="71a6" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在GitHub的几期上，出现了同样的bug</p><pre class="kg kh ki kj gt mo mp mq mr aw ms bi"><span id="5da4" class="mt kw iq mp b gy mu mv l mw mx">Must use import to load ES Module</span></pre><p id="0e49" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这一次也出现了愤怒的浪潮。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="cda0" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这个软件包的创建者写了一篇关于这个问题的“事后分析”,也可以在JavaScript in Plain English——这个出版物中找到。此处链接:<a class="ae mz" href="https://medium.com/javascript-in-plain-english/is-promise-post-mortem-cab807f18dcc" rel="noopener">https://medium . com/JavaScript-in-plain-English/is-promise-postal-mountain-cab 807 f18 DCC</a></p><h1 id="08cc" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">我们能从中学到什么</h1><p id="e562" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">尽管像NPM这样的软件包管理员可以让我们愉快地完成很多工作，但他们也诱使我们把开发变得过于舒适。</p><p id="0cb3" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">有各种各样的软件包每周被下载数百万次，尽管它们通常只包含一行代码，或者更多。</p><p id="c5dd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">包有问题甚至被滥用的危险可能永远不会被完全控制。但是最后还有一个建议:<br/>特别是对于更大、更重要的项目，没有很多小的包可能会更好。一个可能的补救方法是在您自己的项目中实现包的代码，(包括简单的复制粘贴，是的)。</p><p id="ca29" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然而，这是获得安全性的唯一方法，但是当然也有更多的代码，你必须自己维护这些代码，而没有任何包所有者注意到他应该对他的代码进行合理的修改，这最终将使我们作为包用户受益。</p><p id="854c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">因此，这里可能没有明确的解决方案。</p><h2 id="c4bb" class="mt kw iq bd kx nc nd dn lb ne nf dp lf lw ng nh lh ma ni nj lj me nk nl ll nm bi translated">来自简明英语团队的说明</h2><p id="1514" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae mz" href="https://plainenglish.io" rel="noopener ugc nofollow" target="_blank"> <strong class="lp ir"> plainenglish.io </strong> </a>找到所有这些内容——关注我们的出版物并<a class="ae mz" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="lp ir">订阅我们的YouTube频道</strong> </a> <strong class="lp ir">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>