<html>
<head>
<title>jQuery Tips — Multiple Ajax Requests, Scrolling, and Search Parts of an Attribute</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">jQuery技巧——多个Ajax请求、滚动和属性的搜索部分</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/jquery-tips-multiple-ajax-requests-scrolling-and-search-parts-of-an-attribute-f911a9e945c?source=collection_archive---------4-----------------------#2020-07-25">https://javascript.plainenglish.io/jquery-tips-multiple-ajax-requests-scrolling-and-search-parts-of-an-attribute-f911a9e945c?source=collection_archive---------4-----------------------#2020-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/01d6e279a6f14fd1d7e742badf4ea9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XKf6rxW-ZatrRUi_"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@vivibzk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Vivi Bzk</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2557" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管年代久远，jQuery仍然是操纵DOM的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些使用jQuery的技巧。</p><h1 id="4ea5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">jQuery选择器中的通配符</h1><p id="2ce2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有几种方法可以将通配符添加到我们用来通过jQuery获取元素的选择器中。</p><p id="851d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要获得ID以给定字符串开头的元素，我们可以编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3754" class="mn lc iq mj b gy mo mp l mq mr">$("[id^=foo]")</span></pre><p id="d61a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">^</code>意味着我们寻找一个ID以<code class="fe ms mt mu mj b">foo</code>开始的元素。</p><p id="8eea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe ms mt mu mj b">$</code>符号来搜索ID以给定字符串结尾的元素。</p><p id="9f35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="da82" class="mn lc iq mj b gy mo mp l mq mr">$("[id$=foo]")</span></pre><p id="eacc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">$</code>意味着我们寻找一个ID以<code class="fe ms mt mu mj b">foo</code>结尾的元素。</p><p id="9fba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用任何其他属性代替<code class="fe ms mt mu mj b">id</code>。</p><p id="6275" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用星号在任何地方查找属性的一部分。</p><p id="301a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ff01" class="mn lc iq mj b gy mo mp l mq mr">$("[id*=foo]")</span></pre><p id="d80e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">*</code>意味着我们在ID值的任何地方寻找<code class="fe ms mt mu mj b">foo</code>。</p><h1 id="5a43" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">检查用户是否已经滚动到底部</h1><p id="89e7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以检查用户是否已经滚动到底部，我们可以用回调来调用<code class="fe ms mt mu mj b">scroll</code>方法。</p><p id="fac4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在回调中，我们可以调用<code class="fe ms mt mu mj b">scrollTop</code>属性来获取窗口滚动条的当前垂直位置。</p><p id="1312" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们把它加到窗户的高度上。</p><p id="c4f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们把它加起来，然后和文档的高度进行比较。</p><p id="6f23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e7e6" class="mn lc iq mj b gy mo mp l mq mr">$(window).scroll(() =&gt; {<br/>   if ($(window).scrollTop() + $(window).height() === $(document).height()) {<br/>     console.log("scroll to bottom");<br/>   }<br/>});</span></pre><p id="bdfa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将滚动高度与文档高度进行比较，看用户是否滚动到底部。</p><h1 id="e0e1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">等到所有jQuery Ajax请求都完成</h1><p id="6640" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了等到所有的jQuery ajax请求都完成，我们可以使用jQuery Ajax调用作为参数来调用<code class="fe ms mt mu mj b">when</code>方法。</p><p id="0113" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过这种方式，我们等待所有的请求被完成并得到所有的结果。</p><p id="acc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4053" class="mn lc iq mj b gy mo mp l mq mr">const ajax1 = () =&gt; {<br/>  return $.ajax({<br/>    url: "/foo",<br/>    dataType: "json",<br/>    data,            <br/>    //...<br/>  });<br/>}</span><span id="aa3d" class="mn lc iq mj b gy mv mp l mq mr">//...</span><span id="c159" class="mn lc iq mj b gy mv mp l mq mr">$.when(ajax1(), ajax2(), ajax3())<br/>  .done((a1, a2, a3) =&gt; {<br/>    //...<br/>});</span></pre><p id="3f5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有3个Ajax函数<code class="fe ms mt mu mj b">ajax1</code>、<code class="fe ms mt mu mj b">ajax2</code>和<code class="fe ms mt mu mj b">ajax3</code>。</p><p id="3e95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们都通过呼唤<code class="fe ms mt mu mj b">$.ajax</code>来回报我们得到的承诺。</p><p id="b274" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们对每个请求做出承诺，然后传递结果。</p><p id="77f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe ms mt mu mj b">done</code>来获得所有承诺的结果。</p><p id="10eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">a1</code>、<code class="fe ms mt mu mj b">a2</code>和<code class="fe ms mt mu mj b">a3</code>是每个承诺的结果。</p><p id="c4fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于<code class="fe ms mt mu mj b">$.ajax</code>返回承诺，我们可以将它传递给<code class="fe ms mt mu mj b">Promise.all</code>。</p><p id="be19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e2c9" class="mn lc iq mj b gy mo mp l mq mr">Promise.all([ajax1(), ajax2(), ajax3()])<br/>  .then(([a1, a2, a3]) =&gt; {<br/>    //...<br/>  }).catch(() =&gt; {<br/>    //...<br/>  })</span></pre><p id="22a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">Promise.all</code>让我们得到所有请求的结果，就像jQuery的<code class="fe ms mt mu mj b">when</code>一样。</p><p id="3024" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一组承诺，然后返回。</p><p id="0268" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在承诺完成后调用<code class="fe ms mt mu mj b">then</code>去做一些事情。</p><p id="887c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个承诺的结果都在<code class="fe ms mt mu mj b">then</code>回调的第一个参数的数组中。</p><p id="75b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<code class="fe ms mt mu mj b">async</code>和<code class="fe ms mt mu mj b">await</code>语法，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e7ff" class="mn lc iq mj b gy mo mp l mq mr">const makeRequests = async () =&gt; {<br/>  try {<br/>    const results = await Promise.all([ajax1(), ajax2(), ajax3()]);<br/>  } catch(ex) { <br/>    console.log(ex);<br/>  }<br/>}</span></pre><p id="6bc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是用更短的语法重写了代码，但是代码做的和<code class="fe ms mt mu mj b">then</code>一样。</p><p id="6ed9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">results</code>拥有所有承诺的结果数组。</p><h1 id="7f32" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">选择href以某个字符串结尾的<a>元素</a></h1><p id="92e8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe ms mt mu mj b">$=</code>操作符得到一个以给定字符串结尾的<a>元素。</a></p><p id="8d7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9686" class="mn lc iq mj b gy mo mp l mq mr">$('a[href$="foo"]')</span></pre><p id="7d34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将获得以<code class="fe ms mt mu mj b">foo</code>结尾的href属性。</p><p id="ffe9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了<code class="fe ms mt mu mj b">$=</code>，还有很多操作符让我们检查字符串的其他部分。</p><p id="64b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">=</code>完全相等。</p><p id="b1e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">!=</code>不相等。</p><p id="e468" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">^=</code>表示始于。</p><p id="79ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">$=</code>是以结尾。</p><p id="ec3b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">*=</code>意为包含。</p><p id="fb19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">~=</code>表示匹配包含一个单词。</p><p id="2dc5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">|=</code>表示以给定的前缀开始。前缀类似于<code class="fe ms mt mu mj b">prefix-</code>。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/b15c58bedec45afaa6fddb9c2b9592a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c-8MkEhiMeRQcpTW"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@thejoshhoward?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Josh Howard</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="9b23" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f8ca" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有许多运算符可以让我们匹配属性值的各个部分。</p><p id="f94f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以通过比较高度来检查用户是否滚动到底部。</p><p id="138e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">jQuery使用的CSS选择器中可以包含通配符。</p><p id="11ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在所有jQuery Ajax请求完成后，有许多方法可以运行代码。</p></div></div>    
</body>
</html>