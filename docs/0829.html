<html>
<head>
<title>Creating timestamped video annotations with React refs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React引用创建带时间戳的视频注释</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-timestamped-video-annotations-with-react-refs-db0ee3e9a53d?source=collection_archive---------1-----------------------#2019-12-18">https://javascript.plainenglish.io/creating-timestamped-video-annotations-with-react-refs-db0ee3e9a53d?source=collection_archive---------1-----------------------#2019-12-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7896" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用React-Player模块创建一个可以与UI交互的视频播放器</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/36f17c9599a13b9c84f355578175426b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y_0k2OPXIvufSjNmiItLnA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">An image of <strong class="bd ks">Vidplus</strong>, a web-based video annotation tool. Video (left) and annotations (right) are shown.</figcaption></figure><p id="ed8f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最近，我和一些团队成员一起创建了一个名为Vidplus的基于网络的视频注释工具。该工具帮助用户从YouTube、DailyMotion、脸书等网站上的教育视频中获得尽可能多的东西。通过允许他们写<em class="lp">有时间戳的注释</em>。我负责使用React创建注释页面——如上所示。</p><p id="357f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最初，视频是通过主页上的URL加载的。然后，用户可以通过点击“添加注释”按钮或按回车键来创建与视频时间戳相关联的注释。当用户点击现有注释的时间戳时，视频会立即跳转到该时间戳，这样用户就可以看到该注释引用了视频的哪一部分。</p><p id="d48c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通常，为了创建这种类型的UI/UX，必须引用和使用视频所属的视频共享服务所提供的API(例如，<a class="ae lq" href="https://developers.google.com/youtube/iframe_api_reference" rel="noopener ugc nofollow" target="_blank">用于iFrame嵌入的Youtube播放器API</a>)。幸运的是，CookPete已经在NPM发布了一个名为<a class="ae lq" href="https://www.npmjs.com/package/react-player" rel="noopener ugc nofollow" target="_blank"> React-Player </a>的包，作为多个外部视频播放器API(Youtube、脸书等)的React组件包装器。).本文将研究我们如何使用这个包和React refs来实现上述特性。</p><h2 id="10c0" class="lr ls in bd lt lu lv dn lw lx ly dp lz lc ma mb mc lg md me mf lk mg mh mi mj bi translated">什么是反应型裁判？</h2><p id="25c5" class="pw-post-body-paragraph kt ku in kv b kw mk jo ky kz ml jr lb lc mm le lf lg mn li lj lk mo lm ln lo ig bi translated">在深入研究前端代码的细节之前，清楚地理解什么是React refs是很重要的。从本质上讲，refs是对DOM元素或React组件的Javascript引用，这些组件呈现在组件中。下面是参考文献的一般用法:</p><pre class="kd ke kf kg gt mp mq mr ms aw mt bi"><span id="d444" class="lr ls in mq b gy mu mv l mw mx">import ReactPlayer from "react-player";</span><span id="64ae" class="lr ls in mq b gy my mv l mw mx">class VideoPlayer extends Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.player = React.createRef();<br/>  }</span><span id="5ef7" class="lr ls in mq b gy my mv l mw mx">  render() {<br/>    // Detailed options (props) omitted for readability.    <br/>    return &lt;ReactPlayer<br/>      ref={this.player}<br/>      url={this.props.url}<br/>    /&gt;<br/>  }<br/>}</span></pre><p id="f938" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如上所示，我们首先使用React.createRef()方法在VideoPlayer类组件中创建一个React ref。然后，使ref引用render()方法内的ReactPlayer React组件。现在可以通过调用<code class="fe mz na nb mq b">this.player.current</code>来访问实际的视频播放器组件实例。</p><p id="a817" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">注意:<a class="ae lq" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">不要过度使用参考文献</a>。虽然这里需要引用，因为react-player模块具有只能通过引用访问的实例方法，但它们鼓励对子元素进行强制性修改(这与react首选的不变性相冲突)。</p><h2 id="139c" class="lr ls in bd lt lu lv dn lw lx ly dp lz lc ma mb mc lg md me mf lk mg mh mi mj bi translated">使用ReactPlayer引用实现交互功能</h2><p id="f7de" class="pw-post-body-paragraph kt ku in kv b kw mk jo ky kz ml jr lb lc mm le lf lg mn li lj lk mo lm ln lo ig bi translated">应在ReactPlayer ref上使用的两种方法如下:</p><ol class=""><li id="d68d" class="nc nd in kv b kw kx kz la lc ne lg nf lk ng lo nh ni nj nk bi translated"><code class="fe mz na nb mq b">getCurrentTime()</code>:获取视频的当前时间，以秒为单位。</li><li id="a949" class="nc nd in kv b kw nl kz nm lc nn lg no lk np lo nh ni nj nk bi translated"><code class="fe mz na nb mq b">seekTo(amount)</code>:让视频播放器跳到<code class="fe mz na nb mq b">amount</code>秒。</li></ol><p id="3e6f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用这两种方法，我们可以使UI的其余部分直接与视频交互。为了使带时间戳的注释像预期的那样运行，剩余代码的一般流程应该是:</p><ol class=""><li id="b180" class="nc nd in kv b kw kx kz la lc ne lg nf lk ng lo nh ni nj nk bi translated">使用<code class="fe mz na nb mq b">this.player.current.getCurrentTime()</code>定期更新共享状态下(如Redux)视频的当前时间。</li><li id="b7aa" class="nc nd in kv b kw nl kz nm lc nn lg no lk np lo nh ni nj nk bi translated">添加注释时(通过单击“Add Note”或按Enter键)，从共享状态中检索当前时间戳，并将其与注释一起显示在浏览器页面上。</li><li id="c1d5" class="nc nd in kv b kw nl kz nm lc nn lg no lk np lo nh ni nj nk bi translated">当点击现有注释的时间戳时，将共享状态下的另一个属性(即<code class="fe mz na nb mq b">targetTimestamp</code>)更新为点击的时间戳。</li><li id="dec7" class="nc nd in kv b kw nl kz nm lc nn lg no lk np lo nh ni nj nk bi translated">从共享状态中检索<code class="fe mz na nb mq b">targetTimestamp</code>，并在<code class="fe mz na nb mq b">seekTo</code>方法中使用它。使用<code class="fe mz na nb mq b">this.player.current.seekTo(targetTimestamp)</code>将使视频跳转到目标时间戳。</li></ol><p id="c3e8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就是你如何使用React refs和来自NPM的React Player模块使视频与UI进行交互！</p></div></div>    
</body>
</html>