<html>
<head>
<title>Creating Custom Pins With React MapBox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React MapBox创建自定义图钉</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-custom-pins-with-react-mapbox-8b2c91a8659f?source=collection_archive---------6-----------------------#2019-12-02">https://javascript.plainenglish.io/creating-custom-pins-with-react-mapbox-8b2c91a8659f?source=collection_archive---------6-----------------------#2019-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/68fbf5c71d6a2731e33dddfa65ca0208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8mU5gxeGuimfBQ7DQKtSg.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/@iambrettzeck?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Brett Zeck</a> on <a class="ae jd" href="https://unsplash.com/s/photos/map?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="099f" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">让他们指向正确的点！</h2></div><p id="32db" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae jd" href="https://www.mapbox.com/" rel="noopener ugc nofollow" target="_blank"> <em class="lr"> MapBox </em> </a> <em class="lr">允许大量定制，包括完全自由地设计自己的图钉来定位地图上的位置。正如他们的</em> <a class="ae jd" href="https://docs.mapbox.com/mapbox-gl-js/example/custom-marker-icons/" rel="noopener ugc nofollow" target="_blank"> <em class="lr">官方技术文档</em> </a> <em class="lr">所示，pin基本上是一个div，呈现在由坐标指定的位置上，并且div的内部可以被裁剪以适合任何应用程序。这里我们要关注的是自定义标记显示的确切位置，如果它是大头针或指向对象的形式。</em></p><p id="92bf" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与其他地图提供商一样，放大和缩小时大头针的大小保持不变，而地图会扩大或变小。在为我们的项目<a class="ae jd" href="https://github.com/iourisorokine/Gem-Box" rel="noopener ugc nofollow" target="_blank"> GemBox </a>创建定制别针时，我们注意到一个有趣的现象:</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ls"><img src="../Images/d1665149091c6d4063473f10ac8900d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSr55EiId1fn9YFApu6asQ.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">When zooming in, the exact location pointed by the pin changes</figcaption></figure><p id="9eb8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">图例解释得很好，如果你仔细看，第三张图片上大头针显示的确切位置与第一张有很大不同。这个问题已经被一些开发者解决了，但是仍然有可能找到地图。</p><p id="8966" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">原因很简单:在MapBox中，大头针的坐标默认是指div的左上角，因此在放大和缩小时，正是这个角被锚定到正确的位置。</p><p id="eab9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">取决于你的pin是如何设计的，你将不得不使用CSS，并把这个点改变到div的底部或者你的pin指向的任何地方。</p><h2 id="7603" class="lx ly jg bd lz ma mb dn mc md me dp mf le mg mh mi li mj mk ml lm mm mn mo mp bi translated">调整我们的自定义pin</h2><p id="bdc1" class="pw-post-body-paragraph kv kw jg kx b ky mq kh la lb mr kk ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">对于我们的项目，我们对React使用了MapBox，但是原理与标准DOM操作完全相同。我们的pin组件的代码如下所示:</p><pre class="lt lu lv lw gt mv mw mx my aw mz bi"><span id="7857" class="lx ly jg mw b gy na nb l nc nd">// top of the component<br/>import { Marker } from "react-map-gl";</span><span id="e99b" class="lx ly jg mw b gy ne nb l nc nd">//in the render<br/>&lt;Marker <br/>   latitude={props.data.latitude}<br/>   longitude={props.data.longitude}<br/>   captureClick={false}<br/>   draggable={false}&gt;<br/>      &lt;div className=”custom-pin” <br/>         onClick={() =&gt; {props.openPopup(props.data);<br/>         }}&gt;<br/>         &lt;img src=”/images/diamond-icon-green.png” alt=”Gem” /&gt;<br/>      &lt;/div&gt;<br/>&lt;/Marker&gt;</span></pre><p id="8089" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Marker是MapBox包中的一个组件，它在地图上呈现一个div，在我们的例子中它只包含一个图像。有许多可选属性，包括<em class="lr"> offsetTop </em>和<em class="lr"> offsetLeft。我们会玩这些。</em></p><p id="6346" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们检查一下我们的大头针应该是什么样的:它是一个30px边的正方形，点应该在中间的底部；</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/a19547d5ac0f71cee1884eba36aa3b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCUeWYhsZ2iQ_dbRiKgH8Q.jpeg"/></div></div></figure><p id="504c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">越来越清晰了:</p><ul class=""><li id="9595" class="ng nh jg kx b ky kz lb lc le ni li nj lm nk lq nl nm nn no bi translated">我们将在组件的<em class="lr">渲染</em>中为标记属性添加30px的<em class="lr">偏移</em>和一个15px的<em class="lr">偏移</em>。我们正在“把图像拉回来”,所以数字应该是负数。</li><li id="bb91" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">在CSS中，我们将确保img大小合适，如果长宽比不同，我们添加align(在我们的例子中—水平居中)。</li></ul><p id="84b3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">结果是:</p><pre class="lt lu lv lw gt mv mw mx my aw mz bi"><span id="aab9" class="lx ly jg mw b gy na nb l nc nd">// top of the component<br/>import { Marker } from "react-map-gl";</span><span id="23a3" class="lx ly jg mw b gy ne nb l nc nd">//in the render<br/>&lt;Marker <br/>   latitude={props.data.latitude}<br/>   longitude={props.data.longitude}<br/>   captureClick={false}<br/>   draggable={false}<br/>   offsetTop={-30}<br/>   offsetLeft={-15}&gt;<br/>      &lt;div className=”custom-pin” <br/>         onClick={() =&gt; {props.openPopup(props.data);<br/>         }}&gt;<br/>         &lt;img src=”/images/diamond-icon-green.png” alt=”Gem” /&gt;<br/>      &lt;/div&gt;<br/>&lt;/Marker&gt;</span><span id="1b26" class="lx ly jg mw b gy ne nb l nc nd">//in the CSS</span><span id="8767" class="lx ly jg mw b gy ne nb l nc nd">.custom-pin {<br/>   height: 30px;<br/>   width: 30px;<br/>   display: flex;<br/>   justify-content: center;<br/>}</span><span id="3377" class="lx ly jg mw b gy ne nb l nc nd">.custom-pin img {<br/>   width: 100%;<br/>   height: 100%;<br/>}</span></pre><p id="911a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的例子是该应用程序的进一步版本，因此风格完全不同，但它表明，通过这些调整，当我们放大时，我们的大头针总是指向正确的位置:</p><figure class="lt lu lv lw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ls"><img src="../Images/aee5752feccaa0b01cd027b5c0541bfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1djfj7v-R_0eRuY-T0nmw.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">3 times the same pin with different zoom: the diamond points at the same spot</figcaption></figure><p id="f50a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就是这样，我们通过将坐标设置到正确的点来纠正我们的pin。MapBox for React允许对其元素进行大量定制，因此使用开发人员工具在浏览器中检查它们通常有助于确定其结构方式以及如何处理它。</p><p id="dfaa" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于React地图框和标记的更多信息:</p><ul class=""><li id="35fa" class="ng nh jg kx b ky kz lb lc le ni li nj lm nk lq nl nm nn no bi translated"><a class="ae jd" href="https://medium.com/better-programming/into-to-react-mapbox-gl-js-b7d827f7d7d6" rel="noopener">反应地图框简介</a></li><li id="08e5" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated"><a class="ae jd" href="https://stackoverflow.com/questions/51459791/stylable-marker-feature-in-react-mapbox-gl" rel="noopener ugc nofollow" target="_blank">样式标记</a></li><li id="a3a8" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated"><a class="ae jd" href="https://medium.com/better-programming/animate-map-markers-using-mapbox-react-hooks-2f646a6301e" rel="noopener">动画标记</a></li></ul><p id="7ebd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">玩得开心！</p></div></div>    
</body>
</html>