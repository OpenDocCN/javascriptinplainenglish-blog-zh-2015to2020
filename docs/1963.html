<html>
<head>
<title>Detecting an Ad-Blocker Using JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript检测广告拦截器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/detecting-an-ad-blocker-using-javascript-d488b794e5c7?source=collection_archive---------0-----------------------#2020-05-08">https://javascript.plainenglish.io/detecting-an-ad-blocker-using-javascript-d488b794e5c7?source=collection_archive---------0-----------------------#2020-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2ae4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">只用几行JavaScript代码就能增加你的博客或网站的收入</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ce6bace39c25fd4821062df28bff4b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqeODAoW3miejC0JcjxGIg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@ffstop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Fotis Fotopoulos</a> on <a class="ae kv" href="https://unsplash.com/s/photos/programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出版商和抵制展示广告的人之间的斗争已经持续了一段时间，而且还远没有结束。用户无法使显示反广告拦截消息的博客或网站看不到广告拦截器。相反，出版商没有办法完全并始终如一地让他们的网站免受广告拦截器的攻击。</p><p id="30d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于广告拦截扩展，出版商需要找到新的方法来弥补收入损失，要么通过实施特定的广告再插入应用程序，要么通过安装付费墙。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e4c2" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">什么是广告拦截器？</h1><p id="e4ed" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">广告拦截器是一种浏览器扩展，通过阻止特定脚本和DOM元素来禁用某些网页中的广告。基本上，它们是一个巨大的黑名单，列出了哪些文件不应该被加载，或者哪些域不应该加载文件。</p><p id="7d56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你打开一个网站时，你的广告拦截器会查看是否有任何列入黑名单的JavaScript文件(针对谷歌的广告- <code class="fe mw mx my mz b">adsbygoogle.js</code>)，它会阻止这些脚本加载，因此，广告将不会显示。查看热门黑名单— <a class="ae kv" href="https://easylist-downloads.adblockplus.org/easylist.txt" rel="noopener ugc nofollow" target="_blank"> easylist.txt </a></p><h2 id="5274" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated">如何检测广告拦截器？</h2><p id="2253" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">通过实现一个小诱饵脚本是知道用户有广告拦截器的最简单的方法。如果你放置一个带有<strong class="ky ir"> ads </strong>类名的div元素，那么广告拦截器会阻止它的渲染。我们可以通过使用另一个具有独特标识符的div来利用这一点。</p><p id="d445" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> HTML </strong></p><pre class="kg kh ki kj gt nm mz nn no aw np bi"><span id="d27e" class="na ma iq mz b gy nq nr l ns nt">&lt;div id="notify"&gt;<br/>    &lt;div class="ads"&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="b0f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> CSS </strong></p><pre class="kg kh ki kj gt nm mz nn no aw np bi"><span id="db6d" class="na ma iq mz b gy nq nr l ns nt">.ads {<br/>   width: 1px;<br/>}</span></pre><p id="1c28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用JQuery编写一个脚本来检查元素的宽度</p><p id="2252" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> JavaScript </strong></p><pre class="kg kh ki kj gt nm mz nn no aw np bi"><span id="5b0f" class="na ma iq mz b gy nq nr l ns nt">$(document).ready(function(){<br/>    if($("#notify").width() &gt; <em class="nu">0</em>) {<br/>        alert('No AdBlocker');<br/>    } else {<br/>        alert('AdBlocker Detected');<br/>    }<br/>});</span></pre><h1 id="a8fd" class="lz ma iq bd mb mc nv me mf mg nw mi mj jw nx jx ml jz ny ka mn kc nz kd mp mq bi translated">流行的广告拦截脚本</h1><h2 id="5acb" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated"><a class="ae kv" href="https://www.detectadblock.com/" rel="noopener ugc nofollow" target="_blank">检测Adblock </a></h2><p id="5a4b" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">所有阻止列表都包含对“ads.js”的引用，因为这是与提供广告相关的JavaScript文件的通用名称。了解这一点后，将下面创建隐藏div的JavaScript代码保存到一个名为“ads.js”的文件中，并将其放在网站的根目录下。</p><pre class="kg kh ki kj gt nm mz nn no aw np bi"><span id="49e2" class="na ma iq mz b gy nq nr l ns nt">var e=document.createElement('div');<br/>e.id='ECKckuBYwZaP';<br/>e.style.display='none';<br/>document.body.appendChild(e);</span></pre><p id="68c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要检查是否加载了“ads.js”。将JavaScript放在HTML源代码中的</p><pre class="kg kh ki kj gt nm mz nn no aw np bi"><span id="3d63" class="na ma iq mz b gy nq nr l ns nt">&lt;script src="/ads.js" type="text/javascript"&gt;&lt;/script&gt;<br/>&lt;script type="text/javascript"&gt;<br/><br/>if(document.getElementById('ECKckuBYwZaP')){<br/>  alert('Blocking Ads: No');<br/>} else {<br/>  alert('Blocking Ads: Yes');<br/>}<br/><br/>&lt;/script&gt;</span></pre><h2 id="5c2d" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated"><a class="ae kv" href="https://github.com/sitexw/FuckAdBlock" rel="noopener ugc nofollow" target="_blank"> F**k AdBlock </a></h2><p id="740d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">F**k AdBlock是由社区开发的反广告拦截脚本，也称为BlockAdBlock。非常简单有效。你可以去他们的<a class="ae kv" href="https://github.com/sitexw/BlockAdBlock" rel="noopener ugc nofollow" target="_blank">网站</a>，参考代码和示例实现。</p><p id="e309" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">F**kAdBlock用的诱饵是这样的:</p><pre class="kg kh ki kj gt nm mz nn no aw np bi"><span id="4106" class="na ma iq mz b gy nq nr l ns nt">baitClass:   'pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links'</span></pre><p id="7bae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着它将通过参考由<a class="ae kv" href="https://www.iab.com/" rel="noopener ugc nofollow" target="_blank"> IAB </a>(互动广告局)推荐的标准名称和普通广告图像尺寸来激活广告拦截软件</p><h1 id="d64a" class="lz ma iq bd mb mc nv me mf mg nw mi mj jw nx jx ml jz ny ka mn kc nz kd mp mq bi translated">替代方法</h1><p id="4809" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">这是一个你可以借助Google Adsense ( <code class="fe mw mx my mz b">adsbygoogle.js</code> ) JavaScript文件进行编码的方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="d839" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用HEAD作为请求类型，因为它比GET小得多，也快得多。您可以将请求URL更改为任何已知的广告JavaScript并进行检查。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="22bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你会发现它们有用！如果你有自己的建议，请在下面的评论中分享。</p><h2 id="0f99" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="531d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kv" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="ky ir">JavaScript in Plain English</strong></a><a class="ae kv" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="ky ir">AI in Plain English</strong></a><a class="ae kv" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="ky ir">UX in Plain English</strong></a><a class="ae kv" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="ky ir">Python in Plain English</strong></a><strong class="ky ir"/>—谢谢，继续学习！</p><p id="f9d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我们总是有兴趣帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kv" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">submissions @ plain English . io</strong></a><strong class="ky ir"/>，附上您的媒体用户名和您感兴趣的内容，我们将会与您联系！</p></div></div>    
</body>
</html>