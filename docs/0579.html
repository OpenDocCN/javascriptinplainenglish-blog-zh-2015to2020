<html>
<head>
<title>TypeScript Tip of the Week: Generics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">本周打字提示:泛型</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typescript-tip-of-the-week-generics-57110db5b3cb?source=collection_archive---------5-----------------------#2019-11-11">https://javascript.plainenglish.io/typescript-tip-of-the-week-generics-57110db5b3cb?source=collection_archive---------5-----------------------#2019-11-11</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/0aea803169bd72a03e05d4508b367f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pjIz6nPbYSdgBkWlE4fYKA.png"/></div></div></figure><p id="7a43" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">周一快乐，感谢您阅读本周第一篇打字提示。我开始了这一系列有用的TypeScript见解和技巧，作为让更多人对使用TypeScript感兴趣的一种方式。</p><p id="1ce9" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">本周我想谈谈类型脚本泛型。有了支持TypeScript的令人难以置信的类型系统，泛型使您能够轻松地重用逻辑，并使您能够动态定义您期望从该逻辑返回的数据类型。让我们看一个例子。</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="f219" class="lg lh ir lc b gz li lj l lk ll">function foo&lt;T&gt;(arg: T): T {<br/> return arg;<br/>}</span><span id="4807" class="lg lh ir lc b gz lm lj l lk ll">const bar = foo&lt;string&gt;(‘baz’);</span></pre><p id="a427" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这是一个超级基础的例子，但是如果我们想对它进行运算会发生什么呢？</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="85d7" class="lg lh ir lc b gz li lj l lk ll">function foo&lt;T&gt;(arg: T): T {<br/> console.log(arg.length);<br/> return arg;<br/>}</span></pre><p id="9c76" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">有许多类型都有一个<code class="fe ln lo lp lc b">.length</code>属性，但是如果我们试图使用这个新代码，我们会得到一个错误，因为有些类型没有这个属性。为了解决这个问题，我们可以扩展这些类型。</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="d1e3" class="lg lh ir lc b gz li lj l lk ll">function foo&lt;T extends string&gt;(arg: T): T {<br/> console.log(arg.length);<br/> return arg;<br/>}</span></pre><p id="a518" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这是可行的，但是，这有点违背了初衷，因为<code class="fe ln lo lp lc b">T</code>可能是一个数组或一个带有长度属性的对象。使用自定义接口，我们可以专注于需要用泛型类型扩展的属性。</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="0fa9" class="lg lh ir lc b gz li lj l lk ll">interface GenericLengthType {<br/> length: number;<br/>}</span><span id="ecc3" class="lg lh ir lc b gz lm lj l lk ll">function foo&lt;T extends GenericLengthType&gt;(arg: T): T {<br/> console.log(arg.length);<br/> return arg;<br/>}</span><span id="149d" class="lg lh ir lc b gz lm lj l lk ll">const a = foo([‘foo’, ‘bar’, ‘baz’]);<br/>const b = foo(‘bar’);<br/>const c = foo({length: 10});<br/>const d = foo(10); // error number doesn’t have property length</span></pre><p id="6820" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这很好，但是让我们看一个更实际的例子，一个我在编写类型脚本代码时经常使用的例子。</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="6a43" class="lg lh ir lc b gz li lj l lk ll">function TryWrapper&lt;T extends Function&gt;(fn: T): T {<br/> return &lt;any&gt;function() {<br/>   try {<br/>     return fn(...arguments);<br/>   } catch (e) {<br/>     // handle error gracefully<br/>   }<br/> };<br/>}</span><span id="3f83" class="lg lh ir lc b gz lm lj l lk ll">const test = TryWrapper((arg: string) =&gt; {<br/> if (arg.length &lt; 5) {<br/>   throw new Error(“Argument length must be longer than 5”);<br/> }<br/> return arg.split(“”);<br/>});</span></pre><p id="57fa" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">我们在返回的函数上使用类型<code class="fe ln lo lp lc b">any</code>可能看起来很奇怪，但是，如果我们不在那里放置任何东西，我们会得到这个错误</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="9fb1" class="lg lh ir lc b gz li lj l lk ll">Type ‘(args: any) =&gt; any’ is not assignable to type ‘T’.<br/>‘(args: any) =&gt; any’ is assignable to the constraint of type ‘T’,<br/>but ‘T’ could be instantiated with a different subtype of constraint ‘Function’.</span></pre><p id="f056" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">当我们把那个<code class="fe ln lo lp lc b">any</code>去掉时，它基本上是想把那个类型赋给T，它告诉我们这是无效的。我们还使用了<code class="fe ln lo lp lc b">arguments</code>关键字来获取传递给函数的所有参数。然后使用spread操作符确保参数被传递到包装的函数中。我们这样做的原因是，一个包装的函数可能有几个参数传递给它，我们希望确保保留它们。</p><pre class="kx ky kz la gu lb lc ld le aw lf bi"><span id="5c9e" class="lg lh ir lc b gz li lj l lk ll">const add = TryWrapper((a: number, b: number) =&gt; a + b);</span></pre><p id="3ed5" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">这里有一个关于stackblitz的实例</p><figure class="kx ky kz la gu js"><div class="bz fq l di"><div class="lq lr l"/></div></figure><p id="7559" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">感谢阅读本周第一个打字技巧！在评论里说说你的看法。</p><p id="5a18" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">如果你喜欢这篇文章，我希望你<a class="ae ls" href="https://email.sam-redmond.com/" rel="noopener ugc nofollow" target="_blank">加入我的邮件列表</a>，在那里我会发送更多的提示&amp;技巧！</p><p id="e3ea" class="pw-post-body-paragraph jz ka ir kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ik bi translated">如果你觉得这篇文章有帮助，有趣，或娱乐性<a class="ae ls" href="https://email.sam-redmond.com/products/throw-me-a-bit" rel="noopener ugc nofollow" target="_blank">请给我买杯咖啡</a>来帮助我继续发布内容！</p></div></div>    
</body>
</html>