<html>
<head>
<title>How to explain JavaScript .filter() .map() and .reduce() to SQL users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何解释JavaScript？过滤器()。map()和。将()减少到SQL用户</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-explain-javascript-filter-map-and-reduce-to-sql-users-8f5b2d9726e6?source=collection_archive---------4-----------------------#2019-09-07">https://javascript.plainenglish.io/how-to-explain-javascript-filter-map-and-reduce-to-sql-users-8f5b2d9726e6?source=collection_archive---------4-----------------------#2019-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn js jt ju jv gh gi paragraph-image"><div class="gh gi jr"><img src="../Images/0b596a947db4fbf6ec477b821172f1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*5XYuk3NELArS93Ws5orPGA.png"/></div></figure><p id="da32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我发现使用<strong class="ka ir">。</strong>滤镜()<strong class="ka ir">。map() </strong>和<strong class="ka ir">。reduce() </strong> <em class="kw">数组方法</em>有助于降低代码复杂度，简化许多典型的数组数据处理任务。<strong class="ka ir"> </strong>查看<a class="ae kx" href="http://kangax.github.io/compat-table/es5/#test-Array_methods" rel="noopener ugc nofollow" target="_blank">http://kangax . github . io/compat-table/es5/# test-Array _ methods</a>，可以确认这些方法几乎兼容任何现代桌面/移动浏览器。</p><p id="1590" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">理解如何使用<strong class="ka ir">的好方法。过滤器()。map() </strong>和<strong class="ka ir">。reduce() </strong>是比较SELECT语句中每一条到<strong class="ka ir"> <em class="kw">的SQL数据操作</em> </strong>。考虑以下SQL查询:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="b6bc" class="lg lh iq jq b gy li lj l lk ll">SELECT<br/>category, SUM(amount) as total<br/>FROM transactions<br/>WHERE status = 'active'<br/>GROUP BY category</span></pre><p id="3c8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个通用SQL命令可以有三种类型的数据操作:<strong class="ka ir">映射</strong>或选择要显示的字段(<em class="kw">类别、总计</em>)，<strong class="ka ir">使用条件过滤</strong>数据(<em class="kw">状态=‘活动’</em>)，以及<strong class="ka ir">减少</strong>结果，使用指定一些<em class="kw">聚集组</em> ( <em class="kw">类别<strong class="ka ir">的<em class="kw">聚集函数</em> ( <em class="kw">总和</em>)生成汇总数据在Javascript中，这些操作可以使用<strong class="ka ir">来执行。</strong>滤镜()<strong class="ka ir">。map() </strong>和<strong class="ka ir">。reduce() </strong></strong></em></p><p id="a5d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">给定对象的Javascript <em class="kw">数组中的以下数据集，我将解释并向您展示每个数组方法的一些用法示例:</em></p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="a537" class="lg lh iq jq b gy li lj l lk ll">var transactions = [<br/>{ id: 4534, date: "2019–01–08", product: 112, price: 21, quantity: 2, taxes: 1.12, declined: false },<br/>{ id: 4535, date: "2019–01–08", product: 232, price: 32, quantity: 3, taxes: 2.19, declined: false },<br/>{ id: 4536, date: "2019–01–08", product: 554, price: 7, quantity: 100, taxes: 10.55, declined: true },<br/>{ id: 4537, date: "2019–01–08", product: 433, price: 21, quantity: 2, taxes: 1.12, declined: false },<br/>{ id: 4538, date: "2019–01–08", product: 112, price: 21, quantity: 4, taxes: 2.24, declined: false }<br/>];</span></pre><h2 id="6f61" class="lg lh iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated"><strong class="ak">滤镜()</strong></h2><p id="1f5f" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们使用<strong class="ka ir"> filter() </strong>作为要执行的第一个操作，因为它减少了处理信息的行数。</p><p id="8962" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe jn jo jp jq b">result = myArray.<strong class="ka ir">filter</strong>( <em class="kw">filterFunc</em> )</code></p><p id="f14e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw"> filterFunc </em> </strong>每次取<em class="kw">数组</em>中的一个元素，并且必须从结果中返回<strong class="ka ir"> true </strong>到<em class="kw"> include </em>(或<strong class="ka ir"> false </strong>到<em class="kw"> exclude) </em>该项。</p><p id="eaea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="0b1b" class="lg lh iq jq b gy li lj l lk ll">var activeTransactions = transactions.<strong class="jq ir">filter</strong>(function(<em class="kw">item</em>){<br/>  return !<em class="kw">item</em>.declined<br/>})</span></pre><p id="130b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在<code class="fe jn jo jp jq b">activeTransactions</code>将只包含<code class="fe jn jo jp jq b">declined</code>为<code class="fe jn jo jp jq b">true</code>的交易。在本例中，是5分之4。这相当于以下SQL查询:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="48f4" class="lg lh iq jq b gy li lj l lk ll">SELECT * FROM transactions WHERE NOT declined</span></pre><h2 id="a6a9" class="lg lh iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">地图()</h2><p id="a3af" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们可以用<strong class="ka ir"> map() </strong> to <strong class="ka ir"> <em class="kw">选择</em> </strong> <em class="kw"> </em> <strong class="ka ir"> <em class="kw">哪些字段</em> </strong>将是结果的一部分。</p><p id="e858" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe jn jo jp jq b">result = myArray.<strong class="ka ir">map</strong>( <em class="kw">mapFunc</em> )</code></p><p id="8836" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw"> mapFunc </em> </strong>每次取<code class="fe jn jo jp jq b">myArray</code>的一个元素，必须返回一个值或者对象映射元素属性。</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="f219" class="lg lh iq jq b gy li lj l lk ll">var totals = transactions.<strong class="jq ir">map</strong>(function(<em class="kw">item</em>){<br/>  return { <br/>    productId: <em class="kw">item</em>.product, <br/>    totalAmount : <em class="kw">item</em>.price * <em class="kw">item</em>.quantity + <em class="kw">item</em>.taxes <br/>  }<br/>})</span></pre><p id="260c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在<code class="fe jn jo jp jq b">totals</code>将包含一个对象数组，每个对象只有两个字段<strong class="ka ir"><em class="kw"/></strong>:product id(别名<code class="fe jn jo jp jq b">.product</code>)和totalAmount(根据<code class="fe jn jo jp jq b">.price</code> <code class="fe jn jo jp jq b">.quantity</code>和<code class="fe jn jo jp jq b">.taxes</code>计算)。这相当于以下SQL查询:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="48ed" class="lg lh iq jq b gy li lj l lk ll">SELECT product as productId, price*quantity+taxes as totalAmount <br/>FROM transactions</span></pre><h2 id="c82a" class="lg lh iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">减少()</h2><p id="e6d8" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">最后，我们可以从数据集中得到一个值的<strong class="ka ir">汇总</strong>(或者只是一个最终值)，将行减少到一个元素。</p><p id="14bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe jn jo jp jq b">result = myArray.<strong class="ka ir">reduce</strong>( reduceFunc, initialAccum )</code></p><p id="663b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw"> reduceFunc </em> </strong>取一个<em class="kw">累加器</em>和<em class="kw">myArray的每个元素</em>，累加值，返回最终汇总。<code class="fe jn jo jp jq b">initialAccum</code>是你的结果的初始值，从要累加的值开始(比如从<strong class="ka ir"> <em class="kw">零</em> </strong>开始)。</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="0aec" class="lg lh iq jq b gy li lj l lk ll">var total = transactions.<strong class="jq ir">reduce</strong>(function(<em class="kw">accum</em>, <em class="kw">item</em>){<br/>  return { <br/>    total: <em class="kw">accum</em>.total + <em class="kw">item</em>.quantity*<em class="kw">item</em>.price+<em class="kw">item</em>.taxes,<br/>    count: <em class="kw">accum</em>.count + 1<br/>  }<br/>}, {total: 0, count: 0} )</span></pre><p id="9e0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在<code class="fe jn jo jp jq b">total</code>将包含总计金额<code class="fe jn jo jp jq b">total</code>和处理了多少交易(<code class="fe jn jo jp jq b">count</code>)。这相当于以下SQL查询:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="c212" class="lg lh iq jq b gy li lj l lk ll">SELECT <br/>SUM(price*quantity+taxes) as '<strong class="jq ir">total'</strong>, count(1) as '<strong class="jq ir">count'</strong> <br/>FROM transactions</span></pre><p id="ed85" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有时，你只需要返回一个<strong class="ka ir"> <em class="kw">单个最终值</em> </strong>，在这种情况下你的累加器必须是单个值(下例中的<code class="fe jn jo jp jq b">0</code>):</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="5c06" class="lg lh iq jq b gy li lj l lk ll">var total = transactions.reduce(function(accum, item){<br/>  return accum + item.quantity*item.price+item.taxes<br/>}, 0 )</span></pre><h2 id="b5c4" class="lg lh iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">混合在一起</h2><p id="951c" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">最后，因为<strong class="ka ir">。</strong>滤镜()<strong class="ka ir">。地图()</strong>和<strong class="ka ir">。reduce() </strong>返回数组，你可以把所有的东西放在一个调用链中，得到一个最终的结果，如下所示:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="645a" class="lg lh iq jq b gy li lj l lk ll">// Total amount of transactions not declined<br/>var total = <br/>   transactions<br/>   <strong class="jq ir">.filter</strong>(function(item){ <br/>     return !item.declined <br/>   })<br/>   <strong class="jq ir">.map</strong>(function(item){ <br/>     return { <br/>       totalAmount : item.price * item.quantity + item.taxes <br/>     }<br/>   })<br/>   <strong class="jq ir">.reduce</strong>(function(accum, item){<br/>     return accum + item.totalAmount<br/>   }, 0 )</span></pre><p id="71aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这相当于以下SQL查询的结果:</p><pre class="ky kz la lb gt lc jq ld le aw lf bi"><span id="831a" class="lg lh iq jq b gy li lj l lk ll">SELECT <br/>SUM(<em class="kw">price</em>*<em class="kw">quantity</em>+<em class="kw">taxes</em>) <br/>FROM transactions<br/>WHERE NOT <em class="kw">declined</em></span></pre><h2 id="c7ed" class="lg lh iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">自己做</h2><p id="ee8e" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">您可以自己尝试运行和修改以下Javascript演示，并提供更多示例:</p><figure class="ky kz la lb gt jv"><div class="bz fp l di"><div class="mi mj l"/></div></figure></div></div>    
</body>
</html>