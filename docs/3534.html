<html>
<head>
<title>An under the hood look at the map() function in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入了解JavaScript中的map()函数</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/an-under-the-hood-look-at-map-in-javascript-bf1018da737b?source=collection_archive---------10-----------------------#2020-10-06">https://javascript.plainenglish.io/an-under-the-hood-look-at-map-in-javascript-bf1018da737b?source=collection_archive---------10-----------------------#2020-10-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="25d6" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何从头开始构建map()函数的小演练的第一部分</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/c23b07166f8d97ee69c853232899bb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ngxh9U4dFiJo7UCL"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@cookiethepom?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Cookie the Pom</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="888d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不久前，一个朋友向我挑战，要我建造。map( ) native方法，并更进一步，白板演示当涉及到全局执行上下文、全局内存和调用堆栈时会发生什么。作为一个彻头彻尾的编码游戏新手，我看了一眼这个挑战，然后离开了舞台。</p><p id="d05f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">回过头来看，这是一项艰巨的任务，尤其是对于刚刚学会如何用<em class="lp"> let </em>和<em class="lp"> const声明变量的人来说。</em>但我发现学习如何建造。map()帮助我更好地理解了JavaScript是如何工作的。</p><p id="cd85" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是由两部分组成的系列的第一部分:第一部分将简单地构建. map()函数，第二部分将展示JavaScript如何工作，解释全局执行上下文、全局内存和执行线程。所以，对于所有正在阅读这篇文章的人，我终于征服了曾经是我的珠穆朗玛峰。</p><h2 id="cd47" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">首先，什么是。map()？</h2><p id="f0cf" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">根据MDN web docs，map方法“<strong class="kv io"> <em class="lp">创建一个新的数组</em> </strong> <em class="lp">，用调用数组中每个元素上提供的函数的结果填充</em></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="6454" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">尽管我对JavaScript文档有着特殊的兴趣，但对于第一次阅读这篇文章的人来说，当你意识到并非所有这些都有意义时，你可能会听到脑海中响起悲伤的小提琴声。所以这里有一个更快捷的解释方法:</p><ol class=""><li id="cdca" class="mq mr in kv b kw kx kz la lc ms lg mt lk mu lo mv mw mx my bi translated">。map()是JavaScript中存在的数组方法。</li><li id="a52f" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo mv mw mx my bi translated">它接受另一个函数作为参数，这就是所谓的回调函数——根据定义，回调函数是传递给另一个函数的函数。</li><li id="cb34" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo mv mw mx my bi translated">它将这个传入的函数(回调)应用于数组中被调用的每个元素。</li><li id="8ff8" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo mv mw mx my bi translated">最后，它返回一个包含计算值的新数组。</li></ol><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="2fd3" class="lq lr in nf b gy nj nk l nl nm">array.map(callback)  =&gt;Syntax </span></pre><h2 id="a526" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">为什么我们要用？map()？</h2><p id="144c" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">当你第一次学习编码时，作为一般的经验法则，你经常被告知不要改变原始数据。太好了！不要改变数据。如果你和我一样，你需要一个具体的理由，比如为什么你不应该做某件事，否则你的思想会徘徊在如果你做了会发生什么的可能性上。所以对于所有像我一样的人来说，这里有一个很小的列表，列出了突变不好的原因。</p><ol class=""><li id="f305" class="mq mr in kv b kw kx kz la lc ms lg mt lk mu lo mv mw mx my bi translated">如果您改变了代码中的一部分数据，可能会导致代码中的另一部分发生变化，这意味着出现错误，除非您喜欢浪费时间来修复错误，否则这不是对时间的有效利用。</li><li id="1c42" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo mv mw mx my bi translated">当涉及到修复由突变引起的bug时，很难精确定位代码崩溃的确切位置。</li><li id="9992" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo mv mw mx my bi translated">从更大的角度来看——比如说，你在一家大型公司工作，这家公司将数据托管在远程服务器上，或者使用云计算。作为在公司工作的人，你需要在本地访问数据，这样你就可以运行一些代码(你想出的解决方案)。通过不改变你电脑上的数据，你可以更大规模地高效工作。</li></ol><p id="e46b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">简而言之，您不希望更改您的数据，而是希望以某种方式使用它，同时保持原始数据不变。这就是。map()进来，它不会改变原始数组。相反，在map方法中，一旦对原始数组中的每个元素进行了回调计算，它就分配一个新的空数组(在幕后)并返回这个新数组。如果这没有意义，请不要担心，我将在下一节和下一篇博文中展示这是如何实现的。这里的关键是原始数组保持不变。</p><p id="d9ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">把它想象成隔离期间的Instagram帖子，你可能会打扮好，化妆，可能会使用滤镜，然后拍出惊人的照片。事实是，当你脱下所有你已经应用的，跳回你舒适的睡衣，你保持不变(你是原来的数组)。图片直播，在Instagram上。在本例中，图片是新的数组，所有在幕后完成的工作是。map()方法。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nn mp l"/></div></figure></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><h2 id="818a" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">正在建设。地图( )</h2><p id="45c3" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">对于这个具体的例子，我们将从声明一个我们将要处理的数组开始。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="0e6e" class="lq lr in nf b gy nj nk l nl nm">let originalArray= [1,2,3,4]</span></pre><p id="b321" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其次，让我们构建回调函数，我们将把它传递给我们的map函数。对于这个回调函数，我希望传入的数字(参数)在返回时加上2。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="9283" class="lq lr in nf b gy nj nk l nl nm"><strong class="nf io">Regular function declaration:</strong></span><span id="5c87" class="lq lr in nf b gy nv nk l nl nm">function addTwo(num){<br/>    return num + 2;<br/>}</span><span id="d353" class="lq lr in nf b gy nv nk l nl nm"><strong class="nf io">Arrow function:</strong></span><span id="e4ae" class="lq lr in nf b gy nv nk l nl nm">let addTwo=(num)=&gt;{num +2}</span><span id="2af9" class="lq lr in nf b gy nv nk l nl nm">// a number will be passed in and the return value will be the number+2 </span></pre><p id="62f0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">第三，我们将构建带有两个参数的map函数，一个数组和一个回调。正如每个程序员都会建议的那样，我也将在下一节中这样做，最好是从伪代码开始，然后构建函数。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="4536" class="lq lr in nf b gy nj nk l nl nm">//map function-takes in array, and callback function,</span><span id="9500" class="lq lr in nf b gy nv nk l nl nm">//declare a new variable and assign it to an empty array,</span><span id="1fc2" class="lq lr in nf b gy nv nk l nl nm">//initiate a for loop that will iterate through the array and invoke the callback function with the values of array[i] being passed to it within the for loop</span><span id="ec74" class="lq lr in nf b gy nv nk l nl nm">// push that evaluated result into the new array,</span><span id="b4c0" class="lq lr in nf b gy nv nk l nl nm">//return the new array,</span></pre><p id="e05e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在伪代码之后:</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="9ab1" class="lq lr in nf b gy nj nk l nl nm">function map(array,callback){<br/>    let newArray=[];</span><span id="0f0b" class="lq lr in nf b gy nv nk l nl nm">    for (let i=0; i&lt;array.length; i++){<br/>         newArray.push(callback(array[i]))<br/>    };</span><span id="d005" class="lq lr in nf b gy nv nk l nl nm">    return newArray<br/>}</span></pre><p id="c94c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上面的map函数就是native的方法。地图正在引擎盖下做。下面的代码片段将向您展示如何调用map函数、我们的特定代码片段的返回值，以及如何使用本机map方法语法。</p><pre class="kd ke kf kg gt ne nf ng nh aw ni bi"><span id="5533" class="lq lr in nf b gy nj nk l nl nm">//to invoke function</span><span id="24a2" class="lq lr in nf b gy nv nk l nl nm"><strong class="nf io">map(originalArray, addTwo)</strong></span><span id="037e" class="lq lr in nf b gy nv nk l nl nm">//will return [3,4,5,6]</span><span id="6d96" class="lq lr in nf b gy nv nk l nl nm">//to use the native map method syntax</span><span id="87d7" class="lq lr in nf b gy nv nk l nl nm"><strong class="nf io">originalArray.map(addTwo)</strong> or<br/><strong class="nf io">originalArray.map(num=&gt;num+2)</strong></span></pre></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><h2 id="5fcb" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">结论</h2><p id="f526" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">在下一个系列中，我们将使用相同的map函数来研究JavaScript如何在代码行中运行，它在代码行中存储变量、函数和对象的值。以及JavaScript中的执行上下文。但是现在，这里是关键的要点:</p><ul class=""><li id="b392" class="mq mr in kv b kw kx kz la lc ms lg mt lk mu lo nw mw mx my bi translated">不要改变你的数据！</li><li id="8da6" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo nw mw mx my bi translated">。map()在数组上被调用，</li><li id="7d85" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo nw mw mx my bi translated">。map()接受一个回调函数并返回一个新数组，</li><li id="93b2" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo nw mw mx my bi translated">。map()不会改变调用它的原始数组。</li></ul></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><h2 id="0798" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">参考</h2><ul class=""><li id="4da6" class="mq mr in kv b kw mj kz mk lc nx lg ny lk nz lo nw mw mx my bi translated"><a class="ae ks" href="https://alistapart.com/article/why-mutation-can-be-scary/" rel="noopener ugc nofollow" target="_blank">https://alistapart.com/article/why-mutation-can-be-scary/</a></li><li id="0e25" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo nw mw mx my bi translated"><a class="ae ks" href="https://www.geeksforgeeks.org/javascript-array-map-method/" rel="noopener ugc nofollow" target="_blank">https://www.geeksforgeeks.org/javascript-array-map-method/</a></li><li id="a7bc" class="mq mr in kv b kw mz kz na lc nb lg nc lk nd lo nw mw mx my bi translated"><a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Global _ Objects/Array/map</a></li></ul></div></div>    
</body>
</html>