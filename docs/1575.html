<html>
<head>
<title>Creating Web Components with Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用角度创建Web组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-web-components-with-angular-c353413e42da?source=collection_archive---------3-----------------------#2020-04-02">https://javascript.plainenglish.io/creating-web-components-with-angular-c353413e42da?source=collection_archive---------3-----------------------#2020-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/67743de3b6149b5273acd40f2283f8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dNTClVQDITqgTjM7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@borisworkshop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Boris Smokrovic</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="290c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Angular是Google制作的一个流行的前端框架。像其他流行的前端框架一样，它使用基于组件的架构来构建应用程序。</p><p id="7ad2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何创建Angular元素，这些元素被打包成Web组件。</p><h1 id="a536" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">角度元素</h1><p id="8370" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">大多数浏览器都支持Web组件，如Chrome、Firefox、Opera或Safari。</p><p id="3faa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将Angular组件转换成Web组件，使所有的Angular基础设施对浏览器可用。</p><p id="e136" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像数据绑定和其他角度功能这样的特性被映射到它们的HTML等价物。</p><h1 id="b523" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建和使用自定义元素</h1><p id="72f3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过创建一个角度组件来创建一个Web组件，然后将其构建到Web组件中。</p><p id="0c20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要用Angular创建一个Web组件，我们必须做一些事情。</p><p id="637d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们创建一个组件来构建Web组件。然后，我们必须将我们创建的组件设置为入口点。</p><p id="5d3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将它添加到DOM中。</p><p id="47cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将制作一个自定义组件来获取笑话。为此，我们首先运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="cf26" class="mn lc iq mj b gy mo mp l mq mr">ng g component customJoke<br/>ng g service joke</span></pre><p id="4abb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建我们的组件和服务来获取我们的笑话并显示它。</p><p id="4e73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0964" class="mn lc iq mj b gy mo mp l mq mr">ng add @angular/element</span></pre><p id="4299" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加角度元素文件来创建我们的Web组件。</p><p id="a04a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe ms mt mu mj b">joke.service.ts</code>中，我们添加:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="b5c2" class="mn lc iq mj b gy mo mp l mq mr">import { Injectable } from '@angular/core';</span><span id="e551" class="mn lc iq mj b gy mv mp l mq mr">@Injectable({<br/>  providedIn: 'root'<br/>})<br/>export class JokeService {</span><span id="1e97" class="mn lc iq mj b gy mv mp l mq mr">  constructor() { }</span><span id="19ce" class="mn lc iq mj b gy mv mp l mq mr">  async getJokeById(id: number) {<br/>    const response = await fetch(`http://api.icndb.com/jokes/${id}`)<br/>    const joke = await response.json();<br/>    return joke;<br/>  }<br/>}</span></pre><p id="71e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的代码通过ID从Chuck Norris API获取了一个笑话。</p><p id="8cc7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们编写组件代码如下:</p><p id="13f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">app.module.ts</code>:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="597f" class="mn lc iq mj b gy mo mp l mq mr">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule, Injector } from '@angular/core';<br/>import { AppComponent } from './app.component';<br/>import { CustomJokeComponent } from './custom-joke/custom-joke.component';<br/>import { JokeService } from './joke.service';</span><span id="9df8" class="mn lc iq mj b gy mv mp l mq mr">@NgModule({<br/>  declarations: [<br/>    CustomJokeComponent,<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>  ],<br/>  providers: [JokeService],<br/>  bootstrap: [AppComponent],<br/>  entryComponents: [CustomJokeComponent]<br/>})<br/>export class AppModule {</span><span id="747c" class="mn lc iq mj b gy mv mp l mq mr">}</span></pre><p id="fc20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe ms mt mu mj b">AppModule</code>中，我们将<code class="fe ms mt mu mj b">CustomJokeComponent</code>添加到<code class="fe ms mt mu mj b">entryComponents</code>，这样它将成为入口点组件，而不是<code class="fe ms mt mu mj b">AppComponent</code>。</p><p id="c963" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它将在<code class="fe ms mt mu mj b">custom-joke</code>元素被创建时加载。</p><p id="cb96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">app.component.ts</code>:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="79bb" class="mn lc iq mj b gy mo mp l mq mr">import { Component, Injector } from '@angular/core';<br/>import { createCustomElement, WithProperties, NgElement } from '@angular/elements';<br/>import { CustomJokeComponent } from './custom-joke/custom-joke.component';</span><span id="f235" class="mn lc iq mj b gy mv mp l mq mr">@Component({<br/>  selector: 'app-root',<br/>  template: ''<br/>})<br/>export class AppComponent {<br/>  constructor(injector: Injector) {<br/>    const JokeElement = createCustomElement(CustomJokeComponent, { injector });<br/>    customElements.define('custom-joke', JokeElement);<br/>    this.showAsElement(20);<br/>  }</span><span id="6630" class="mn lc iq mj b gy mv mp l mq mr">  showAsElement(id: number) {<br/>    const jokeEl: WithProperties&lt;CustomJokeComponent&gt; = document.createElement('custom-joke') as any;<br/>    jokeEl.id = id;<br/>    document.body.appendChild(jokeEl as any);<br/>  }<br/>}</span></pre><p id="afa5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">constructor</code>中的代码创建定制组件，并用我们的<code class="fe ms mt mu mj b">showAsElement</code>方法将其附加到DOM。</p><p id="537d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">createCustomElement</code>来自我们的<code class="fe ms mt mu mj b">@angular/element</code>代码。</p><p id="f6f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">showAsElement</code>方法加载我们之前定义的<code class="fe ms mt mu mj b">custom-joke</code> Web组件。</p><p id="31e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">custom-joke.component.ts</code>:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="b54a" class="mn lc iq mj b gy mo mp l mq mr">import { Component, OnInit, ViewEncapsulation, Input } from '@angular/core';<br/>import { JokeService } from '../joke.service';</span><span id="c69a" class="mn lc iq mj b gy mv mp l mq mr">@Component({<br/>  selector: 'custom-joke',<br/>  template: `&lt;p&gt;{{joke?.value?.joke}}&lt;/p&gt;`,<br/>  styles: [`p { font-size: 20px }`],<br/>  encapsulation: ViewEncapsulation.Native<br/>})<br/>export class CustomJokeComponent implements OnInit {<br/>  @Input() id: number = 1;<br/>  joke: any = {};</span><span id="c9f3" class="mn lc iq mj b gy mv mp l mq mr">  constructor(private jokeService: JokeService) { }</span><span id="3967" class="mn lc iq mj b gy mv mp l mq mr">  async ngOnInit() {<br/>    this.joke = await this.jokeService.getJokeById(this.id)<br/>  }</span><span id="e3b0" class="mn lc iq mj b gy mv mp l mq mr">}</span></pre><p id="cea6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们把所有东西都放在一个文件中，这样它们都可以包含在我们的<code class="fe ms mt mu mj b">custom-joke</code> Web组件中。</p><p id="d425" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">@Input</code>将被转换成一个属性，我们可以将一个数字传递给它，并通过它的ID获取笑话。</p><p id="44f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">custom-joke.component.html</code>和<code class="fe ms mt mu mj b">app.component.html</code>留空。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/4640974075fc7778494ad620dd305bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uslthZzCzF6ebhcf"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">David Clode</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="251d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1ee8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们使用<code class="fe ms mt mu mj b">@angular/element</code>包来创建一个我们可以使用的Web组件。</p><p id="8b90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不同之处在于我们内嵌了模板和样式。</p><p id="ca6f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们必须注册组件并将其附加到DOM。</p><p id="4fa0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">【JavaScript用简单的英语写的一句话:我们总是乐于帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到submissions@javascriptinplainenglish.com<a class="ae kc" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">给我们，我们会把你添加为作者。</a></p></div></div>    
</body>
</html>