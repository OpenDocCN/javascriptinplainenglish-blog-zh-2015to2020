<html>
<head>
<title>A deep dive into Angular’s Renderer2.setValue method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入探讨Angular的渲染器2.setValue方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-deep-dive-into-angulars-renderer2-setvalue-method-229fa210e7d3?source=collection_archive---------1-----------------------#2020-07-19">https://javascript.plainenglish.io/a-deep-dive-into-angulars-renderer2-setvalue-method-229fa210e7d3?source=collection_archive---------1-----------------------#2020-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/62eb2ca56652f656daf015150f0b78e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2vUcN3WFfrLuh00g_D2Xcw.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/@artemverbo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Artem Verbo</a> on <a class="ae jd" href="https://unsplash.com/s/photos/deep-dive?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="f6fb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">解释为什么Renderer.setValue方法不能按照您想象的方式工作</p><p id="d168" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Angular中构建组件/指令时，我们经常会遇到需要在本机元素上更新值/textContent的情况。这可以通过多种方式实现，但Angular建议的方式是使用<code class="fe lb lc ld le b">Renderer</code> API。</p><p id="b247" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">渲染器有很多方法，其中之一就是<code class="fe lb lc ld le b">Renderer's</code> setValue方法。这实际上让我很困惑，因为它并不适用于所有类型的元素。所以，本文将帮助您详细理解这个方法，这样您就不用花费数小时来弄清楚为什么这个方法不起作用。</p><blockquote class="lf lg lh"><p id="4fc3" class="kd ke li kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated"><strong class="kf jh">From docs:</strong>set value()<br/>实现这个回调来设置宿主元素中某个节点的值。</p><p id="d120" class="kd ke li kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">API:抽象<strong class="kf jh">设置值</strong>(节点:任意，值:字符串):无效</p></blockquote><p id="7090" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个方法很简单，只需要一个节点和一个值。让我们用一个简单的例子来尝试一下。</p><p id="f3d0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个简单的例子:</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lm"><img src="../Images/c309889898c442625f88a38bb7a66f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FswDV0WwYvIo7ZQv9i03Qg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">A simple directive that changes content dynamically</figcaption></figure><p id="f7fa" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们有一个<code class="fe lb lc ld le b">changeContentDir</code>指令，就是更新宿主元素的内容，我们使用renderer.setValue方法来完成这个任务。后一部分是使用该指令的示例模板。</p><p id="5330" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在的问题是，它有效吗？答案是否定的。但为什么呢？让我们现在开始吧。</p><blockquote class="lf lg lh"><p id="053c" class="kd ke li kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated"><strong class="kf jh">注意:</strong>在Javascript中，所有元素都是节点，但是所有节点都不是元素。这就是上述代码更改不起作用的主要原因。</p></blockquote><p id="b479" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们退后一步，了解这个<code class="fe lb lc ld le b">setValue</code>方法的作用。</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lr"><img src="../Images/8cfb4bb8c3ed3bb1cf45b2ae6275854d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVVva6eGwPvSSlmZTT6b_g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Renderer.setValue implementation</figcaption></figure><p id="4537" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">setValue</code>方法接受一个节点和一个需要更新的值。</p><p id="0fed" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，这是什么<code class="fe lb lc ld le b">nodeValue</code>？让我们找出答案。</p><blockquote class="lf lg lh"><p id="6ef6" class="kd ke li kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">MDN Docs:<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeValue" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/Docs/Web/API/Node/Node value</a><br/>界面的<code class="fe lb lc ld le b"><strong class="kf jh">nodeValue</strong></code>属性返回或设置当前节点的值。</p></blockquote><p id="1f16" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有元素都有这个<code class="fe lb lc ld le b">nodeValue</code>属性，但是在所有类型的元素上设置这个值是无效的。它只适用于某些节点类型，文本节点就是其中之一。</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ls"><img src="../Images/9942914ba49447901b0d66bda76aa8a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pju5p8tHVlZpAukr0C7WZw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">A picture form MDN docs describing what type of nodes can be</figcaption></figure><blockquote class="lf lg lh"><p id="8fce" class="kd ke li kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">更多关于nodeValue的信息可以在这里<br/><a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeValue" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/Node/Node value</a></p></blockquote><p id="1882" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果我们回过头来看看我们的更改，您会注意到,<code class="fe lb lc ld le b">setValue</code>方法实际上试图在类型为<code class="fe lb lc ld le b">Element</code>的节点上更新<code class="fe lb lc ld le b">nodeValue</code>,但没有任何效果。</p><h1 id="adaa" class="lt lu jg bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">我们如何更新元素值？</h1><p id="4389" class="pw-post-body-paragraph kd ke jg kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">由于<code class="fe lb lc ld le b">setValue</code>与<code class="fe lb lc ld le b">Text</code>节点一起工作，我们必须将作为div元素的子元素的文本节点直接传递给<code class="fe lb lc ld le b">setValue</code>方法，现在值得到了更新。</p><p id="c755" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是进行这些更改后的样子:</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/0118a4c08e83b2e45fd57f20acd9a9d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H6RZLS1lCba1FMjMSKpe2g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Updating the child text node value</figcaption></figure><h1 id="1295" class="lt lu jg bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">更改和更新不同类型元素的值的替代方法:</h1><p id="7f4a" class="pw-post-body-paragraph kd ke jg kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">作为Renderer2 API的一部分，还有其他有用的方法可以用来更新innerText的值/元素的值。其中一个是<code class="fe lb lc ld le b">setProperty</code>，可以用来更新<code class="fe lb lc ld le b">Elements</code>上的值，如<code class="fe lb lc ld le b">Input</code>、<code class="fe lb lc ld le b">TextArea</code>等..(类似于具有<code class="fe lb lc ld le b">value</code>类型的元素)</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/c6fee7b7c51cc952cd69b2d90ff9b79b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvAr3m_N1rIX2-lAjdKSUw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Examples for setProperty method</figcaption></figure></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="7502" class="lt lu jg bd lv lw ne ly lz ma nf mc md me ng mg mh mi nh mk ml mm ni mo mp mq bi translated"><strong class="ak">结论:</strong></h1><p id="9377" class="pw-post-body-paragraph kd ke jg kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated"><code class="fe lb lc ld le b">renderer.setValue</code>方法通常是一个令人困惑的部分，并不适用于所有的元素。简单地说，renderer.setValue方法接受一个<strong class="kf jh">节点、</strong>而不是<strong class="kf jh">元素。</strong></p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="bc62" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望这对您有所帮助！关注更多有趣的文章</p><h2 id="782f" class="nj lu jg bd lv nk nl dn lz nm nn dp md ko no np mh ks nq nr ml kw ns nt mp nu bi translated">简单英语的JavaScript</h2><p id="af1d" class="pw-post-body-paragraph kd ke jg kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae jd" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf jh">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf jh">！</strong></p></div></div>    
</body>
</html>