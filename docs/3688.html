<html>
<head>
<title>Building an Animated Counter with React and CSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React和CSS构建动画计数器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/attempting-to-build-a-cool-animated-counter-with-react-and-css-e37f7f2d47e4?source=collection_archive---------3-----------------------#2020-10-18">https://javascript.plainenglish.io/attempting-to-build-a-cool-animated-counter-with-react-and-css-e37f7f2d47e4?source=collection_archive---------3-----------------------#2020-10-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="5dc1" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在这篇博客中，我试图创建我自己版本的动画计数器组件，我一直在网上到处寻找</h2></div><p id="5b65" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我会告诉你我是怎么做的，但我希望得到反馈。有更好的方法吗？</p><p id="7b23" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请在<code class="fe ky kz la lb b">jason.melton2@gmail.com</code>给我留言或发邮件。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/027130f99db4654a3225e497a10fd788.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/1*teuNCFz-eydpbdJ7O0FGmg.gif"/></div></figure><blockquote class="lk ll lm"><p id="eaf0" class="kc kd ln ke b kf kg jo kh ki kj jr kk lo km kn ko lp kq kr ks lq ku kv kw kx ig bi translated"><a class="ae lr" href="https://github.com/cooljasonmelton/count-comp" rel="noopener ugc nofollow" target="_blank"><em class="in">Github上的代码</em> </a></p></blockquote><h1 id="f68f" class="ls lt in bd lu lv lw lx ly lz ma mb mc jt md ju me jw mf jx mg jz mh ka mi mj bi translated">辅导的</h1><h2 id="3366" class="mk lt in bd lu ml mm dn ly mn mo dp mc kl mp mq me kp mr ms mg kt mt mu mi mv bi translated">目录</h2><ul class=""><li id="e8a7" class="mw mx in ke b kf my ki mz kl na kp nb kt nc kx nd ne nf ng bi translated">初级垃圾</li><li id="2a29" class="mw mx in ke b kf nh ki ni kl nj kp nk kt nl kx nd ne nf ng bi translated">计数组件</li><li id="d113" class="mw mx in ke b kf nh ki ni kl nj kp nk kt nl kx nd ne nf ng bi translated">增量函数</li><li id="c7d9" class="mw mx in ke b kf nh ki ni kl nj kp nk kt nl kx nd ne nf ng bi translated">结论</li></ul><h2 id="65e1" class="mk lt in bd lu ml mm dn ly mn mo dp mc kl mp mq me kp mr ms mg kt mt mu mi mv bi translated">初级垃圾</h2><p id="cee4" class="pw-post-body-paragraph kc kd in ke b kf my jo kh ki mz jr kk kl nm kn ko kp nn kr ks kt no kv kw kx ig bi translated">我设置了一个<code class="fe ky kz la lb b">create-react-app</code>，删除了一堆默认的东西，还有一个这样的文件结构:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi np"><img src="../Images/c460a8799ee34f0a79e826f693918932.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/format:webp/1*KaPEgIrkT1PiLX035GTdmA.png"/></div></figure><p id="f303" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我向应用程序组件添加了一些基本的CSS高度、宽度和一个flex框，用于居中显示所有内容。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/dbb343e4d194bc6bc03f72b0ee3c594a.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*8jyVCbpeKkSHvdKzEukDYg.png"/></div></figure><p id="ccba" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我还设置了一个json文件，其中包含我将映射到Count组件中的数据。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/88b8b44a6985a8ea916653b2334efd94.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*9wVMcZzn4AjM5MbRexgl3g.png"/></div></figure><h2 id="38cd" class="mk lt in bd lu ml mm dn ly mn mo dp mc kl mp mq me kp mr ms mg kt mt mu mi mv bi translated">计数组件</h2><p id="48e6" class="pw-post-body-paragraph kc kd in ke b kf my jo kh ki mz jr kk kl nm kn ko kp nn kr ks kt no kv kw kx ig bi translated">我的计数组件的对象是接受一些关于计数应该如何运行和渲染动画的数据。</p><p id="6aa4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，我设置了一个基本组件。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/0787ab1d3217c348fc997388a80149c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*hs7aUwRSi_qEC3P1if3jHg.png"/></div></figure><p id="7160" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Count从data.json中获取一个数据项的道具，我从道具中析构了<code class="fe ky kz la lb b">label</code>、<code class="fe ky kz la lb b">number</code>、<code class="fe ky kz la lb b">duration</code>。</p><p id="4f0b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用JSX，我返回<code class="fe ky kz la lb b">label</code>和<code class="fe ky kz la lb b">number</code>作为标题。稍后，我将更改<code class="fe ky kz la lb b">number</code>使其具有动画效果，但现在我可以对我正在构建的硬编码版本进行样式化。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d610f9b63453bfac811241e138b36755.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*yEO0RCwz7qOx21VQh3n5Ng.png"/></div></figure><h2 id="04b7" class="mk lt in bd lu ml mm dn ly mn mo dp mc kl mp mq me kp mr ms mg kt mt mu mi mv bi translated">增量函数</h2><p id="f4ea" class="pw-post-body-paragraph kc kd in ke b kf my jo kh ki mz jr kk kl nm kn ko kp nn kr ks kt no kv kw kx ig bi translated">我将建立一个函数，在这三个步骤中从0递增到所需的数字。</p><ol class=""><li id="8cf1" class="mw mx in ke b kf kg ki kj kl ns kp nt kt nu kx nv ne nf ng bi translated">设置一个<code class="fe ky kz la lb b">useState</code>钩子来保存我们的显示号，当更新时，将触发组件的渲染。</li></ol><p id="c258" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">钩子看起来像这样:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a8dffbdc20408e937918cbd7e84774c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*6M4k7SI8nMMPNh4J9pp6IA.png"/></div></figure><p id="e357" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我更新了JSX以显示<code class="fe ky kz la lb b">count</code>而不是<code class="fe ky kz la lb b">number</code>。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/1156e05e5950b3c94dc48e4f44c9e602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*FA8nx4tpUGWqomJrTRFlkA.png"/></div></figure><p id="9a30" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.设置一个计算计数和递增时间的<code class="fe ky kz la lb b">useEffect</code>钩子。</p><p id="ae31" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe ky kz la lb b">useEffect()</code>首先采用一个匿名函数来处理计数。我创建变量<code class="fe ky kz la lb b">start</code>和<code class="fe ky kz la lb b">end</code>。<code class="fe ky kz la lb b">start</code>设置为0。</p><p id="0ec1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最初，我用<code class="fe ky kz la lb b">number</code>作为我的<code class="fe ky kz la lb b">end</code>。然而，我意识到，对于非常大的数字，一个更好的方法是只递增<code class="fe ky kz la lb b">number</code>的前三个数字，并在更新计数之前粘贴其余的数字。这样的话，柜台不会花一整晚的时间。</p><p id="adac" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我用持续时间(秒)除以我计划做的增量数，再乘以1000转换成毫秒，从而计算出每次增量的速率。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/303f785b3ba485266ecbeeb27ea44395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*IdcT6TSQ-9-x3u0LEGav2g.png"/></div></figure><blockquote class="lk ll lm"><p id="ef60" class="kc kd ln ke b kf kg jo kh ki kj jr kk lo km kn ko lp kq kr ks lq ku kv kw kx ig bi translated">最初，我希望加快间隔以弥补大数，但<code class="fe ky kz la lb b">setInterval()</code>的最小持续时间为10毫秒。任何小于10的数字都将重置回10。</p></blockquote><p id="339d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.在同一个<code class="fe ky kz la lb b">useEffect</code>钩子中，我使用了<code class="fe ky kz la lb b">setInterval()</code>来增加计数，副作用是重新呈现组件。</p><p id="0dc5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我给<code class="fe ky kz la lb b">start</code>加1，并调用<code class="fe ky kz la lb b">setCount()</code>来更新我的<code class="fe ky kz la lb b">useState</code>钩子。我将<code class="fe ky kz la lb b">start</code>转换成一个字符串，如果它是一个很大的数字，我会将我之前截取的数字的剩余部分连接起来。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/021a5d1cf0fd693ae8a23d5d32cc2d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*k8sme5nH_FMNI2KwbO3dzw.png"/></div></figure><p id="92c6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">整个组件现在将如下所示:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/5ad46b3c054e59277281f9bd3706c450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*KCF8YkAqohCZj8L1aeofdg.png"/></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/2988c7ec76fa7676eaabcb0435864706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*P5qgmgC5l1UlpwMrMm6aeA.png"/></div></figure><h2 id="5eeb" class="mk lt in bd lu ml mm dn ly mn mo dp mc kl mp mq me kp mr ms mg kt mt mu mi mv bi translated">结论</h2><p id="31ca" class="pw-post-body-paragraph kc kd in ke b kf my jo kh ki mz jr kk kl nm kn ko kp nn kr ks kt no kv kw kx ig bi translated">我通读了几篇关于这种动画的文章，并将他们的想法与我的直觉结合起来，制作了上面的抽象可重用组件。</p><p id="1db7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我不确定我想到的是最好的方法。例如<code class="fe ky kz la lb b">setInterval</code>有我没有预见到的局限性。我希望得到一些反馈。欢迎评论或发邮件给我<code class="fe ky kz la lb b">jason.melton2@gmail.com</code>。</p><p id="e2ad" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最好的，杰森</p></div></div>    
</body>
</html>