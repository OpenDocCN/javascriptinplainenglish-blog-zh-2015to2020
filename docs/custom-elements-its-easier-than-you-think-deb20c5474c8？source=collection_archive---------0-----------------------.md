# å®šåˆ¶å…ƒç´ â€”â€”å®ƒä»¬æ¯”ä½ æƒ³è±¡çš„æ›´å®¹æ˜“åˆ›å»º

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/custom-elements-its-easier-than-you-think-deb20c5474c8?source=collection_archive---------0----------------------->

![](img/22d95ff21b68f13cda7b45dbad5bdc9a.png)

æœ‰äº†[å®šåˆ¶å…ƒç´ ](https://html.spec.whatwg.org/multipage/scripting.html#custom-elements)ï¼Œweb å¼€å‘è€…å¯ä»¥**åˆ›å»ºæ–°çš„ HTML æ ‡ç­¾**ï¼Œå¢å¼ºç°æœ‰çš„ HTML æ ‡ç­¾ï¼Œæˆ–è€…æ‰©å±•å…¶ä»–å¼€å‘è€…åˆ›ä½œçš„ç»„ä»¶ã€‚

ä¸ºäº†å®šä¹‰ä¸€ä¸ªæ–°çš„ HTML å…ƒç´ ï¼Œæˆ‘ä»¬éœ€è¦ğŸ”¥JavaScript çš„åŠ›é‡ï¼

# å®šä¹‰å…ƒç´ çš„ JavaScript API

ä½¿ç”¨æ‰©å±•äº†`**HTMLElement**`çš„ ES2015 `**class**` æ¥å®šä¹‰è‡ªå®šä¹‰å…ƒç´ çš„åŠŸèƒ½ã€‚

æ‰©å±•`**HTMLElement**` ç¡®ä¿å®šåˆ¶å…ƒç´ ç»§æ‰¿æ•´ä¸ª **DOM API** å¹¶æ„å‘³ç€ä½ æ·»åŠ åˆ°ç±»ä¸­çš„ä»»ä½•**å±æ€§/æ–¹æ³•**æˆä¸ºå…ƒç´ çš„ DOM æ¥å£çš„ä¸€éƒ¨åˆ†ã€‚

æœ¬è´¨ä¸Šï¼Œä½¿ç”¨è¯¥ç±»ä¸ºæ‚¨çš„æ ‡ç­¾åˆ›å»ºä¸€ä¸ª**å…¬å…± JavaScript API** ã€‚

```
**class OurElement extends HTMLElement {...}**
```

# å®šä¹‰æ–°å…ƒç´ 

`**customElements**` å…¨å±€å˜é‡ç”¨äºå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ ï¼Œå¹¶å‘æµè§ˆå™¨æ•™æˆä¸€ä¸ªæ–°æ ‡ç­¾ã€‚ç”¨æ‚¨æƒ³è¦åˆ›å»ºçš„æ ‡ç­¾åå’Œä¸€ä¸ª JavaScript `**class**` è°ƒç”¨`**customElements.define()**`æ¥æ‰©å±•åŸºç¡€`**HTMLElement**`

```
window.customElements.define('our-element', **OurElement**);
```

> é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œä½¿ç”¨å®šåˆ¶å…ƒç´ ä¸ä½¿ç”¨`<div>`æˆ–ä»»ä½•å…¶ä»–å…ƒç´ æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚å®ä¾‹å¯ä»¥åœ¨é¡µé¢ä¸Šå£°æ˜ï¼Œåœ¨ JavaScript ä¸­åŠ¨æ€åˆ›å»ºï¼Œå¯ä»¥é™„åŠ äº‹ä»¶ç›‘å¬å™¨ï¼Œç­‰ç­‰ã€‚

# ç”Ÿå‘½å‘¨æœŸ

è‡ªå®šä¹‰å…ƒç´ å¯ä»¥å®šä¹‰ç‰¹æ®Šçš„ç”Ÿå‘½å‘¨æœŸæŒ‚é’©ï¼Œç”¨äºåœ¨å…¶å­˜åœ¨çš„æœ‰è¶£æ—¶æœŸè¿è¡Œä»£ç ã€‚è¿™äº›è¢«ç§°ä¸º**è‡ªå®šä¹‰å…ƒç´ ååº”**ã€‚

![](img/c6265d3ad98bacf644a8490966653844.png)

âœ”ï¸ **æ„é€ å™¨â€”** å…ƒç´ çš„ä¸€ä¸ªå®ä¾‹è¢«åˆ›å»ºæˆ–è€…[è¢«å‡çº§](https://developers.google.com/web/fundamentals/web-components/customelements#upgrades)

âœ”ï¸**connectedcallback**â€”â€”æ¯æ¬¡å…ƒç´ æ’å…¥ DOM æ—¶è°ƒç”¨

âœ”ï¸**disconnected callback**â€”æ¯æ¬¡ä» DOM ä¸­ç§»é™¤å…ƒç´ æ—¶è°ƒç”¨ã€‚å¯¹äºè¿è¡Œæ¸…ç†ä»£ç å¾ˆæœ‰ç”¨ã€‚

âœ”ï¸**attributechangedcallback**â€”å½“ä¸€ä¸ª[è§‚å¯Ÿå±æ€§](https://developers.google.com/web/fundamentals/web-components/customelements#attrchanges)è¢«æ·»åŠ ã€åˆ é™¤ã€æ›´æ–°æˆ–æ›¿æ¢æ—¶è°ƒç”¨ã€‚å½“è§£æå™¨åˆ›å»ºä¸€ä¸ªå…ƒç´ æˆ–è€…[å‡çº§](https://developers.google.com/web/fundamentals/web-components/customelements#upgrades)æ—¶ï¼Œä¹Ÿéœ€è¦åˆå§‹å€¼ã€‚

âœ”ï¸ **é‡‡ç”¨å›è°ƒâ€”** è‡ªå®šä¹‰å…ƒç´ å·²ç»è¢«ç§»å…¥ä¸€ä¸ªæ–°çš„`document`

# å…¥é—¨æŒ‡å—ğŸ‘

æˆ‘ä»¬å°†åœ¨ä¸€ä¸ªå•ç‹¬çš„ JavaScript æ–‡ä»¶ä¸­åˆ›å»ºæ‰€æœ‰å†…å®¹ï¼Œè¯¥æ–‡ä»¶å°†åŒ…å«å…³äºè‡ªå®šä¹‰å…ƒç´ çš„æ‰€æœ‰å†…å®¹:æ ·å¼è§„åˆ™ã€æ ‡è®°ã€ES6 ç±»å®šä¹‰ï¼Œæœ€åæ³¨å†Œè‡ªå®šä¹‰å…ƒç´ ã€‚

åœ¨æˆ‘ä»¬æƒ³è¦ä½¿ç”¨è‡ªå®šä¹‰å…ƒç´ çš„ HTML æ–‡ä»¶ä¸­ï¼Œ**æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯åŒ…å«é‚£ä¸ª JavaScript æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åœ¨æˆ‘ä»¬çš„é¡µé¢ä¸Šä½¿ç”¨æ–°çš„æ ‡ç­¾äº†**

![](img/e56e91e8342b93e054b33e2c27f1bcc0.png)

ä¸‹é¢æ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰å…ƒç´ çš„ç±»çš„å®šä¹‰ï¼Œå®ƒåº”è¯¥æ‰©å±• **HTMLElement** :

**è¿™é‡Œæœ‰ä¸€äº›éœ€è¦æ³¨æ„çš„äº‹æƒ…:**

âœ”ï¸ç±»æ„é€ å‡½æ•°æ˜¯ä¸€ä¸ªé™„åŠ å½±å­æ ¹å¹¶å®šä¹‰å…¶å†…éƒ¨ html çš„å¥½åœ°æ–¹ã€‚æˆ‘ä»¬è°ƒç”¨å®ç°å®ƒçš„å‡½æ•°(***)render(â€¦)***)ã€‚

âœ”ï¸å½“ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ çš„ç±»æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°æ—¶ï¼Œä½ åº”è¯¥æ€»æ˜¯åœ¨å…¶ä¸­è°ƒç”¨ **super()** ã€‚

âœ”ï¸é˜´å½±æ ¹çš„æ¨¡å¼å¯ä»¥æ˜¯å¼€æ”¾çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å°é—­çš„ã€‚æ‚¨å¯èƒ½åªä¼šä½¿ç”¨ openï¼Œå› ä¸ºå¦åˆ™æ‚¨å°†æ— æ³•ä¸ºå®ƒè®¾ç½®ä»»ä½• innerHTMLã€‚

**ä½¿ç”¨å½±å­ DOMï¼Œä¸‹é¢æ˜¯ä½ çš„æµè§ˆå™¨æ§åˆ¶å°ä¸­çš„æ ‡è®°å¤–è§‚:**

![](img/7cdf370155bd66affae34cb79eae3f92.png)

# ä½¿ç”¨ğŸ”¥

ä½¿ç”¨æˆ‘ä»¬çš„å®šåˆ¶å…ƒç´ éå¸¸ç®€å•ï¼Œåªéœ€å°†è„šæœ¬æ–‡ä»¶æ·»åŠ åˆ°é¡µé¢ä¸­ï¼Œç„¶ååƒä½¿ç”¨ä»»ä½•å…¶ä»–å¸¸è§„ HTML å…ƒç´ ä¸€æ ·ä½¿ç”¨æˆ‘ä»¬çš„å…ƒç´ ã€‚

> ä½†æ˜¯è¯·æ³¨æ„ï¼Œè‡ªå®šä¹‰å…ƒç´ åº”è¯¥å§‹ç»ˆæœ‰ä¸€ä¸ªç»“æŸæ ‡è®°:

![](img/9d9154a4566ec3f663b7350d8b0fac28.png)

> è¯·è®°ä½ï¼Œæˆ‘ä»¬çš„å…ƒç´ è¿˜æ²¡æœ‰åšå¥½ç”Ÿäº§å‡†å¤‡ã€‚ç°åœ¨ï¼Œè¿™ä¸ªå…ƒç´ åªèƒ½åœ¨ä¸€äº›ç°ä»£æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚
> 
> å¯¹äº ES6 ç±»æˆ–å­—ç¬¦ä¸²æ–‡å­—ç­‰ä¸è¢«å…¨é¢æ”¯æŒçš„ JavaScript ç‰¹æ€§ï¼Œæ‚¨å°†å¸Œæœ›é€šè¿‡ Babel ç­‰ transpiler è¿è¡Œä»£ç ï¼Œå¹¶ä¸”æ‚¨å°†å¸Œæœ›å¯¹è‡ªå®šä¹‰å…ƒç´ å’Œé˜´å½± DOM ä½¿ç”¨ polyfillsã€‚
> 
> æˆ‘ä»¬å°†åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»å¦‚ä½•ä½¿ç”¨ Web ç»„ä»¶ polyfillsã€‚

M çŸ¿çŸ³ç¯èŠ‚:

[](https://www.webcomponents.org/introduction) [## ç®€ä»‹-webcomponents.org

### Web ç»„ä»¶æ˜¯ä¸€ç»„ web å¹³å° APIï¼Œå…è®¸æ‚¨åˆ›å»ºæ–°çš„è‡ªå®šä¹‰çš„ã€å¯é‡ç”¨çš„ã€å°è£…çš„ HTML æ ‡è®°ï¼Œä»¥â€¦

www.webcomponents.org](https://www.webcomponents.org/introduction) [](https://alligator.io/web-components/your-first-custom-element/) [## æ‚¨çš„ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ 

### é‚£ä¹ˆæ‚¨å¯¹å­¦ä¹  Web ç»„ä»¶å’Œåˆ›å»ºè‡ªå·±çš„å®šåˆ¶ HTML æ ‡ç­¾æ„Ÿå…´è¶£å—ï¼Ÿåœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢â€¦

é³„é±¼. io](https://alligator.io/web-components/your-first-custom-element/) [](https://developers.google.com/web/fundamentals/web-components/customelements) [## å®šåˆ¶å…ƒç´  v1:å¯é‡ç”¨çš„ Web ç»„ä»¶| Web åŸºç¡€| Google å¼€å‘è€…

### è‡ªå®šä¹‰å…ƒç´ å…è®¸ web å¼€å‘äººå‘˜å®šä¹‰æ–°çš„ HTML æ ‡è®°ï¼Œæ‰©å±•ç°æœ‰çš„æ ‡è®°ï¼Œå¹¶åˆ›å»ºå¯é‡ç”¨çš„ web ç»„ä»¶ã€‚

developers.google.com](https://developers.google.com/web/fundamentals/web-components/customelements) [](https://habr.com/post/210058/) [## ç½‘é¡µç»„ä»¶- Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞµç½‘é¡µ

### ÑĞ¿ÑƒÑÑ‚ÑĞºĞºĞ¾ĞµĞ²Ñ€ĞµĞ¼ÑÑÑ‚Ğ°Ğ»Ğ¾ÑÑĞ½Ğ¾ï¼ŒÑ‡Ñ‚Ğ¾ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¸Ğ´ĞµÑåŸå‹Ğ²Ğ¾ÑˆĞ»Ğ°Ğ²Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²Ğ¾Ñ€ĞµÑ‡Ğ¸ĞµÑĞ¼Ğ¸Ğ¸Ğ¸Ğ¾Ğ¼ã€‚Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ¾Ğ² Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¸Ğ»Ğ¸â€¦

habr.com](https://habr.com/post/210058/) [](https://learn.javascript.ru/webcomponents) [## Ğ’ĞµĞ±-ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹: Ğ²Ğ·Ğ³Ğ»ÑĞ´ Ğ² Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞµ

### Ğ²ĞµĞ±-ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹-" Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ³Ğ¾":ÑĞ¾Ğ²Ğ¾ĞºÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒï¼ŒĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹ĞµĞ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑÑ‚Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°Ñ‚ÑŒĞ½Ğ¾Ğ²Ñ‹ĞµÑ‚Ğ¸Ğ¿Ñ‹dom-ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²â€¦

learn.javascript.ru](https://learn.javascript.ru/webcomponents) [](https://www.polymer-project.org/3.0/toolbox/) [## èšåˆç‰©åº”ç”¨å·¥å…·ç®±-èšåˆç‰©é¡¹ç›®

### ç¼–è¾‘æè¿°

www.polymer-project.org](https://www.polymer-project.org/3.0/toolbox/)