<html>
<head>
<title>JavaScript: Object.defineProperty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript:object . define property</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-object-defineproperty-411c5fff06bc?source=collection_archive---------4-----------------------#2020-05-14">https://javascript.plainenglish.io/javascript-object-defineproperty-411c5fff06bc?source=collection_archive---------4-----------------------#2020-05-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d0a105e4a37f90187dedeb70fd060578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4h5luNQWQb5nDlPPOb9eQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@codytdavis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">davisco</a> on <a class="ae kc" href="https://unsplash.com/s/photos/object?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0721" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript中的对象是属性的集合，属性是键<em class="lb">和值</em>的关联。创建一个对象非常简单:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="beab" class="ll lm iq lh b gy ln lo l lp lq">const person = {<br/>  name: 'Max',<br/>  age: 23,<br/>};</span></pre><p id="e961" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要在现有对象中定义新属性，您只需为其赋值:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="68a2" class="ll lm iq lh b gy ln lo l lp lq">person.gender = 'Male';</span></pre><p id="3dc1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是还有另外一种定义属性的方法，不太为人所知:<code class="fe lr ls lt lh b">Object.defineProperty</code>。它需要三个参数:对象、属性名和描述符:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="3075" class="ll lm iq lh b gy ln lo l lp lq">Object.defineProperty(<em class="lb">object</em>, <em class="lb">propertyName</em>, <em class="lb">descriptor</em>);</span></pre><p id="1bf3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">描述符，顾名思义，是描述属性的对象，我们将在下面的例子中看到。这种语法通常比较长，感觉不太自然，但是它可以做经典赋值不能做的事情。</p><h1 id="8ecd" class="lu lm iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">可写、可枚举和可配置</h1><p id="20aa" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我们分配给对象<code class="fe lr ls lt lh b">person</code>的<code class="fe lr ls lt lh b">gender</code>属性是</p><ol class=""><li id="7f61" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated">可写的</li><li id="4e05" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">可列举的</li><li id="94ec" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated">可配置的</li></ol><p id="f655" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一点，可写，意味着您可以更改属性的值:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="b2f4" class="ll lm iq lh b gy ln lo l lp lq">person.gender = 'Female';<br/>console.log(person.gender); // Female</span></pre><p id="2d79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二点，enumerable，意味着属性出现在对象属性的枚举中，例如在一个<code class="fe lr ls lt lh b">for ... in ...</code>循环中:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="1560" class="ll lm iq lh b gy ln lo l lp lq">for (const key in person) {<br/>  console.log(key); // name age gender<br/>}</span></pre><p id="1b81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，可配置的属性意味着您可以在以后删除该属性，或者更改它的可写和可枚举参数:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="adb1" class="ll lm iq lh b gy ln lo l lp lq">delete person.gender;<br/>console.log(person.gender); // undefined</span></pre><p id="6e86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对我们来说，属性以这种方式运行是很自然的，但它们并不一定如此。默认情况下，用<code class="fe lr ls lt lh b">Object.defineProperty</code>定义的属性是不可写、不可枚举、不可配置的。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="08dd" class="ll lm iq lh b gy ln lo l lp lq">Object.defineProperty(person, 'gender', {<br/>  value: 'Male',<br/>});</span><span id="8bed" class="ll lm iq lh b gy nk lo l lp lq">// Non writable<br/>person.gender = 'Female';<br/>console.log(person.gender); // 'Male'</span><span id="7158" class="ll lm iq lh b gy nk lo l lp lq">// Non enumerable<br/>for (const key in person) {<br/>  console.log(key); // name age<br/>}</span><span id="aaaa" class="ll lm iq lh b gy nk lo l lp lq">// Non configurable<br/>delete person.gender;<br/>console.log(person.gender); // 'Male'</span></pre><p id="935f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，如果你的目标是实现这样的事情，使用<code class="fe lr ls lt lh b">Object.defineProperty</code>可能是一个很好的选择<code class="fe lr ls lt lh b">Proxy</code>(如果你从未听说过JavaScript代理，那么<a class="ae kc" href="https://medium.com/javascript-in-plain-english/javascript-proxies-b41abcdd2bda" rel="noopener">这种方式</a>)。</p><p id="ea9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，以这种方式定义的属性可能是不可写、不可枚举、不可配置的，但是您当然可以在描述符中更改它:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="f82b" class="ll lm iq lh b gy ln lo l lp lq">Object.defineProperty(person, 'gender', {<br/>  value: 'Male',<br/>  writable: true,<br/>  enumerable: true,<br/>  configurable: true,<br/>});</span><span id="f552" class="ll lm iq lh b gy nk lo l lp lq">// Writable<br/>person.gender = 'Female';<br/>console.log(person.gender); // 'Female'</span><span id="9dae" class="ll lm iq lh b gy nk lo l lp lq">// Enumerable<br/>for (const key in person) {<br/>  console.log(key); // name age gender<br/>}</span><span id="81c6" class="ll lm iq lh b gy nk lo l lp lq">// Configurable<br/>delete person.gender;<br/>console.log(person.gender); // undefined</span></pre><h1 id="bca2" class="lu lm iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">存取描述符</h1><p id="988b" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在前面的例子中，我们使用<em class="lb">数据</em>定义了属性。我们使用描述符给它赋值，并声明它是可写的、可枚举的和可配置的。因此我们的描述符是一个<em class="lb">数据描述符</em>。还有另一种使用<code class="fe lr ls lt lh b">Object.defineProperty</code> : <em class="lb">访问器描述符</em>定义属性的方法。</p><p id="8026" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些描述符有一个<code class="fe lr ls lt lh b">get</code>和一个<code class="fe lr ls lt lh b">set</code>方法，在其中你可以分别定义如何读写属性。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="ebfa" class="ll lm iq lh b gy ln lo l lp lq">let value = 'Male';<br/>Object.defineProperty(person, 'gender', {<br/>  get: () =&gt; value,<br/>  set: (newValue) =&gt; value = newValue,<br/>});</span><span id="158f" class="ll lm iq lh b gy nk lo l lp lq">console.log(person.gender); // Male<br/>person.gender = 'Female'; <br/>console.log(person.gender); // Female</span></pre><p id="a45f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，这些方法返回<code class="fe lr ls lt lh b">undefined</code>。通过不定义<code class="fe lr ls lt lh b">set</code>方法，您将使您的属性不可写。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="4ccf" class="ll lm iq lh b gy ln lo l lp lq">Object.defineProperty(person, 'gender', {<br/>  get: () =&gt; 'Male',<br/>});</span><span id="dfcb" class="ll lm iq lh b gy nk lo l lp lq">console.log(person.gender); // Male<br/>person.gender = 'Female'; <br/>console.log(person.gender); // Male</span></pre><p id="570f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，如果你想要做的只是使一个属性不可写，那么这可能是一个简短的替代方法。</p><p id="b1eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">值得注意的是，你可以使用一个<em class="lb">数据描述符</em> <strong class="kf ir">或者</strong>一个<em class="lb">访问器描述符</em>，但是你不能混合使用两者。尝试这样做将导致抛出错误。如果你试图改变一个不可配置的属性的配置，但是试图写一个不可写的属性，也会抛出一个错误。它只是不改变价值。</p><p id="6c9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lr ls lt lh b">Object.defineProperty</code>在大多数常见的JavaScript情况下是多余的。但它是一个很好的、本地的、可读的和易于实现的解决方案，在您不希望您的属性是可写的、可删除的或可枚举的情况下监视您的属性是如何被访问的。</p><h2 id="92f7" class="ll lm iq bd lv nl nm dn lz nn no dp md ko np nq mh ks nr ns ml kw nt nu mp nv bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="aab0" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="kf ir">JavaScript in Plain English</strong></a><a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！我们还推出了一个YouTube，希望你能通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的简明英语频道</strong> </a>来支持我们</p><p id="9de0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一如既往,“简明英语”希望帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>