<html>
<head>
<title>Client-Side Routing with Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Firebase的客户端路由</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/client-side-routing-with-firebase-a6e630f299f2?source=collection_archive---------15-----------------------#2020-12-21">https://javascript.plainenglish.io/client-side-routing-with-firebase-a6e630f299f2?source=collection_archive---------15-----------------------#2020-12-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f874" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用React路由器和Firebase身份验证创建受保护的路由</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d38813a2e14e64775d965fbf88b59f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yOMMypzHtRVHXedaTAA2XQ.png"/></div></div></figure><h1 id="993f" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">问题</h1><p id="3032" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo lp lq lr ls lt lu lv lw lx ly lz ma mb ig bi translated">假设你正在尝试使用<a class="ae mc" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>和<a class="ae mc" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>构建一个web应用程序。到目前为止，您已经完成了以下步骤:</p><ol class=""><li id="40cb" class="md me in li b lj mf lm mg lp mh lt mi lx mj mb mk ml mm mn bi translated">创建了一个空白的单页应用程序:<code class="fe mo mp mq mr b">npx create-react-app .</code></li><li id="edcd" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb mk ml mm mn bi translated">已安装Firebase npm软件包:<code class="fe mo mp mq mr b">npm install --save firebase</code></li><li id="e658" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb mk ml mm mn bi translated">在你的React: <code class="fe mo mp mq mr b">firebase.initializeApp(firebaseConfig);</code>的index.js文件中添加了Firebase </li><li id="9c40" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb mk ml mm mn bi translated">创建了一个<a class="ae mc" href="https://www.positronx.io/build-react-login-sign-up-ui-template-with-bootstrap-4/" rel="noopener ugc nofollow" target="_blank">基本注册和登录界面</a></li><li id="9f75" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb mk ml mm mn bi translated">增加了<a class="ae mc" href="https://firebase.google.com/docs/auth/web/start" rel="noopener ugc nofollow" target="_blank"> Firebase验证码</a></li></ol><p id="5664" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">下一步是将用户路由到受保护的页面。然而，这带来了一些可怕的问题:</p><ul class=""><li id="438e" class="md me in li b lj mf lm mg lp mh lt mi lx mj mb na ml mm mn bi translated">如何在我的单页应用程序中添加多个页面？</li><li id="3227" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">如何在React中创建受保护的路由？</li><li id="fede" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">我如何将它与Firebase身份验证联系起来？</li></ul><h1 id="640e" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">解决办法</h1><p id="5a3a" class="pw-post-body-paragraph lg lh in li b lj lk jo ll lm ln jr lo lp lq lr ls lt lu lv lw lx ly lz ma mb ig bi translated">您首先需要将React路由器添加到您的项目中。<a class="ae mc" href="https://reactrouter.com/" rel="noopener ugc nofollow" target="_blank"> React Router </a>是一个工具，可以让你在web app中处理路由，而不是在服务器上处理。</p><p id="3075" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">之前:</p><pre class="kd ke kf kg gt nb mr nc nd aw ne bi"><span id="797e" class="nf kp in mr b gy ng nh l ni nj">app.get('/home', function (req, res) { <!-- -->res.render('home')<!-- -->; })</span></pre><p id="be95" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">现在:</p><pre class="kd ke kf kg gt nb mr nc nd aw ne bi"><span id="660d" class="nf kp in mr b gy ng nh l ni nj">&lt;Route exact path=”/home” component={Home} /&gt;</span></pre><p id="60e2" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">要将React Router添加到您的web应用程序中，您可以安装<em class="nk"> react-router-dom。</em>我用过5.2.0版本，所以这段代码将来有可能会被弃用。</p><pre class="kd ke kf kg gt nb mr nc nd aw ne bi"><span id="5f55" class="nf kp in mr b gy ng nh l ni nj">npm install react-router-dom</span></pre><p id="98e8" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">接下来，在你的<strong class="li io"> App.js. </strong>中添加<em class="nk"> firebase </em>、<a class="ae mc" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> useState </em> </a>、<a class="ae mc" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> useEffect </em> </a>和<a class="ae mc" href="https://reactrouter.com/web/guides/quick-start" rel="noopener ugc nofollow" target="_blank"><em class="nk">react-router-DOM</em></a>然后，中的<strong class="li io">函数<strong class="li io"> App </strong>，添加一个新的状态变量。这将用于确定用户是否已登录应用程序。</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="6ea3" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">接下来，每当Firebase用户发生变化时，我们可以使用<em class="nk"> useEffect </em>钩子来更新我们上面创建的状态变量。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="ad61" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">最后，我们可以添加我们的return语句。你可能会看到<em class="nk">路径</em>被设置到子目录，比如<em class="nk">"/登录"</em>或者<em class="nk">"/仪表板。"</em></p><p id="c163" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">另外，注意<em class="nk">加载</em>、<em class="nk">主页</em>、<em class="nk">登录</em>、<em class="nk">注册</em>、<em class="nk">管理</em>和<em class="nk">错误</em>都是需要在<strong class="li io"> App.js </strong>顶部导入的React组件。我不会包含这些页面的任何代码，因为您应该已经有了您的注册和登录代码。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="150d" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">看起来我们都完成了，但是还有一步。<em class="nk">路径</em>在<strong class="li io"> App.js </strong>顶部导入，但是<em class="nk"> PublicRoute </em>和<em class="nk"> PrivateRoute </em>不存在。在您的应用程序中，您可能有一些只有经过身份验证的用户才能访问的页面，比如<em class="nk">仪表板</em>页面。然而，你也可能有认证用户不能访问的页面，比如<em class="nk">注册</em>页面。毕竟，为什么已经登录的人需要创建另一个帐户呢？</p><p id="95ed" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">将以下代码添加到<strong class="li io"> App.js </strong>的底部，<strong class="li io">在<strong class="li io"> App </strong>函数的</strong>之外。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="eb32" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">现在，您已经解决了将用户路由到受保护页面的问题！</p><h1 id="65ec" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">走向</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/7d13d0af7d479ec7efd4a86f313bebbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzyXC0LZUtwPyei_G8pAAQ.jpeg"/></div></div></figure><p id="166e" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">要扩展本教程，您可以执行以下操作:</p><ul class=""><li id="5d9e" class="md me in li b lj mf lm mg lp mh lt mi lx mj mb na ml mm mn bi translated">添加更多受保护的和公共的路由</li><li id="9497" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">在useEffect挂钩内添加附加代码</li><li id="a84c" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">改变<strong class="li io">保护路线</strong>和<strong class="li io">公共路线</strong>的重定向</li></ul><p id="cf32" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">如果你遇到问题，问问自己:</p><ul class=""><li id="333e" class="md me in li b lj mf lm mg lp mh lt mi lx mj mb na ml mm mn bi translated">我是否缺少任何注册、登录或管理组件？</li><li id="b070" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">我是否正确地创建了一个Firebase项目？</li><li id="b1a1" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">我是否安装了<strong class="li io">并且</strong>导入了所有需要的包？</li><li id="fb62" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated">我用的是旧的<strong class="li io">还是新版本的</strong>React？</li></ul><p id="b16c" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">最后，这里有一些我用来学习所有使用Firebase的React路由的资源。请检查他们！</p><ul class=""><li id="79dd" class="md me in li b lj mf lm mg lp mh lt mi lx mj mb na ml mm mn bi translated"><a class="ae mc" href="https://stackoverflow.com/questions/58769189/react-router-protected-route-with-firebase-auth-check" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/58769189/react-router-protected-route-with-firebase-auth-check</a></li><li id="926e" class="md me in li b lj ms lm mt lp mu lt mv lx mw mb na ml mm mn bi translated"><a class="ae mc" href="https://medium.com/@subalerts/creating-protected-routes-in-react-js-89e95974a822" rel="noopener">https://medium . com/@ subalerts/creating-protected-routes-in-react-js-89e 95974 a822</a></li></ul></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><p id="7c69" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">感谢你把这篇文章看完！我真的很高兴找到像我一样对计算机科学充满热情的人。</p><p id="4978" class="pw-post-body-paragraph lg lh in li b lj mf jo ll lm mg jr lo lp mx lr ls lt my lv lw lx mz lz ma mb ig bi translated">确保<strong class="li io">喜欢</strong> / <strong class="li io">分享</strong>这篇文章😁，并评论你的阅读体验！</p></div></div>    
</body>
</html>