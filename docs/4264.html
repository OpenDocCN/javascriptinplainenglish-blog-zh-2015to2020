<html>
<head>
<title>Enable Blazing Gatsby Build Time with Incremental Builds</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过增量构建实现惊人的Gatsby构建时间</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/enable-blazing-gatsby-build-time-with-incremental-builds-6f93935b05c2?source=collection_archive---------8-----------------------#2020-11-29">https://javascript.plainenglish.io/enable-blazing-gatsby-build-time-with-incremental-builds-6f93935b05c2?source=collection_archive---------8-----------------------#2020-11-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="5c68" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Gatsby团队最近在他们的框架中引入了一个新特性，叫做增量构建，它显著地减少了构建时间。这里将实验它的实现。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/84629e2dcc51bd26b1ab1e61d95a0eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3ItxSjtEYxOrghm7MjIbQ.jpeg"/></div></div></figure><p id="cfaf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">创建静态网站或设置JAM(Javascript、API和标记)应用程序Gatsby对于这两者来说都是一个令人惊叹的工具包。我们可以利用大量的插件来增强Gatsby的功能。在我们的网站或个人项目中使用Gatsby没有太大问题。它可以很好地处理大量的博客文章，因为较小的站点会导致较少的构建时间。</p><p id="78cd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是当处理一个有大量博客文章的站点并扩大其规模时，使用Gatsby的主要缺点。这可能导致<strong class="kq io">长的构建时间</strong>。纠正一个错别字需要的时间和第一次重建网站的时间是一样的。但是，情况不再是这样了。Gatsby团队最近在4月份宣布了Gatsby cloud增量构建的新功能发布——使我们的构建速度提高了1000倍。<a class="ae lk" href="https://www.gatsbyjs.com/blog/2020-04-22-announcing-incremental-builds/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">也就是说平均建造时间为&lt; 10秒！</strong> </a> <strong class="kq io">。有了这个功能，Gatsby Cloud的<strong class="kq io"> </strong>提高了预览和发布速度，因为它只构建实际上发生了变化的内容。</strong></p><h1 id="c0ff" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">盖茨比云？</h1><p id="cf45" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">盖茨比云是一个运行我们盖茨比网站的在线平台。它经过全面优化，有助于扩展Gatsby站点的速度限制和附加功能。它是卡特创建的，旨在消除启动新项目的一些标准工作，并帮助用户轻松设置应用程序。</p><p id="3e97" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">借助定制的云基础设施，您的Gatsby站点在缓存和真正的增量构建方面拥有更多超能力，将速度和性能提升到一个全新的水平。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/a88eb9a1b5c9228d5cdf0b63205de4e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*VMnfUTVk3bhK5w-A-63HXw.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk"><a class="ae lk" href="https://www.gatsbyjs.com/cloud/" rel="noopener ugc nofollow" target="_blank">Incremental builds up to 1000x faster</a></figcaption></figure><h1 id="2363" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">增量构建</h1><p id="7b3e" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">运行在盖茨比云上的盖茨比网站快得惊人。这背后的原因是真正的增量构建需要粒度缓存和在并发进程之间分割工作。这只能发生在高度专业化的CI/CD管道中。这正是盖茨比云被创造出来的原因。Gatsby用户现在可以获得尽可能好的体验，而不需要依赖必须支持各种项目的通用构建服务。盖茨比云还针对盖茨比网站和应用进行了全面优化。</p><p id="5852" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">在Gatsby Cloud上使用增量构建，我们可以在10秒内完成数据编辑。</strong>这通常是现有构建解决方案的1000倍改进，在现有构建解决方案中，即使是最小的数据更改也必须重新构建整个站点。</p><p id="e0bd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">由于Gatsby的由GraphQL支持的复杂数据引擎，这在没有任何配置和任何数据源的情况下都会自动发生。Gatsby的数据引擎自动跟踪页面和数据之间的依赖关系，并在数据发生变化时，安排更新网站所需的最小工作量。</p><h1 id="9e61" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">什么触发了增量构建？</h1><p id="c83b" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">在Gatsby Cloud上，可以触发增量构建。当在我们的CMS中检测到内容更改或任何数据更改时，它会触发增量构建。</p><p id="7062" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是，对实际代码库的更改也会触发完全重建。Gatsby团队正致力于在不久的将来支持基于代码更改的增量构建，但是由于这些发生的频率比数据更改(即内容编辑)低得多，所以他们决定首先处理内容问题。这些构建是在我们将CMS和GitHub与Gatsby Cloud集成后自动触发的。</p><h1 id="349d" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">演示</h1><p id="407e" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">在这里，我们将采取步骤来启用增量构建特性。我们将从头开始创建一个应用程序并探索</p><h2 id="eb38" class="mn lm in bd ln mo mp dn lr mq mr dp lv kx ms mt lx lb mu mv lz lf mw mx mb my bi translated">步骤1:项目设置</h2><p id="ae6c" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">首先，您需要在本地机器上安装Node和Gatsby CLI。运行以下命令在您的本地计算机上安装Gatsby CLI。</p><blockquote class="mz na nb"><p id="dbb9" class="ko kp nc kq b kr ks jo kt ku kv jr kw nd ky kz la ne lc ld le nf lg lh li lj ig bi translated">Gatsby在版本2.20.4中引入了增量构建，所以请确保将您的Gatsby站点升级到最新版本。将Gatsby升级到v2.20.4或更高版本。</p></blockquote><pre class="kd ke kf kg gt ng nh ni nj aw nk bi"><span id="d5f3" class="mn lm in nh b gy nl nm l nn no">yarn add gatsby-cli</span></pre><p id="edc3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，完成后，我们将继续创建一个全新的项目来试验这一特性。我们将把我们的项目命名为<strong class="kq io"> <em class="nc">盖茨比-增量-构建-演示</em> </strong></p><pre class="kd ke kf kg gt ng nh ni nj aw nk bi"><span id="b4c2" class="mn lm in nh b gy nl nm l nn no">gatsby new gatsby-incrementals-builds-demo</span></pre><p id="3efd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该命令将在执行该命令的目录中创建一个文件夹。我们现在可以去里面的网站文件夹。启动我们的本地开发服务器。</p><pre class="kd ke kf kg gt ng nh ni nj aw nk bi"><span id="aad0" class="mn lm in nh b gy nl nm l nn no">cd gatsby-incrementals-builds-demo<br/>gatsby develop</span></pre><h2 id="ec05" class="mn lm in bd ln mo mp dn lr mq mr dp lv kx ms mt lx lb mu mv lz lf mw mx mb my bi translated">步骤2:添加一些页面</h2><p id="38c9" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">在我们的文件夹目录中，我们现在可以看到没有多少页面。让我们在里面添加一些页面。我们将制作几页来试验这个特性。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/2970c371ac529ce69b32c8bafa0b7f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qq7uDFkW_a-XKxuEtRyvig.png"/></div></div></figure><p id="e523" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这里我们添加了多达五个页面，其中我们添加了一些图片作为内容和导航来导航到所有页面。一旦添加了页面和图像，我们就可以继续实现增量构建了。</p><h2 id="148f" class="mn lm in bd ln mo mp dn lr mq mr dp lv kx ms mt lx lb mu mv lz lf mw mx mb my bi translated">步骤2:激活增量构建</h2><p id="3ca7" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">这是我们目前所做的所有实验的核心部分。为了激活这个特定的特性支持，我们在build命令中使用了以下环境变量。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/b5bac73e02c65f0a81fbb8d840d0c8ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aRVvHj8T9qbipA4n4Xgwgw.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">package.json</figcaption></figure><p id="00be" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们在这里添加了可选指示符，这样我们就可以看到Gatsby每次运行都构建了什么。如果您不想看到额外的日志，请不要犹豫，把它放在一边。<code class="fe nr ns nt nh b">--log-pages</code></p><p id="30a3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这就是我们项目中增量构建的全部实现。因此，我们将继续进行项目的部署，以测试我们的构建性能。</p><h2 id="6be4" class="mn lm in bd ln mo mp dn lr mq mr dp lv kx ms mt lx lb mu mv lz lf mw mx mb my bi translated">步骤3: Gatsby云部署</h2><p id="a40c" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">我们去访问页面部署我们的项目，<a class="ae lk" href="https://www.gatsbyjs.com/get-started/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">盖茨比云</strong> </a> <strong class="kq io">。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nu"><img src="../Images/fa97a10c773ee6c5f1ecc1cc8e08b2fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*URMtaaOmyRERk0WJgpNV7A.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Gatsby Cloud</figcaption></figure><p id="6c72" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">公开测试版中提供了增量版本。因此，所有Gatsby Cloud用户都可以享受14天的免费试用。但是我们仍然可以用<a class="ae lk" href="https://www.netlify.com/blog/2020/04/23/enable-gatsby-incremental-builds-on-netlify/" rel="noopener ugc nofollow" target="_blank">网络部署</a>免费<strong class="kq io">试验它。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/77ff7386548ab0b84432d7051cba7f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*li-lMsC-VFAZDubAsuafkw.png"/></div></div></figure><p id="6f87" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们已经成功部署了我们的站点。它可以在我们的仪表板中生成的URL中找到。现在。增量构建将在我们的项目中自动激活。这意味着从无头CMS进行的更改只会导致重新生成受修改数据影响的页面。</p><h2 id="b5ca" class="mn lm in bd ln mo mp dn lr mq mr dp lv kx ms mt lx lb mu mv lz lf mw mx mb my bi translated">步骤4:结果</h2><p id="8f35" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">查看当前的报告，其中我修改并添加了新的模式字段和图像，并进行了一些小的更改。它让我们知道不同构建的日志。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/cda08d9cf328268186966c145e9a1b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JeURfD-Z7qs3tDCu3WEPGQ.png"/></div></div></figure><p id="4a1a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">从上面的截图中，我们可以看到触发因素以及构建流程所花费的时间。最初花了将近一分钟，但是后来改进了，我们现在的构建时间大约是几秒钟。这的确是一项伟大的成就。这可以在具有大量内容的庞大网站的构建过程中反映出来。</p><p id="762b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这样我们节省了大量的时间和资源。</p><p id="af1a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">任务成功。</p><h1 id="2cb2" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">结论</h1><p id="89ff" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">因此很高兴看到增量构建时间消耗的显著减少。现在，我们终于可以构建包含大量页面的静态网站，而无需为每次更改花费大量构建时间！</p><p id="36fb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是要注意的一点是，增量构建只对数据变更有效。如果代码发生变化(业务逻辑、布局……)，仍然需要重新构建网站，尽管有缓存，这可能需要更长时间。</p><p id="ea02" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你也可以在我的库<a class="ae lk" href="https://github.com/ishan-me/Gatsby-Incrementals-Builds-Demo" rel="noopener ugc nofollow" target="_blank">这里</a>找到代码参考。</p><p id="2aab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nc">注意:增量版本在公测中可用。因此，所有Gatsby Cloud用户都可以享受14天的免费试用。如果你想免费试用，我建议你选择Netlify选项链接</em> <a class="ae lk" href="https://www.netlify.com/blog/2020/04/23/enable-gatsby-incremental-builds-on-netlify/?utm_source=twitter&amp;utm_medium=gatsby-inc-builds-jl&amp;utm_campaign=devex" rel="noopener ugc nofollow" target="_blank"> <em class="nc">这里</em> </a> <em class="nc">。</em></p><p id="ad0c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">— — — — — — —祝你黑客生涯愉快！- — — — — — — — — — —</p><div class="nw nx gp gr ny nz"><a href="https://www.netlify.com/blog/2020/04/23/enable-gatsby-incremental-builds-on-netlify/?utm_source=blog&amp;utm_medium=gatsby-perf-jl&amp;utm_campaign=devex" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd io gy z fp oe fr fs of fu fw im bi translated">在Netlify上启用Gatsby增量构建</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">Gatsby最近发布了增量构建，这一改进减少了构建Gatsby所需的工作量…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">www.netlify.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on km nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://www.netlify.com/blog/2020/06/11/5-optimizations-for-faster-gatsby-builds/" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd io gy z fp oe fr fs of fu fw im bi translated">5项优化加快了Gatsby的构建速度</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">Gatsby是快速构建复杂网站的一个极其强大的工具。它允许我们从任何地方获取数据…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">www.netlify.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on km nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://www.gatsbyjs.com/blog/2020-04-22-announcing-incremental-builds/" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd io gy z fp oe fr fs of fu fw im bi translated">什么是Gatsby增量构建？</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">今天，我很高兴地宣布Gatsby Cloud增量版的发布。一月份我们宣布了盖茨比…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">www.gatsbyjs.com</p></div></div><div class="oi l"><div class="op l ok ol om oi on km nz"/></div></div></a></div></div></div>    
</body>
</html>