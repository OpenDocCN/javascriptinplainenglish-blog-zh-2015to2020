<html>
<head>
<title>Free website hosting and CD with Expo and Github</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Expo和Github的免费网站托管和CD</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/expo-web-deploy-to-github-io-8262a8eb9645?source=collection_archive---------11-----------------------#2020-03-16">https://javascript.plainenglish.io/expo-web-deploy-to-github-io-8262a8eb9645?source=collection_archive---------11-----------------------#2020-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="40b3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Expo Web通过连续交付脚本部署到GitHub.io</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0c06e787dd13043efcbe34a7b9f6edf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipk6Xeowueq40fBcdf72vA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Your phone, your code, and your localhost:19006 site — all that’s left is deployment! And coffee. That mug is totally empty. Photo by <a class="ae kv" href="https://unsplash.com/@cgower?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Christopher Gower</a> on <a class="ae kv" href="https://unsplash.com/s/photos/web-development?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="be27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您有一个Expo.io应用程序，并准备好部署您的web版本。我已经在GitHub.io上免费部署，并遇到了几个<em class="ls"> 100%可避免的</em>问题——从那以后，用一个命令部署到生产就一帆风顺了。</p><p id="dd11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文结束时，您将知道如何:</p><ul class=""><li id="5c54" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">在github.io上部署您的网站(免费)</li><li id="536a" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">将一个(非免费的)自定义域连接到您的网站(并通过修改您的构建脚本来保持连接)</li><li id="fada" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">编写一个脚本来测试(如果有)、构建，然后将应用部署到生产环境中(本质上是CI/CD)。</li></ul><h1 id="0eb0" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">部署</h1><p id="6446" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">在github.io上部署任何GitHub pages静态站点都很简单。首先，在项目中安装<code class="fe ne nf ng nh b">gh-pages</code>作为devDependency。</p><p id="200c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在构建您的网站(运行:<code class="fe ne nf ng nh b">expo web:build</code>)之后，将您的资产部署到GitHub repo中的gh-pages分支，并使用以下命令进行推送:</p><pre class="kg kh ki kj gt ni nh nj nk aw nl bi"><span id="4079" class="nm mi iq nh b gy nn no l np nq">gh-pages -d web-build</span></pre><p id="7cb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">顺便说一下，这个实用程序比仅仅将静态站点部署到GitHub更有帮助。你可以用它推<em class="ls">任何东西</em>到<em class="ls">任何分支</em>，推<em class="ls">任何远程</em> (GitLab，BitBucket等。—请注意，其他服务不会将这些文件作为网站静态提供)。当我出于公司原因不想在公共NPM上发布时，我用它将库输出推送到分支——是的，您可以将git repo+分支指定为NPM依赖项。对于一些CI/CD+Git问题，<code class="fe ne nf ng nh b">gh-pages</code>可能是您工具箱中的一个有用工具。要了解更多信息，请运行<code class="fe ne nf ng nh b">gh-pages --help</code>。</p><p id="6ac6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从技术上来说，此时你已经部署在GitHub.io上了。然而，你可能想要连接一个自定义域名到你的站点上(比如<a class="ae kv" href="http://jamesfulford.com" rel="noopener ugc nofollow" target="_blank">jamesfulford.com</a>)。</p><h1 id="e245" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">自定义域指令</h1><p id="5098" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">您需要的大多数说明都来自GitHub Pages文档，但是其中也有一些gotchya。如果你想要一个子域(“www。或者是“简历”)，请按照说明配置子域。如果没有，向下滚动以遵循配置“apex”域的说明。</p><div class="nr ns gp gr nt nu"><a href="https://help.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">管理GitHub Pages站点的自定义域</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">您可以设置或更新某些DNS记录和您的存储库设置，以指向您的GitHub的默认域…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">help.github.com</p></div></div></div></a></div><p id="ac73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上，apex域的步骤是:</p><ul class=""><li id="52c1" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">从注册商处获得域名(godaddy.com，AWS Route 53等。)</li><li id="a57e" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">在回购的“设置”标签中，粘贴您的自定义域名。</li><li id="a1eb" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">将域名的A记录指向GitHub.io文档提供的IP地址。</li></ul><pre class="kg kh ki kj gt ni nh nj nk aw nl bi"><span id="1917" class="nm mi iq nh b gy nn no l np nq">185.199.108.153<br/>185.199.109.153<br/>185.199.110.153<br/>185.199.111.153</span></pre><ul class=""><li id="32ad" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">在您的构建输出中，指定一个包含域名的CNAME文件。<strong class="ky ir">参见下一节关于修改构建脚本的内容。</strong></li><li id="0fea" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">(后来)启用HTTPS。根据我的经验，选中复选框并不总是“有效”，所以确保以后再次选中它。</li></ul><h1 id="d87a" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">在每次构建时生成CNAME文件</h1><p id="525a" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">在进行构建时，您需要自动包含一个CNAME文件。(否则，您的下一次部署将清除以前的CNAME文件，您的站点将会崩溃。)</p><p id="a420" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在部署到gh-pages分支之前，构建一个脚本，将您的CNAME文件添加到构建输出中。请随意调整我的快速脚本以满足您的需求:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Don’t forget to change the “yourwebsitehere.com” bit!</figcaption></figure><p id="d0bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将<code class="fe ne nf ng nh b">"web:build": "bash build.sh"</code>添加到package.json脚本中。</p><h1 id="1f5c" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">一键部署脚本</h1><p id="793d" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">一旦建立了构建脚本和定制域，您就可以运行一个命令来部署到生产环境中。我把它添加到我的package.json脚本中，然后知道我的应用程序的web版本在GitHub上免费测试和部署，晚上就可以睡个好觉了。</p><pre class="kg kh ki kj gt ni nh nj nk aw nl bi"><span id="7ff7" class="nm mi iq nh b gy nn no l np nq">"web:deploy": "yarn ci &amp;&amp; yarn web:e2e &amp;&amp; yarn web:build &amp;&amp; gh-pages -d web-build",</span></pre></div></div>    
</body>
</html>