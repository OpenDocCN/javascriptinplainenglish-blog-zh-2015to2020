<html>
<head>
<title>React Patterns — Writing Clean Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应模式—编写干净的代码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-patterns-writing-clean-code-9535f211a6a9?source=collection_archive---------1-----------------------#2020-06-17">https://javascript.plainenglish.io/react-patterns-writing-clean-code-9535f211a6a9?source=collection_archive---------1-----------------------#2020-06-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a6d130690bac116eb7eb67844327cefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LnYYJUI0mXRcS3Yg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@zoeeee_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Zoë Reeve</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9675" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何清理我们的React代码。</p><h1 id="a539" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">多属性</h1><p id="3591" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们有很多属性或道具，我们应该把它们放在自己的线上。</p><p id="4d65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="81e0" class="mn lc iq mj b gy mo mp l mq mr">&lt;Content<br/> foo="bar"<br/> anotherProp="baz"<br/> onClick={this.handleClick}<br/>/&gt;</span></pre><p id="9d38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以清楚地看到每个道具。</p><p id="333a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">道具应该有一个缩进。</p><p id="a760" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就不会有需要滚动的长队。</p><h1 id="0b00" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">条件式</h1><p id="9f2f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们经常要写条件语句或者表达式来有条件的显示一些东西。</p><p id="dea5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="96f0" class="mn lc iq mj b gy mo mp l mq mr">let link;<br/>if (isLoggedIn) {<br/>  link= &lt;LogoutLink /&gt;<br/>}<br/>return &lt;div&gt;{link}&lt;/div&gt;</span></pre><p id="e27a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，这很难理解。</p><p id="870a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更困难的是我们有多种成分和条件。</p><p id="35c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使它更简短，我们可以使用内联表达式来代替:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="20b7" class="mn lc iq mj b gy mo mp l mq mr">&lt;div&gt;<br/> {isLoggedIn &amp;&amp; &lt;LogoutLink /&gt;}<br/>&lt;/div&gt;</span></pre><p id="c33a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为如果<code class="fe ms mt mu mj b">isLoggedIn</code>是<code class="fe ms mt mu mj b">false</code>，那么第二个表达式将不会被求值。</p><p id="6229" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但如果是，那就一定会。</p><p id="6ce8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想为替代情况显示一些内容，而不是编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1c2c" class="mn lc iq mj b gy mo mp l mq mr">let link;<br/>if (isLoggedIn) {<br/>  link = &lt;LogoutLink /&gt;<br/>} else {<br/>  link = &lt;LoginLink /&gt;<br/>}<br/>return &lt;div&gt;{link}&lt;/div&gt;</span></pre><p id="6f0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用一个三元表达式来简化它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="008e" class="mn lc iq mj b gy mo mp l mq mr">&lt;div&gt;<br/>  {isLoggedIn ? &lt;LogoutLink /&gt; : &lt;LoginLink /&gt;}<br/>&lt;/div&gt;</span></pre><p id="c619" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有更长的布尔表达式，那么我们应该把它们放在一个函数中，而不是把它们写出来:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="601f" class="mn lc iq mj b gy mo mp l mq mr">const canShowSecretData = () =&gt; {<br/>  return dataLoaded &amp;&amp; (isAdmin || userHasPermissions)<br/>}</span></pre><p id="2c95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在条件表达式中使用它来表达:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5db1" class="mn lc iq mj b gy mo mp l mq mr">&lt;div&gt;<br/>  {canShowSecretData() &amp;&amp; &lt;Secret /&gt;}<br/>&lt;/div&gt;</span></pre><p id="9235" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一个类组件，我们也可以定义一个getter:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c2f3" class="mn lc iq mj b gy mo mp l mq mr">get canShowSecretData(){<br/>  return dataLoaded &amp;&amp; (isAdmin || userHasPermissions)<br/>}</span></pre><p id="bd63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们可以使用:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c8b8" class="mn lc iq mj b gy mo mp l mq mr">&lt;div&gt;<br/> {this.canShowSecretData &amp;&amp; &lt;Secret /&gt;}<br/>&lt;/div&gt;</span></pre><p id="840a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算出的属性也可以放入函数中。</p><p id="55f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1353" class="mn lc iq mj b gy mo mp l mq mr">const getPriceAfterTax = () =&gt; {<br/>  return currency * (1 + taxRate);<br/>}</span></pre><p id="91c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在类组件中，我们也可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="905e" class="mn lc iq mj b gy mo mp l mq mr">getPriceAfterTax() {<br/>  return this.props.currency * (1 + this.props.taxRate);<br/>}</span></pre><p id="0602" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果它在一个类中，我们也可以使用一个getter:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bffb" class="mn lc iq mj b gy mo mp l mq mr">get priceAfterTax() {<br/>  return this.props.currency * (1 + this.props.taxRate);<br/>}</span></pre><p id="bb80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一个<code class="fe ms mt mu mj b">render-if</code>包，让我们传入一个组件来有条件地显示。</p><p id="7e4c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下内容来安装它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8e5b" class="mn lc iq mj b gy mo mp l mq mr">npm install --save render-if</span></pre><p id="620d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0862" class="mn lc iq mj b gy mo mp l mq mr">const canShowSecretData = renderIf(<br/> dataLoaded &amp;&amp; (isAdmin || userHasPermissions)<br/>)</span></pre><p id="0610" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以有条件地呈现我们的组件:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0587" class="mn lc iq mj b gy mo mp l mq mr">&lt;div&gt;<br/> {canShowSecretData(&lt;Secret /&gt;)}<br/>&lt;/div&gt;</span></pre><p id="1743" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者，我们可以使用<code class="fe ms mt mu mj b">react-only-if</code>包来创建一个组件，该组件由该包附带的高阶组件有条件地呈现。</p><p id="22f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了安装它，我们编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4b4f" class="mn lc iq mj b gy mo mp l mq mr">npm install --save react-only-if</span></pre><p id="1407" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="186b" class="mn lc iq mj b gy mo mp l mq mr">const SecretDataOnlyIf = onlyIf(<br/> ({ dataLoaded, isAdmin, userHasPermissions }) =&gt; {<br/>   return dataLoaded &amp;&amp; (isAdmin || userHasPermissions)<br/> }<br/>)(Secret)</span><span id="9ab0" class="mn lc iq mj b gy mv mp l mq mr">...</span><span id="a259" class="mn lc iq mj b gy mv mp l mq mr">&lt;div&gt;<br/> &lt;SecretOnlyIf<br/>   dataLoaded={...}<br/>   isAdmin={...}<br/>   userHasPermissions={...}<br/> /&gt;<br/>&lt;/div&gt;</span></pre><p id="8869" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们不需要在表达式中有逻辑来显示JSX代码中的<code class="fe ms mt mu mj b">Secret</code>。</p><p id="c2dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在将某物渲染为道具之前，我们传入表达式进行检查。</p><h1 id="bb45" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">环</h1><p id="d142" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了呈现对象列表，我们使用了<code class="fe ms mt mu mj b">map</code>方法。</p><p id="34e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="cf80" class="mn lc iq mj b gy mo mp l mq mr">&lt;div&gt;<br/>  {users.map(user =&gt; &lt;p key={user.id}&gt;{user.name}&lt;/p)}<br/>&lt;/div&gt;</span></pre><p id="5c0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意，我们必须使用带有唯一ID的<code class="fe ms mt mu mj b">key</code>属性，这样React才能正确跟踪列表项。</p><p id="0057" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们要动态地改变条目，这就更重要了。</p><h1 id="5b27" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">控制语句</h1><p id="ed12" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有一个<code class="fe ms mt mu mj b">jsx-control-statements</code>包可以让我们有条件地呈现项目，尤其是在有多个案例的情况下。</p><p id="f296" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过编写以下内容来安装它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6d33" class="mn lc iq mj b gy mo mp l mq mr">npm install - save jsx-control-statements</span></pre><p id="97bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe ms mt mu mj b">.babelrc</code>文件中，我们添加:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0106" class="mn lc iq mj b gy mo mp l mq mr">"plugins": ["jsx-control-statements"]</span></pre><p id="7554" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="be37" class="mn lc iq mj b gy mo mp l mq mr">&lt;If condition={canShowSecret}&gt;<br/>  &lt;Secret /&gt;<br/>&lt;/If&gt;</span></pre><p id="8c99" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有不止一个案例，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="27ca" class="mn lc iq mj b gy mo mp l mq mr">&lt;Choose&gt;<br/>  &lt;When condition={...}&gt;<br/>    &lt;span&gt;if&lt;/span&gt;<br/>  &lt;/When&gt;<br/>  &lt;When condition={...}&gt;<br/>    &lt;span&gt;else if&lt;/span&gt;<br/>  &lt;/When&gt;<br/>  &lt;Otherwise&gt;<br/>    &lt;span&gt;else&lt;/span&gt;<br/>  &lt;/Otherwise&gt;<br/>&lt;/Choose&gt;</span></pre><p id="3293" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">When</code>就像<code class="fe ms mt mu mj b">case</code>和<code class="fe ms mt mu mj b">Otherwise</code>如果像<code class="fe ms mt mu mj b">default</code>在一个<code class="fe ms mt mu mj b">switch</code>语句中。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/84e540b3113a61bfb9b53029e7e3e57c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M4bfLvRQvTxJG6Sd"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@cieloadentro?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roksolana Zasiadko</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="48e0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="9f9d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在React组件中，有许多方法可以使事物变得干净。</p><p id="04f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有很多条件语句，我们可能想要使用那些列出的包。</p><p id="166f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想要呈现一个列表，我们使用数组的<code class="fe ms mt mu mj b">map</code>方法。</p><h2 id="68bf" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">简单英语的JavaScript</strong></h2><p id="09e2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>