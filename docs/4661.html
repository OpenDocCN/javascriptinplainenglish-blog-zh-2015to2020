<html>
<head>
<title>Generate Word Documents from Templates in Vue.JS with TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Vue中的模板生成Word文档。带有类型脚本的JS</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/generate-word-documents-from-templates-in-vue-js-with-typescript-da0f15114f5d?source=collection_archive---------3-----------------------#2020-12-29">https://javascript.plainenglish.io/generate-word-documents-from-templates-in-vue-js-with-typescript-da0f15114f5d?source=collection_archive---------3-----------------------#2020-12-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/93690763ee5289e8df67a1aa93ed59c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lHVz-zbOMa2kYmZ8rbauTA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@austinchan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Austin Chan</a> on <a class="ae kc" href="https://unsplash.com/s/photos/template?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9534" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的一个Vue项目中，我需要用不同的模板生成word文档。我做了一个小的R&amp;D，遇到了几个库和API来实现这个。它们都不是免费的，我们必须购买订阅，这对我来说非常昂贵。可用的免费库使用的方法是，我们必须首先用HTML设计模板，然后将它们呈现为word文档。这种方法不适合我的需要，因为有许多模板，它们可以根据客户的需要经常改变。</p><p id="6e4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我遇到了一个很棒的库(这是互联网上唯一可用的库),它可以根据给定的模板生成word文档，该模板包括在生成报告时可以用当前数据替换的标签。它是一个JavaScript库，但我的Vue项目是在Typescript中。</p><p id="244a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我将解释如何用Vue轻松实现这个特性。TypeScript中的JS项目。如果您不熟悉使用TypeScript的Vue，请阅读这篇解释如何创建新Vue的文章。TypeScript中的JS项目。其他人可以继续。</p><h1 id="7495" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">安装必要的库</h1><p id="0d6d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了生成word文档，我们使用由<a class="ae kc" href="https://twitter.com/EdgarHipp" rel="noopener ugc nofollow" target="_blank"> Edgar Hipp </a>开发的<a class="ae kc" href="https://www.npmjs.com/package/docxtemplater" rel="noopener ugc nofollow" target="_blank"> docxtemplater库</a>。首先，在项目文件夹内的控制台中运行这些命令</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="465c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了主库，在这个过程中我们还需要上面提到的其他库。文件保存库用于将最终输出保存到本地机器。</p><h1 id="4d3d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为TypeScript编写定义文件</h1><p id="e9dd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果某些JavaScript库不包含TypeScript的类型定义文件，则不能在TypeScript项目中直接使用它们。类型定义文件通常以<em class="mk">&lt;library name&gt;</em><strong class="kf ir"><em class="mk">. d . ts</em></strong>的形式出现，你可以在项目的node_modules文件夹中查看已安装的库中是否有这样的文件。</p><p id="df67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了docxtemplater库，其他三个库都不包含这样的定义文件。因此，我们必须自己单独为它们编写定义文件。这些文件被创建，按照结构<strong class="kf ir"><em class="mk">&lt;library name&gt;. d . ts</em></strong>命名，放置在<strong class="kf ir"> <em class="mk"> src </em> </strong>文件夹中。</p><p id="d6eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> jszip.d.ts </strong></p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="ak">jszip.d.ts</strong></figcaption></figure><p id="254c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> jszip-utils.ts </strong></p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="ak">jszip-utils.ts</strong></figcaption></figure><p id="8f9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> file-saver.d.ts </strong></p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="ak">file-saver.d.ts</strong></figcaption></figure><p id="5d37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在src文件夹中创建这些文件后，您可以在任何组件中使用它们。</p><h1 id="8c85" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">提交模板</h1><p id="e0af" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">首先，您必须将由标签组成的模板文档放在Vue项目的<strong class="kf ir"> public </strong>文件夹中。标签写在两个大括号内。ex:-<strong class="kf ir">{全名} </strong>。</p><p id="05ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解释这个问题，我创建了我的样本模板，并把它放在一个单独的文件夹中，这个文件夹位于<strong class="kf ir"> public </strong>文件夹中(public→report templates→template-1 . docx)。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/0db1c494508b91f265579099a9c2f13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*6a9xpzDPpVY20naABwcjCQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Sample template ( template-1.docx )</figcaption></figure><p id="4080" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有在<strong class="kf ir"> {} </strong>里面的都是标签，它们被渲染时提供的JSON数据集所替代。JSON对象中的标记名和属性名必须相似，才能对标记进行替换。</p><p id="d626" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mk"> {#students}……{/students} </em>表格中的一行表示JSON对象中名为“students”的列表，我们将在渲染时提供该列表。</p><p id="80bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这个例子，这是我们将提供的JSON数据集。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">JSON Object</figcaption></figure><h1 id="e667" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">编写组件</h1><p id="a4b9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这就是我的最终组件代码的样子。当我单击这个按钮时，它会下载docx格式的最终word文档以及JSON格式的硬编码数据集。通常，您应该调用您的后端API并为报告获取这个数据集。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="189d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第82行，对于loadFile函数的第一个参数，您可以给出模板相对于<strong class="kf ir"> public </strong>文件夹的路径。</p><p id="b5c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者</p><p id="eb3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如第81行(注释)所示，您也可以传递一个URL。这也可以来自服务器或云存储。</p><p id="3bc1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里使用JSUtils库从模板文档中读取二进制内容，并以可以压缩的方式准备它。JSZip库用于创建压缩内容。docxtemplater库要求模板为压缩内容。这就是我们在这个过程中使用另外两个库的原因。</p><p id="92b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第89行，您可以看到我已经为文档设置了JSON数据集。如前所述，这个数据集可以来自API。</p><p id="bb28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第113行，在file-saver.js库中导出的saveAs函数已经被用来下载具有给定文件名(这里是MyDocument.docx)的blob。</p><p id="0fd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在上面的代码中添加了一些有用的注释，这样你就可以随意修改代码了。</p><h1 id="747b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最终输出</h1><p id="e79b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在提交模板、创建定义文件和编写Vue组件之后，我们可以下载下面这个不错的word文档。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/4864b22f5e3aafc88fbd599bd2a9d08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*YlaBXSVSn4l2r_nJYx_cwQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">MyDocument.docx</figcaption></figure><h2 id="df09" class="mm lc iq bd ld mn mo dn lh mp mq dp ll ko mr ms lp ks mt mu lt kw mv mw lx mx bi translated">我们还能用这个图书馆做什么？</h2><p id="2124" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">仅word文档带有“.”。docx”可以生成免费版。(商业版也支持pptx和xlsx版本)</p><p id="46df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">免费版本支持以下功能，足以在您的项目中生成好看的令人印象深刻的报告。</p><ul class=""><li id="1e00" class="my mz iq kf b kg kh kk kl ko na ks nb kw nc la nd ne nf ng bi translated">在表格中填充数据(就像我们讨论的例子一样)</li><li id="9f45" class="my mz iq kf b kg nh kk ni ko nj ks nk kw nl la nd ne nf ng bi translated">用给定的对象列表重复word文档中的一节。(循环)</li><li id="cbe1" class="my mz iq kf b kg nh kk ni ko nj ks nk kw nl la nd ne nf ng bi translated">通过启用<a class="ae kc" href="https://docxtemplater.readthedocs.io/en/latest/angular_parse.html#angular-parser" rel="noopener ugc nofollow" target="_blank">角度解析器选项</a>对标签进行条件渲染。</li><li id="9201" class="my mz iq kf b kg nh kk ni ko nj ks nk kw nl la nd ne nf ng bi translated">创建循环列表</li></ul><p id="fdfa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在他们的<a class="ae kc" href="https://docxtemplater.com/" rel="noopener ugc nofollow" target="_blank">官方页面</a>的<a class="ae kc" href="https://docxtemplater.com/demo/" rel="noopener ugc nofollow" target="_blank">演示区</a>测试这些功能。</p><h2 id="46f0" class="mm lc iq bd ld mn mo dn lh mp mq dp ll ko mr ms lp ks mt mu lt kw mv mw lx mx bi translated">结论</h2><p id="41c7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我解释了如何通过Vue使用这个docxtemplater库。TypeScript中的JS项目。使用这种方法，可以适应模板的频繁变化，而标签名称保持不变。这是我迄今为止遇到的最有优势的图书馆之一，我相信有一天你也会遇到同样的情况。</p><p id="c970" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你对此有任何问题，请不要犹豫，使用评论部分。</p><p id="3698" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读&amp;快乐编码！</p></div></div>    
</body>
</html>