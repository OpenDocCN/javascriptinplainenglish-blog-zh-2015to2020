<html>
<head>
<title>Introduction to the Vue Composition API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue组合API简介</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/introduction-to-the-vue-composition-api-1485d301c100?source=collection_archive---------3-----------------------#2020-05-19">https://javascript.plainenglish.io/introduction-to-the-vue-composition-api-1485d301c100?source=collection_archive---------3-----------------------#2020-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3c302b6419ee8dafdf18ec927b9ac6f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cJmjP9okOJVYXIS-"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@1stpersonviews?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nazar Yakymenko</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1834" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js是一个易于使用的web应用框架，我们可以用它来开发交互式前端应用。</p><p id="b479" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看Vue 2.x的Vue Composition API插件，以更接近Vue 3.x的方式创建我们的组件。</p><h1 id="9db3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Vue组合API</h1><p id="98a9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Vue组合API允许我们将可重用的代码移动到组合函数中，任何组件都可以使用<code class="fe me mf mg mh b">setup</code>组件选项。</p><p id="a65f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了它，我们不必担心mixin成员和component成员之间的名称冲突，因为所有成员都封装在它们自己的函数中，我们可以用新名称导入它们。</p><p id="b396" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不必重新创建组件实例来重用不同组件的逻辑。</p><p id="10fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Composition API是在大型项目中构建的，其中有大量可重用的代码。</p><p id="43b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了上面列出的好处，我们还有更好的类型推断。它的可读性也更好，因为我们可以将所有代码追溯到它们的组合函数，其中代码是在<code class="fe me mf mg mh b">setup</code>方法中声明的。</p><p id="5e00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vetur VS Code扩展有助于使用VS代码开发Vue应用程序，当它与Composition API一起使用时，提供类型推断。</p><h1 id="ec1c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">怎么用？</h1><p id="fc4f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">对于Vue 2.x项目，我们可以通过为Vue CLI项目安装Vue Composition API包来使用它，如下所示:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9baf" class="mq lc iq mh b gy mr ms l mt mu">npm install @vue/composition-api</span></pre><p id="9e0c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它也适用于不使用Vue CLI作为库的项目，我们可以通过脚本标记添加库，如下所示:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="833f" class="mq lc iq mh b gy mr ms l mt mu">&lt;script src="https://unpkg.com/@vue/composition-api/dist/vue-composition-api.umd.js"&gt;&lt;/script&gt;</span></pre><p id="b740" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其余步骤假设我们正在构建一个Vue CLI项目。</p><p id="a5b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们安装了它，我们可以通过首先在<code class="fe me mf mg mh b">main.js</code>中注册如下插件来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3c60" class="mq lc iq mh b gy mr ms l mt mu">import Vue from "vue";<br/>import App from "./App.vue";<br/>import VueCompositionApi from "@vue/composition-api";</span><span id="9267" class="mq lc iq mh b gy mv ms l mt mu">Vue.use(VueCompositionApi);</span><span id="ab0e" class="mq lc iq mh b gy mv ms l mt mu">Vue.config.productionTip = false;</span><span id="f580" class="mq lc iq mh b gy mv ms l mt mu">new Vue({<br/>  render: h =&gt; h(App)<br/>}).$mount("#app");</span></pre><p id="3a85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将实际使用Vue Composition API插件来构建我们的组件。</p><p id="4e0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们在<code class="fe me mf mg mh b">components</code>文件夹中创建一个名为<code class="fe me mf mg mh b">Search.vue</code>的文件，如下:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1130" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div class="hello"&gt;<br/>    &lt;form @submit.prevent="handleSubmit"&gt;<br/>      &lt;label&gt;{{label}}&lt;/label&gt;<br/>      &lt;input type="text" v-model="state.name"&gt;<br/>      &lt;input type="submit" value="search"&gt;<br/>    &lt;/form&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="3655" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import { reactive } from "@vue/composition-api";</span><span id="78fe" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "Search",<br/>  props: {<br/>    label: String<br/>  },<br/>  setup({ label }, { emit }) {<br/>    const state = reactive({<br/>      name: ""<br/>    });</span><span id="ab81" class="mq lc iq mh b gy mv ms l mt mu">    return {<br/>      handleSubmit(event) {<br/>        emit("search", state.name);<br/>      },<br/>      state<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="03d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们创建了一个组件，它采用一个名为<code class="fe me mf mg mh b">label</code>的道具，这是一个字符串。</p><p id="63a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过从<code class="fe me mf mg mh b">setup</code>方法的第一个参数中获取道具的值，而不是用原来的Vue API获取道具作为<code class="fe me mf mg mh b">this</code>的属性。</p><p id="43a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，<code class="fe me mf mg mh b">emit</code>方法是从作为第二个参数传递给<code class="fe me mf mg mh b">setup</code>的对象中获取的，而不是从<code class="fe me mf mg mh b">this</code>的属性中获取的。</p><p id="405f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了保存状态，我们从组合API包中调用<code class="fe me mf mg mh b">reactive</code>函数，向它传递一个带有状态属性的对象。</p><p id="3387" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">state</code>和<code class="fe me mf mg mh b">reactive</code>相当于我们用常规Vue API在<code class="fe me mf mg mh b">data</code>方法中返回的对象。</p><p id="53e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">常量<code class="fe me mf mg mh b">state</code>作为对象的属性返回，这样我们可以在模板中引用状态作为属性<code class="fe me mf mg mh b">state</code>。</p><p id="5662" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了用Vue组合API添加方法，我们将它们添加到我们返回的对象中，而不是像没有Vue组合API时那样作为<code class="fe me mf mg mh b">methods</code>属性的一个属性。</p><p id="2b8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">handleSubmit</code>方法做到了。</p><p id="5e23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的模板中，我们将<code class="fe me mf mg mh b">v-model</code>绑定到<code class="fe me mf mg mh b">state.name</code>，而不仅仅是<code class="fe me mf mg mh b">name</code>。但是我们引用了<code class="fe me mf mg mh b">handleSubmit</code>方法，就像我们以前引用方法一样。</p><p id="024b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们在输入中键入一些内容并点击搜索时，就会发出<code class="fe me mf mg mh b">search</code>事件。</p><p id="4304" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，在<code class="fe me mf mg mh b">App.vue</code>中，我们编写以下代码:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2f02" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;Search label="name" @search="search"/&gt;<br/>    &lt;div&gt;{{state.data.name}}&lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="e1e1" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import Search from "./components/Search";<br/>import { reactive } from "@vue/composition-api";</span><span id="f2d7" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "App",<br/>  components: {<br/>    Search<br/>  },<br/>  setup() {<br/>    const state = reactive({<br/>      data: {}<br/>    });</span><span id="5f6b" class="mq lc iq mh b gy mv ms l mt mu">    return {<br/>      state,<br/>      async search(ev) {<br/>        const res = await fetch(`https://api.agify.io/?name=${ev}`);<br/>        state.data = await res.json();<br/>      }<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="c935" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们有类似于<code class="fe me mf mg mh b">Search.vue</code>的结构。我们在这个文件中没有的是监听事件。</p><p id="5a35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">search</code>方法，它监听从<code class="fe me mf mg mh b">Search.vue</code>发出的<code class="fe me mf mg mh b">search</code>事件。在<code class="fe me mf mg mh b">search</code>方法中，我们获取一些数据，将其分配给<code class="fe me mf mg mh b">state</code>，并显示在模板上。</p><p id="e413" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们将检索到的数据分配给了<code class="fe me mf mg mh b">state.data</code>。</p><p id="827c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用Vue Composition API包中的<code class="fe me mf mg mh b">computed</code>函数添加计算属性。</p><p id="710b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以用下面的代码替换<code class="fe me mf mg mh b">App.vue</code>来创建一个计算属性并使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6fbf" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;Search label="name" @search="search"/&gt;<br/>    &lt;div&gt;{{state.name}}&lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="42ec" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import Search from "./components/Search";<br/>import { computed, reactive } from "@vue/composition-api";</span><span id="fe89" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "App",<br/>  components: {<br/>    Search<br/>  },<br/>  setup() {<br/>    const state = reactive({<br/>      data: {},<br/>      name: computed(() =&gt;<br/>        state.data.name ? `The name is: ${state.data.name}` : ""<br/>      )<br/>    });</span><span id="3509" class="mq lc iq mh b gy mv ms l mt mu">    return {<br/>      state,<br/>      async search(ev) {<br/>        const res = await fetch(`https://api.agify.io/?name=${ev}`);<br/>        state.data = await res.json();<br/>      }<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="1e63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们通过导入<code class="fe me mf mg mh b">computed</code>函数来创建一个计算属性，从而对<code class="fe me mf mg mh b">App.vue</code>做了一些小小的修改。</p><p id="7df7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建属性，我们添加了:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="eacc" class="mq lc iq mh b gy mr ms l mt mu">computed(() =&gt; state.data.name ? `The name is: ${state.data.name}` : "")</span></pre><p id="63a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在模板中，我们通过编写以下内容来引用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="43f2" class="mq lc iq mh b gy mr ms l mt mu">&lt;div&gt;{{state.name}}&lt;/div&gt;</span></pre><p id="0e0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们键入一些内容并点击搜索时，我们会看到“名称是(您键入的任何内容)”。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/d63713ccbad6b8eac969af66dd5ee8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3C3J7yQBgZhtoBjc"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@paulgilmore_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Paul Gilmore</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="d7c9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="df8a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Vue组合API对于在复杂的应用程序中创建组件非常有用。它的组织减少了名称的冲突，并在我们的组件中提供了更好的类型推断。</p><p id="0e3f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们仍然拥有我们习惯的一切，比如状态、方法、事件、模板和计算属性。只是他们在不同的地方。</p><h1 id="c6d0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">简明英语团队的笔记</strong></h1><p id="9464" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="kf ir">JavaScript in Plain English</strong></a><a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！</p><p id="c9e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还推出了一个YouTube，希望你能通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的简明英语频道</strong> </a>来支持我们</p><p id="20d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一如既往,“简明英语”希望帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>