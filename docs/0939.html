<html>
<head>
<title>Create a Twitter Bot in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Node.js中创建一个Twitter Bot</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-twitter-bot-in-node-js-a09137ad2b7b?source=collection_archive---------5-----------------------#2020-01-04">https://javascript.plainenglish.io/create-a-twitter-bot-in-node-js-a09137ad2b7b?source=collection_archive---------5-----------------------#2020-01-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/20e9cef92f6dd4676a90eee94bb94c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eIdt1EeVcD7Pp2S7"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@freestocks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">freestocks.org</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1d3d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一个简单的转发/搜索/回复推特的推特机器人怎么样？我最近做了一个——<a class="ae jz" href="https://twitter.com/checkra1nbot" rel="noopener ugc nofollow" target="_blank">来看看</a>。构建twitter机器人听起来可能是一件大事，但一旦你理解了JavaScript和Node.js的基础知识，这真的很容易。今天，我们将使用来自<a class="ae jz" href="http://npmjs.org" rel="noopener ugc nofollow" target="_blank"> npm </a>的“twit”包来构建一个twitter机器人。请注意——您需要参考<a class="ae jz" href="https://www.npmjs.com/package/twit" rel="noopener ugc nofollow" target="_blank"> twit文档</a>以获得更深入的参考。</p><h2 id="1a1a" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">入门指南</h2><p id="c2e4" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">首先，确保您已经安装了Node.js(当然)。要在Linux上安装它:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="90d8" class="ky kz in mb b gy mf mg l mh mi">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.1/install.sh | bash</span></pre><p id="1294" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="d631" class="ky kz in mb b gy mf mg l mh mi">nvm install node</span></pre><p id="cb97" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在新项目中</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="31a4" class="ky kz in mb b gy mf mg l mh mi">npm init</span></pre><p id="8137" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于所有的提示，只需按回车键(默认)。</p><p id="558a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要安装twit:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="5c9c" class="ky kz in mb b gy mf mg l mh mi">npm install twit</span></pre><p id="60c1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，我们只需要在<a class="ae jz" href="https://www.twitter.com" rel="noopener ugc nofollow" target="_blank">https://www.twitter.com</a>上为机器人创建一个账户</p></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><p id="fb7e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为机器人创建一个账户后，前往https://apps.twitter.com/app/new为机器人创建一个新的twitter开发者账户。</p><p id="b186" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">填写表格中的必要字段，然后点击“创建您的Twitter应用程序”按钮。创建应用程序后，在导航窗格下查找“密钥和访问令牌”,单击“生成令牌操作”,然后复制:</p><ul class=""><li id="5cb1" class="mq mr in kc b kd ke kh ki kl ms kp mt kt mu kx mv mw mx my bi translated">消费者密钥</li><li id="a5d3" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated">消费者秘密</li><li id="09ec" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated">访问令牌</li><li id="8183" class="mq mr in kc b kd mz kh na kl nb kp nc kt nd kx mv mw mx my bi translated">访问令牌秘密</li></ul><p id="ae13" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建新的config.js文件并添加凭据，如下所示:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="2083" class="ky kz in mb b gy mf mg l mh mi">// config.js<br/>/** TWITTER APP CONFIGURATION<br/> * consumer_key<br/> * consumer_secret<br/> * access_token<br/> * access_token_secret<br/> */</span><span id="350c" class="ky kz in mb b gy ne mg l mh mi">module.exports = {<br/>  consumer_key: '',  <br/>  consumer_secret: '',<br/>  access_token: '',  <br/>  access_token_secret: ''<br/>}</span></pre></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><h2 id="c863" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">建造机器人</h2><p id="0947" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">在同一个文件夹中，创建一个<code class="fe nf ng nh mb b">index.js</code>文件。我们需要根据需要用配置文件实例化一个新的Twit和Twitter对象。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="2a78" class="ky kz in mb b gy mf mg l mh mi">var Twit = require('twit');<br/>var Twitter = new Twit(require('./config.js');</span></pre><h2 id="e0a7" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">转发功能</h2><p id="2c23" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">让我们创建一个转发东西的函数。为此，我们可以使用Twitter对象来转发作为参数传递给函数的tweet。Twitter对象(根据文档)转发作为ID字符串传递给post函数的推文。这意味着tweet的ID必须作为post函数的参数给出。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="60ee" class="ky kz in mb b gy mf mg l mh mi">/**<br/> * Retweets a tweet passed into the function.<br/> * @param {*} tweet<br/> */<br/>function retweet(tweet) {<br/>  Twitter.post(<br/>    'statuses/retweet/:id',<br/>    { id: tweet.id_str },<br/>    function(err, data, response) {<br/>      // do something<br/>    });<br/>}</span></pre><p id="7fed" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这样，在我们传递给post函数的函数被调用后，你就可以做一些事情了。被称为回调的函数将被返回:<code class="fe nf ng nh mb b">err, data, response</code>。这意味着我们可以使用返回的<code class="fe nf ng nh mb b">data</code>来告诉控制台我们转发了哪条tweet(可选)。返回的<code class="fe nf ng nh mb b">data</code>实际上是一个<code class="fe nf ng nh mb b">twitter</code>对象。</p><p id="fe8e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">否则，如果twitter在转发推文时向我们发送一个错误，我们可以只记录到控制台。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="4cd8" class="ky kz in mb b gy mf mg l mh mi">/**<br/> * Retweets a tweet passed into the function.<br/> * @param {*} tweet<br/> */<br/>function retweet(tweet) {<br/>  Twitter.post(<br/>    'statuses/retweet/:id',<br/>    { id: tweet.id_str },<br/>    function(err, data, response) {<br/>      if (err) {  // here<br/>        console.log(err.message);<br/>        return;<br/>      }<br/>    }<br/>  );<br/>}</span></pre><h2 id="4735" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated">搜索功能</h2><p id="038f" class="pw-post-body-paragraph ka kb in kc b kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">我们也可以有一个函数搜索某个东西，用搜索后的结果调用另一个函数作为参数传入搜索函数。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="3c9e" class="ky kz in mb b gy mf mg l mh mi">/**<br/> * The searching function.<br/> * @callback callback function which is called after the tweet is returned.<br/> */<br/>function search(callback) {</span><span id="25c3" class="ky kz in mb b gy ne mg l mh mi">/**<br/>   * Gets a search key from data.js.<br/>   * @private<br/>   */<br/>  function getSearchKey() {<br/>    let searchKeys = require('./data.js').searchKeys;<br/>    return searchKeys[Math.floor(Math.random() * searchKeys.length)].toLowerCase();<br/>  }</span><span id="39a4" class="ky kz in mb b gy ne mg l mh mi">Twitter.get(<br/>    'search/tweets',<br/>    { q: getSearchKey(), count: 50, lang: 'en' },<br/>    function(err, data, response) {<br/>      let tweetList = [];<br/>      if (!err) {<br/>        for (let i = 0; i &lt; data.statuses.length; i++) {<br/>          let tweet = data.statuses[i];<br/>          tweetList.push(tweet);<br/>        }<br/>        callback(tweetList);<br/>        return;<br/>      } else {<br/>        console.log(err);<br/>      }<br/>    }<br/>  );<br/>}</span></pre><p id="c19a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您想搜索某样东西，并从查询中转发一个随机结果，我们可以将retweet函数传递给search函数，并设置函数执行的时间间隔。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="aab3" class="ky kz in mb b gy mf mg l mh mi">function main() {<br/>  search(retweet);<br/>}</span></pre><p id="15ef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们正在调用这个函数，但并没有实际运行它。这意味着我们没有将()括号放在<code class="fe nf ng nh mb b">retweet</code>函数之后。只有在搜索函数中才会从内部调用。</p><p id="c528" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，我们可以在设定的时间间隔后调用main函数。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="e79a" class="ky kz in mb b gy mf mg l mh mi">main();  // Run the main function once first before running the interval ticks. This is optional.</span><span id="7b82" class="ky kz in mb b gy ne mg l mh mi">setInterval(main, Math.floor(((Math.random() * 10) + 5) * 1000) * 60);</span></pre></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><p id="69c1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请参考<a class="ae jz" href="https://www.npmjs.com/package/twit#usage" rel="noopener ugc nofollow" target="_blank"> twit文档</a>,了解更多你可以用twit做的事情。</p><p id="0286" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读！</p><p id="eec4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ni">本文原载于</em><a class="ae jz" href="https://blog.raphtlw.rocks/posts/create-a-twitter-bot-in-node-js/" rel="noopener ugc nofollow" target="_blank"><em class="ni">blog . raphtlw . rocks</em></a></p></div></div>    
</body>
</html>