<html>
<head>
<title>How to test your Redux API calls with Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Jest测试Redux API调用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-test-your-redux-api-calls-with-jest-64ebdd9c0034?source=collection_archive---------6-----------------------#2020-04-15">https://javascript.plainenglish.io/how-to-test-your-redux-api-calls-with-jest-64ebdd9c0034?source=collection_archive---------6-----------------------#2020-04-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/6ad6e4e8c811351ce4ea7312e394c146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHrIelvk-b4NnaK1gJpYLw.jpeg"/></div></div></figure><p id="0676" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我们将讨论如何测试API如何在我们的应用程序中调用Jest并使用Axios作为HTTP客户端。Redux允许您处理和管理多条路线上的复杂数据，分派各种类型的动作，但有时处理异步数据可能会很棘手，因为响应会随时间变化。</p><p id="bf60" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在下面的示例中，您将看到关于如何使用以下工具处理异步调用的提示和教程:</p><p id="3ee5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Jest:React(或其他)应用的主要测试框架；<br/> <strong class="jx io"> Axios </strong>:用于HTTP客户端通信；<br/> <strong class="jx io"> Moxios </strong>:模仿我们的Axios API调用。</p><p id="493b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在下一个示例中，我将提供一个使用Axios的get请求的简单示例:</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="8b21" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">开始对get用户进行单元测试的第一步将是使用<strong class="jx io"> Moxios </strong>进行模拟。这个文件必须有fixture扩展名(例如:getUsers.fixtures.js)。模拟请求的主要目的显然是测试两种可能的场景:成功和失败。别忘了定义方法和状态！</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="5f29" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们已经准备好开始编写我们的测试场景，我们将看看成功和失败的场景是否通过。目标是测试三件事:正确的响应数据、成功的获得和失败。让我们为测试设置初始配置。</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="0858" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在我们的测试配置中，我们开始将Axios配置定义为undefined，因为我们将使用带有默认配置的Axios。最重要的部分出现在第5行和第9行。要开始运行您的Moxios实例，您需要在每个测试中安装并在结束时卸载它，这样您的测试将能够使用mockStubs访问您的fixtures文件。另一件重要的事情是探查用户将被调用的方法类型。</p><figure class="kt ku kv kw gt jo"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="95b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在上面的例子中，您可以检查是否涵盖了三种可能的场景:响应数据、成功和失败。不要忘记将您的测试定义为异步的，并在调用模拟的fixture之后进行断言。什么是断言？</p><blockquote class="kz la lb"><p id="d486" class="jv jw lc jx b jy jz ka kb kc kd ke kf ld kh ki kj le kl km kn lf kp kq kr ks ig bi translated">Expect.assertions(number)验证在测试过程中调用了一定数量的断言。这在测试异步代码时非常有用，可以确保回调中的断言确实被调用了。</p></blockquote></div><div class="ab cl lg lh hr li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ig ih ii ij ik"><p id="36c5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Moxios将帮助您加快测试速度，并保证所有的覆盖率都得到满足，因为它是一个基于承诺的解决方案。</p><h2 id="63bb" class="ln lo in bd lp lq lr dn ls lt lu dp lv kg lw lx ly kk lz ma mb ko mc md me mf bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="2157" class="pw-post-body-paragraph jv jw in jx b jy mg ka kb kc mh ke kf kg mi ki kj kk mj km kn ko mk kq kr ks ig bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名在<a class="ae ml" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">【submissions@javascriptinplainenglish.com】</strong></a>给我们发电子邮件，我们会把你添加为作者。</p><p id="020a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还推出了三种新的出版物！请关注我们的新出版物:<a class="ae ml" href="https://medium.com/ai-in-plain-english" rel="noopener"> <strong class="jx io"> AI in Plain English </strong> </a>，<a class="ae ml" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="jx io">UX in Plain English</strong></a>，<a class="ae ml" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="jx io">Python in Plain English</strong></a><strong class="jx io"/>——谢谢，继续学习！</p></div></div>    
</body>
</html>