<html>
<head>
<title>Fitting a Web App in a single MTU</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在单个MTU中安装Web应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/fitting-a-webapp-in-a-single-mtu-4f5b8309f3e6?source=collection_archive---------0-----------------------#2019-08-22">https://javascript.plainenglish.io/fitting-a-webapp-in-a-single-mtu-4f5b8309f3e6?source=collection_archive---------0-----------------------#2019-08-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7e9d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可能听说过术语“MTU”又名。“最大传输单位”。这是一个网络术语，描述了一个信息包中可以容纳的最大字节数。该数据包将从您的计算机完整无缺地传送到收件人，而不会进一步分解成更小的部分(大多数情况下)。仅供参考，典型的MTU大小为1500字节。</p><p id="8809" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这意味着，如果我们设法将所有有用的信息都放在一个MTU中，我们将达到最大可能的传递速度。所以你认为，我们能在这么小的空间里放些有用的东西吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bdf0e7af58176c95ccf9e24e1b5ec632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*120phVUYePxwYkr5"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@halgatewood?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hal Gatewood</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="d237" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">提供有用的东西</h1><p id="57e4" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">首先，我们来定义一下“有用”。我想提高我们的标准。尽可能高。所以，我想传达:</p><ul class=""><li id="9489" class="mc md in jm b jn jo jr js jv me jz mf kd mg kh mh mi mj mk bi translated">一个网站</li><li id="9892" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">反应灵敏，适合我的手机或台式机屏幕</li><li id="6e6a" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">它有很好的背景、颜色和图形</li><li id="921c" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">这是动态的，做一些有用的事情</li><li id="19c3" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">让我们假设这个“有用”的东西是一个3标签的网络应用程序，带有秒表、计时器和时钟！</li></ul><h1 id="1004" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">我们到底能装多少？</h1><p id="5189" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">在我们继续之前，让我们先来计算一下我们的规模预算:</p><ul class=""><li id="f31d" class="mc md in jm b jn jo jr js jv me jz mf kd mg kh mh mi mj mk bi translated"><strong class="jm io"> 1500字节</strong>的MTU(网络上的原始非结构化数据)</li><li id="829b" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">IPv4报头减去20字节的<strong class="jm io"/></li><li id="1067" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">减去TCP报头的20字节的<strong class="jm io"/></li><li id="081c" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">对于一个简单的HTTP响应，减去大约91个字节</li><li id="f71c" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">我们的网站还剩<strong class="jm io"> 1369字节</strong>！</li></ul><p id="5e52" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我的计算是正确的，我们将在CSS样式中浪费大部分空间，所以让我们从这里开始。大师，放音乐…</p><h1 id="0301" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">做一些基本的造型</h1><p id="bf31" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">我梦想着一个如丝般平滑的渐变背景，以及一个漂浮在页面中间的白色面板。我认为天蓝色是一个好的开始。我打开我可信赖的<a class="ae ky" href="https://www.colorzilla.com/gradient-editor/" rel="noopener ugc nofollow" target="_blank">终极梯度发生器</a>并输入我的值。</p><p id="60b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">哦，我假设我们是在2020年的时代这样做的，所以不再有特定于浏览器的后缀，或旧技术！（🤣耶！浪费的字节更少！)</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="6d46" class="mv la in mr b gy mw mx l my mz">body, html {<br/>  background: #b2e1ff;<br/>  background: linear-gradient(to bottom,  #b2e1ff 0%,#66b6fc 100%);<br/>  height: 100%;<br/>  overflow: hidden;<br/>}</span></pre><p id="21c7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那一定很好看！但是没有一个内容是如此的空…让我们添加一个面板。我们肯定要用flexbox！哦，我们尽量少用班级名。对你来说是1个字节:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="2e42" class="mv la in mr b gy mw mx l my mz">.c {<br/>  display: flex;<br/>  justify-content: center;<br/>  align-items: center;<br/>  height: 100%;<br/>}</span><span id="0fad" class="mv la in mr b gy na mx l my mz">.b {<br/>  background: #fff;<br/>  border: solid 1px #999;<br/>  width: 70%;<br/>  padding: 20px;<br/>}</span></pre><p id="3805" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">到目前为止，我们做得很好，我们只有362字节深</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/a13ee0a6d419f1bbcdb86e389a7fd972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ya3zLXUmGsPqOALmrRAODQ.png"/></div></div></figure><p id="1c15" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">根据我出色的UI技能，我们在设计中将需要一些组件:</p><ul class=""><li id="5d85" class="mc md in jm b jn jo jr js jv me jz mf kd mg kh mh mi mj mk bi translated">标签按钮</li><li id="dc89" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">时钟的大文本</li><li id="95c8" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">一些媒体询问更小的屏幕分辨率</li></ul><p id="1b0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">几个CSS定义之后，我们得到了下面的结果。可以在下面的gist中查看完整的CSS:<a class="ae ky" href="https://gist.github.com/wavesoft/6e33858bab9149b9f1834a590f56c085#file-style-css" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/wavesoft/6e 33858 Bab 9149 B9 f 1834 a 590 f 56 c 085 # file-style-CSS</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/bd5539efbe85359f996b26df1cd11d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4HfegpxNCUX2SJgxcV0KdQ.png"/></div></div></figure><p id="037b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们把这个放在一边，让我们看一下它的功能。</p><h1 id="c400" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">实现我们的业务逻辑</h1><p id="e145" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">为了强调我的局限性，我将使用一个虚拟DOM库来呈现我们的动态应用程序。如果你不知道这是什么，看看React和<a class="ae ky" href="https://reactjs.org/docs/faq-internals.html" rel="noopener ugc nofollow" target="_blank">它的内部</a>。但是对于我来说，我将使用一个特殊的小库(字面上的意思)😉</p><p id="e82d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在过去的几年里，我一直在完善最小的、功能最全的虚拟DOM库，它能容纳512字节！女士们先生们，我向你们介绍<a class="ae ky" href="https://github.com/wavesoft/dot-dom" rel="noopener ugc nofollow" target="_blank">网络项目:</a><a class="ae ky" href="https://github.com/wavesoft/dot-dom" rel="noopener ugc nofollow" target="_blank">https://github.com/wavesoft/dot-dom</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="666e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">。dom </strong>是一个全功能的虚拟dom库，支持适当的协调、高阶组件、生命周期挂钩、键控更新等等！</p><p id="92ab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我打开了库的<a class="ae ky" href="https://github.com/wavesoft/dot-dom/blob/master/dist/dotdom.min.js" rel="noopener ugc nofollow" target="_blank">缩小版，并复制了一个我保存为<code class="fe nf ng nh mr b">app.js</code>的空白新文件。现在是时候开始写我们的逻辑了。</a></p><h1 id="66af" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">使用编写web应用程序。数字正射影像图</h1><p id="f3d4" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">我将从主要的应用程序组件开始:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="6b32" class="mv la in mr b gy mw mx l my mz">// Extract accelerators<br/><strong class="mr io">const</strong> { div } = H;</span><span id="6288" class="mv la in mr b gy na mx l my mz">// The main application component<br/><strong class="mr io">function</strong> App() {<br/>  <strong class="mr io">return</strong> div.c(<br/>    div.b("Some Content")<br/>  );<br/>}</span><span id="6e74" class="mv la in mr b gy na mx l my mz">// Render the app<br/>R(H(App), document.body);</span></pre><p id="3ba1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们为您分析一下…</p><h2 id="212e" class="mv la in bd lb ni nj dn lf nk nl dp lj jv nm nn ln jz no np lr kd nq nr lv ns bi translated">HTML标签加速器</h2><p id="be14" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">首先，我从<code class="fe nf ng nh mr b">H</code>函数中提取一些加速器。这个函数与其他虚拟DOM库中的<code class="fe nf ng nh mr b">createElement</code>相同，但是它也能够自动将自己绑定到一个名为被访问属性的标签上。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="8f32" class="mv la in mr b gy mw mx l my mz"><strong class="mr io">const</strong> { div } = H;</span></pre><p id="6f1a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，实际上，每次你调用<code class="fe nf ng nh mr b">div(...)</code>时，你都隐含地调用了<code class="fe nf ng nh mr b">H("div", ...)</code>。整洁，对不对？为什么？因为您现在可以以自然的方式编写一个完整的HTML页面，如下所示:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="f760" class="mv la in mr b gy mw mx l my mz"><strong class="mr io">return</strong> div(<br/>  div("Some Content")<br/>);</span></pre><p id="bab6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">自然，这就渲染到了<code class="fe nf ng nh mr b">&lt;div&gt;&lt;div&gt;Some Content&lt;/div&gt;&lt;/div&gt;</code>。但是现在造型呢？</p><h2 id="3279" class="mv la in bd lb ni nj dn lf nk nl dp lj jv nm nn ln jz no np lr kd nq nr lv ns bi translated">造型加速器</h2><p id="5e7a" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated"><strong class="jm io">。dom </strong> accelerator提供了另一个惊人的特性:如果你试图更深入地访问属性，而不是调用它们，它们会自动将相应的类名附加到类属性上。</p><p id="d95a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以，像以前一样，当你调用<code class="fe nf ng nh mr b">div.a(...)</code>时，你隐式地调用了<code class="fe nf ng nh mr b">H("div", {className: "a"}, ...)</code>。现在你知道这是干什么的了:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="5dc6" class="mv la in mr b gy mw mx l my mz"><strong class="mr io">return</strong> div.a(<br/>  div.b("Some Content")<br/>);</span></pre><p id="eaa3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">没错，这个渲染到<code class="fe nf ng nh mr b">&lt;div class="a"&gt;&lt;div class="b"&gt;Some Content&lt;/div&gt;&lt;/div&gt;</code>。太棒了。</p><h1 id="293a" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">组件，组件，组件！</h1><p id="1e8d" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated"><strong class="jm io">的另一个漂亮特征。dom </strong>和虚拟dom引擎的其余部分就是你可以多么容易地创建可重用的HTML组件。在我的例子中，我也遵循这个模式。</p><p id="94d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我将创建一个可重用的组件来呈现活动选项卡的标题和主体:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="94b4" class="mv la in mr b gy mw mx l my mz">const <strong class="mr io">Tabs</strong> = ({t}, {a=0}, setState) =&gt; {<br/>    const names = Object.keys(t);<br/>    return div.b(<br/>      // The tab header contains the tab buttons<br/>      div.t(<br/>        // Create a button for each tab<br/>        names.map((tabName,i) =&gt;<br/>          // Make sure to add the 'a' class on the active tab<br/>          div.n[a == i ? 'a' : '']({<br/>            onclick: () =&gt; setState({a:i})<br/>          },<br/>          tabName)<br/>        )<br/>      ),<br/>      // Render the active tab component<br/>      H(t[names[a]])<br/>    );<br/>  }</span></pre><p id="acee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个tabs组件是我们应用程序的主路由器，所以我们现在可以将我们的主类改为:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="6026" class="mv la in mr b gy mw mx l my mz">const <strong class="mr io">App</strong> = (props, state, setState) =&gt; {<br/>  return div.c(<br/>    H(Tabs, {t: {<br/>      Clock: ClockTab,<br/>      Stopwatch: StopwatchTab,<br/>      "1h Timer": TimerTab<br/>    }})<br/>  );<br/>}</span></pre><h2 id="4232" class="mv la in bd lb ni nj dn lf nk nl dp lj jv nm nn ln jz no np lr kd nq nr lv ns bi translated">高阶组件</h2><p id="27e4" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在，像任何其他虚拟DOM库一样，我们需要一个触发器来呈现属性更新。由于我们所有的组件都是基于时钟节拍的，因此创建一个更高阶的组件来以固定的时间间隔重新呈现组件可能是一个好主意:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="2563" class="mv la in mr b gy mw mx l my mz">const <strong class="mr io">WithInterval</strong> = (Component) =&gt; {<br/>  <strong class="mr io">return</strong> (props, state, setState, hooks) =&gt; {</span><span id="a65d" class="mv la in mr b gy na mx l my mz">    // Register a hook that starts a timer when the component <br/>    // is mounted<br/>    hooks.m.<strong class="mr io">push</strong>(() =&gt; {<br/>      // The `state` object can also be used for local storage`<br/>      state.t = setInterval(<br/>        () =&gt; {<br/>          // Update the component, by updating the 'i' variable with<br/>          // the number of milliseconds passed since mount<br/>          setState({i: (state.i || 0) + 60})<br/>        },<br/>        60<br/>      )<br/>    });</span><span id="6ce4" class="mv la in mr b gy na mx l my mz">    // Register a hook that resets the timer when unmounted<br/>    hooks.u.<strong class="mr io">push</strong>(() =&gt; {<br/>      clearInterval(state.t);<br/>    });</span><span id="3427" class="mv la in mr b gy na mx l my mz">    // Call-out to the higher-order component, and share our<br/>    // state with it. Alternatively we could have used the H<br/>    // function and pass the state as property, like so:<br/>    //<br/>    // H(Component, { i: state.i })<br/>    //<br/>    <strong class="mr io">return</strong> Component(props, state, setState, hooks);<br/>  }<br/>}</span></pre><p id="96e6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们可以将我们的主要功能改为:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="4960" class="mv la in mr b gy mw mx l my mz">const <strong class="mr io">App</strong> = (props, state, setState) =&gt; {<br/>  <strong class="mr io">return</strong> div.c(<br/>    H(Tabs, {t: {<br/>      Clock: <strong class="mr io">WithInterval</strong>(ClockTab),<br/>      Stopwatch: <strong class="mr io">WithInterval</strong>(StopwatchTab),<br/>      "1h Timer": <strong class="mr io">WithInterval</strong>(TimerTab)<br/>    }})<br/>  );<br/>}</span></pre><p id="6a1f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我们可以再花几分钟，为我们的时钟、秒表和计时器编写实现。我不会用这些细节来烦你，但是你可以<a class="ae ky" href="https://gist.github.com/wavesoft/6e33858bab9149b9f1834a590f56c085#file-app-js" rel="noopener ugc nofollow" target="_blank">检查最终结果的要点</a>😉</p><h1 id="c296" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">把它们放在一起</h1><p id="745a" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">相反，我让你快进到最后一点。压缩！(记住我们的规模预算。我们需要在1369字节中适应这个项目)</p><p id="11da" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">到目前为止，我们已经创建了2个文件。包含样式和应用程序的<code class="fe nf ng nh mr b">style.css</code>和<code class="fe nf ng nh mr b">app.js</code>。(我作弊了，还创建了一个<code class="fe nf ng nh mr b">index.html</code>来为你呈现截图，但这是我们之间的秘密)</p><p id="e689" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于我们的“生产”页面，我们必须保持简洁。这意味着我们必须将所有内容嵌入到一个页面中。我们还知道HTML隐式地关闭了开放标签，所以我们可以通过不关闭<code class="fe nf ng nh mr b">&lt;body&gt;</code>和<code class="fe nf ng nh mr b">&lt;html&gt;</code>标签来节省更多的字节。</p><p id="4b0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但是让我们首先缩小我们的javascript:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="41f2" class="mv la in mr b gy mw mx l my mz">npm install <!-- -->uglify-es -g<br/>uglifyjs &lt;page.js &gt;page.min.js</span></pre><p id="a3a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的CSS:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="8715" class="mv la in mr b gy mw mx l my mz">npm install uglifycss -g<br/>uglifycss &lt;style.css &gt;style.min.css</span></pre><p id="1907" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们可以一段一段地编写我们的页面了:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="27fc" class="mv la in mr b gy mw mx l my mz">echo '&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Clocks&lt;/title&gt;&lt;style&gt;' &gt; page.html<br/>cat style.min.css &gt;&gt; page.html<br/>echo '&lt;/style&gt;&lt;body&gt;&lt;script&gt;' &gt;&gt; page.html<br/>cat app.min.js &gt;&gt; page.html<br/>echo '&lt;/script&gt;' &gt;&gt; page.html</span></pre><p id="847b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们做<code class="fe nf ng nh mr b">ls</code>并对结果感到极度失望之前，让我们先<code class="fe nf ng nh mr b">gzip</code>一下我们的页面</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="1bdf" class="mv la in mr b gy mw mx l my mz">gzip -9 page.html</span></pre><p id="5c45" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们可以用最终的结果敲敲自己的后背，因为我们还有108字节的空间💪</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="4c16" class="mv la in mr b gy mw mx l my mz"><strong class="mr io">~$</strong> ls -l page.html.gz<br/>-rw-r--r--  1 user  staff  <strong class="mr io">1261</strong> Aug 22 23:26 page.html.gz</span></pre><p id="5756" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们唯一要做的事情，就是用下面的HTTP响应来服务它(需要91个字节):</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="0e7e" class="mv la in mr b gy mw mx l my mz">HTTP/1.1 200 OK<br/>Content-Type: text/html<br/>Content-Encoding: gzip<br/>Content-Length: 1270<br/></span></pre><p id="53f1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们准备好享受结果了</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/c248ac9e0eed0f5d5251ec56673bf2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhT3WhHt3zla2cbfjLh4jQ.png"/></div></div></figure><p id="3eb8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">女士们先生们，这就是你如何创建一个适合MTU的web应用程序！🎩</p><p id="32a5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这一个特别简单，但是我打赌你已经为你的情况想到了更复杂的东西。是的，它会非常小！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu ne l"/></div></figure><h1 id="5c9b" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">让事情变得更小</h1><p id="1b8e" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">假设我们对目前的规模不满意，我们想更进一步。你能做什么？</p><p id="697d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以下是给你的一些建议:</p><ul class=""><li id="23e2" class="mc md in jm b jn jo jr js jv me jz mf kd mg kh mh mi mj mk bi translated">减少缩小后仍存在的变量的名称</li><li id="c5e8" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">将公共代码移动到单独的函数中</li><li id="1281" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">将函数声明为ES6 lambda函数</li><li id="161b" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">尽可能多地重复你自己</li></ul><p id="077a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我知道最后一点和第二点有点矛盾，但是这对GZip压缩很有帮助。</p><h2 id="9984" class="mv la in bd lb ni nj dn lf nk nl dp lj jv nm nn ln jz no np lr kd nq nr lv ns bi translated">帮助GZip</h2><p id="9bf6" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">不涉及太多的技术细节，压缩算法通过删除重复的部分使东西变得更小。句号。</p><p id="cb84" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一个算法的好坏，很大程度上取决于它对哪些部分要组合的启发。</p><p id="b70d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">GZip也不例外。如果你帮助它，它就帮助你。怎么会？简单地重复你的逻辑。</p><p id="91ca" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">请看下图，由<a class="ae ky" href="https://encode.su/threads/1889-gzthermal-pseudo-thermal-view-of-Gzip-Deflate-compression-efficiency" rel="noopener ugc nofollow" target="_blank">广州热电</a>出品。它很好地显示了每个片段被压缩的程度。红色代表不好，蓝色代表好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/57687db1ea276e4af4b06b96a158b97f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BajJsXA3RCc9BJ2YIkhPZg.png"/></div></div></figure><p id="c1c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如你所看到的，你重复一个字符或者一个模式越多，它被压缩得越好。那么我们如何利用这一点呢？这里还有一些提示:</p><ul class=""><li id="bbb6" class="mc md in jm b jn jo jr js jv me jz mf kd mg kh mh mi mj mk bi translated">坚持使用特定的数组迭代函数，即使它不适合你的情况(比如坚持使用<code class="fe nf ng nh mr b">array.map()</code>)</li><li id="1ccc" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">如果你在重复一些代码(例如，获取一个变量的默认值，或者共享一些公共的CSS定义)，将尽可能多的代码分块在一起，这样GZip将会两次找到相同的字节块。</li><li id="7186" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">避免使用大写字母作为变量/函数/键名。不要惊讶，记住你的代码的其余部分是小写的。</li><li id="39f2" class="mc md in jm b jn ml jr mm jv mn jz mo kd mp kh mh mi mj mk bi translated">避免在代码中混合模式。例如，不要同时使用javascript怪癖来改变变量的类型(例如<code class="fe nf ng nh mr b">''+number</code>)和冗长函数(例如<code class="fe nf ng nh mr b">number.toString()</code>)。</li></ul><p id="dd03" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有了这些小技巧，在gzthermal的帮助下，我成功挤到了<a class="ae ky" href="https://github.com/wavesoft/dot-dom" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">。dom </strong>👏</a></p></div></div>    
</body>
</html>