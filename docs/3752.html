<html>
<head>
<title>What Happened to Image Sprites and Concatenated Assets?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像精灵和级联资产发生了什么变化？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-the-heck-happened-to-image-sprites-and-concatenated-assets-794d8633279d?source=collection_archive---------5-----------------------#2020-10-22">https://javascript.plainenglish.io/what-the-heck-happened-to-image-sprites-and-concatenated-assets-794d8633279d?source=collection_archive---------5-----------------------#2020-10-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="453d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">前端性能优化</h2><div class=""/><div class=""><h2 id="acd7" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">一些最佳实践现在已经不是最好的了——现在是2020年。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5347d13cc0e65dec59e723c98a574f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mrymy_h_8NdLvSx2rzxN7A.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@rossf?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ross Findon</a> on <a class="ae le" href="https://unsplash.com/s/photos/change?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ba2c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">今天早上，我被拖进了一个倒退的星期四。我在StyleMePretty开始了我的职业生涯，当时我是一名全栈开发人员，StyleMePretty是一个婚礼和生活方式博客，2015年由AOL所有。是的，你没听错，美国在线还活着。我以前从未有过真正的web开发经验，我在工作中必须做的第一件事就是使用“图像精灵”对大量图片的网站进行优化。</p><p id="db79" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果你以前没有听说过它们，图像精灵是一种优化技术，用于减少对服务器的请求数量和减少带宽。你基本上是通过使用图像精灵工具将几个小图像拼接在一起来创建图像的。一个CSS表单，在X轴和Y轴上显示图像精灵上较小图像的坐标，可以帮助您在网站上显示原始图像。</p><p id="d52d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">另一种类似的技术是资产串联——将较小的JS和CSS文件合并在一起。从某种意义上来说，图像精灵和连接的资源服务于相同的目的。它们都通过捆绑在一起减少了来自浏览器的小网络请求的数量。</p><p id="cc69" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">图像精灵和链接资产(JS或CSS)有一个很大的缺点。如果一个图标发生变化，整个sprite表都会发生变化，因此客户端必须使其缓存无效。JS、CSS或其他资产也是如此。在大多数情况下，避免所有额外的握手和其他TCP开销带来的性能收益超过了这些缺点。</p><blockquote class="mc"><p id="ee61" class="md me iq bd mf mg mh mi mj mk ml ma dk translated">减少页面组件的数量是“性能黄金法则”。</p></blockquote><p id="11ba" class="pw-post-body-paragraph lf lg iq lh b li mm ka lk ll mn kd ln lo mo lq lr ls mp lu lv lw mq ly lz ma ij bi translated">我最喜欢的一本关于web应用优化的书斯托扬·斯特凡诺夫的《T2速度之书》引用了这句话。它当然是在HTTP/1时代写的。如今，与减少请求数量恰恰相反的做法受到了鼓励。像Webpack这样的模块捆绑工具可以让你进行代码分割，图像精灵甚至已经不存在了(它们可能仍然有用，但并不普遍),资产连接听起来像个笑话。</p><h1 id="2808" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">什么变了？</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/b96cb731aa35abdb5777288eb9e5ffbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/1*7Gpxoeszqdc4YI8k6gnZ-g.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">The Internet Protocol Suite (Source: W3.org)</figcaption></figure><p id="e0db" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">互联网从未像现在这样充满活力。就在过去的5年里，互联网协议套件的应用层经历了重大变化。统治互联网20多年的HTTP/1在2015年被HTTP/2取代，目前约有98%的浏览器支持它。截至2020年10月，HTTP/3草案经历了多次修订。这意味着我们也必须快速适应新的优化。</p><p id="0641" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">HTTP/1和HTTP/2之间的区别是一个广为人知的话题，这里的<a class="ae le" href="https://www.digitalocean.com/community/tutorials/http-1-1-vs-http-2-what-s-the-difference" rel="noopener ugc nofollow" target="_blank"/>是一个有趣的读物。我们感兴趣的HTTP/2的关键特性有<strong class="lh ja"> <em class="mb">复用</em> </strong>和<strong class="lh ja"> <em class="mb">服务器推送</em> </strong>。多路复用允许客户端通过单个TCP连接发送多个请求，而无需等待响应。服务器推送则更进一步，它允许服务器甚至在客户机请求资源之前就发送资源。客户端可以拒绝推送的资源。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nk"><img src="../Images/bbe6213ca976109e95d395c3dabdeb8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7h8c7XRW7sB3gmKFfTD1jA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Request/Response mechanisms in HTTP/1 vs HTTP/2 (Source: <a class="ae le" href="https://blog.scottlogic.com/2014/11/07/http-2-a-quick-look.html" rel="noopener ugc nofollow" target="_blank">Scott Logic Blog</a>)</figcaption></figure><p id="a86c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如上面的时序图所示，HTTP/2多路复用允许web应用程序通过一个TCP连接向服务器发送多个请求，并以任意顺序接收响应。这改变了一切。如果您查看任何支持HTTP/2的web应用程序的network选项卡，您将不再看到熟悉的请求瀑布。资源是并行下载的。</p><div class="kp kq kr ks gt ab cb"><figure class="nl kt nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/d43d5d67b557176833f2eadbe11bc9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*SpeAg2zWq94p8ZcIi0SIGw.png"/></div></figure><figure class="nl kt nr nn no np nq paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/f1122c270d26219306b7f6f96baebc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*e6GlJ6DSLRjZlGzBZ-xRBg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk ns di nt nu">HTTP/1 waterfall vs HTTP/2 parallel network requests (Source: <a class="ae le" href="https://spinupwp.com/performance-best-practices-http2/" rel="noopener ugc nofollow" target="_blank">SpinupWP</a>)</figcaption></figure></div><p id="c0b5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">右边的图片解释了为什么现在推荐把你的代码分割成更小的块。一个大文件，而不是多个小文件，会减慢你第一次有意义的绘画的时间，并对其他重要指标产生负面影响。使用<strong class="lh ja"> <em class="mb">渐进式加载</em> </strong>等设计模式可以优化用户体验和应用性能，只需在最初加载页面最关键的部分，然后在用户导航或与页面交互时请求额外的资源。</p><blockquote class="mc"><p id="befb" class="md me iq bd mf mg mh mi mj mk ml ma dk translated">速度是一个特点。确实是非常重要的一个。</p></blockquote><p id="1221" class="pw-post-body-paragraph lf lg iq lh b li mm ka lk ll mn kd ln lo mo lq lr ls mp lu lv lw mq ly lz ma ij bi translated">HTTP/3即将问世，它比HTTP/2有几处增强。它基于谷歌开发的全新传输层协议QUIC。一旦HTTP/3被广泛采用，很难预测我们今天利用的优化是否仍然有效。老实说，这是我作为开发人员最喜欢的部分。永远不要停止学习，因为互联网永远不会停止教学。</p></div></div>    
</body>
</html>