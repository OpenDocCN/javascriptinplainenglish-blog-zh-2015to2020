<html>
<head>
<title>5 Vanilla JavaScript Tips I Learned from Vue Source Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我从Vue源代码中学到的5个普通JavaScript技巧</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/learn-javascript-from-vue-source-code-d9d8516ea9c4?source=collection_archive---------3-----------------------#2020-09-13">https://javascript.plainenglish.io/learn-javascript-from-vue-source-code-d9d8516ea9c4?source=collection_archive---------3-----------------------#2020-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="8782" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">从源代码中学习</h2><div class=""/><div class=""><h2 id="df0c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">阅读这篇文章不需要Vue的背景知识</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3fb49d9db0e75f9653c9abdda3345e28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IvPCuVrfMKehVASf.jpg"/></div></div></figure><p id="2b0d" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">学习编程语言的一个非常有效的方法是阅读用该编程语言开发的著名开源项目的源代码。Vuejs是最好的JavaScript开源项目之一。在阅读Vue 2.x源代码的时候，我了解了很多关于JavaScript的用法，所以我写了这篇文章。</p><p id="94a2" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">应该指出的是:</p><ul class=""><li id="891e" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">本文主要是总结vanilla JavaScript的使用，并不涉及Vue的运行机制</li><li id="cae9" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">阅读这篇文章不需要Vue的背景知识。</li><li id="276a" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">许多关于Vue源代码的技巧都是基于上下文的。但是<strong class="lc ja">我把它简化了一点，让读者更容易理解</strong>。因此，您将在本文中看到的用法与实际的Vue源代码略有不同。</li></ul><p id="4536" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果您对Vue源代码感兴趣，可以通过以下链接找到它:</p><div class="mk ml gp gr mm mn"><a href="https://github.com/vuejs/vue" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ja gy z fp ms fr fs mt fu fw iz bi translated">vuejs/vue</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">Vue.js是一个麻省理工学院许可的开源项目，其正在进行的开发完全是在…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">github.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ky mn"/></div></div></a></div><h1 id="726b" class="nc nd iq bd ne nf ng nh ni nj nk nl nm kf nn kg no ki np kj nq kl nr km ns nt bi translated">浏览器环境嗅探</h1><blockquote class="nu nv nw"><p id="efa5" class="la lb nx lc b ld le ka lf lg lh kd li ny lk ll lm nz lo lp lq oa ls lt lu lv ij bi translated">vue/src/核心/实用程序/环境. js</p></blockquote><p id="81f7" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">我们知道JavaScript可以在浏览器、节点、weex等中运行。，那么我们如何检查当前的JavaScript代码是否运行在浏览器环境中呢？</p><p id="2dfe" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果JavaScript运行在浏览器环境中，那么必须有一个全局对象:<code class="fe ob oc od oe b">window</code>。所以我们可以这样判断环境:</p><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="f27d" class="oj nd iq oe b gy ok ol l om on">const inBrowser = typeof window !== 'undefined'</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/5c00a5a9f3669fa88f28d28e5ce9bc4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsZSOUHGz1qd3CvK1eREPw.png"/></div></div><figcaption class="op oq gj gh gi or os bd b be z dk">Execute in Chrome</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/fb6662a8eb838efd7a757ff2232474b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PPUAzQTR-dODCUL8zsVIhw.png"/></div></div><figcaption class="op oq gj gh gi or os bd b be z dk">Execute in node</figcaption></figure><p id="5842" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果脚本运行在浏览器环境中，那么我们可以这样得到浏览器的<code class="fe ob oc od oe b"><a class="ae ou" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent" rel="noopener ugc nofollow" target="_blank">userAgent</a></code>:</p><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="78d0" class="oj nd iq oe b gy ok ol l om on">const UA = inBrowser &amp;&amp; window.navigator.userAgent.toLowerCase()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/7e2bdf91356eb53511a7e9ca2da91dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KxyNsvrh1MrFoVjQj1A0AA.png"/></div></div><figcaption class="op oq gj gh gi or os bd b be z dk">Execute in Chrome on masOS</figcaption></figure><p id="5cab" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">不同的浏览器有不同的用户代理。在Internet Explorer的用户代理中，总是包含有<code class="fe ob oc od oe b">MSIE</code>和<code class="fe ob oc od oe b">Trident</code>这两个词。在Chrome浏览器的userAgent中，总会包含<code class="fe ob oc od oe b">Chrome</code>这个词。</p><p id="2c18" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">同样，在Android操作系统浏览器中，userAgent总是包含<code class="fe ob oc od oe b">Androi</code> d字样，在iOS中，总有<code class="fe ob oc od oe b">iPhone</code>、<code class="fe ob oc od oe b">iPad</code>、<code class="fe ob oc od oe b">iPod</code>、<code class="fe ob oc od oe b">iOS</code>字样中的一个。</p><p id="017c" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">所以我们可以通过检查userAgent来确定当前的浏览器厂商和操作系统。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ow"><img src="../Images/e9fe8173ef16d34365c1f9427ca397c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4MH7T4BW-Z8sdpdKKmJlw.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="9263" class="oj nd iq oe b gy ok ol l om on">const UA = inBrowser &amp;&amp; window.navigator.userAgent.toLowerCase()<br/>const isIE = UA &amp;&amp; /msie|trident/.test(UA)<br/>const isIE9 = UA &amp;&amp; UA.indexOf('msie 9.0') &gt; 0<br/>const isEdge = UA &amp;&amp; UA.indexOf('edge/') &gt; 0<br/>const isAndroid = (UA &amp;&amp; UA.indexOf('android') &gt; 0) <br/>const isIOS = (UA &amp;&amp; /iphone|ipad|ipod|ios/.test(UA))<br/>const isChrome = UA &amp;&amp; /chrome\/\d+/.test(UA) &amp;&amp; !isEdge<br/>const isPhantomJS = UA &amp;&amp; /phantomjs/.test(UA)<br/>const isFF = UA &amp;&amp; UA.match(/firefox\/(\d+)/)</span></pre><p id="b9c2" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">顺便提一下，Edge和Chrome都是基于Chrome的，所以两种浏览器的userAgent都包含了单词<code class="fe ob oc od oe b">Chrome</code>。即当浏览器的userAgent包含<code class="fe ob oc od oe b">Chrome</code>字样时，浏览器不一定是Chrome。所以我们需要编写像<code class="fe ob oc od oe b">const isChrome = UA &amp;&amp; /chrome\/\d+/.test(UA) &amp;&amp; !isEdge</code>这样的代码，以确保当前的浏览器是Chrome。</p><h1 id="bada" class="nc nd iq bd ne nf ng nh ni nj nk nl nm kf nn kg no ki np kj nq kl nr km ns nt bi translated">获取HTML格式字符串中的非标记字符</h1><blockquote class="nu nv nw"><p id="9df9" class="la lb nx lc b ld le ka lf lg lh kd li ny lk ll lm nz lo lp lq oa ls lt lu lv ij bi translated">vue/src/编译器/解析器/实体解码器. js</p></blockquote><p id="1d5c" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">例如，我们有一些类似这样的HTML字符串:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ox"><img src="../Images/79b297f343d6ba50523c08764369bb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiYk_nWBQUOIKERVvNlM4g.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="30b0" class="oj nd iq oe b gy ok ol l om on">var html1 = '&lt;span class="red"&gt;hello world&lt;/span&gt; &lt;span&gt;hello friend&lt;/span&gt;'</span><span id="ea2d" class="oj nd iq oe b gy oy ol l om on">var html2 = <br/>`&lt;ul&gt;<br/>  &lt;li&gt;Hello Medium!&lt;/li&gt;<br/>  &lt;li&gt;Hello Friends!&lt;/li&gt;<br/>  &lt;li&gt;Lorem, ipsum dolor.&lt;/li&gt;<br/>&lt;/ul&gt;`</span></pre><p id="f484" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">我们希望提取这些字符串中未标记的内容，并得到以下结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oz"><img src="../Images/cdd0e02d10418b75dbe63bc9afff05fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XLJao8MxtXU5504Pavd_kw.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="143c" class="oj nd iq oe b gy ok ol l om on">'hello world hello friend'</span><span id="99db" class="oj nd iq oe b gy oy ol l om on">`  Hello Medium!<br/>  Hello Friends!<br/>  Lorem, ipsum dolor.`</span></pre><p id="136a" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你有这个需求，你会怎么做？</p><p id="5fcc" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">我们可能想到的第一件事是使用正则表达式来解析字符串。当然，使用正则表达式在理论上是可行的，但是相关的正则表达式可能很麻烦并且容易出错。</p><p id="1563" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">那么有没有更好的思考方式呢？</p><p id="a40d" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">以下是聪明的Vue开发者对它的看法:</p><ul class=""><li id="8d4d" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">由于字符串是HTML格式的，我们可以将相应的字符串解析成HTML元素</li><li id="5a66" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">HTML元素的<code class="fe ob oc od oe b">textContent</code>属性用于获取该元素中的文本内容。</li></ul><p id="1af7" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">具体来说，这是代码:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pa"><img src="../Images/32366c85eb665d2b1a31f8c24019bd9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ec37v_KTaTszPQYygC_njw.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="0888" class="oj nd iq oe b gy ok ol l om on">function decoder(html){<br/>  let decoder = document.createElement('div')<br/>  decoder.innerHTML = html<br/>  console.log(decoder.textContent)<br/>  // return decoder.textContent<br/>}</span></pre><p id="4acc" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这段代码首先创建一个DIV元素作为容器，然后通过设置<code class="fe ob oc od oe b">innerHTML</code>将字符串转换成HTML元素。最后，通过<code class="fe ob oc od oe b">textContent</code>属性获得元素的文本内容。</p><p id="13ce" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">然后我们来测试一下。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/2203f5adc566c44396aa982baaffc2e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Zy8Eq7r7SOxBHLlZIgP2Q.png"/></div></div></figure><h1 id="6e36" class="nc nd iq bd ne nf ng nh ni nj nk nl nm kf nn kg no ki np kj nq kl nr km ns nt bi translated">普通物体</h1><blockquote class="nu nv nw"><p id="d28c" class="la lb nx lc b ld le ka lf lg lh kd li ny lk ll lm nz lo lp lq oa ls lt lu lv ij bi translated">vue/src/shared/util.js</p></blockquote><p id="6400" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><code class="fe ob oc od oe b">Object.prototype.toString</code>允许你将一个对象转换成一个字符串。对于普通对象，调用该方法时，总是返回<code class="fe ob oc od oe b">[object Object]</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/78069e29dd5eb35463087c145c1351d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-16GosApRJqeoyRBGyqMw.png"/></div></div></figure><p id="8d57" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">对于这类物体，我们可以称之为普通物体。</p><p id="f294" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">JavaScript中还有一些特殊的对象，比如Array、String和RegExp，它们在JavaScript引擎中有特殊的设计。所以当他们调用这个方法时，会返回不同的结果。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/0ec4d0c991ebe96da8aabbe878c58f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HjS5aOTz4JaY4S8QAQ5Wcg.png"/></div></div></figure><p id="0921" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">为了将这些特别设计的对象与那些普通对象区分开来，我们可以编写一个这样的函数:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/b4b38565b8858ba0cd0f7a3b90074740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uXEuVGWn0pylxIuFURMbKA.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="788b" class="oj nd iq oe b gy ok ol l om on">function isPlainObject (obj){<br/>  return Object.prototype.toString.call(obj) === '[object Object]'<br/>}</span></pre><h1 id="6381" class="nc nd iq bd ne nf ng nh ni nj nk nl nm kf nn kg no ki np kj nq kl nr km ns nt bi translated">字符串值</h1><blockquote class="nu nv nw"><p id="5f2f" class="la lb nx lc b ld le ka lf lg lh kd li ny lk ll lm nz lo lp lq oa ls lt lu lv ij bi translated">vue/src/shared/util.js</p></blockquote><p id="4720" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">将值转换为字符串是非常常见的需求。在JavaScript中，我们有两个将值转换为字符串的函数:</p><ul class=""><li id="ea27" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">字符串()</li><li id="5050" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">JSON.stringify()</li></ul><p id="4b6f" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这两种功能有不同的机制:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/cf74d4156ea4ab6c43d3126360e08ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pnLMdc_emnkJK-DVvYD1ew.png"/></div></div></figure><p id="e5fb" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如您所见，尝试将值转换为字符串有完全不同的机制。那么我们该如何选择呢？</p><ul class=""><li id="95a8" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">当我们想把<code class="fe ob oc od oe b">null</code>和<code class="fe ob oc od oe b">undefined</code>转换成一个字符串的时候，往往希望它返回一个空字符串。</li><li id="29a5" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">当我们把一个数组和一个普通的对象变成一个字符串的时候，我们经常要用到<code class="fe ob oc od oe b">JSON.stringify</code>。</li><li id="65d5" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">如果对象的<code class="fe ob oc od oe b">toString</code>方法被覆盖，那么我们希望使用<code class="fe ob oc od oe b">String()</code>。</li><li id="775b" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">在其他情况下，<code class="fe ob oc od oe b">String()</code>用于将值转换为字符串。</li></ul><p id="67f2" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">为了满足上述要求，它用Vue写成如下:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/999b84a482783e92988a8f65e847d14a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5c56uKUnaldzoAXD8GnoMg.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="ca78" class="oj nd iq oe b gy ok ol l om on">function isPlainObject (obj){<br/>  return Object.prototype.toString.call(obj) === '[object Object]'<br/>}</span><span id="7066" class="oj nd iq oe b gy oy ol l om on">function toString (val) {<br/>  if(val === null || val === undefined) return ''</span><span id="4700" class="oj nd iq oe b gy oy ol l om on">if (Array.isArray(val)) return JSON.stringify(val)</span><span id="0092" class="oj nd iq oe b gy oy ol l om on">if (isPlainObject(val) &amp;&amp; val.toString === Object.prototype.toString)<br/>    return JSON.stringify(val)</span><span id="3db3" class="oj nd iq oe b gy oy ol l om on">// other cases<br/>  return String(val)<br/>}</span></pre><h1 id="7a46" class="nc nd iq bd ne nf ng nh ni nj nk nl nm kf nn kg no ki np kj nq kl nr km ns nt bi translated">一次</h1><blockquote class="nu nv nw"><p id="bf81" class="la lb nx lc b ld le ka lf lg lh kd li ny lk ll lm nz lo lp lq oa ls lt lu lv ij bi translated">vue/src/shared/util.js</p></blockquote><p id="1bb5" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">很多时候，我们希望一个函数只执行一次。如果多次调用该函数，则只执行第一次。</p><p id="4ef6" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">所以我们可以写一个像这样的函数:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ph"><img src="../Images/7d345deb20e711864c8a9537e309872d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lb-BC9plf3qEjBriCKubhA.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="ce5b" class="oj nd iq oe b gy ok ol l om on">function once (fn) {<br/>  let called = false<br/>  return function () {<br/>    if (!called) {<br/>      called = true<br/>      fn.apply(this, arguments)<br/>    }<br/>  }<br/>}</span></pre><p id="b519" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">那我们来测试一下这个功能。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pi"><img src="../Images/11ba287f9b2d54d353ed8da25b741582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUMVj_oU7vLHdGDP7K6Amg.png"/></div></div></figure><pre class="kp kq kr ks gt of oe og oh aw oi bi"><span id="1371" class="oj nd iq oe b gy ok ol l om on">function launchRocket(){<br/>  console.log('The rocket has been launched.')<br/>}</span><span id="4abf" class="oj nd iq oe b gy oy ol l om on">const launchRocketOnce = once(launchRocket)</span><span id="a5ff" class="oj nd iq oe b gy oy ol l om on">launchRocketOnce()<br/>launchRocketOnce()<br/>launchRocketOnce()</span></pre></div><div class="ab cl pj pk hu pl" role="separator"><span class="pm bw bk pn po pp"/><span class="pm bw bk pn po pp"/><span class="pm bw bk pn po"/></div><div class="ij ik il im in"><h1 id="6783" class="nc nd iq bd ne nf pq nh ni nj pr nl nm kf ps kg no ki pt kj nq kl pu km ns nt bi translated">类似文章</h1><div class="mk ml gp gr mm mn"><a href="https://levelup.gitconnected.com/5-javascript-tips-i-learned-from-vue-source-code-6095df4e9bc1" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ja gy z fp ms fr fs mt fu fw iz bi translated">我从Vue源代码中学到的5个JavaScript技巧</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">从流行的JS框架的源代码中学习JavaScript。</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mw l"><div class="pv l my mz na mw nb ky mn"/></div></div></a></div></div></div>    
</body>
</html>