<html>
<head>
<title>New Features In ES2020 You Should Check</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您应该检查ES2020中的新功能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/new-features-in-es2020-you-should-check-b4974d9d7edc?source=collection_archive---------0-----------------------#2020-01-05">https://javascript.plainenglish.io/new-features-in-es2020-you-should-check-b4974d9d7edc?source=collection_archive---------0-----------------------#2020-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="ef04" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">Java Script语言</h2><div class=""/><div class=""><h2 id="2bc1" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">ES2020有哪些新功能？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/10f86050800da7664f51840d8f28126b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8QsfiyvTid36rFiZ"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@patrikward?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Patrick Ward</a> on <a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="de8c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">大家新年快乐！随着新的一年，新的ECMAScript版本已经发布！对于我这样热爱ECMAScript的人来说，这是个好消息。在之前的ECMAScript版本中，添加了许多有趣且有用的功能。这次等待我们的是什么？简而言之，让我们来看看吧！</p><h1 id="f1c0" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">动态导入</h1><p id="e09d" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">现在，您可以动态导入文件。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="480e" class="nd mc iq mz b gy ne nf l ng nh">import { max } from '../math.js';</span><span id="3924" class="nd mc iq mz b gy ni nf l ng nh">const nums = [1, 2, 3];<br/>max(...nums); // 3</span></pre><p id="27f1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是我们导入文件的方式。JavaScript引擎读取文件中的模块，并将它们放入调用这些模块的文件中。但是现在，你可以这样做。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="3b3d" class="nd mc iq mz b gy ne nf l ng nh">const numbs = [1, 2, 3];</span><span id="e2d2" class="nd mc iq mz b gy ni nf l ng nh">if (numbs.length) {<br/>  const math = '../math';<br/>  import(math)<br/>    .then(module =&gt; {<br/>      module.max(...numbs);<br/>    })<br/>}</span></pre><p id="7dca" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">动态导入返回一个承诺。也就是说你也可以这样写。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="27fb" class="nd mc iq mz b gy ne nf l ng nh">const math = '../math.js';<br/>const module = await import(math);<br/>module.max(...numbs);</span></pre><p id="f4b5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这个特性之所以好，是因为您可以在常规JavaScript代码中使用动态导入，就像上面的例子一样。</p><p id="6cda" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是浏览器对动态导入的支持。</p><ul class=""><li id="ec3d" class="nj nk iq lh b li lj ll lm lo nl ls nm lw nn ma no np nq nr bi translated">铬合金:63</li><li id="2a39" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">边缘:不支持</li><li id="2096" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">火狐浏览器:67</li><li id="12b5" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">IE:不支持</li><li id="4e26" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">歌剧:50</li><li id="2451" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">Safari: 11.1</li></ul><h1 id="4536" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">BigInt</h1><p id="e26d" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">当你不得不将两个大到足以导致溢出的数字相加时，你不痛苦吗？</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="f49b" class="nd mc iq mz b gy ne nf l ng nh">Number.MAX_VALUE * 2 // Infinity</span></pre><p id="5b8c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这种情况下，BigInt是一个救世主。</p><p id="3137" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您可以通过调用带括号的<code class="fe nx ny nz mz b">BigInt()</code>或带数字结尾的‘n’的<code class="fe nx ny nz mz b">2n</code>来创建BigInt。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="2e88" class="nd mc iq mz b gy ne nf l ng nh">const num = 2;<br/>const bigNum = BigInt(num);</span><span id="4c1b" class="nd mc iq mz b gy ni nf l ng nh">bigNum; // 2n<br/>bigNum === 2n; // true</span></pre><p id="13f6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">也可以加减乘除。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="abcb" class="nd mc iq mz b gy ne nf l ng nh">const bigN = BigInt(10);</span><span id="2f9d" class="nd mc iq mz b gy ni nf l ng nh">bigN + bigN; // 20n<br/>bigN * 3n; // 30n<br/>bigN - BigInt('55'); // 45n<br/>bigN / 3n; // 3n</span></pre><p id="00eb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">注意，<code class="fe nx ny nz mz b">bigN / 3n</code>返回的是<code class="fe nx ny nz mz b">3n</code>，不是<code class="fe nx ny nz mz b">3.33333n</code>。因为你也可以从它的名字中推断出，它只处理整数。所以<code class="fe nx ny nz mz b">bigN / 3n</code>类似于<code class="fe nx ny nz mz b">Math.floor(10 / 3)</code>。</p><p id="6b0f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是，很遗憾，不能用浮点数做BigInt。同样，你也不能同时使用BigInt和Number。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="462e" class="nd mc iq mz b gy ne nf l ng nh">BigInt(3.3); <br/>// Uncaught RangeError </span><span id="ef39" class="nd mc iq mz b gy ni nf l ng nh">BigInt('3.3');<br/>// Uncaught SyntaxError</span><span id="f329" class="nd mc iq mz b gy ni nf l ng nh">BigInt(1) + 1;<br/>// Uncaught TypeError<br/>// Cannot mix BigInt and other types</span></pre><p id="13f9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">相反，唯一允许混合操作的情况是在比较操作的大小时。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="c606" class="nd mc iq mz b gy ne nf l ng nh">BigInt(1) &lt; 2 // true</span></pre><p id="0d75" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果在<code class="fe nx ny nz mz b">if</code>条件下，BigInt可以像数字一样被计算。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="4715" class="nd mc iq mz b gy ne nf l ng nh">function print(n) {<br/>  if (BigInt(n)) {<br/>   console.log('hi');<br/>  } else {<br/>   console.log('bye');<br/>  }<br/>}</span><span id="55d7" class="nd mc iq mz b gy ni nf l ng nh">print(1); // hi<br/>print(0); // bye</span></pre><p id="ae85" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是浏览器对BigInt的支持</p><ul class=""><li id="6e99" class="nj nk iq lh b li lj ll lm lo nl ls nm lw nn ma no np nq nr bi translated">Chrome: 67</li><li id="3b76" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">边缘:不支持</li><li id="dd1e" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">火狐浏览器:68</li><li id="a457" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">IE:不支持</li><li id="0e09" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">歌剧:54</li><li id="65af" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">Safari:不支持</li></ul><h1 id="681d" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">承诺。都解决了</h1><p id="1573" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">这与<code class="fe nx ny nz mz b">Promise.all</code>非常相似，但它们之间有显著的区别。<code class="fe nx ny nz mz b">Promise.all</code>等待所有承诺<em class="oa">被履行</em>或任何承诺<em class="oa">被拒绝</em>。另一方面，<code class="fe nx ny nz mz b">Promise.allSettled</code>并不关心这个。它关心的是知道是否所有的承诺都完成了，无论它们的状态如何。所以每一个输入的承诺都可能被<em class="oa">实现</em>或者被<em class="oa">拒绝</em>，但是对<code class="fe nx ny nz mz b">Promise.allSettled</code>来说都无所谓。只是所有的都要做。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">The example is from <a class="od oe ep" href="https://medium.com/u/9cbdd3686b35?source=post_page-----b4974d9d7edc--------------------------------" rel="noopener" target="_blank">Tomas Dostal</a></figcaption></figure><p id="ca7e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">当您想在某个动作之前做一些工作时，这可能非常有用，例如，在用户看到列表页面之前获取所有需要的数据。但是用户可以看到空的项目，因为提取可能会失败。</p><p id="a91d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是浏览器对<code class="fe nx ny nz mz b">Promise.allSettled</code>的支持。</p><ul class=""><li id="d2e2" class="nj nk iq lh b li lj ll lm lo nl ls nm lw nn ma no np nq nr bi translated">铬合金:76</li><li id="d890" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">边缘:不支持</li><li id="66e2" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">火狐浏览器:71</li><li id="f1ef" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">IE:不支持</li><li id="cec2" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">歌剧:未知</li><li id="cc7c" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">Safari:未知</li></ul><h1 id="d022" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">globalThis</h1><p id="ce5c" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">这是点燃的。它非常简单易用。</p><p id="3bfb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nx ny nz mz b">globalThis</code>是指您的运行上下文所在的全局<code class="fe nx ny nz mz b">this</code>上下文。如果你在浏览器上，<code class="fe nx ny nz mz b">globalThis</code>将是<code class="fe nx ny nz mz b">this</code>，如果你在Node上，<code class="fe nx ny nz mz b">globalThis</code>将是<code class="fe nx ny nz mz b">global</code>。因此不再需要考虑不同的环境问题。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="536f" class="nd mc iq mz b gy ne nf l ng nh">// worker.js<br/>globalThis === self</span><span id="8d61" class="nd mc iq mz b gy ni nf l ng nh">// node.js<br/>globalThis === global</span><span id="d574" class="nd mc iq mz b gy ni nf l ng nh">// browser.js<br/>globalThis === window</span></pre><p id="a42a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这就是它的工作原理，但是不要在你的代码中使用它！</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="aa33" class="nd mc iq mz b gy ne nf l ng nh">var getGlobal = function () { <br/>  if (typeof self !== 'undefined') { return self; } <br/>  if (typeof window !== 'undefined') { return window; } <br/>  if (typeof global !== 'undefined') { return global; } <br/>  throw new Error('unable to locate global object'); <br/>};</span></pre><p id="361b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是<code class="fe nx ny nz mz b">gloablThis</code>的环境支持。</p><ul class=""><li id="7466" class="nj nk iq lh b li lj ll lm lo nl ls nm lw nn ma no np nq nr bi translated">铬合金:71</li><li id="bed7" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">边缘:不支持</li><li id="2b54" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">火狐浏览器:65</li><li id="21fc" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">IE:不支持</li><li id="43df" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">Opera:不支持</li><li id="0253" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">Safari: 12.1</li><li id="8a82" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated">节点:12</li></ul><h1 id="ef94" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">结论</h1><p id="c280" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">ES2020中有许多有趣的新功能。然而，它们中的大多数不支持旧的浏览器，并且它们并不总是在每个环境中都稳定。所以您应该考虑在您的服务中应该支持什么样的环境。</p><h1 id="d857" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">资源</h1><ul class=""><li id="58f0" class="nj nk iq lh b li mt ll mu lo of ls og lw oh ma no np nq nr bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" rel="noopener ugc nofollow" target="_blank">导入— MDN </a></li><li id="f386" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt" rel="noopener ugc nofollow" target="_blank"> BigInt — MDN </a></li><li id="1466" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled" rel="noopener ugc nofollow" target="_blank"> Promise.allSettled — MDN </a></li><li id="430a" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/globalThis" rel="noopener ugc nofollow" target="_blank"> globalThis — MDN </a></li><li id="016e" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated"><a class="ae le" href="https://github.com/tc39/proposals/blob/master/finished-proposals.md" rel="noopener ugc nofollow" target="_blank">阶段4 — TC39 Github </a></li><li id="fa38" class="nj nk iq lh b li ns ll nt lo nu ls nv lw nw ma no np nq nr bi translated"><a class="ae le" href="https://v8.dev/features/tags/es2020" rel="noopener ugc nofollow" target="_blank">标记为“ES2020”的功能</a></li></ul></div></div>    
</body>
</html>