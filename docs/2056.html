<html>
<head>
<title>Adding Route Transition Effects with React Router</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React路由器添加路由转换效果</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-route-transition-effects-with-react-router-8b5dd8214dde?source=collection_archive---------7-----------------------#2020-05-16">https://javascript.plainenglish.io/adding-route-transition-effects-with-react-router-8b5dd8214dde?source=collection_archive---------7-----------------------#2020-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fbd745d0657873abf691f89bd204503c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j53Yh92BrJk4lrvA"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@diegojimenez?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Diego Jimenez</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a7f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建前端视图的库。它有一个庞大的图书馆生态系统与之合作。此外，我们可以用它来增强现有的应用程序。</p><p id="b150" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要构建单页面应用程序，我们必须有某种方法将URL映射到React组件来显示。</p><p id="4354" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何添加转换效果来反应路由器路由转换。</p><h1 id="c245" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加路线过渡效果</h1><p id="5e10" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要使用React添加过渡效果，我们可以使用<code class="fe me mf mg mh b">react-transition-group</code>库来轻松完成。</p><p id="2619" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过运行以下命令来安装它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4bcf" class="mq lc iq mh b gy mr ms l mt mu">npm i react-transition-group</span></pre><p id="e913" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，为了使开发更加方便，我们还可以通过运行以下命令来添加TypeScript类型定义:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fe78" class="mq lc iq mh b gy mr ms l mt mu">npm install @types/react-transition-group</span></pre><p id="a5bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当路线改变时，我们可以添加一个简单的渐变过渡效果，如下所示:</p><p id="841c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">styles.css</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ebf3" class="mq lc iq mh b gy mr ms l mt mu">.fade-enter {<br/>  opacity: 0;<br/>}<br/>.fade-enter-active {<br/>  opacity: 1;<br/>  transition: opacity 800ms;<br/>}<br/>.fade-exit {<br/>  opacity: 1;<br/>}<br/>.fade-exit-active {<br/>  opacity: 0;<br/>  transition: opacity 800ms;<br/>}</span></pre><p id="b81c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">index.js</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1728" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import { TransitionGroup, CSSTransition } from "react-transition-group";<br/>import {<br/>  useLocation,<br/>  useParams,<br/>  BrowserRouter as Router,<br/>  Switch,<br/>  Route,<br/>  Link<br/>} from "react-router-dom";<br/>import "./styles.css";</span><span id="199b" class="mq lc iq mh b gy mv ms l mt mu">function RGB() {<br/>  let { r, g, b } = useParams();<br/>  return (<br/>    &lt;div<br/>      style={{<br/>        background: `rgb(${r}, ${g}, ${b})`<br/>      }}<br/>    &gt;<br/>      rgb({r}, {g}, {b})<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="3901" class="mq lc iq mh b gy mv ms l mt mu">function Foo() {<br/>  return &lt;h3&gt;Foo&lt;/h3&gt;;<br/>}</span><span id="2b76" class="mq lc iq mh b gy mv ms l mt mu">function AnimationApp() {<br/>  const location = useLocation();<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;ul&gt;<br/>        &lt;li&gt;<br/>          &lt;Link to="/foo"&gt;Foo&lt;/Link&gt;<br/>        &lt;/li&gt;<br/>        &lt;li&gt;<br/>          &lt;Link to="/rgb/33/150/243"&gt;Blue&lt;/Link&gt;<br/>        &lt;/li&gt;<br/>        &lt;li&gt;<br/>          &lt;Link to="/rgb/240/98/146"&gt;Pink&lt;/Link&gt;<br/>        &lt;/li&gt;<br/>      &lt;/ul&gt;</span><span id="8200" class="mq lc iq mh b gy mv ms l mt mu">      &lt;div&gt;<br/>        &lt;TransitionGroup&gt;<br/>          &lt;CSSTransition key={location.key} classNames="fade" timeout={300}&gt;<br/>            &lt;Switch location={location}&gt;<br/>              &lt;Router&gt;<br/>                &lt;Route path="/rgb/:r/:g/:b" children={&lt;RGB /&gt;} /&gt;<br/>                &lt;Route path="/foo" children={&lt;Foo /&gt;} /&gt;<br/>              &lt;/Router&gt;<br/>            &lt;/Switch&gt;<br/>          &lt;/CSSTransition&gt;<br/>        &lt;/TransitionGroup&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="5dcb" class="mq lc iq mh b gy mv ms l mt mu">function App() {<br/>  return (<br/>    &lt;Router&gt;<br/>      &lt;Switch&gt;<br/>        &lt;Route path="*"&gt;<br/>          &lt;AnimationApp /&gt;<br/>        &lt;/Route&gt;<br/>      &lt;/Switch&gt;<br/>    &lt;/Router&gt;<br/>  );<br/>}</span><span id="9334" class="mq lc iq mh b gy mv ms l mt mu">const rootElement = document.getElementById("root");<br/>ReactDOM.render(&lt;App /&gt;, rootElement);</span></pre><p id="ebf5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们有过渡效果的类。</p><p id="c18d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">fade-</code>之后的部分类名是标准的。我们可以将<code class="fe me mf mg mh b">fade</code>改为其他名称，只要它与我们为<code class="fe me mf mg mh b">CSSTransition</code>组件设置的<code class="fe me mf mg mh b">classNames</code>属性值相同。</p><p id="94c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">styles.css</code>中，我们用<code class="fe me mf mg mh b">.fade-enter</code>指定动画开始时的样式。</p><p id="8e47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们指定用<code class="fe me mf mg mh b">.fade-enter-active</code>显示路线内容时要显示的样式。</p><p id="cfd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦路线的组件退出，将应用<code class="fe me mf mg mh b">.fade-exit</code>类中的样式。然后，在route的组件离开DOM之后，将应用<code class="fe me mf mg mh b">.fade-exit-active</code>类中的样式。</p><p id="4717" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个类型动作，不以<code class="fe me mf mg mh b">-active</code>结尾的类应用于以<code class="fe me mf mg mh b">-active</code>结尾的类。这4个类一起创建了一个渐变效果，不透明度从0开始，然后过渡显示为完全不透明。然后过渡效果又消失了。</p><p id="6f63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">Route</code>组件中，我们根据URL显示<code class="fe me mf mg mh b">RGB</code>组件或<code class="fe me mf mg mh b">Foo</code>组件。</p><p id="6666" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">AnimationApp</code>的<code class="fe me mf mg mh b">CSSTransition</code>组件中，我们有<code class="fe me mf mg mh b">timeout</code>属性来指示转换进入或离开DOM所需的毫秒数。</p><p id="dbad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">react-transitions-group</code>使用<code class="fe me mf mg mh b">key</code>道具来确定哪个子组件已经进入或退出。</p><p id="d62f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">App</code>中，我们有<code class="fe me mf mg mh b">Router</code>、<code class="fe me mf mg mh b">Switch</code>和<code class="fe me mf mg mh b">Route</code>组件。我们只是用它来映射到<code class="fe me mf mg mh b">AnimationApp</code>的所有路线，它有实际想要映射到的路线。</p><p id="4880" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要这样做，因为React路由器无法从根路由中获取<code class="fe me mf mg mh b">location</code>对象。所以:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9886" class="mq lc iq mh b gy mr ms l mt mu">const location = useLocation();</span></pre><p id="7b12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果在<code class="fe me mf mg mh b">App</code>中会给我们一个错误。</p><p id="e0e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">RGB</code>组件中，我们用<code class="fe me mf mg mh b">useParams</code>获取路线参数，然后用它用路线参数中的RGB值设置背景颜色。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/eb8d96977aa1d190806f34b3ce7c1a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ka2Dg1v_xHTyjBPR"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@thisisjlaw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Justin Lawrence</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e75b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f42d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们在路线之间转换时，我们可以使用<code class="fe me mf mg mh b">react-transition-group</code>库来添加转换效果。</p><p id="5de4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何其他组件过渡一样，我们使用<code class="fe me mf mg mh b">TransitionGroup</code>和<code class="fe me mf mg mh b">CSSTransition</code>组件来创建CSS的过渡效果。</p><p id="e4a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们指定了<code class="fe me mf mg mh b">classNames</code>属性的值，那么我们就可以使用CSS代码中的类前缀来指定转换。</p><p id="bc49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以为<code class="fe me mf mg mh b">enter</code>、<code class="fe me mf mg mh b">enter-active</code>、<code class="fe me mf mg mh b">exit</code>和<code class="fe me mf mg mh b">exit-active</code>类指定CSS样式，如果需要的话还可以指定其他样式。</p><p id="9246" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不以<code class="fe me mf mg mh b">-active</code>结尾的类应用于以<code class="fe me mf mg mh b">-active</code>结尾的类。</p><h2 id="0855" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="c72f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="kf ir">JavaScript in Plain English</strong></a><a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！</p><p id="c25f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还推出了一个YouTube，希望你能通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的简明英语频道</strong> </a>来支持我们</p><p id="f075" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一如既往,“简明英语”希望帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>