<html>
<head>
<title>Setting up Redux to avoid boilerplate code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置Redux以避免样板代码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/setting-up-redux-to-avoid-boilerplate-code-33abf57a293b?source=collection_archive---------8-----------------------#2020-07-04">https://javascript.plainenglish.io/setting-up-redux-to-avoid-boilerplate-code-33abf57a293b?source=collection_archive---------8-----------------------#2020-07-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="521e" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">生成Reducer函数和减小包大小的明确指南。</h2><div class=""/><div class=""><h2 id="df1f" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">在web应用程序中编写reducers时，这是一种避免冗余和重复代码的好方法。</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/c98778672613f0113bea2bf919f50be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pckkl0-6Mo9Eoknx"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@goshua13?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Aragon</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bcd0" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">好吧，如果你熟悉React和Redux，我敢肯定你一定担心在很多地方编写重复和冗余的代码片段。</p><p id="bb1e" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">在进入实际的业务逻辑之前，您总是需要编写这些代码。虽然在你的web应用程序中有很多地方重复相同的编码模式，但我想谈谈我觉得我们都为反复编写相同类型的代码而感到沮丧的地方:<strong class="le ix"> Redux Reducers </strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ly"><img src="../Images/6c5dc7ad9a2465950fc0e8189525b7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8vW9uMXPkqgWrio8CWj2g.jpeg"/></div></div></figure><p id="19cd" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">由于干式编码原理建议我们应该减少重复的编码模式以提高质量和冗余度，所以让我们尝试修复Reducer模式。</p><h2 id="8fe2" class="lz ma in bd mb mc md dn me mf mg dp mh ll mi mj mk lp ml mm mn lt mo mp mq it bi translated"><strong class="ak">添加一个生成reducer函数的抽象函数:</strong></h2><p id="e737" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">简单地说，我们将创建一个返回另一个函数的函数，返回的函数将表现为一个reducer函数。在我们进入编码部分之前，这里有一些关于Reducer函数的要点:</p><ul class=""><li id="ef53" class="mw mx in le b lf lg li lj ll my lp mz lt na lx nb nc nd ne bi translated">它用API结果更新商店数据。</li><li id="318e" class="mw mx in le b lf nf li ng ll nh lp ni lt nj lx nb nc nd ne bi translated">如果出现错误，它会相应地更新存储。</li><li id="9aea" class="mw mx in le b lf nf li ng ll nh lp ni lt nj lx nb nc nd ne bi translated">它可能有也可能没有异步操作。</li></ul><p id="6489" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">因此，我们将创建一个抽象函数来处理:A)成功情况，b)失败情况，以及c)从API获取数据时的“等待”情况。这些是Reducer函数最常见的用例。我们将牢记这些标准来编写我们的抽象。</p></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="1286" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我们开始吧！</p><h2 id="4876" class="lz ma in bd mb mc md dn me mf mg dp mh ll mi mj mk lp ml mm mn lt mo mp mq it bi translated">返回Reducer函数的函数:</h2><p id="ee43" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">正如我们之前讨论的，我们的抽象函数必须返回reducer函数。并且缩减器需要具有:a)状态和b)动作作为参数。它还应该有一个默认状态(可选):</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nr"><img src="../Images/010d360eb408e89e1bad3fda4d49e618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T57JaFJ2KJGmt5wzzyNQJQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Find the full code snippet at the bottom of the post.</figcaption></figure><p id="1d36" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这里，<code class="fe ns nt nu nv b">makeReducer</code>函数是我们抽象的名字，它返回reducer函数。我使用<code class="fe ns nt nu nv b">defaultState</code>变量为我们的缩减器提供一个默认状态。我们将在稍后的文章中添加一个自定义的默认状态功能。</p><h2 id="b577" class="lz ma in bd mb mc md dn me mf mg dp mh ll mi mj mk lp ml mm mn lt mo mp mq it bi translated">进行不同类型操作的功能:</h2><p id="60f8" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">如您所见，我们在返回的Reducer函数中硬编码了成功和失败动作的名称。为了简单起见，让我们做一个通过类型返回动作的函数，我们称它为<code class="fe ns nt nu nv b">makeActionByType</code>。该函数将返回一个带有关键字:<code class="fe ns nt nu nv b">type</code>的对象，值将是动作类型名称:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nw"><img src="../Images/0394f0bfba8c0a6209522d798e565974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SBmjsf9PF8_Or5HwILnzA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">find full code snippet at the bottom of the post.</figcaption></figure><p id="0089" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">当我们让动作创建者调度动作时，这个函数也会很有帮助。</p><h2 id="0651" class="lz ma in bd mb mc md dn me mf mg dp mh ll mi mj mk lp ml mm mn lt mo mp mq it bi translated">抽象接受自定义初始状态:</h2><p id="a0b7" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">我们还对减速器的默认初始状态进行了硬编码。如果有人想在最初将一个自定义状态传递给Reducer，该怎么办？我们的抽象应该接受自定义状态:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nx"><img src="../Images/e999254edbf1a9b73ff2f8ef6bf1997d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VcjwZSCCvK07KBAqLkzXg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">find full code snippet at the bottom of the post.</figcaption></figure><p id="729a" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这里需要注意的主要有两点:1)我们引入了一个新的参数:<code class="fe ns nt nu nv b">shouldMergeDefaultStates</code>(第19行)？并且，我们现在将自定义状态与<code class="fe ns nt nu nv b">defaultState</code>(第22–26行)合并。2)我们使用合并状态作为缩减器的初始状态(第28行)。参数<code class="fe ns nt nu nv b">shouldMergeDefaultStates</code>将告诉我们的抽象函数是否将自定义状态与默认状态合并。这样，开发人员就不必一遍又一遍地传递多余的代码。</p><h2 id="216f" class="lz ma in bd mb mc md dn me mf mg dp mh ll mi mj mk lp ml mm mn lt mo mp mq it bi translated">自定义操作呢:</h2><p id="bd4f" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">到目前为止一切看起来都很好，但是如果有人想要将一个自定义操作传递给函数，该怎么办呢？我们没有任何方法将自定义动作添加到Reducer中。让我们想出一种方法来为我们的Reducer添加定制动作。从代码中我们知道，所有的动作都是对象变量的一部分:<code class="fe ns nt nu nv b">options</code>。我们可以在抽象函数的参数中接受自定义操作，并在选项变量中扩展自定义操作对象:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/9012b4301718560d5158126a64a8eb04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBbhyAD9Knk40WTWwQA0gQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">find full code snippet at the bottom of the post.</figcaption></figure><p id="4c48" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">新参数<code class="fe ns nt nu nv b">additionalActions</code>(第19行)是一个函数，因为我们需要从reducer函数访问<code class="fe ns nt nu nv b">state</code>和<code class="fe ns nt nu nv b">action</code>变量。这个函数返回您想要添加到Reducer中的所有定制动作。下面是您传递自定义操作的方式:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nz"><img src="../Images/78b1d4aa5536358414c462aa704adcc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kujAq96nOVojqyxArdmQA.png"/></div></div></figure><p id="a634" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这就是我们如何在React-Redux web应用程序的Reducer部分去掉无用的样板代码。</p></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><h2 id="df47" class="lz ma in bd mb mc md dn me mf mg dp mh ll mi mj mk lp ml mm mn lt mo mp mq it bi translated">奖金:</h2><p id="0755" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">虽然我们已经修好了减速器部分。但是如果你像我一样，使用动作创建器功能来调度动作。你知道它也可以被优化，因为那里也有很多重复的代码。因此，让我们创建一个函数，返回默认操作的创建者:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oa"><img src="../Images/39c0841d1576f3cf8fe4856f4a23e0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MI6JPaD5smQWgH06NY9BpA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">find full code snippet at the bottom of the post.</figcaption></figure><p id="994e" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">我们的<code class="fe ns nt nu nv b">makeActions</code>函数返回三种类型的动作创建者:1)<code class="fe ns nt nu nv b">defaultAction</code>:这是默认动作。假设您想从API获取数据。你想把抓取设置为真？您将使用这个动作创建器。2)<code class="fe ns nt nu nv b">successAction</code>:用API返回的数据更新存储中的数据。3)<code class="fe ns nt nu nv b">failureAction</code>:设置减速机状态的<code class="fe ns nt nu nv b">error</code>字段的值。这可能是一个API错误，或者是当用户的行为不符合预期时，您可能想要通知用户的情况。以下是如何使用<code class="fe ns nt nu nv b">makeActions</code>功能:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ob"><img src="../Images/f2f04524793bd4197d3e0016630d3ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-5StT8bFsaIgwv8uNcNxA.png"/></div></div></figure><p id="3f52" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">由于该函数返回非常通用的动作名称，所以我根据我的Reducer上下文对它进行了重命名。</p><p id="801e" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">这里是<a class="ae lb" href="https://gist.github.com/iiisoni/9476de109fe1147fb56752f130590309" rel="noopener ugc nofollow" target="_blank">完整代码</a>的链接。</p><h1 id="a9b8" class="oc ma in bd mb od oe of me og oh oi mh kc oj kd mk kf ok kg mn ki ol kj mq om bi translated">关于作者:</h1><p id="0fba" class="pw-post-body-paragraph lc ld in le b lf mr jx lh li ms ka lk ll mt ln lo lp mu lr ls lt mv lv lw lx ig bi translated">自2011年以来，Bharat一直是前端开发人员。他喜欢“前端开发经验”。他喜欢学习和教授技术。他喜欢和最可爱的女人以及两个珍贵的双胞胎在一起的生活。</p><p id="7d6d" class="pw-post-body-paragraph lc ld in le b lf lg jx lh li lj ka lk ll lm ln lo lp lq lr ls lt lu lv lw lx ig bi translated">总的来说是个好人。在<a class="ae lb" href="https://twitter.com/iiisoni" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae lb" href="https://github.com/iiison" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae lb" href="https://www.linkedin.com/in/iiison/" rel="noopener ugc nofollow" target="_blank">领英</a>上找到他。</p></div></div>    
</body>
</html>