<html>
<head>
<title>usePopper with styled-components for React — React Popper 2.×</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Popper与样式化组件一起用于React-React Popper 2.×</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/usepopper-with-styled-components-for-react-react-popper-2-568284d029bf?source=collection_archive---------0-----------------------#2020-05-19">https://javascript.plainenglish.io/usepopper-with-styled-components-for-react-react-popper-2-568284d029bf?source=collection_archive---------0-----------------------#2020-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cc49" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">React Popper的<code class="fe kf kg kh ki b"><strong class="ak">usePopper</strong></code>挂钩— Popper.js</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/6ba3bad78bc6fe9679cec32f86a92eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znR0PTlaXgcgSNhGfq1WWA.png"/></div></div></figure><p id="cb95" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我最近升级了我们组件库中的popper。</p><p id="11ad" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">管理popper的放置、翻转和溢出防止所涉及的复杂性使得从头编写自己的实现令人生畏(尤其是耗时)。</p><p id="813b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在解释为什么你应该使用它们方面，Popper.js比我做得更好。</p><h2 id="8275" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">反作用弹出器2.×使用弹出器挂钩</h2><p id="29a9" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">关于实现<code class="fe kf kg kh ki b">usePopper</code>钩子的文档相对有限。(我花了很长时间才得到一个可用的版本😅)</p><p id="6351" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe kf kg kh ki b">usePopper</code>挂钩有三个参数:</p><ul class=""><li id="f93d" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq mv mw mx my bi translated">对切换元素的引用，例如按钮</li><li id="4e9d" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated">对popper元素的引用</li><li id="2d8e" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated">配置对象</li></ul><p id="94be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并返回两个变量:</p><ul class=""><li id="c270" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq mv mw mx my bi translated"><code class="fe kf kg kh ki b">styles</code></li><li id="31d8" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated"><code class="fe kf kg kh ki b">attributes</code></li></ul><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="898a" class="ls lt iq ki b gy ni nj l nk nl">const { styles, attributes } = usePopper(<br/>  buttonRef.current,<br/>  popperRef.current,<br/>  {<br/>    modifiers: [<br/>      {<br/>        name: "arrow",<br/>        options: {<br/>          element: arrowRef<br/>        }<br/>      },<br/>      {<br/>        name: "offset",<br/>        options: {<br/>          offset: [0, 10]<br/>        }<br/>      }<br/>    ]<br/>  }<br/>);</span></pre><h2 id="4213" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">处理按钮和弹出器ref-useRef()</h2><p id="1bc4" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">当创建对我们的按钮和弹出器的引用时，我们可以<code class="fe kf kg kh ki b">useRef</code>创建一个引用对象并将其分配给我们的按钮。我们的波普也一样:</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="fcef" class="ls lt iq ki b gy ni nj l nk nl">const buttonRef = useRef(null);<br/>const popperRef = useRef(null);</span><span id="e658" class="ls lt iq ki b gy nm nj l nk nl">...</span><span id="4914" class="ls lt iq ki b gy nm nj l nk nl">&lt;Button ref={buttonRef} ...</span><span id="cad8" class="ls lt iq ki b gy nm nj l nk nl">...<br/>&lt;PopperContainer ref={popperRef} ...</span></pre><p id="ed4b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，当我们将引用传递给<code class="fe kf kg kh ki b">usePopper</code>时，我们简单地使用<code class="fe kf kg kh ki b">.current</code>属性。</p><p id="9e4e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">简单。</p><h2 id="bdbc" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">通过useState()对我们的箭头使用回调引用</h2><p id="fe16" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">在为我们的箭头创建引用时，我们需要<a class="ae lr" href="https://github.com/popperjs/react-popper/issues/354#issuecomment-613937717" rel="noopener ugc nofollow" target="_blank">使用回调引用</a>，而不是引用对象。</p><p id="0097" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">啊？引用对象？</p><p id="d136" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过选择<code class="fe kf kg kh ki b">useState</code>，我们可以<a class="ae lr" href="https://reactjs.org/docs/refs-and-the-dom.html#callback-refs" rel="noopener ugc nofollow" target="_blank">创建一个回调引用</a>，而不是<code class="fe kf kg kh ki b">useRef</code>创建的引用对象。</p><p id="74bb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将<code class="fe kf kg kh ki b">setArrowRef</code>函数传递给箭头div上的<code class="fe kf kg kh ki b">ref</code>:</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="87f7" class="ls lt iq ki b gy ni nj l nk nl"><em class="nn">// the ref for the arrow must be a callback ref<br/></em>const [arrowRef, setArrowRef] = useState(null);</span><span id="650e" class="ls lt iq ki b gy nm nj l nk nl">...</span><span id="2d3e" class="ls lt iq ki b gy nm nj l nk nl">&lt;div ref={setArrowRef} /&gt;</span></pre><p id="1885" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，当我们将ref变量传递给<code class="fe kf kg kh ki b">usePopper</code>钩子时，我们只需使用<code class="fe kf kg kh ki b">arrowRef</code>。</p><h2 id="5ef5" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">配置对象—修饰符</h2><p id="b06c" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们将一个配置对象传递给我们的<code class="fe kf kg kh ki b">usePopper</code>钩子，并为我们的特定用例指定修饰符。</p><p id="a9e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将指定一个箭头元素，popper.js为我们处理定位，以及一个匹配我们的箭头大小的偏移量。</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="26fc" class="ls lt iq ki b gy ni nj l nk nl">modifiers: [<br/>      {<br/>        name: "arrow",<br/>        options: {<br/>          element: arrowRef<br/>        }<br/>      },<br/>      {<br/>        name: "offset",<br/>        options: {<br/>          offset: [0, 10]<br/>        }<br/>      }<br/>    ]</span></pre><p id="922d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">配置对象可用修改器的完整列表可以在<a class="ae lr" href="https://popper.js.org/docs/v2/modifiers/" rel="noopener ugc nofollow" target="_blank">非反应弹出器文档</a>中找到。</p><h2 id="e17a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">应用usePopper样式和属性</h2><p id="182c" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">出于本文的目的，我们将使用一个基本的样式化组件弹出器:</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="fe81" class="ls lt iq ki b gy ni nj l nk nl">const PopperContainer = styled.div`<br/>  box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);<br/>  border-radius: 5px;<br/>  background-color: white;<br/>  padding: 20px;<br/>  text-align: center;<br/>`</span></pre><p id="843b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，在我们的组件内部，我们将添加<code class="fe kf kg kh ki b">PopperContainer</code>并应用引用、样式和属性:</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="5a0f" class="ls lt iq ki b gy ni nj l nk nl">&lt;PopperContainer<br/>  ref={popperRef}<br/>  style={styles.popper}<br/>  {...attributes.popper}<br/>&gt;<br/>  &lt;div ref={setArrowRef} style={styles.arrow} className="arrow" /&gt;<br/>  &lt;p&gt;I'm a popper&lt;/p&gt;<br/>&lt;/PopperContainer&gt;</span></pre><h2 id="2a61" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">设计我们的箭头以匹配弹出器的位置</h2><p id="d948" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们已经将<code class="fe kf kg kh ki b">styles.arrow</code>传递给我们的arrow div，它处理整体定位，我们仍然需要手动添加一些样式来使它工作。</p><p id="5c68" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的<code class="fe kf kg kh ki b">PopperContainer</code>样式组件内部，我们的目标是<code class="fe kf kg kh ki b">.arrow</code>类名:</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="cbfb" class="ls lt iq ki b gy ni nj l nk nl">const PopperContainer = styled.div`</span><span id="35bf" class="ls lt iq ki b gy nm nj l nk nl">  ...</span><span id="e7fb" class="ls lt iq ki b gy nm nj l nk nl">.arrow {<br/>    position: absolute;<br/>    width: 10px;<br/>    height: 10px;<br/><br/>    &amp;:after {<br/>      content: " ";<br/>      position: absolute;<br/>      top: -25px; // we account for the PopperContainer padding<br/>      left: 0;<br/>      transform: rotate(45deg);<br/>      width: 10px;<br/>      height: 10px;<br/>      background-color: white;<br/>      box-shadow: -1px -1px 1px rgba(0, 0, 0, 0.1);<br/>    }<br/>  }<br/>`</span></pre><p id="72f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">目前，我们的箭头被设计成位于popper div的顶部，看起来不错。</p><p id="833f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">直到我们滚动页面😅：</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="726d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我们已经将popper属性添加到了我们的<code class="fe kf kg kh ki b">PopperContainer</code>中，所以我们可以在我们的样式化组件中访问<code class="fe kf kg kh ki b">data-popper-placement</code>:</p><pre class="kk kl km kn gt ne ki nf ng aw nh bi"><span id="c23d" class="ls lt iq ki b gy ni nj l nk nl">const PopperContainer = styled.div`</span><span id="5cfa" class="ls lt iq ki b gy nm nj l nk nl">...</span><span id="86ab" class="ls lt iq ki b gy nm nj l nk nl">  .arrow {<br/>    ...<br/>  }</span><span id="98dc" class="ls lt iq ki b gy nm nj l nk nl">  &amp;[data-popper-placement^='top'] &gt; .arrow {<br/>    bottom: -30px;</span><span id="a6f4" class="ls lt iq ki b gy nm nj l nk nl">    :after {<br/>      box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);<br/>    }<br/>  }<br/>`</span></pre><p id="be21" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里，我们将箭头调整为当其位置翻转方向时显示在弹出器的底部。</p><p id="49d2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们想为不同的方向设计箭头样式，那么我们可以简单地以同样的方式访问<code class="fe kf kg kh ki b">data-popper-placement</code>属性的底部、左侧和右侧。</p><h2 id="7839" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">最后的结果</h2><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="82a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">资源:</strong></p><ul class=""><li id="ed10" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq mv mw mx my bi translated">CodeSandbox 上的源代码<a class="ae lr" href="https://codesandbox.io/s/blue-worker-w9rtu?file=/src/App.js" rel="noopener ugc nofollow" target="_blank"/></li><li id="7b41" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated">对popper.js上的Popper文档<a class="ae lr" href="https://popper.js.org/react-popper/v2/" rel="noopener ugc nofollow" target="_blank">做出反应</a></li><li id="5316" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated">popper.js上的自定义修改器文档<a class="ae lr" href="https://popper.js.org/docs/v2/modifiers/" rel="noopener ugc nofollow" target="_blank"/></li><li id="4a18" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated">React文档上的useRef<a class="ae lr" href="https://popper.js.org/docs/v2/modifiers/" rel="noopener ugc nofollow" target="_blank"/></li></ul><p id="8568" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读！</p><p id="bf66" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">麦显杰</p><div class="nq nr gp gr ns nt"><a href="https://medium.com/javascript-in-plain-english/youre-missing-a-trick-with-your-styled-components-in-react-e3dfcd586f75" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">您错过了React中样式化组件的一个技巧</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">为组件添加显示名称以帮助识别它们</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kt nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://medium.com/javascript-in-plain-english/are-your-react-components-style-extendible-17148ba98c00" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">你的React组件风格可扩展吗？</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">用React和styled-components创建样式可扩展组件</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="oi l oe of og oc oh kt nt"/></div></div></a></div><ul class=""><li id="6fbd" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq mv mw mx my bi translated"><a class="ae lr" href="https://codesandbox.io/s/blue-worker-w9rtu" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/blue-worker-w9rtu</a></li></ul><div class="nq nr gp gr ns nt"><a href="https://github.com/popperjs/react-popper/issues/354" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">安装问题#354 popperjs/react-popper的位置不正确</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">github.com</p></div></div><div class="oc l"><div class="oj l oe of og oc oh kt nt"/></div></div></a></div><h2 id="9b50" class="ls lt iq bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="6939" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae lr" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> plainenglish.io </strong> </a>找到所有这些内容——关注我们的出版物并<a class="ae lr" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">订阅我们的YouTube频道</strong> </a> <strong class="kx ir">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>