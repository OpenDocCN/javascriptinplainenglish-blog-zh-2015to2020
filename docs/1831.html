<html>
<head>
<title>How To Put A Custom API Call In Your Gatsby App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在您的盖茨比应用程序中加入自定义API调用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-put-a-custom-api-call-in-your-gatsby-app-ef7496bc69f2?source=collection_archive---------5-----------------------#2020-04-27">https://javascript.plainenglish.io/how-to-put-a-custom-api-call-in-your-gatsby-app-ef7496bc69f2?source=collection_archive---------5-----------------------#2020-04-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ada9b7051d2291b6cef31c7624cf7bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*5wjmeSwGoV8SQFZRlLkL3Q.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Courtesy the good people at <a class="ae jy" href="https://frinkiac.com/" rel="noopener ugc nofollow" target="_blank">Frinkiac</a></figcaption></figure><p id="e7ac" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">最近，我试图在一个志愿者项目中帮助人们在COVID期间找到视频治疗，我一直在使用<a class="ae jy" href="https://medium.com/javascript-in-plain-english/why-you-should-be-using-gatsby-a94c1c6efc15" rel="noopener"> Gatsby </a>进行该项目。盖茨比是围绕【T2反应】的包装或轻型框架，结合了GraphQL和服务器端渲染，为用户提供了非常快速的访问，这对于人们可能没有良好互联网的地方来说是完美的，比如受这场危机影响的疗养院和农村地区。</p><p id="2738" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">然而，虽然盖茨比真的很酷，但它也是<a class="ae jy" href="https://en.wikipedia.org/wiki/Open_source" rel="noopener ugc nofollow" target="_blank">“开源”</a>这是不可思议的，它允许任何人，不管他们的资历如何，尝试贡献和添加它，而且大多数时候这是以一种叫做“插件”的形式(至少对盖茨比来说是这样)。</p><p id="9ea6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">通常对于一个反应项目，人们可能会使用来自<a class="ae jy" href="http://npmjs.com" rel="noopener ugc nofollow" target="_blank"> NPM的“包”，节点包管理器</a>允许任何人对他们的代码使用开源贡献，不管它是否像方法<a class="ae jy" href="https://www.npmjs.com/package/isarray" rel="noopener ugc nofollow" target="_blank">“I Array”</a>一样简单，该方法查看某个东西是否是一个类似于<a class="ae jy" href="https://medium.com/javascript-in-plain-english/redux-hooks-profit-bf3f576e066d" rel="noopener"> Redux </a>的数组，该数组存储整个应用程序的所有可变数据！</p><p id="3ffd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">然而，在盖茨比的服务器端渲染中，NPM包经常不得不被修改以使用盖茨比，主要是使用盖茨比附带的用于全球状态管理的<a class="ae jy" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL API </a>。</p><p id="42d2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我的目标相对简单:用网站生成时发生的回迁替换网站生命周期中通常会进入Redux“Store”或全局状态的一些<a class="ae jy" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank">“回迁”</a>，这样它们就可以被放入Gatsby的GraphQL中间件中，在整个应用程序中使用。</p><p id="73d7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我确实说相对；).</p><p id="d00d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">幸运的是有一个插件:gatsby-source-custom-api</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kx"><img src="../Images/9d95f8e17a109d4780dfeb298bddd9e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Io4xOwowu1P8e077EVrEfQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">There’s an app for that…</figcaption></figure><p id="3918" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这让您可以为您正在查询的url定义简单的选项，并为您将要放入GraphQL的模式定义一些选项:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/efdee02b28dd743d706672538d941c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*yJdE6Us3yBF61DTZ8s-hIg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Doin great, the plug-in way!</figcaption></figure><p id="b62b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这适用于一个例子(得分！)，但实际上我不得不向两个不同的端点发出两个请求，由于数据的性质，第二个请求没有被正确解析。后来，我发现它比我想象的更有效，但是由于我的查询的性质，我陷入了困境。永远学习！</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lh"><img src="../Images/a5c48862ea3ea262ac93f8cce3f43b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/0*py8-04YgYLg0kQk2"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Remember this?</figcaption></figure><p id="ba4f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我尝试了另一个名为"<a class="ae jy" href="https://www.gatsbyjs.org/packages/gatsby-source-apiserver/?=apiserver" rel="noopener ugc nofollow" target="_blank"> gatsby-source-apiserver </a>的插件，但我发现这个插件更复杂，而且不幸的是它不起作用。</p><p id="26f9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">幸运的是，我和我的朋友，也是更酷/更聪明的程序员<a class="ae jy" href="https://blog.marksauerutley.com/" rel="noopener ugc nofollow" target="_blank">马克·绍尔-乌特利</a>聊了聊，他向我展示了我可以通过“gatsby-node.js”文件使用Gatsby的节点API手动将东西放入GraphQL <a class="ae jy" href="https://www.gatsbyjs.org/docs/node-apis/#sourceNodes" rel="noopener ugc nofollow" target="_blank">中。</a></p><p id="6afd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们最终使用了<a class="ae jy" href="https://www.npmjs.com/package/isomorphic-fetch" rel="noopener ugc nofollow" target="_blank">NPM的“同构获取”</a>，它允许你在前端和后端都使用“获取”。我们是这样做的:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/843cea801902e0d19ecfca3c52cc79fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*NO9MUrtGFsv6H60puSUwLQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">custom-gatsby-node work!</figcaption></figure><p id="2bcc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">盖茨比和盖茨比的插件是开源的，所以它可能会令人困惑，当事情不工作时，没有人真正负责，因为人们是出于内心的善良来创造东西的。</p><p id="c7cb" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">看到马克帮助我，以及程序员们互相帮助完成工作的精神，真是令人振奋。</p><p id="705e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这是密码，以防有人需要！</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lq"><img src="../Images/1ff194ee09b7ad0106c3ad8bdaf716df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w304LrqtWCLektvBnjsnZA.jpeg"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Bleecker!</figcaption></figure><p id="5b40" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">说到精神，布里克很有精神！当我骑自行车顺流而下时，这只小狗爬到我身上，给我啃咬和拥抱。</p><p id="5d77" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们程序员可以用这样的布里克精神。</p><p id="fbaf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">白对瑙尔道:</p><p id="eb0b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">网卡</p><h2 id="5bab" class="lr ls iq bd lt lu lv dn lw lx ly dp lz kk ma mb mc ko md me mf ks mg mh mi mj bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="e995" class="pw-post-body-paragraph jz ka iq kb b kc mk ke kf kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw ij bi translated">我们已经推出了三种新的出版物！为我们的新出版物献上一点爱心吧，请跟随他们:<a class="ae jy" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kb ir">AI in Plain English</strong></a>，<a class="ae jy" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kb ir">UX in Plain English</strong></a>，<a class="ae jy" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kb ir">Python in Plain English</strong></a><strong class="kb ir"/>——谢谢，继续学习！</p><p id="e717" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae jy" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kb ir">submissions @ plain English . io</strong></a><strong class="kb ir"/>，并附上您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>