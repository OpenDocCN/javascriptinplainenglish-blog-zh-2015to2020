<html>
<head>
<title>Implementing Angular Material table with pagination, server side filtering and sorting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实现带分页、服务器端过滤和排序的角度素材表</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/implementing-angular-material-table-with-pagination-server-side-filtering-and-sorting-58e6a2ba4a48?source=collection_archive---------0-----------------------#2020-04-18">https://javascript.plainenglish.io/implementing-angular-material-table-with-pagination-server-side-filtering-and-sorting-58e6a2ba4a48?source=collection_archive---------0-----------------------#2020-04-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="66d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://material.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular Material </a>是Google提供的用户界面库。谷歌开发人员在谷歌产品中使用它。棱角分明的材质<strong class="jp ir"> <em class="km">专注极简的设计</em> </strong>。<strong class="jp ir"> <em class="km">它比丰富的用户界面</em>更注重性能。</strong>角状素材提供了一堆控件，我们在本文中讨论的范围是角状素材表。我们将贯彻我们的产品设计理念。我们将创建一个产品列表，并在Angular material表中显示它们。然后我们将讨论角材表的排序和分页。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/e3ad01eddac37cdc518c0666c0bf2f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-l-m7mJqcYq18fVi.png"/></div></div></figure><h1 id="2f03" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">导入角材数据表模块:</strong></h1><p id="65d4" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">在添加角度材料数据表模块之前，您必须添加BrowserAnimationsModule。BrowserAnimationsModule是运行其他物料模块的依赖模块。数据表有三个关键模块。</p><ul class=""><li id="5459" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated">mat数据表的mattable模块</li><li id="9367" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">MatSortModule通过单击标题对元素进行排序</li><li id="54ee" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">用于分页的MatPaginatorModule显示页面大小、下一页和页面大小下拉列表</li><li id="21a2" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">另一个模块MatButtonModule，MatIconModule，MatTooltipModule用于构造按钮、图标和工具提示的模板。</li></ul><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="1466" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一点需要注意的是，9 plus版本中所有的材质模块都是从@angular/material/ <module>导入的。在以前的版本(即版本5)中，您只能从@angular/material导入所有模块。</module></p><h1 id="08ee" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">创建产品界面和产品数据:</strong></h1><p id="8db9" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">下一步是为表创建一个数据模型。在这里，我们正在创建产品界面。产品界面由id、作为必填字段的名称和产品描述以及作为可选参数的产品等级组成。接下来，我们将创建产品数据，这是产品数组的类型。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="485e" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">欢迎来到角度材料数据表:</h1><h2 id="93d3" class="ms la iq bd lb mt mu dn lf mv mw dp lj jy mx my ln kc mz na lr kg nb nc lv nd bi translated"><strong class="ak"> 1。创建模板:</strong></h2><p id="47cd" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">角度材料以标准表格格式显示数据。我们可以根据我们的项目定制表的外观和感觉。下面的模板是材料数据表的一个例子。如果你看到这里我们使用的是<code class="fe ne nf ng nh b">&lt;ng-container&gt; </code><strong class="jp ir"/><code class="fe ne nf ng nh b"><strong class="jp ir">&lt;ng-container&gt;</strong></code><strong class="jp ir">是一个分组元素，它不会干扰样式或布局，因为<em class="km"> Angular没有把它放在DOM </em> </strong>中。<code class="fe ne nf ng nh b">matColumnDef</code>用<code class="fe ne nf ng nh b">&lt;ng-container&gt;</code>包装，这将给它元素的顺序和描述。dataSource用于数据的值。<code class="fe ne nf ng nh b">matColumnDef </code>是列定义的必填字段。<code class="fe ne nf ng nh b">matColumnDef </code>应该总是与我们正在渲染的元素相同。即，在第二列中，如果<code class="fe ne nf ng nh b">matColumnDef </code>是产品名称，那么<code class="fe ne nf ng nh b">matCellDef </code>元素应该是{element.productName}}。<strong class="jp ir"> <em class="km">如果上述名称不同，那么在对列进行排序时会产生问题。</em> </strong></p><h2 id="b58a" class="ms la iq bd lb mt mu dn lf mv mw dp lj jy mx my ln kc mz na lr kg nb nc lv nd bi translated">2.<strong class="ak">创建组件:</strong></h2><p id="5994" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">第二步是创建角度材料数据表组件。这里我有导入的产品，来自Product.ts文件的产品。这将定义数据表的类型和值。接下来，定义displayedColumns。displayedColumns是一种字符串数组。您可以在这里定义要显示的列。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="ab8f" class="ms la iq nh b gy nm nn l no np">displayedColumns: string[] = [‘productName’, ‘productCode’, ‘prodRating’, ‘edit’, ‘delete’];</span></pre><p id="2502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们导出产品类型和产品数据。将MatPaginator和MatSort定义为ViewChild引用。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="c61a" class="ms la iq nh b gy nm nn l no np">products:Product[]= products;</span><span id="60cc" class="ms la iq nh b gy nq nn l no np">dataSource = new MatTableDataSource(products);</span><span id="5040" class="ms la iq nh b gy nq nn l no np">@ViewChild(MatPaginator,{static:false}) paginator: MatPaginator;</span><span id="e6e8" class="ms la iq nh b gy nq nn l no np">@ViewChild(MatSort, {static:false}) sort: MatSort;</span></pre><p id="3189" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km">由于我们将MatPaginator和MatSort定义为ViewChild，我们必须在ngAfterViewInit生命周期钩子</em> </strong>中初始化它。在视图初始化之后设置排序，因为组件将能够查询它的视图来初始化排序。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="6775" class="ms la iq nh b gy nm nn l no np">ngAfterViewInit() {</span><span id="f7ed" class="ms la iq nh b gy nq nn l no np">this.dataSource.paginator = this.paginator;</span><span id="24c7" class="ms la iq nh b gy nq nn l no np">this.dataSource.sort = this.sort;</span><span id="350d" class="ms la iq nh b gy nq nn l no np">}</span></pre><p id="ac6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的组件将如下所示:</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="7ea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呈现后的页面如下所示:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nr"><img src="../Images/1c5f177c9ac2a4cee5dc65278e11c34a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_URvyeOUZhL89dJeuRRag.png"/></div></div></figure><h2 id="2b95" class="ms la iq bd lb mt mu dn lf mv mw dp lj jy mx my ln kc mz na lr kg nb nc lv nd bi translated">3.<strong class="ak"> CSS和样式:</strong></h2><p id="79d5" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">现在我们可以看到我们的数据表看起来有点原始。我们可以看到编辑和删除按钮列太大。现在先导入棱角分明的材质主题。主题可以在组件css文件中导出。<strong class="jp ir">但是导入文件最好的地方是angular.json风格。</strong></p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="42f5" class="ms la iq nh b gy nm nn l no np">“styles”: [</span><span id="5ec7" class="ms la iq nh b gy nq nn l no np"><strong class="nh ir">“../node_modules/@angular/material/prebuilt-themes/deeppurple-amber.css”</strong></span><span id="ff20" class="ms la iq nh b gy nq nn l no np">"../node_modules/primeng/resources/primeng.min.css",</span><span id="ef35" class="ms la iq nh b gy nq nn l no np">]</span></pre><p id="e72a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在组件中导入这样的css文件:</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="ecb5" class="ms la iq nh b gy nm nn l no np">@import ‘~@angular/material/prebuilt-themes/deeppurple-amber.css’;</span><span id="1e5e" class="ms la iq nh b gy nq nn l no np">@import ‘~material-design-icons/iconfont/material-icons.css’;</span></pre><p id="efb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的css是这样的。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="8060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们在前面的截图中看到的，编辑和删除列看起来很大。但由于这些只是一个图标，所以应该很小。也就是说，我想让它变成40 px，然后使用<em class="km">mat-header-cell:n-child</em>序列我们可以做到这一点。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="955c" class="ms la iq nh b gy nm nn l no np">.mat-cell:nth-child(4),</span><span id="d08d" class="ms la iq nh b gy nq nn l no np">.mat-header-cell:nth-child(4) {</span><span id="10fe" class="ms la iq nh b gy nq nn l no np">flex: 0 0 40px;</span><span id="c556" class="ms la iq nh b gy nq nn l no np">}</span><span id="23c7" class="ms la iq nh b gy nq nn l no np">.mat-cell:nth-child(5),</span><span id="f040" class="ms la iq nh b gy nq nn l no np">.mat-header-cell:nth-child(5) {</span><span id="671a" class="ms la iq nh b gy nq nn l no np">flex: 0 0 40px;</span><span id="ae7b" class="ms la iq nh b gy nq nn l no np">}</span></pre><p id="7973" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用css后的页面看起来像下面的截图。现在你可以看到编辑，删除列很小。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ns"><img src="../Images/38e5e6cd5cafad43bfe13b7a7de2e51c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F3KvqYH-5-O_g7t8-PwUfg.png"/></div></div></figure><h2 id="9bac" class="ms la iq bd lb mt mu dn lf mv mw dp lj jy mx my ln kc mz na lr kg nb nc lv nd bi translated">4.<strong class="ak">过滤材料表:</strong></h2><p id="f1dd" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">过滤是任何表格中非常重要的一部分。我们可以创建一个简单的搜索功能，从产品列表中搜索产品。为此，创建一个输入控件，它是mat输入文本。现在，我更喜欢焦点上的过滤器，所以当用户结束编写过滤器和焦点，然后我们将从数据存储搜索。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="76fc" class="ms la iq nh b gy nm nn l no np">&lt;mat-form-field&gt;</span><span id="d84a" class="ms la iq nh b gy nq nn l no np">&lt;mat-label&gt;Filter Product&lt;/mat-label&gt;</span><span id="e879" class="ms la iq nh b gy nq nn l no np">&lt;input matInput type="text" [(ngModel)]="filterValue"</span><span id="3871" class="ms la iq nh b gy nq nn l no np">(blur)="filterProduct(filterValue)" placeholder="Search product name"&gt;</span><span id="20e5" class="ms la iq nh b gy nq nn l no np">&lt;/mat-form-field&gt;</span></pre><p id="8e54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，当您编写上述代码时，您可能会得到未知模式的错误。所以你必须导入mat输入模块。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="5fd2" class="ms la iq nh b gy nm nn l no np">import {MatInputModule} from ‘@angular/material/input’;</span></pre><p id="3e26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在组件中，您可以根据输入的任何产品名称进行过滤。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="afd7" class="ms la iq nh b gy nm nn l no np">public filterProduct = (value: string) =&gt; {</span><span id="d721" class="ms la iq nh b gy nq nn l no np">this.dataSource.filter = value;</span><span id="3dd5" class="ms la iq nh b gy nq nn l no np">}</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nt"><img src="../Images/279e7835ffc6048b4c71f170fb1548af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDMUZS4olcaMx-2ERWFx_w.png"/></div></div></figure><h2 id="d030" class="ms la iq bd lb mt mu dn lf mv mw dp lj jy mx my ln kc mz na lr kg nb nc lv nd bi translated"><strong class="ak"> 5。服务器端过滤器:</strong></h2><p id="99f5" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">类似于第4点，我们可以实现服务器端过滤，搜索所有数据。当我们处理大量数据时，它非常有效。导入MatProgressSpinnerModule并添加根组件。添加一个异步加载，如下所示:</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="4a0d" class="ms la iq nh b gy nm nn l no np">//Add MatProgressSpinnerModule in root component import<br/>import {MatProgressSpinnerModule} from ‘@angular/material/progress-spinner’;</span><span id="9e87" class="ms la iq nh b gy nq nn l no np">//Write async method in </span><span id="878b" class="ms la iq nh b gy nq nn l no np">&lt;div class=”spinner-container” *ngIf=”dataSource.loading$ | async”&gt;</span><span id="e143" class="ms la iq nh b gy nq nn l no np">&lt;mat-spinner&gt;&lt;/mat-spinner&gt;</span><span id="e8e4" class="ms la iq nh b gy nq nn l no np">&lt;/div&gt;</span></pre><p id="e27a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在一旦API搜索了产品页面大小和产品？。长度将被设置为产品计数。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="761c" class="ms la iq nh b gy nm nn l no np">&lt;mat-paginator [length]=”products?.length” [pageSize]=”{{pageSize}}" [pageSizeOptions]=”[5, 10, 15]”&gt;&lt;/mat-paginator&gt;</span></pre><p id="eb81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">调用API获取搜索到的数据。另外，设置pageSize属性。</p><pre class="ko kp kq kr gt ni nh nj nk aw nl bi"><span id="328d" class="ms la iq nh b gy nm nn l no np">filterProduct(value: string):void{</span><span id="c3c6" class="ms la iq nh b gy nq nn l no np">this.serviceAPI.getDataByFilter(value).subscribe(response =&gt;</span><span id="377d" class="ms la iq nh b gy nq nn l no np">{</span><span id="8cfd" class="ms la iq nh b gy nq nn l no np">this.dataSource= response[‘products’];<br/>//Set page index<br/>//Enable disable next button here<br/>//this.pageSize</span><span id="1486" class="ms la iq nh b gy nq nn l no np">});</span><span id="8be0" class="ms la iq nh b gy nq nn l no np">}</span></pre><h2 id="25e5" class="ms la iq bd lb mt mu dn lf mv mw dp lj jy mx my ln kc mz na lr kg nb nc lv nd bi translated">结论:</h2><p id="9427" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">这是最后的手段。我们已经开始从手工制作html到创建具有功能的数据表。我们讨论了以下几点:</p><ul class=""><li id="3d47" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated">创建的材料数据表模板，组件</li><li id="b186" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">讨论了CSS和样式数据表</li><li id="9761" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">实现材料表排序和分页</li><li id="43c2" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">从数据源实现过滤器</li><li id="9f98" class="mc md iq jp b jq ml ju mm jy mn kc mo kg mp kk mh mi mj mk bi translated">服务器端过滤和分页</li></ul><p id="7938" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">附上stackblitz代码以供参考。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="nu mr l"/></div></figure><p id="50b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查原始数据表并实现服务器端分页。</p><div class="nv nw gp gr nx ny"><a href="https://medium.com/@codingindepth/server-side-pagination-using-ng-prime-data-table-in-angular-5ffb082da138" rel="noopener follow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">Angular中使用NG Prime数据表的服务器端分页</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">web技术栈中的大多数项目都使用客户端分页。在大多数有角的、有反应的入口…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kx ny"/></div></div></a></div><p id="83a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢，祝阅读愉快！</p></div></div>    
</body>
</html>