<html>
<head>
<title>Nuxt.js — Error Handling and Plugins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Nuxt.js —错误处理和插件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/nuxt-js-error-handling-and-plugins-4695d6519684?source=collection_archive---------6-----------------------#2020-12-27">https://javascript.plainenglish.io/nuxt-js-error-handling-and-plugins-4695d6519684?source=collection_archive---------6-----------------------#2020-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a55652287fda7265bdf3cb4552700607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NOX6jM94cv-K2LH3"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Winkler</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0c44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Nuxt.js是一个基于Vue.js的应用框架。</p><p id="28fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它来创建服务器端渲染应用和静态站点。</p><p id="392c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Nuxt.js处理异步数据错误和插件。</p><h1 id="4483" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">处理错误</h1><p id="67ef" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们得到异步数据时，我们可以处理页面中的错误。</p><p id="4cbd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="deed" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div&gt;{{ title }}&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="2d51" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>import axios from "axios";</span><span id="cc4e" class="mn lc iq mj b gy ms mp l mq mr">export default {<br/>  async asyncData({ params, error }) {<br/>    try {<br/>      const { data } = await axios.get(<br/>        `https://jsonplaceholder.typicode.com/posts/${params.id}`<br/>      );<br/>      return { title: data.title };<br/>    } catch {<br/>      error({ statusCode: 404, message: "Post not found" });<br/>    }<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="fd72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个带有对象的<code class="fe mt mu mv mj b">asyncData</code>方法，该对象具有<code class="fe mt mu mv mj b">error</code>属性。</p><p id="3ddb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">error</code>是一个我们可以用来渲染误差的函数。</p><h1 id="842e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">资产</h1><p id="f514" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Nuxt使用vue加载器、文件加载器和url加载器Webpack加载器进行资产服务。</p><p id="6529" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以将<code class="fe mt mu mv mj b">static</code>文件夹用于静态资产。</p><p id="94ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要添加资产，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9cdb" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;img src="~/assets/kitten.jpg" /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="e0f8" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {};<br/>&lt;/script&gt;</span></pre><p id="299f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">~</code>是Nuxt根文件夹的简写。</p><h1 id="7f5c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">静态</h1><p id="ddb2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以提供<code class="fe mt mu mv mj b">static</code>文件夹中的资产。</p><p id="4415" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以将文件移动到<code class="fe mt mu mv mj b">static</code>文件夹中，并写下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="54bb" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;img src="/kitten.jpg" /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="cc52" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {};<br/>&lt;/script&gt;</span></pre><p id="c964" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">/</code>是<code class="fe mt mu mv mj b">static </code>文件夹的简写。</p><h1 id="11db" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">插件</h1><p id="7724" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在应用程序中添加插件。</p><p id="c544" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们可能是像Axios这样的外部包。</p><p id="58d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者我们可以使用Vue插件。</p><p id="4a69" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用Vue插件，我们必须手动添加它们。</p><p id="a557" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们想给我们的应用程序添加一个工具提示，我们通过运行以下命令来安装<code class="fe mt mu mv mj b">v-tooltip</code>包:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7344" class="mn lc iq mj b gy mo mp l mq mr">npm install --save v-tooltip</span></pre><p id="e96c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建<code class="fe mt mu mv mj b">plugins/vue-tooltip.js</code>并添加:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="328c" class="mn lc iq mj b gy mo mp l mq mr">import Vue from 'vue'<br/>import VTooltip from 'v-tooltip'</span><span id="bb42" class="mn lc iq mj b gy ms mp l mq mr">Vue.use(VTooltip)</span></pre><p id="b2da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe mt mu mv mj b">nuxt.config.js</code>中，我们添加:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fd23" class="mn lc iq mj b gy mo mp l mq mr">plugins: [<br/>  '@/plugins/vue-tooltip.js'<br/>],</span></pre><p id="3cff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以像往常一样使用它，写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="906d" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;button v-tooltip="'hello world'"&gt;hello&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="9ce5" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {};<br/>&lt;/script&gt;</span></pre><h1 id="1f51" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在\$root &amp; context中注入</h1><p id="8cf6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以在所有应用程序中提供功能。</p><p id="b65a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以调用<code class="fe mt mu mv mj b">inject</code>函数。</p><p id="7fe8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过添加<code class="fe mt mu mv mj b">plugins/hello.js</code>来创建自己的插件:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1539" class="mn lc iq mj b gy mo mp l mq mr">export default (context, inject) =&gt; {<br/>  const hello = msg =&gt; console.log(`hello ${msg}!`)<br/>  inject('hello', hello)<br/>}</span></pre><p id="8336" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在<code class="fe mt mu mv mj b">nuxt.config.js</code>中添加我们的插件:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2caf" class="mn lc iq mj b gy mo mp l mq mr">plugins: [<br/>  '@/plugins/hello.js'<br/>],</span></pre><p id="d1f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过编写以下代码来调用我们的<code class="fe mt mu mv mj b">hello</code>函数:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8791" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div class="container"&gt;&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="421b" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {<br/>  mounted() {<br/>    this.$hello("james");<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="f3b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还需要:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3806" class="mn lc iq mj b gy mo mp l mq mr">context.$hello = hello</span></pre><p id="119b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们使用Nuxt 2.12或更早版本导出的函数中。</p><p id="1457" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以通过编写以下代码将<code class="fe mt mu mv mj b">$hello</code>函数与<code class="fe mt mu mv mj b">asyncData</code>函数一起使用:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e32e" class="mn lc iq mj b gy mo mp l mq mr">&lt;template&gt;<br/>  &lt;div class="container"&gt;&lt;/div&gt;<br/>&lt;/template&gt;</span><span id="8389" class="mn lc iq mj b gy ms mp l mq mr">&lt;script&gt;<br/>export default {<br/>  mounted() {<br/>    this.$hello("james");<br/>  },<br/>  asyncData({ $hello }) {<br/>    $hello("asyncData");<br/>  },<br/>};<br/>&lt;/script&gt;</span></pre><p id="5a17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">$hello</code>是<code class="fe mt mu mv mj b">asyncData</code>上下文参数的一部分。</p><h1 id="58fe" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="6f11" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在获得数据时处理错误。</p><p id="e9b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以创建自己的插件和功能，并将其注入我们的应用程序。</p></div></div>    
</body>
</html>