<html>
<head>
<title>How to test Asynchronous action creator functions in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中测试异步动作创建器函数</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-test-asynchronous-action-creator-functions-in-react-793c36cd8643?source=collection_archive---------8-----------------------#2020-05-18">https://javascript.plainenglish.io/how-to-test-asynchronous-action-creator-functions-in-react-793c36cd8643?source=collection_archive---------8-----------------------#2020-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="774c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解使用axios库测试API调用的方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/db87b5440fa652dd0bede3ae7f3718b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qQYv2Siwr5qzcQh1"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@sctgrhm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Scott Graham</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0f4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将学习如何使用<code class="fe ls lt lu lv b">Jest</code>测试异步动作创建器函数。</p><p id="e8b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想学习如何测试你的整个React应用程序以及代码覆盖率和快照测试，查看我以前的文章<a class="ae kv" href="https://medium.com/swlh/react-testing-using-jest-along-with-code-coverage-report-7454b5ba0236" rel="noopener">这里</a></p><p id="a011" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始吧</p><p id="71cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，从这里的<a class="ae kv" href="https://github.com/myogeshchavan97/redux-thunk-demo" rel="noopener ugc nofollow" target="_blank">克隆我们在本文</a>的<br/> <a class="ae kv" href="https://medium.com/javascript-in-plain-english/how-to-integrate-redux-thunk-into-your-react-application-cd92b87c1629" rel="noopener">中创建的</a>存储库代码。</p><p id="9490" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过依次执行以下命令来运行应用程序</p><p id="7320" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.npm安装<br/> 2。npm运行开始</p><p id="e479" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过运行以下命令安装<code class="fe ls lt lu lv b">jest</code></p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="01e2" class="ma mb iq lv b gy mc md l me mf">npm install jest@26.0.1</span></pre><p id="3cec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了测试异步函数，我们将使用<code class="fe ls lt lu lv b">redux-mock-store</code>库。通过执行以下命令来安装它</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="ce07" class="ma mb iq lv b gy mc md l me mf">npm install redux-mock-store@1.5.4</span></pre><p id="f118" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">package.json</code>中添加新脚本</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="0818" class="ma mb iq lv b gy mc md l me mf">"test": "jest"</span></pre><p id="5a82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的<code class="fe ls lt lu lv b">package.json</code>会是这个样子</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/69ec314f575def4f7cfd920a57e04eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kxfgpDRIH9NBWIe_5zLfzQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">package.json</figcaption></figure><p id="d80e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将测试来自<code class="fe ls lt lu lv b">src/actions/users.js </code>文件的<code class="fe ls lt lu lv b">initiateAddUsers</code>函数，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/b7f4b526ae4ea21b716071e5af23f9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZPMqxhEyja-zqy-NaAUgg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Action</figcaption></figure><p id="c7a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">src</code>文件夹和<code class="fe ls lt lu lv b">tests</code>文件夹内创建一个新的<code class="fe ls lt lu lv b">tests</code>文件夹，在<code class="fe ls lt lu lv b">actions</code>文件夹内创建<code class="fe ls lt lu lv b">users.test.js</code>文件。</p><p id="c5d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入文件顶部的<code class="fe ls lt lu lv b">initiateAddUsers</code>函数导入。此外，从<code class="fe ls lt lu lv b">redux-mock-store</code>库导入<code class="fe ls lt lu lv b">configureStore</code>并提供我们在应用程序中使用的<code class="fe ls lt lu lv b">thunk</code>中间件。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="51fb" class="ma mb iq lv b gy mc md l me mf">import { initiateAddUsers } from '../../actions/users';<br/>import configureStore from 'redux-mock-store';<br/>import thunk from 'redux-thunk';</span><span id="32e2" class="ma mb iq lv b gy mi md l me mf">const mockStore = configureStore([thunk]);</span><span id="f8c3" class="ma mb iq lv b gy mi md l me mf">test('should test for initiateAddUsers action generator', () =&gt; {<br/>  const store = mockStore([]);<br/>  store.dispatch(initiateAddUsers());<br/>});</span></pre><p id="a50c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，我们通过传递一个空数组<code class="fe ls lt lu lv b">[]</code>作为初始存储状态来调用<code class="fe ls lt lu lv b">mockStore</code>函数。</p><p id="e703" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">mockStore</code>函数返回一个存储，我们可以用它来调度我们的动作。</p><p id="0f0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，通过从终端执行以下命令来运行测试文件</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="b6e8" class="ma mb iq lv b gy mc md l me mf">npm test</span></pre><p id="2ac5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将看到如下所示的输出</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mj"><img src="../Images/2ab3fe8c256dfa8cde60eee63baa4a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OAcZu7TB0t04deqL4zOA8A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Passed test</figcaption></figure><p id="5775" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了实际验证<code class="fe ls lt lu lv b">addUsers</code>动作被分派并且<code class="fe ls lt lu lv b">redux</code>存储被更新，我们需要对代码进行一些修改。</p><p id="4048" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">打开<code class="fe ls lt lu lv b">src/actions/users.js</code>，在<code class="fe ls lt lu lv b">axios.get</code>前和<code class="fe ls lt lu lv b">dispatch</code>调用前添加<code class="fe ls lt lu lv b">return</code>关键字</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="42d9" class="ma mb iq lv b gy mc md l me mf">export const initiateAddUsers = () =&gt; {<br/>  return (dispatch) =&gt; {<br/>    <strong class="lv ir">return</strong> axios.get('/users').then((response) =&gt; {<br/>      console.log(response.data);<br/>      <strong class="lv ir">return</strong> dispatch(addUsers(response.data.results));<br/>    });<br/>  };<br/>};</span></pre><p id="4afc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一种允许承诺链接的方式，所以我们添加了<code class="fe ls lt lu lv b">return</code>语句。通过这样做，我们可以将<code class="fe ls lt lu lv b">.then</code>调用再次附加到从<code class="fe ls lt lu lv b">initiateAddUsers</code>函数调用返回的任何内容上。</p><blockquote class="mk ml mm"><p id="b53e" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">注意:您应该在react代码中做更少的修改，以使它与您的测试一起工作。此外，如果您在react代码中做了任何更改，您应该再次测试您的应用程序，以验证应用程序没有被破坏。</p></blockquote><p id="a602" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们刚刚添加了<code class="fe ls lt lu lv b">return</code>关键字，这不会在应用程序中引起任何问题。</p><p id="a9a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在在测试文件中附上<code class="fe ls lt lu lv b">.then</code>调用</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="911d" class="ma mb iq lv b gy mc md l me mf">test('should test for initiateAddUsers action generator', () =&gt; {<br/>  const store = mockStore([]);<br/>  store<br/>    .dispatch(initiateAddUsers())<br/>    <strong class="lv ir">.then((response) =&gt; console.log('response', response));</strong><br/>});</span></pre><p id="6e52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再次运行<code class="fe ls lt lu lv b">npm test</code>命令并检查输出</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/b210b1fbfc16027810c7bf215b78338c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*os4DdSZoXln2dmPHjJJAwg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">passed test</figcaption></figure><p id="0ded" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，测试通过了，但是<code class="fe ls lt lu lv b">users</code>属性值在打印的<code class="fe ls lt lu lv b">console.log</code>中显示为<code class="fe ls lt lu lv b">undefined</code></p><p id="e8a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在测试中，我们从不发出实际的API请求，而是通过传递一些测试数据来模拟它，以查看API是否被实际调用。所以我们需要模拟<code class="fe ls lt lu lv b">axios</code> API调用。</p><p id="60c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，在<code class="fe ls lt lu lv b">test</code>文件夹中创建一个名为<code class="fe ls lt lu lv b">__mocks__</code>的新文件夹(<strong class="ky ir">注</strong>:在<code class="fe ls lt lu lv b">mocks</code>前后有两个下划线)。</p><p id="4e40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个文件夹将包含我们所有的手动模拟。</p><p id="5993" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">__mocks__</code>文件夹中创建一个名为<code class="fe ls lt lu lv b">axios.js</code>的新文件。因此，当我们在测试文件中导入<code class="fe ls lt lu lv b">axios</code>时，它将执行来自我们自己的<code class="fe ls lt lu lv b">axios.js</code>而不是实际的<code class="fe ls lt lu lv b">axios</code>库的代码。所以名字还得是<code class="fe ls lt lu lv b">axios</code>。射流研究…</p><p id="806d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们在操作中使用了<code class="fe ls lt lu lv b">axios.get</code>，所以我们将只模仿<code class="fe ls lt lu lv b">get</code> API。</p><p id="b671" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">axios.js</code>文件中添加以下代码</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="12af" class="ma mb iq lv b gy mc md l me mf">export default {<br/>  get: jest.fn(() =&gt;<br/>    Promise.resolve({<br/>      data: {}<br/>    })<br/>  )<br/>};</span></pre><p id="1c37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们以如下方式导入<code class="fe ls lt lu lv b">axios</code></p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="d525" class="ma mb iq lv b gy mc md l me mf">import axios from 'axios';</span></pre><p id="8b9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">axios</code>是一个<code class="fe ls lt lu lv b">default export</code>，因为<code class="fe ls lt lu lv b">axios</code>关键字周围没有像<code class="fe ls lt lu lv b">{ axios }</code>一样的花括号，所以我们在<code class="fe ls lt lu lv b">axios.js.</code>中添加了自己的默认导出</p><p id="115f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个文件中，我们添加了一个<code class="fe ls lt lu lv b">get</code>属性，并使用<code class="fe ls lt lu lv b">jest.fn() </code>函数来创建一个模拟函数。</p><p id="d4d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所知，<code class="fe ls lt lu lv b">axios</code>库返回的数据将可以使用<code class="fe ls lt lu lv b">.data</code>属性，我们已经创建了一个承诺，它将解析为一个具有空<code class="fe ls lt lu lv b">data</code>属性的对象</p><p id="74a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，在<code class="fe ls lt lu lv b">users.test.js</code>中为<code class="fe ls lt lu lv b">axios</code>添加导入，我们将覆盖<code class="fe ls lt lu lv b">axios.get</code>函数实现来传递我们的测试数据。</p><p id="48e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里是完整的源代码</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="d243" class="ma mb iq lv b gy mc md l me mf">import { initiateAddUsers } from '../../actions/users';<br/>import configureStore from 'redux-mock-store';<br/>import thunk from 'redux-thunk';<br/>import axios from 'axios';<br/><br/>const mockStore = configureStore([thunk]);<br/>const usersTestData = [<br/>  {<br/>    gender: 'female',<br/>    name: {<br/>      title: 'Miss',<br/>      first: 'Molly',<br/>      last: 'Lewis'<br/>    },<br/>    location: {<br/>      city: 'New York'<br/>    }<br/>  }<br/>];<br/><br/>axios.get.mockImplementationOnce(() =&gt;<br/>  Promise.resolve({<br/>    data: {<br/>      results: usersTestData<br/>    }<br/>  })<br/>);<br/><br/>test('should test for initiateAddUsers action generator', () =&gt; {<br/>  const store = mockStore([]);<br/>  store<br/>    .dispatch(initiateAddUsers())<br/>    .then((response) =&gt; console.log('response', response));<br/>});</span></pre><p id="6d98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们已经创建了一个测试数据，当我们从应用程序中调用<code class="fe ls lt lu lv b"> /users</code> API时，它的格式由<code class="fe ls lt lu lv b">/users</code> API返回。</p><p id="390f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Jest提供了一个<code class="fe ls lt lu lv b">.mockImplementationOnce</code>函数，我们已经在<code class="fe ls lt lu lv b">jest.fn </code>函数上使用它来覆盖来自<code class="fe ls lt lu lv b">__mocks__/axios.js</code>文件的实现。</p><p id="d533" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果您通过运行<code class="fe ls lt lu lv b">npm test</code>命令再次运行测试，您将看到以下输出</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/0b37f22dd25dd8e37f4f39ea549f631c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G5r-URl0lE4PLZhlx13idw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">test output</figcaption></figure><p id="e085" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，第一个<code class="fe ls lt lu lv b">console.log</code>来自于<code class="fe ls lt lu lv b">actions/users.js</code>文件中的<code class="fe ls lt lu lv b">console.log</code>。</p><p id="4862" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试文件中的主日志是第二个</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/6a74290c3bea8d5fdceabd45c84128e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aKa_c99RmdkhQx-q6rbL-Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">test output log</figcaption></figure><p id="88a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，现在我们得到了实际的<code class="fe ls lt lu lv b">users</code>对象，而不是<code class="fe ls lt lu lv b">undefined</code></p><p id="8915" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">redux-mock-stor</code> e提供了一个<code class="fe ls lt lu lv b">getActions</code>函数来调度所有的动作。</p><p id="25cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用jest提供的<code class="fe ls lt lu lv b">expect</code>函数来进行断言。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="9cc8" class="ma mb iq lv b gy mc md l me mf">test('should test for initiateAddUsers action generator', () =&gt; {<br/>  const store = mockStore([]);<br/>  store.dispatch(initiateAddUsers()).then(() =&gt; {<br/>    const action = store.getActions()[0];</span><span id="7d43" class="ma mb iq lv b gy mi md l me mf">    <strong class="lv ir">expect(action.type).toBe('ADD_USERS');<br/>    expect(action.users).toEqual(usersTestData);</strong><br/>  });<br/>});</span></pre><p id="a074" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们在<code class="fe ls lt lu lv b">initiateAddUsers</code>函数中只有一个调度调用，所以只有一个可用的动作可以使用<code class="fe ls lt lu lv b">store.getActions()[0].</code>来访问</p><p id="4631" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果您再次运行测试，您可以看到所有的<code class="fe ls lt lu lv b">expect</code>检查都是成功的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/184710c83dcd9d97ad02d1b6cda09d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QBqJPRPnF6HXKy0Bb6FaOg.png"/></div></div></figure><p id="cf44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里找到这篇文章<a class="ae kv" href="https://github.com/myogeshchavan97/async-actions-test" rel="noopener ugc nofollow" target="_blank">的完整源代码</a></p><p id="2f21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天到此为止。我希望你学到了新东西。</p><p id="c491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要忘记订阅我的每周时事通讯，里面有惊人的技巧、诀窍和文章，直接在你的收件箱 <a class="ae kv" href="https://yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里。</strong> </a></p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h2 id="1698" class="ma mb iq bd nc nd ne dn nf ng nh dp ni lf nj nk nl lj nm nn no ln np nq nr ns bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="a31e" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kv" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="ky ir">JavaScript in Plain English</strong></a><a class="ae kv" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="ky ir">AI in Plain English</strong></a><a class="ae kv" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="ky ir">UX in Plain English</strong></a><a class="ae kv" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="ky ir">Python in Plain English</strong></a><strong class="ky ir"/>—谢谢，继续学习！</p><p id="f95c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还推出了一个YouTube，希望你能通过<a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">订阅我们的简明英语频道</strong> </a>来支持我们</p><p id="8e74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一如既往,“简明英语”希望帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kv" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">submissions @ plain English . io</strong></a><strong class="ky ir"/>，并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>