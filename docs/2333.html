<html>
<head>
<title>Publishing private npm packages using GitHub Packages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GitHub包发布私有npm包</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/publishing-private-npm-packages-using-github-packages-415993cd2da8?source=collection_archive---------0-----------------------#2020-06-14">https://javascript.plainenglish.io/publishing-private-npm-packages-using-github-packages-415993cd2da8?source=collection_archive---------0-----------------------#2020-06-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8d6e3ec399dc48a7124b498eb298a408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xSPPRrvDQZw7Nm_kDZl6ig.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pixabay</a> from <a class="ae kc" href="https://www.pexels.com/photo/business-cargo-cargo-container-city-262353/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="7546" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将介绍如何使用GitHub包来发布您的npm包。如果您不熟悉GitHub包，它允许您将npm、gem或NuGet包发布到它们的注册表中，这里仅举几个例子。</p><h2 id="4e41" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">首先，你需要一个访问令牌…</h2><p id="c2af" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">你需要生成一个个人访问令牌。这个令牌将允许您使用GitHub的API进行身份验证，并发布您的包。要创建一个，您必须前往<em class="lz">设置/开发者设置/个人访问令牌</em>。在这里你必须点击<em class="lz">生成新的令牌</em>。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="ab gu cl me"><img src="../Images/0bd747afdc62a8f5acba64cbdfee3bf3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*cVayfflcmZKikMASLSI2cQ.png"/></div></figure><p id="7d6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在新的个人访问令牌屏幕中，您必须选择<em class="lz"> repo </em>、<em class="lz"> write:packages、</em>和<em class="lz"> read:packages </em>的范围。确保添加注释，以便您知道该令牌的用途，并点击底部的<em class="lz">生成令牌</em>按钮。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="ab gu cl me"><img src="../Images/bcc2e9dd79698a98b4a953f7b3750ce3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*GcEtz_2dtRLxHKjCQiWbhA.png"/></div></figure><p id="b82d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lz">重要提示</em>:请务必将此令牌保存在安全的地方，因为您稍后会需要此令牌。成功生成令牌后，您需要在存储库中创建一个秘密。为此，请访问您在GitHub上的存储库，然后进入<em class="lz">设置/秘密、</em>并点击<em class="lz">新秘密</em>。</p><p id="5a32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于名称，在value字段中输入<code class="fe mf mg mh mi b">NPM_AUTH_TOKEN</code>和，然后粘贴您生成的令牌的值。</p><h2 id="1371" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">更新您的package.json</h2><p id="9b9c" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">现在，您需要对存储库上的package.json进行一些更改，以便可以发布您的库。首先，您必须更改您的包的名称，将您的用户名或您的组织的名称作为作用域，后跟包的名称。例如，如果你的用户名是<em class="lz"> your_username </em>并且你的项目名是<em class="lz"> your_project_name </em>，你将最终把包的名称改为如下。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="190e" class="lb lc iq mi b gy mn mo l mp mq">"name": "@your_username/your_project_name"</span></pre><p id="a4c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，您必须指定您要将软件包发布到哪个注册表。您必须添加此条目，并用您的用户名或组织名称替换<em class="lz">您的用户名</em>。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="4704" class="lb lc iq mi b gy mn mo l mp mq">"publishConfig": {<br/>  "registry": "https://npm.pkg.github.com/your_username"<br/>}</span></pre><p id="f31d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，如果您的项目在monorepo中，您将必须添加这个条目，这样您就可以在同一个存储库中发布多个包。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="b93b" class="lb lc iq mi b gy mn mo l mp mq">"repository": {<br/>  "type": "git",<br/>  "url": "ssh://git@github.com:your_username/your_project_name.git",<br/>  "directory": "@your_username/your_project_name"<br/>}</span></pre><h2 id="423e" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">包访问</h2><p id="7fff" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">到目前为止，默认情况下GitHub包从您的存储库中继承访问权限。鉴于此，只要您的存储库是私有的，您的包也将是私有的。如果您在package.json中保留private:true属性，就会出现问题。您可以删除该属性，因为它不允许您用它发布您的包。</p><h2 id="68e3" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">现在…npmrc</h2><p id="bd7d" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">下一步将是创建一个名为. npmrc的文件。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="2ee5" class="lb lc iq mi b gy mn mo l mp mq">registry=https://npm.pkg.github.com/@your_username<br/>registry=https://registry.npmjs.org</span></pre><p id="632b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从您的工作站发布您的包首先，您需要登录到您工作站上的GitHub包注册表。为此，您可以运行以下npm命令。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="f56c" class="lb lc iq mi b gy mn mo l mp mq">npm login —registry=https://npm.pkg.github.com —scope=@your_username</span></pre><p id="2b97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦您运行这个命令，它将要求您输入用户名、密码和电子邮件。确保使用您之前生成的访问令牌作为密码。经过身份验证后，转到项目的dist文件夹并运行npm publish。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="0737" class="lb lc iq mi b gy mn mo l mp mq">cd dist<br/>npm publish</span></pre><h2 id="d9f7" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">安装您的软件包</h2><p id="fff8" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">要使用您的软件包，您必须添加相同的。将您添加到发布库项目的npmrc文件添加到您的消费项目。除此之外，您还需要运行如下所示的npm安装命令。</p><pre class="ma mb mc md gt mj mi mk ml aw mm bi"><span id="e161" class="lb lc iq mi b gy mn mo l mp mq">npm install @your_username/your_project_name@version</span></pre><p id="fc8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一点上，你应该都准备好了！尽情享受吧！</p><h2 id="3b4a" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">需要记住的事情</h2><p id="ca95" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">生活中没有什么是免费的。虽然GitHub软件包的价格相当慷慨，但一定要留意这一点，并在必要时设定支出限额。</p><h2 id="6a74" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">简单英语的JavaScript</h2><p id="0da3" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>