<html>
<head>
<title>Increasing promise performance with pending-promise-recycler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é€šè¿‡å¾…å®šæ‰¿è¯ºå›æ”¶å™¨æé«˜æ‰¿è¯ºç»©æ•ˆ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/increasing-promise-performance-with-pending-promise-recycler-52fe6e65d545?source=collection_archive---------12-----------------------#2020-10-21">https://javascript.plainenglish.io/increasing-promise-performance-with-pending-promise-recycler-52fe6e65d545?source=collection_archive---------12-----------------------#2020-10-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="bace" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">JavaScriptä¸­æœ€å¿«çš„æ‰¿è¯ºæ˜¯å·²ç»è§£å†³çš„æ‰¿è¯ºï¼</h2></div><p id="0bb4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">npmåŒ…<a class="ae ky" href="http://npmjs.com/package/pending-promise-recycler" rel="noopener ugc nofollow" target="_blank">æœªå†³æ‰¿è¯ºå›æ”¶å™¨</a>è·Ÿè¸ªå¤„äºæœªå†³çŠ¶æ€çš„æ‰¿è¯ºï¼›è¿™æ„å‘³ç€å°šæœªå…‘ç°çš„æ‰¿è¯ºã€‚</p><p id="020b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æœæœ‰äººè¯•å›¾åˆ›å»ºè¿™äº›å¾…å®šæ‰¿è¯ºä¹‹ä¸€çš„æ–°å®ä¾‹ï¼Œå¾…å®šæ‰¿è¯ºå›æ”¶å™¨å°†<strong class="ke io">é‡ç”¨å½“å‰å¾…å®šçš„<strong class="ke io">è€Œä¸æ˜¯ä¸å¿…è¦åœ°åˆ›å»ºä¸€ä¸ªé‡å¤çš„</strong>ã€‚</strong></p><h1 id="1a3b" class="kz la in bd lb lc ld le lf lg lh li lj jt lk ju ll jw lm jx ln jz lo ka lp lq bi translated">å¦‚ä½•ä½¿ç”¨å¾…å®šæ‰¿è¯ºå›æ”¶å™¨ï¼Ÿ</h1><p id="981e" class="pw-post-body-paragraph kc kd in ke b kf lr jo kh ki ls jr kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">ç®€å•åœ°ç”¨pending-promise-recycleråŒ…è£…ä»»ä½•è¿”å›æ‰¿è¯ºçš„å‡½æ•°:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="2e7c" class="mf la in mb b gy mg mh l mi mj">const <strong class="mb io">recycle</strong> = require('pending-promise-recycler');</span><span id="aaad" class="mf la in mb b gy mk mh l mi mj">const func = () =&gt; { return Promise.resolve(); }<br/>const <em class="ml">recycledFunc</em> = <strong class="mb io">recycle</strong>(func);</span><span id="a401" class="mf la in mb b gy mk mh l mi mj"><em class="ml">recycledFunc</em>().then(...);</span></pre><p id="a160" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">å¯¹</strong> <code class="fe mm mn mo mb b"><strong class="ke io">recycledFunc</strong></code> <strong class="ke io">çš„ä»»ä½•é¢å¤–è°ƒç”¨åœ¨å®ƒä»å¤„äºæŒ‚èµ·çŠ¶æ€æ—¶ä¸ä¼šå¯¼è‡´å¯¹</strong> <code class="fe mm mn mo mb b"><strong class="ke io">func</strong></code>çš„é¢å¤–è°ƒç”¨ï¼›ç›¸åï¼Œæœªå†³æ‰¿è¯ºå°†è¢«å›æ”¶å¹¶åœ¨ä»»ä½•åç»­è°ƒç”¨ä¸­å†æ¬¡ä½¿ç”¨ã€‚</p><h1 id="336a" class="kz la in bd lb lc ld le lf lg lh li lj jt lk ju ll jw lm jx ln jz lo ka lp lq bi translated">å¿«é€Ÿåº”ç”¨ç¨‹åºçš„å®é™…ä¾‹å­</h1><p id="fa39" class="pw-post-body-paragraph kc kd in ke b kf lr jo kh ki ls jr kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´ç°å®çš„ä¾‹å­ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†ä¸€ä¸ªç®€å•çš„expressæœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨å¸¦æœ‰ä¸€ä¸ªè°ƒç”¨éå¸¸æ…¢ä¸”æ˜‚è´µçš„å‡½æ•°çš„ç«¯ç‚¹:</p><figure class="lw lx ly lz gt mp"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f39c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æœæˆ‘ä»¬è°ƒç”¨è¿™ä¸ªç«¯ç‚¹ï¼Œå‡½æ•°<code class="fe mm mn mo mb b">someSlowAndExpensiveOperation</code>å°†è¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="8ce2" class="mf la in mb b gy mg mh l mi mj">ğŸ• node index.js &amp;<br/>[1] 81740<br/>Express server up and running!</span><span id="7573" class="mf la in mb b gy mk mh l mi mj">âœ¦ ğŸ• curl <a class="ae ky" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a><br/>Starting a very slow operation!<br/>Slow operation is over!<br/>{"foo":"bar"}<br/>Request: 1517.251ms</span></pre><p id="ae50" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä½†æ˜¯å¦‚æœæˆ‘ä»¬åŒæ—¶å‘å‡º10ï¼Œ000ä¸ªå‘¼å«ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‘¼å«<code class="fe mm mn mo mb b">someSlowAndExpensiveOperation</code> 10ï¼Œ000æ¬¡ï¼å³ä½¿æˆ‘ä»¬ç¼“å­˜äº†æ“ä½œçš„ç¬¬ä¸€ä¸ªå“åº”ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šè°ƒç”¨<code class="fe mm mn mo mb b">func</code> 10ï¼Œ000æ¬¡ï¼Œå› ä¸ºåœ¨ç¬¬äºŒä¸ªè¯·æ±‚åˆ°è¾¾æ—¶ï¼Œç¼“å­˜çš„å“åº”è¿˜æ²¡æœ‰å‡ºç°ï¼</p><h2 id="317d" class="mf la in bd lb ms mt dn lf mu mv dp lj kl mw mx ll kp my mz ln kt na nb lp nc bi translated">ä½¿ç”¨å¾…å®šæ‰¿è¯ºå›æ”¶å™¨æ”¹è¿›æˆ‘ä»¬çš„å¿«é€’åº”ç”¨ç¨‹åº</h2><p id="0b53" class="pw-post-body-paragraph kc kd in ke b kf lr jo kh ki ls jr kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">å¦‚æœæˆ‘ä»¬å›æ”¶<code class="fe mm mn mo mb b">someSlowAndExpensiveOperation</code>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»¥ä¸‹æ”¹è¿›ç‰ˆçš„expressåº”ç”¨ç¨‹åº:</p><figure class="lw lx ly lz gt mp"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="4380" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬ç°åœ¨æ­£åœ¨å›æ”¶ç¼“æ…¢è€Œæ˜‚è´µçš„æ“ä½œã€‚</p><p id="3b4d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code class="fe mm mn mo mb b">apache-bench</code>å‘æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå‘å‡º5ä¸ªå¹¶å‘è¯·æ±‚â€¦</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="b1b0" class="mf la in mb b gy mg mh l mi mj">ğŸ• ab -n 5 -c 5 -k <a class="ae ky" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a></span></pre><p id="1ad5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ—¥å¿—å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="937a" class="mf la in mb b gy mg mh l mi mj">&gt;&gt;&gt; Incoming request<br/><strong class="mb io">Starting a very slow operation!</strong><br/>&gt;&gt;&gt; Incoming request<br/>&gt;&gt;&gt; Incoming request<br/>&gt;&gt;&gt; Incoming request<br/>&gt;&gt;&gt; Incoming request<br/><strong class="mb io">Slow operation is over!</strong><br/>&lt;&lt;&lt; Outgoing response<br/>&lt;&lt;&lt; Outgoing response<br/>&lt;&lt;&lt; Outgoing response<br/>&lt;&lt;&lt; Outgoing response<br/>&lt;&lt;&lt; Outgoing response</span></pre><p id="7914" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">æˆ‘ä»¬ç”¨å‡½æ•°</strong> <code class="fe mm mn mo mb b"><strong class="ke io">someSlowAndExpensiveOperation</strong></code>ä¸­çš„ä¸€ä¸ªæ‰¿è¯ºè§£ææ¥å“åº”æ‰€æœ‰è¿™äº›å¹¶å‘è¯·æ±‚ï¼Œè€Œä¸æ˜¯é‡å¤è°ƒç”¨è¿™ä¸ªå‡½æ•°5æ¬¡ã€‚</p></div><div class="ab cl nd ne hr nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ig ih ii ij ik"><figure class="lw lx ly lz gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/6bd4bfd6420709fb5190709f1b6b0ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bKRsevrzzD9rxL-I9lJFkA.png"/></div></div></figure><p id="d9bf" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æ¨¡å—å¾…å®šæ‰¿è¯ºå›æ”¶å™¨åœ¨<a class="ae ky" href="https://www.npmjs.com/package/pending-promise-recycler" rel="noopener ugc nofollow" target="_blank"> npm </a>å’Œ<a class="ae ky" href="https://www.npmjs.com/package/pending-promise-recycler" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸­å¯ç”¨ã€‚</p><p id="61da" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">éå¸¸æ¬¢è¿æŠ•ç¨¿å’Œé—®é¢˜æŠ¥å‘Šï¼</p></div></div>    
</body>
</html>