<html>
<head>
<title>Fetch using GET, POST, PUT &amp; DELETE in React App (Part I)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React应用程序中使用GET、POST、PUT和DELETE获取(第一部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/fetch-using-get-post-put-delete-in-react-app-part-i-12d7496262b5?source=collection_archive---------0-----------------------#2019-12-21">https://javascript.plainenglish.io/fetch-using-get-post-put-delete-in-react-app-part-i-12d7496262b5?source=collection_archive---------0-----------------------#2019-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6010" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">另一个有趣的项目是探索React特性及其与API的交互。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a956f4c7052c7f88a444da81d65ecdec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6f5y7JzzsX1yVUB_lXyYA.jpeg"/></div></div></figure><p id="0234" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在上一篇文章中，我们学习了如何从第三方API获取数据并将这些数据返回给应用程序。可以在这里查看之前的项目<a class="ae ln" href="https://medium.com/@jhcxavier/fetching-data-from-third-party-api-with-hooks-1801897e934a" rel="noopener">。</a></p><p id="5d83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这一次我们将使用React和explore特性构建一个联系人列表应用程序，以<strong class="kt ir">创建</strong>、<strong class="kt ir">更新</strong>和<strong class="kt ir">删除</strong>项。这些交互在软件开发人员的日常生活中非常常见。</p><p id="2962" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在开始研究和编写我们的应用程序之前，我想向大家展示一下最终会是什么样子:</p><p id="ce29" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">h<a class="ae ln" href="https://www.youtube.com/watch?v=ov99iesb0Lw" rel="noopener ugc nofollow" target="_blank">ttps://youtu . be/ho-yWvLUjPU</a></p><p id="5a28" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于每一个与外部数据交互的机会，都有不同的步骤要遵循，因此阅读和理解它的文档意味着节省时间和避免以后的错误和意外结果。对于这个项目，我们将访问API，文档在链接“<a class="ae ln" href="https://assets.breatheco.de/apis/fake/contact/" rel="noopener ugc nofollow" target="_blank">https://assets.breatheco.de/apis/fake/contact/</a>”处。</p><p id="0f71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要考虑的一件重要的事情是学习看什么和理解期望做什么。考虑到这一点，API文档中需要强调的主题如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/fb86606785d870943a5433399d9a4ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*OUAJOyo_CmMNkELvgsjEwg.png"/></div></figure><p id="2e9a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，我们需要端点来检索数据。<strong class="kt ir">端点</strong>是连接网络并与网络来回通信的远程计算设备。</p><p id="c92b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，通过这个端点"<a class="ae ln" href="https://assets.breatheco.de/apis/fake/contact/" rel="noopener ugc nofollow" target="_blank">https://assets.breatheco.de/apis/fake/contact/</a>"+"议程"使用Postman，我们可以访问如下数据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lp"><img src="../Images/1623b9db4e97c20ea87782b734717d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*9_rI_ihPRwJC0K3VNYsLUg.png"/></div></div></figure><p id="cdbc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是阅读文档的重要性，这里的每一项都有一个联系人列表，此时我们只是访问议程而不是联系人。要访问联系人列表，我们将使用此端点"<a class="ae ln" href="https://assets.breatheco.de/apis/fake/contact/" rel="noopener ugc nofollow" target="_blank">https://assets.breatheco.de/apis/fake/contact/</a>"+" agenda/downtown _ XII "，文档显示如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/7a8460d23ed4c668eb1929442f4f769b.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*lWPc64ua5W2Oq8bZQ-jejA.png"/></div></figure><p id="e603" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，当我们试图从特定的议程中获取数据时，我们得到的是联系人列表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/70deb74449e2e7b8a98414b29014931e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*cwrm3iy1v4G4X_mwXhym8g.png"/></div></figure><p id="9a31" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是我们在开始编码之前需要测试和了解的，端点以及它是否正在获取数据。到目前为止，我们只讨论了GET方法。</p><p id="305d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们即将使用的样板是4Geeks Academy在这个<a class="ae ln" href="https://github.com/breatheco-de/exercise-contact-list-context" rel="noopener ugc nofollow" target="_blank">资源库</a>上提供的样板。风格和组成部分已经创建，我们的任务将只是应用一些功能。为了遵循相同的结构，第一步将更新文件“appContext.js”，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/240579cdc414bd1890cc9f33a7759516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J13C4dQl4q366I9m4-22rA.png"/></div></div></figure><p id="4e83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">右边是你应该如何更新你的文件。这仅仅是因为在之前的文章<a class="ae ln" href="https://medium.com/@jhcxavier/fetching-data-from-third-party-api-with-hooks-1801897e934a" rel="noopener">星球大战</a>中我们使用了Context，并且保持相同的管理状态的方式将会避免一些错误。因此，请确保您的“appContext.js”文件与右侧的相同。</p><p id="be83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第一步是让它成为我们应用程序中的可用议程，为此，我们将开始使用函数从API获取数据。样板文件提供了一个特定的文件来放置一些功能。文件“src/js/store/flux.js”是一个函数组件，它按如下方式返回一个对象:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/596e943012fef4c386c5f097c0c7b5bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*ZPZpao4PyVHbMWWN8nrh2w.png"/></div></figure><p id="1631" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将声明我们的函数来获取“actions”中的数据；</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/5cc76c049082ef33976bbf32cb8e3022.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*bP3ebXyYngIKJIDfx7Knwg.png"/></div></figure><p id="2ce7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是你的“flux.js”在你声明你的函数后应该是什么样子的。</p><p id="387a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于第一行，我们声明了一个全局变量，可以随时在组件中调用。第5行，指定将接收来自API的数据的数组。我们在第8行启动函数，在第9行我们只需要调用“<em class="lv"> const url </em>，并添加“agenda/闹市区_xii”，因为这是GET数据的端点。</p><p id="1a12" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上一篇文章我一行一行的解释了fetch函数，所以如果有需要的话来点点心看看<a class="ae ln" href="https://medium.com/@jhcxavier/fetching-data-from-third-party-api-with-hooks-1801897e934a" rel="noopener">这里</a>。</p><p id="c470" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在声明函数之后，我们需要调用它，这将在“appContext.js”中完成，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/59bfe109a19ae7365138e404c09b0d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*mSfOIqltdbritGCXBUKKIA.png"/></div></figure><p id="971c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个文件唯一的变化将出现在第31行。我们将调用函数“state.actions.loadContact()。。</p><p id="2d0d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果正确遵循了这些步骤，现在就应该是运行<em class="lv">NPM run start</em>的时候了，使用这个检查器我们会得到这个结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/532858312334ac8281e65d1c0276053a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7y3PeRw3qGEkXz3HhSfkHA.png"/></div></div></figure><p id="f558" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我们使用Postman检索数据时，我们得到了一个包含三个项目的数组，这三个项目与我们使用检查器返回到这里的内容相同。我们可以通过检查显示的id来确保它与邮差收到的id相匹配。</p><p id="1f7d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该应用程序在浏览器4中显示联系人，这些联系人是硬编码的，因为它出现在“src/js/view/contacts . js”中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ly"><img src="../Images/7390e22b89a7d15f3b6e6c9b9f697f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqnkRYrPGGviasFONWk6xw.png"/></div></div></figure><p id="9515" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们需要从第23行到第25行删除，只保留一个<ContactCard/>，它可以保留第22行中的那个。</p><p id="1f81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，如果您检查浏览器，它应该只显示一个联系人。</p><p id="6013" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了这些最后的改变，可以得出结论，ContactCard是我们应该把API数据带到的组件。为此，我们将使用文件“src/js/component/contact card . js”中的<strong class="kt ir"> useContext </strong>在该组件中提供数据，如下所示<strong class="kt ir"> : </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/801b52c00399b5509ed6613c5dec9bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*mmdP0PS2O4SUhzJ1Ye5DWA.png"/></div></figure><p id="311b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第1行，我们开始添加“useContext”，它接受一个上下文对象(从<code class="fe ma mb mc md b">React.createContext</code>返回的值)，并返回该上下文的当前上下文值。然后我们需要导入<strong class="kt ir">上下文</strong>，就像我们在第5行所做的那样。最后，在第11行，我们将提供存储在“flux.js”中的数据。为了确保一切正常工作，在<strong class="kt ir">控制台上，记录</strong>内联12，然后是命令<em class="lv">“NPM运行开始”</em>并使用检查器，它应该显示两个数组“Get Contact”和“storeeee”，两个数组的值相同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi me"><img src="../Images/8e92eaa7b765caa3ad2f280b8d154830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2tKvcIGAPn8pZbeXuL85Q.png"/></div></div></figure><p id="4564" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们绘制地图。第15行我们使用“store.contacts &amp;”作为条件渲染。fetch函数是Async，它返回一个<code class="fe ma mb mc md b"><a class="ae ln" href="https://developer.mozilla.org/en-US/docs/Web/API/Promise" rel="noopener ugc nofollow" target="_blank">Promise</a></code>来解析该请求的<code class="fe ma mb mc md b"><a class="ae ln" href="https://developer.mozilla.org/en-US/docs/Web/API/Response" rel="noopener ugc nofollow" target="_blank">Response</a></code>，不管它是否成功。<code class="fe ma mb mc md b"><strong class="kt ir">Promise</strong></code>对象表示异步操作的最终完成(或失败)及其结果值。简而言之，这意味着数据将在提取结束时立即显示出来。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/4ac3a1a5ddfc00eed382cf30d83268fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*oPwEzaQz_BNadrZxvFBqVg.png"/></div></figure><p id="3bde" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要进行测试并完全理解上一段，请使用检查器在控制台部分转到浏览器并刷新页面。看到左侧，首先出现的是承诺，一个空数组“storee-&gt;[]”，然后是数据和相同的“storee”的“Get Contact ”,但循环已完成。</p><p id="b57d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在关闭map函数后，在第60行，需要在第18行添加key validation " key = { index } "，并像在第36、39、47和55行一样输入数据。结果应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/c8a73b7973c142405d6f9669eb1a6735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5Wbc-GsViVlBtCfX1M97g.png"/></div></div></figure><p id="f90d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们已经得出结论，我们的应用程序的第一种方法是GET，它允许我们读取数据。到目前为止还没有什么新的东西，因为我们已经在《星球大战》的文章中讨论了同样的过程。</p><p id="1fef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">*现在是提交代码的好时机！</p><p id="e1fb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们项目的下一阶段将是在我们的议程上创建一个新的联系人。为了更好的理解，我们应该回到API <a class="ae ln" href="https://assets.breatheco.de/apis/fake/contact/" rel="noopener ugc nofollow" target="_blank">文档</a>；</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/1c8acab8d3d34fa776912b3b31ce4dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*JoDNTYpHrQ7kZ1CVoYBxzw.png"/></div></figure><p id="c4d0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它说要创建一个联系人，我们需要使用方法<strong class="kt ir"> POST </strong>，header <strong class="kt ir"> application/json </strong>，我们知道<em class="lv"> application/json </em>是<strong class="kt ir"> Content-type </strong>的值，最后但同样重要的是主体。</p><p id="4e8f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在使用API时，Postman应该是您最好的朋友。我们选择POST方法，指定主体并选择“raw ”,而测试选项可能是“TEXT ”,它需要被更改为JSON。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mi"><img src="../Images/227989b0178be4902400a00428593dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NgUVOKkdDMRfRwZmkiW5g.png"/></div></div></figure><p id="bb35" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因为是JSON，所以语法需要是JSON。您可以在这里验证您的JSON代码<a class="ae ln" href="https://jsonlint.com/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="2489" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果一切正常，将为我们的议程“第十二市区”创建一个新的联系人。</p><p id="a0ff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了验证POST请求，我们可以在浏览器中进行检查。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mj"><img src="../Images/0e17d5adae7c3b6199b87c61d297f450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qkq5jYZ3p4Uw_RVhwKXiCw.png"/></div></div></figure><p id="934a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">结果应该是id为531的新联系人。</p><p id="a452" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请注意，这个数据是不断变化的，因为访问是对所有学生开放的，现在是id 531，但当你检查项目时，可以是任何其他数字。</p><p id="015a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们知道端点正在工作，我们可以基于API文档创建一个新的联系人，现在是时候回到代码了。</p><p id="d32e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先要做的是声明将创建新联系人的函数，我将调用<strong class="kt ir"> addContact() </strong>和<strong class="kt ir"> </strong> it <strong class="kt ir"> </strong>应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/8d41158dee3918d8c4e6108432832c0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*1FGjzg70vyO5pkOkp3VFEA.png"/></div></figure><p id="7337" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该函数在<strong class="kt ir"> loadContact() </strong>之后的“flux.js”中声明。记住“actions”是键，<strong class="kt ir"> addContact() </strong>是值，这些值用逗号分隔，如第18行所示。</p><p id="66ec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">声明函数时，在第19行我们传递了4个参数，<em class="lv">姓名</em>、<em class="lv">电话</em>、<em class="lv">电子邮件、</em>和<em class="lv">地址。</em>然后我们声明<strong class="kt ir"> fetch() </strong>第20行，从第1行传递“<em class="lv"> const url </em>”，这正是创建新联系人对应的端点。接下来，按照API文档，我们将方法设置为"<strong class="kt ir"> post </strong>"，头设置为"<strong class="kt ir">{ " Content-type ":" application/JSON " }</strong>"以及最重要的部分，即主体。</p><p id="1ab9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">(我们马上就要回到身体上了)</p><p id="846a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在是解释视图AddContact的时候了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/e001e136954e238beb253c6c29e59e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5c37piBz_1tP8sY-ObB8-g.png"/></div></div></figure><p id="042e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我们添加一个新的联系人时，我们需要指定<em class="lv">姓名</em>、<em class="lv">电子邮件</em>、<em class="lv">电话、</em>和<em class="lv">地址。</em>在控制台的右侧出现每个联系人的所有键和值。然而，API文档说我们需要指定这一点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/c85a9b171919fa484d84846a31cbab62.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*KZq3k8B4r8uu0oYQ7Bgfpw.png"/></div></figure><p id="a0fd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">即<strong class="kt ir">全名</strong>、<strong class="kt ir">电子邮件</strong>、<strong class="kt ir">议程_段子</strong>、<strong class="kt ir">地址、</strong>和<strong class="kt ir">电话。</strong></p><p id="ee5b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们开始讨论"<em class="lv"> agenda_slug </em>"因为这是唯一看起来没有意义的事情。</p><p id="bb78" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们需要指定agenda_slug来分配联系人将被创建到哪个议程。我们已经知道我们在和“<em class="lv">市区_xii </em>合作，但是API不知道。因此，我们将在代码中设置硬编码的值“<em class="lv">市区_xii </em>”，这意味着我们为每个联系人创建的“<em class="lv">议程_slug </em>”将具有正确列表的值。</p><p id="90a8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们回到<strong class="kt ir">体</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/824dad76845bb8e8d667963eefc8ec99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*3GetqMWo3RQHALTD_Doesg.png"/></div></figure><p id="6891" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">主体将首先有一个函数JSON.stringfy，它具有将我们发送给API的对象转换成JSON的功能。因为我们知道数据在<strong class="kt ir"> JSON </strong>或<strong class="kt ir"> Text中传输。</strong>转换为JSON后，我们将参数<em class="lv"> name </em> (addContact，parameter)赋给<strong class="kt ir"> full_name </strong>(代表名称的API key)，对于所有其他<strong class="kt ir">电话、</strong>地址和<strong class="kt ir">电子邮件、</strong>将是相同的，除了<strong class="kt ir"> agenda_slug </strong>。对于这个函数，我们将对值进行硬编码，因此每次我们调用<strong class="kt ir"> addContact() </strong>函数时，<strong class="kt ir"> agenda_slug </strong>的值都将是“<em class="lv"> downtown_xii </em>”。</p><p id="1873" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第30行，我们再次用GET方法获取数据。这意味着一旦触发addContact()函数，页面将重新呈现新的联系人。</p><p id="ff6b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们让函数工作吧！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/5f1de55b7af95cf5536c95e39cd3a46c.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*bsaNOWWtWcJVYuF6Mi6Rfw.png"/></div></div></figure><p id="20f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将在“src/js/views/AddContact.js”中工作。首先要做的是在第一行添加<strong class="kt ir">使用状态</strong>和<strong class="kt ir">使用上下文</strong>。第3行，我们需要导入<strong class="kt ir">上下文</strong>以使<strong class="kt ir">动作</strong>可用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/79f18dcb42629fb8634ecd96e7dc04ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*78SW2emBfJli0EP3kmvbTw.png"/></div></figure><p id="934d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第6行，它通过<strong class="kt ir">上下文</strong>访问“flux.js”中的动作。对于每个参数，已经使用<a class="ae ln" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> React钩子</strong> </a>设置了状态，从第7行到第10行，在一个const中，首先需要声明<em class="lv">初始状态</em>值，它由<strong class="kt ir"> phone </strong>、<strong class="kt ir"> name、</strong>email、<strong class="kt ir"> address表示。</strong>然后，这些值可以由接受新值并更新状态的函数来更新。对于<strong class="kt ir">使用状态，</strong>这是<em class="lv">初始状态</em>值，一个空字符串，原因很简单，为了添加一个新的联系人<em class="lv">初始值</em>它需要为空。就在我们<strong class="kt ir">改变</strong>状态时，值被更新。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/3ea4d02b212963973ca9006beb55ad14.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*Dlt_11CeorK0WEiS30hybg.png"/></div></figure><p id="bd81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">每个输入将保存一个onChange事件，该事件在元素的值改变时发生。通过函数setName，我们为第8行中的<em class="lv"> name、</em>设置了一个新值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/ab7bb42c0a2b7e5623451343912931b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNeoCxeaz5UIfNt5pamyGw.png"/></div></div></figure><p id="d93a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">向前看，保存按钮将是创建新联系人的触发器，但这将发生在改变所有变量的<em class="lv">初始状态</em>(<em class="lv">姓名</em>、<em class="lv">电子邮件</em>、<em class="lv">地址</em>和<em class="lv">电话</em>)之后。一旦单击了save按钮，onClick函数将被激活，我们将把更改后的状态作为参数传递。这些参数与在<strong class="kt ir"> addContact()，</strong>中的“<em class="lv"> flux.js </em>”中声明的参数相同，实际上是相同的函数和相同的参数，顺序需要相同。</p><p id="f53a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">电子邮件，无论何时添加，都需要是有效的格式“<em class="lv">email@gmail.com</em>”。</p><p id="ea53" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在这里找到代码<a class="ae ln" href="https://github.com/jhcxavier/Contact_List_Medium" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="44e7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢阅读，<a class="ae ln" href="https://medium.com/@jhcxavier/fetch-using-get-post-put-delete-in-react-app-part-ii-e116f8bc69da" rel="noopener"> <strong class="kt ir">第二部</strong> </a>将盖放并删除。</p></div></div>    
</body>
</html>