<html>
<head>
<title>Responsive web design | Bootstrap | Node.js | Auth0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">响应式网页设计| Bootstrap | Node.js | Auth0</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/responsive-web-design-bootstrap-node-js-auth0-11e75053d1e4?source=collection_archive---------9-----------------------#2020-11-20">https://javascript.plainenglish.io/responsive-web-design-bootstrap-node-js-auth0-11e75053d1e4?source=collection_archive---------9-----------------------#2020-11-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4c26" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本文的目标是为一个假设的组织开发一个应用程序，该应用程序将对用户进行身份验证，然后允许用户对该组织的员工数据库执行CRUD操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9b1637ea755e647e498f39c9ebfc6a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G2fGL5RJDBgnPA9H"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@uxstore?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">UX Store</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="b6ef" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">项目大纲</h2><p id="951e" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">我们的项目基本上是基于<strong class="jm io">联合身份流</strong>，下面将对其进行描述。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/9d23480967d098676105f99eb5119504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oa0BOWJs71u2rJVb.png"/></div></div></figure><ol class=""><li id="9d26" class="ly lz in jm b jn jo jr js jv ma jz mb kd mc kh md me mf mg bi translated">用户试图访问我的资源服务器处理的资源。</li><li id="8226" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh md me mf mg bi translated">服务器将用户重定向到授权服务器，因为他没有访问资源的适当凭证。授权服务器配置为允许用户使用由身份提供者管理的凭据登录。</li><li id="fb7f" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh md me mf mg bi translated">授权服务器将用户重定向到身份提供商的登录页面。</li><li id="65df" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh md me mf mg bi translated">成功登录后，用户连同身份提供者提供的凭据一起被重定向到授权服务器。授权服务器使用这些凭证来访问资源服务器所需的凭证。</li><li id="6116" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh md me mf mg bi translated">授权服务器将用户以及访问资源所需的凭证重定向到资源服务器。</li><li id="c022" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh md me mf mg bi translated">用户成功访问资源。</li></ol><p id="3b7e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的项目中，身份提供者将是<strong class="jm io"> Google </strong>，授权服务器将是<strong class="jm io"> Auth0，</strong>资源服务器将由我们在Node.js中编程，资源将是<strong class="jm io"> SQLite3数据库</strong>。</p><p id="3e98" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以下视频是我们项目的最终外观。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="9a34" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这个项目是我做的另一个项目的延伸，它的链接在下面提到。我们在这个版本中添加的新特性是使用Auth0的身份验证和授权，以及对路由的一些其他修改。</p><div class="mo mp gp gr mq mr"><a href="https://medium.com/javascript-in-plain-english/responsive-web-design-using-bootstrap-4-with-node-js-as-the-backend-b4b64a0f48e8" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">使用Bootstrap和Node.js作为后端的响应式web设计</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">随着技术的发展，多年来许多事情都发生了变化。更具体地说，如果我们谈论大小…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ks mr"/></div></div></a></div><p id="955c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">欲了解更多信息，请访问以下博客。</p><div class="mo mp gp gr mq mr"><a href="https://souvikpl.medium.com/json-web-token-ad5284fa302" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">JSON Web令牌</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">了解JWT、联合身份、访问和刷新令牌、OpenID connect。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">souvikpl.medium.com</p></div></div><div class="na l"><div class="ng l nc nd ne na nf ks mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a href="https://souvikpl.medium.com/an-overview-of-oauth-2-0-7255e1b5eed3" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">OAuth 2.0概述</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">OAuth 2.0是一个授权框架，应用程序使用它为客户端应用程序提供安全的委托…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">souvikpl.medium.com</p></div></div><div class="na l"><div class="nh l nc nd ne na nf ks mr"/></div></div></a></div><h2 id="cc39" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">使用的工具</h2><ul class=""><li id="da53" class="ly lz in jm b jn ls jr lt jv ni jz nj kd nk kh nl me mf mg bi translated">节点. js</li><li id="dc8d" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh nl me mf mg bi translated">Auth0</li><li id="0816" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh nl me mf mg bi translated">HTML，CSS，引导</li><li id="fa53" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh nl me mf mg bi translated">JQuery</li><li id="5351" class="ly lz in jm b jn mh jr mi jv mj jz mk kd ml kh nl me mf mg bi translated">SQLite3</li></ul><p id="1fbe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在开始编码部分之前，让我通知您，我们将要编写的所有代码也可以在我的GitHub库中找到。</p><div class="mo mp gp gr mq mr"><a href="https://github.com/souvik-pl/ResponsiveWebDev_Auth0" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">sou vik-pl/responsive web dev _ auth 0</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">GitHub是超过5000万开发人员的家园，他们一起工作来托管和审查代码、管理项目和构建…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">github.com</p></div></div><div class="na l"><div class="nm l nc nd ne na nf ks mr"/></div></div></a></div><p id="857d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，是时候开始编码部分了。</p><h2 id="131a" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">初始设置</h2><p id="f382" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">首先，我们将在系统中创建一个名为<strong class="jm io"> myproject </strong>的项目目录，该目录包含以下文件和文件夹。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/fcac7bdb8c708557bb7885729cde36db.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*Axy__E6ideElAPdZgm0ofg.png"/></div></figure><p id="c0a2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们将创建<strong class="jm io">数据库</strong>目录和其中的文件，即<strong class="jm io"> employees.db </strong>将由我们的服务器应用程序(<strong class="jm io"> app.js </strong>)自动创建。</p><p id="518c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后，我们将打开终端，导航到这个目录，运行命令<code class="fe no np nq nr b">npm init</code>并输入所有默认选项。</p><p id="8ec0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，我们将运行以下命令来安装dotenv、body-parser、express、express-openid-connect、socket.io和sqlite3。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="19d6" class="kz la in nr b gy nw nx l ny nz">npm install dotenv body-parser express express-openid-connect socket.io sqlite3 --save</span></pre><p id="c96c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://www.google.com/url?sa=t&amp;source=web&amp;rct=j&amp;url=https://www.npmjs.com/package/express&amp;ved=2ahUKEwiA-cHVs4DtAhUST30KHYnBC3oQFjAAegQIERAB&amp;usg=AOvVaw0QmeMdDUG_lpfBECY8aNVb" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Express </strong> </a>是一个极简灵活的Node.js web应用框架，为web和移动应用提供了一组健壮的特性。在express的帮助下，API可以非常容易和快速地构建。</p><p id="11bc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Dotenv </strong> </a>是一个零依赖模块，将环境变量从<code class="fe no np nq nr b">.env</code>文件加载到<code class="fe no np nq nr b">process.env</code>中。将配置存储在独立于代码的环境中是基于十二因素应用程序方法的。</p><p id="36f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://socket.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">插座。IO </strong> </a> <strong class="jm io"> </strong> —支持基于事件的实时双向通信。</p><p id="b393" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://www.npmjs.com/package/sqlite3/v/3.0.4" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Sqlite3 </strong> </a> —它是Node.js的异步、非阻塞Sqlite3绑定。</p><p id="7221" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://www.npmjs.com/package/express-openid-connect" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">Express-OpenID-Connect</strong></a><strong class="jm io"/>—Express JS中间件使用OpenID Connect实现Express web apps的登录。</p><p id="e501" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ky" href="https://www.google.com/url?sa=t&amp;source=web&amp;rct=j&amp;url=https://www.npmjs.com/package/body-parser&amp;ved=2ahUKEwitjNr3s4DtAhUIOSsKHbeXDysQFjAAegQIGRAD&amp;usg=AOvVaw25YQ9Y7zSE8ft8uHS1kYRG" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">需要Body-parser </strong> </a>来处理<strong class="jm io"> Express.js </strong>中的<code class="fe no np nq nr b">HTTP POST</code>请求。它提取传入请求流的整个主体部分，并在<code class="fe no np nq nr b">req.body</code>上公开它。</p><p id="db20" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们将转到<a class="ae ky" href="https://auth0.com/docs/quickstarts/" rel="noopener ugc nofollow" target="_blank"> Auth0 quickstart </a>，选择常规web应用程序，并按照那里的说明向Auth0注册我们的应用程序。</p><p id="512d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">需要注意的是，在<strong class="jm io">回调URL </strong>字段中，我们必须输入<a class="ae ky" href="http://localhost:3000/callback" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/callback</a>，在<strong class="jm io">注销URL </strong>字段中，我们必须输入<a class="ae ky" href="http://localhost:3000/callback" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>。</p><p id="4f11" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">之后，我们将创建一个<strong class="jm io">。env </strong>文件放在我们的<strong class="jm io"> myproject </strong>目录的根目录下，我们将在这里输入以下信息。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="e4c3" class="kz la in nr b gy nw nx l ny nz">ISSUER_BASE_URL=https://example.us.auth0.com<br/>CLIENT_ID=mYexampleC1i3ntId<br/>BASE_URL=http://localhost:3000<br/>SECRET=aNyRanDomStuFftHatYoUwaNtT0MenTiOn</span></pre><p id="4af1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意Auth0将给出发卡行基本URL和客户端ID。</p><p id="084f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">前端开发</strong></p><p id="5e6c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们将开发应用程序的前端，它位于<strong class="jm io"> public </strong>目录中。</p><p id="3d0f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">首先，我们将创建文件<strong class="jm io">login.html</strong>，这将是当用户键入<a class="ae ky" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>时显示的第一个页面，该页面将要求用户登录。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa mn l"/></div></figure><p id="6794" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">成功登录后，用户将进入I<strong class="jm io">ndex.html</strong>页面，代码如下。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa mn l"/></div></figure><p id="414d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">其他html文件的代码可以在我的GitHub repo中找到。</p><h2 id="8c63" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated"><strong class="ak">后端开发</strong></h2><p id="a219" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">现在我们将为我们的资源服务器编写代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa mn l"/></div></figure><p id="5aa2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">了解<strong class="jm io">插座。IO，</strong>请访问此链接—</p><div class="mo mp gp gr mq mr"><a href="https://medium.com/swlh/real-time-chat-application-using-socket-io-in-node-js-37806e98918c" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">Node.js中使用Socket.io的实时聊天应用</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">任何领域的专家都曾是初学者。所以，要成为专家，有一个坚实的基础是非常重要的…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="ob l nc nd ne na nf ks mr"/></div></div></a></div><h2 id="a337" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">测试应用程序</h2><p id="5ea0" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">最后，我们的应用程序准备好了。我们可以使用<code class="fe no np nq nr b">node app</code>命令启动服务器，并在浏览器中键入<a class="ae ky" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>。</p><h1 id="e617" class="oc la in bd lb od oe of le og oh oi lh oj ok ol lk om on oo ln op oq or lq os bi translated">Auth0的角色</h1><p id="0420" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">现在，是了解Auth0如何管理事物的好时机。下面是整个过程的描述。</p><ol class=""><li id="4816" class="ly lz in jm b jn jo jr js jv ma jz mb kd mc kh md me mf mg bi translated">浏览器访问资源服务器(在我们的例子中是<strong class="jm io"> app.js </strong>),并尝试使用下面的请求访问<code class="fe no np nq nr b">/protected</code> route中的资源。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/8ec37f33e9caa30fb1f1770f6d7adbbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*V9d-4phqPukEKLpzCQApvg.png"/></div></figure><p id="b2b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">2.我们已经安装的OIDC中间件(<strong class="jm io"> express-openid-connect </strong>在我们的例子中)拦截这个调用，并向授权服务器发出一个授权请求，作为对上述GET请求的响应(在下面给出)。这是通过重定向浏览器来完成的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/de2f3cdeb2807c2ceddf94bae9fab650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*t9jOceZsRDyNJe2XW4VsGw.png"/></div></figure><p id="f90a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在上面的响应中，所有参数的含义描述如下。</p><p id="3141" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">位置</strong>:授权服务器中的授权端点。</p><p id="e705" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> client_id </strong>:是我们的资源服务器在授权服务器上的标识。</p><p id="554d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> response_type </strong>:是浏览器和中间件想要的神器。在这种情况下，用户想要登录。所以，他需要一个身份证。</p><p id="ad70" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> response_mode </strong>:是浏览器和中间件希望工件返回的方式。这里，我们有HTTP允许的所有方法。我们可以在查询字符串中获得工件，但这不是一个好主意，因为这会被记录到浏览器的历史记录中。因此，我们将使用' form_post '，它将令牌作为post请求发送到资源服务器。</p><p id="8a17" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> redirect_uri </strong>:它表示我们的资源服务器中的地址，我们希望令牌和工件返回到这个地址。我们在这个上下文中使用的令牌是不记名令牌。</p><p id="be3b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> scope </strong>:它表示授权服务器请求的工件。</p><p id="edab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">nonce</strong>:nonce参数用于防止令牌注入。在请求时，会生成一个唯一的标识符并保存在浏览器中。该标识符被发送到授权服务器，最终接收回的ID令牌具有包含相同标识符的声明。在这一点上，这可以与保存的标识符进行比较，我们将确信我们得到了我们所请求的令牌。</p><p id="5639" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">OAuth和OIDC将响应类型及其默认响应模式定义如下</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/f9dcdaac469de3c443095985f1f78474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*mEmxAKqX2FfWPOGHuqWOiA.png"/></div></figure><p id="fd2b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们的例子中，在中间件的响应中，它有<code class="fe no np nq nr b">response_type=id_token</code>，而不是使用默认的<code class="fe no np nq nr b">response_mode</code>，中间件已经覆盖了它并使用了<code class="fe no np nq nr b">response_mode=form_post</code>。</p><p id="ca44" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">3.当浏览器从我们的资源服务器中的中间件获得302状态时，它将向授权服务器中的授权端点(<code class="fe no np nq nr b">/authorize</code>)发送一个GET请求(下面给出了该请求),其中包含中间件提供的所有参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/890009c5d9d47e7fe4dca3895db6a812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*YE-RIIva_qTDeQP_dYy3Pw.png"/></div></figure><p id="a711" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，授权服务器将做任何它认为必要的事情来验证用户。OAuth或OIDC没有规定这方面的程序。可以使用多种类型的身份认证，如单因素、多因素等。</p><p id="bfdc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">4.当用户成功通过授权端点的身份验证时，通常授权服务器会设置一个cookie，它代表用户与授权服务器的会话。因此，如果稍后用户再次点击授权端点，他将不必再次登录。</p><p id="8848" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了响应前面的GET请求，授权服务器将发送以下内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/0fbcd2a3d2239785426f72763adf4f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aS84T8h779gZDrbSJP_NMA.png"/></div></div></figure><p id="211f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这个响应中，所请求的ID令牌(JWT格式)已经作为表单中的参数返回。在HTML的标签上，连接了一个<code class="fe no np nq nr b">onload</code>事件，当这个页面被渲染时，它会自动提交表单，并将这个令牌发送到资源服务器。</p><p id="18f0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">5.当浏览器收到来自授权服务器的前一个响应时，带有令牌ID的表单会立即作为POST请求发送到资源服务器，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/635e29da157679a926fee2070093d7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*jPzA0bSolECOc20upcyi4w.png"/></div></figure><p id="f742" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">6.中间件将截取id_token，并对其进行比较，以检查该id_token是否是针对它的。如果验证成功，id_token将被接受，代表资源服务器的OIDC中间件将给出302响应(重定向)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/517e1cb6339ba10b3cb1e8b7d608fac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EuKYxxxHYW4wxtwmwG2r0g.png"/></div></div></figure><p id="6adf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有了这个响应，OIDC中间件将在浏览器和资源服务器之间设置自己的cookie。因此资源服务器不需要再次获取ID令牌。同时，这个响应会将用户重定向到他试图通过cookie访问的原始路由。</p><p id="8fa8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">7.在重定向过程中，浏览器将发送一个与第一个请求相似的GET请求。这里唯一的区别是cookie将包含在每个请求中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/a84e7f740bf63f0ef305801f458fbbae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*x2vns593nrAqzLTrS_Zn2w.png"/></div></figure><p id="30f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">8.最后，用户将可以访问他试图访问的资源。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/70ca5866368ad6268542706cd8e28e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*lAI2wh342n86ywhC6s1KNw.png"/></div></figure><h2 id="c4d4" class="kz la in bd lb lc ld dn le lf lg dp lh jv li lj lk jz ll lm ln kd lo lp lq lr bi translated">参考</h2><p id="c5f4" class="pw-post-body-paragraph jk jl in jm b jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh ig bi translated">自举4:【https://getbootstrap.com/ T2】</p><p id="c010" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">快递模块:<a class="ae ky" href="https://www.npmjs.com/package/express" rel="noopener ugc nofollow" target="_blank">T5【https://www.npmjs.com/package/express】T6</a></p><p id="d9d0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">sqlite3模块:<a class="ae ky" href="https://www.npmjs.com/package/sqlite3" rel="noopener ugc nofollow" target="_blank">T9】https://www.npmjs.com/package/sqlite3T11】</a></p><p id="9971" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正文解析器模块:<a class="ae ky" href="https://www.npmjs.com/package/body-parser" rel="noopener ugc nofollow" target="_blank"><em class="pc">https://www.npmjs.com/package/body-parser</em></a></p><p id="3c72" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">socket . io:<a class="ae ky" href="https://socket.io/" rel="noopener ugc nofollow" target="_blank">T17】https://socket.io/T19】</a></p><p id="97e9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">dotenv:<a class="ae ky" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/dotenvT21</a></p><p id="9c99" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">express-OpenID-connect:<a class="ae ky" href="https://www.npmjs.com/package/express-openid-connect" rel="noopener ugc nofollow" target="_blank"><em class="pc">https://www.npmjs.com/package/express-openid-connect</em></a></p><p id="0510" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">auth 0 Docs:<a class="ae ky" href="https://auth0.com/docs/quickstarts/" rel="noopener ugc nofollow" target="_blank"><em class="pc">https://auth0.com/docs/quickstarts/</em></a></p><p id="7530" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用OpenID Connect对web应用程序进行身份验证的视频:<a class="ae ky" href="https://auth0.com/docs/videos/learn-identity-series/web-sign-in" rel="noopener ugc nofollow" target="_blank">https://auth 0 . com/docs/videos/learn-identity-series/we B- sign-in</a></p></div></div>    
</body>
</html>