<html>
<head>
<title>Type-Safe Actions, Action Creators and Reducers in Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux中的类型安全操作、操作创建者和减少者</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/type-safe-actions-action-creators-and-reducers-in-redux-22c28013d1c6?source=collection_archive---------8-----------------------#2020-04-18">https://javascript.plainenglish.io/type-safe-actions-action-creators-and-reducers-in-redux-22c28013d1c6?source=collection_archive---------8-----------------------#2020-04-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0eec0d216565a8d90f15789e99287cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tB4O92VXF6uMY-HQIGpEow.jpeg"/></div></div></figure><p id="1324" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在开发JavaScript应用程序时，TypeScript提供了很好的静态类型检查。当您遍历代码以理解各种组件之间的关系时，TypeScript的优势尤其明显。当您可以依靠TypeScript在编译时捕捉类型错误的能力时，重构代码是轻而易举的事情。最后，它全部编译成普通的旧JavaScript并去掉类型信息，这意味着它不会影响您的包的大小！总而言之，它提供了一个简单而高效的开发者体验。</p><p id="8b50" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是有一个条件！</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/3ba995696e4c5a94af16aeefec0fa536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*2WF5EWkf98Ac7OpBy-RNhg.gif"/></div></figure><p id="c270" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="kt"> TypeScript的好坏取决于它从推理和我们的类型定义中获得的信息。</em></p><p id="dc20" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，让我们看看如何利用TypeScript的各种特性，使Redux中的reducers和actions成为类型安全的。</p><h1 id="e127" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">动作和动作创建者</h1><p id="d914" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">“Redux中一个动作的理想结构是怎样的？”就是主观和固执己见。我将使用4种类型的操作来解决我迄今为止在应用程序中遇到的所有用例。让我们定义4种类型的操作和操作创建者:</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="ba02" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我已经用<a class="ae me" href="https://www.typescriptlang.org/docs/handbook/generics.html" rel="noopener ugc nofollow" target="_blank"> <em class="kt">泛型</em> </a>用<em class="kt">类型变量</em>定义了每种类型的动作。注意，每个动作中的<code class="fe mf mg mh mi b">type</code>字段不是<code class="fe mf mg mh mi b">string</code>而是<code class="fe mf mg mh mi b">Type extends string</code>。当我们转向减速器时，原因就显而易见了。</p><p id="81f8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对Redux的一个常见抱怨是，它需要很多样板文件，比如动作和动作创建器，用于指定存储上的变化。有一些方法可以减少这种样板文件。其中之一就是<em class="kt">用函数生成动作创建者。</em>在牢记类型安全的同时实现这个函数的方法之一是:</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="9f79" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我使用了<a class="ae me" href="https://www.typescriptlang.org/docs/handbook/functions.html#overloads" rel="noopener ugc nofollow" target="_blank"> <em class="kt">函数重载</em> </a> <em class="kt"> </em>到<em class="kt"> </em>来定义<code class="fe mf mg mh mi b">makeActionCreator</code>的4种不同用法。<code class="fe mf mg mh mi b">makeActionCreator</code>的实现遵循最后一个重载函数类型，相当简单。它接受<code class="fe mf mg mh mi b">type</code>字段以及可选的<code class="fe mf mg mh mi b">payload</code>和<code class="fe mf mg mh mi b">meta</code>字段，并返回一个元组(动作常量，动作创建者)。</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/06f88edeba3aac3df092eda238d7fe89.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*32Ws9IpmX5ervgsrxJl5XA.gif"/></div></figure><p id="eb05" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好吧！是时候享受所有细致的类型定义的好处了。</p><h1 id="fd62" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">还原剂</h1><p id="b8b4" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">在创建缩减器之前，让我们使用<code class="fe mf mg mh mi b">makeActionCreator</code>为每种类型创建一个动作:</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="8774" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe mf mg mh mi b">placeholderType</code>用作虚拟变量，指定有效载荷和元的类型。在TypeScript开始支持<a class="ae me" href="https://github.com/microsoft/TypeScript/issues/26242" rel="noopener ugc nofollow" target="_blank">部分类型参数推断</a> ( <em class="kt"> TypeScript可以推断所有类型参数或者不推断任何类型参数之前，这是一种变通方法。例如，它不能推断出</em> <code class="fe mf mg mh mi b"><em class="kt">type</em></code> <em class="kt">的类型，也不能允许</em> <code class="fe mf mg mh mi b"><em class="kt">makeActionCreator</em></code> <em class="kt">的调用者将</em> <code class="fe mf mg mh mi b"><em class="kt">meta</em></code> <em class="kt">和</em> <code class="fe mf mg mh mi b"><em class="kt">payload</em></code> <em class="kt">的类型作为类型参数</em>。最后，创建一个所有动作的联合类型，以便在reducer中使用。</p><p id="4459" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们创建一个使用我们刚刚创建的动作的reducer:</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="898a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">TypeScript现在可以自动推断每个开关情况中的动作类型，并自动完成它(这就是为什么动作类型被定义为<code class="fe mf mg mh mi b">Type extends string</code>)！这将有助于开发人员更好地理解代码，给他们信心，在需要的时候轻松地重构动作和reducers，总之会给开发人员带来极好的体验。</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/5b8bf9bee8fd5fc700b59feac2379799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xpSGCIsijKcvtfJDhs3eBw.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Auto-complete for action with meta</figcaption></figure><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mp"><img src="../Images/ba89bd50d55500ef910ef333ee7e32c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5TvB-TIniqYidlD2OFpmVw.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Auto-complete for action with payload</figcaption></figure><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mq"><img src="../Images/143275f7bdb4c68617c450a0ccbfc4b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joxK2NPBEd2EmsMZ4oovjQ.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Auto-complete for action with payload and meta</figcaption></figure><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/23c2d4609e9bd3d67a4b16308577c5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/1*bAGOoSr6XuD7NL0rnLG7Jg.gif"/></div></figure><p id="9c68" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我相信还有其他方法可以给actions和reducers增加类型安全。我们已经在<a class="ae me" href="https://clumio.com/" rel="noopener ugc nofollow" target="_blank"> Clumio </a>的应用中使用了本文中概述的方法，它很有价值。</p><h2 id="2296" class="ms la in bd lb mt mu dn lf mv mw dp lj kg mx my ln kk mz na lr ko nb nc lv nd bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="1ac0" class="pw-post-body-paragraph jv jw in jx b jy lx ka kb kc ly ke kf kg lz ki kj kk ma km kn ko mb kq kr ks ig bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物:<a class="ae me" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="jx io">AI in Plain English</strong></a>，<a class="ae me" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="jx io">UX in Plain English</strong></a>，<a class="ae me" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="jx io">Python in Plain English</strong></a><strong class="jx io"/>——谢谢，继续学习！</p><p id="4ad8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae me" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">submissions @ plain English . io</strong></a><strong class="jx io"/>，使用您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>