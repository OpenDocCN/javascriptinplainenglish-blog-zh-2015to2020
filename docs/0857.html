<html>
<head>
<title>Writing Your Very First Neural Network in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript编写你的第一个神经网络</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/writing-your-very-first-neural-network-in-javascript-e5be554acfac?source=collection_archive---------3-----------------------#2019-12-23">https://javascript.plainenglish.io/writing-your-very-first-neural-network-in-javascript-e5be554acfac?source=collection_archive---------3-----------------------#2019-12-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bbb9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用TensorFlow.js的机器学习</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ef7c7a8f4aaf01b7b890e46dea67fdee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GVni5-wV7QIxpgvR"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@sanderweeteling?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sander Weeteling</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://www.webtips.dev/writing-your-very-first-neural-network-in-javascript"><div class="gh gi kw"><img src="../Images/c19cb3069af1beba3c93258d9fcfe139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*-PVzecNs3s4ZbJsdsgIsGA.png"/></div></a></figure><p id="f6fe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在过去的几年里，我们已经看到许多机器学习库在JavaScript社区中出现，允许前端开发人员将人工智能引入网络，并使用易于使用的API解决复杂的问题。</p><p id="5eb1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">TensorFlow是最流行的开源机器学习平台之一，主要与Python一起使用。2018年，谷歌宣布了第一个面向JavaScript的TensorFlow版本，名为TensorFlow.js。这就是我们在本教程中要探索的。</p><p id="66a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将构建一个图像分类器。在教程的最后，我们的分类器将能够区分图像之间的圣诞老人和一个日常的老人。但要开始，我们首先需要了解什么是神经网络。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="42b2" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">神经网络如何工作</h1><p id="88d4" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">在深入研究编码之前，我们需要了解几个概念。如果您已经熟悉神经网络，那么您可以跳过这一部分，直接进入编码。否则，请继续阅读，因为我将在整个教程中参考这里提到的内容。让我们先看看什么是神经网络？</p><h2 id="7e8c" class="mx mb iq bd mc my mz dn mg na nb dp mk lg nc nd mm lk ne nf mo lo ng nh mq ni bi translated">神经网络</h2><p id="8cb4" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">其中涉及到许多技术细节，但为了让您简单了解一下，神经网络是受我们大脑中生物神经网络启发的机器学习算法。它们用于模式识别，由称为神经元的节点组成，通过突触权重连接在一起。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/1449cc6b0bce84e528130e3baae12e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxlcTC8PLQkb4ValgXe4lg.png"/></div></div></figure><h2 id="3da0" class="mx mb iq bd mc my mz dn mg na nb dp mk lg nc nd mm lk ne nf mo lo ng nh mq ni bi translated">模型</h2><p id="510b" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">当这些机器学习算法用数据训练时，我们得到一个模型作为输出。它代表了培训过程。模型可用于未来的预测。</p><h2 id="4702" class="mx mb iq bd mc my mz dn mg na nb dp mk lg nc nd mm lk ne nf mo lo ng nh mq ni bi translated">功能和标签</h2><p id="e9c2" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">输入模型的数据通常由要素和标签组成。特征是与数据集中的每个样本相关联的属性。一个典型的例子是基于特征(如萼片和花瓣的宽度)对鸢尾花进行分类。</p><p id="3c4b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">标签代表了您对每个样本的分类方式。继续这个例子，根据你的特征，你把条目分类到一个自由物种中。它要么获得“濑户鸢尾”、“海滨鸢尾”或“花斑鸢尾”的标签。</p><p id="e2b0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">既然我们已经把一切都解决了，让我们看看我们最终会得到什么。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="cc1f" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">本教程的最终输出</h1><p id="b77d" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">在教程的最后，我们将有一个应用程序，你可以在两个不同的图像集上训练:圣诞老人和老人。一旦你有了足够的数据，应用程序将能够预测图像是关于什么的，而永远不会看到它。</p><p id="9e59" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我将在<a class="ae kv" href="https://codesandbox.io/" rel="noopener ugc nofollow" target="_blank">代码沙箱</a>上提供整个项目，所以你可以对它进行调整。你会在教程的最后找到一个链接。还有一个关于我们的应用程序如何工作的好礼物:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/8c434fdde4d6b3f82d878c8c0df0b8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0rpojyb0TGxVBSov0vZ6aA.gif"/></div></div></figure><p id="6044" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您可以将图像拖到画布元素上，并通过单击下面的按钮之一来训练分类器。一旦你有了足够的数据，你就可以拖动一个新的图像并预测上面有什么。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="3826" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">拉入依赖项</h1><p id="063b" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">我们的第一步是把我们需要的东西都拉进来。我们将使用<a class="ae kv" href="https://www.tensorflow.org/js" rel="noopener ugc nofollow" target="_blank"> TensorFlow.js </a>和一个流行的预训练模型MobileNet进行图像分类。然后，我们将使用一种称为迁移学习的技术，用我们自己的定制训练集来扩展预训练模型。为此，我们需要一个分类器。我们将使用K-最近邻模块。它将允许我们对图像进行分类，一旦我们使用预测，它将选择最适合该图像的类别。</p><p id="134e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这意味着我们将有3个依赖项:TensorFlow、MobileNet和KNN分类器模块。这是我们将要处理的整个文档:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="9e15" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在主体关闭之前，我们将有两个不同的脚本。一个用于分类器，一个用于处理UI事件。</p><p id="eee7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您可能还会注意到canvas元素有一个真正特定的宽度和高度。这是因为预训练模型已经用224x224px图像进行了训练。为了匹配数据的格式，我们必须使用相同的大小。您仍然可以处理更大的图像，只需在将数据输入分类器之前调整数据大小。</p><p id="edaf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在开始处理分类器之前，让我们快速地将UI组装起来。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="b902" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">创建用户界面</h1><p id="9c23" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">创建一个名为<code class="fe nn no np nq b">ui.js</code>的新文件。我们将通过拖放使画布接受图像。首先，获取画布及其上下文，并为其附加一些事件侦听器:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="f9b6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们需要处理两个事件:T1和T2。<code class="fe nn no np nq b">onDrop</code>将图像绘制到画布上，而<code class="fe nn no np nq b">dragover</code>仅阻止默认动作发生。这是必需的，因为没有它，图像将在同一个选项卡上打开。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/b08c40f887bdec976565421d9278678d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lJYJruwsifetBiQt6bNOyw.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Without preventing the default action, the page is reloaded</figcaption></figure><p id="3080" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们来看看<code class="fe nn no np nq b">onDrop</code>函数里面有什么。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="af62" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">第一件事是防止默认动作，就像我们对<code class="fe nn no np nq b">dragover</code>所做的那样。接下来，我们想从拖放到画布上的文件中获取数据。我们可以用<code class="fe nn no np nq b">e.dataTransfer.files[0]</code>得到。然后我们想创建一个新的<code class="fe nn no np nq b">FileReader</code>对象，并将文件作为数据URL读取。我们还想为它的<code class="fe nn no np nq b">onload</code>事件创建一个函数。当<code class="fe nn no np nq b">reader</code>完成读取文件时，我们创建一个新的<code class="fe nn no np nq b">Image</code>对象，并将其源设置为<code class="fe nn no np nq b">file.target.result</code>。这将保存base64编码的图像数据。一旦图像被创建，我们就把它画在画布上。记住，我们需要将其缩放到224x244。</p><p id="bb60" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">同样在这里，让我们快速地向按钮添加事件侦听器，然后我们可以开始创建分类器。我们有3个按钮和3个事件监听器:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="b76f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将有一个接受一个参数的<code class="fe nn no np nq b">addExample</code>函数:类别的标签。而且我们会有一个<code class="fe nn no np nq b">predict</code>函数。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="e265" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">构建分类器</h1><p id="3dc8" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">我们将在一个名为<code class="fe nn no np nq b">classifier.js</code>的新文件中创建这两个函数。但是首先，我们需要创建一个分类器并加载到MobileNet中。为此，将以下函数添加到<code class="fe nn no np nq b">classifier.js</code>并调用它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="6551" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">稍后将使用分类器和模型。所以我在函数外面为它们创建了两个变量。模型加载需要一些时间，而且是异步的，因此我们使用<code class="fe nn no np nq b">async</code> / <code class="fe nn no np nq b">await</code>。一旦加载完毕，我们可以隐藏加载信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/8fad1f847107ab4ab84d59647a4cf0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*t4mwl7ZQXxpokgo-dYCUnA.gif"/></div></div></figure><p id="78a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了用我们自己的定制数据集扩展模型，我们必须添加我们自己的例子。为此，每当用户点击“圣诞老人”或“老人”时，我们调用<code class="fe nn no np nq b">addExample</code>函数。</p><h2 id="3fa9" class="mx mb iq bd mc my mz dn mg na nb dp mk lg nc nd mm lk ne nf mo lo ng nh mq ni bi translated">添加示例</h2><p id="0e2f" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">该函数将执行以下操作:</p><ul class=""><li id="9e33" class="ns nt iq kz b la lb ld le lg nu lk nv lo nw ls nx ny nz oa bi translated">从画布中获取图像数据</li><li id="2ed1" class="ns nt iq kz b la ob ld oc lg od lk oe lo of ls nx ny nz oa bi translated">使用MobileNet获取检索到的数据的特征</li><li id="7b89" class="ns nt iq kz b la ob ld oc lg od lk oe lo of ls nx ny nz oa bi translated">通过向分类器添加一个使用功能和关联标签的示例来训练分类器</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="e739" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，我们使用<code class="fe nn no np nq b">ft.browser.fromPixels</code>从画布中获取像素值。接下来，我们使用MobileNet的<code class="fe nn no np nq b">infer</code>方法获取特性。之后，要添加示例，我们可以简单地在带有特征和标签的分类器上调用<code class="fe nn no np nq b">addExample</code>。</p><p id="06ff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后我们需要更新DOM元素。我们清空画布，这样我们可以添加一个新的例子。我们还需要更新按钮来告诉用户每个集合中添加了多少个示例。为此，我创建了一个新的数组来计算例子的数量。</p><p id="ca71" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，我们可以调用<code class="fe nn no np nq b">image</code>上的<code class="fe nn no np nq b">dispose</code>来释放内存。</p><h2 id="dab6" class="mx mb iq bd mc my mz dn mg na nb dp mk lg nc nd mm lk ne nf mo lo ng nh mq ni bi translated">预测</h2><p id="5879" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">一旦我们有了必要的数据，我们就可以测试这个模型。点击“预测”，将调用与<code class="fe nn no np nq b">addExample</code>非常相似的<code class="fe nn no np nq b">predict</code>功能:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="325d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">第一件事是测试我们的数据集中是否有例子。如果我们没有添加任何例子，它不可能预测我们任何事情。这就是<code class="fe nn no np nq b">classifier.getNumClasses</code>检查的内容。</p><p id="dcb3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">就像对于<code class="fe nn no np nq b">addExample</code>来说，我们需要图像的特征，我们可以用同样的方法得到。然后我们需要调用<code class="fe nn no np nq b">classifier.predictClass</code>传入特征来获得关于图像的预测。一旦我们得到一个结果，我们清除画布，打印出预测，并处理<code class="fe nn no np nq b">image</code>对象。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/8c434fdde4d6b3f82d878c8c0df0b8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0rpojyb0TGxVBSov0vZ6aA.gif"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="9a07" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">摘要</h1><p id="c15c" class="pw-post-body-paragraph kx ky iq kz b la ms jr lc ld mt ju lf lg mu li lj lk mv lm ln lo mw lq lr ls ij bi translated">现在我们的图像分类器像预期的那样工作。在用两组图像训练模型之后，我们可以有把握地预测下一幅图像。</p><p id="32b9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要获得完整的源代码并对项目进行调整，请访问<a class="ae kv" href="https://codesandbox.io/s/zealous-gates-g9hk9" rel="noopener ugc nofollow" target="_blank"> codesandbox.io </a>。也可以从<a class="ae kv" href="https://github.com/flowforfrank/classifier" rel="noopener ugc nofollow" target="_blank"> GitHub </a>克隆。这是我今年的最后一个教程，但我会在下一个十年带着新的主题回来。感谢您通读！</p><p id="40e2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，我想祝你圣诞快乐，新年快乐！🎄 🎉</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://medium.com/@ferencalmasi/membership"><div class="gh gi og"><img src="../Images/e66c4cd6d9849ac0bd245f3fc39b65c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZ9xuLqLkbqUG65sgVB3gg.png"/></div></a></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://www.webtips.dev/how-to-easily-add-emotion-detection-to-your-app-with-face-api-js"><div class="gh gi kw"><img src="../Images/132551be9e8ecb77e5dfcb2169fb0e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*ZDjAgCnkn5Nr4zd0haZ5Yw.png"/></div></a></figure></div></div>    
</body>
</html>