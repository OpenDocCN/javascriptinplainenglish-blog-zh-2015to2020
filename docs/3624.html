<html>
<head>
<title>TypeScript Strict mode: Turn it on immediately without refactoring for months!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript严格模式:几个月不重构立即打开！</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typescript-strict-mode-turn-it-on-immediately-without-refactoring-for-months-13b440cac9c0?source=collection_archive---------5-----------------------#2020-10-13">https://javascript.plainenglish.io/typescript-strict-mode-turn-it-on-immediately-without-refactoring-for-months-13b440cac9c0?source=collection_archive---------5-----------------------#2020-10-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/2118ed391acb9e3dd670f28710e1f316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uDAkRvYPY-IUdNm6"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@acharki95?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Aziz Acharki</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="80cd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">TypeScript使我们能够利用类型安全和代码文档来改进JavaScript应用程序的架构。然而，默认情况下，它不会打开“严格模式”,以降低新适配器的准入门槛。Angular采用了同样的方法。除非明确指定，否则在生成新的角度应用时，它不会切换到严格模式。这可能会妨碍我们充分利用TypeScripts的强类型特性，这种特性允许我们在编译时检测一整类错误。</p><p id="1160" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">有一种方法可以立即获得严格模式的好处，即使您现有的应用程序有成百上千个类型脚本文件</strong>。继续阅读了解更多！</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="1be7" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">架构影响软件的经济性</h1><p id="8fd0" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">马丁·福勒给出了软件架构的一个流行定义:</p><blockquote class="mi mj mk"><p id="9df4" class="ka kb ml kc b kd ke kf kg kh ki kj kk mm km kn ko mn kq kr ks mo ku kv kw kx ig bi translated">"软件架构是那些既重要又难以改变的决定."—马丁·福勒</p></blockquote><p id="eeae" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些决定深刻地影响了添加一个新特性所花费的时间成本和精力(软件工程经济学)。</p><p id="92a8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">作为软件工程师/架构师，我们的目标是保持最高水平的内部代码质量，以确保代码库是可维护的。这确保了通过像乐高积木一样将特性插入到代码库中，并持续地将它们发送给我们的最终用户，可以快速地开发出特性。如果你想了解更多关于软件架构的知识，可以看看由<a class="ae jz" href="https://www.thoughtworks.com/books" rel="noopener ugc nofollow" target="_blank">思想工作者</a>写的<a class="ae jz" href="https://amzn.to/2Fo6uYc" rel="noopener ugc nofollow" target="_blank">这本伟大的书。</a></p><p id="0891" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe mp mq mr ms b">strict</code>标志是一个伞状标志，可同时切换以下六个标志:</p><ul class=""><li id="86c2" class="mt mu in kc b kd ke kh ki kl mv kp mw kt mx kx my mz na nb bi translated"><code class="fe mp mq mr ms b">noImplicitAny</code></li><li id="de25" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated"><code class="fe mp mq mr ms b">noImplicitThis</code></li><li id="dc78" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated"><code class="fe mp mq mr ms b">strictNullChecks</code></li><li id="5d66" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated"><code class="fe mp mq mr ms b">strictPropertyInitialization</code></li><li id="5123" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated"><code class="fe mp mq mr ms b">strictBindCallApply</code></li><li id="b579" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated"><code class="fe mp mq mr ms b">strictFunctionTypes</code></li></ul><p id="39a8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这些标志的目的是加强TypeScript提供的类型安全，以避免编译时出现一整类错误。这里有一篇文章解释这些标志。这对于减少代码库中的错误流量，降低软件熵，从而减少添加新功能的工作量/成本非常有用。但这在现实中并不容易做到。</p><h1 id="e36a" class="lf lg in bd lh li nh lk ll lm ni lo lp lq nj ls lt lu nk lw lx ly nl ma mb mc bi translated">立即打开它可能会导致1000个错误</h1><p id="0f0d" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">如果您正在处理一个具有成百上千个TypeScript文件的中型到大型应用程序，那么立即打开严格模式可能并不可行。您肯定会遇到多个编译时错误并破坏您的构建。暂停特性开发并花费几个月的工程时间来修复这些编译错误是不理想的。</p><p id="5482" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">有一种方法可以在改进代码库的类型安全性和架构的同时继续发布新特性:</strong></p><ul class=""><li id="bf8f" class="mt mu in kc b kd ke kh ki kl mv kp mw kt mx kx my mz na nb bi translated">在打开strict标志的情况下，为您的代码编辑器使用单独的<code class="fe mp mq mr ms b">tsconfig.json</code>文件</li><li id="e1c3" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated">当开发人员在文件中遇到代码编辑器显示的林挺/编译器错误时，在您的组织中设置一个规则来修复它们。</li><li id="a038" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated">专业提示:在CI/CD管道中添加一个构建步骤，使用strict <code class="fe mp mq mr ms b">tsconfig.json</code>文件构建您的应用程序，为每个版本生成一个报告，以绘制和监控编译器错误数量随时间减少的情况</li></ul><figure class="nn no np nq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/4a023ee9938e8f145013ab726776bf59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p7ZwpaRA7IAWPYiU"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@mahiruysal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mahir Uysal</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="238f" class="lf lg in bd lh li nh lk ll lm ni lo lp lq nj ls lt lu nk lw lx ly nl ma mb mc bi translated">诀窍是</h1><p id="1222" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">如果我们能为VSCode设置一个自定义的<code class="fe mp mq mr ms b">tsconfig.json</code>就好了(我假设我们大多数人都在使用vscode)。但是由于根据这个Github问题这还不可能，我们可以使用一个变通方法。让我们假设您正在使用一个<a class="ae jz" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular </a>应用程序，但是这个技巧适用于浏览器或节点运行时中的任何TypeScript应用程序</p><ul class=""><li id="8157" class="mt mu in kc b kd ke kh ki kl mv kp mw kt mx kx my mz na nb bi translated">将您的tsconfig.json文件重命名为<code class="fe mp mq mr ms b">tsconfig.build.json</code></li><li id="69eb" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated">在您的项目根目录下运行<code class="fe mp mq mr ms b">tsc --init --strict</code>来创建一个<code class="fe mp mq mr ms b">tsconfig.json</code>文件，打开严格标志进行严格的类型检查</li><li id="103f" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated">修改<code class="fe mp mq mr ms b">tsconfig.app.json</code>文件以扩展<code class="fe mp mq mr ms b">tsconfig.build.json</code>和<code class="fe mp mq mr ms b">tsconfig.spec.json</code>并保存。</li></ul><figure class="nn no np nq gt jo"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="12bb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了🎉🎉🎉</p><p id="7627" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们已经让VSCode使用新创建的<code class="fe mp mq mr ms b">tsconfig.json</code></p><p id="0b98" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">现在，您将在不破坏Angular/Webpack构建的情况下收到针对您的TypeScript文件中的严格键入错误的视觉反馈</strong></p><h1 id="c62b" class="lf lg in bd lh li nh lk ll lm ni lo lp lq nj ls lt lu nk lw lx ly nl ma mb mc bi translated">警告</h1><p id="3ded" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">像任何伟大的决定一样，总会有权衡取舍。通过使用此解决方案，我们将注意到以下注意事项:</p><ul class=""><li id="eeb6" class="mt mu in kc b kd ke kh ki kl mv kp mw kt mx kx my mz na nb bi translated">大多数TypeScript文件中都会出现许多错误，这可能会令人望而生畏</li><li id="cca6" class="mt mu in kc b kd nc kh nd kl ne kp nf kt ng kx my mz na nb bi translated">由于严格模式，很难将正在进行的开发中的新错误与先前存在的错误区分开来，这些新错误可能会破坏构建</li></ul><p id="d352" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然而，在我看来，在编辑器中显示错误的好处超过了它的不便。</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="2dcd" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">摘要</h1><p id="5d37" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">作为软件工程师/架构师，我们的主要目标之一是保持应用程序的高质量。在本文中，我们看到了如何在现有的大中型应用程序中启用严格的类型检查设置。我们学会了如何立即利用严格的类型检查，而无需重构成百上千的错误。我们学习了如何使用它来检测代码编辑器中的输入错误，从而在编译时消除许多错误。我们还了解到，所有的架构决策总是有权衡。</p><p id="ae37" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢你的阅读，我希望这能帮助你，就像它帮助了我一样。</p><p id="7659" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我很想在下面的评论中知道这是否有用！</p><p id="49d8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">可以在<a class="ae jz" href="https://github.com/nivrith" rel="noopener ugc nofollow" target="_blank"> GitHub </a>或者<a class="ae jz" href="https://twitter.com/_Nivrith_" rel="noopener ugc nofollow" target="_blank"> Twitter </a> <br/>快乐工程上关注我！</p></div></div>    
</body>
</html>