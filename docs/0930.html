<html>
<head>
<title>JavaScript Performance Issues?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript性能问题？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-performance-issues-6edaee6db7b1?source=collection_archive---------11-----------------------#2020-01-03">https://javascript.plainenglish.io/javascript-performance-issues-6edaee6db7b1?source=collection_archive---------11-----------------------#2020-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a6d2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">初学者加载JS代码以获得更好性能的一些技巧</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6cc1238b53737a81fb53b9700ce1a4ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*snQIrziO4ebhbtVx"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@marcojodoin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marc-Olivier Jodoin</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f07f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">浏览器要运行JavaScript代码，需要下载代码，解析代码，然后运行代码命令浏览器做的任何事情。每个步骤的执行都需要时间；脚本文件越多，执行的时间就越长。并且在错误的时间加载脚本文件，也会阻止其他一些内容..猜猜接下来会发生什么？</p><blockquote class="lp lq lr"><p id="d13b" class="kt ku ls kv b kw kx jo ky kz la jr lb lt ld le lf lu lh li lj lv ll lm ln lo ig bi translated">你开始抱怨你的应用程序像蜗牛一样慢！</p></blockquote><h1 id="7509" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated"><em class="mo">JavaScript中的脚本是如何加载的？</em></h1><p id="f9f0" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">当您的浏览器遇到HTML文件中的任何<em class="ls"> &lt;脚本&gt; </em>标签时，所有其他操作都会暂停，直到<em class="ls"> &lt;脚本&gt; </em>标签被成功解析。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">loading script in an HTML file</figcaption></figure><p id="0e78" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您的浏览器现在将向服务器请求一个文件名为<em class="ls"> sampleScript.js </em>的脚本，然后下载它进行解析和执行。但是请记住，在这一切发生的同时，浏览器的呈现是被阻塞的。(浏览器上显示的所有可视内容将被保留)</p><h1 id="b7bb" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated"><strong class="ak">我现在在哪里加载我的JS脚本？</strong></h1><p id="c3fe" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">通常建议将所有脚本加载到HTML页面底部的<em class="ls"> &lt; body &gt; </em>标签下，这将使浏览器能够很快加载它们。但是等等。本文不仅仅是关于在底层加载脚本，还有更多内容。这可以进一步优化以获得更好的性能。</p><p id="4f9d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="ls"> &lt;脚本&gt; </em>标签附带了两个新属性，称为<strong class="kv io"> async </strong>和<strong class="kv io"> defer </strong>，帮助脚本更高效地执行。</p><p id="7115" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> async </strong>属性负责告诉浏览器异步下载脚本，并在完成下载后立即执行。这样就不会阻碍整个渲染过程。它是这样使用的。</p><pre class="kd ke kf kg gt mw mx my mz aw na bi"><span id="c7d0" class="nb lx in mx b gy nc nd l ne nf">&lt;script src="sampleScript.js" <!-- -->async<!-- -->&gt;&lt;/script&gt;</span></pre><p id="76ca" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> defer </strong>属性比async更好。它异步下载脚本，然后在页面解析完成后执行代码。像async属性一样，这也可以防止渲染阻塞。</p><pre class="kd ke kf kg gt mw mx my mz aw na bi"><span id="d063" class="nb lx in mx b gy nc nd l ne nf">&lt;script src="sampleScript.js" defer&gt;&lt;/script&gt;</span></pre><blockquote class="lp lq lr"><p id="9ed7" class="kt ku ls kv b kw kx jo ky kz la jr lb lt ld le lf lu lh li lj lv ll lm ln lo ig bi translated"><strong class="kv io">警告</strong>:不能同时使用<strong class="kv io">异步</strong>和<strong class="kv io">延时</strong>。这样做，可以冻结您的应用程序或网页</p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/1ba817099694859690685a3cb3493a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DnfyyKiphiESGpRugjgeDA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">normal script VS script async VS script defer</figcaption></figure><h1 id="1054" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">除了这两个属性，还有更好的方法吗？</h1><p id="6c10" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">是的。不要绝望。在渲染网页时尽可能晚地加载脚本的常用方法是使用<strong class="kv io"> load </strong>事件。只有在下载了所有资源(如样式表、图像和脚本)之后，才会触发此事件。</p><p id="2a68" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要使用这个加载事件，我们需要创建一个<em class="ls">窗口</em>事件侦听器，并将<em class="ls">加载</em>事件绑定到它。现在在回调函数内部，创建一个<em class="ls"> &lt;脚本&gt; </em>标记，添加<em class="ls"> src </em>属性并将其附加到文档正文中。通过这样做，我们可以确保当视觉效果全部下载并出现在页面上时，脚本被加载。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="76ef" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">结论</h1><p id="bb00" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">使用<strong class="kv io">异步</strong>和<strong class="kv io">延迟</strong>是开始提高页面性能的两个好方法。但是，如果您的要求是从JavaScript为顶级用户体验提供的性能中获得最大限度(UX)，那么我建议您参加<em class="ls"> load </em>事件，这将保证您看到结果。</p><p id="2315" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">资源</strong></p><p id="0ea8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://flaviocopes.com/javascript-async-defer/" rel="noopener ugc nofollow" target="_blank">https://flaviocopes.com/javascript-async-defer/</a><br/><a class="ae ks" href="https://gist.github.com/Amjad675/d73a6f0bea5ce210d12ff92882ffa1ba" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Amjad 675/d73 a6 f 0 bea 5 ce 210d 12 ff 92882 FFA 1ba</a><br/><a class="ae ks" href="https://gist.github.com/Amjad675/fab546a912a57d24fea1a4b9c3f87a33" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Amjad 675/fab 546 a912 a 57d 24 FEA 4 b 9 C3 f 87 a 33</a></p></div></div>    
</body>
</html>