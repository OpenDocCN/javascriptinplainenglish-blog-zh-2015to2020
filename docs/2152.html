<html>
<head>
<title>Add Custom Markers with the Google Maps JavaScript API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌地图JavaScript API添加自定义标记</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/add-custom-markers-with-the-google-maps-javascript-api-43e8b83f4f7d?source=collection_archive---------0-----------------------#2020-05-25">https://javascript.plainenglish.io/add-custom-markers-with-the-google-maps-javascript-api-43e8b83f4f7d?source=collection_archive---------0-----------------------#2020-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9188" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">2020年更新的解决方案，关于如何使用JavaScript将谷歌地图添加到您的网站，并根据客户标记进行调整</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/10f92bdca60abe817cd0619d1c64fa31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-d11iVWHc3hJNrPyjFpcA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@m_weber?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Mackenzie Weber</a> on <a class="ae kv" href="https://unsplash.com/s/photos/maps?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b5a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有很多关于如何使用Google Maps API在你的网站上实现地图的教程，但是大部分都是旧的，没有很好的整合在一起。在本文中，我将介绍如何创建地图，添加标记，如何为标记添加自定义图标，以及如何添加弹出叠加图。</p><p id="d94b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们开始之前，您需要有一个Google API密钥，因此要做到这一点，我们必须转到<a class="ae kv" href="https://console.developers.google.com/apis" rel="noopener ugc nofollow" target="_blank"> Google API控制台</a>并创建一个项目(您创建的这个项目不只是用于Google Maps。它支持很多API)。创建项目后，您需要转到Maps JavaScript并启用它。在“凭据”选项卡中，您可以创建API密钥。</p><p id="99d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">还可以查看</em><a class="ae kv" href="https://apilayer.com/?utm_source=plainenglish&amp;utm_medium=Leads%20Acquisition&amp;utm_content=apilayer" rel="noopener ugc nofollow" target="_blank"><em class="ls">API layer</em></a><em class="ls">，这是一套提升生产力的Web APIs和基于云的微服务应用。</em></p><p id="cc40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在一切都准备好了，让我们开始吧。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="56b6" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">设置地图</h1><p id="2100" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">首先，创建一个HTML文件，并从<a class="ae kv" href="https://developers.google.com/maps/documentation/javascript/tutorial" rel="noopener ugc nofollow" target="_blank">谷歌地图文档</a>中复制脚本</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="89e5" class="nc mb iq my b gy nd ne l nf ng">&lt;div id="map"&gt;&lt;/div&gt;<br/>&lt;script src="https://maps.googleapis.com/maps/api/js?key=<strong class="my ir">YOUR_API_KEY</strong>&amp;callback=initMap" async defer&gt;&lt;/script&gt;</span></pre><p id="ea23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在请注意，它有一个名为<code class="fe nh ni nj my b">callback</code>的参数，该参数被设置为<code class="fe nh ni nj my b">initMap</code>。所以它将加载一个名为<code class="fe nh ni nj my b">initMap</code>的函数。我们要做的是将<code class="fe nh ni nj my b">function initMap</code>放入我们的JavaScript文件中。在<code class="fe nh ni nj my b">initMap</code>中，我们必须设置一个名为map的变量，并设置一个新的Google Map对象。</p><blockquote class="nk nl nm"><p id="136b" class="kw kx ls ky b kz la jr lb lc ld ju le nn lg lh li no lk ll lm np lo lp lq lr ij bi translated">出于开发目的，您可以通过添加<code class="fe nh ni nj my b">js?v=3.exp</code>来添加没有API键的地图</p></blockquote><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="b11a" class="nc mb iq my b gy nd ne l nf ng">function initMap() {<br/>   var options = {<br/>      zoom:10,<br/>      center: { lat:40.730610, lng:-73.935242} //Coordinates of New York <br/>   }</span><span id="b4f0" class="nc mb iq my b gy nq ne l nf ng">var map = new google.maps.Map(document.getElementById('map'), options);</span><span id="543b" class="nc mb iq my b gy nq ne l nf ng">}</span></pre><p id="64ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在如果你保存并重新加载，你将不会在网站上看到任何东西。那是因为我们还没有为我们的地图设置高度和宽度。因此，您必须将这几行代码添加到CSS文件中</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="e653" class="nc mb iq my b gy nd ne l nf ng">#map {<br/>   height: 400px;<br/>   width: 100%;<br/>}</span></pre><p id="67e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一张以纽约市为中心的地图。</p><h1 id="09ab" class="ma mb iq bd mc md nr mf mg mh ns mj mk jw nt jx mm jz nu ka mo kc nv kd mq mr bi translated">添加自定义标记</h1><p id="dc29" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">要添加自定义标记，您需要创建一个变量并将其设置为<code class="fe nh ni nj my b">google.maps.Markers()</code>,并给出放置标记的对象位置</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="a3d4" class="nc mb iq my b gy nd ne l nf ng">var marker = new google.maps.Marker({<br/>   position:{lat: 40.6782, lng: -73.9442}, // Brooklyn Coordinates<br/>   map:map //Map that we need to add<br/>   icon:'<a class="ae kv" href="https://img.icons8.com/fluent/48/000000/marker-storm.png" rel="noopener ugc nofollow" target="_blank">https://img.icons8.com/fluent/48/000000/marker-storm.png</a>',<br/>   // adding custom icons (Here I used a Flash logo marker)<br/>   draggarble: false// If set to true you can drag the marker<br/>});</span></pre><p id="12ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们继续添加一个包含一些信息或内容的弹出窗口，为此我们要做的是在<code class="fe nh ni nj my b">marker</code>下创建一个名为<code class="fe nh ni nj my b">infomation</code>的变量，并将其设置为<code class="fe nh ni nj my b">google.maps.InfoWindow</code>，该变量将接收一个包含我们想要的内容的对象。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="4620" class="nc mb iq my b gy nd ne l nf ng">var information = new google.maps.InfoWindow({<br/>   content: '&lt;h4&gt;The marker is at Brooklyn&lt;/h4&gt;'<br/>});</span></pre><p id="22b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这本身不会做任何事情，所以我们需要添加一个事件监听器来监听那个信息窗口</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="a559" class="nc mb iq my b gy nd ne l nf ng">marker.addListener('click', function() {<br/>   information.open(map, marker);<br/>});</span></pre><p id="de79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们看看我们到目前为止完成的所有代码是什么样子的，</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://jsfiddle.net/c6shrnbw/6/" rel="noopener ugc nofollow" target="_blank">https://jsfiddle.net/c6shrnbw/6/</a></figcaption></figure><p id="34ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是如何添加带有自定义图标和信息窗口的单个标记。</p><h1 id="f176" class="ma mb iq bd mc md nr mf mg mh ns mj mk jw nt jx mm jz nu ka mo kc nv kd mq mr bi translated">添加多个标记</h1><p id="4477" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">当您需要添加多个标记时，使用一个函数而不硬编码坐标是非常有效的。让我们看看如何做到这一点，</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="8313" class="nc mb iq my b gy nd ne l nf ng">function addMarker(coordinates) {<br/>   var marker = new google.maps.Marker({<br/>      position: coordinates, // Passing the coordinates<br/>      map:map, //Map that we need to add<br/>      draggarble: false// If set to true you can drag the marker<br/>   });<br/>}</span><span id="92a7" class="nc mb iq my b gy nq ne l nf ng">addMarker({lat: 40.6782, lng: -73.9442}); // Brooklyn Coordinates<br/>addMarker({lat: 40.7831, lng: -73.9712}); // Manhattan Coordinates</span></pre><p id="4471" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以更改传递属性，并为每个标记设置不同的自定义图标。但是当您为一些标记添加自定义图标时，保持默认标记图标不变并不是最佳选择。传递这些标记的内容信息也是如此。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="5269" class="nc mb iq my b gy nd ne l nf ng">function addMarker(prop) {<br/>   var marker = new google.maps.Marker({<br/>      position: prop.coordinates, // Passing the coordinates<br/>      map:map, //Map that we need to add<br/>      draggarble: false// If set to true you can drag the marker<br/>   });</span><span id="2879" class="nc mb iq my b gy nq ne l nf ng">   if(prop.iconImage) { marker.setIcon(prop.iconImage); }</span><span id="8aed" class="nc mb iq my b gy nq ne l nf ng">   if(prop.content) { <br/>      var information = new google.maps.InfoWindow({<br/>      content: prop.content<br/>      });<br/>      <br/>      marker.addListener('click', function() {<br/>      information.open(map, marker);<br/>      });<br/>   }<br/>}</span><span id="5960" class="nc mb iq my b gy nq ne l nf ng">addMarker({<br/>   coordinates:{lat: 40.6782, lng: -73.9442},<br/>   iconImage:'<a class="ae kv" href="https://img.icons8.com/fluent/48/000000/marker-storm.png" rel="noopener ugc nofollow" target="_blank">https://img.icons8.com/fluent/48/000000/marker-storm.png</a>',<br/>   content:'&lt;h4&gt;Brooklyn Marker&lt;/h4&gt;'<br/>});<br/>addMarker({<br/>   coordinates:{lat: 40.7831, lng: -73.9712} // Manhattan Marker<br/>}); </span></pre><p id="0800" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看使用JSFiddle的结果，</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://jsfiddle.net/c6shrnbw/9/" rel="noopener ugc nofollow" target="_blank">JSFiddle</a></figcaption></figure><p id="5817" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过将所有标记属性添加到一个数组中，可以进一步优化这一点。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6ab0" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="88cc" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这些是你可以用谷歌地图JavaScript API做的一些事情。文章到此为止。谢谢，注意安全！</p><p id="796a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">更多内容看</em><a class="ae kv" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">plain English . io</em></strong></a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="be4b" class="nc mb iq bd mc ny nz dn mg oa ob dp mk lf oc od mm lj oe of mo ln og oh mq oi bi translated">资源</h2><ul class=""><li id="ca57" class="oj ok iq ky b kz ms lc mt lf ol lj om ln on lr oo op oq or bi translated"><a class="ae kv" href="https://developers.google.com/maps/documentation/javascript/tutorial" rel="noopener ugc nofollow" target="_blank">谷歌地图文档</a></li><li id="a27b" class="oj ok iq ky b kz os lc ot lf ou lj ov ln ow lr oo op oq or bi translated"><a class="ae kv" href="https://jsfiddle.net/" rel="noopener ugc nofollow" target="_blank"> JSFiddle </a></li></ul></div></div>    
</body>
</html>