<html>
<head>
<title>Creating Dynamic Forms with Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用角度创建动态表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-dynamic-forms-with-angular-b126d3968695?source=collection_archive---------7-----------------------#2020-04-18">https://javascript.plainenglish.io/creating-dynamic-forms-with-angular-b126d3968695?source=collection_archive---------7-----------------------#2020-04-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1fea1c79264ebaf89f1293fb2c988f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SRsarZiu55DgfA7c"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@vincentvanzalinge?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Vincent van Zalinge</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f2d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Angular是Google制作的一个流行的前端框架。像其他流行的前端框架一样，它使用基于组件的架构来构建应用程序。</p><p id="2ace" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Angular构建动态表单。</p><h1 id="4a46" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">动态表单</h1><p id="8869" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用表单组轻松构建动态表单。</p><p id="3a4c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">动态表单从源获取数据，然后我们使用角度表单组将它们转换成表单。</p><p id="2d60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个简单的例子如下:</p><p id="ff62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.module.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="76ba" class="mq lc iq mh b gy mr ms l mt mu">import { BrowserModule } from "@angular/platform-browser";<br/>import { NgModule } from "@angular/core";<br/>import { ReactiveFormsModule } from "@angular/forms";<br/>import { AppComponent } from "./app.component";</span><span id="d2d4" class="mq lc iq mh b gy mv ms l mt mu">@NgModule({<br/>  declarations: [AppComponent],<br/>  imports: [BrowserModule, ReactiveFormsModule],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule {}</span></pre><p id="edf9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="37a1" class="mq lc iq mh b gy mr ms l mt mu">import { Component } from "@angular/core";<br/>import { FormControl, FormGroup, Validators } from "@angular/forms";</span><span id="3670" class="mq lc iq mh b gy mv ms l mt mu"><a class="ae kc" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: "app-root",<br/>  templateUrl: "./app.component.html",<br/>  styleUrls: ["./app.component.css"]<br/>})<br/>export class AppComponent {<br/>  questions = [<br/>    {<br/>      key: "name",<br/>      question: "What's your name?",<br/>      required: true,<br/>      controlType: "text"<br/>    },<br/>    {<br/>      key: "age",<br/>      question: "What's your age?",<br/>      required: false,<br/>      controlType: "number"<br/>    }<br/>  ];<br/>  questionsForm;</span><span id="b1c7" class="mq lc iq mh b gy mv ms l mt mu">  constructor() {<br/>    this.questionsForm = this.toFormGroup(this.questions);<br/>  }</span><span id="8017" class="mq lc iq mh b gy mv ms l mt mu">  toFormGroup(questions) {<br/>    let group: any = {};</span><span id="52de" class="mq lc iq mh b gy mv ms l mt mu">    questions.forEach(question =&gt; {<br/>      group[question.key] = question.required<br/>        ? new FormControl(question.value || "", Validators.required)<br/>        : new FormControl(question.value || "");<br/>    });<br/>    return new FormGroup(group);<br/>  }<br/>}</span></pre><p id="6a82" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fabb" class="mq lc iq mh b gy mr ms l mt mu">&lt;div [formGroup]="questionsForm"&gt;<br/>  &lt;div *ngFor="let question of questions"&gt;<br/>    &lt;label [attr.for]="question.key"&gt;{{question.label}}&lt;/label&gt;</span><span id="4165" class="mq lc iq mh b gy mv ms l mt mu">    &lt;div&gt;<br/>      &lt;input<br/>        [formControlName]="question.key"<br/>        [id]="question.key"<br/>        [type]="question.controlType"<br/>        [placeholder]="question.question"<br/>      /&gt;<br/>    &lt;/div&gt;</span><span id="59e2" class="mq lc iq mh b gy mv ms l mt mu">    &lt;div *ngIf="questionsForm.controls[question.key]?.errors?.required"&gt;<br/>      {{question.question}} is required<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="5f22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们导入了<code class="fe me mf mg mh b">AppModuke</code>中的<code class="fe me mf mg mh b">ReactiveFormsModule</code>。</p><p id="424e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">AppComponent</code>中，我们有一个<code class="fe me mf mg mh b">questions</code>数组，里面有问题类型，不管它是否是必需的，以及我们用于表单控件名称的键。</p><p id="23b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个<code class="fe me mf mg mh b">toFormGroup</code>对象来遍历<code class="fe me mf mg mh b">questions</code>数组，然后用从<code class="fe me mf mg mh b">questions</code>条目的字段创建的<code class="fe me mf mg mh b">FormControl</code>来创建<code class="fe me mf mg mh b">FormGroup</code>。</p><p id="c4bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一个<code class="fe me mf mg mh b">questions</code>条目的<code class="fe me mf mg mh b">required</code>被设置为<code class="fe me mf mg mh b">true</code>，那么我们将<code class="fe me mf mg mh b">Validators.required</code>验证器添加到我们的<code class="fe me mf mg mh b">FormGroup</code>中。</p><p id="2e08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在问题被添加为<code class="fe me mf mg mh b">FormControl</code> s后，我们返回<code class="fe me mf mg mh b">FormGroup</code>。</p><p id="6601" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的模板中，我们用<code class="fe me mf mg mh b">*ngFor</code>遍历<code class="fe me mf mg mh b">questions</code>数组，然后根据每个<code class="fe me mf mg mh b">questions</code>条目中的值设置输入元素中的字段。</p><p id="11a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">控件类型、占位符、ID、<code class="fe me mf mg mh b">formControlName</code>均由<code class="fe me mf mg mh b">question</code>条目中的值设置。</p><p id="5dd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ddd0" class="mq lc iq mh b gy mr ms l mt mu">[formGroup]="questionsForm"</span></pre><p id="6fe9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将我们在<code class="fe me mf mg mh b">AppComponent</code>中创建的<code class="fe me mf mg mh b">questionsForm</code>与模板中的表单绑定。</p><p id="9467" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了显示每个字段的验证消息，我们通过编写以下代码来动态获取控件:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="04c5" class="mq lc iq mh b gy mr ms l mt mu">questionsForm.controls[question.key]</span></pre><p id="728c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其具有<code class="fe me mf mg mh b">errors</code>属性。这样，我们就可以得到它们返回的错误。</p><p id="2c42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们看到一个表单，它有两个字段，分别是姓名和年龄。姓名是文本输入，年龄是由<code class="fe me mf mg mh b">questions</code>条目的<code class="fe me mf mg mh b">controlType</code>设置的数字输入。</p><p id="b814" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们有一个空的名称字段时，我们会得到一个错误消息，直到我们键入一个名称。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/045a28865dc3e9ade9bf770bf02aecaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8tDKyAzgFq-ELtZD"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">David Clode</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="3460" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="9da0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过将来自数据源的值映射到<code class="fe me mf mg mh b">FormControls</code>来轻松创建动态表单，我们用它来填充表单组。</p><p id="abb6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的模板中，我们可以用数据源中的内容填充所有字段。</p><p id="e3a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了获得我们创建的表单组的控件，我们可以在任何地方使用表单组的<code class="fe me mf mg mh b">controls</code>来获得我们的控件。</p><h2 id="467d" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="66fe" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物:<a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"> <strong class="kf ir"> AI in Plain English </strong> </a>，<a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a>，<a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>——谢谢，继续学习！</p><p id="644b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，使用您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>