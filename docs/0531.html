<html>
<head>
<title>How to use the new composition API in Vue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Vue中使用新的合成API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-composition-api-in-vue-967fc9b8393c?source=collection_archive---------1-----------------------#2019-11-04">https://javascript.plainenglish.io/how-to-use-composition-api-in-vue-967fc9b8393c?source=collection_archive---------1-----------------------#2019-11-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2f19" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本文中，我们将在Vue2.x项目设置中使用Vue组合API，并构建一个简单的todo应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/20c7a46b67bff7f04b5e0159e2de599a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8V3z6kKx2AD-L68LgN96g.png"/></div></div></figure><p id="5403" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Composition API是最常讨论的，也是Vue下一个主要版本的新特性语法。这是使我们的逻辑可重用和组织我们的代码库的一种全新的方法。</p><h1 id="5a37" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">如何开始使用API</h1><p id="624f" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们将在现有插件的帮助下使用Vue2.x项目中的复合API，首先用Vue CLI创建我们的应用程序</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="af2f" class="mp lo iq ml b gy mq mr l ms mt">vue create composition-todo</span></pre><p id="29ac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后我们需要从命令行安装插件:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="6b41" class="mp lo iq ml b gy mq mr l ms mt">yarn add @vue/composition-api</span></pre><p id="ac6f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将用下面的代码将插件初始化到main.js文件中:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="2fe9" class="mp lo iq ml b gy mq mr l ms mt">import Vue from 'vue'<br/>import App from './App.vue'<br/>import CompositionApi from '@vue/composition-api'<br/><br/>Vue.config.productionTip = false<br/>Vue.use(CompositionApi)<br/><br/>new Vue({<br/>  render: h =&gt; h(App),<br/>}).$mount('#app')</span></pre><p id="fa01" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是我们继续使用API所需要的一切。我们将开始使用反应式、参考式、计算式、Vue生命周期等等。让我们继续处理代码，在app.vue文件中创建全新的组件，我们将从API导入reactive，并编写下面的代码</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="c803" class="mp lo iq ml b gy mq mr l ms mt">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;section&gt;<br/>      &lt;input type="text" v-model="state.todo" /&gt;<br/>      &lt;ul&gt;<br/>        &lt;li v-for="(todo, i) in state.todolist" :key="i"&gt;{{todo}}&lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/section&gt;<br/>    &lt;button <a class="ae mu" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="addTodo"&gt;Add Todo&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="58e9" class="mp lo iq ml b gy mv mr l ms mt">&lt;script&gt;<br/>import { reactive } from "<a class="ae mu" href="http://twitter.com/vue/composition-api" rel="noopener ugc nofollow" target="_blank">@vue/composition-api</a>";<br/>export default {<br/>  setup() {<br/>    const { state, addTodo } = useOurTodo();<br/>    return {<br/>      state,<br/>      addTodo<br/>    };<br/>  }<br/>};<br/>function useOurTodo() {<br/>  let state = reactive({<br/>    todo: "",<br/>    todolist: []<br/>  });<br/>  function addTodo() {<br/>    state.todolist.push(state.todo);<br/>    state.todo = "";<br/>  }<br/>  return {<br/>    state,<br/>    addTodo<br/>  };<br/>}<br/>&lt;/script&gt;</span><span id="6a10" class="mp lo iq ml b gy mv mr l ms mt">&lt;style lang="sass"&gt;<br/>&lt;/style&gt;</span></pre><p id="9e34" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们看一下上面的代码，我们可以看到我们已经创建了一个设置函数，设置了我们的反应数据属性并返回了它的值。在API的帮助下，我们能够以更具可读性和可重用性的方式构建我们的函数，相比之下，在选项API中，之前它会根据结构进行强制。我们可以把代码分成小模块。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4e5fde469cabdd20ecdc75de161b9a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jq-V4qyMS3HfBtNYXnnGTg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">comparing with Options API</figcaption></figure><p id="56c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我们将进一步将逻辑分组到不同的部分。我们将进行修改，使其结构更加合理。</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="ef9b" class="mp lo iq ml b gy mq mr l ms mt">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;section&gt;<br/>      &lt;h3&gt;My Todo List&lt;/h3&gt;<br/>      &lt;input type="text" v-model="state.todo" /&gt;<br/>      &lt;ul&gt;<br/>        &lt;li v-for="(todo, i) in state.todolist" :key="i"&gt;<br/>          {{todo}}<br/>          &lt;button @click="removeTodo(i)"&gt;x&lt;/button&gt;<br/>        &lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/section&gt;<br/>    &lt;button @click="addTodo"&gt;Add Todo&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;<br/><br/>&lt;script&gt;<br/>import { reactive } from "@vue/composition-api";<br/>export default {<br/>  setup() {<br/>    const { state, addTodo, removeTodo } = useOurTodo();<br/>    return {<br/>      state,<br/>      addTodo,<br/>      removeTodo<br/>    };<br/>  }<br/>};<br/><br/>function useOurTodo() {<br/>  let state = reactive({<br/>    todo: "",<br/>    todolist: []<br/>  });<br/><br/>  function addTodo() {<br/>    state.todolist.push(state.todo);<br/>    state.todo = "";<br/>  }<br/>  function removeTodo(i) {<br/>    state.todolist.splice(i);<br/>  }<br/>  return {<br/>    state,<br/>    addTodo,<br/>    removeTodo<br/>  };<br/>}<br/>&lt;/script&gt;<br/><br/>&lt;style lang="sass"&gt;<br/>&lt;/style&gt;</span></pre><p id="e78e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们对代码做了进一步的修改。这样，我们可以用更简洁的方式编写代码，这对我们的代码结构化和模块化很有用。类似地，我们可以使用更多提供的组合API特性，比如Props、watchers、context、Lifecycle hooks，这些将在下一篇文章中讨论。</p><p id="7181" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">代码现在得到了改进，但是它展示了逻辑分离的重要性。我们不必理解哪些数据或属性或方法属于哪个组件领域，我们现在可以简单地将它分组到可读性更好、可重用的模块化函数中。</p><p id="821b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以从Github获得代码，也请查看branch = &gt;<a class="ae mu" href="http://shorturl.at/hxU34" rel="noopener ugc nofollow" target="_blank">shorturl.at/hxU34</a></p><p id="7a3b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">*********************** —快乐编码—* * * * * * * * * * * * * * * * * * * * * * *</p><p id="c160" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">参考读物:</strong></p><div class="na nb gp gr nc nd"><a href="https://dev.to/dasdaniel/composition-api-in-vue3-2ob6" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">在Vue3中尝试合成API</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">10月4日，Vue-3代码在github.com/vuejs/vue-next公开，它仍然在alpha monorepo之前，你…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">开发到</p></div></div><div class="nm l"><div class="nn l no np nq nm nr kp nd"/></div></div></a></div><div class="na nb gp gr nc nd"><a href="https://rimdev.io/vue-3-composition-api/" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">Vue 3组合API</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">您是否发现自己迷失在具有多种功能的大型Vue组件中？组合API是一个新的…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">rimdev.io</p></div></div><div class="nm l"><div class="ns l no np nq nm nr kp nd"/></div></div></a></div></div></div>    
</body>
</html>