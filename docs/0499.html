<html>
<head>
<title>Creating a pool table game using React, Three JS and react-three-fiber</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React，Three JS和react-three-fiber创建台球桌游戏</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-a-rudimentary-pool-table-game-using-react-three-js-and-react-three-fiber-part-1-cbb1214bed82?source=collection_archive---------9-----------------------#2019-10-28">https://javascript.plainenglish.io/creating-a-rudimentary-pool-table-game-using-react-three-js-and-react-three-fiber-part-1-cbb1214bed82?source=collection_archive---------9-----------------------#2019-10-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d86e" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">第一部分</h2></div><p id="faaf" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">很长一段时间，我想学习并开始使用WebGL。在做了一些OpenGL的工作后，我认为WebGL会是一个很好的补充。这是我碰到three.js的时候。</p><p id="e9c7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae ky" href="https://threejs.org" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> Three.js </strong> </a>是一个非常棒的3D图形库。它是用JavaScript编写的，但是不支持React。与React一起工作了很长时间后，我想将React的表现力与三个j的力量结合起来。这是我发现<a class="ae ky" href="https://github.com/react-spring/react-three-fiber" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">反应过来的时候——三纤</strong> </a>。它是three.js的轻量级React渲染器，运行良好。</p><p id="8015" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是一个由三部分组成的系列文章，其中我们将看到如何使用React、three.js和react-three-fiber来创建一个台球桌游戏。</p><ul class=""><li id="a1a3" class="kz la in ke b kf kg ki kj kl lb kp lc kt ld kx le lf lg lh bi translated">第1部分:React、three.js和react-three-fiber入门。</li><li id="8acc" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">第2部分:设置基本场景(即将推出)。</li><li id="586a" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">第3部分:添加物理并完成(即将推出)。</li></ul><h1 id="3c3c" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">重要的事情先来</h1><ul class=""><li id="3f54" class="kz la in ke b kf mf ki mg kl mh kp mi kt mj kx le lf lg lh bi translated">创建React项目。最好的方法是使用<a class="ae ky" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">创建-反应-应用</strong> </a></li><li id="f6c7" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">下一步是安装three.js和react-three-fiber模块。根据您选择的软件包管理器，继续安装它们。<code class="fe mk ml mm mn b">npm i three react-three-fiber</code>或<code class="fe mk ml mm mn b">yarn add three react-three-fiber</code></li></ul><p id="2669" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">既然我们的项目已经设置好了，让我们做有趣的部分，开始编码吧。</p><h1 id="9444" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">组织项目</h1><p id="1d3f" class="pw-post-body-paragraph kc kd in ke b kf mf jo kh ki mg jr kk kl mo kn ko kp mp kr ks kt mq kv kw kx ig bi translated">这是一个我喜欢遵循的项目结构，无论如何，你必须这样做。这是我喜欢的组织方式，但也可以随意移动东西。</p><p id="da21" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在src目录中，让我们为组件、视图、实用程序和资产创建不同的目录。您的目录结构应该如下所示</p><pre class="mr ms mt mu gt mv mn mw mx aw my bi"><span id="8849" class="mz lo in mn b gy na nb l nc nd">project<br/>+-- README.md<br/>+-- src<br/>|   +-- index.js<br/>|   +-- App.js<br/>|   +-- assets/<br/>|   +-- components/<br/>|   +-- utils/<br/>|   +-- views/</span></pre><h1 id="96af" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">创建一个基本场景</h1><ul class=""><li id="ad05" class="kz la in ke b kf mf ki mg kl mh kp mi kt mj kx le lf lg lh bi translated">继续在views目录中创建一个名为Scene.js的文件。</li><li id="b0c7" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">只需将下面的代码复制并粘贴到Scene.js文件中。</li></ul><p id="014a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这将为我们创建一个立方体网格。</p><p id="0d51" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们去看看每一行是做什么的。</p><p id="de44" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您看到的所有jsx标签都是react——three . js对象周围的三纤维包装器</p><ul class=""><li id="6841" class="kz la in ke b kf kg ki kj kl lb kp lc kt ld kx le lf lg lh bi translated">网格组件是来自三个js库的<a class="ae ky" href="https://threejs.org/docs/#api/en/objects/Mesh" rel="noopener ugc nofollow" target="_blank">网格</a>对象。对于<a class="ae ky" href="https://threejs.org/docs/#api/en/geometries/BoxBufferGeometry" rel="noopener ugc nofollow" target="_blank"> boxBufferGeometry </a>和<a class="ae ky" href="https://threejs.org/docs/#api/en/materials/MeshNormalMaterial" rel="noopener ugc nofollow" target="_blank"> meshNormalMaterial </a>也是如此。</li><li id="d96f" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">如果你在three js网站上查看这些组件的文档，你会看到BoxBufferGeometry有一个带一堆参数的构造函数。</li><li id="087f" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">使用react-three-fiber在React中创建新实例的方法是使用该组件的<strong class="ke io"> args </strong> prop，并将参数作为数组传入。</li><li id="9d77" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">所以在上面的例子中，<code class="fe mk ml mm mn b">&lt;boxBufferGeometry attach='geometry' args={[1, 1, 1]} /&gt;</code>将创建一个新的BoxBufferGeometry(又名cube ),其宽度、高度和深度的参数分别为1、1和1。<strong class="ke io"> attach </strong>属性告诉渲染器给定组件是哪种对象。您可以使用这个给定对象及其超类的所有属性作为组件的道具。你可以在<a class="ae ky" href="https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene" rel="noopener ugc nofollow" target="_blank">文档</a>中找到三个js的所有属性。</li><li id="d568" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">类似地，meshNormalMaterial可以用于给几何体着色，还有许多其他用途，我们将在后面看到。</li></ul><p id="0912" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">恭喜您，您刚刚创建了一个立方体并将其添加到场景中。下一步是在画布元素中渲染场景。你们都知道该怎么做，所以再见了，祝编码愉快。</p><p id="6182" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我只是在开玩笑。现在，让我们创建一个画布。</p><h1 id="bcc5" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">创建画布</h1><p id="9e9f" class="pw-post-body-paragraph kc kd in ke b kf mf jo kh ki mg jr kk kl mo kn ko kp mp kr ks kt mq kv kw kx ig bi translated">我们到此为止。只需运行<code class="fe mk ml mm mn b">npm start</code>，你就可以在浏览器中看到你漂亮的立方体。</p><p id="e148" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您的输出应该如下所示</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ne"><img src="../Images/23343818c9d00a4d5024620bd67bc58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4rm5EWQsbeuT1_1L"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk">Basic cube</figcaption></figure><ul class=""><li id="c5b0" class="kz la in ke b kf kg ki kj kl lb kp lc kt ld kx le lf lg lh bi translated">这里要做的最后一件事是画布不会占据屏幕的整个高度。</li><li id="c3ad" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">所以在你的index.css中添加下面几行</li></ul><p id="ffff" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望你对刚才的努力感到满意，但是正如你所看到的，这个立方体看起来更像一个正方形。不要慌，相信我，它是一个立方体。要将其视为一个3D对象，让我们添加鼠标/跟踪板控件，以便我们可以执行平移，旋转和缩放(也称为动态观察控件)。</p><h1 id="7d93" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">添加动态观察控件</h1><ul class=""><li id="ebf0" class="kz la in ke b kf mf ki mg kl mh kp mi kt mj kx le lf lg lh bi translated">这里要理解的第一件事是，OrbitControls不是三个主要模块的一部分，因此你不能像我们在前面的立方体网格和几何体代码中看到的那样直接使用它。</li><li id="ef10" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">为了处理这个问题，react-three-fiber提供了一个<code class="fe mk ml mm mn b">extend</code>函数，可以用于三个主要js代码库之外的模块。记得在组件函数之前先调用扩展函数，之后，你就可以像使用其他三个js模块一样使用扩展模块了。</li><li id="0614" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">因此，正如我们之前看到的，在使用网格和几何体时，我们可以以同样的方式使用轨道控制及其所有的<a class="ae ky" href="https://threejs.org/docs/#examples/en/controls/OrbitControls" rel="noopener ugc nofollow" target="_blank">属性</a>。</li><li id="e789" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">再来说说上面用的钩子还有<code class="fe mk ml mm mn b">useRef</code>、<code class="fe mk ml mm mn b">useThree</code>和<code class="fe mk ml mm mn b">useFrame</code>。</li><li id="f1f9" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">useRef是Reacts提供给我们访问底层dom节点的方法。你可以在这里了解更多信息<a class="ae ky" href="https://reactjs.org/docs/hooks-reference.html#useref" rel="noopener ugc nofollow" target="_blank"/></li><li id="7d8f" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated"><a class="ae ky" href="https://github.com/react-spring/react-three-fiber#hooks" rel="noopener ugc nofollow" target="_blank"> useThree </a>是一个react-three-fiber挂钩，本质上让我们可以访问添加到场景中的所有东西。这对我们以后会非常有帮助。</li><li id="fac0" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated"><a class="ae ky" href="https://github.com/react-spring/react-three-fiber#hooks" rel="noopener ugc nofollow" target="_blank">使用帧</a>同样，每画一帧就调用一个react-three-fiber钩子。如果你用过浏览器提供的RequestAnimationFrame API，这个钩子类似于那个。在后面的例子中，它将阐述我们物理计算的基础。</li><li id="f1da" class="kz la in ke b kf li ki lj kl lk kp ll kt lm kx le lf lg lh bi translated">最后一步是将新创建的控件添加到画布中。为此，请打开App.js文件，用下面的代码替换当前代码。</li></ul><p id="b982" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">启动应用程序，不会有任何变化，但现在你可以使用鼠标滚轮/跟踪板来放大和缩小，同时按住左键单击将允许你旋转和检查立方体的所有方面，并允许你平移。您应该能够做如下所示的事情。</p><figure class="mr ms mt mu gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ne"><img src="../Images/51da568601451fba2bc4b8f938d8fdb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V1adUE57tbDUBUiz"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk">Cube after adding orbit controls</figcaption></figure><p id="e74d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我们开始模拟台球桌之前，我们还有最后一件事要做。让我们稍微调整一下我们的摄像头，这样我们就可以看到如何更改摄像头的默认设置。</p><h1 id="f291" class="ln lo in bd lp lq lr ls lt lu lv lw lx jt ly ju lz jw ma jx mb jz mc ka md me bi translated">编辑相机设置</h1><ul class=""><li id="4322" class="kz la in ke b kf mf ki mg kl mh kp mi kt mj kx le lf lg lh bi translated">你可以在这里找到相机对象的所有属性和功能。</li></ul><p id="a914" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是三部分系列的第1部分。我将在接下来的几天里发布即将到来的部分。</p><p id="2d99" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">另外，这是我的第一篇博文。如果你能在评论中留下一些反馈，那就太好了，这样我就可以了解并改进我的内容交付。可以在<a class="ae ky" href="https://twitter.com/Manan_30" rel="noopener ugc nofollow" target="_blank">推特</a>和<a class="ae ky" href="https://www.instagram.com/manan__joshi/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>关注我。</p><p id="89b4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">和平结束，快乐编码！！！</p></div><div class="ab cl nq nr hr ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ig ih ii ij ik"><p id="9e70" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nx">原发布于2019年10月28日</em><a class="ae ky" href="https://dev.to/manan30/creating-a-rudimentary-pool-table-game-using-react-three-js-and-react-three-fiber-part-1-363l" rel="noopener ugc nofollow" target="_blank"><em class="nx">https://dev . to</em></a><em class="nx">。</em></p></div></div>    
</body>
</html>