<html>
<head>
<title>JavaScript Best Practices — Speed and Spread</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—速度和传播</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-speed-and-spread-9317c309df24?source=collection_archive---------7-----------------------#2020-07-31">https://javascript.plainenglish.io/javascript-best-practices-speed-and-spread-9317c309df24?source=collection_archive---------7-----------------------#2020-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/792474922c587cc764c8d23a4a187f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gHn-NLDiKaheKyVM"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@nicnut?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nicola Nuttall</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a9c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些在编写JavaScript代码时应该遵循的最佳实践。</p><h1 id="5ae2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">扩展运算符和数组</h1><p id="762a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">扩展操作符可以做很多事情。</p><p id="0691" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它们来合并数组。</p><p id="4846" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f141" class="mn lc iq mj b gy mo mp l mq mr">const a = [1, 2, 3];<br/>const b = [4, 5, 6];<br/>const c = [...a, ...b];</span></pre><p id="e0fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">c</code>拥有<code class="fe ms mt mu mj b">a</code>和<code class="fe ms mt mu mj b">b</code>的所有条目。</p><p id="4412" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以将一个数组扩展到一个函数中作为它的参数。</p><p id="fdf3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="88d2" class="mn lc iq mj b gy mo mp l mq mr">const sum = (x, y, z) =&gt; x + y + z;<br/>const nums = [1, 2, 3];<br/>const total = sum(...nums);</span></pre><p id="7eb0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用spread操作符将<code class="fe ms mt mu mj b">nums</code>条目展开作为参数。</p><h1 id="0c35" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">推迟加载脚本</h1><p id="7e0d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以推迟加载带有<code class="fe ms mt mu mj b">defer</code>属性的脚本。</p><p id="e81c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，它们将按照列出的顺序异步加载。</p><p id="bb8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="23db" class="mn lc iq mj b gy mo mp l mq mr">&lt;script defer src='script.js'&gt;&lt;/script&gt;</span></pre><p id="c525" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以将脚本标签放在文件的末尾，这样它们就可以最后加载。</p><h1 id="ad1c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">通过使用缩小来节省字节</h1><p id="5fcc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在我们将我们的应用程序部署到生产环境之前，我们应该缩小它们，这样我们就可以减小包的大小。</p><p id="b21f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们使用框架，这应该由那些框架的CLI程序自动完成。</p><p id="0292" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们没有，我们可以使用package或Webpack为我们做修改。</p><h1 id="8005" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免不必要的循环</h1><p id="59a6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该避免嵌套循环，以保持代码的线性。</p><p id="a7cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不希望我们的循环通过许多对象，因为它会很慢。</p><h1 id="f334" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">优先选择Map而不是for循环</h1><p id="7c41" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们将数组条目从一个东西映射到另一个东西，我们可以使用数组实例的<code class="fe ms mt mu mj b">map</code>方法。</p><p id="e3cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，原始数组不会改变。</p><p id="5d00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">范围是隔离的，因为映射是通过回调完成的。</p><p id="1742" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它也比循环短。</p><p id="4cf7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用其他操作，比如循环和其他数组方法来组合。</p><p id="65d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="52a3" class="mn lc iq mj b gy mo mp l mq mr">let strings = ['1', '2', '3', '4', '5'];<br/>const total = strings<br/>  .map(str =&gt; +str)<br/>  .filter(num =&gt; num % 2 === 1)<br/>  .reduce((sum, number) =&gt; sum + number);</span></pre><p id="d723" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<code class="fe ms mt mu mj b">map</code>将<code class="fe ms mt mu mj b">strings</code>条目转换成数字。</p><p id="61ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe ms mt mu mj b">filter</code>从映射的数组中返回奇数。</p><p id="6527" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们调用<code class="fe ms mt mu mj b">reduce</code>来获得奇数的总数。</p><p id="e7a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了循环，这个时间就长多了。</p><p id="85e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们要写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ecf3" class="mn lc iq mj b gy mo mp l mq mr">let strings = ['1', '2', '3', '4', '5'];<br/>let nums = [];<br/>let oddNums = [];<br/>let total = 0;</span><span id="5918" class="mn lc iq mj b gy mv mp l mq mr">for (const s of strings) {<br/>  nums.push(+s);<br/>}</span><span id="5849" class="mn lc iq mj b gy mv mp l mq mr">for (const n of nums) {<br/>  if (n % 2 === 1) {<br/>    oddNums.push(n);<br/>  }<br/>}</span><span id="4ee9" class="mn lc iq mj b gy mv mp l mq mr">for (const o of oddNums) {<br/>  total += o;<br/>}</span></pre><p id="9106" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有3个循环来分别进行映射、过滤和添加。</p><p id="1e8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用数组实例方法要短得多。</p><h1 id="06af" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用适当的事件处理程序</h1><p id="084d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用事件委托来使用事件处理程序，以检查哪个DOM元素触发了事件。</p><p id="ca2c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们应该在使用完<code class="fe ms mt mu mj b">removeEventListener</code>后移除它们。</p><p id="64a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要进行事件委托，我们可以编写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c0e9" class="mn lc iq mj b gy mo mp l mq mr">document.addEventListener('click', (e) =&gt; {<br/>  if (e.srcElement.tagName.toLowerCase() === 'div') {<br/>    //...<br/>  }<br/>})</span></pre><p id="d82b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查div的点击量。</p><p id="ef47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要调用<code class="fe ms mt mu mj b">removeEventListener</code>，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3f91" class="mn lc iq mj b gy mo mp l mq mr">target.removeEventListener('click', onClick);</span></pre><p id="8393" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<code class="fe ms mt mu mj b">onClick</code>是一个事件监听器函数。</p><h1 id="847e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">移除未使用的JavaScript</h1><p id="8cba" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们有未使用的代码，那么我们应该删除它们。</p><p id="5068" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，就不会有人对它们感到困惑了。</p><h1 id="6e6f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免使用太多内存</h1><p id="dfd6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每当我们的代码使用更多的内存时，垃圾收集器将在稍后清理未使用的资源时运行。</p><p id="617d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果垃圾收集经常运行，那么我们的应用程序运行缓慢。</p><p id="a66c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们首先应该避免预留内存。</p><h1 id="15cc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">浏览器中的缓存</h1><p id="1ffd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以和服务人员一起保管东西。</p><p id="a97e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用缓存API来缓存东西。</p><p id="1645" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要添加缓存，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8254" class="mn lc iq mj b gy mo mp l mq mr">const CACHE_VERSION = 1;<br/>const CURRENT_CACHES = {<br/>  font: `font-cache-v${CACHE_VERSION}`;<br/>};</span><span id="cdaf" class="mn lc iq mj b gy mv mp l mq mr">self.addEventListener('activate', (event) =&gt; {<br/>  let expectedCacheNamesSet = new Set(Object.values(CURRENT_CACHES));<br/>  event.waitUntil(<br/>    caches.keys().then((cacheNames) =&gt; {<br/>      return Promise.all(<br/>        cacheNames.map((cacheName) =&gt; {<br/>          if (!expectedCacheNamesSet.has(cacheName)) {<br/>            return caches.delete(cacheName);<br/>          }<br/>        })<br/>      );<br/>    })<br/>  );<br/>});</span></pre><p id="6218" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过遍历键并检查没有在<code class="fe ms mt mu mj b">CURRENT_CACHES</code>中命名的条目来从缓存中删除数据。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/a919e0708acd5260bca3b793fa950aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5bsfkLoZgzV1rQ4b"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@gerandeklerk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Geran de Klerk</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="d914" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="18a7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用service works和spread operator等现代功能来帮助我们改进应用程序。</p><p id="faac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们应该记住一些要寻找的东西的性能。</p><h2 id="e05e" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated">简单英语的JavaScript</h2><p id="e7ee" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>