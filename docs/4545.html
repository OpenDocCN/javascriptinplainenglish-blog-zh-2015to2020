<html>
<head>
<title>How to Create a Unit Converter Pipe in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中创建单位转换器管道</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-unit-converter-pipe-in-angular-eea9b7201402?source=collection_archive---------6-----------------------#2020-12-20">https://javascript.plainenglish.io/how-to-create-a-unit-converter-pipe-in-angular-eea9b7201402?source=collection_archive---------6-----------------------#2020-12-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="90f8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在Angular中创建简单的自定义管道</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ff5787392ad0a6eac782778131413b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*agPZ_HuJa2HEbDSt"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2996" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Angular中，管道用于转换或格式化模板中的数据，而无需在组件中编写任何样板代码。管道非常方便，因为只需声明一次管道，就可以在整个应用程序的模板中使用它。</p><p id="daaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本指南中，我将通过实现一个简单的自定义单位转换管道向您展示角形管道的强大功能。以下是管道在Angular方面的一些优势。</p><ul class=""><li id="df20" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">当您键入或对其他更改做出反应时，值被格式化或转换，用户可以获得即时反馈。</li><li id="d277" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">管道非常轻</li><li id="96ab" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">简单语法，要在模板中调用管道，只需使用管道字符后跟管道名，例如{{ name|大写}}。</li></ul><p id="a476" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了简单起见，我们的管道会将值从千米(km)转换为等价的米(m)值。</p><p id="d29c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事不宜迟，让我们直接进入代码。</p><h1 id="90a8" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">创建新的角度应用程序</h1><p id="74a9" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">首先，我们将使用以下CLI命令创建一个名为unit-conversion的新角度应用程序。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="c118" class="ni mh iq ne b gy nj nk l nl nm">ng new unit-conversion --defaults</span></pre><h1 id="7ce8" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">添加新管道</h1><p id="9911" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">一旦创建了应用程序，现在就可以创建单位转换管道了。为此，您可以使用以下CLI命令。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="026d" class="ni mh iq ne b gy nj nk l nl nm">ng g p kilometer-to-meter</span></pre><p id="204b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的命令创建了两个文件:包含逻辑的管道类和单元测试文件。此外，管道用缺省模块文件注册。</p><p id="9d67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本指南中，我们对类文件本身更感兴趣，但是我强烈建议您为您的管道编写单元测试。项目结构现在看起来如下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/0fa43f215a5d34645e03cc98cfd4b22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4szAdrJMzwu0-6oHaD7szQ.png"/></div></div></figure><h1 id="d7e1" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">实现管道</h1><p id="8ddb" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">通常，Angular中的管道将实现PipeTransform接口。该接口包含<strong class="ky ir"> <em class="no">转换方法</em> </strong>，该方法接受至少一个参数，包括要格式化或转换的值。</p><p id="345a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="no">转换方法</em> </strong>是您编写逻辑来格式化或计算所需值并将其作为格式化值返回的地方。</p><p id="d8d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的例子中，我们知道1公里等于1000米。因此，要从千米转换到米，转换方法必须通过将千米输入值乘以1000来计算所需的米值。返回值将是仪表的等效值。</p><p id="ba89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在上面创建的管道代码应该如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="abb8" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">在模板中使用管道</h1><p id="7df2" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">既然我们的管道逻辑已经就位。我们现在可以在模板中使用管道。</p><p id="131e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从<strong class="ky ir"><em class="no">app.component.html</em></strong>文件中删除所有样板代码，并替换为下面的代码。</p><p id="1bb3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该代码为用户创建了一个输入字段来输入公里数，在它下面，我们动态地显示以米为单位的等值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="e54f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们已经在输入属性上使用了<strong class="ky ir"> <em class="no"> ngModel </em> </strong>。我们必须在相应的模块中注册<strong class="ky ir"> <em class="no">表单模块</em> </strong>，在本例中是<strong class="ky ir"> <em class="no"> app.module.ts </em> </strong>文件。</p><p id="d362" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"><em class="no">app . module . ts</em></strong>文件中的代码如下。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="e8d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong>:如果您不导入并注册<strong class="ky ir"> <em class="no"> FormsModule </em> </strong>，您将得到以下错误消息:<em class="no">“无法绑定到‘ng model’，因为它不是‘input’的已知属性”</em>。</p><p id="4c92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<strong class="ky ir"><em class="no">app . component . ts</em></strong>文件中，我们为km值创建一个属性。并且最初将其设置为零。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="85e8" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">测试管道</h1><p id="d226" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">要为应用程序提供服务，只需在应用程序的根文件夹中运行以下CLI命令。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="17ea" class="ni mh iq ne b gy nj nk l nl nm">ng serve -o</span></pre><p id="1a7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在公里输入字段中，您可以输入想要转换的公里数。</p><p id="c317" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的GIF显示了转换管道的作用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/9b3af98ebc99ebcd1d9b104341126327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-DFfwnpKWeSUC7o1Hb99uQ.gif"/></div></div></figure><h1 id="3b5d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">摘要</h1><p id="425f" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">在本指南中，我们创建了一个简单的管道来处理单位转换。具体来说，从千米到米。</p><p id="016b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">管道功能强大且轻量级，可以轻松地在模板中使用，为用户提供即时格式化的数据。</p><p id="2796" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Angular框架提供了许多用于格式化数据的内置管道，随着框架的成熟，将会添加更多的默认管道。</p></div></div>    
</body>
</html>