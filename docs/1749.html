<html>
<head>
<title>Easy Mistakes To Make In React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应中容易犯的错误</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/mistakes-to-avoid-in-react-development-42db9788a5aa?source=collection_archive---------12-----------------------#2020-04-18">https://javascript.plainenglish.io/mistakes-to-avoid-in-react-development-42db9788a5aa?source=collection_archive---------12-----------------------#2020-04-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="da98" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">以及如何避免犯这些错误</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/fa3132b013089e2a92f34887e6758694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-R1VDd0vfJQPxE_1"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@esteejanssens?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Estée Janssens</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="925f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你是一个探索反应堆的新手，那么你来对地方了。作为初学者，我们会遇到很多错误和警告。这些常见的错误可以帮助你更好地了解reactjs。我想分享一下我学习反应堆的经历和我从中学到的东西。这篇文章一定会帮助你梳理关于ReactJs的概念</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><blockquote class="lw lx ly"><p id="3acf" class="kt ku lz kv b kw kx jo ky kz la jr lb ma ld le lf mb lh li lj mc ll lm ln lo ig bi translated">“从错误中吸取教训是件好事。最好从别人的错误中吸取教训”——沃伦·巴菲特</p></blockquote></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><ol class=""><li id="6c85" class="md me in kv b kw kx kz la lc mf lg mg lk mh lo mi mj mk ml bi translated"><strong class="kv io">直接修改状态:</strong><br/>T0】</li></ol><p id="64f7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">react中的状态被认为是不可变的，所以不应该在状态中直接改变。我们应该使用方法调用setState()来更新状态。</p><p id="4e8f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">问题是状态的直接更新不会反映UI中的变化，因为状态是用相同的引用更新的，所以不会触发重新渲染。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="c60c" class="mu mv in mp b gy mw mx l my mz">// Correct<br/>this.setState({comment: 'Hello'});</span></pre><p id="5b75" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用贴图或展开对象不改变项目原始状态。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="7b6d" class="mu mv in mp b gy mw mx l my mz">// Managing old state also<em class="lz"><br/>this.setState({…this.state, name: “Test”})</em></span></pre><p id="e405" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2.<strong class="kv io">不使用列表组件上的键:</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/97016fdc06b6dd0abd678e6a2aba43cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tAgKSSBS-gbnnzxU05JI5g.png"/></div></div></figure><p id="9e56" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">大多数react初学者会跳过这个警告，但是你不应该。要提高React应用程序的性能，密钥是必不可少的。关键字有助于识别哪些项目已经更改、添加或删除。应该给数组内部的元素赋予键，以给元素一个稳定的标识。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="b91b" class="mu mv in mp b gy mw mx l my mz">const numbers = [1, 2, 3, 4, 5];<br/>const listItems = numbers.map((number,index) =&gt;<br/>  &lt;li key={index}&gt;    {number}<br/>  &lt;/li&gt;<br/>);</span></pre><h1 id="179e" class="nb mv in bd nc nd ne nf ng nh ni nj nk jt nl ju nm jw nn jx no jz np ka nq nr bi translated">在哪些情况下使用索引作为键是安全的？</h1><ol class=""><li id="d7b9" class="md me in kv b kw ns kz nt lc nu lg nv lk nw lo mi mj mk ml bi translated">如果你的列表是静态的，不会改变。</li><li id="edec" class="md me in kv b kw nx kz ny lc nz lg oa lk ob lo mi mj mk ml bi translated">该列表将永远不会重新排序。</li><li id="bc7b" class="md me in kv b kw nx kz ny lc nz lg oa lk ob lo mi mj mk ml bi translated">将不筛选列表(从列表中添加/删除项目)。</li><li id="6906" class="md me in kv b kw nx kz ny lc nz lg oa lk ob lo mi mj mk ml bi translated">列表上的项目没有id。</li></ol><p id="7be9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果所有这些例外都符合条件，那么就可以使用索引作为键。</p><p id="73eb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果项的顺序可能改变，Reactjs不建议对键使用索引。这可能会对性能产生负面影响，并可能导致组件状态出现问题。查看Robin Pokorny的文章，深入了解使用索引作为关键字的负面影响。</p><p id="9a7b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">3.<strong class="kv io">忘记setState是异步的</strong></p><p id="caf2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">另一个常见的错误是试图在设置状态值后立即访问它。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="6979" class="mu mv in mp b gy mw mx l my mz">handleChange = count =&gt; {<br/>      this.setState({ count });<br/>      this.props.callback(this.state.count); // Old state value<br/>    };</span></pre><p id="d243" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">设置新值不会立即发生，通常会在下一次可用渲染时完成，或者可以批处理以优化性能。因此，在设置状态值后访问它可能不会反映最新的更新。这个问题可以通过对<code class="fe mm mn mo mp b">setState</code>使用可选的第二个参数来解决，这是一个回调函数，在状态用其最新值更新后调用。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="a3cd" class="mu mv in mp b gy mw mx l my mz">handleChange = count =&gt; {<br/>      this.setState({ count }, () =&gt; {<br/>        this.props.callback(this.state.count); // Updated state value<br/>      });<br/>    };</span></pre><p id="440e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">4.<strong class="kv io">不使用道具类型</strong></p><p id="5d49" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我经常在应用程序中看到不正确的数据类型。</p><p id="9b34" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">例如，假设您想通过props将数字2传递给另一个组件。通常，你会看到它是这样做的:</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="e088" class="mu mv in mp b gy mw mx l my mz">&lt;MyComponent value="2" /&gt;</span></pre><p id="ddd4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这会将值2作为字符串而不是数字发送给<code class="fe mm mn mo mp b">MyComponent</code>。要以数字形式发送，请这样写:</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="8574" class="mu mv in mp b gy mw mx l my mz">&lt;MyComponent value={2}/&gt;</span></pre><p id="7e74" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过<a class="ae ks" href="http://npmjs.com/package/prop-types" rel="noopener ugc nofollow" target="_blank">道具类型包</a>定义类型是确保你发送正确道具的最可靠方式。</p><p id="b024" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">属性类型用于记录传递给组件的预期属性类型。React将根据这些定义检查传递给组件的属性，如果不匹配，将在开发中发出警告。</p><p id="993f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你可以在这里了解更多道具类型<a class="ae ks" href="https://github.com/facebook/prop-types" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="f498" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">5.<strong class="kv io">不使用助手类或函数。</strong></p><p id="bb1a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是大多数开发人员常犯的错误。就像可重用组件一样，我们的应用程序中也有可重用的功能。</p><p id="e60b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该功能通常是在组件到组件的基础上硬编码的，这导致了相似组件之间的低效和不一致的行为。</p><p id="c4ff" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所有容器组件都包含获取资源、将其保存到状态和管理错误的逻辑。</p><p id="5863" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">大多数情况下，这种行为在不同的容器组件中是相同的，但是如果编写不当，可能会表现得不一致。</p><p id="1c6c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">6.<strong class="kv io">使用Redux或Flux管理所有应用程序状态</strong></p><p id="b773" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在更大的react应用中，你应该使用redux来维护全局状态。但是大部分初学者都会跳过。</p><p id="aa20" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">但是，不建议在应用程序的每个状态中使用redux。</p><p id="f7e2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Redux在开始时可能很难理解，但是它会让你的组件很容易地共享状态。所以会让你的开发变得容易。</p><p id="3379" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">7.<strong class="kv io">不使用React和Redux开发工具</strong></p><p id="3676" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">应用程序总会在一段时间后出现问题。调试通常是一项繁重的工作，因为大多数时候会涉及到许多组件。</p><p id="4027" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用<a class="ae ks" href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en" rel="noopener ugc nofollow" target="_blank"> React开发工具</a>，您可以检查React元素的渲染树，这对于查看各种组件如何构建页面非常有用。</p><p id="9934" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en" rel="noopener ugc nofollow" target="_blank"> Redux dev tools </a>还附带了许多功能，让您可以看到已经发生的每个操作，查看这些操作导致的状态变化，并返回到特定操作发生之前。</p><p id="2db4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以添加React开发工具作为开发依赖项或浏览器扩展。使用它们将节省您大量的开发时间。</p><h1 id="c02a" class="nb mv in bd nc nd ne nf ng nh ni nj nk jt nl ju nm jw nn jx no jz np ka nq nr bi translated">结论</h1><p id="5779" class="pw-post-body-paragraph kt ku in kv b kw ns jo ky kz nt jr lb lc oc le lf lg od li lj lk oe lm ln lo ig bi translated">在本文中，我们讨论了我们在react开发中经常犯的错误。</p><p id="f837" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你有任何提示或常见错误来分享，放弃回应和任何与文章相关的建议，因为这是我的第一篇文章，所以任何建议都可以让我的下一篇文章更好。</p><h2 id="1f88" class="mu mv in bd nc of og dn ng oh oi dp nk lc oj ok nm lg ol om no lk on oo nq op bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="1914" class="pw-post-body-paragraph kt ku in kv b kw ns jo ky kz nt jr lb lc oc le lf lg od li lj lk oe lm ln lo ig bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物:<a class="ae ks" href="https://medium.com/ai-in-plain-english" rel="noopener"> <strong class="kv io"> AI in Plain English </strong> </a>，<a class="ae ks" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kv io">UX in Plain English</strong></a>，<a class="ae ks" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kv io">Python in Plain English</strong></a><strong class="kv io"/>——谢谢，继续学习！</p><p id="4595" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae ks" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kv io">submissions @ plain English . io</strong></a><strong class="kv io"/>，使用您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>