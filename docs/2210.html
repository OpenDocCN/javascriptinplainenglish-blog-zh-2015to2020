<html>
<head>
<title>Building an eCommerce Mobile App with React Native and WooCommerce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React Native和WooCommerce构建电子商务移动应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-an-ecommerce-mobile-app-with-react-native-and-woocommerce-a4f5b3a1e434?source=collection_archive---------1-----------------------#2020-05-31">https://javascript.plainenglish.io/building-an-ecommerce-mobile-app-with-react-native-and-woocommerce-a4f5b3a1e434?source=collection_archive---------1-----------------------#2020-05-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2ca1" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">一个实践教程，用一个免费的流行的电子商务平台——woo commerce来构建一个跨平台的应用程序。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/ec20e2e6bdf56f7f841be0bc9bb52384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lo_VChojvIDsYQLJ"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@alvaroserrano?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Álvaro Serrano</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bc7c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2020年的这个时候，电子商务正在兴起。全球疫情迫使我们在家做任何事情。因此，实体店老板正在适应并开始建立他们的第一个网上商店。作为一名开发人员，我认为这是一个分享我的知识来帮助陷入困境的企业的机会。有了为这些企业主创建移动应用的技能，你将是比大型电子商务顾问更快、更便宜的选择。</p><p id="f2e4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://reactnative.dev/" rel="noopener ugc nofollow" target="_blank"> React Native </a>是一个用于构建原生iOS和Android应用的javascript框架。它基于React，您的代码将被编译成本机代码，您可以构建并在应用商店上发布。在本教程中，我们的应用程序将只使用通过<a class="ae ks" href="https://woocommerce.github.io/woocommerce-rest-api-docs/" rel="noopener ugc nofollow" target="_blank"> WooCommerce REST API </a>连接的WooCommerce作为其后端。该应用程序将有简单的功能，如浏览产品，添加到购物车，并结帐。如果你已经理解了基本的React、<a class="ae ks" href="https://reactnavigation.org/" rel="noopener ugc nofollow" target="_blank"> React导航</a>、<a class="ae ks" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>和REST API，你会更好地理解本教程。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="ebe5" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">🚀开一家网络商店</h1><p id="fdff" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">WooCommerce是Wordpress的一个开源电子商务插件。要使用它，你应该把它安装在你的Wordpress网站上。</p><p id="a50e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于本教程，我们将通过在本地服务器上运行来使用Wordpress。但是如果你已经有一个带有WooCommerce插件的Wordpress网站，你可以跳过这些步骤。</p><ol class=""><li id="9cf1" class="mt mu in kv b kw kx kz la lc mv lg mw lk mx lo my mz na nb bi translated">你需要在你的电脑上安装一个PHP和数据库服务器，这样你就可以下载并安装<a class="ae ks" href="https://www.apachefriends.org/index.html" rel="noopener ugc nofollow" target="_blank"> XAMPP </a>或<a class="ae ks" href="https://www.mamp.info/en/" rel="noopener ugc nofollow" target="_blank"> MAMP </a>。</li><li id="64b5" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated">在这里下载Wordpress <a class="ae ks" href="https://wordpress.org/download/" rel="noopener ugc nofollow" target="_blank">并解压到你服务器的根目录。</a></li><li id="a817" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated">现在你可以通过访问服务器地址上的<code class="fe nh ni nj nk b">/wp-admin</code>路径来访问Wordpress管理页面。例如，MAMP的地址是<code class="fe nh ni nj nk b">http://localhost:8888/wp-admin</code>。</li><li id="ee24" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated">当你第一次访问它时，你将被要求建立你的网站，你可以遵循<a class="ae ks" href="https://wordpress.org/support/article/how-to-install-wordpress/" rel="noopener ugc nofollow" target="_blank">这个官方指南</a>。</li><li id="5c9f" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated">要添加WooCommerce插件，在仪表板侧菜单上点击插件→添加新插件→搜索“woo commerce”→点击立即安装。</li><li id="ce53" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated">添加插件后，您可以在管理页面上看到一个新菜单。出于开发目的，我们将用虚拟产品填充商店，单击产品→添加新品开始添加一些产品。</li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nl"><img src="../Images/2d6a7573dea976c424a7e1dc19ba4bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aO3rjjOo1RnPKErp6MjMow.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Adding Products to a WooCommerce store</figcaption></figure></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="d3bf" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">🎮尝试WooCommerce REST API</h1><p id="d8c2" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">WooCommerce提供了几乎所有基本功能的端点，正如你在这里看到的<a class="ae ks" href="https://woocommerce.github.io/woocommerce-rest-api-docs/" rel="noopener ugc nofollow" target="_blank"/>。我们可以查询产品、类别、评论、优惠券等数据。</p><p id="ae99" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">甚至我们可以作为管理员提出请求，如创建和更新产品或支付网关。因此，您必须小心不要将任何管理端点暴露给为用户设计的应用程序。</p><p id="d589" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要使用WooCommerce REST API进行请求，我们需要一个从您的商店生成的API密钥。可以进入管理页面→点击WooCommerce菜单→设置→进入高级选项卡→ REST API →添加密钥。填写描述字段并将权限字段设置为<em class="nm">读/写</em>，然后点击<em class="nm">生成API密钥</em>。</p><p id="ae3b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您将检索消费者密钥和消费者机密。OAuth 1.0方法的每个请求中都将使用这些密钥。例如，我们将使用API开发应用程序<a class="ae ks" href="https://insomnia.rest/download/" rel="noopener ugc nofollow" target="_blank">失眠症</a>发出请求，查询所有产品。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/cf1dc07f9fbc777d2326aeb698bddb96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIxkQVH9UoofnFgX9pI0nw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Querying list of all products with WooCommerce REST API</figcaption></figure></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="c170" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">⚒启动了一个React本地项目</h1><p id="d3df" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">我们将从头开始构建电子商务应用程序，因此我们需要为它设置必要的依赖关系。我们还将在这个项目中使用Typescript。如果你想知道为什么我们应该实现类型检查，正如React官方网站上所说的，</p><blockquote class="no np nq"><p id="c7e7" class="kt ku nm kv b kw kx jo ky kz la jr lb nr ld le lf ns lh li lj nt ll lm ln lo ig bi translated">TypeScript可以在构建时捕获错误和bug，远远早于您的应用程序上线。</p></blockquote><p id="de9b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在让我们把手弄脏。为了快速启动项目，我们使用官方的react本地模板和来自这个<a class="ae ks" href="https://github.com/react-native-community/react-native-template-typescript#arrow_forward-usage" rel="noopener ugc nofollow" target="_blank">链接</a>的类型脚本。只需使用下面的命令启动一个新项目。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="91fe" class="ny lx in nk b gy nz oa l ob oc">npx react-native init RNWCShop --template react-native-template-typescript</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi od"><img src="../Images/3dbc9d701c5408064a5062c6e5455f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_r3P--XkkwAj3muzq8l-cg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Starting a React Native project</figcaption></figure><h2 id="2ae3" class="ny lx in bd ly oe of dn mc og oh dp mg lc oi oj mi lg ok ol mk lk om on mm oo bi translated">文件夹结构和相关性</h2><p id="466b" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">当您在IDE中打开项目时，您可以看到<code class="fe nh ni nj nk b">App.tsx</code>文件，它将是您的应用程序的根组件。为了使我们的项目更有条理，我们将把代码放在一个新的<code class="fe nh ni nj nk b">app</code>目录中。里面的文件夹结构会如下图。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="0db5" class="ny lx in nk b gy nz oa l ob oc">index.js<br/>App.tsx<br/>/app<br/>|_ Components<br/>|_ Containers<br/>|_ Navigations<br/>|_ Reducers<br/>|_ Services<br/>|_ Utils</span></pre><p id="dd97" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe nh ni nj nk b">Components</code>目录用于存放可复用组件，如<code class="fe nh ni nj nk b">ProductItem</code>、<code class="fe nh ni nj nk b">Button</code>、<code class="fe nh ni nj nk b">InputField</code>等。，而<code class="fe nh ni nj nk b">Containers</code>目录是我们把组件作为一个包含状态、处理程序和数据映射函数的屏幕放置的地方。</p><p id="f760" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们开始编码之前，我们需要安装一些依赖项，如<a class="ae ks" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> Axios </a>、<a class="ae ks" href="https://react-redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>和<a class="ae ks" href="https://reactnavigation.org/" rel="noopener ugc nofollow" target="_blank"> React Navigation </a>。在本教程中，我们还将使用组件库，如<a class="ae ks" href="https://react-native-elements.github.io/react-native-elements/" rel="noopener ugc nofollow" target="_blank"> React Native Elements </a>、<a class="ae ks" href="https://github.com/archriss/react-native-snap-carousel" rel="noopener ugc nofollow" target="_blank"> RN Snap Carousel </a>、<a class="ae ks" href="https://github.com/ascoders/react-native-image-viewer" rel="noopener ugc nofollow" target="_blank"> RN Image Zoom Viewer </a>、<a class="ae ks" href="https://github.com/archriss/react-native-render-html" rel="noopener ugc nofollow" target="_blank"> RN Render HTML </a>和<a class="ae ks" href="https://jaredpalmer.com/formik/docs/guides/react-native" rel="noopener ugc nofollow" target="_blank"> Formik </a>，因此您不必过多关注样式😉。要将它们全部添加到您的项目中，您可以运行下面的命令。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="ac6c" class="ny lx in nk b gy nz oa l ob oc"><strong class="nk io">yarn add</strong> axios redux react-redux @types/react-redux @react-navigation/native @react-navigation/stack @react-navigation/bottom-tabs react-native-reanimated react-native-gesture-handler react-native-screens react-native-safe-area-context @react-native-community/masked-view react-native-elements react-native-snap-carousel @types/react-native-snap-carousel react-native-image-zoom-viewer react-native-render-html formik react-native-vector-icons react-native-webview intl</span></pre><h2 id="b01b" class="ny lx in bd ly oe of dn mc og oh dp mg lc oi oj mi lg ok ol mk lk om on mm oo bi translated">设计应用流程</h2><p id="c7a9" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">“总是从目的开始”，也就是说，我们需要定义我们的应用程序可以有什么功能。WooCommerce在其API中提供的功能没有其基于网络的商店和高级扩展多。但我们可以实现基本功能，让用户有完整的购买体验。</p><p id="6e43" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于本教程，我们的应用程序的用户将能够浏览在一个屏幕上显示的产品，当一个项目被单击，它将进入一个产品的详细信息屏幕。在浏览和详细信息屏幕上，用户可以将产品添加到他们的购物车，然后将显示购物车屏幕。在那里，用户将能够管理他们的购物车，直到点击一个结帐按钮，它将转到一个结帐屏幕。结账时，用户需要填写账单细节，并确认他们订购的商品。最后，当用户点击“继续付款”按钮时，我们会在浏览器上将他们重定向到您的WooCommerce网上商店的付款页面。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi op"><img src="../Images/f6e863430fb68440cdd5c959193e2da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OL0Cs41YU9OhYyFpHzludQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">React Native WooCommerce App Flow</figcaption></figure><p id="c357" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">基于以上流程，我们可以创建应用程序的导航堆栈。首先，我们定义了包含<em class="nm">浏览</em>和<em class="nm">订单</em>堆栈的标签导航。<em class="nm">浏览</em>栈内有<em class="nm">店铺</em><em class="nm">明细</em>集装箱，而<em class="nm">订单</em>栈内有<em class="nm">推车</em>和<em class="nm">结账</em>集装箱。该导航堆栈将位于路径为<code class="fe nh ni nj nk b">app/Navigations/index.tsx</code>的文件中。它将在<code class="fe nh ni nj nk b">App.tsx</code>中呈现，如下所示。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="519d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如您所见，每个屏幕都有一个容器作为其组件支柱。因为我们还没有创建任何容器，所以你可以给它们放一个空的组件。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="a467" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">👨🏽‍🍳创建WooCommerce服务</h1><p id="606d" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">现在，我们正在创建一个服务，将我们的React Native应用程序与WooCommerce REST API连接起来。该服务包含HTTP方法的功能，如GET和POST。然后，我们从应用程序中提出的每一个请求都将使用OAuth 1.0参数进行设置和签名。</p><p id="f97a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了做到这一点，我们需要在我们的项目中添加<a class="ae ks" href="https://github.com/brix/crypto-js" rel="noopener ugc nofollow" target="_blank"> CryptoJS </a>和<a class="ae ks" href="https://github.com/ddo/oauth-1.0a" rel="noopener ugc nofollow" target="_blank"> Oauth-1.0a </a>库。这些库具有OAuth 1.0请求所需的加密和哈希函数。然而，这些功能是基于Node的，在React Native项目中不能正确使用，所以我们使用<a class="ae ks" href="https://github.com/tradle/rn-nodeify" rel="noopener ugc nofollow" target="_blank"> RN Nodeify </a>来实现。</p><p id="fab3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">第一步，我们需要安装这些依赖项。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="bd50" class="ny lx in nk b gy nz oa l ob oc">yarn add oauth-1.0a crypto-js @types/crypto-js rn-nodeify</span></pre><p id="ce4d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，在项目的根目录下，运行以下命令。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="2bbc" class="ny lx in nk b gy nz oa l ob oc">./node_modules/.bin/rn-nodeify --install \"crypto,vm,stream,process\" --hack --yarn</span></pre><p id="b6f2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">它将生成一个名为<code class="fe nh ni nj nk b">shim.js</code>的新文件。您需要在顶部增加一行，将该文件导入<code class="fe nh ni nj nk b">index.js</code>。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="174c" class="ny lx in nk b gy nz oa l ob oc">import './shim.js';</span></pre><p id="8f6a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">RN Nodeify应该在您每次安装依赖项时执行。为此，您可以简单地将命令放入<code class="fe nh ni nj nk b">package.json</code>脚本中。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="e25a" class="ny lx in nk b gy nz oa l ob oc">"scripts": {<br/>  // other scripts<br/>  "postinstall": "./node_modules/.bin/rn-nodeify --install \"crypto,vm,stream,process\" --hack --yarn"<br/>},</span></pre><p id="68a6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于服务文件，您可以在<code class="fe nh ni nj nk b">app/Services/</code>目录下创建一个名为<code class="fe nh ni nj nk b">WooCommerce.ts</code>的文件，并按照下面的代码进行操作。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="52f7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如您在<em class="nm">配置</em>对象中所看到的，您可以将基本URL更改为您的WooCommerce URL，然后从我们之前生成的密钥中更改消费者密钥和消费者秘密。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="b7bb" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">🏪创建浏览产品选项卡屏幕</h1><p id="b759" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">在这一部分，我们将开始为我们的组件和容器编写代码。如前所述，在<em class="nm">浏览</em>页签会有<em class="nm">店铺</em>画面显示产品列表，以及<em class="nm">明细</em>画面显示产品的明细信息。</p><p id="2cb2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们制作<em class="nm">商店</em>容器之前，我们需要首先制作一个可重用的<em class="nm">产品项目</em>组件。我设计这个组件用于显示产品列表的<em class="nm">商店</em>和<em class="nm">购物车</em>容器。所以如果你注意到，我做了<em class="nm">is Cart</em>prop来区分它在不同屏幕上的样子，我还做了与cart相关的动作按钮，我们稍后会讲到。您可以在<code class="fe nh ni nj nk b">app/Components/ProductItem</code>中添加一个名为<code class="fe nh ni nj nk b">ProductItem.tsx</code>的新文件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="1620" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，我们将创建商店容器。该容器将有两个文件，<code class="fe nh ni nj nk b">Shop.container.tsx</code>和<code class="fe nh ni nj nk b">Shop.component.tsx</code>。在这个项目中，带有<code class="fe nh ni nj nk b">*.container</code>文件的容器的一部分是放置状态、钩子、动作处理程序和数据映射的地方。而<code class="fe nh ni nj nk b">*.component</code>文件是放置要渲染的组件的地方。您可以在<code class="fe nh ni nj nk b">app/Containers/Shop/</code>中创建这些文件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="1219" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">注意，我们在<code class="fe nh ni nj nk b">useEffect</code> hook中调用了WooCommerce服务，因此它将在组件呈现后被调用。</p><p id="3361" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们还创建了一个名为<code class="fe nh ni nj nk b">handleProductPress</code>的处理函数，它被传递给ProductItem组件。因此，当列表中的产品被按下时，它将被调用，然后在传递其产品id时，它将导航到详细信息屏幕。</p><p id="16fb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下一步是制作<em class="nm">细节</em>屏幕。只有当一个产品被按下时，屏幕才会被渲染，因此它将接收一个产品id来从WooCommerce获取数据。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="d7b6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在detail组件中，我们有两种方式来显示产品的图像。我们首先用一个转盘显示它们，然后当一个图像被点击时，它会显示一个图像缩放查看器，你也可以滑动到其他图像。因此，我们创建<code class="fe nh ni nj nk b">handleShowImages</code>处理程序作为切换函数来显示图像查看器模态，并将其传递给每个carousel项目。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/2e1202358b0456fba1bbc9c0b92f631d.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*GdrplQaw8lnFhnG7MHJGAw.gif"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Browse products tab screens</figcaption></figure></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="056c" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">🛒创建购物车Redux商店</h1><p id="ab45" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">如果你还不熟悉Redux，它是一个JS库，可以让你管理应用程序的全局状态。使用Redux，我们可以为用户的购物车商品状态提供一个单独的存储，并且我们可以从任何组件转换状态。</p><p id="822d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以为reducer中的购物车条目定义状态和动作。购物车缩减器将有一个状态，其中包含购物车中的一组产品和总价。我们将创建以下操作:</p><ol class=""><li id="594a" class="mt mu in kv b kw kx kz la lc mv lg mw lk mx lo my mz na nb bi translated"><strong class="kv io">添加到购物车</strong>动作会在状态中插入一个新产品，但是如果该产品已经存在，该动作会将其数量加1。</li><li id="3d3e" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated"><strong class="kv io">从购物车中移除</strong>动作将在产品存在的状态下移除产品。</li><li id="653f" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated"><strong class="kv io">添加数量</strong>动作将产品的数量加1。</li><li id="fadb" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated"><strong class="kv io">子数量</strong>动作会将产品的数量减去1，但如果其数量为1或更少，则该动作会移除该产品。</li><li id="6e93" class="mt mu in kv b kw nc kz nd lc ne lg nf lk ng lo my mz na nb bi translated"><strong class="kv io">重置购物车</strong>动作将清空购物车的产品和总价。</li></ol><p id="a142" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以在<code class="fe nh ni nj nk b">app/Reducers</code>中创建一个名为<code class="fe nh ni nj nk b">Cart.reducer.ts</code>的新文件，并遵循下面的代码。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="2f36" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了使我们的redux存储对组件全局可用，我们需要在我们的根组件<code class="fe nh ni nj nk b">App.tsx</code>中创建一个提供者，并遵循下面的代码。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="145d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们可以创建在<em class="nm">商店</em>和<em class="nm">细节</em>容器中分派这些动作的处理程序。您可以在现有的处理程序中添加一些函数，如下所示。</p><pre class="kd ke kf kg gt nu nk nv nw aw nx bi"><span id="0cf4" class="ny lx in nk b gy nz oa l ob oc">import { <strong class="nk io"><em class="nm">actions </em></strong>} from '../../Reducers/Cart.reducer';</span><span id="39d1" class="ny lx in nk b gy ot oa l ob oc">const dispatch = useDispatch();<br/><br/>const handlers = {<br/>  // ...rest of handlers<br/>  addToCart: (product: Product): Action =&gt; {<br/>    navigation.navigate('Orders', { screen: <strong class="nk io"><em class="nm">routes</em></strong>.Cart });<br/><br/>    return dispatch(<strong class="nk io"><em class="nm">actions</em></strong>.addToCart(product));<br/>  },<br/>  removeFromCart: (productId: number): Action =&gt;<br/>    dispatch(<strong class="nk io"><em class="nm">actions</em></strong>.removeFromCart(productId)),<br/>  addQuantity: (productId: number): Action =&gt;<br/>    dispatch(<strong class="nk io"><em class="nm">actions</em></strong>.addQuantity(productId)),<br/>  subQuantity: (productId: number): Action =&gt;<br/>    dispatch(<strong class="nk io"><em class="nm">actions</em></strong>.subQuantity(productId))<br/>};</span></pre></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="8437" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">🛍创建订单标签屏幕</h1><p id="983e" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">在最后一部分，我们将创建<em class="nm">购物车</em>和<em class="nm">收银台</em>容器。<em class="nm">订单</em>标签将显示<em class="nm">推车</em>画面，当按下checkout时，将显示<em class="nm"> Checkout </em>画面。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/fa6f564754fa9cf278361e14e2b143db.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*n-WRG56g8QmSOoeSnaXubQ.gif"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Cart screen</figcaption></figure><p id="53b8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要创建<em class="nm">购物车</em>容器，您可以在<code class="fe nh ni nj nk b">app/Containers/Cart</code>中创建名为<code class="fe nh ni nj nk b">Cart.container.tsx</code>和<code class="fe nh ni nj nk b">Cart.component.tsx</code>的新文件。在这个容器中，我们使用我们之前所做的购物车操作，并使用ProductItem组件显示购物车商品列表。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="3c4d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，我们用<code class="fe nh ni nj nk b">app/Containers/Checkout</code>中名为<code class="fe nh ni nj nk b">Checkout.container.tsx</code>和<code class="fe nh ni nj nk b">Checkout.component.tsx</code>的文件创建<em class="nm"> Checkout </em>容器。在这个容器中，我们将使用Formik来呈现一个表单，供用户输入他们的账单细节。当用户点击“继续付款”时，我们会将订单发布请求发送到WooCommerce。</p><p id="160e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">从请求中，我们将收到订单id和密钥的响应，因此我们将使用它们在WooCommerce网络商店上创建到您的支付页面的链接。链接扩展了一个<code class="fe nh ni nj nk b">/checkout/order-pay</code>的永久链接，你可以在你的WP仪表盘上找到配置→ WooCommerce →设置→高级→页面设置→结账端点。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/75be207819e0088a66aa8ea43a9a896c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrpaTr5URWCDByF04WPV6w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Checkout payment permalink settings on WooCommerce</figcaption></figure><p id="5f4a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以按照下面的代码创建容器。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/1456c83c76615a652724e67ed7651c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*1hywKnyRZKEcFpe28uxbQg.gif"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Checkout screen and payment page</figcaption></figure><p id="bb77" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，你自己的电子商务应用程序完成了！你可以试着用<code class="fe nh ni nj nk b">yarn android</code>或<code class="fe nh ni nj nk b">yarn ios</code>在模拟器或你自己的设备上运行。</p><p id="fa44" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要在Play Store或App Store上发布你的应用，可以阅读这个<a class="ae ks" href="https://reactnative.dev/docs/signed-apk-android" rel="noopener ugc nofollow" target="_blank">官方文档</a>。请确保您的WooCommerce基本URL使用的是公共域，这样任何网络中的任何设备都可以访问它。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="545b" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">📚从这里去哪里</h1><p id="6be2" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">我做这个项目只是为了帮助你快速启动电子商务应用程序。如果我忽略了React和Typescript的一些最佳实践，这是有可能的。有了这个项目，希望你能学会改进，满足自己的风格和需求。</p><p id="92bc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在一个电子商务应用程序中，像运输和支付这样的功能是很常见的。所以你可能想了解更多关于使用WooCommerce API在<em class="nm"> Checkout </em>屏幕上包含运输和支付网关选项的信息。为了使它更加安全，在处理用户订单请求时，还可以进行表单验证和错误处理。</p><p id="345a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在技术方面，你可以增强应用的性能和架构。例如，你可以使用像<a class="ae ks" href="https://github.com/reduxjs/redux-thunk" rel="noopener ugc nofollow" target="_blank"> redux-thunk </a>或<a class="ae ks" href="https://redux-saga.js.org/" rel="noopener ugc nofollow" target="_blank"> redux-saga </a>这样的Redux中间件库来调用像WooCommerce service这样的异步函数。还有一个名为<a class="ae ks" href="https://github.com/rt2zz/redux-persist" rel="noopener ugc nofollow" target="_blank"> redux-persist </a>的库，用于在持久存储中存储应用程序的redux状态，因此每次用户打开应用程序时，购物车状态都会被持久化。</p><p id="486c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我已经为这个项目发布了一个资源库，你可以在这里查看。</p><div class="ou ov gp gr ow ox"><a href="https://github.com/iksena/RNWCShop" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd io gy z fp pc fr fs pd fu fw im bi translated">iksena/RNWCShop</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">用Typescript反应原生WooCommerce app。通过在…上创建帐户，为iksena/RNWCShop的发展做出贡献</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl km ox"/></div></div></a></div><p id="6ef2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我还为这个应用程序做了一个正在进行的项目，增强了redux-saga和redux-persist。</p><div class="ou ov gp gr ow ox"><a href="https://github.com/iksena/react-native-woocommerce" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd io gy z fp pc fr fs pd fu fw im bi translated">iks ENA/react-native-woo commerce</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">在GitHub上创建一个帐户，为iks ENA/react-native-woo commerce的发展做出贡献。</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="pm l pi pj pk pg pl km ox"/></div></div></a></div><p id="769b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">请随意为项目做贡献。如果你有任何反馈，你可以在推特上给我发消息。</p><h2 id="e1f9" class="ny lx in bd ly oe of dn mc og oh dp mg lc oi oj mi lg ok ol mk lk om on mm oo bi translated"><strong class="ak">用简单英语写的便条</strong></h2><p id="630d" class="pw-post-body-paragraph kt ku in kv b kw mo jo ky kz mp jr lb lc mq le lf lg mr li lj lk ms lm ln lo ig bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io">plain English . io</strong></a>找到所有这些内容——关注我们的出版物并<a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io">订阅我们的YouTube频道</strong> </a> <strong class="kv io">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>