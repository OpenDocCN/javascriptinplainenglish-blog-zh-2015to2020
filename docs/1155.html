<html>
<head>
<title>React Material UI Dark Mode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应材质UI黑暗模式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-material-ui-dark-mode-705f33202344?source=collection_archive---------4-----------------------#2020-02-05">https://javascript.plainenglish.io/react-material-ui-dark-mode-705f33202344?source=collection_archive---------4-----------------------#2020-02-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0a0f" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">创建React应用程序，该应用程序使用材质UI在黑暗模式下进行渲染</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/2ce7bf33a9f1e7b581dd44ba499975e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2sHPi-_oKZNsM7hoz8xPg.jpeg"/></div></div></figure><p id="0fd2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">随着互联网的出现，人们总是盲目地打开应用程序，无论是在手机上还是在电脑上。进入黑暗模式。</p><p id="421d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">黑暗模式已经变得越来越流行。如果你的应用或网站有黑暗模式，那么你已经赢得了这场战斗。用React和Material UI很容易实现。它会用深色和对比强烈的文字来渲染组件，这样看起来很舒服。</p></div><div class="ab cl lk ll hr lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ig ih ii ij ik"><p id="11c9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文中，我们将从头开始，创建一个react应用程序，安装Material UI，并设置一个上下文来存储我们的主题状态。</p><p id="1172" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">本文的来源可以在这里找到。</p><div class="lr ls gp gr lt lu"><a href="https://gitlab.com/sundry/react/material-ui-dark-mode" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd io gy z fp lz fr fs ma fu fw im bi translated">杂项/反应/材质-界面-深色-模式</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">材质UI黑暗模式</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">gitlab.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi km lu"/></div></div></a></div><p id="6652" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">首先，我们将使用React和TypeScript。你可以使用npm或者yarn。</p><pre class="kd ke kf kg gt mj mk ml mm aw mn bi"><span id="7ca5" class="mo mp in mk b gy mq mr l ms mt">npx create-react-app my-app — template typescript</span></pre><p id="3f4d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">下面是React网站上安装React的命令。</p><div class="lr ls gp gr lt lu"><a href="https://create-react-app.dev/docs/adding-typescript/" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd io gy z fp lz fr fs ma fu fw im bi translated">创建React应用程序通过运行一个命令设置一个现代化的web应用程序。</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">注意:此功能在“react-scripts@2.1.0”和更高版本中可用。</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">创建-反应-应用程序.开发</p></div></div><div class="md l"><div class="mu l mf mg mh md mi km lu"/></div></div></a></div><p id="3b89" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">好了，现在我们已经安装了React。让我们创建一个React上下文来存储用户的主题状态。不是所有人都喜欢黑暗模式，所以我们将默认它是假的。</p><pre class="kd ke kf kg gt mj mk ml mm aw mn bi"><span id="c212" class="mo mp in mk b gy mq mr l ms mt">interface ContextProps {<br/>  darkMode: boolean;<br/>  setDarkMode(darkMode: boolean): void;<br/>}</span><span id="dfdc" class="mo mp in mk b gy mv mr l ms mt">const Context = React.createContext&lt;ContextProps&gt;({<br/>  darkMode: false,<br/>  setDarkMode: () =&gt; {},<br/>});</span></pre><p id="da9b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这将创建一个React上下文，我们可以在其中存储一个名为darkMode的布尔变量和一个名为setDarkMode的setter函数，它可以在亮暗模式之间切换。</p><p id="0c9b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我们将创建一个React上下文提供者，我们可以在应用程序中的任何地方使用它。</p><pre class="kd ke kf kg gt mj mk ml mm aw mn bi"><span id="4d66" class="mo mp in mk b gy mq mr l ms mt">interface Props {<br/>  children?: React.ReactNode;<br/>}</span><span id="6e34" class="mo mp in mk b gy mv mr l ms mt">const Provider: React.FC&lt;Props&gt; = ({ children }) =&gt; {<br/>  const [darkMode, setDarkMode] = useLocalStorage('darkMode', false);<br/>  return (<br/>    &lt;Context.Provider<br/>      value={{<br/>        darkMode,<br/>        setDarkMode,<br/>      }}<br/>    &gt;<br/>    {children}<br/>  &lt;/Context.Provider&gt;<br/> );<br/>};</span></pre><p id="3ea8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该代码片段将创建一个React上下文提供程序，该提供程序将使用一个名为useLocalStorage的自定义挂钩。</p><p id="cbb1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">查看我关于如何创建自己的定制钩子的文章，尤其是useLocalStorage钩子。</p><div class="lr ls gp gr lt lu"><a href="https://medium.com/@andrewgbliss/react-custom-hook-uselocalstorage-afbde976c72b" rel="noopener follow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd io gy z fp lz fr fs ma fu fw im bi translated">React自定义挂钩useLocalStorage</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">React Hooks风靡全球！不需要笨重的类和奇怪的关键字this。现在我们…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">medium.com</p></div></div><div class="md l"><div class="mw l mf mg mh md mi km lu"/></div></div></a></div><p id="25ad" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在让我们开始导出我们的精彩上下文，这样我们就可以在我们的应用程序中使用它们了。</p><pre class="kd ke kf kg gt mj mk ml mm aw mn bi"><span id="a42f" class="mo mp in mk b gy mq mr l ms mt">export const useStore = () =&gt; useContext(Context);</span><span id="53fb" class="mo mp in mk b gy mv mr l ms mt">export function withProvider(Component: any) {<br/>  return function WrapperComponent(props: any) {<br/>    return (<br/>      &lt;Provider&gt;<br/>        &lt;Component {...props} /&gt;<br/>      &lt;/Provider&gt;<br/>    );<br/>  };<br/>}</span><span id="feec" class="mo mp in mk b gy mv mr l ms mt">export { Context, Provider };</span></pre><p id="0572" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这将导出上下文和提供者，以便在我们的应用程序中使用。但是，让我们也导出一些助手函数，这样我们就可以整齐地包装or组件。</p><p id="f3f8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">useStore函数是我们进入这个上下文的钩子。我们将在我们的组件中使用它来切换主题。</p><p id="0620" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">withProvider函数是我们的包装器，它将使我们能够在这个上下文中整齐地包装我们的应用程序组件。如果您不熟悉React上下文，这里有一个链接。</p><p id="5005" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae mx" href="https://reactjs.org/docs/hooks-reference.html#usecontext" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/docs/hooks-reference.html#usecontext</a></p><p id="fb02" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们再添加几个助手函数。</p><pre class="kd ke kf kg gt mj mk ml mm aw mn bi"><span id="f7fd" class="mo mp in mk b gy mq mr l ms mt">export const useApp = () =&gt; {<br/>  const { darkMode, setDarkMode } = useStore();<br/>  return {<br/>    darkMode,<br/>    setDarkMode,<br/>  };<br/>};</span><span id="6edf" class="mo mp in mk b gy mv mr l ms mt">export function withThemeProvider(Component: any) {<br/>  const WrapperComponent = ({ props }: any) =&gt; {<br/>  const { darkMode } = useApp();<br/>  const theme = darkMode ? darkTheme : defaultTheme;<br/>  return (<br/>    &lt;ThemeProvider theme={theme}&gt;<br/>      &lt;CssBaseline /&gt;<br/>      &lt;Component {...props} /&gt;<br/>    &lt;/ThemeProvider&gt;<br/>  );<br/> };<br/> return withProvider(WrapperComponent);<br/>}</span></pre><p id="2bee" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">useApp函数只是将useStore函数重命名为更容易理解的名称。这是我们的应用环境。每当主题改变，它需要更新整个应用程序。当然，您不希望经常改变这种状态。你可能想使用Memo和useCallback来提高应用程序的效率，但这是一个更广泛的话题，我们将在后面的文章中讨论。</p><p id="7481" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">withThemeProvider函数是一个包装器，它使我们能够将我们的应用程序包装在一个材质UI主题中。你可以看到我正在使用useApp钩子并提取darkMode布尔值来决定材质UI使用哪个主题。当变量状态改变时，它会用新的主题呈现这个组件。</p><p id="db6b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在让我们看看我们简单的应用程序组件。</p><pre class="kd ke kf kg gt mj mk ml mm aw mn bi"><span id="84d1" class="mo mp in mk b gy mq mr l ms mt">import React from 'react';<br/>import { makeStyles } from '@material-ui/core/styles';<br/>import { withThemeProvider } from './store/Store';<br/>import Grid from '@material-ui/core/Grid';<br/>import Paper from '@material-ui/core/Paper';<br/>import Box from '@material-ui/core/Box';<br/>import FormControlLabel from '@material-ui/core/FormControlLabel';<br/>import Switch from '@material-ui/core/Switch';<br/>import { useStore } from './store/Store';</span><span id="fc1e" class="mo mp in mk b gy mv mr l ms mt">const useStyles = makeStyles(theme =&gt; ({<br/>  root: {<br/>    width: '100%',<br/>    height: '100%',<br/>  },<br/>}));</span><span id="441c" class="mo mp in mk b gy mv mr l ms mt">const App: React.FC = () =&gt; {<br/>  const classes = useStyles();<br/>  const { darkMode, setDarkMode } = useStore();<br/>  return (<br/>    &lt;Grid<br/>      className={classes.root}<br/>      container<br/>      justify="center"<br/>      alignItems="center"<br/>    &gt;<br/>      &lt;Paper&gt;<br/>        &lt;Box p={10}&gt;<br/>          &lt;FormControlLabel<br/>            control={<br/>              &lt;Switch<br/>                checked={darkMode}<br/>                onChange={() =&gt; setDarkMode(!darkMode)}<br/>              /&gt;<br/>            }<br/>            label="Dark Mode"<br/>          /&gt;<br/>       &lt;/Box&gt;<br/>     &lt;/Paper&gt;<br/>   &lt;/Grid&gt;<br/> );<br/>};</span><span id="8390" class="mo mp in mk b gy mv mr l ms mt">export default withThemeProvider(App);</span></pre><p id="eaa0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是我们的应用程序组件，它将接受我们的useStore挂钩，并从上下文中获取darkMode和setDarkMode。</p><p id="6c36" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">它将呈现一个用户可以用来打开或关闭黑暗模式主题的开关组件。</p><p id="2896" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您可能希望将此开关放在抽屉或用户设置页面中。一旦你有了上下文，我们将应用程序包装在我们的withThemeProvider中。</p><p id="7cab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">再一次，你应该记住，当创建一个像这样的全球环境时，你的应用程序的性能。全局上下文应该只存储关于整个应用程序的信息，比如主题或登录的用户。</p><p id="0841" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">谢谢！</p></div></div>    
</body>
</html>