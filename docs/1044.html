<html>
<head>
<title>JavaScript Events Handlers — ondragend and ondragenter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript事件处理程序— ondragend和ondragenter</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-events-handlers-ondragend-and-ondragenter-1d741649c2f5?source=collection_archive---------3-----------------------#2020-01-20">https://javascript.plainenglish.io/javascript-events-handlers-ondragend-and-ondragenter-1d741649c2f5?source=collection_archive---------3-----------------------#2020-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn js jt ju jv gh gi paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gh gi jr"><img src="../Images/b8f8a4e6386bf7e00750f37c870cb7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lE2psnDWs2v8E2xa"/></div></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">Photo by <a class="ae kg" href="https://unsplash.com/@sharonmccutcheon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sharon McCutcheon</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="faad" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在JavaScript中，事件是应用程序中发生的动作。它们是由各种事情触发的，比如输入、提交表单、调整大小等元素变化，或者应用程序运行时发生的错误等。我们可以分配事件处理程序来处理这些事件。发生在DOM元素上的事件可以通过为相应事件的DOM对象的属性分配一个事件处理程序来处理。在本文中，我们通过为<code class="fe jn jo jp jq b">ondragend</code>和<code class="fe jn jo jp jq b">ondragenter</code>事件处理程序创建我们自己的事件处理程序函数，来看看用普通JavaScript代码添加拖放功能的简单方法。</p><h1 id="25fb" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">翁德拉根德</h1><p id="f466" class="pw-post-body-paragraph kh ki iq kj b kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le ij bi translated">通过<code class="fe jn jo jp jq b">ondragend</code>事件，我们可以设置一个事件处理程序来处理<code class="fe jn jo jp jq b">dragend</code>事件，该事件发生在通过释放鼠标按钮或按escape键完成拖动操作时。例如，我们可以通过编写下面的HTML代码来使用它，通过将<code class="fe jn jo jp jq b">draggable </code>属性设置为<code class="fe jn jo jp jq b">true</code>来制作一个可拖动的框，并在其下方放置我们分配了ID <code class="fe jn jo jp jq b">drop-zone</code>的可拖动框:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="56cf" class="mq lg iq jq b gy mr ms l mt mu">&lt;div id='drag-box' draggable="true"&gt;</span><span id="6b89" class="mq lg iq jq b gy mv ms l mt mu">&lt;/div&gt;</span><span id="1eec" class="mq lg iq jq b gy mv ms l mt mu">&lt;div id='drop-zone'&gt;</span><span id="e536" class="mq lg iq jq b gy mv ms l mt mu">&lt;/div&gt;</span></pre><p id="d070" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后我们用CSS样式化它，使其宽100像素，高100像素，填充红色背景，并使<code class="fe jn jo jp jq b">drop-zone</code> div宽200像素，高200像素，使其背景为紫色:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="423a" class="mq lg iq jq b gy mr ms l mt mu">#drag-box {<br/>  width: 100px;<br/>  height: 100px;<br/>  background-color: red;<br/>}</span><span id="2a4b" class="mq lg iq jq b gy mv ms l mt mu">#drop-zone {<br/>  width: 200px;<br/>  height: 200px;<br/>  background-color: purple<br/>}</span></pre><p id="5957" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">最后，我们可以添加JavaScript代码来跟踪框的拖动动作，方法是将一个事件处理函数分配给我们在HTML代码中创建的框的DOM元素的<code class="fe jn jo jp jq b">ondragend</code>属性:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="1000" class="mq lg iq jq b gy mr ms l mt mu">const dragBox = document.getElementById('drag-box');<br/>const dropZone = document.getElementById('drop-zone');</span><span id="5a8c" class="mq lg iq jq b gy mv ms l mt mu">dragBox.ondragend = (e) =&gt; {<br/>  dropZone.appendChild(dragBox);<br/>}</span></pre><p id="19fd" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在事件处理函数中，我们调用<code class="fe jn jo jp jq b">dropZone</code>对象上的<code class="fe jn jo jp jq b">appendChild</code>将红色可拖动框放入紫色框中，这样看起来就像红色框被放入紫色框中。除了将<code class="fe jn jo jp jq b">dragBox</code>对象直接传递给<code class="fe jn jo jp jq b">appendChild</code>方法，我们还可以获取<code class="fe jn jo jp jq b">e</code>参数的<code class="fe jn jo jp jq b">srcElement</code>属性，然后将其传递给<code class="fe jn jo jp jq b">appendChild</code>，如以下代码所示:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="009c" class="mq lg iq jq b gy mr ms l mt mu">const dragBox = document.getElementById('drag-box');<br/>const dropZone = document.getElementById('drop-zone');</span><span id="4b4f" class="mq lg iq jq b gy mv ms l mt mu">dragBox.ondragend = (e) =&gt; {<br/>  dropZone.appendChild(e.srcElement);<br/>}</span></pre><p id="7ff4" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">上面的代码比直接将<code class="fe jn jo jp jq b">dragBox</code>传入<code class="fe jn jo jp jq b">appendChild</code>要好，因为它比事件处理函数的原始版本更通用。我们可以将它附加到任何我们想要的可拖动对象上。例如，如果我们有多个可拖动的<code class="fe jn jo jp jq b">div</code>元素，如下面的HTML代码所示:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="77de" class="mq lg iq jq b gy mr ms l mt mu">&lt;div id='drag-box' draggable="true"&gt;<br/>&lt;/div&gt;</span><span id="63bd" class="mq lg iq jq b gy mv ms l mt mu">&lt;div id='drag-box-2' draggable="true"&gt;<br/>&lt;/div&gt;</span><span id="6422" class="mq lg iq jq b gy mv ms l mt mu">&lt;div id='drop-zone'&gt;<br/>&lt;/div&gt;</span></pre><p id="a279" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我们更改CSS来设计两个可拖动的<code class="fe jn jo jp jq b">div</code>元素，如下面的代码所示:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="2da6" class="mq lg iq jq b gy mr ms l mt mu">#drag-box {<br/>  width: 100px;<br/>  height: 100px;<br/>  background-color: red;<br/>}</span><span id="42ed" class="mq lg iq jq b gy mv ms l mt mu">#drag-box-2 {<br/>  width: 100px;<br/>  height: 100px;<br/>  background-color: green;<br/>}</span><span id="3ea4" class="mq lg iq jq b gy mv ms l mt mu">#drop-zone {<br/>  width: 200px;<br/>  height: 200px;<br/>  background-color: purple<br/>}</span></pre><p id="c4f9" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后，我们可以编写以下JavaScript代码，使用一个<code class="fe jn jo jp jq b">ondragend</code>事件处理函数来处理两个可拖动的<code class="fe jn jo jp jq b">div</code>元素的拖放，如下面的代码所示:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="1e38" class="mq lg iq jq b gy mr ms l mt mu">const dragBox = document.getElementById('drag-box');<br/>const dragBox2 = document.getElementById('drag-box-2');<br/>const dropZone = document.getElementById('drop-zone');</span><span id="d55c" class="mq lg iq jq b gy mv ms l mt mu">const dragEndHandler = (e) =&gt; {<br/>  dropZone.appendChild(e.srcElement);<br/>}</span><span id="3096" class="mq lg iq jq b gy mv ms l mt mu">dragBox.ondragend = dragEndHandler;<br/>dragBox2.ondragend = dragEndHandler;</span></pre><p id="bd14" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">从上面的代码中我们可以看到，我们为两个可拖动的<code class="fe jn jo jp jq b">div</code> DOM元素对象的<code class="fe jn jo jp jq b">ondragend</code>属性分配了相同的事件处理函数。最后，我们得到以下效果:</p><figure class="mi mj mk ml gt jv gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/ad736f7326146a00490ab44311bcba97.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/1*OFzWJFwYamOcpxPIfx9x6g.gif"/></div></figure><figure class="mi mj mk ml gt jv gh gi paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gh gi mx"><img src="../Images/172645d63d95601e695345c85a3dce29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sNKhy7qAJpva9c3f"/></div></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">Photo by <a class="ae kg" href="https://unsplash.com/@mjsleeper?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matthew Sleeper</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5101" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">翁德朗特</h1><p id="e06b" class="pw-post-body-paragraph kh ki iq kj b kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le ij bi translated">使用DOM元素的<code class="fe jn jo jp jq b">ondragenter</code>属性，我们可以分配一个事件处理函数来处理<code class="fe jn jo jp jq b">dragenter</code>事件。当拖动的元素或文本选择进入有效的放置目标时，触发<code class="fe jn jo jp jq b">dragenter</code>事件。目标对象是被用户直接指定为放置目标或主体元素的元素。例如，我们可以使用<code class="fe jn jo jp jq b">ondragenter</code>事件处理函数来跟踪可拖动元素进入的元素，并通过将事件处理函数分配给<code class="fe jn jo jp jq b">ondragenter</code>属性，将可拖动元素拖放到我们想要拖放的元素中。例如，通过编写以下代码，我们可以添加以下HTML代码来添加一个用于显示可拖动元素被放入的元素的ID的<code class="fe jn jo jp jq b">p</code>元素、一个可拖动的<code class="fe jn jo jp jq b">div</code>元素和两个可拖动的<code class="fe jn jo jp jq b">div</code>元素:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="e615" class="mq lg iq jq b gy mr ms l mt mu">&lt;p id='drop-tracker'&gt;</span><span id="1e33" class="mq lg iq jq b gy mv ms l mt mu">&lt;/p&gt;<br/>&lt;div id='drag-box' draggable="true"&gt;<br/>&lt;/div&gt;<br/>&lt;div id='drop-zones'&gt;<br/>  &lt;div id='drop-zone'&gt;<br/>  &lt;/div&gt;</span><span id="af0f" class="mq lg iq jq b gy mv ms l mt mu">&lt;div id='drop-zone-2'&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="1e8c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后，我们通过使用以下CSS代码更改每个div的颜色和大小，来设置HTML代码中的元素的样式:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="0ed0" class="mq lg iq jq b gy mr ms l mt mu">#drag-box {<br/>  width: 100px;<br/>  height: 100px;<br/>  background-color: red;<br/>}</span><span id="cd03" class="mq lg iq jq b gy mv ms l mt mu">#drop-zones {<br/>  display: flex;<br/>}</span><span id="3236" class="mq lg iq jq b gy mv ms l mt mu">#drop-zone {<br/>  width: 200px;<br/>  height: 200px;<br/>  background-color: purple<br/>}</span><span id="499a" class="mq lg iq jq b gy mv ms l mt mu">#drop-zone-2 {<br/>  width: 200px;<br/>  height: 200px;<br/>  background-color: green;<br/>}</span></pre><p id="c03c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">通过使用<code class="fe jn jo jp jq b">display: flex</code>属性和值，我们将可以拖放<code class="fe jn jo jp jq b">div</code>的2个<code class="fe jn jo jp jq b">div</code>元素放在一起。然后，我们可以将自己的事件处理函数分配给2个<code class="fe jn jo jp jq b">div</code>元素的<code class="fe jn jo jp jq b">ondragenter</code>属性，通过编写以下代码，我们可以将可拖动的<code class="fe jn jo jp jq b">div</code>元素放入其中:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="327b" class="mq lg iq jq b gy mr ms l mt mu">const dragBox = document.getElementById('drag-box');<br/>const dropZone = document.getElementById('drop-zone');<br/>const dropZone2 = document.getElementById('drop-zone-2');<br/>const dropTracker = document.getElementById('drop-tracker');</span><span id="38c6" class="mq lg iq jq b gy mv ms l mt mu">const dragEnterHandler = (e) =&gt; {<br/>  if (e.toElement.id.includes('drop-zone')) {<br/>    dropTracker.innerHTML = `Dropped to ${e.toElement.id}`;<br/>    e.toElement.appendChild(document.getElementById('drag-box'));<br/>  }<br/>}</span><span id="6f80" class="mq lg iq jq b gy mv ms l mt mu">dropZone.ondragenter = dragEnterHandler;<br/>dropZone2.ondragenter = dragEnterHandler;</span></pre><p id="05e7" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在<code class="fe jn jo jp jq b">dragEnterHandler</code>函数中，我们通过检查<code class="fe jn jo jp jq b">e.toElement.id</code>属性来检查是否将<code class="fe jn jo jp jq b">drag-box</code> <code class="fe jn jo jp jq b">div</code>元素拖到了<code class="fe jn jo jp jq b">drop-zone</code> <code class="fe jn jo jp jq b">div</code>元素中。属性包含了我们要拖动的元素。我们通过写<code class="fe jn jo jp jq b">e.toElement.id.includes(‘drop-zone’)</code>来检查<code class="fe jn jo jp jq b">drag-box</code> <code class="fe jn jo jp jq b">div</code>确实进入了2 <code class="fe jn jo jp jq b">drop-zone</code> <code class="fe jn jo jp jq b">div</code>元素，所以我们不能把它们放在我们不希望它们被放的地方。如果<code class="fe jn jo jp jq b">drag-box</code> <code class="fe jn jo jp jq b">div</code>落在<code class="fe jn jo jp jq b">drop-zone</code> <code class="fe jn jo jp jq b">div</code>元素之一中，那么我们调用<code class="fe jn jo jp jq b">drop-zone</code> <code class="fe jn jo jp jq b">div</code>上的<code class="fe jn jo jp jq b">appendChild</code>将它们放在<code class="fe jn jo jp jq b">drop-zone</code> <code class="fe jn jo jp jq b">div</code>里面。此外，我们通过设置<code class="fe jn jo jp jq b">drop-tracker</code> <code class="fe jn jo jp jq b">p</code>元素的<code class="fe jn jo jp jq b">innerHTML</code>属性，显示了我们将<code class="fe jn jo jp jq b">drag-box</code> <code class="fe jn jo jp jq b">div</code>放入的<code class="fe jn jo jp jq b">drop-zone</code> <code class="fe jn jo jp jq b">div</code>的ID。最后，我们应该有如下内容:</p><figure class="mi mj mk ml gt jv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/ff0f1d167d62de643dd4e0da86a04db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*VSTivgFTmW89TKRDSgnqCw.png"/></div></figure><p id="01c3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">使用<code class="fe jn jo jp jq b">ondragenter</code>事件处理函数，我们可以将可拖动的元素放入我们想要放入的元素中，可以是一个或多个。</p><p id="fc41" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">DOM元素的<code class="fe jn jo jp jq b">ondragend</code>属性允许我们设置一个事件处理程序来处理<code class="fe jn jo jp jq b">dragend</code>事件，该事件在通过释放鼠标按钮或按下escape键完成拖动操作时发生。利用DOM元素的<code class="fe jn jo jp jq b">ondragenter</code>属性，我们可以分配一个事件处理函数来处理<code class="fe jn jo jp jq b">dragenter</code>事件。当拖动的元素或文本选择进入有效的放置目标时，触发<code class="fe jn jo jp jq b">dragenter</code>事件。目标对象是被用户直接指定为放置目标或主体元素的元素。这让我们可以将一个可拖动的元素拖放到多个可能的元素中。</p></div></div>    
</body>
</html>