<html>
<head>
<title>Vue 3 — Dynamic and Async Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue 3 —动态和异步组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-3-dynamic-and-async-components-9d6389b012a?source=collection_archive---------4-----------------------#2020-10-04">https://javascript.plainenglish.io/vue-3-dynamic-and-async-components-9d6389b012a?source=collection_archive---------4-----------------------#2020-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9bf569b3ea2cbc61a92b40517f3df5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WXT27PrcZ5pPJt1R"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@yogi198?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Yogesh Mankame</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="714c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue 3处于测试阶段，可能会有变化。</p><p id="d5d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue 3是Vue前端框架的最新版本。</p><p id="1584" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它建立在Vue 2的普及性和易用性之上。</p><p id="577f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Vue 3添加动态和异步组件。</p><h1 id="a53c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">带<code class="fe lz ma mb mc b">keep-alive</code>的动态组件</h1><p id="818c" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lz ma mb mc b">keep-alive</code>组件让我们保持组件的状态，即使我们退出了它们。</p><p id="ced5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="5c85" class="mq lc iq mc b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click='currentComponent = "tab-home"'&gt;home&lt;/button&gt;<br/>      &lt;button @click='currentComponent = "tab-post"'&gt;post&lt;/button&gt;<br/>      &lt;button @click='currentComponent = "tab-archive"'&gt;archive&lt;/button&gt;<br/>      &lt;keep-alive&gt;<br/>        &lt;component :is="currentComponent"&gt;&lt;/component&gt;<br/>      &lt;/keep-alive&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const app = Vue.createApp({<br/>        data() {<br/>          return {<br/>            currentComponent: "tab-home"<br/>          };<br/>        }<br/>      });</span><span id="bdf9" class="mq lc iq mc b gy mv ms l mt mu">      app.component("tab-home", {<br/>        template: `<br/>          &lt;div&gt;<br/>            home<br/>          &lt;/div&gt;<br/>        `<br/>      });</span><span id="04c3" class="mq lc iq mc b gy mv ms l mt mu">      app.component("tab-post", {<br/>        data() {<br/>          return {<br/>            on: false<br/>          };<br/>        },<br/>        template: `<br/>          &lt;div&gt;<br/>            &lt;button @click='on = !on'&gt;toggle&lt;/button&gt;<br/>            &lt;p v-if='on'&gt;post&lt;/p&gt;<br/>          &lt;/div&gt;<br/>        `<br/>      });</span><span id="1a0d" class="mq lc iq mc b gy mv ms l mt mu">      app.component("tab-archive", {<br/>        data() {<br/>          return {<br/>            on: false<br/>          };<br/>        },<br/>        template: `<br/>          &lt;div&gt;<br/>            &lt;button @click='on = !on'&gt;toggle&lt;/button&gt;<br/>            &lt;p v-if='on'&gt;archive&lt;/p&gt;<br/>          &lt;/div&gt;<br/>        `<br/>      });</span><span id="b29b" class="mq lc iq mc b gy mv ms l mt mu">      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="bcf8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe lz ma mb mc b">keep-alive</code>组件来缓存动态组件的状态，这样当我们离开它后再次显示它时，我们保持和以前一样的状态。</p><p id="52b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，如果<code class="fe lz ma mb mc b">on</code>状态是<code class="fe lz ma mb mc b">tab-post</code>或<code class="fe lz ma mb mc b">tab-archive</code>中的<code class="fe lz ma mb mc b">true</code>，那么<code class="fe lz ma mb mc b">on</code>将保持<code class="fe lz ma mb mc b">true</code>，即使我们在任何组件之间来回切换。</p><p id="94ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有它，<code class="fe lz ma mb mc b">on</code>状态将被重置为初始状态。</p><h1 id="7cf3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">异步组件</h1><p id="5b0d" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">在较大的应用程序中，我们可能需要将应用程序分成更小的块，只在需要的时候从服务器加载组件。</p><p id="f99f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lz ma mb mc b">Vue.defineAsyncComponent</code>方法来实现。</p><p id="e7df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="9582" class="mq lc iq mc b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;async-comp&gt;&lt;/async-comp&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const app = Vue.createApp({});</span><span id="5e29" class="mq lc iq mc b gy mv ms l mt mu">      const AsyncComp = Vue.defineAsyncComponent(<br/>        () =&gt;<br/>          new Promise((resolve, reject) =&gt; {<br/>            resolve({<br/>              template: "&lt;div&gt;async component&lt;/div&gt;"<br/>            });<br/>          })<br/>      );</span><span id="274e" class="mq lc iq mc b gy mv ms l mt mu">      app.component("async-comp", AsyncComp);</span><span id="1327" class="mq lc iq mc b gy mv ms l mt mu">      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="78b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">定义异步组件并使用它。</p><p id="19ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一个回调函数调用了<code class="fe lz ma mb mc b">Vue.defineAsyncComponent</code>，该回调函数返回一个解析为组件对象的承诺。</p><p id="a690" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将返回给<code class="fe lz ma mb mc b">app.component</code>方法的异步组件以名称作为第一个参数，异步组件对象作为第二个参数。</p><p id="8ab4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在父Vue实例的模板中使用它。</p><p id="155f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以从其他地方导入组件。</p><p id="b883" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="5aba" class="mq lc iq mc b gy mr ms l mt mu">import { defineAsyncComponent } from 'vue'</span><span id="2cca" class="mq lc iq mc b gy mv ms l mt mu">const AsyncComp = defineAsyncComponent(() =&gt;<br/>  import('./components/AsyncComponent.vue')<br/>)</span><span id="b76e" class="mq lc iq mc b gy mv ms l mt mu">app.component('async-component', AsyncComp)</span></pre><p id="4f99" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lz ma mb mc b">import</code>返回一个解析到Vue组件的承诺，因此我们获得了相同的结果。</p><p id="8fe8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以通过将我们的异步组件放在<code class="fe lz ma mb mc b">components</code>属性中来本地注册组件:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="d8a9" class="mq lc iq mc b gy mr ms l mt mu">import { createApp, defineAsyncComponent } from 'vue'</span><span id="d476" class="mq lc iq mc b gy mv ms l mt mu">createApp({<br/>  // ...<br/>  components: {<br/>    AsyncComponent: defineAsyncComponent(() =&gt;<br/>      import('./components/AsyncComponent.vue')<br/>    )<br/>  }<br/>})</span></pre><h1 id="bc1e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">带悬念地使用</h1><p id="753e" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">默认情况下，异步组件是可挂起的。</p><p id="de04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们可以将它传递给<code class="fe lz ma mb mc b">Suspenbse</code>组件并使用它。</p><p id="190e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要禁用暂停，我们可以在异步组件中将<code class="fe lz ma mb mc b">suspensible</code>设置为<code class="fe lz ma mb mc b">false</code>。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/41ddba4da16abc87a28b83b5d5db468a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4urHBNhSS1zwA5yz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@thezenoeffect?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Shyam</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="998d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3493" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以定义异步组件来异步加载它们。</p><p id="3d04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lz ma mb mc b">keep-alive</code>组件让我们在它们之间切换时保持组件的状态。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/787be6c671be8d345dc786dad8729ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s-sOyyG8NoRbKpCG_y4Cmw@2x.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank">Subscribe to Decoded, our official YouTube channel!</a></figcaption></figure></div></div>    
</body>
</html>