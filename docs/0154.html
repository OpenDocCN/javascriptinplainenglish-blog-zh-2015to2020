<html>
<head>
<title>Hacking my Honeymoon with JavaScript 🦒</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript入侵我的蜜月🦒</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/hacking-my-honeymoon-with-javascript-c4c476f7584b?source=collection_archive---------1-----------------------#2019-05-25">https://javascript.plainenglish.io/hacking-my-honeymoon-with-javascript-c4c476f7584b?source=collection_archive---------1-----------------------#2019-05-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a8ab" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">我如何使用web scraper、cron和SMS通过非传统方法预订房间</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/38b26b45c3a0b6136de94e44e5e35e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Oo8Lm6D2liqKTVG9T2zlw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@tobinrogers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Tobin Rogers</a> on <a class="ae ks" href="https://unsplash.com/search/photos/giraffe?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fa07" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当我妻子在Instagram上看到这个帖子时，她立刻就被迷住了:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="0053" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们在肯尼亚的蜜月即将来临，我们开始预订房间。咨询了年前去过肯尼亚的阿姨，她留在了这里，订票没有困难。当我们听说这个地方在一两年前就被预订一空时，我们大吃一惊。</p><p id="e149" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">突然流行一定是有原因的。一些调查显示这个地方最近被艾伦·T4占领了。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ls lq l"/></div></figure><p id="565a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该死的艾伦。</p><p id="e44a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">起初，我们查看他们的网站，看看我们在肯尼亚的日期是否可用，运气不好。然后我们给庄园发了电子邮件，还是没有，我们被告知我们被列入了他们的“等候名单”。很可能与候选名单上的其他人竞争，我们的旅行只有几个月了，我和我妻子的希望变得渺茫。</p><h1 id="c15d" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">寻求解决方案</h1><p id="a01e" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">他们用来显示空房的网站是只读的，没有预订房间的功能。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mq"><img src="../Images/330e31306bb1fe2e08c3b31c70fd4eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mRaBy1Ro60a_jHikES1cJQ.gif"/></div></div></figure><p id="b086" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">电话和电子邮件是联系他们的唯一方式，这是一个缓慢而艰难的过程。我认为当约会变得空闲时，他们的网站会首先更新<em class="lr"/>和<em class="lr">，然后</em>他们会开始联系候补成员。这样，如果人们错过了，他们仍然会得到预订。</p><h1 id="fb48" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">假设</h1><p id="720e" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">我接下来假设的是，如果我们在空房那天联系他们，我们可能会绕过等候名单。但是每小时查看网站并不有趣。</p><p id="0967" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我穿上我的程序员裤，认为这将是一个很好的web-scraper的用例，<em class="lr"> jazz hands </em>。每30分钟访问一次网站，给我和我妻子的手机发短信，这样我们就可以给他们打电话了。这个1990年的肯尼亚网站不太可能有针对机器人的保护。</p><p id="4c57" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">看似简单的桌子，结果却是简单的桌子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr lq l"/></div></figure><p id="90cd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是我需要找到的，如果节点文本是<code class="fe ms mt mu mv b">1</code>，它是可用的。</p><p id="0042" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在研究了简单的html结构之后，我开始编写Node.js服务来废弃它。我偶然发现了一个NPM模块，<a class="ae ks" href="https://www.npmjs.com/package/crawler" rel="noopener ugc nofollow" target="_blank">爬虫</a>，它给了我开箱所需的一切。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr lq l"/></div></figure><p id="b66c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这需要一点调试，但现在我有了长颈鹿庄园网站的HTML可以玩了。</p><p id="306f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，我用一个叫做<a class="ae ks" href="https://www.npmjs.com/package/cheerio" rel="noopener ugc nofollow" target="_blank"> cheerio </a>的NPM包搜索结果。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr lq l"/></div></figure><p id="186d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在有趣的部分来了，当房间显示有空房时，给我妻子发短信。为此我使用了Twilio，但是还有很多其他的服务。这需要建立一个免费账户，我知道我不会发送超过几条短信。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr lq l"/></div></figure><p id="7cca" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在测试了几个没有预定的日期后，它成功了！现在安排它每5分钟运行一次(为什么不呢？).</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr lq l"/></div></figure><p id="0a32" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了托管和运行代码，我选择了Heroku，因为我有这方面的经验，并且知道免费层可以满足我的需要。我不知道他们的免费层如何支持后台服务工作，但无论如何。</p><p id="bc4c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">几个星期后，(实际上我忘了它还在运行)，我妻子的手机收到了这条短信！我们马上给他们打电话，拿到了！似乎绕过了等候名单，就像我们希望的那样。她收到了一大堆短信，用光了我在Twilio上的免费层，因为当它找到一个可用的空间时，我没有编写stop方法🤣</p><p id="427b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我特别喜欢这样做，因为我并不经常用编码来解决生活中的问题，但我认为对于这样的图片来说这是值得的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mw"><img src="../Images/8bbf22e187fb850676a38f510dfd06bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VDpO2QQ_Yn_PSSHmGdqm2A.jpeg"/></div></div></figure><p id="ae32" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是我如何用我的编程技能解决“真实”世界问题的一个例子。我很想听听你可能已经解决的问题，请在这里评论。</p><p id="c091" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">https://github.com/aleccool213/giraffe-manor-ping<a class="ae ks" href="https://github.com/aleccool213/giraffe-manor-ping" rel="noopener ugc nofollow" target="_blank">的代号</a></p></div></div>    
</body>
</html>