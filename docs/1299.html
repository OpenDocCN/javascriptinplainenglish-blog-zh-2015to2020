<html>
<head>
<title>More About the Express Application Object</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于快速应用程序对象的更多信息</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/more-about-the-express-application-object-a8ea38f04c93?source=collection_archive---------6-----------------------#2020-02-26">https://javascript.plainenglish.io/more-about-the-express-application-object-a8ea38f04c93?source=collection_archive---------6-----------------------#2020-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/75a821f6ad2c12c64d0095ed5245e21a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8fv4docdMf6eLvHn"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mimithian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mimi Thian</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="07cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">快速应用程序的核心部分是应用程序对象。是应用本身。</p><p id="06a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看<code class="fe lb lc ld le b">app</code>对象的方法以及我们可以用它做什么。</p><h1 id="69a0" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">方法</h1><h2 id="0fba" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.disabled(名称)</h2><p id="bcb1" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">如果给定的设置被禁用，该方法返回<code class="fe lb lc ld le b">true</code>。</p><p id="ea21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="e2a3" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');</span><span id="46a2" class="md lg iq le b gy ng nd l ne nf">const app = express();</span><span id="58d6" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="35b6" class="md lg iq le b gy ng nd l ne nf">app.disable('foo');</span><span id="996b" class="md lg iq le b gy ng nd l ne nf">app.get('/', function (req, res, next) {<br/>  res.json({ fooDisabled: app.disabled('foo') });<br/>})</span><span id="9a8c" class="md lg iq le b gy ng nd l ne nf">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="726d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="223b" class="md lg iq le b gy nc nd l ne nf">{"fooDisabled":true}</span></pre><p id="58ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们叫<code class="fe lb lc ld le b">app.disable(‘foo’);</code></p><p id="7387" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，如果我们调用<code class="fe lb lc ld le b">app.enable(‘foo’);</code>，那么我们得到:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="de44" class="md lg iq le b gy nc nd l ne nf">{"fooDisabled":false}</span></pre><h2 id="c1bc" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.enable(名称)</h2><p id="8c21" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我们可以使用<code class="fe lb lc ld le b">enable</code>将指定名称的设置设置为<code class="fe lb lc ld le b">true</code>。</p><p id="bf73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以如下使用它:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="e818" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');</span><span id="f250" class="md lg iq le b gy ng nd l ne nf">const app = express();</span><span id="7ef8" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="28e8" class="md lg iq le b gy ng nd l ne nf">app.enable('foo');</span><span id="9b48" class="md lg iq le b gy ng nd l ne nf">app.get('/', function (req, res, next) {<br/>  res.json({ fooDisabled: app.disabled('foo') });<br/>})</span><span id="442b" class="md lg iq le b gy ng nd l ne nf">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="9b3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="b5e7" class="md lg iq le b gy nc nd l ne nf">{"fooDisabled":false}</span></pre><p id="5756" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们调用了传入了<code class="fe lb lc ld le b">'foo'</code>的<code class="fe lb lc ld le b">enable</code>。</p><h2 id="56c2" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.enabled(名称)</h2><p id="7ee4" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">如果启用了具有给定名称的设置，则<code class="fe lb lc ld le b">enabled</code>方法返回。例如，我们可以如下使用它:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="c0a7" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');</span><span id="12f8" class="md lg iq le b gy ng nd l ne nf">const app = express();</span><span id="680e" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="a7c4" class="md lg iq le b gy ng nd l ne nf">app.enable('foo');</span><span id="32a4" class="md lg iq le b gy ng nd l ne nf">app.get('/', function (req, res, next) {<br/>  res.json({ fooDisabled: app.enabled('foo') });<br/>})</span><span id="13a8" class="md lg iq le b gy ng nd l ne nf">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="883e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到了<code class="fe lb lc ld le b">{“fooDisabled”:true}</code>，因为我们调用了<code class="fe lb lc ld le b">app.enable(‘foo’);</code>。</p><h2 id="c687" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.engine(外部，回调)</h2><p id="33c3" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我们调用<code class="fe lb lc ld le b">engine</code>方法来设置用于呈现HTML输出的模板引擎。</p><p id="050e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以如下使用它:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="b784" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const app = express();</span><span id="1493" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));<br/>app.set('views', './views');</span><span id="e511" class="md lg iq le b gy ng nd l ne nf">app.get('/', (req, res, next) =&gt; {<br/>  res.render('index', { people: ['geddy', 'neil', 'alex'] })<br/>})</span><span id="52d6" class="md lg iq le b gy ng nd l ne nf">app.engine('html', require('ejs').renderFile);<br/>app.set('view engine', 'ejs');<br/>app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="f7f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将我们的模板添加到<code class="fe lb lc ld le b">views/index.ejs</code>中，如下所示:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="39e2" class="md lg iq le b gy nc nd l ne nf">&lt;%= people.join(", "); %&gt;</span></pre><p id="8057" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="6a05" class="md lg iq le b gy nc nd l ne nf">geddy, neil, alex</span></pre><p id="62d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">已显示。</p><p id="9836" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">callback</code>应具有参数<code class="fe lb lc ld le b">path</code>、<code class="fe lb lc ld le b">options</code>和<code class="fe lb lc ld le b">callback</code>。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/e849b29bba26b691e1f482be38063a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VJmmaoHlhx8NxCw7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@andrewtneel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andrew Neel</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="06b6" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.get(名称)</h2><p id="9efc" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我们可以使用<code class="fe lb lc ld le b">get</code>方法获得给定名称的设置值。</p><p id="1dec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="f330" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const app = express();</span><span id="b4fc" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));<br/>app.set('title', 'Foo');</span><span id="b773" class="md lg iq le b gy ng nd l ne nf">app.get('/', (req, res, next) =&gt; {<br/>  res.send(app.get('title'));<br/>})</span><span id="c4ca" class="md lg iq le b gy ng nd l ne nf">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="8415" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们显示<code class="fe lb lc ld le b">Foo</code>,因为我们调用了:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="c814" class="md lg iq le b gy nc nd l ne nf">app.set('title', 'Foo');</span></pre><h2 id="d7b4" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.get(路径，回调[，回调…])</h2><p id="a13a" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated"><code class="fe lb lc ld le b">get</code>方法让我们传入一个路由处理程序回调或一系列回调来处理带有给定<code class="fe lb lc ld le b">path</code>的get请求。</p><p id="3f39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它采用以下参数:</p><ul class=""><li id="6b41" class="ni nj iq kf b kg kh kk kl ko nk ks nl kw nm la nn no np nq bi translated"><code class="fe lb lc ld le b">path</code> —它可以是表示路径或路径模式的字符串或正则表达式。默认为<code class="fe lb lc ld le b">/</code>。</li><li id="de72" class="ni nj iq kf b kg nr kk ns ko nt ks nu kw nv la nn no np nq bi translated"><code class="fe lb lc ld le b">callback</code> —处理请求的功能。它可以是一个中间件功能、一系列中间件功能、一系列中间件功能或以上所有功能的组合</li></ul><p id="c964" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以如下使用它:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="a080" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const app = express();</span><span id="8b1d" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));<br/>app.set('title', 'Foo')</span><span id="973e" class="md lg iq le b gy ng nd l ne nf">app.get('/', (req, res, next) =&gt; {<br/>  res.send('GET request made');<br/>})</span><span id="82b7" class="md lg iq le b gy ng nd l ne nf">app.listen(3000, () =&gt; console.log('server started'));</span></pre><h2 id="2364" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app.listen(路径，[回调])</h2><p id="0961" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">它启动一个UNIX套接字并监听给定路径上的连接。</p><p id="9250" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以如下使用它:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="256d" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const app = express();</span><span id="83ed" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));<br/>app.set('title', 'Foo')</span><span id="9e09" class="md lg iq le b gy ng nd l ne nf">app.get('/', (req, res, next) =&gt; {<br/>  res.send('hi');<br/>})</span><span id="d2ee" class="md lg iq le b gy ng nd l ne nf">app.listen('/tmp/sock');</span></pre><p id="2e04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当<code class="fe lb lc ld le b">/tmp/sock</code>套接字不使用时，我们可以通过监听这个套接字来启动我们的应用程序。</p><h2 id="d8e7" class="md lg iq bd lh me mf dn ll mg mh dp lp ko mi mj lt ks mk ml lx kw mm mn mb mo bi translated">app . listen([端口[，主机[，积压]]][，回调])</h2><p id="5f27" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">这个<code class="fe lb lc ld le b">listen</code>方法监听给定主机和端口上的连接。</p><p id="86f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果端口被省略或者是0，那么操作系统将分配一个任意的端口给它监听。</p><p id="cb56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将Express <code class="fe lb lc ld le b">app</code>对象传递给<code class="fe lb lc ld le b">http.createServer</code>来监听如下连接:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="a556" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const http = require('http');<br/>const app = express();</span><span id="a8f3" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="62da" class="md lg iq le b gy ng nd l ne nf">app.get('/', (req, res, next) =&gt; {<br/>  res.send('hi');<br/>})</span><span id="5f94" class="md lg iq le b gy ng nd l ne nf">http.createServer(app).listen(3000);</span></pre><p id="7ca8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们可以很容易地用相同的代码库提供HTTP和HTTPS版本的应用程序。</p><p id="b3d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">app</code>实际上是一个函数，所以我们可以把它作为回调传递给<code class="fe lb lc ld le b">http.createServer</code>。</p><p id="643a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">app.listen()</code>返回一个<code class="fe lb lc ld le b">http.Server</code>对象，这是下面的一个方便的方法:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="d8af" class="md lg iq le b gy nc nd l ne nf">app.listen = function () {<br/>  const server = http.createServer(this)<br/>  return server.listen.apply(server, arguments)<br/>}</span></pre><p id="4acd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以这样使用它:</p><pre class="mu mv mw mx gt my le mz na aw nb bi"><span id="1293" class="md lg iq le b gy nc nd l ne nf">const express = require('express');<br/>const bodyParser = require('body-parser');<br/>const http = require('http');<br/>const app = express();</span><span id="0dd8" class="md lg iq le b gy ng nd l ne nf">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: true }));</span><span id="16ce" class="md lg iq le b gy ng nd l ne nf">app.get('/', (req, res, next) =&gt; {<br/>  res.send('hi');<br/>})</span><span id="828b" class="md lg iq le b gy ng nd l ne nf">app.listen = function () {<br/>  const server = http.createServer(this)<br/>  return server.listen.apply(server, arguments)<br/>}</span><span id="cf9f" class="md lg iq le b gy ng nd l ne nf">app.listen(3000);</span></pre><h1 id="3381" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="3dd7" class="pw-post-body-paragraph kd ke iq kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我们可以用<code class="fe lb lc ld le b">disabled</code>方法检查设置是否被设置为<code class="fe lb lc ld le b">false</code>。</p><p id="ffdd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了处理GET请求，我们可以使用<code class="fe lb lc ld le b">get</code>方法。它接受一个路由路径和一个或多个路由处理程序回调。</p><p id="9bb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们有<code class="fe lb lc ld le b">listen</code>方法来监听来自UNIX套接字或给定主机和端口的连接。因为<code class="fe lb lc ld le b">app</code>实际上是一个函数，所以<code class="fe lb lc ld le b">app</code>可以作为一个回调函数传递给Node.js' <code class="fe lb lc ld le b">http.createServer</code>方法。</p></div></div>    
</body>
</html>