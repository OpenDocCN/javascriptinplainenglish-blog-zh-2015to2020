<html>
<head>
<title>React Tips — Clicks, Watching Widths, Custom Links</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反馈提示—点击、观看宽度、自定义链接</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-tips-clicks-watching-widths-custom-links-7a1459b0c681?source=collection_archive---------15-----------------------#2020-07-27">https://javascript.plainenglish.io/react-tips-clicks-watching-widths-custom-links-7a1459b0c681?source=collection_archive---------15-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aeb2240fa94bcfc3bf694b901af66659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vqch4YDDCFDTWjYP"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@lucija_ros?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lucija Ros</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f447" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的React应用程序的技巧。</p><h1 id="fed0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在React中手动触发点击事件</h1><p id="c948" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了手动触发React组件中的click事件，我们可以为DOM元素分配一个ref。</p><p id="af00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在ref上调用<code class="fe me mf mg mh b">click</code>。</p><p id="8246" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6318" class="mq lc iq mh b gy mr ms l mt mu">class App extends React.Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.handleClick = this.handleClick.bind(this);<br/>  }</span><span id="1fee" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    return (<br/>      &lt;div onClick={this.handleClick}&gt;<br/>        &lt;input ref={input =&gt; this.inputElement = input} /&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }</span><span id="ddcf" class="mq lc iq mh b gy mv ms l mt mu">  handleClick(e){<br/>    this.inputElement.click();<br/>  }<br/>}</span></pre><p id="7568" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经给<code class="fe me mf mg mh b">inputElement</code> ref分配了回调。</p><p id="edc5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过调用<code class="fe me mf mg mh b">this.inputElement</code> DOM对象上的<code class="fe me mf mg mh b">click</code>来点击<code class="fe me mf mg mh b">handleClick</code>方法中的输入元素。</p><p id="ac89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也适用于函数组件:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="54c5" class="mq lc iq mh b gy mr ms l mt mu">const UploadsWindow = () =&gt; {<br/>  const inputRef = useRef();</span><span id="a2e7" class="mq lc iq mh b gy mv ms l mt mu">  const uploadClick = e =&gt; {<br/>    e.preventDefault();<br/>    inputRef.current.click();<br/>  };</span><span id="4ef9" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;&gt;<br/>      &lt;input<br/>        type="file"<br/>        name="fileUpload"<br/>        ref={inputRef}<br/>        multiple<br/>        onClick={uploadClick}<br/>      /&gt;<br/>    &lt;/&gt;<br/>  )<br/>}</span></pre><p id="f2cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">useRef</code>钩子创建了一个ref，并将其分配给输入。</p><p id="3532" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们有click handler <code class="fe me mf mg mh b">uploadClick</code>函数，它调用输入DOM元素上的<code class="fe me mf mg mh b">click</code>方法。</p><p id="8210" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">current</code>属性拥有被赋予了ref的DOM对象。</p><h1 id="9156" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在React中响应自动调整大小的DOM元素的宽度</h1><p id="2dde" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了观察React上DOM元素的宽度，我们可以使用react-measure包。</p><p id="9311" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们运行:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3002" class="mq lc iq mh b gy mr ms l mt mu">yarn add react-measure</span></pre><p id="05b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1940" class="mq lc iq mh b gy mr ms l mt mu">npm install react-measure --save</span></pre><p id="d47e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们通过书写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="66f9" class="mq lc iq mh b gy mr ms l mt mu">import * as React from 'react'<br/>import Measure from 'react-measure'</span><span id="c7de" class="mq lc iq mh b gy mv ms l mt mu">const Width = () =&gt; (<br/>  &lt;Measure bounds&gt;<br/>    {({ measureRef, contentRect: { bounds: { width }} }) =&gt; (<br/>      &lt;div ref={measureRef}&gt;{width}&lt;/div&gt;<br/>    )}<br/>  &lt;/Measure&gt;<br/>)</span></pre><p id="a637" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">Measure</code>组件，它有一个回调函数，回调函数有许多属性作为它的参数。</p><p id="af87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">measureRef</code>是一个引用，我们可以用它来获取元素。</p><p id="63ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">contentRect</code>具有关于已经分配给<code class="fe me mf mg mh b">measureRef</code>的元素的信息。</p><p id="5189" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">width</code>有宽度。</p><p id="705e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们观察元素的宽度随<code class="fe me mf mg mh b">width</code>属性的变化。</p><p id="a249" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有react-sizeme组件，它也可以用来获取组件的大小。</p><p id="77a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="037b" class="mq lc iq mh b gy mr ms l mt mu">import SizeMe from 'react-sizeme';</span><span id="17f6" class="mq lc iq mh b gy mv ms l mt mu">class Circle extends Component {<br/>  render() {<br/>    const { width, height } = this.props.size;</span><span id="4a17" class="mq lc iq mh b gy mv ms l mt mu">    return (<br/>     &lt;svg width="100" height="100"&gt;<br/>       &lt;circle cx="150" cy="100" r="80" fill="green" /&gt;<br/>     &lt;/svg&gt;<br/>    );<br/>  }<br/>}</span><span id="e742" class="mq lc iq mh b gy mv ms l mt mu">export default SizeMe()(Circle);</span></pre><p id="9a33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它带有<code class="fe me mf mg mh b">SizeMe</code>高阶组件，我们可以将我们的组件传递给它，以获得它的<code class="fe me mf mg mh b">width</code>和<code class="fe me mf mg mh b">height</code>。</p><p id="f86b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们可以通过props获得，因为我们用它调用了<code class="fe me mf mg mh b">SizeMe</code>高阶组件。</p><h1 id="9742" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在渲染函数之外反应上下文</h1><p id="b16b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有了函数组件，我们可以使用<code class="fe me mf mg mh b">useContext</code>钩子来访问组件中任何地方的上下文。</p><p id="dad8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1715" class="mq lc iq mh b gy mr ms l mt mu">const App = () =&gt; {<br/>  const contextValue = useContext(AppContext);<br/>  // ...<br/>}</span></pre><p id="975f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在类组件中，我们可以设置静态的<code class="fe me mf mg mh b">contextTyoe</code>属性，这样我们就可以在类组件中的任何地方使用上下文。</p><p id="8815" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">this.context</code>属性访问上下文。</p><p id="4638" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c017" class="mq lc iq mh b gy mr ms l mt mu">class App extends React.Component {<br/>  componentDidMount() {<br/>    const value = this.context;<br/>  }</span><span id="145d" class="mq lc iq mh b gy mv ms l mt mu">  componentDidUpdate() {<br/>    const value = this.context;<br/>    /* ... */<br/>  }</span><span id="ef2c" class="mq lc iq mh b gy mv ms l mt mu">  componentWillUnmount() {<br/>    const value = this.context;<br/>    /* ... */<br/>  }</span><span id="0705" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    const value = this.context;<br/>    /* render content */<br/>  }<br/>}</span><span id="1941" class="mq lc iq mh b gy mv ms l mt mu">App.contextType = AppContext;</span></pre><p id="77a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们将<code class="fe me mf mg mh b">contextType</code>属性设置为一个上下文，就可以在任何地方使用<code class="fe me mf mg mh b">this.context</code>。</p><h1 id="1ad1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将React路由器链接包装在HTML按钮中</h1><p id="f140" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用任何想要显示的东西包装<code class="fe me mf mg mh b">Link</code>组件。</p><p id="e8d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8b8f" class="mq lc iq mh b gy mr ms l mt mu">&lt;Link to="/profile"&gt;<br/>   &lt;button type="button"&gt;<br/>     click me<br/>   &lt;/button&gt;<br/> &lt;/Link&gt;</span></pre><p id="4039" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以嵌入组件:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="65f5" class="mq lc iq mh b gy mr ms l mt mu">&lt;Link to="/profile"&gt;<br/>   &lt;Button&gt;<br/>     click me<br/>   &lt;/Button&gt;<br/> &lt;/Link&gt;</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/07dfeb16a82bccd054e7af42c13f7575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4TbUjND2ctb0u7Yl"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@fridooh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Frida Bredesen</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="d298" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="cd5d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过将一个元素分配给ref并对其调用方法来触发click事件。</p><p id="c56f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用<code class="fe me mf mg mh b">render</code>函数之外的上下文。</p><p id="d2a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一些库可以让我们观察组件维度的变化。</p><p id="502f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React路由器<code class="fe me mf mg mh b">Link</code>组件内部可以有元素或者组件。</p><h1 id="6a08" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单英语的JavaScript</h1><p id="f218" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码获得更多类似内容，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>