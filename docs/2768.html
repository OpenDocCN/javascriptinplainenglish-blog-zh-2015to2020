<html>
<head>
<title>React Tips — Function Props, Query Strings, and Default Props</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应提示—函数属性、查询字符串和默认属性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-tips-function-props-query-strings-and-default-props-9b2536818f30?source=collection_archive---------4-----------------------#2020-07-22">https://javascript.plainenglish.io/react-tips-function-props-query-strings-and-default-props-9b2536818f30?source=collection_archive---------4-----------------------#2020-07-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e1e5a1a726d90b04db652016fbde9a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_2bSE0NIBFYP-zXO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@ramche?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ramiz Dedaković</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="49f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的React应用程序的技巧。</p><h1 id="604e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">听React中的状态变化</h1><p id="28c8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过几种方式监听状态变化来做出反应。</p><p id="747b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在类组件中，我们可以使用<code class="fe me mf mg mh b">componentDidUpdate</code>钩子来监听状态和属性的变化。</p><p id="985c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c32d" class="mq lc iq mh b gy mr ms l mt mu">componentDidUpdate(object prevProps, object prevState)</span></pre><p id="0ca9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一个不推荐使用的<code class="fe me mf mg mh b">componentWillUpdate</code>方法。</p><p id="6a37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于功能组件，我们可以使用<code class="fe me mf mg mh b">useEffect</code>钩子来观察变化。</p><p id="f03a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d107" class="mq lc iq mh b gy mr ms l mt mu">const [name, setName] = useState('foo');<br/>useEffect(getSearchResults, [name])</span></pre><p id="cd62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个数组，其中包含我们希望在<code class="fe me mf mg mh b">useEffect</code>钩子的第二个参数中观察的变量。</p><p id="a999" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是当<code class="fe me mf mg mh b">name</code>改变时调用的回调。</p><h1 id="f8e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在与React路由器的链接中传递属性</h1><p id="4ec1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以向<code class="fe me mf mg mh b">Link</code>传递一个查询字符串。</p><p id="1372" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6928" class="mq lc iq mh b gy mr ms l mt mu">&lt;Link to={{ pathname: `/foo/bar`, query: { backUrl } }} /&gt;</span></pre><p id="212d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一个对象设置了<code class="fe me mf mg mh b">query</code>属性。</p><p id="3fba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对象的键和值被转换成一个查询字符串，附加在<code class="fe me mf mg mh b">pathname</code>之后。</p><p id="fac8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以使用带占位符的URL参数:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c069" class="mq lc iq mh b gy mr ms l mt mu">&lt;Route name="/foo/:value" handler={CreateIdeaView} /&gt;</span></pre><p id="b4ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们可以通过使用:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="94b4" class="mq lc iq mh b gy mr ms l mt mu">this.props.match.params.value</span></pre><p id="ebd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要获得查询字符串，我们可以编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0641" class="mq lc iq mh b gy mr ms l mt mu">this.props.location.search</span></pre><p id="3994" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来获取值。</p><p id="8feb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以使用<code class="fe me mf mg mh b">URLSearchParams</code>构造函数来解析它和其中的值:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8e8f" class="mq lc iq mh b gy mr ms l mt mu">new URLSearchParams(this.props.location.search).get("foo")</span></pre><p id="c736" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一个查询字符串<code class="fe me mf mg mh b">?foo=bar</code>，那么它将返回<code class="fe me mf mg mh b">'bar'</code>。</p><h1 id="70d0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用React调用父方法</h1><p id="09e6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们将父组件的函数作为道具传递给子组件，我们可以调用父组件的方法。</p><p id="d01c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="07d4" class="mq lc iq mh b gy mr ms l mt mu">import React, {Component} from 'react';</span><span id="12ba" class="mq lc iq mh b gy mv ms l mt mu">class Child extends Component {<br/>  render () {<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;button<br/>          onClick={() =&gt; this.props.someFunc('foo')}<br/>        &gt;<br/>          click me<br/>        &lt;/button&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="7f9f" class="mq lc iq mh b gy mv ms l mt mu">class Parent extends Component {<br/>  someFunc(value) {<br/>    console.log(value)<br/>  }</span><span id="5c0f" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;Child<br/>          someFunc={this.someFunc.bind(this)}<br/>        /&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }</span><span id="129d" class="mq lc iq mh b gy mv ms l mt mu">}</span></pre><p id="ce51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">Parent</code>组件中的<code class="fe me mf mg mh b">someFunc</code>道具将函数从父节点传递给子节点。</p><p id="1d4d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">Child</code>组件中，我们用<code class="fe me mf mg mh b">this.props.someFunc</code>调用函数。</p><p id="c5a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用函数组件，我们可以编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4ba9" class="mq lc iq mh b gy mr ms l mt mu">import React from "react";</span><span id="ee9c" class="mq lc iq mh b gy mv ms l mt mu">function Child(props){<br/>  return(<br/>    &lt;&gt; <br/>      &lt;button onClick={props.parentFunc}&gt;<br/>        click me<br/>      &lt;/button&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span><span id="4dae" class="mq lc iq mh b gy mv ms l mt mu">function Parent(){<br/>  const parentFunc = () =&gt; {<br/>    console.log("parent func called");<br/>  }<br/> <br/>  return (<br/>    &lt;&gt;    <br/>      &lt;Child <br/>        parentFunc={parentFunc}<br/>      /&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="7f81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">Parent</code>组件，它有作为道具传递给<code class="fe me mf mg mh b">Child</code>组件的<code class="fe me mf mg mh b">parentFunc</code>。</p><p id="1394" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们单击<code class="fe me mf mg mh b">Child</code>组件中的按钮时，我们通过调用<code class="fe me mf mg mh b">props.parentFunc</code>来调用它。</p><h1 id="979c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用React、ES6和Webpack导入和导出组件</h1><p id="eb2a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要导出React项目中的组件，我们应该将其导出为默认导出。</p><p id="16b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="7c6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">SomeNavBar.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6943" class="mq lc iq mh b gy mr ms l mt mu">import React from 'react';<br/>import Navbar from 'react-bootstrap/lib/Navbar';</span><span id="e934" class="mq lc iq mh b gy mv ms l mt mu">export default class SomeNavBar extends React.Component {<br/>  render(){<br/>    return (<br/>      &lt;Navbar className="navbar-dark" fluid&gt;<br/>        {//...}<br/>      &lt;/Navbar&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="7cc2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用任何我们想要的名字导入它。</p><p id="490c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5b0f" class="mq lc iq mh b gy mr ms l mt mu">import SomeNavBar from './SomeNavBar';</span></pre><p id="8105" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">导入导航栏组件。</p><p id="655a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不会在默认导出中使用花括号。</p><h1 id="67de" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在React组件上设置组件默认属性</h1><p id="12de" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要在React组件上设置默认属性，我们可以使用<code class="fe me mf mg mh b">prop-types</code>包。</p><p id="e793" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须通过运行以下命令来安装它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ca13" class="mq lc iq mh b gy mr ms l mt mu">npm i prop-types</span></pre><p id="40ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="34bc" class="mq lc iq mh b gy mr ms l mt mu">import PropTypes from 'prop-types';</span><span id="88d4" class="mq lc iq mh b gy mv ms l mt mu">class Address extends React.Component {<br/>  render() {<br/>    const { street, city } = this.props;<br/>    &lt;p&gt;{street}, {city}&lt;/p&gt;<br/>  }<br/>}</span><span id="322a" class="mq lc iq mh b gy mv ms l mt mu">Address.defaultProps = {<br/>  street: 'street',<br/>  city: 'city',<br/>};</span><span id="0e4b" class="mq lc iq mh b gy mv ms l mt mu">Address.propTypes = {<br/>  street: PropTypes.string.isRequired,<br/>  city: PropTypes.string.isRequired<br/>}</span></pre><p id="3c63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们设置<code class="fe me mf mg mh b">defaultProps</code>属性来设置默认的属性值。</p><p id="2b05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该对象将属性名作为键，将默认值作为值。</p><p id="e36e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">propTypes</code>有每个道具的道具类型。</p><p id="ed68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将它们都设置为string，并用<code class="fe me mf mg mh b">isRequired</code>使它们成为必需的。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/3ce0814ec6aba268053fe771931d04d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bTI0PBKPv173Qbfn"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@hg_photo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Herbert Goetsch</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5931" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="fc45" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以设置默认道具，并用<code class="fe me mf mg mh b">prop-types</code>包验证它们的格式。</p><p id="bd35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用类组件生命周期方法或功能组件的<code class="fe me mf mg mh b">useEffect</code>钩子来监听状态变化。</p><p id="bf9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用React Router获取和设置查询字符串和URL参数。</p><p id="d577" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将功能作为道具从父母传递给孩子。</p><h1 id="0b87" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单英语的JavaScript</h1><p id="b8d2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>