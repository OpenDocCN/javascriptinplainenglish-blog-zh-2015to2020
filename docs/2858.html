<html>
<head>
<title>How to build a reusable Vue Modal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建一个可重用的Vue模型</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-a-reusable-vue-js-modal-5f65017e190b?source=collection_archive---------0-----------------------#2020-07-30">https://javascript.plainenglish.io/how-to-build-a-reusable-vue-js-modal-5f65017e190b?source=collection_archive---------0-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3442" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何构建一个可重用的Vue模型，但具有一些高级功能</h2></div><h2 id="71b2" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">介绍</h2><p id="4873" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">以前，我写过一篇关于如何构建可重用Vue模型的文章，那是一年前的事了。我很感激很多人读了它，虽然它有点太初级了。今天，我想教大家如何建立一个可重用的Vue模型，但有一些先进的功能。</p><p id="8a62" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">我们要构建的是一个具有多种支持的可重用模态组件。</p><ul class=""><li id="bf0f" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt me mf mg mh bi translated">基于组件的</li><li id="343c" class="lz ma iq ld b le mi lh mj ko mk ks ml kw mm lt me mf mg mh bi translated">在根DOM中呈现</li><li id="3926" class="lz ma iq ld b le mi lh mj ko mk ks ml kw mm lt me mf mg mh bi translated">使用slot来呈现内容</li><li id="a3a9" class="lz ma iq ld b le mi lh mj ko mk ks ml kw mm lt me mf mg mh bi translated">添加可滚动内容的选项</li><li id="6009" class="lz ma iq ld b le mi lh mj ko mk ks ml kw mm lt me mf mg mh bi translated">按escape键退出模式</li><li id="9b52" class="lz ma iq ld b le mi lh mj ko mk ks ml kw mm lt me mf mg mh bi translated">动画过渡</li></ul><p id="b530" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">让我们深入研究如何构建它。</p><h1 id="2d97" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">构建一个HTML/CSS模板</h1><p id="fd3a" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">首先，让我们为我们的模态组件创建一个新文件，并将其命名为<code class="fe my mz na nb b">BaseModal.vue</code></p><p id="cf67" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">因为，我已经准备了一些在HTML和CSS中使用的模板，让我们把它添加到我们的模态组件中，并在我们的页面中呈现它。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi nj"><img src="../Images/f1ced4a17d8e9b6018f1f0affc1f95c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5A57UhTOWgkrX6ge.png"/></div></div></figure><h1 id="4a2a" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">创建一个按钮来触发模式</h1><p id="4291" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">酷毙了。让我们添加一个方法来控制模态的可见性。我将用方法<code class="fe my mz na nb b">openModal</code>添加一个新的按钮，并添加一个新的状态调用<code class="fe my mz na nb b">this.isShowModal</code>。每当用户点击按钮时，就会反转<code class="fe my mz na nb b">isModalOpen</code>值。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7182371bb9a822208c0cd4a38fdcea4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/0*6sAGlFwEWq7TTEza.png"/></div></figure><p id="ab73" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">酷毙了。所以我们来添加一个关闭模态的方法。我们希望当用户按下x标记或取消按钮时，它将关闭模态。</p><p id="281b" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">在模态组件中，添加一个名为<code class="fe my mz na nb b">handleClose</code>的新方法，它将触发监听<code class="fe my mz na nb b">close</code>监听器的父组件。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="e4b8" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">在容器组件中，我们将添加监听器调用<code class="fe my mz na nb b">close</code>，它将触发我们刚才构建的<code class="fe my mz na nb b">toggleModal</code>方法。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/7d84fac1906e7f670a4c686edb603fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*oGUqRLJXDTowx26q.gif"/></div></figure><h1 id="71b5" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">使用Vue门户</h1><p id="a697" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">看起来一切都很顺利。为了更加灵活，让我们在容器DOM之外呈现这个模态。既然我们在处理绝对位置，就给它渲染减少摩擦。</p><p id="7e73" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">我们将使用一个名为vue Portal—<a class="ae ns" href="https://github.com/LinusBorg/portal-vue" rel="noopener ugc nofollow" target="_blank">GitHub—Linus Borg/Portal-Vue的库:一个功能丰富的Vue门户插件，用于在组件之外、我们的应用程序或整个文档的任何地方呈现DOM。</a></p><p id="2634" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">让我们安装<code class="fe my mz na nb b">vue-portal</code></p><p id="5298" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated"><code class="fe my mz na nb b">npm i portal-vue yarn add portal-vue</code></p><p id="3e93" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">在您的<code class="fe my mz na nb b">main.js</code>中添加依赖项</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8160" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">将门户添加到您希望呈现模式的位置。在这种情况下，我将在根Vue组件中呈现它— <code class="fe my mz na nb b">App.vue</code></p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="718a" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">要使用它，用<code class="fe my mz na nb b">&lt;portal-target&gt;&lt;/portal-target&gt;</code>包装我们的模态组件</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5b1e" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">现在，我们的模型已经呈现在门户中。是不是太酷了😎</p><h1 id="ec6c" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">添加属性支持</h1><p id="ce4a" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">让我们将道具支持添加到我们的模型中。作为一名开发人员，我希望这个模态组件能够改变模态标题和其中的内容。</p><p id="3ea5" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">让我们在模态组件中添加props参数。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="2ac9" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">若要使用它，请传递</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="618e" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">狭槽</h1><p id="14f8" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">现在，我们想显示模态体内部的内容——我们想通过使用槽来实现。有两个槽；我们要用它。</p><ol class=""><li id="08fd" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt nt mf mg mh bi translated">模态体</li><li id="f109" class="lz ma iq ld b le mi lh mj ko mk ks ml kw mm lt nt mf mg mh bi translated">模态页脚</li></ol><p id="3b58" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">我们希望modal能够预览主体中的任何内容，并为submit按钮添加一个功能。我们将使用<code class="fe my mz na nb b">&lt;slot&gt;&lt;/slot&gt;</code>作为模态主体，使用<code class="fe my mz na nb b">&lt;slot name="footer"&gt;&lt;/slot&gt;</code>作为模态页脚。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="d770" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">要使用它，我们只需像这样传递<code class="fe my mz na nb b">&lt;base-modal&gt;</code>组件中的内容。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi nu"><img src="../Images/3cc245aca2ff77f2a2357fce536d026c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o6uxNpsLfBpO_C8g.png"/></div></div></figure><h1 id="a80a" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">可滚动</h1><p id="51cf" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">现在，我们有了一个函数模态组件。假设我们的内容页面很长。所以，我们想增加一些功能来增加可滚动的选项。</p><p id="6364" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">在模态组件中，我们添加一个数据类型为<code class="fe my mz na nb b">Boolean</code>的新道具调用<code class="fe my mz na nb b">scrollable</code>，并将其设置为默认值<code class="fe my mz na nb b">false</code>。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a691" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">让我们为可滚动内容添加一个新的样式。我将添加这个名为<code class="fe my mz na nb b">.scrollable</code>的类</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="93ed" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">为了使用它，我们将检查可滚动的属性。如果<code class="fe my mz na nb b">scrollable</code>为真，那么我们将把这个类添加到我们的内容中。我们将使用类绑定来实现它。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/06cc3d6deae9464997e4c08ebadab900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*_6PGQ-etChKUURz7.gif"/></div></figure><p id="f184" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">酷毙了。现在，我们也可以在带有可滚动道具的槽中添加一个长内容。它工作正常👏🏻。</p><h1 id="2ff2" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">键盘绑定</h1><p id="a7f3" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">让我们添加另一个强大的功能。如果我们按下<code class="fe my mz na nb b">escape</code>键，我们将关闭该模式。</p><p id="4b22" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">首先，我们需要按下键盘听一个事件。所以，在模态组件中，让我们将它添加到<code class="fe my mz na nb b">created</code>和<code class="fe my mz na nb b">destroyed</code>生命周期中。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="69f7" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">当我们不使用侦听器时，不要忘记删除它。这里发生的事情是，每当<code class="fe my mz na nb b">keyup</code>被触发时，它将被调用一个名为<code class="fe my mz na nb b">onClose</code>的方法。我们来补充一下这个方法。</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5325" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">我们可以通过使用<code class="fe my mz na nb b">event</code>参数来读取事件。由于<code class="fe my mz na nb b">escape key</code>按钮是27，我们将对其进行过滤。如果keycode是27，那么它将触发<code class="fe my mz na nb b">handleClose</code>方法，关闭我们的模态。</p><figure class="nc nd ne nf gt ng gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f9a52427c3f19630c083e3c345e4b943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*lYb0FhIuKhUIPrBx.gif"/></div></figure><h1 id="9762" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">过渡</h1><p id="79bb" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">让我们在打开和关闭模态时添加一个漂亮的过渡。幸运的是，Vue已经有了一个过渡元素，我们将使用它。只需用<code class="fe my mz na nb b">&lt;transition name=“fade”&gt;&lt;/transition&gt;</code>包裹模态组件</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7054" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">将<code class="fe my mz na nb b">fade</code> CSS也添加到组件中</p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="98f6" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">因此，在打开和关闭期间，您将有一个很好的过渡。</p><h1 id="3b2c" class="mn kg iq bd kh mo mp mq kk mr ms mt kn jw mu jx kr jz mv ka kv kc mw kd kz mx bi translated">源代码</h1><p id="3603" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated"><em class="nv"> BaseModal.vue </em></p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5fe9" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated"><em class="nv"> App.vue </em></p><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="nc nd ne nf gt ng"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1b8e" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">如果您对这个模型中添加的特性感兴趣，或者对下一篇文章有什么想法，请告诉我。请随时联系<a class="ae ns" href="https://twitter.com/jakzaizzat" rel="noopener ugc nofollow" target="_blank"> @jakzaizzat </a></p><p id="a663" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">完整源代码可在此获得—<a class="ae ns" href="https://github.com/jakzaizzat/blog-snippet" rel="noopener ugc nofollow" target="_blank">https://github.com/jakzaizzat/blog-snippet</a></p><p id="f5ef" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">原文发表于—<a class="ae ns" href="https://jakzaizzat.com/vue-modal" rel="noopener ugc nofollow" target="_blank">https://jakzaizzat.com/vue-modal</a></p></div></div>    
</body>
</html>