<html>
<head>
<title>Using the URLSearchParams Object in JavaScript — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaScript中使用URLSearchParams对象—第1部分</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-the-urlsearchparams-object-in-javascript-part-1-db2c066d52e6?source=collection_archive---------4-----------------------#2020-01-06">https://javascript.plainenglish.io/using-the-urlsearchparams-object-in-javascript-part-1-db2c066d52e6?source=collection_archive---------4-----------------------#2020-01-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/421ac34d08a47a9758aef763719debb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KXn5ze_xaAVtUU6M"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@christianw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christian Wiediger</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8790" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们不得不从头开始编写代码来解析和修改查询字符串，那么处理查询字符串可能会很痛苦。幸运的是，大多数最新的浏览器都有<code class="fe lb lc ld le b">URLSearchParams </code>对象，可以让我们轻松处理查询字符串。有了它，解析和操作查询字符串就变得容易了。我们不再需要第三方库或从头开始编写代码来处理查询字符串。在本指南的第1部分，我们将看看如何创建<code class="fe lb lc ld le b">URLSearchParams</code>对象，并看看一些方便的方法，让我们获得和设置查询字符串的键值对。</p><h1 id="3a0e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">创建URLSearchParam对象</h1><p id="1da9" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们可以用<code class="fe lb lc ld le b">URLSearchParams</code>构造函数创建一个URLSearchParams对象。<code class="fe lb lc ld le b">URLSearchParams</code>构造函数接受一个可选参数，这是一个包含查询字符串的<code class="fe lb lc ld le b">USVString </code>参数。<code class="fe lb lc ld le b">USVString</code>对象对应于Unicode标量值的所有可能序列的集合。在我们的代码中，我们可以像对待常规字符串一样对待它们。它可以是一系列的<code class="fe lb lc ld le b">USVString</code>或包含<code class="fe lb lc ld le b">USVString</code>的记录。在我们的代码中，我们不必关心<code class="fe lb lc ld le b">USVString</code> s。实际上，它们被视为字符串。我们可以像下面的代码一样构造一个<code class="fe lb lc ld le b">URLSearchParams</code>对象:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="5499" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>console.log(params.get('key1'));<br/>console.log(params.get('key2'));</span></pre><p id="82a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用上面的代码，我们创建了一个<code class="fe lb lc ld le b">URL </code>对象，然后我们用<code class="fe lb lc ld le b">URL </code>对象的<code class="fe lb lc ld le b">search</code>属性获取查询字符串，然后我们将它传递给<code class="fe lb lc ld le b">URLSearchParams</code>构造函数。然后我们可以使用<code class="fe lb lc ld le b">URLSearchParams</code>对象，通过使用<code class="fe lb lc ld le b">URLSearchParams </code>对象的<code class="fe lb lc ld le b">get</code>方法来获取键值。上面的<code class="fe lb lc ld le b">console.log</code>语句应该分别得到值1和2。</p><p id="b034" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以使用一个数组构造一个<code class="fe lb lc ld le b">URLSearchParams</code>对象，该数组的条目是以键作为第一个元素，以值作为第二个元素的数组。例如，我们可以用如下代码中的数组构造一个<code class="fe lb lc ld le b">URLSearchParams</code>对象:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="b31c" class="mq lg iq le b gy mr ms l mt mu">const params = new URLSearchParams([<br/>  ["key1", 1],<br/>  ["key2", 2]<br/>]);<br/>console.log(params.get('key1'));<br/>console.log(params.get('key2'));<br/>console.log(params.toString());</span></pre><p id="927c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用上面的代码，我们传入一个数组，数组中的键和值都在条目中。使用<code class="fe lb lc ld le b">toString()</code>实例方法，我们可以很容易地获得完整的查询字符串。上面的<code class="fe lb lc ld le b">console.log</code>语句应该通过前两个语句分别得到值1和2，最后一个语句应该得到值<code class="fe lb lc ld le b">key1=1&amp;key2=2</code>。使用该对象创建查询字符串从未如此简单。</p><p id="096b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">构造<code class="fe lb lc ld le b">URLSearchParams </code>对象的第三种方法是将普通的JavaScript对象传递给构造函数。键在对象的键中，值在对象的值中。例如，我们可以像下面的代码一样构造一个<code class="fe lb lc ld le b">URLSearchParams</code>对象:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="6d13" class="mq lg iq le b gy mr ms l mt mu">const params = new URLSearchParams({key1: 1, key2: 2});<br/>console.log(params.get('key1'));<br/>console.log(params.get('key2'));<br/>console.log(params.toString());</span></pre><p id="8725" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的<code class="fe lb lc ld le b">console.log</code>语句应该通过前两个语句分别得到值1和2，最后一个语句应该得到值<code class="fe lb lc ld le b">key1=1&amp;key2=2</code>。使用该对象创建查询字符串从未如此简单。</p><p id="4e35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以将映射传入构造函数，并获得一个查询字符串。对于地图，我们可以像下面的代码一样传递它:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="aa3a" class="mq lg iq le b gy mr ms l mt mu">const params = new URLSearchParams(new Map([['key1', 1], ['key2', 2]]));<br/>console.log(params.get('key1'));<br/>console.log(params.get('key2'));<br/>console.log(params.toString());</span></pre><p id="bad3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用上面的<code class="fe lb lc ld le b">console.log</code>语句，我们应该得到与前面的例子相同的输出。</p><p id="bd91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在构造了一个<code class="fe lb lc ld le b">URLSearchParams</code>对象后，我们可以遍历它，因为它是一个类似数组的对象。类似数组的对象是包含迭代器方法的对象。该方法用<code class="fe lb lc ld le b">Symbol.iterator</code>符号标识。我们可以用<code class="fe lb lc ld le b">for...of</code>循环遍历像objects这样的数组条目。例如，如果我们有下面的<code class="fe lb lc ld le b">URLSearchParams</code>对象:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="dd54" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>for (const [key, value] of params) {<br/>  console.log(key, value);<br/>}</span></pre><p id="c5a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到以下<code class="fe lb lc ld le b">console.log</code>输出:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="ad11" class="mq lg iq le b gy mr ms l mt mu">key1 1<br/>key2 2</span></pre><p id="a9c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所看到的，我们用<code class="fe lb lc ld le b">for...of</code>循环获得了所有的查询字符串键和值。这是使用<code class="fe lb lc ld le b">URLSearchParams </code>对象解析查询字符串的另一个原因。它是一个iterable对象，让我们可以很容易地获得键和值。如果我们有一个很长的查询字符串键值对列表，这个特性就更有用了。或者，我们可以使用<code class="fe lb lc ld le b">entries</code>方法，这是一个<code class="fe lb lc ld le b">URLSearchParams</code>对象的实例方法。获取查询字符串的键值对，就像我们在下面的代码中所做的那样:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="6e0c" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>for (const [key, value] of params.entries()) {<br/>  console.log(key, value);<br/>}</span></pre><p id="e7e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该得到与第一个例子相同的输出，我们直接用<code class="fe lb lc ld le b">for...of</code>循环遍历<code class="fe lb lc ld le b">params</code>对象。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/209ca516b74658e781a67aa24209c898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wefpeohND6h_MTWH"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="a06f" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">方法</h1><p id="aeee" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">每个<code class="fe lb lc ld le b">URLSearchParams</code>实例都有多种方法来获取键和值，并通过添加、更改和删除键或值来操作它们。使用这些方法，我们可以轻松地构造查询字符串，而不必直接进行字符串操作。如果我们想在操作后得到完整的查询字符串，我们可以用<code class="fe lb lc ld le b">toString()</code>方法得到它。</p><h2 id="424f" class="mq lg iq bd lh mw mx dn ll my mz dp lp ko na nb lt ks nc nd lx kw ne nf mb ng bi translated">附加</h2><p id="2e09" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">append</code>方法让我们向<code class="fe lb lc ld le b">URLSearchParams</code>对象添加一个键值对作为新的搜索参数。该方法有两个参数。一个用于键名，一个用于值。当我们传入两个参数时，它们都将被转换成字符串。我们可以多次追加相同的键，可以有也可以没有相同的对应值。例如，我们可以在下面的代码中使用<code class="fe lb lc ld le b">append</code>方法:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="d0a2" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>params.append('key1', 1);<br/>params.append('key1', 2);<br/>console.log(params.toString());</span></pre><p id="ce84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用上面的代码，我们应该从上面代码中的<code class="fe lb lc ld le b">console.log</code>语句中返回<code class="fe lb lc ld le b">key1=1&amp;key2=2&amp;key1=1&amp;key1=2</code>。正如我们所看到的，我们可以任意多次追加相同的键-值对，并且<code class="fe lb lc ld le b">append</code>方法不会试图将它们合并在一起。</p><p id="170b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">删除</p><p id="2412" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">URLSearchParams</code>对象的<code class="fe lb lc ld le b">delete</code>方法将让我们删除带有给定键的键-值对。如果有多个相同的密钥，那么它们都会被删除。If接受一个参数，即字符串形式的键名。例如，我们可以编写以下代码:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="df0a" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>params.append('key1', 1);<br/>params.append('key1', 2);<br/>params.delete('key1');<br/>console.log(params.toString());</span></pre><p id="5793" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们像上面的最后一段代码那样运行上面的<code class="fe lb lc ld le b">console.log</code>，我们将返回<code class="fe lb lc ld le b">key2=2</code>。这意味着键名为<code class="fe lb lc ld le b">key1</code>的所有键值对都从<code class="fe lb lc ld le b">URLSearchParams</code>对象和相应的查询字符串中删除了。</p><h2 id="e68a" class="mq lg iq bd lh mw mx dn ll my mz dp lp ko na nb lt ks nc nd lx kw ne nf mb ng bi translated">进入</h2><p id="06b6" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">entries</code>方法从<code class="fe lb lc ld le b">URLSearchParams</code>对象获取键值对。它不带参数，返回一个迭代器，让我们遍历键值对。键-值对将采用数组的形式，键作为第一个元素，对应的值作为第二个元素。例如，我们可以在下面的代码中使用<code class="fe lb lc ld le b">entries</code>方法:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="fb38" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>for (const [key, value] of params.entries()) {<br/>  console.log(key, value);<br/>}</span></pre><p id="8c2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们使用了析构赋值语法将键值数组分解成它们自己的变量。这是一种访问键和值的好方法，因为我们不必使用索引或者用自己的代码将它们赋给变量。</p><h2 id="d4e6" class="mq lg iq bd lh mw mx dn ll my mz dp lp ko na nb lt ks nc nd lx kw ne nf mb ng bi translated">为每一个</h2><p id="42c7" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">forEach</code>方法让我们直接迭代这些值，而不使用<code class="fe lb lc ld le b">entries</code>方法。它采用一个回调函数，其中can可以访问每个<code class="fe lb lc ld le b">URLSearchParams</code>条目的键和值。回调函数将值作为第一个参数，将键作为第二个参数。例如，如果我们有以下代码:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="acc0" class="mq lg iq le b gy mr ms l mt mu">const url = new URL('<a class="ae kc" href="https://example.com?key1=1&amp;key2=2'" rel="noopener ugc nofollow" target="_blank">https://example.com?key1=1&amp;key2=2'</a>);<br/>const params = new URLSearchParams(url.search);<br/>params.append('key3', 3);<br/>params.append('key4', 4);<br/>params.append('key5', 5);<br/>params.forEach((value, key) =&gt; {<br/>  console.log(key, value);<br/>})</span></pre><p id="28e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们运行上面的代码时，我们应该从<code class="fe lb lc ld le b">console.log</code>语句中获得以下输出:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="59c6" class="mq lg iq le b gy mr ms l mt mu">key1 1<br/>key2 2<br/>key3 3<br/>key4 4<br/>key5 5</span></pre><p id="9d27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">重要的是要注意value参数在key之前，所以我们不像在大多数其他地方那样颠倒它们。</p><p id="8d88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">URLSearchParams </code>对象中有更多的方法，我们将继续方法列表，并在本指南的第2部分中查看使用<code class="fe lb lc ld le b">URLSearchParams</code>对象的注意事项。</p><p id="ab28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数最新的浏览器都有<code class="fe lb lc ld le b">URLSearchParams </code>对象，可以让我们轻松处理查询字符串。现在，处理查询字符串不再是一件痛苦的事情，因为我们不必从头开始编写代码来解析和修改它。有了<code class="fe lb lc ld le b">URLSearchParams</code>对象，解析和操作查询字符串就变得容易了。我们不再需要第三方库或从头开始编写代码来处理查询字符串。在<code class="fe lb lc ld le b">URLSearchParams </code>对象中有更多的方法和一些使用时的注意事项，所以请继续关注第2部分。</p></div></div>    
</body>
</html>