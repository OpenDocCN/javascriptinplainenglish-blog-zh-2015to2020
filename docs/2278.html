<html>
<head>
<title>React Native Localize: How to build multi-lang App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native Localize:如何构建多语言应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-native-localize-how-to-build-multi-lang-app-b8604884baca?source=collection_archive---------1-----------------------#2020-06-07">https://javascript.plainenglish.io/react-native-localize-how-to-build-multi-lang-app-b8604884baca?source=collection_archive---------1-----------------------#2020-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8a79" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">本地化意味着调整应用程序的翻译，以适应客户的特定国家或地区。支持多种语言(包括RTL语)对于任何成功的移动应用程序来说都是一个关键的特性，因为它向更大的人群开放了用户基础，并且极大地改善了用户体验。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/68473f6fe2dbb5f65f47eae8af17fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfCK0w9rCe4ZpFRslpUWcQ.png"/></div></div></figure><p id="2d28" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">React Native中的本地化可能有点棘手，这就是我们写这篇教程的原因。让我们看看如何优雅地本地化React本地应用程序。</p><h2 id="d6e2" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">装置</h2><p id="6bd2" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">expo-localization是一个expo库，用于获取用户的语言环境信息，并对你的应用进行本地化。它提供了有关用户的地区、时区、区域和货币代码的信息，所有这些信息都可以帮助您定制应用程序的用户体验。让我们通过运行以下命令来安装这个包:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="c5fa" class="ln lo iq mm b gy mq mr l ms mt">expo install expo-localization</span></pre><p id="63e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> i18n-js </strong>携手<em class="mu"> expo-localization </em>实现React原生移动&amp; web应用的本地化。</p><blockquote class="mv mw mx"><p id="2c8f" class="kr ks mu kt b ku kv jr kw kx ky ju kz my lb lc ld mz lf lg lh na lj lk ll lm ij bi translated">这是一个小库，提供JavaScript上的Rails I18n翻译。</p></blockquote><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="9c7a" class="ln lo iq mm b gy mq mr l ms mt">yarn add i18n-js</span></pre><p id="69f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">lodash.memoize 是另一个我们需要用来缓存翻译的库。让我们也安装它:</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="6c25" class="ln lo iq mm b gy mq mr l ms mt">yarn add lodash.memoize</span></pre><h2 id="cced" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">创建翻译配置文件</h2><p id="7077" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">假设我们想在React本地应用程序中支持3种语言:法语、英语和西班牙语。让我们为它们添加一个配置json文件，如下所示:</p><p id="faff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> fr.json </strong></p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="a175" class="ln lo iq mm b gy mq mr l ms mt">//fr.json<br/>{<br/>    "welcome": "Bienvenue dans le didacticiel de traduction"<br/>}</span></pre><p id="6671" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> en.json </strong></p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="d3db" class="ln lo iq mm b gy mq mr l ms mt">//en.json<br/>{<br/>    "welcome": "Welcome to translation tutorial",<br/>}</span></pre><p id="bf73" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> es.json </strong></p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="5bbb" class="ln lo iq mm b gy mq mr l ms mt">//es.json<br/>{<br/>    "welcome": "Bienvenida al tutorial de traducción",<br/>}</span></pre><h2 id="f421" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">反应本地本地化——代码魔术</h2><p id="977e" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">现在，我们已经准备好了配置文件，并且安装了所需的依赖项，让我们来实际实现React本地应用程序的本地化。</p><p id="59e2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们创建一个名为<strong class="kt ir"><em class="mu">im localized . js</em></strong>的文件，并添加以下代码片段。你可能已经猜到了，在<a class="ae nb" href="https://www.instamobile.io/" rel="noopener ugc nofollow" target="_blank"> Instamobile </a>，我们正在使用完全相同的机制来本地化我们的React原生应用，这就是我们得到这段代码的地方。请随意将IMLocalized重命名为您自己的原始名称，但在本教程中我们将使用它(IM前缀代表<em class="mu"> Instamobile </em>)。</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="7875" class="ln lo iq mm b gy mq mr l ms mt">import memoize from 'lodash.memoize'; // Use for caching/memoize for better performance<br/>import i18n from 'i18n-js';<br/>import * as Localization from 'expo-localization';<br/>import { I18nManager } from 'react-native';<br/><br/>export const translationGetters = {<br/>  'es-US': () =&gt; require('./es.json'),<br/>  'en-US': () =&gt; require('./en.json'),<br/>  'fr-FR': () =&gt; require('./fr.json'),<br/>};<br/><br/>export const IMLocalized = memoize(<br/>  (key, config) =&gt;<br/>    i18n.t(key, config).includes('missing') ? key : i18n.t(key, config),<br/>  (key, config) =&gt; (config ? key + JSON.stringify(config) : key),<br/>);<br/><br/>export const init = () =&gt; {<br/>    <br/>  let localeLanguageTag = Localization.locale;<br/>  let isRTL = Localization.isRTL;<br/><br/>  IMLocalized.cache.clear();<br/>  // update layout direction<br/>  I18nManager.forceRTL(isRTL);<br/>  // set i18n-js config<br/>  i18n.translations = {<br/>    [localeLanguageTag]: translationGetters[localeLanguageTag](),<br/>  };<br/>  i18n.locale = localeLanguageTag;<br/>};</span></pre><p id="a03a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">功能细分:</p><ul class=""><li id="88d5" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated"><strong class="kt ir"> init() </strong>计算出用户的地区并配置i18n</li><li id="878a" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><strong class="kt ir"> IMLocalized() </strong>接受存储在我们的配置文件中的字符串值的键，并获取它们的值，而<em class="mu"> lodash.memoize </em>帮助缓存获取的值(巨大的性能优势)</li><li id="519a" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><strong class="kt ir"> translationGetters() </strong>根据用户的语言环境获取正确的配置文件</li></ul><h2 id="d751" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">创建您的视图</h2><p id="fe89" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">为了测试我们的应用程序，让我们构建一个简单的自定义UI，以展示强大的本地化组件。</p><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="0067" class="ln lo iq mm b gy mq mr l ms mt">import React from 'react';<br/>import {IMLocalized, init} from './IMLocalized';<br/>import { View, StyleSheet, Text } from 'react-native';<br/><br/>export function WelcomeScreen(params) {<br/>    init();<br/>    return(<br/>        &lt;View style={styles.container} &gt;<br/>            &lt;Text style={styles.welcomeText} &gt;<br/>                {IMLocalized('welcome')}<br/>            &lt;/Text&gt;<br/>        &lt;/View&gt;<br/>    )<br/>}<br/><br/>const styles = StyleSheet.create({<br/>    container: {<br/>        flex: 1,<br/>        justifyContent: "center",<br/>        alignItems: "center"<br/>    },<br/>    welcomeText: {<br/>        fontSize: 16,<br/>    }<br/>})</span></pre><p id="0077" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注意使用<strong class="kt ir"> IMLocalized </strong>。我们没有向文本组件提供简单的“欢迎”字符串，而是用一个<strong class="kt ir"> IMLocalized </strong>调用来包装它。这是我们如何实现支持多种语言(包括RTL语)的反应式本地本地化的关键部分。该应用程序会神奇地以正确的语言显示“欢迎”字符串(根据用户的设备设置)，而不是显示硬编码的英语字符串。</p><p id="729f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">运行您的应用程序应该如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/8fb4a8abd65319b55043fa7a137362ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/0*guOoknxgZb6juvU7.png"/></div></figure><p id="08e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">英语</strong></p><p id="9064" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将设备设置更改为西班牙语，然后重新打开应用程序。请注意该字符串现在在西班牙语中的形式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/fac3628875d66ecd5d0916587fa2c41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/0*cMWfZN3EhpkShphn.png"/></div></figure><p id="4dd3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">西班牙语</strong></p><p id="ee36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">再次将设备设置更改为法语:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/3d76bee52628fec1acbacc220587a5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/0*eSYNBVzJin7VvpAt.png"/></div></figure><p id="5aa4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">法语</strong></p><h2 id="c08b" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">结论</h2><p id="c692" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">本地化您的应用程序对于接触到来自世界各地的更广泛的客户非常重要。正如我们在上面看到的，本地化您的应用程序并不是一个可怕的过程。</p><p id="b295" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过使用我们的<strong class="kt ir"> <em class="mu"> IMLocalized </em> </strong>方法，您可以简单地翻译我们应用程序中的所有字符串，将它们包装在一个<strong class="kt ir"> <em class="mu"> IMLocalized </em> </strong>调用中。您可以在所有其他移动编程语言中遵循类似的模式，如<a class="ae nb" href="https://www.iosapptemplates.com/" rel="noopener ugc nofollow" target="_blank"> Swift </a>、<a class="ae nb" href="https://www.instaflutter.com/" rel="noopener ugc nofollow" target="_blank">flute</a>或<a class="ae nb" href="https://www.instakotlin.com/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>。</p><p id="e4f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦你建立了基础设施，增加对多种语言(包括RTL)的支持就非常简单了。简单地将硬编码的字符串包装到一个翻译方法中就足够了。</p><h2 id="6582" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated"><strong class="ak"> JavaScript简单明了</strong></h2><p id="7784" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae nb" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">订阅我们的YouTube频道</strong> </a> <strong class="kt ir">获取更多类似的内容吧！</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div></div>    
</body>
</html>