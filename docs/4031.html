<html>
<head>
<title>Base 64 Images with Node and JIMP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带节点和JIMP的Base 64图像</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/base-64-images-with-node-and-jimp-a590a144d827?source=collection_archive---------13-----------------------#2020-11-11">https://javascript.plainenglish.io/base-64-images-with-node-and-jimp-a590a144d827?source=collection_archive---------13-----------------------#2020-11-11</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="5db3" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">创建可以嵌入到HTML或CSS中的图像的字符串表示</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj kg"><img src="../Images/c34c1efa8725292449430defa144c992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*PMpf3cGkkYbMLoc8lS9qXw.jpeg"/></div><figcaption class="ko kp gk gi gj kq kr bd b be z dk">Image: <a class="ae ks" href="https://pixabay.com/illustrations/finger-touch-hand-structure-769300/" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="5a6a" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">JIMP是JavaScript图像处理程序，它实际上是一个NPM包，它的众多特性之一是能够从图像文件创建Base 64字符串。这有多种用途(有些是邪恶的……)，在这篇文章中，我将演示如何在HTML文档中嵌入一个Base 64编码的图形作为<code class="fe lp lq lr ls b">img src</code>。这对于像徽标或按钮图形这样的小图像很有用，可以减少HTTP请求的数量，虽然我使用的是HTML，但是Base 64字符串也可以用在CSS中。</p><p id="0df5" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">您可能知道，十进制使用数字0-9，十六进制使用数字0-9和字母A-f。64进制当然需要64个不同的字符，使用26个大写字母、26个小写字母、数字0-9和正斜杠字符，以及等号填充。(还有其他一些不太常见的标准。)因此，将文件、流或缓冲区转换为Base 64的任何代码将提供仅包含ASCII字符的字符串，该字符串可以使用任何协议安全地传输。</p><p id="9721" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">对于这个项目，我将编写一对简单的函数来打开一个图像文件，获取它的Base 64编码，然后将其插入到一个HTML文档中。你可以从<a class="ae ks" href="https://github.com/CodeDrome/base64-images-jimp" rel="noopener ugc nofollow" target="_blank"> Github库</a>中抓取源代码。</p><p id="3b16" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">https://www.npmjs.com/package/jimp,的JIMP的完整文档是<a class="ae ks" href="https://www.npmjs.com/package/jimp" rel="noopener ugc nofollow" target="_blank">你可以安装它:</a></p><p id="31e1" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated"><code class="fe lp lq lr ls b">npm install --save jimp</code></p><p id="cbca" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">这是生成base 64图像并将其嵌入HTML文件的源代码。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="lt lu l"/></div></figure><p id="4c37" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">在<code class="fe lp lq lr ls b">openLogo</code>函数中，我们读取一个图像文件(包含在源代码中)，然后调用MIME类型为<code class="fe lp lq lr ls b">Jimp.AUTO</code>的<code class="fe lp lq lr ls b">getBase64Async</code>来保存原始图像的文件类型。然后将得到的Base 64字符串传递给<code class="fe lp lq lr ls b">base64ToPage</code>。</p><p id="ba0c" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated"><code class="fe lp lq lr ls b">base64ToPage</code>函数打开一个现有的HTML文件，用Base 64字符串替换<code class="fe lp lq lr ls b">{{logo}}</code>,然后保存文件。这是诸如Mustache和Handlebars之类的模板引擎所执行的非常粗略的近似，并且只是一种将Base 64图像快速“n”到网页中的肮脏方式，而不是产品质量代码。</p><p id="1cab" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">在现实世界中，使用JIMP生成的base 64图像的最简单方法可能是将其写入文本文件，然后将其复制/粘贴到您的代码中。生成一个base 64图像是非常耗时的，即使对于非常小的图形也是如此，因此不能对每个HTTP请求都即时完成—严格来说，这是对每个图像的一次性处理。</p><p id="e28e" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">现在让我们运行代码。</p><p id="a864" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated"><code class="fe lp lq lr ls b">node base64image.js</code></p><p id="97c2" class="pw-post-body-paragraph kt ku ir kv b kw kx js ky kz la jv lb lc ld le lf lg lh li lj lk ll lm ln lo ik bi translated">如果你在浏览器中打开<strong class="kv is">base64image.htm</strong>，你会看到一个包含这个标志的页面。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj lv"><img src="../Images/f3755e6a3ae4e773ae90030f16bf6ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*JsYZXZd7uQHpDdhEWPoXFg.png"/></div></figure></div></div>    
</body>
</html>