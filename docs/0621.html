<html>
<head>
<title>Server-Side Image Rendering with Express Handlebars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有快速手柄的服务器端图像渲染</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/server-side-image-rendering-with-express-handlebars-cb224187b276?source=collection_archive---------2-----------------------#2019-11-18">https://javascript.plainenglish.io/server-side-image-rendering-with-express-handlebars-cb224187b276?source=collection_archive---------2-----------------------#2019-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cef6f9665af3e765017159cbbae476b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPmW20XFrm39s43MNGFrZw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by Cristina Gottardi on <a class="ae kc" href="https://unsplah.com" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5cfc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你不熟悉我最喜欢的服务器端渲染工具之一的手柄，你可能不习惯在服务器端渲染图像。</p><p id="2504" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将向您展示一种在进行服务器端渲染时快速处理图像的方法。</p><blockquote class="lb lc ld"><p id="c614" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">请注意，我使用的是快速把手，但该命令并不特定于把手。</p></blockquote><h2 id="4579" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">假设</h2><p id="04f5" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">我想让这篇文章简短。稍后我会写一篇关于服务器端渲染的更长的文章。所以我假设你已经在使用手柄或者刚刚开始使用，有一些使用node.js和VS代码的经验。我将主要关注下面代码的两个部分。但也将简要解释其他部分，以便您可以学到一些额外的东西。</p><blockquote class="lb lc ld"><p id="89c9" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">尽管这不是关于手柄或服务器端渲染的教程，但您可能会学到一些东西。</p></blockquote><p id="b80a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的重点将是显示一个索引和关于页面的图像。为什么只关注一个图像？因为我注意到图像的显示方式太复杂了。这个很简单。</p><h2 id="1991" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">我们将做什么</h2><ul class=""><li id="6c1e" class="mg mh iq kf b kg mb kk mc ko mi ks mj kw mk la ml mm mn mo bi translated">设置节点web服务器</li><li id="f1f9" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">安装<a class="ae kc" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank">快递</a></li><li id="f3e0" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">安装<a class="ae kc" href="https://www.npmjs.com/package/express-handlebars" rel="noopener ugc nofollow" target="_blank">快速把手</a></li><li id="0ca2" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">创建一个基本的车把文件夹结构</li><li id="f811" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">创建三个页面，index.handlebars、about.handlebars和main.handlebars</li></ul><h2 id="1eda" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">我们开始吧</h2><ol class=""><li id="f774" class="mg mh iq kf b kg mb kk mc ko mi ks mj kw mk la mu mm mn mo bi translated">创建名为displayimage的目录。</li><li id="13c6" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la mu mm mn mo bi translated">因为我们需要它们，所以在<strong class="kf ir"> displayimage </strong>下创建一个<strong class="kf ir"> images </strong>文件夹，在<strong class="kf ir"> views </strong>文件夹下创建一个<strong class="kf ir">布局</strong>。</li></ol><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/559f1e32cd465b7e6cf9c91254c680c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*TAB09fAKxX5bLE8J5qd3IA.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Folder Structure</figcaption></figure><p id="cab4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.启动VS代码并打开displayimage文件夹</p><p id="07c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.打开一个新的终端并键入，<strong class="kf ir"> <em class="le"> npm init </em> </strong> <br/>创建package.json .接受默认设置<em class="le">，除了将默认页面改为</em> <strong class="kf ir"> <em class="le"> app.js </em> </strong>，而不是index . js . js .这将使它与我的保持一致。</p><p id="491a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.在终端窗口中键入<strong class="kf ir"><em class="le">NPM install express</em></strong><br/>来安装轻量级web框架。</p><p id="fdf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.在终端窗口输入<strong class="kf ir"><em class="le">NPM install express-handlebars</em></strong><br/>安装Handlebars服务器端渲染视图引擎。</p><p id="1770" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">7.键入以下内容，在端口5005上设置web服务器。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/ab14eb085df23e0cd824e86a0bc79fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*iT8iWW9NSyxKXMRwV3MlOA.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Basic node web server</figcaption></figure><p id="a432" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">8.在终端中，按F5启动web服务器。您应该会得到上图中的信息。</p><p id="d585" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想要一个<strong class="kf ir">索引</strong>页面和一个<strong class="kf ir">关于</strong>页面。记住，这些是在服务器端渲染的。每个页面将显示相同的图像。但首先我们要确保它们能正常工作。</p><p id="0fd9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">9.将以下代码添加到app.js中的第10行之后。我想让你注意的就是这第13行。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/74b8fafbf677917f3c191d3cbd3fe0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*OWUjOtPZ24s93GAhNHS55A.jpeg"/></div></figure><p id="022a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过第13行，你告诉应用程序你的图片将被存储在哪里。您将不必在您的<img/>元素中为您的图像指定一个混乱的路径。</p><p id="1650" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="le">和所有东西一样，总会有更多，所以使用app.use()或express.static之类的东西来了解更多。</em></p><p id="a9aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将添加<strong class="kf ir">索引.车把</strong>(默认)和<strong class="kf ir">关于.车把</strong>。每个都将显示图像和一些文本。现在，让我们为这些添加<strong class="kf ir">路线</strong>。</p><p id="34d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">布局文件夹中的<strong class="kf ir"> main.handlebars </strong>像往常一样包含您想要在每页上显示的内容。通常这可能是类似于引导导航条的东西。</p><p id="475d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">app.js应该如下所示。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/ed590652dfc0391a50606560e712c74b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNdLCBoEpJBzcEFCEkTMXw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">app.js</figcaption></figure><p id="4a84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有到达索引('/')和about ('/about ')的路线。</p><h2 id="d0ae" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">创建我们的三个页面</h2><h2 id="2e5e" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">索引.把手</h2><p id="7c8c" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">在<strong class="kf ir">视图</strong>文件夹中，我添加了以下内容</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2b6408d4d5c5d5dfc2d21f9aa6349ee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*IBSLldXkTyrSmqECYRNT5w.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">index.handlebars</figcaption></figure><p id="d0fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您刚刚开始使用车把，请注意{{greeting}}，也请注意app.js中的内容。“问候”这个名字没什么特别的，可以是任何东西。app.js中的route将用我们发送给它的文本填充{{greeting}}占位符。</p><h2 id="09e3" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">大约.把手</h2><p id="936f" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">为简单起见，与index.handlebars的代码完全相同</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/22dbb3cdfdf91aa99c3645eb6daf9cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*G95jzanHd2gQPhBybXfOnA.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">about.handlebars</figcaption></figure><h2 id="cea8" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">主把手</h2><p id="2df4" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">在视图/布局文件夹中创建。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/6c100ec01901fc0021fbd9e68bd145e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDDvuLzVECbVNwv_IjNxPg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">main.handlebars</figcaption></figure><p id="25cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您是手柄的新手，{{{body}}}是一个占位符，表示“对于每个页面，在正文中放置发送到该页面的内容。”</p><p id="7230" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们看来，这是一种问候。</p><p id="1ad2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">确保您的web服务器正在运行，并在必要时刷新它。</p><p id="071b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在浏览器中运行您的应用程序，并通过转到<strong class="kf ir"> localhost:5005 </strong>获取索引和<strong class="kf ir"> localhost:5005/about </strong>获取about页面来测试到<strong class="kf ir"> index </strong>和<strong class="kf ir"> about </strong>的路由。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/debd72d141ff4acb6fa9b5c72d0f361c.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*dRoLK5N8H0KqS6dikcfLnQ.jpeg"/></div></figure><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/2d327723614ec4ac310b96c221caf813.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*C2dtm0j3uVUMwzwBJm6OzQ.jpeg"/></div></figure><h2 id="d60d" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">现在是图像</h2><p id="452d" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">有点失望，因为我没做什么特别的事。app.js的第13行处理了这个问题。我只是在我的主手柄中加入了一个<img/>元素，这样它就会出现在每一页上。</p><p id="a741" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我想把图片放在一个页面上，我们可以把<img/>放在那个页面上，而不是主手柄上。</p><blockquote class="lb lc ld"><p id="92bc" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">重要的是<img/>它知道在哪里可以找到我们的图片，因为app.js的第13行。</p></blockquote><p id="9415" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">修改index.handlebars，使第13行出现以下<img/></p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/0ef3df70f1dfa13d2a63d47dbcb30ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*brdEPBScRKkAYxXDRamIRw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">main.handlebars</figcaption></figure><p id="f89c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">刷新您的网络服务器和浏览器，图像应该显示当您访问索引和关于。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/bcf213d2c6926e84f5a9b252ac3dbe0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*CRB6IJGlcSxLnWY39nMjEg.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">index</figcaption></figure><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/e36aa2f280c172838fef1aa64d5598a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*g1og9dvJn2KZRpwjaJtyXg.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">about</figcaption></figure><h1 id="dda8" class="nk lj iq bd lk nl nm nn ln no np nq lq nr ns nt lt nu nv nw lw nx ny nz lz oa bi translated">结论</h1><p id="96eb" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">对于在服务器端呈现的网页中引用的图像，一种选择是使用<a class="ae kc" href="https://expressjs.com/en/starter/static-files.html" rel="noopener ugc nofollow" target="_blank"> express.static </a>。</p><p id="b032" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个过程中，我们看到了如何使用node和express来建立一个node web服务器，如何使用Handelbars来进行web页面的服务器端呈现，以及对服务器端路由的一瞥。</p><p id="4746" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我计划在以后的文章中花更多时间讨论最后两项。</p><p id="0dbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读和快乐编码！</p></div></div>    
</body>
</html>