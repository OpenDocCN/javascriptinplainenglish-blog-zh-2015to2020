<html>
<head>
<title>Creating a Splash Screen in Angular for Loading all the Data at Startup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Angular中创建一个闪屏，用于在启动时加载所有数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-a-splash-screen-in-angular-for-loading-all-the-data-at-startup-b0b91d9d9f93?source=collection_archive---------0-----------------------#2020-11-09">https://javascript.plainenglish.io/creating-a-splash-screen-in-angular-for-loading-all-the-data-at-startup-b0b91d9d9f93?source=collection_archive---------0-----------------------#2020-11-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/372c839d3f551f1afc7bc203cbff45e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Pj-LaKSCKCHd9dF"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@danny144?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Dan Nelson</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="891b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如今，用户对应用程序的UI和UX的要求和关注越来越高。这主要是由于市场上的竞争如此激烈，以至于用户确切地知道当今技术能走多远。</p><p id="8bfd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，重要的是不仅要为用户提供一个功能符合设计目的的应用程序，而且要吸引用户的眼球。</p><p id="57de" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，一个站点或应用程序提供的第一张名片是访问屏幕和加载必要数据的方式。</p><p id="9856" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们说的是<strong class="kc io"> <em class="ky">闪屏:</em> </strong>用任何应用程序的logo、使用应用程序前的有用信息，或者简单地用一个加载屏幕让用户明白应用程序正在加载他的数据并且没有被阻止，来转移用户注意力的简单方法。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><h2 id="e968" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">目标</strong></h2><p id="49c4" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">今天的目标是创建一个闪屏显示给用户，直到数据准备好并可用于我们的主页</p><h2 id="3a54" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">先决条件</strong></h2><p id="61af" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">在开始之前，了解一些事情是有用的:</p><ul class=""><li id="fea8" class="me mf in kc b kd ke kh ki kl mg kp mh kt mi kx mj mk ml mm bi translated">对于开发来说，最好了解一下<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" rel="noopener ugc nofollow" target="_blank"> Javascript </a>(推荐使用<a class="ae jz" href="https://www.typescriptlang.org/docs/" rel="noopener ugc nofollow" target="_blank"> Typescript </a>但不是必需的)和Html</li><li id="5e03" class="me mf in kc b kd mn kh mo kl mp kp mq kt mr kx mj mk ml mm bi translated"><a class="ae jz" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>您机器上安装的v12 +;</li><li id="1580" class="me mf in kc b kd mn kh mo kl mp kp mq kt mr kx mj mk ml mm bi translated">Npm包管理器由于<a class="ae jz" href="https://angular.io/docs" rel="noopener ugc nofollow" target="_blank"> Angular </a>，Angular CLI和Angular应用程序依赖于npm包。为了安装npm软件包，您需要一个npm软件包管理器。遵循本指南了解如何使用它。</li></ul><h2 id="a44c" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated">准备环境</h2><p id="96e3" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">创建项目、生成应用程序和库代码、执行测试、构建和部署等任务都依赖于Angular CLI。</p><p id="7e7f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要安装Angular CLI，请打开终端并运行以下命令:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="72f8" class="lg lh in mx b gy nb nc l nd ne">npm install -g @angular/cli</span></pre><h2 id="c2f1" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">让我们开始</strong></h2><p id="b4b0" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">使用以下命令创建并启动项目:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="7b88" class="lg lh in mx b gy nb nc l nd ne">ng new splash-app --routing</span></pre><p id="dc2a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我的例子中，当它问我“<em class="ky">你想使用哪种样式表格式？”我选择了SCSS，但这取决于你的习惯。</em></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="800b" class="lg lh in mx b gy nb nc l nd ne">cd splash-app<br/>ng serve</span></pre><p id="cb75" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在导航到<code class="fe nf ng nh mx b"><a class="ae jz" href="http://localhost:4200" rel="noopener ugc nofollow" target="_blank">http://localhost:4200</a></code>查看Angular CLI为我们创建的默认应用程序。</p><h2 id="b403" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">主页面:【首页】</strong></h2><p id="31d5" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">用户将访问的主页是我们的主页，大概是任何种类的项目列表。</p><p id="3ece" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，让我们创建以下路径:<code class="fe nf ng nh mx b">src/app/page/homepage/</code></p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/af26485734a12ecbc500bed0e999519f.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*ZLaFEInWXGMHCZ_k3QB_-g.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Homepage’s files</figcaption></figure><p id="7370" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">主页.组件. ts </strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="804c" class="lg lh in mx b gy nb nc l nd ne">import { Component } from '@angular/core';</span><span id="7855" class="lg lh in mx b gy nj nc l nd ne">@Component({<br/>   selector: 'app-home',<br/>   templateUrl: './homepage.component.html',<br/>   styleUrls: ['./homepage.component.scss']<br/>})<br/>export class HomepageComponent {<br/>   constructor() { }<br/>}</span></pre><p id="febc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">homepage.component.html</strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="47a5" class="lg lh in mx b gy nb nc l nd ne">&lt;div&gt;I'm homepage&lt;/div&gt;</span></pre><p id="93a8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">声明新组件</strong></p><p id="1b8a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">转到<code class="fe nf ng nh mx b">src/app/app.module.ts</code>并添加新的申报</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="c6ac" class="lg lh in mx b gy nb nc l nd ne">declarations: [<br/>   AppComponent,<br/>   HomepageComponent<br/>],</span></pre><p id="3fa5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">记录新路线</strong></p><p id="4977" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">转到<code class="fe nf ng nh mx b">src/app/app-routing.module.ts</code>,如果用户访问一条空路线，则创建一条带有重定向的新路线</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="1ebd" class="lg lh in mx b gy nb nc l nd ne">import { NgModule } from '@angular/core';<br/>import { Routes, RouterModule } from '@angular/router';<br/>import { HomepageComponent } from './pages/homepage/homepage.component';</span><span id="f320" class="lg lh in mx b gy nj nc l nd ne">const routes: Routes = [<br/>   {<br/>      path: 'homepage',<br/>      component: HomepageComponent<br/>   },<br/>   {<br/>      path: '',<br/>      redirectTo: 'homepage',<br/>      pathMatch: 'full'<br/>   }<br/>];</span><span id="170d" class="lg lh in mx b gy nj nc l nd ne">@NgModule({<br/>imports: [RouterModule.forRoot(routes)],<br/>exports: [RouterModule]<br/>})</span><span id="b23e" class="lg lh in mx b gy nj nc l nd ne">export class AppRoutingModule { }</span></pre><p id="1df2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">最后一步</strong></p><p id="d876" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了导航到想要的路线，我们需要将<code class="fe nf ng nh mx b">&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>包含到<code class="fe nf ng nh mx b">src/app/app.component.html</code></p><blockquote class="nk nl nm"><p id="e2bc" class="ka kb ky kc b kd ke kf kg kh ki kj kk nn km kn ko no kq kr ks np ku kv kw kx ig bi translated">“路由器出口”通知Angular用所选路由的组件更新应用视图。</p></blockquote><p id="bd13" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">输出</strong></p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/cab4160ee535d39f15354004be24fd1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*ER-gXAUE-Jd-YB07qZFHMg.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Homepage route</figcaption></figure><h2 id="927b" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated">是闪屏的时候了</h2><p id="b0a3" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">在组织应用程序的初始阶段之后，终于到了创建我们想要的闪屏的时候了。</p><p id="4c57" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有些步骤看起来类似于创建主页组件，然而，这种开发的特殊方面是创建一个服务，当我们认为合适时，它负责完成飞溅。</p><p id="e5dd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们先从服务开始</p><p id="c8fd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">创建文件<code class="fe nf ng nh mx b">src/app/services/splash-screen-state.service.ts</code>并编写以下代码</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="6276" class="lg lh in mx b gy nb nc l nd ne">import { Injectable } from '@angular/core';<br/>import { Subscription, Subject } from 'rxjs';</span><span id="4f1a" class="lg lh in mx b gy nj nc l nd ne">@Injectable()<br/>export class SplashScreenStateService {<br/>   subject = new Subject();</span><span id="facf" class="lg lh in mx b gy nj nc l nd ne">   subscribe(onNext): Subscription {<br/>      return this.subject.subscribe(onNext);<br/>   }</span><span id="4f7e" class="lg lh in mx b gy nj nc l nd ne">   stop() {<br/>      this.subject.next(false);<br/>   }</span><span id="fc78" class="lg lh in mx b gy nj nc l nd ne">}</span></pre><p id="5dfc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如你所见，我们只创建了一个<em class="ky">停止</em>方法，而没有创建一个<em class="ky">开始</em>方法。<br/>这是因为在第一次访问时，我们打算激活闪屏而不发生任何事件。</p><p id="1ba2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还有，把注意力放在<code class="fe nf ng nh mx b">subject = new Subject()</code>线上。<br/>我们使用了<em class="ky"> Subject </em>而不是<em class="ky"> BehaviorSubject </em>或<em class="ky"> ReplaySubject </em>，因为订阅者不需要知道任何关于先前值的信息。<br/>这样，订阅者将只获得在订阅后发出的已发布值。</p><p id="bf68" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当然，像任何其他服务一样，我们需要将它包含到<code class="fe nf ng nh mx b">src/app/app.module.ts</code>中的providers数组中</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="52d4" class="lg lh in mx b gy nb nc l nd ne">providers: [<br/>   SplashScreenStateService<br/>]</span></pre><h1 id="adcb" class="nr lh in bd li ns nt nu ll nv nw nx lo ny nz oa lr ob oc od lu oe of og lx oh bi translated"><strong class="ak">最后的闪屏</strong></h1><p id="2ec2" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">创建文件夹<code class="fe nf ng nh mx b">src/app/components/splash-screen</code></p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ab699a804b85a010570e211d2fa9515f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*3Z1aW_a7KfLGwbVSztl7aQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Splash files</figcaption></figure><p id="7977" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> splash.component.ts </strong></p><p id="81bd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我们的空组件的样子</p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7b6fe4e3fc9ffa5f979b6e96a2268245.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*TSx3yt7FWedv3C3RrMO6mQ.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Empty SplashComponent</figcaption></figure><p id="8ac0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">作为HomepageComponent，我们需要将其包含到<code class="fe nf ng nh mx b">src/app/app.module.ts</code></p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/dfb582423d9696905e8e209df0efd481.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*mMZKaWyu58Vgnm_Fdr53Iw.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">app.module.ts</figcaption></figure><p id="be78" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在将选择器添加到<code class="fe nf ng nh mx b">src/app/app.component.html</code>中，使其内容与下面的代码相同</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="901e" class="lg lh in mx b gy nb nc l nd ne">&lt;router-outlet&gt;&lt;/router-outlet&gt;<br/>&lt;app-splash&gt;&lt;/app-splash&gt;</span></pre><h2 id="e92f" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">我们需要什么来让启动画面变得生动起来</strong></h2><p id="db01" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">转到<code class="fe nf ng nh mx b">src/app/components/splash-screen/splash-screen.component.ts</code></p><p id="d1d8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">变量</strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b313" class="lg lh in mx b gy nb nc l nd ne">// The screen starts with the maximum opacity<br/>public opacityChange = 1;</span><span id="72fd" class="lg lh in mx b gy nj nc l nd ne">public splashTransition;</span><span id="d58d" class="lg lh in mx b gy nj nc l nd ne">// First access the splash is visible<br/>public showSplash = true;</span><span id="fe79" class="lg lh in mx b gy nj nc l nd ne">readonly ANIMATION_DURATION = 1;</span></pre><p id="3a96" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">隐藏方法</strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="dcbb" class="lg lh in mx b gy nb nc l nd ne">private hideSplashAnimation() {<br/>   // Setting the transition<br/>   this.splashTransition = `opacity ${this.ANIMATION_DURATION}s`;<br/>   this.opacityChange = 0;</span><span id="b943" class="lg lh in mx b gy nj nc l nd ne">   setTimeout(() =&gt; {<br/>      // After the transition is ended the showSplash will be hided<br/>      this.showSplash = !this.showSplash;<br/>   }, 1000);<br/>}</span></pre><p id="34f8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">订阅停止事件</strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="3f2a" class="lg lh in mx b gy nb nc l nd ne">constructor(<br/>   private splashScreenStateService: SplashScreenStateService<br/>) { }</span><span id="9555" class="lg lh in mx b gy nj nc l nd ne">ngOnInit(): void {</span><span id="4a0d" class="lg lh in mx b gy nj nc l nd ne">   // Somewhere the stop method has been invoked<br/>   this.splashScreenStateService.subscribe(res =&gt; {<br/>      this.hideSplashAnimation();<br/>   });</span><span id="1ff6" class="lg lh in mx b gy nj nc l nd ne">}</span></pre><p id="605f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">splash.component.html</strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4b77" class="lg lh in mx b gy nb nc l nd ne">&lt;div *ngIf="showSplash" class="app-splash-screen" [ngStyle]="{'opacity': opacityChange, 'transition': splashTransition}"&gt;<br/>   <br/>   &lt;div class="app-splash-content"&gt;<br/>      &lt;div data-text="Loading ..." class="loading-text"&gt;Loading ...<br/>      &lt;/div&gt;<br/>   &lt;/div&gt;</span><span id="98d6" class="lg lh in mx b gy nj nc l nd ne">&lt;/div&gt;</span></pre><p id="4fcb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> splash.component.scss </strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b6bf" class="lg lh in mx b gy nb nc l nd ne">.app-splash-screen {<br/>   background: #3a36d1;<br/>   position: fixed;<br/>   top: 0;<br/>   left: 0;<br/>   right: 0;<br/>   bottom: 0;<br/>   display: flex;<br/>   justify-content: center;<br/>   align-items: center;<br/>   width: 100%;<br/>   height: 100%;<br/>   z-index: 1;<br/>   opacity: 1;<br/>}</span><span id="503b" class="lg lh in mx b gy nj nc l nd ne">.loading-text {<br/>   position: relative;<br/>   color: rgba(0, 0, 0, 0.3);<br/>   font-size: 5em;<br/>}</span><span id="aa28" class="lg lh in mx b gy nj nc l nd ne">.loading-text:before {<br/>   content: attr(data-text);<br/>   position: absolute;<br/>   overflow: hidden;<br/>   max-width: 7em;<br/>   white-space: nowrap;<br/>   color: #fff;<br/>   animation: loading 8s linear;<br/>}</span><span id="487f" class="lg lh in mx b gy nj nc l nd ne">@keyframes loading {<br/>   0% {<br/>      max-width: 0;<br/>   }<br/>}</span></pre><p id="cb19" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">好吧，一切都很好，但是谁来停止启动画面呢？</strong>🤔</p><p id="e1c4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">目前，让我们采取最简单的解决方案。我们委托主页调用服务器，接收它需要的数据，一旦完成，也停止启动画面。</p><p id="988c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，转到<code class="fe nf ng nh mx b">src/app/pages/homepage/homepage.component.ts</code>并在超时5秒后停止闪屏。<br/>(超时模拟http请求)</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="3897" class="lg lh in mx b gy nb nc l nd ne">constructor(<br/>   private splashScreenStateService: SplashScreenStateService<br/>) { }</span><span id="e740" class="lg lh in mx b gy nj nc l nd ne">ngOnInit(): void {<br/>   setTimeout(() =&gt; {<br/>      this.splashScreenStateService.stop();<br/>   }, 5000);<br/>}</span></pre><p id="7d48" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">输出</strong></p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ol"><img src="../Images/4f3341258ced1c04b13264def4bc7a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_c0PkXBQfXzw3EEY7hRn1g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">SplashScreen</figcaption></figure><h1 id="d1e1" class="nr lh in bd li ns nt nu ll nv nw nx lo ny nz oa lr ob oc od lu oe of og lx oh bi translated">主页解析器</h1><p id="7652" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">什么是解析器？</p><blockquote class="nk nl nm"><p id="6ab1" class="ka kb ky kc b kd ke kf kg kh ki kj kk nn km kn ko no kq kr ks np ku kv kw kx ig bi translated">角度解析器是一种平滑的方法，通过在导航到特定组件之前加载数据来增强用户体验。</p></blockquote><p id="fe05" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这种情况下，我们希望将主页从从服务器加载数据的责任中解放出来，因为没有这些数据，主页就没有存在的理由。</p><p id="ad19" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用这种方法，主页只需检索数据，而不必担心如何为HTTP请求构建请求，也不必知道在需要来自不同服务的数据时应该调用哪些服务。对解析器的单一访问为组件提供了所需的一切。</p><h2 id="33bc" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">让我们创建解析器</strong></h2><p id="c960" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">创建解析器到<code class="fe nf ng nh mx b">src/app/resolvers/homepage.resolver.ts</code>路径。</p><p id="a60f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于本文，我们将用经典的超时替换对服务器的直接调用。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4ad7" class="lg lh in mx b gy nb nc l nd ne">import { Resolve, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';<br/>import { Injectable } from '@angular/core';<br/>import { Observable, of } from 'rxjs';<br/>import { SplashScreenStateService } from '../services/splash-screen-state.service';</span><span id="65d4" class="lg lh in mx b gy nj nc l nd ne">@Injectable()<br/>export class HomepageResolver implements Resolve&lt;any&gt; {</span><span id="b646" class="lg lh in mx b gy nj nc l nd ne">   constructor(<br/>      private splashScreenStateService: SplashScreenStateService<br/>   ) { }</span><span id="0ebe" class="lg lh in mx b gy nj nc l nd ne">   public resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Promise&lt;Observable&lt;any&gt;&gt; {</span><span id="4a11" class="lg lh in mx b gy nj nc l nd ne">      return new Promise((resolve, reject) =&gt; {<br/>         setTimeout(() =&gt; {<br/>            this.splashScreenStateService.stop();<br/>            resolve(of(['item1', 'item2']));<br/>         }, 5000);<br/>      });</span><span id="1619" class="lg lh in mx b gy nj nc l nd ne">   }<br/>}</span></pre><p id="578c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如你所看到的，我们已经将我们在<em class="ky">主页</em>文件中所做的大致移动到了<em class="ky">解析器</em>中，返回了一个条目列表。</p><p id="7577" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">像其他人一样，将解析器添加到providers数组中的<code class="fe nf ng nh mx b">src/app/app.module.ts</code>。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="ea85" class="lg lh in mx b gy nb nc l nd ne">providers: [<br/>   SplashScreenStateService,<br/>   HomepageResolver<br/>]</span></pre><p id="6b43" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">并移动到<code class="fe nf ng nh mx b">src/app/app-routing.module.ts</code>以将解析器添加到<code class="fe nf ng nh mx b">homepage</code>路线。</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8f38" class="lg lh in mx b gy nb nc l nd ne">const routes: Routes = [<br/>   {<br/>      path: 'homepage',<br/>      component: HomepageComponent,<br/>      resolve: {'itemsList': HomepageResolver}<br/>   },<br/>   {<br/>      path: '',<br/>      redirectTo: 'homepage',<br/>      pathMatch: 'full'<br/>   }<br/>];</span></pre><p id="6273" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，让我们回到<code class="fe nf ng nh mx b">src/app/pages/homepage/homepage.component.ts</code>，用下面的代码替换现有的代码</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="51b9" class="lg lh in mx b gy nb nc l nd ne">constructor(private activatedRoute: ActivatedRoute) { }</span><span id="40f6" class="lg lh in mx b gy nj nc l nd ne">ngOnInit(): void {<br/>   this.activatedRoute.snapshot.data.itemsList<br/>      .subscribe(res =&gt; {<br/>         console.log({ res });<br/>      })<br/>}</span></pre><h2 id="458c" class="lg lh in bd li lj lk dn ll lm ln dp lo kl lp lq lr kp ls lt lu kt lv lw lx ly bi translated"><strong class="ak">最后也是最简单的步骤</strong></h2><p id="1273" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">因为我们的解析器为主页提供了一个元素列表，所以让我们尝试在模板上显示它们。</p><p id="ad5d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">转到<code class="fe nf ng nh mx b">src/app/pages/homepage/homepage.component.html</code>并添加</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d0ec" class="lg lh in mx b gy nb nc l nd ne">&lt;ul&gt;<br/>   &lt;li *ngFor="let item of myItems"&gt;<br/>      {{item}}<br/>   &lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="bb8e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<code class="fe nf ng nh mx b">homepage.component.ts</code>上创建“<em class="ky"> myItems </em>”列表，并用订阅结果增强它。</p><p id="a5fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">输出</strong></p><figure class="ms mt mu mv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi om"><img src="../Images/0517fa9562c879f46aac9b049aae8411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xTTcFSOjxZP3c3nI-b-1ww.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Homepage</figcaption></figure><h1 id="d6f7" class="nr lh in bd li ns nt nu ll nv nw nx lo ny nz oa lr ob oc od lu oe of og lx oh bi translated">参考</h1><p id="e674" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">本文中的所有代码都可以在这里找到:<a class="ae jz" href="https://github.com/CoxxD/splash-app" rel="noopener ugc nofollow" target="_blank">https://github.com/CoxxD/splash-app</a></p><h1 id="0e83" class="nr lh in bd li ns nt nu ll nv nw nx lo ny nz oa lr ob oc od lu oe of og lx oh bi translated">结论</h1><p id="18f3" class="pw-post-body-paragraph ka kb in kc b kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx ig bi translated">闪屏当然是现在许多应用程序都采用的一个特性。易于使用，但对用户来说非常有效和有吸引力。</p></div><div class="ab cl kz la hr lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ig ih ii ij ik"><p id="9b89" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你喜欢这篇文章，请按👏想按多少次就按多少次。另外，如果你有任何问题，请随时提问。</p><p id="5488" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">非常感谢你的阅读！</p><p id="6701" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">更多内容尽在</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="ky">plain English . io</em></strong></a></p></div></div>    
</body>
</html>