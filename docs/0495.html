<html>
<head>
<title>Managing forms in React with Formik</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Formik管理React中的表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-managing-forms-with-formik-c90a2ea75f4b?source=collection_archive---------5-----------------------#2019-10-28">https://javascript.plainenglish.io/react-managing-forms-with-formik-c90a2ea75f4b?source=collection_archive---------5-----------------------#2019-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ed24" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">介绍在React中管理表单的Formik库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ae60d9ef243496a40753e216f4d42b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U3OVWyx5sM2Wz080"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@sapegin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artem Sapegin</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="515d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天我想谈谈<a class="ae kv" href="https://jaredpalmer.com/formik/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Formik </strong> </a>库，它允许我们在React中以简单干净的方式创建表单，这通常是一项复杂的任务，而像Redux Forms这样的库已经以相对的方式解决了这个问题。</p><p id="0d16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是否需要使用第三方库来管理我们的应用程序的表单在很大程度上取决于我们的应用程序的复杂性。对于最简单的，我们可能能够求助于组件的内部状态，但是对于更复杂的，我们可能需要一些帮助。</p><p id="6d81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是为什么今天我想介绍一下<strong class="ky ir"> Formik </strong>库，它对自己的描述如下:</p><blockquote class="ls lt lu"><p id="1439" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">在没有眼泪的情况下做出反应😭</p></blockquote><p id="e420" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不需要更多的介绍，对不对？所以，让我们开始吧！</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="02ea" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">与Redux形式的比较</h1><p id="3364" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">根据Formik的文档，这个库比<a class="ae kv" href="https://github.com/erikras/redux-form" rel="noopener ugc nofollow" target="_blank"> Redux Form </a>突出的地方有三点:</p><ul class=""><li id="d45a" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated"><strong class="ky ir">一个表单的状态是短暂的和局部的</strong>，所以根据Dan Abramov的观点，让它保持Redux的全局状态是没有意义的。</li><li id="7d3b" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">当我们使用<strong class="ky ir"> Redux Form </strong>时，每次按下一个键，它都会在reducing时被调用，这<strong class="ky ir">会降低大型应用程序的性能</strong>。</li><li id="130b" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">缩小的Formik大小是Redux形式的一半</strong>(12.7 kB vs 22.5 kB)。</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="15d1" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">安装Formik并构建我们的第一个模板</h1><p id="6e00" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我们可以在项目中使用<code class="fe nr ns nt nu b">npm</code> / <code class="fe nr ns nt nu b">yarn</code>安装Formik，如下所示:</p><pre class="kg kh ki kj gt nv nu nw nx aw ny bi"><span id="b058" class="nz mh iq nu b gy oa ob l oc od">yarn add formik</span></pre><p id="f841" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦完成，我们就可以使用库的<strong class="ky ir"> Formik </strong>组件来创建我们的第一个表单。该组件可以接收以下参数:</p><ul class=""><li id="a9a8" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated"><code class="fe nr ns nt nu b">initialValues</code>，我们将向其传递一个对象来定义我们表单的初始值。</li><li id="5100" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><code class="fe nr ns nt nu b">validate</code>，我们将传递一个函数来验证用户输入的值。</li><li id="9785" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><code class="fe nr ns nt nu b">onSubmit</code>，我们将向其传递一个函数，该函数接收发送的值作为第一个参数，接收一个对象作为第二个参数，该对象将为我们提供<code class="fe nr ns nt nu b">setSubmitting</code>方法，通知Formik我们完成表单处理的时刻。</li></ul><p id="d6c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">了解了这一点，一个基本的联系方式可以是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/afea1431cfd7c58921caadb3f0a253b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zoa3W4kFrpom0qx0YiaXZg.png"/></div></div></figure><p id="58c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将会看到，代码非常简单:</p><ul class=""><li id="d8be" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated">在第8行和第9行，我们定义了表单的初始值以及验证函数(当用户填写表单时执行该函数，因此此时会显示错误)。</li><li id="e3f5" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">在第26行，我们建立了传递给参数<code class="fe nr ns nt nu b">onSubmit</code>的函数。在这种情况下，<code class="fe nr ns nt nu b">setTimeout</code>复制对外部API的调用。一秒钟后，我们用<code class="fe nr ns nt nu b">false</code>调用<code class="fe nr ns nt nu b">setSubmitting</code>方法。</li><li id="9d62" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">在第34到40行，我们有一个可以从表单中访问的所有方法和属性的列表。例如，我们可以获取允许您管理表单更改(<code class="fe nr ns nt nu b">handleChange</code>)或提交(<code class="fe nr ns nt nu b">handleSubmit</code>)的值、验证错误或方法。</li><li id="62e9" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">最后，从第42行到第79行，我们通常使用上述属性来绘制表单。</li></ul><p id="6254" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单对吗？通过这种方式，我们的表单状态保持在本地管理，并且代码非常易读。但是还有更多…</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="f64d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">用Yup验证Formik表单</h1><p id="e4a8" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">正如您所看到的，我们可以编写自己的验证函数，或者将它委托给其他第三方库，这样我们可以轻松地使用它们。</p><p id="3f9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不过Formik自己的一个建议用<a class="ae kv" href="https://github.com/jquense/yup" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Yup </strong> </a>库。这个库允许我们定义一个可以在表单中使用的验证方案，这要感谢<code class="fe nr ns nt nu b">validationSchema</code>选项，它会自动将由Yup抛出的验证错误转换成适合Formik的对象。</p><p id="2bf1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要安装Yup，我们将通过<code class="fe nr ns nt nu b">npm</code> / <code class="fe nr ns nt nu b">yarn</code>来完成:</p><pre class="kg kh ki kj gt nv nu nw nx aw ny bi"><span id="a298" class="nz mh iq nu b gy oa ob l oc od">yarn add yup</span></pre><p id="e7e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成后，我们可以为前面的表单定义如下的验证方案:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/f2ed82663114904c4096befc6ffb9924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLKwxd6UA5d8qSF6d6kjYA.png"/></div></div></figure><p id="9725" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个验证方案的定义非常简单。定义<strong class="ky ir">中的</strong>称为<code class="fe nr ns nt nu b">shape</code>就足够了，T9是一个对象，其中的属性是表单中每个字段的名称及其值，要进行的验证是从语义上编写的，就像你在<code class="fe nr ns nt nu b">email</code>字段的例子中看到的那样。</p><p id="9320" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦完成，我们就可以使用<code class="fe nr ns nt nu b">Formik</code>组件的<code class="fe nr ns nt nu b">validationSchema</code>属性来使用我们的<code class="fe nr ns nt nu b">ProfileSchema</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/3f421ec3906b2ad14ccbfa8c50d2a157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UIwut9BVIr2P5s2_y1ItHg.png"/></div></div></figure><p id="bbfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，我们的表格就更短、更简单了。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="5168" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">特设withFormik</h1><p id="5938" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">最后，Formik还为我们提供了使用HOC(高阶组件)<code class="fe nr ns nt nu b">withFormik</code>的可能性，以便将所有属性和<code class="fe nr ns nt nu b">handlers</code>传递给用这个HOC包装的组件。</p><p id="400e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们要做的第一件事是如下声明我们的<code class="fe nr ns nt nu b">ProfileForm</code>组件:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/d56fcda228251228d2b74ae5d114a135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fTGtZPJtPjBXxkxOMWstQ.png"/></div></div></figure><p id="5bf1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以传递给这个HOC的其余选项可以在<a class="ae kv" href="https://jaredpalmer.com/formik/docs/api/withformik#reference" rel="noopener ugc nofollow" target="_blank"> Formik文档本身中读取。</a></p><p id="cead" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样我们的表单又可以工作了。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="4191" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">最后的想法</h1><p id="bcdc" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">如你所见，<strong class="ky ir"> Formik </strong>库允许我们非常容易地管理应用程序的表单，而不像Redux Form那样求助于全局状态。</p><p id="38ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇介绍之后，在接下来的文章中，我将教你创建更复杂的表单，比如那些涉及管理图像或动态元素的表单。</p><p id="78c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前，我希望这篇文章能帮助你了解一家正在2019年底获得力量的书店。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="2ea9" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">贮藏室ˌ仓库</h1><p id="4ae2" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我留下了一个简单应用程序的存储库，如果您想继续使用<strong class="ky ir"> Formik </strong>进行练习，您可以在其中找到我在本文中评论的代码。</p><div class="of og gp gr oh oi"><a href="https://github.com/ger86/react-formik" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">ger86/react-formik</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">github.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow kp oi"/></div></div></a></div></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="5d5f" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">你想看更多这样的文章吗？</h1><p id="b16c" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">如果你喜欢这篇文章，我鼓励你订阅我每周日发送的时事通讯，里面有类似的出版物和更多的推荐内容:👇👇👇</p><div class="of og gp gr oh oi"><a href="https://eepurl.us20.list-manage.com/subscribe?u=c14cad2102bcf33bf216cc69e&amp;id=2790da9378" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">拿铁和代码</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">这是一份最新的时事通讯，代码是recibirás cada domingo。——洛斯多斯乌尔蒂莫斯艺术博物馆……</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">eepurl.us20.list-manage.com</p></div></div><div class="or l"><div class="ox l ot ou ov or ow kp oi"/></div></div></a></div></div></div>    
</body>
</html>