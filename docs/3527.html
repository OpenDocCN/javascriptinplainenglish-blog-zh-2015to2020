<html>
<head>
<title>Create Custom Pipe in Angular to Replace Null Value With a Text</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Angular中创建自定义管道，用文本替换空值</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-custom-pipe-in-angular-to-replace-null-value-with-a-text-376b58b15b61?source=collection_archive---------3-----------------------#2020-10-06">https://javascript.plainenglish.io/create-custom-pipe-in-angular-to-replace-null-value-with-a-text-376b58b15b61?source=collection_archive---------3-----------------------#2020-10-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2d0d" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">基本管道概述和在Angular中创建自定义管道的逐步过程</h2></div><h2 id="216c" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">一点背景知识</h2><p id="e74a" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">Angular中的管道是在HTML模板中转换数据的一种方式。它不会更改TypeScript文件中数据的值。管道接收数据作为输入，并将其转换为所需的输出。管道的一个很好的用例是转换数据格式。通常，我们从API数据中获得的日期时间格式并不是我们想要显示给用户的格式。这时，我们可以使用管道将数据转换成所需的格式。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/72b51e41734cdcd3b6636b9bb0ab3cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1bRfAeWhhc9-2YB-"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Photo by <a class="ae mh" href="https://unsplash.com/@oskaryil?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Oskar Yildiz</a> on <a class="ae mh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="615c" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">内置管道</h2><p id="b371" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">Angular为典型的数据转换提供了<a class="ae mh" href="https://angular.io/api/common#pipes" rel="noopener ugc nofollow" target="_blank">内置管道</a>，例如DatePipe、UpperCasePipe、LowerCasePipe等。以便我们可以将数据转换成HTML模板中所需的格式。现在，让我们看一些关于DatePipe的例子。</p><p id="a9b1" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">在下面的代码中(官方<a class="ae mh" href="https://angular.io/api/common/DatePipe#usage-example" rel="noopener ugc nofollow" target="_blank">示例</a>的略微修改版本)，我们使用了<strong class="la io">日期</strong>管道。我们必须将管道放在模板表达式中的垂直线(|)之后。</p><p id="4ee0" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">管道可以接受可选参数来修改输出。要向管道传递参数，只需在管道表达式的末尾添加一个冒号和参数值。在下面的代码中，我们将' shortTime '、' medium '作为参数传递给<strong class="la io"> date </strong>管道。</p><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="3ed7" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">我们将在浏览器中得到下面的输出。</p><pre class="ls lt lu lv gt mp mq mr ms aw mt bi"><span id="55b2" class="kc kd in mq b gy mu mv l mw mx">Today is Sep 25, 2020</span><span id="6f07" class="kc kd in mq b gy my mv l mw mx">Or if you prefer, 09/25/2020</span><span id="5d17" class="kc kd in mq b gy my mv l mw mx">The time is 2:16 PM</span><span id="6e22" class="kc kd in mq b gy my mv l mw mx">Date from time stamp is Sep 25, 2020, 2:11:19 PM</span></pre></div><div class="ab cl mz na hr nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ig ih ii ij ik"><h2 id="2f83" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">我们定制管道的动机</h2><p id="ed07" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">我们都喜欢给用户最好的用户体验。因此，如果值为null，用户在浏览器中看不到任何内容。不是很好的用户体验。我们将通过创建自己的自定义管道来解决这个问题，该管道将在模板表达式中用给定的文本替换空值或未定义的值。</p><h2 id="8039" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">让我们创建我们的自定义管道</h2><p id="b436" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">我们将使用Angular CLI通过下面的命令创建我们自己的自定义管道。</p><pre class="ls lt lu lv gt mp mq mr ms aw mt bi"><span id="ea67" class="kc kd in mq b gy mu mv l mw mx">ng generate pipe replace-null-with-text</span></pre><p id="5144" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">Angular CLI将为我们的自定义管道生成一个框架文件。</p><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="1a93" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">在<strong class="la io"> @Pipe </strong>装饰器中指定的<strong class="la io">名称</strong>是管道的名称(例如<strong class="la io">replaceullwithtext</strong>)。我们将在HTML中使用这个名称，就像<strong class="la io"> date </strong>管道示例一样。</p><p id="4793" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">在<strong class="la io">转换</strong>方法中，<strong class="la io">值</strong>参数是我们从HTML模板中获取的<strong class="la io"> </strong>值<strong class="la io"> </strong>，而<strong class="la io"> args </strong>是我们想要发送给自定义管道的可选参数。请注意，您不必使用相同的参数名称，但请记住参数位置很重要。第一个参数总是从HTML模板中获取值，并且至少有一个参数是必需的。</p><p id="5f40" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated"><em class="ng">如果您正在SharedModule之类的Angular模块中创建管道，那么不要忘记从module.ts文件中将其导出，否则您将无法在其他模块中使用它。或者，如果您没有使用Angular CLI来生成框架文件，那么您也必须在模块声明中添加自定义管道类名。</em></p><p id="d86b" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">对于我们的自定义管道，我们希望它返回一个文本值，当来自HTML模板的值为null时，我们将把这个文本值作为参数从模板表达式中传递。因此，在下面的代码中，我们检查HTML模板中的值是否为空或未定义。如果值为空/未定义，那么我们将返回<strong class="la io"> replaceText </strong>参数值，或者我们将返回相同的值。</p><p id="151b" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">我们还为<strong class="la io"> replaceText </strong>添加了一个默认值‘N/A’。因此，如果我们不从HTML模板传递任何参数，那么对于null/undefined值，我们的自定义管道将返回' N/A '。</p><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="9160" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">现在让我们来看看我们的定制管道的运行情况。😃</p><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="4872" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">我们将在浏览器中得到以下输出。</p><pre class="ls lt lu lv gt mp mq mr ms aw mt bi"><span id="136b" class="kc kd in mq b gy mu mv l mw mx">Book Name : Awesome Book</span><span id="d33d" class="kc kd in mq b gy my mv l mw mx">Author Name : Author Name Not Available</span><span id="781a" class="kc kd in mq b gy my mv l mw mx">Published at : Published Date Not Available</span><span id="8603" class="kc kd in mq b gy my mv l mw mx">Price: N/A</span></pre><p id="204f" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated"><strong class="la io"> book </strong>变量不为空，因此我们的自定义管道不会更改该值，我们在输出中不会看到任何类型的book value转换。但是由于我们的<strong class="la io"> author </strong>和<strong class="la io"> publishedAt </strong>值为空，我们的自定义管道将返回我们从HTML模板传递的<strong class="la io"> replaceText </strong>值作为自定义管道的参数，对于<strong class="la io"> price </strong>我们没有传递任何参数值来替换空值，因此我们的自定义管道将返回默认的replaceText值‘N/A’。</p><p id="c551" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated">耶！😃我们得到了我们的定制角管。</p></div><div class="ab cl mz na hr nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ig ih ii ij ik"><p id="fb92" class="pw-post-body-paragraph ky kz in la b lb mi jo ld le mj jr lg kl mk li lj kp ml ll lm kt mm lo lp lq ig bi translated"><em class="ng">我也几乎每天都在学Angular。所以，如果我犯了什么错误，请随时纠正我，并在评论区提出你的建议。</em></p></div></div>    
</body>
</html>