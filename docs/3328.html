<html>
<head>
<title>Maintainable JavaScript — Loops and Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可维护的JavaScript——循环和变量</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/maintainable-javascript-loops-and-variables-b5d500becd1a?source=collection_archive---------4-----------------------#2020-09-19">https://javascript.plainenglish.io/maintainable-javascript-loops-and-variables-b5d500becd1a?source=collection_archive---------4-----------------------#2020-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2b3b2a46dcdd3eae1090cb2082b65a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XojkJPA33TUArn5X"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@kevinoetiker?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kevin Oetiker</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0533" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果想继续使用代码，创建可维护的JavaScript代码很重要。</p><p id="9221" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将通过查看各种块语句和声明变量来了解创建可维护JavaScript代码的基础。</p><h1 id="d91a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">for-in循环</h1><p id="60ea" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">for-in循环用于迭代对象的属性。</p><p id="48d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该循环遍历每个属性，并在变量中返回属性名，而不是定义控制条件。</p><p id="94a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以这样使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2487" class="mn lc iq mj b gy mo mp l mq mr">for (const prop in object) {<br/>  console.log(prop, object[prop]);<br/>}</span></pre><p id="b353" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">object</code>是对象，<code class="fe ms mt mu mj b">prop</code>是属性键。</p><p id="09d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">for-in循环获取对象本身及其所有原型的所有属性。</p><p id="5f58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们最终可能会得到意想不到的结果。</p><p id="bdc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们想使用<code class="fe ms mt mu mj b">hasOwnProperty</code>方法来检查属性是否在方法中。</p><p id="5ff1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a2d4" class="mn lc iq mj b gy mo mp l mq mr">for (const prop in object) {<br/>  if (object.hasOwnProperty(prop)) {<br/>    console.log(prop, object[prop]);<br/>  }<br/>}</span></pre><p id="d548" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有些风格指南，比如道格拉斯·克洛克福特的，需要在for-in循环中使用<code class="fe ms mt mu mj b">hasOwnProperty</code>。</p><p id="4228" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们在没有使用<code class="fe ms mt mu mj b">hasOwnProperty</code>方法的情况下使用for-in循环时，ESLint和JSHint都会警告我们。</p><p id="7e30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个常见的错误是使用for-in循环来迭代数组。</p><p id="7094" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们不应该使用for-in循环来遍历数组:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="722d" class="mn lc iq mj b gy mo mp l mq mr">const values = [1, 2, 3, 4, 5];</span><span id="3c3b" class="mn lc iq mj b gy mv mp l mq mr">for (const i in values) {<br/>  console.log(values[i]);<br/>}</span></pre><p id="f738" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为订单没有保证。</p><p id="75a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这不是它的预期目的。</p><p id="5b5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">for-in循环用于处理对象及其原型的关键点。</p><h1 id="1186" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">for-of循环</h1><p id="19d7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">for-of循环让我们遍历一个iterable对象。</p><p id="bc6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们应该在数组中循环的循环。</p><p id="acb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以这样使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9d8f" class="mn lc iq mj b gy mo mp l mq mr">const values = [1, 2, 3, 4, 5];</span><span id="8346" class="mn lc iq mj b gy mv mp l mq mr">for (const val of values) {<br/>  console.log(val);<br/>}</span></pre><p id="96be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">val</code>是数组的入口。</p><p id="9ea2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以遍历任何可迭代的对象，所以我们可以遍历地图和集合。</p><p id="715c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bf29" class="mn lc iq mj b gy mo mp l mq mr">const values = new Set([1, 2, 3, 4, 5]);</span><span id="85fb" class="mn lc iq mj b gy mv mp l mq mr">for (const val of values) {<br/>  console.log(val);<br/>}</span></pre><p id="10ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7f60" class="mn lc iq mj b gy mo mp l mq mr">const values = new Map([<br/>  [1, 'foo'],<br/>  [2, 'bar'],<br/>  [3, 'baz']<br/>]);</span><span id="785e" class="mn lc iq mj b gy mv mp l mq mr">for (const val of values) {<br/>  console.log(val);<br/>}</span></pre><p id="3a44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以破坏地图的键:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8f59" class="mn lc iq mj b gy mo mp l mq mr">const values = new Map([<br/>  [1, 'foo'],<br/>  [2, 'bar'],<br/>  [3, 'baz']<br/>]);</span><span id="b127" class="mn lc iq mj b gy mv mp l mq mr">for (const [key, val] of values) {<br/>  console.log(key, val);<br/>}</span></pre><p id="5045" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是很多像ESLint和Airbnb这样的风格指南推荐的循环。</p><h1 id="e1c3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">变量声明</h1><p id="550e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">变量声明可以用<code class="fe ms mt mu mj b">var</code>、<code class="fe ms mt mu mj b">let</code>或<code class="fe ms mt mu mj b">const</code>关键字来完成。</p><p id="192f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">var</code>是声明变量的老办法。</p><p id="3f88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该使用<code class="fe ms mt mu mj b">let</code>和<code class="fe ms mt mu mj b">const</code>，因为它们是块范围的，只有在定义后才可用。</p><p id="dec2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">const</code>变量也不能被重新分配。</p><p id="825d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6d35" class="mn lc iq mj b gy mo mp l mq mr">function doWork() {<br/>  var result = 20 + value;<br/>  var value = 30;<br/>  return result;<br/>}</span></pre><p id="f144" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="69c3" class="mn lc iq mj b gy mo mp l mq mr">function doWork() {<br/>  const value = 30;<br/>  const result = 20 + value;<br/>  return result;<br/>}</span></pre><p id="8ebd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们尽可能多地使用<code class="fe ms mt mu mj b">const</code>,这样变量就不会被意外地重新分配。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/08560dce37009d73aa74a3d709f92f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9ZEfNiNZ6foDjr7m"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="decb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="4f3f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">for-in循环仅用于遍历对象的键。</p><p id="2787" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">for-of循环用于遍历任何可迭代对象。</p><p id="7cd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，<code class="fe ms mt mu mj b">var</code>不应该再用于声明变量。</p></div></div>    
</body>
</html>