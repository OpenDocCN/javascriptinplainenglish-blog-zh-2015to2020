<html>
<head>
<title>Goodist: A simple array manipulation library for Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Goodist:一个简单的Node.js数组操作库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simple-array-manipulation-library-for-node-js-goodist-cb02175db504?source=collection_archive---------2-----------------------#2019-05-08">https://javascript.plainenglish.io/simple-array-manipulation-library-for-node-js-goodist-cb02175db504?source=collection_archive---------2-----------------------#2019-05-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/2649506b389b7738201d2eca1ca54efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Nq1fQSPq9aeoWxn4WFbhg.png"/></div></div></figure><div class=""/><div class=""><h2 id="f30e" class="pw-subtitle-paragraph jv ix iy bd b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dk translated">今天早上我花了两个多小时，在互联网上搜索一个简单易用的库来解决我在Node项目中面临的一个小问题，并使我的工作更快。</h2></div><h1 id="411b" class="kn ko iy bd kp kq kr ks kt ku kv kw kx ke ky kf kz kh la ki lb kk lc kl ld le bi translated">我找不到一个能完全满足我需求的。所以我决定写一个(goodist)来解决我的问题。</h1><p id="13da" class="pw-post-body-paragraph lf lg iy lh b li lj jz lk ll lm kc ln lo lp lq lr ls lt lu lv lw lx ly lz ma ig bi translated">因为我认为它可能对其他人有所帮助，所以我将它发布到npm，让开源社区可以使用。</p><p id="3998" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">你到底想达到什么目的？会是一个很好的问题。</p><p id="df91" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">让我用一个实际的例子来开始我的解释，这样事情可能看起来更清楚，更容易理解。</p><p id="9caf" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">假设我有两个模式对象employeeSchema和leaveSchema，如下面的步骤所示。</p><p id="c241" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">第一步</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="93c5" class="mp ko iy ml b gy mq mr l ms mt">//Employee Schema<br/>const mongoose = require('mongoose');<br/>const Schema = mongoose.Schema;</span><span id="61b1" class="mp ko iy ml b gy mu mr l ms mt">const employeeSchema = new Schema({<br/>  firstName: {<br/>    type: String,<br/>    required: true<br/>  }<br/>  lastName: {<br/>    type: String,<br/>    required: true<br/>  },<br/>  leave: [{<br/>    type: Schema.Types.ObjectId,<br/>    ref: 'Leave',<br/>    required: true<br/>  }]<br/>  resetToken: String,<br/>  resetTokenExpiration: Date<br/>}, { timestamps: true });</span><span id="9fe9" class="mp ko iy ml b gy mu mr l ms mt">module.exports = mongoose.model('Employee', employeeSchema);<br/></span><span id="6184" class="mp ko iy ml b gy mu mr l ms mt">//Leave Schema<br/>const mongoose = require('mongoose');<br/>const Schema = mongoose.Schema;</span><span id="32f6" class="mp ko iy ml b gy mu mr l ms mt">const leaveSchema = new Schema({<br/>  startDate: {<br/>    type: Date,<br/>    required: true<br/>  }<br/>  endDate: {<br/>    type: Date,<br/>    required: true<br/>  },<br/>  leaveType: {<br/>    type: String,<br/>	enum: ['annual','sick']<br/>    required: true<br/>  },<br/>  employee: {<br/>    type: mongoose.Types.ObjectId,<br/>    ref: 'Employee',<br/> 	required: true<br/>  }<br/>}, { timestamps: true });</span><span id="2f73" class="mp ko iy ml b gy mu mr l ms mt">module.exports = mongoose.model(‘Leave’, leaveSchema);</span></pre><p id="fb5c" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">第二步</p><p id="2b0b" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">既然我的模式已经准备好了。</p><p id="a3fc" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">注意:在我上面的模式中，员工可以多次请求休假，换句话说就是一对多的关系。</p><p id="9946" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">而一个假期只能有一个员工，换句话说就是一对一的关系，视情况而定。</p><p id="0510" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">因此，每当一个雇员请求休假时，我希望将该休假ID添加到上面employeeSchema对象中该雇员的休假数组中，每当他删除该休假时，我也希望将其从休假数组中删除。这就是我的图书馆(<a class="ae mv" href="https://www.npmjs.com/package/goodist" rel="noopener ugc nofollow" target="_blank"> goodist </a>)发挥巨大作用的地方。请参见代码片段。</p><p id="bfe2" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">第一件事首先安装库</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="abef" class="mp ko iy ml b gy mq mr l ms mt">npm i goodist</span></pre><p id="df6c" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">如下图所示导入它</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="5643" class="mp ko iy ml b gy mq mr l ms mt">const goodist = require(‘goodist’);</span><span id="ab14" class="mp ko iy ml b gy mu mr l ms mt">//Create Leave</span><span id="8638" class="mp ko iy ml b gy mu mr l ms mt">exports.create = async (req, res, next) =&gt; {<br/>  const errors = validationResult(req);<br/>  const { startDate, endDate, comment, leavetype } = req.body;<br/>  const employeeID = req.userId;</span><span id="dccd" class="mp ko iy ml b gy mu mr l ms mt">  try {</span><span id="a90a" class="mp ko iy ml b gy mu mr l ms mt">    if (!errors.isEmpty()) {<br/>      const error = new Error('Validation failed, entered data is incorrect.');<br/>      error.statusCode = 422;<br/>      throw error;<br/>    }</span><span id="56af" class="mp ko iy ml b gy mu mr l ms mt">    const leave = new Leave({<br/>      startDate: startDate,<br/>      endDate: endDate,<br/>      leavetype: leavetype,<br/>      employee: employeeID<br/>    });</span><span id="4a32" class="mp ko iy ml b gy mu mr l ms mt">    await leave.save();<br/>    const employee = await Employee.findById(employeeID);</span><span id="6e17" class="mp ko iy ml b gy mu mr l ms mt">   //Add leave ID to employee leave array<br/>   <strong class="ml iz">goodist.pushOne(leave, employee.leave, employee);</strong></span><span id="7334" class="mp ko iy ml b gy mu mr l ms mt">    res.status(201).json({<br/>      success: true,<br/>      message: 'Created successfully!',<br/>      leave: leave<br/>    });</span><span id="8848" class="mp ko iy ml b gy mu mr l ms mt">  } catch (err) {<br/>    if (!err.statusCode) {<br/>      err.statusCode = 500;<br/>    }<br/>    next(err);<br/>  }<br/>}<br/></span><span id="8610" class="mp ko iy ml b gy mu mr l ms mt">//To Delete Leave Request<br/>exports.delete = async (req, res, next) =&gt; {<br/>  const errors = validationResult(req);<br/>  const id = req.params.id;<br/>  const employeeID = req.userId;</span><span id="64c0" class="mp ko iy ml b gy mu mr l ms mt">  try {</span><span id="e668" class="mp ko iy ml b gy mu mr l ms mt">    if (!errors.isEmpty()) {<br/>      const error = new Error('Validation failed, entered data is incorrect.');<br/>      error.statusCode = 422;<br/>      throw error;<br/>    }</span><span id="460d" class="mp ko iy ml b gy mu mr l ms mt">    const leave = await Leave.findById(id);<br/>     <br/>    if (!leave) {<br/>      const error = new Error('Error fetching data');<br/>      error.statusCode = 422;<br/>      throw error;<br/>    }</span><span id="1830" class="mp ko iy ml b gy mu mr l ms mt">    if (employeeID.toString() !== leave.employee.toString()) {<br/>      const error = new Error('Unauthorized!');<br/>      error.statusCode = 401;<br/>      throw error;<br/>    }</span><span id="d67c" class="mp ko iy ml b gy mu mr l ms mt">    await Leave.findOneAndDelete(id);<br/>    const employee = await Employee.findById(employeeID);</span><span id="722a" class="mp ko iy ml b gy mu mr l ms mt">   //Remove leave from employee leave array    <br/>   <strong class="ml iz">goodist.pullOne(leave, employee.leave, employee);</strong></span><span id="88a7" class="mp ko iy ml b gy mu mr l ms mt">    res.status(200).json({<br/>      success: true,<br/>      message: 'Deleted successfully!'<br/>    });</span><span id="9ef9" class="mp ko iy ml b gy mu mr l ms mt">  } catch (err) {<br/>    if (!err.statusCode) {<br/>      err.statusCode = 500;<br/>    }<br/>    next(err);<br/>  }<br/>}</span></pre><blockquote class="mw mx my"><p id="8dd4" class="lf lg mz lh b li mb jz lk ll mc kc ln na md lq lr nb me lu lv nc mf ly lz ma ig bi translated">总之<strong class="lh iz"> goodist </strong>揭露4个有用的方法<strong class="lh iz"> pushOne </strong>、<strong class="lh iz"> pushMany </strong>、<strong class="lh iz"> pullOne </strong>和<strong class="lh iz"> pullMany </strong>。</p></blockquote><p id="5195" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">I .按一键在数组中添加一个项目。</p><p id="51e9" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">使用</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="c013" class="mp ko iy ml b gy mq mr l ms mt">const employee = await Employee.findById(employeeID);<br/>goodist.pushOne(leave, employee.leave, employee);</span></pre><p id="5212" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">二。<strong class="lh iz">拉动</strong>从数组中移除一个项目。</p><p id="5c87" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">使用</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="631a" class="mp ko iy ml b gy mq mr l ms mt">const employee = await Employee.findById(employeeID);<br/>goodist.pullOne(leave, employee.leave, employee);</span></pre><p id="c5d7" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">三。<strong class="lh iz"> pushMany </strong>一次在数组中添加多个项目。</p><p id="a9f8" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">使用</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="dcd3" class="mp ko iy ml b gy mq mr l ms mt">const employee = await Employee.findById(employeeID);<br/>goodist.pushMany(leave, employee.leave, employee);</span></pre><p id="cb7c" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">四。<strong class="lh iz"> pullMany </strong>一次从数组中移除多个项目。</p><p id="073f" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">使用</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="a7f2" class="mp ko iy ml b gy mq mr l ms mt">const employee = await Employee.findById(employeeID);<br/>goodist.pullMany(leave, employee.leave, employee);</span></pre><p id="0692" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">注意:</p><p id="ac26" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated"><strong class="lh iz">离开</strong> :-代表你要推送的内容。在我的例子中，它是离开对象</p><p id="0c93" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated"><strong class="lh iz"> employee.leave </strong> :-是一个数组，它代表你把项目推到了哪里。</p><p id="883c" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated"><strong class="lh iz"> employee </strong> :-是存放数组的对象，推送后必须重新保存。</p><p id="3e2f" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">使用<strong class="lh iz"> pushOne </strong>和<strong class="lh iz"> pullOne </strong>时，第一个参数必须是对象或字符串，而<strong class="lh iz"> pushMany </strong>和<strong class="lh iz"> pullMany </strong>期望第一个参数是数组。</p><p id="c3cd" class="pw-post-body-paragraph lf lg iy lh b li mb jz lk ll mc kc ln lo md lq lr ls me lu lv lw mf ly lz ma ig bi translated">谢谢你阅读我的文章。希望有帮助。</p></div></div>    
</body>
</html>