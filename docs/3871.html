<html>
<head>
<title>Use Twitch to Login to Your Chrome Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Twitch登录您的Chrome扩展</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-twitch-to-login-to-your-chrome-extension-4477dd6ec0d6?source=collection_archive---------7-----------------------#2020-10-30">https://javascript.plainenglish.io/use-twitch-to-login-to-your-chrome-extension-4477dd6ec0d6?source=collection_archive---------7-----------------------#2020-10-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="26e3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">允许你的用户使用他们的Twitch凭证登录你的Chrome扩展</p><p id="b099" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本教程使用了一个锅炉板谷歌浏览器扩展设置。<strong class="jm io">如果你想知道如何进行设置，请点击这里查看我的文章:</strong></p><div class="ki kj gp gr kk kl"><a href="https://anobjectisa.medium.com/how-does-a-chrome-extension-work-web-development-6e85bd2bccc1" rel="noopener follow" target="_blank"><div class="km ab fo"><div class="kn ab ko cl cj kp"><h2 class="bd io gy z fp kq fr fs kr fu fw im bi translated">Chrome扩展是如何工作的？(网络开发)</h2><div class="ks l"><h3 class="bd b gy z fp kq fr fs kr fu fw dk translated">Chrome扩展有5个部分:</h3></div><div class="kt l"><p class="bd b dl z fp kq fr fs kr fu fw dk translated">anobjectisa.medium.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz la kl"/></div></div></a></div></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi li"><img src="../Images/ff60c0801d18efc3b00b4e73f8845eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nUWSJYPolq0ixmTnvfuZIA.jpeg"/></div></div></figure><h1 id="2306" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">我们开始吧。</h1><p id="c881" class="pw-post-body-paragraph jk jl in jm b jn mr jp jq jr ms jt ju jv mt jx jy jz mu kb kc kd mv kf kg kh ig bi translated">在我们接触一行代码之前，我们需要设置我们的开发工作区，以便我们能够使用<strong class="jm io"> Twitch的OpenID端点</strong>。</p><p id="166b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">导航至https://dev.twitch.tv/console的'<a class="ae mw" href="https://dev.twitch.tv/console'" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">'</strong>'</a>并登录。</p><p id="b6c8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击<strong class="jm io">应用</strong>，然后<strong class="jm io">注册您的应用</strong>。</p><p id="49eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">填写'<strong class="jm io">名称</strong>，选择一个'<strong class="jm io">类别</strong>。</p><p id="fe1a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">添加一个“<strong class="jm io"> OAuth重定向URL</strong>”。会以<br/>"<strong class="jm io">https://&lt;chrome ext id&gt;. chromiumapp . org/</strong>的形式。</p><p id="7b2c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要找到你的chrome扩展id，在你的浏览器中导航到“<strong class="jm io"> chrome://extensions </strong>”，确保你的Chrome扩展已经加载。它会在那里。<br/>完成后，点击“<strong class="jm io">创建</strong>”。</p><p id="fe30" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击“<strong class="jm io">管理</strong>”，保留“<strong class="jm io">客户ID </strong>”，我们以后会用到。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h2 id="cc21" class="mx lu in bd lv my mz dn lz na nb dp md jv nc nd mh jz ne nf ml kd ng nh mp ni bi translated">在开始实际的Chrome扩展工作之前，让我们做一些web开发工作。</h2><p id="61f7" class="pw-post-body-paragraph jk jl in jm b jn mr jp jq jr ms jt ju jv mt jx jy jz mu kb kc kd mv kf kg kh ig bi translated">我们将创建两个页面。一个'<strong class="jm io">签到</strong>页和一个'<strong class="jm io">签退</strong>页。没什么特别的。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nj nk l"/></div></figure></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><p id="44a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们已经讨论了Web开发部分，让我们看看我们的“manifest.json”。</p><pre class="lj lk ll lm gt nl nm nn no aw np bi"><span id="0407" class="mx lu in nm b gy nq nr l ns nt">// manifest.json</span><span id="8d07" class="mx lu in nm b gy nu nr l ns nt">{<br/>    "name": "Twitch OpenID Connect Authentication Test",<br/>    "description": "Testing a Twitch login system.",<br/>    "version": "0.1.0",<br/>    "manifest_version": 2,<br/>    "icons": {<br/>        "16": "./obj-16x16.png",<br/>        "32": "./obj-32x32.png",<br/>        "48": "./obj-48x48.png",<br/>        "128": "./obj-128x128.png"<br/>    },<br/>    "background": {<br/>        "scripts": [<br/>            "./background.js",<br/>            "./jsrsasign-all-min.js"<br/>        ]<br/>    },<br/>    "options_page": "./options.html",<br/>    "browser_action": {<br/>        "default_popup": "popup.html"<br/>    },<br/>    "permissions": [<br/>        "identity"<br/>    ]<br/>}</span></pre><p id="6d96" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注:<br/> </strong> 1。<strong class="jm io"/><strong class="jm io">browser _ action</strong>的<strong class="jm io"> default_popup </strong>属性设置为页面中的<br/><strong class="jm io">标志。<br/> 2。为了使用Chrome的'<strong class="jm io"> launchWebAuthFlow() </strong>'方法，我们需要'<strong class="jm io"> identity </strong>'权限。</strong></p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="4e50" class="lt lu in bd lv lw nv ly lz ma nw mc md me nx mg mh mi ny mk ml mm nz mo mp mq bi translated">让我们做一些实际的Chrome扩展编程</h1><p id="a171" class="pw-post-body-paragraph jk jl in jm b jn mr jp jq jr ms jt ju jv mt jx jy jz mu kb kc kd mv kf kg kh ig bi translated">我们将从编写应用程序的基本框架逻辑流开始。</p><p id="55c0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在'<strong class="jm io"> popup-script.js </strong>中，当用户点击按钮时，我们会向'<strong class="jm io">后台</strong>脚本发送一条消息，要求“<strong class="jm io">登录</strong>”。</p><p id="8b22" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我们从'<strong class="jm io">背景</strong>'中得到一个“<strong class="jm io">成功</strong>”，我们将把页面更改为“<strong class="jm io">签出</strong>”页面。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="b19f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在'<strong class="jm io"> popup-script.js </strong>'中，当用户点击按钮时，我们会向'<strong class="jm io">后台</strong>'脚本发送消息给“<strong class="jm io">登录</strong>”。</p><p id="4191" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我们从'<strong class="jm io">背景</strong>中得到一个“<strong class="jm io">成功</strong>，我们将把页面改为“<strong class="jm io">签出</strong>页面。</p><p id="851b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在'<strong class="jm io"> popup-sign-out-script.js </strong>中，当用户点击按钮时，我们会向'<strong class="jm io">后台</strong>脚本发送一条消息，要求“<strong class="jm io">注销</strong>”。</p><p id="0ff6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果我们从'<strong class="jm io">背景</strong>中得到一个"<strong class="jm io">成功</strong>"，我们将把页面更改为页面中的"<strong class="jm io">标志。</strong></p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h1 id="cf03" class="lt lu in bd lv lw nv ly lz ma nw mc md me nx mg mh mi ny mk ml mm nz mo mp mq bi translated">让我们一起努力。</h1><p id="fee7" class="pw-post-body-paragraph jk jl in jm b jn mr jp jq jr ms jt ju jv mt jx jy jz mu kb kc kd mv kf kg kh ig bi translated">转到'<strong class="jm io"> background.js </strong>'脚本，我们创建一个条件树来捕获这些消息。</p><p id="6f67" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们需要6个常量和1个变量。当我们这样做时，一个变量跟踪用户的登录状态。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="6e86" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注:</strong> <br/> 1。<strong class="jm io"> CLIENT_ID </strong> —告诉<strong class="jm io"> Twitch </strong>我们被允许使用他们的<strong class="jm io"> OpenID </strong>端点<br/> 2。<strong class="jm io"> RESPONSE_TYPE </strong> —向<strong class="jm io"> Twitch </strong>询问特定类别的信息<br/> 3。<strong class="jm io"> REDIRECT_URI </strong> —给我们令牌后把用户重定向到哪里<br/> 4。<strong class="jm io">范围</strong> —向<strong class="jm io">抽动</strong>请求<strong class="jm io"> OpenID </strong>权限<br/> 5。<strong class="jm io">声明</strong> —告诉<strong class="jm io"> Twitch </strong>我们想要<br/> 6用户的哪些信息。<strong class="jm io">陈述</strong> —帮助个性化我们的<strong class="jm io"> OpenID </strong>请求</p><p id="0dd1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong> <br/>我们创建了一个函数将所有这些信息汇集在一起。我们在函数中创建了最后一个变量，<strong class="jm io"> nonce </strong>。nonce只是一个每当我们需要使用Twitch OpenID端点时随机生成的字符串。每次都需要不同。这就是它不是常数的原因。</p><p id="ab85" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当我们的'<strong class="jm io"> background.js </strong>'脚本得到消息要“<strong class="jm io">登录</strong>”时，我们将调用'<strong class="jm io">chrome . identity . launchwebauthflow()</strong>'函数。这需要两个参数。</p><p id="e4a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第一个对象为我们构造的<strong class="jm io"> OpenID </strong>端点和“<strong class="jm io"> interactive </strong>”标志提供true(这允许用户看到Twitch凭证提示)。</p><p id="78a8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第二个是回调函数，它从Twitch的服务器给我们一个'<strong class="jm io">重定向uri </strong>'。我们可以使用交付给我们的一个“<strong class="jm io">令牌</strong>”来访问登录用户的Twitch数据。</p><p id="eebd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本教程中，我们不会这样做；我们只是使用这个端点来"<strong class="jm io">认证</strong>用户，而不是"<strong class="jm io">授权</strong>我们。</p><p id="1d37" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意:</strong> <br/>除了检查“<strong class="jm io"> chrome.runtime </strong>”错误，我们还检查用户是否正确登录。</p><p id="699f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果没有，将在“<strong class="jm io"> redirect_url </strong>”中找到“<strong class="jm io"> error=access_denied </strong>”字符串。</p><p id="81bf" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了安全起见，我们检查我们收到的'<strong class="jm io"> id_token </strong>'的'<strong class="jm io"> iss </strong>和'<strong class="jm io"> aud </strong>'是否与我们应用程序的'<strong class="jm io"> Twitch </strong>端点和'<strong class="jm io">客户端ID </strong>'匹配。我们还每60分钟检查一次令牌是否有效。如果没有，我们“<strong class="jm io">转储</strong>它。</p></div><div class="ab cl lb lc hr ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ig ih ii ij ik"><h2 id="ebd5" class="mx lu in bd lv my mz dn lz na nb dp md jv nc nd mh jz ne nf ml kd ng nh mp ni bi translated">我们完了。</h2><p id="5a1d" class="pw-post-body-paragraph jk jl in jm b jn mr jp jq jr ms jt ju jv mt jx jy jz mu kb kc kd mv kf kg kh ig bi translated">当用户点击按钮中的<strong class="jm io">符号时，他们将会看到<strong class="jm io">抽动</strong>的登录系统。如果他们成功登录，他们将看到我们的“<strong class="jm io">注销</strong>”页面。</strong></p><p id="c9f6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你想要更深入的指导，可以看看我在YouTube上的完整视频教程，<strong class="jm io">一个物体就是一个</strong>。</p><p id="03ee" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一定要在<a class="ae mw" href="https://www.instagram.com/an_object_is_a/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Instagram </strong> </a>和<a class="ae mw" href="https://twitter.com/anobjectisa1" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> Twitter </strong> </a>上关注我们，及时了解我们最新的<strong class="jm io"> Web开发教程</strong>。</p><h2 id="0ada" class="mx lu in bd lv my mz dn lz na nb dp md jv nc nd mh jz ne nf ml kd ng nh mp ni bi translated">带有Chrome扩展的Twitch登录系统| OpenID Connect</h2><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="oa nk l"/></div></figure></div></div>    
</body>
</html>