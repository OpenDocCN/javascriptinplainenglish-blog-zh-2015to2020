<html>
<head>
<title>Angular Animation Callbacks and Key Frames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度动画回调和关键帧</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-animation-callbacks-and-key-frames-2d415d657b9d?source=collection_archive---------3-----------------------#2020-04-26">https://javascript.plainenglish.io/angular-animation-callbacks-and-key-frames-2d415d657b9d?source=collection_archive---------3-----------------------#2020-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a3b5223d859056480d7dfb9948035e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4acrDv59tRVukVo4"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@designbytholen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Regine Tholen</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7366" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Angular是Google制作的一个流行的前端框架。像其他流行的前端框架一样，它使用基于组件的架构来构建应用程序。</p><p id="484a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们来看看动画回调和关键帧。</p><h1 id="2faf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">动画回调</h1><p id="d186" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">动画<code class="fe me mf mg mh b">trigger</code>在开始和结束时发出回调。</p><p id="48d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码来记录事件的值:</p><p id="9db8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ee48" class="mq lc iq mh b gy mr ms l mt mu">import { Component, HostBinding } from "@angular/core";<br/>import {<br/>  trigger,<br/>  transition,<br/>  style,<br/>  animate,<br/>  state<br/>} from "@angular/animations";</span><span id="3083" class="mq lc iq mh b gy mv ms l mt mu">@Component({<br/>  selector: "app-root",<br/>  templateUrl: "./app.component.html",<br/>  styleUrls: ["./app.component.css"],<br/>  animations: [<br/>    trigger("openClose", [<br/>      state(<br/>        "true",<br/>        style({ height: "200px", opacity: 1, backgroundColor: "yellow" })<br/>      ),<br/>      state(<br/>        "false",<br/>        style({ height: "100px", opacity: 0.5, backgroundColor: "green" })<br/>      ),<br/>      transition("false &lt;=&gt; true", animate(500))<br/>    ])<br/>  ]<br/>})<br/>export class AppComponent {<br/>  onAnimationEvent(event: AnimationEvent) {<br/>    console.log(event);<br/>  }<br/>}</span></pre><p id="9818" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c466" class="mq lc iq mh b gy mr ms l mt mu">&lt;button (click)="show = !show"&gt;Toggle&lt;/button&gt;<br/>&lt;div<br/>  [@openClose]="show ? true: false"<br/>  (@openClose.start)="onAnimationEvent($event)"<br/>  (@openClose.done)="onAnimationEvent($event)"<br/>&gt;<br/>  {{show ? 'foo' : ''}}<br/>&lt;/div&gt;</span></pre><p id="caad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="bb6d" class="mq lc iq mh b gy mr ms l mt mu">(@openClose.start)="onAnimationEvent($event)"<br/>(@openClose.done)="onAnimationEvent($event)"</span></pre><p id="82aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分别在动画开始和结束时调用<code class="fe me mf mg mh b">onAnimationEvent</code>回调。</p><p id="223b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的<code class="fe me mf mg mh b">onAnimationEvent</code>回调中，我们记录了<code class="fe me mf mg mh b">event</code>参数的内容。</p><p id="5e50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它对调试很有用，因为它提供了关于动画的状态和元素的信息。</p><h1 id="740a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">关键帧</h1><p id="d1e9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在动画中添加关键帧来创建比两阶段动画更复杂的动画。</p><p id="1f28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以这样写:</p><p id="f424" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="65cc" class="mq lc iq mh b gy mr ms l mt mu">import { Component } from "@angular/core";<br/>import {<br/>  trigger,<br/>  transition,<br/>  style,<br/>  animate,  <br/>  keyframes<br/>} from "@angular/animations";</span><span id="0d72" class="mq lc iq mh b gy mv ms l mt mu">@Component({<br/>  selector: "app-root",<br/>  templateUrl: "./app.component.html",<br/>  styleUrls: ["./app.component.css"],<br/>  animations: [<br/>    trigger("openClose", [<br/>      transition('true &lt;=&gt; false', [<br/>        animate('2s', keyframes([<br/>          style({ backgroundColor: 'blue' }),<br/>          style({ backgroundColor: 'red' }),<br/>          style({ backgroundColor: 'orange' })<br/>        ]))<br/>    ])<br/>  ]<br/>})<br/>export class AppComponent {<br/>  onAnimationEvent(event: AnimationEvent) {<br/>    console.log(event);<br/>  }<br/>}</span></pre><p id="0b96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="978c" class="mq lc iq mh b gy mr ms l mt mu">&lt;button (click)="show = !show"&gt;Toggle&lt;/button&gt;<br/>&lt;div [@openClose]="show ? true: false"&gt;<br/>  {{show ? 'foo' : 'bar'}}<br/>&lt;/div&gt;</span></pre><p id="2073" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们在<code class="fe me mf mg mh b">AppComponent</code>中添加了不同风格的关键帧。</p><p id="2089" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们将按照为正向状态转换列出的顺序运行，为反向状态转换列出的顺序运行。</p><p id="b352" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们单击切换时，我们会看到颜色随着文本的变化而变化。</p><h1 id="b558" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">抵消</h1><p id="b72d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">关键帧包括一个偏移，该偏移定义动画中每次样式更改发生的点。</p><p id="cf52" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">偏移量是从零到一的相对度量。它们标志着动画的开始和结束。</p><p id="4949" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些是可选的。忽略偏移量时，会自动分配偏移量。</p><p id="2434" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以如下指定偏移:</p><p id="5b90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6fc2" class="mq lc iq mh b gy mr ms l mt mu">import { Component } from "@angular/core";<br/>import {<br/>  trigger,<br/>  transition,<br/>  style,<br/>  animate,  <br/>  keyframes<br/>} from "@angular/animations";</span><span id="15e6" class="mq lc iq mh b gy mv ms l mt mu">@Component({<br/>  selector: "app-root",<br/>  templateUrl: "./app.component.html",<br/>  styleUrls: ["./app.component.css"],<br/>  animations: [<br/>    trigger("openClose", [<br/>      transition('true &lt;=&gt; false', [<br/>        animate('2s', keyframes([<br/>          style({ backgroundColor: 'blue', offset: 0 }),<br/>          style({ backgroundColor: 'red', offset: 0.6 }),<br/>          style({ backgroundColor: 'orange', offset: 1 })<br/>        ]))<br/>    ])<br/>  ]<br/>})<br/>export class AppComponent {<br/>  onAnimationEvent(event: AnimationEvent) {<br/>    console.log(event);<br/>  }<br/>}</span></pre><p id="5c8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a8a0" class="mq lc iq mh b gy mr ms l mt mu">&lt;button (click)="show = !show"&gt;Toggle&lt;/button&gt;<br/>&lt;div [@openClose]="show ? true: false"&gt;<br/>  {{show ? 'foo' : 'bar'}}<br/>&lt;/div&gt;</span></pre><p id="2412" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们向我们的<code class="fe me mf mg mh b">style</code>参数对象添加了<code class="fe me mf mg mh b">offset</code>属性来改变颜色变化的时间。</p><p id="a4a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与之前相比，颜色变化应该在时间上稍微偏移。</p><h1 id="3f58" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">有脉动的关键帧</h1><p id="8fdd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用关键帧，通过在整个动画中的特定偏移处定义样式来创建脉冲效果。</p><p id="27f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要添加它们，我们可以按如下方式更改关键帧的不透明度:</p><p id="82c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="543d" class="mq lc iq mh b gy mr ms l mt mu">import { Component } from "@angular/core";<br/>import {<br/>  trigger,<br/>  transition,<br/>  style,<br/>  animate,  <br/>  keyframes<br/>} from "@angular/animations";</span><span id="6afb" class="mq lc iq mh b gy mv ms l mt mu">@Component({<br/>  selector: "app-root",<br/>  templateUrl: "./app.component.html",<br/>  styleUrls: ["./app.component.css"],<br/>  animations: [<br/>    trigger("openClose", [<br/>      transition('true &lt;=&gt; false', [<br/>        animate('1s', keyframes ( [<br/>          style({ opacity: 0.1, offset: 0.1 }),<br/>          style({ opacity: 0.6, offset: 0.2 }),<br/>          style({ opacity: 1,   offset: 0.5 }),<br/>          style({ opacity: 0.2, offset: 0.7 })<br/>        ]))<br/>    ])<br/>  ]<br/>})<br/>export class AppComponent {<br/>  onAnimationEvent(event: AnimationEvent) {<br/>    console.log(event);<br/>  }<br/>}</span></pre><p id="4fc3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d9db" class="mq lc iq mh b gy mr ms l mt mu">&lt;button (click)="show = !show"&gt;Toggle&lt;/button&gt;<br/>&lt;div [@openClose]="show ? true: false"&gt;<br/>  {{show ? 'foo' : 'bar'}}<br/>&lt;/div&gt;</span></pre><p id="708a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们有具有<code class="fe me mf mg mh b">opacity</code>和<code class="fe me mf mg mh b">offset</code>属性的<code class="fe me mf mg mh b">style</code>参数对象。</p><p id="4e1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">opacity</code>差异将产生脉动效果。</p><p id="0217" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">offset</code>将改变<code class="fe me mf mg mh b">opacity</code>变化的时间。</p><p id="49ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们点击切换，我们应该看到脉动效果。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/194c8bf95ba491d69b531d35a9ce9aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*10sMnKXjBejpUJ6H"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jfelise?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Josh Felise</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e2e6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用通配符的自动属性计算</h1><p id="5e41" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将CSS样式属性设置为通配符来进行自动计算。</p><p id="fc24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以使用通配符，如下所示:</p><p id="0dbc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.ts</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a8aa" class="mq lc iq mh b gy mr ms l mt mu">import { Component } from "@angular/core";<br/>import {<br/>  trigger,<br/>  transition,<br/>  style,<br/>  animate,<br/>  state<br/>} from "@angular/animations";</span><span id="512a" class="mq lc iq mh b gy mv ms l mt mu">@Component({<br/>  selector: "app-root",<br/>  templateUrl: "./app.component.html",<br/>  styleUrls: ["./app.component.css"],<br/>  animations: [<br/>    trigger("openClose", [<br/>      state("in", style({ height: "*" })),<br/>      transition("true =&gt; false", [<br/>        style({ height: "*", backgroundColor: "pink" }),<br/>        animate(250, style({ height: 0 }))<br/>      ]),<br/>      transition("false =&gt; true", [<br/>        style({ height: "*", backgroundColor: "yellow" }),<br/>        animate(250, style({ height: 0 }))<br/>      ])<br/>    ])<br/>  ]<br/>})<br/>export class AppComponent {<br/>  onAnimationEvent(event: AnimationEvent) {<br/>    console.log(event);<br/>  }<br/>}</span></pre><p id="6421" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app.component.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0d2e" class="mq lc iq mh b gy mr ms l mt mu">&lt;button (click)="show = !show"&gt;Toggle&lt;/button&gt;<br/>&lt;div [@openClose]="show ? true: false"&gt;<br/>  {{show ? 'foo' : 'bar'}}<br/>&lt;/div&gt;</span></pre><p id="019e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们将样式的<code class="fe me mf mg mh b">height</code>设置为通配符，因为我们不想将高度设置为固定高度。</p><p id="649f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们单击“切换”时，我们会看到颜色框随着动画的运行而增长和收缩。</p><h1 id="e6c4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="568d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以给动画添加回调来调试动画，因为我们可以在那里记录值。</p><p id="4602" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要制作更复杂的动画，我们可以使用关键帧。</p><p id="4af5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">偏移可用于更改动画关键帧的计时。</p><p id="fcfe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用通配符来自动设置CSS样式值。</p><h2 id="65e2" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="d1de" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物，表达对它们的爱:<a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a>，<a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a>，<a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！</p><p id="91d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果你有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，并附上你的中级用户名，我们会将你添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>