<html>
<head>
<title>Creating a Dev.to clone with React, Node, TypeScript, GraphQL and Apollo (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React、Node、TypeScript、GraphQL和Apollo创建要克隆的开发工具(第1部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/dev-to-clone-using-reactjs-nodejs-via-typescript-apollo-using-graphql-orm-environment-part-1-cf83f65e795d?source=collection_archive---------1-----------------------#2019-11-16">https://javascript.plainenglish.io/dev-to-clone-using-reactjs-nodejs-via-typescript-apollo-using-graphql-orm-environment-part-1-cf83f65e795d?source=collection_archive---------1-----------------------#2019-11-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="81dc" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">设置Graphql-ORM环境</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6cb193b60407384620c2dac91805b387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kshPMm94JwLG2j3jM04boA.png"/></div></div></figure><p id="0458" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你好社区，今天我试图用<strong class="kq io"> ReactJs </strong>和<strong class="kq io"> NodeJs </strong>将<strong class="kq io"> dev .克隆到</strong>网站。这将是一个原型，其中用户可以<strong class="kq io">注册/登录</strong>，创建后&amp;其他功能。</p><blockquote class="lk ll lm"><p id="235f" class="ko kp ln kq b kr ks jo kt ku kv jr kw lo ky kz la lp lc ld le lq lg lh li lj ig bi translated">我这样做只是为了学习。</p></blockquote><h1 id="d39c" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">技术堆栈:</h1><p id="9149" class="pw-post-body-paragraph ko kp in kq b kr mj jo kt ku mk jr kw kx ml kz la lb mm ld le lf mn lh li lj ig bi translated"><strong class="kq io"> NodeJs，ReactJs，Graphql，TypeOrm，TypeGraphql，Typescript，JWT，阿波罗服务器快递，Jest，阿波罗客户端，阿波罗链接&amp;更多..</strong></p><p id="a4c7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae mo" href="https://github.com/vinodchauhan7/dev.to-clone" rel="noopener ugc nofollow" target="_blank"> Git Hub开发。克隆链接</a></p><p id="9034" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae mo" href="https://medium.com/@vinodc45/dev-to-clone-using-reactjs-nodejs-via-typescript-apollo-using-graphql-orm-environment-part-1-cf83f65e795d" rel="noopener"> <em class="ln">第一部分</em></a><em class="ln">&amp;</em><a class="ae mo" href="https://medium.com/@vinodc45/dev-to-clone-using-reactjs-nodejs-via-typescript-apollo-using-refreshtoken-authentication-99fa89d567e9" rel="noopener"><em class="ln">第二部分</em> </a></p><p id="3db6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">首先，我刚刚开始使用typeorm安装typegraphql-typescript-node。到目前为止，我已经完成了jest设置的注册和登录功能。对于认证，我使用“JWT”。我正在使用<strong class="kq io"> bcryptjs </strong>保存密码，用于哈希目的。</p><p id="c71c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">对我来说，一步一步地进行是很困难的，因为这个系列文章可能会很大，所以我在git中创建了分支。到目前为止，我已经为以下目的在Git中创建了3个分支:</p><ul class=""><li id="1dcb" class="mp mq in kq b kr ks ku kv kx mr lb ms lf mt lj mu mv mw mx bi translated"><a class="ae mo" href="https://github.com/vinodchauhan7/dev.to-clone/tree/Part-1/server" rel="noopener ugc nofollow" target="_blank">第一部分(设置服务器)</a></li><li id="ffc8" class="mp mq in kq b kr my ku mz kx na lb nb lf nc lj mu mv mw mx bi translated"><a class="ae mo" href="https://github.com/vinodchauhan7/dev.to-clone/tree/Part-2/server" rel="noopener ugc nofollow" target="_blank">第2部分(添加测试设置的注册逻辑)</a></li><li id="b0b4" class="mp mq in kq b kr my ku mz kx na lb nb lf nc lj mu mv mw mx bi translated"><a class="ae mo" href="https://github.com/vinodchauhan7/dev.to-clone/tree/Part-3/server" rel="noopener ugc nofollow" target="_blank">第3部分(使用刷新令牌添加登录功能)</a></li></ul><blockquote class="lk ll lm"><p id="d9b6" class="ko kp ln kq b kr ks jo kt ku kv jr kw lo ky kz la lp lc ld le lq lg lh li lj ig bi translated">如果任何人在运行上述任何分支机构时遇到问题，请检查“主”分支机构，它将始终处于运行状态。</p></blockquote><h1 id="950e" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">项目结构:</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/f34cb72ada67b3a8e6c6e488acf2d58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lqg9j4NwHHe7Pu-Inm0jdw.png"/></div></div></figure><p id="4649" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Package.json</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="eae3" class="ni ls in ne b gy nj nk l nl nm">{<br/>    "name": "server",<br/>    "version": "1.0.0",<br/>    "main": "index.js",<br/>    "license": "MIT",<br/>    "dependencies": {<br/>        "apollo-server-express": "^2.9.6",<br/>        "bcryptjs": "^2.4.3",<br/>        "class-validator": "^0.10.1",<br/>        "dotenv": "^8.1.0",<br/>        "express": "^4.17.1",<br/>        "graphql": "^14.5.8",<br/>        "jsonwebtoken": "^8.5.1",<br/>        "pg": "^7.12.1",<br/>        "reflect-metadata": "^0.1.13",<br/>        "type-graphql": "^0.17.5",<br/>        "typeorm": "^0.2.19"<br/>    },<br/>    "devDependencies": {<br/>        "@types/bcryptjs": "^2.4.2",<br/>        "@types/express": "^4.17.1",<br/>        "@types/graphql": "^14.5.0",<br/>        "@types/jest": "^24.0.18",<br/>        "@types/jsonwebtoken": "^8.3.4",<br/>        "@types/node": "^12.7.12",<br/>        "jest": "^24.9.0",<br/>        "nodemon": "^1.19.3",<br/>        "ts-jest": "^24.1.0",<br/>        "ts-node": "^8.4.1",<br/>        "ts-node-dev": "^1.0.0-pre.43",<br/>        "typescript": "^3.6.4"<br/>    },<br/>    "scripts": {<br/>        "start": "ts-node-dev --respawn src/index.ts",<br/>        "db:setup": "ts-node ./src/test-utils/setup.ts",<br/>        "test": "npm run db:setup &amp;&amp; jest"<br/>    }<br/>}</span></pre><p id="78e7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我使用“yarn”包管理器来运行我所有的脚本。<br/> 1) yarn start(它将在localhost:4000/graphql上运行您的后端服务器)<br/> 2) yarn test(测试所有运行情况)</p><p id="e721" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Index.ts</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="b8e5" class="ni ls in ne b gy nj nk l nl nm">import "dotenv/config";<br/>import "reflect-metadata";<br/>import { ApolloServer } from "apollo-server-express";<br/>import Express from "express";<br/>import { createConnection } from "typeorm";<br/>import { createSchema } from "./utils/createSchema";<br/><br/>const server = async () =&gt; {<br/>  await createConnection();<br/><br/>  const schema = await createSchema();<br/><br/>  const apolloServer = new ApolloServer({<br/>    schema,<br/>    context: ({ req, res }) =&gt; ({ req, res })<br/>  });<br/><br/>  const app = Express();<br/><br/>  apolloServer.applyMiddleware({ app });<br/><br/>  app.listen(4000, () =&gt; {<br/>    console.log("Dev.to server started on localhost:4000/graphql");<br/>  });<br/>};<br/><br/>server();</span></pre><p id="4d56" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我用postgres作为我的数据库。。db的ormConfiguration将如下所示。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="c2c8" class="ni ls in ne b gy nj nk l nl nm">{<br/>    "type": "postgres",<br/>    "host": "localhost",<br/>    "port": 5432,<br/>    "username": "postgres",<br/>    "password": "root",<br/>    "database": "dev-to-clone",<br/>    "synchronize": true,<br/>    "logging": false,<br/>    "entities": [<br/>        "src/entity/*.*"<br/>    ]<br/>}</span></pre><p id="83ac" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了测试我的解析器，我使用jest和不同的db。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="2eef" class="ni ls in ne b gy nj nk l nl nm">import "dotenv/config";<br/>import "reflect-metadata";<br/>import { createConnection } from "typeorm";<br/>import { User } from "./../entity/User";<br/><br/>export const testConn = (drop: boolean = false) =&gt; {<br/>  return createConnection({<br/>    type: "postgres",<br/>    host: "localhost",<br/>    port: 5432,<br/>    username: "postgres",<br/>    password: "root",<br/>    database: "dev-to-clone-test",<br/>    synchronize: drop,<br/>    dropSchema: drop,<br/>    logging: false,<br/>    entities: [User]<br/>  });<br/>};</span></pre><p id="24d9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">到目前为止，我的“用户”实体具有以下属性，如果我将来需要操作它，我可以更新它们。</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="fa93" class="ni ls in ne b gy nj nk l nl nm">import { Entity, PrimaryGeneratedColumn, Column, BaseEntity } from "typeorm";<br/>import { ObjectType, Field, ID } from "type-graphql";<br/><br/>@ObjectType()<br/>@Entity()<br/>export class User extends BaseEntity {<br/>  @Field(() =&gt; ID)<br/>  @PrimaryGeneratedColumn()<br/>  id: number;<br/><br/>  @Field()<br/>  @Column()<br/>  name: string;<br/><br/>  @Field()<br/>  @Column("text", { unique: true })<br/>  email: string;<br/><br/>  @Column()<br/>  password: string;<br/><br/>  @Field()<br/>  @Column({ nullable: true, default: null })<br/>  workPlace?: string;<br/><br/>  @Field()<br/>  @Column({ nullable: true, default: null })<br/>  about?: string;<br/><br/>  @Field()<br/>  @Column({ nullable: true, default: null })<br/>  linkedIn?: string;<br/><br/>  @Field()<br/>  @Column({ nullable: true, default: null })<br/>  github?: string;<br/><br/>  @Field(() =&gt; [String])<br/>  @Column("simple-array", { nullable: true, default: null })<br/>  tags?: string[];<br/><br/>  @Field()<br/>  @Column()<br/>  joinedDate: string;<br/><br/>  @Field()<br/>  @Column({ nullable: true, default: null })<br/>  location?: string;<br/><br/>  @Field()<br/>  @Column({ nullable: true, default: null })<br/>  isActive?: boolean;<br/>}</span></pre><p id="8803" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一些快照包括:</p><h1 id="7c47" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">注册用户</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6cb193b60407384620c2dac91805b387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kshPMm94JwLG2j3jM04boA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk">Register Image</figcaption></figure><h1 id="d076" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">使用访问令牌登录:</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8c931bc9f1d6e90f50740e493887b835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0rCIkTx2LCaamE0ACeNjQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk">Login with Access Token</figcaption></figure><h1 id="4336" class="lr ls in bd lt lu lv lw lx ly lz ma mb jt mc ju md jw me jx mf jz mg ka mh mi bi translated">登录时刷新令牌。</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9d8c5e60ab23878e1098e72f5ac86f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kzUdtAkwDJPXH_T3dSBbug.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk">Refresh Token</figcaption></figure><p id="8221" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">试验结果</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/fda2f0098aac1b8e08773ca8cca9d347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hi2uJdLtBMxXkx3y8TpnaQ.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk">Test Result</figcaption></figure><p id="4228" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">那些不理解访问和刷新令牌逻辑的人，当我们使用React with Typescript &amp; Apollo覆盖它的前端部分时，就可以理解了。</p><p id="eefa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">直到那时再见社区，将尽快回来与其他功能。</p></div></div>    
</body>
</html>