<html>
<head>
<title>Beginner Drag-and-Drop Game with HTML, SCSS and JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学用HTML，SCSS和JS的拖放游戏</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/beginner-drag-and-drop-game-with-html-css-and-js-58653f974285?source=collection_archive---------1-----------------------#2020-07-20">https://javascript.plainenglish.io/beginner-drag-and-drop-game-with-html-css-and-js-58653f974285?source=collection_archive---------1-----------------------#2020-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7f09" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用HTML5 DnD API构建一个简单的游戏</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f183e550c4e7c0f3662096171a893dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OipRgPmJVolUKxFOGsfIZA.gif"/></div></div></figure><p id="bd40" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个简短的教程将教你如何使用HTML5 API构建一个简单的拖放游戏。<a class="ae ln" href="https://codepen.io/andreeamaco/pen/qBbLdjY" rel="noopener ugc nofollow" target="_blank">密码笔在这里</a>。</p><p id="94bc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">DnD行为是HTML5固有的，所以您可以使用API，而不是试图用jQuery之类的工具来寻找变通方法。</p><p id="ce01" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从大图开始:在任何拖放应用程序中，你都会有可拖动的元素，就像上面的图片，以及拖放区。在这个游戏中，我们有两种类型的拖放区:</p><ul class=""><li id="d814" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">顶部的盒子里有动物的名字</li><li id="3fe1" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">底部的容器，动物图像在开始的地方</li></ul><p id="20ec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只要在HTML代码中添加一个属性，页面的任何元素都可以拖动，如下所示:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="081f" class="mh mi iq md b gy mj mk l ml mm">&lt;img id="cat" src="<a class="ae ln" href="https://www.veterinarypracticenews.com/wp-content/uploads/2019/10/bigstock-Four-Kittens-On-A-White-Backgr-2730282.jpg" rel="noopener ugc nofollow" target="_blank">https://www.veterinarypracticenews.com/wp-content/uploads/2019/10/bigstock-Four-Kittens-On-A-White-Backgr-2730282.jpg</a>" draggable="true" ondragstart="drag(event)" width="300"&gt;</span></pre><p id="b3b8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注意，猫图片有一个名为<code class="fe mn mo mp md b">draggable</code>的属性，它被设置为<code class="fe mn mo mp md b">true</code>。</p><p id="4338" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，为了在开始拖动元素时启用一个行为，我们需要在可拖动节点上添加一个事件侦听器。</p><p id="b0ac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">DnD API允许以下事件:</p><ul class=""><li id="1010" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated"><code class="fe mn mo mp md b">ondragstart</code> -当您开始拖动元素时，该事件触发</li><li id="05a2" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><code class="fe mn mo mp md b">ondragend</code> -拖动动作完成时触发此事件</li><li id="d3dc" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><code class="fe mn mo mp md b">ondragenter</code> -当可拖动元素被移动到放置区域时，该事件被触发</li><li id="24f2" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><code class="fe mn mo mp md b">ondragover</code> -当你拖动一个元素到拖放区域时，这个事件被触发</li><li id="19c1" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><code class="fe mn mo mp md b">ondragleave</code> -这与<code class="fe mn mo mp md b">ondragenter</code>相反，当可拖动元素被拖出拖放区域时触发</li><li id="5343" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><code class="fe mn mo mp md b">ondrop</code> -当您将元素放入放置区域时，此事件触发</li></ul><p id="baa9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">前两个应用于可拖动元素，后四个与拖放区有关。</p><p id="d88b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以这是你在创作这个游戏时需要思考的问题。首先，您需要使元素可拖动。我已经在上面展示了如何做到这一点。</p><p id="5470" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下一步是将所需的事件侦听器附加到draggable元素。在我们的例子中，我们希望在开始拖动图像时发生一些事情，所以我们将添加以下内容:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="a87e" class="mh mi iq md b gy mj mk l ml mm">// on the image, we add ondragstart="drag(event)"</span><span id="1861" class="mh mi iq md b gy mq mk l ml mm">&lt;img id="cat" src="<a class="ae ln" href="https://www.veterinarypracticenews.com/wp-content/uploads/2019/10/bigstock-Four-Kittens-On-A-White-Backgr-2730282.jpg" rel="noopener ugc nofollow" target="_blank">https://www.veterinarypracticenews.com/wp-content/uploads/2019/10/bigstock-Four-Kittens-On-A-White-Backgr-2730282.jpg</a>" draggable="true" ondragstart="drag(event)" width="300"&gt;</span><span id="6a6c" class="mh mi iq md b gy mq mk l ml mm">// in our JS file, we define the drag() function</span><span id="873d" class="mh mi iq md b gy mq mk l ml mm">function drag(event) {<br/>   event.dataTransfer.setData("text", event.target.id);<br/>}</span></pre><p id="abc4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当您开始拖动图像时，会调用<code class="fe mn mo mp md b">drag(event)</code>函数。在这个函数中，<code class="fe mn mo mp md b">dataTransfer</code>属性保存事件的数据，并带有管理被拖动数据的特定方法。</p><p id="3884" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面使用的方法<code class="fe mn mo mp md b">setData()</code>用于向拖动的数据添加一个项目。您可以使用不同类型的数据，被拖动数据的值由<code class="fe mn mo mp md b">event.target.id</code>定义。</p><p id="4c7d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们已经完成了draggable元素，所以我们可以继续到拖放区。首先，我们希望这些区域接受孩子，当我们掉东西的时候。所以我们需要指出应该发生的事情:</p><ul class=""><li id="8e8f" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">当我们将一个元素拖动到拖放区的顶部时</li><li id="4912" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">当我们将元素放入放置区域时</li></ul><p id="e2b5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了定义拖放区，我们使用了<code class="fe mn mo mp md b">ondragover</code>事件。</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="d07e" class="mh mi iq md b gy mj mk l ml mm">&lt;div id="animals" ondrop="drop(event)" ondragover="allowDrop(event)"&gt;</span></pre><p id="6acb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这两个JS函数如下所示:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="43d2" class="mh mi iq md b gy mj mk l ml mm">function allowDrop(event) {<br/>  event.preventDefault();<br/>}</span><span id="93dc" class="mh mi iq md b gy mq mk l ml mm">function drop(event) {<br/>  event.preventDefault();<br/>  var data = event.dataTransfer.getData("text");<br/>  event.target.appendChild(document.getElementById(data));<br/>}</span></pre><p id="ebb3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们使用<code class="fe mn mo mp md b">event.preventDefault()</code>来取消这些div的默认行为。我们这样做是因为默认情况下一个元素不能被放到另一个元素中，但是我们希望它可以。</p><p id="f0e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，为了表明一个区域可以接受可拖动的元素，我们使用了<code class="fe mn mo mp md b">allowDrop()</code>函数。然后，为了指示当我们放下图片时应该发生什么，我们使用了<code class="fe mn mo mp md b">drop()</code>函数。</p><p id="80c1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就像以前一样，我们正在防止默认行为，并提到可以放入拖放区的数据类型。然后，我们将图像添加到拖放区域，一旦拖放。</p><p id="f953" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是最终的代码:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="362f" class="mh mi iq md b gy mj mk l ml mm">// HTML</span><span id="e2ba" class="mh mi iq md b gy mq mk l ml mm">&lt;div id="dropZone"&gt;<br/>  &lt;div<br/>    id="dropBox1"<br/>    ondrop="drop(event)"<br/>    ondragover="allowDrop(event)"<br/>  &gt;<br/>    &lt;p&gt;Fish&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  &lt;div<br/>    id="dropBox2"<br/>    ondrop="drop(event)"<br/>    ondragover="allowDrop(event)"<br/>  &gt;<br/>    &lt;p&gt;Mouse&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  &lt;div<br/>    id="dropBox3"<br/>    ondrop="drop(event)"<br/>    ondragover="allowDrop(event)"<br/>  &gt;<br/>    &lt;p&gt;Cat&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  &lt;div<br/>    id="dropBox4"<br/>    ondrop="drop(event)"<br/>    ondragover="allowDrop(event)"<br/>  &gt;<br/>    &lt;p&gt;Dog&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span><span id="f11f" class="mh mi iq md b gy mq mk l ml mm">&lt;div<br/>  id="animals"<br/>  ondrop="drop(event)"<br/>  ondragover="allowDrop(event)"<br/>&gt;<br/>  &lt;img<br/>    id="cat"<br/>    src="<a class="ae ln" href="https://www.veterinarypracticenews.com/wp-content/uploads/2019/10/bigstock-Four-Kittens-On-A-White-Backgr-2730282.jpg" rel="noopener ugc nofollow" target="_blank">https://www.veterinarypracticenews.com/wp-content/uploads/2019/10/bigstock-Four-Kittens-On-A-White-Backgr-2730282.jpg</a>"<br/>    draggable="true"<br/>    ondragstart="drag(event)"<br/>    width="300"<br/>  /&gt;</span><span id="05c2" class="mh mi iq md b gy mq mk l ml mm">&lt;img<br/>    id="dog"<br/>    src="<a class="ae ln" href="https://www.wallpaperflare.com/static/800/62/574/puppies-white-background-paws-yellow-wallpaper-preview.jpg" rel="noopener ugc nofollow" target="_blank">https://www.wallpaperflare.com/static/800/62/574/puppies-white-background-paws-yellow-wallpaper-preview.jpg</a>"<br/>    draggable="true"<br/>    ondragstart="drag(event)"<br/>    width="300"<br/>  /&gt;</span><span id="6d50" class="mh mi iq md b gy mq mk l ml mm">&lt;img<br/>    id="mouse"<br/>    src="<a class="ae ln" href="https://www.adamspestcontrol.com/cms-files/size-992x992/adams-mouse-600x600.jpg" rel="noopener ugc nofollow" target="_blank">https://www.adamspestcontrol.com/cms-files/size-992x992/adams-mouse-600x600.jpg</a>"<br/>    draggable="true"<br/>    ondragstart="drag(event)"<br/>    width="300"<br/>  /&gt;</span><span id="20f7" class="mh mi iq md b gy mq mk l ml mm">&lt;img<br/>    id="fish"<br/>    src="<a class="ae ln" href="https://cdn.mos.cms.futurecdn.net/uhLVL2jTdtQ7ScXCeoeAU6-650-80.jpg.webp" rel="noopener ugc nofollow" target="_blank">https://cdn.mos.cms.futurecdn.net/uhLVL2jTdtQ7ScXCeoeAU6-650-80.jpg.webp</a>"<br/>    draggable="true"<br/>    ondragstart="drag(event)"<br/>    width="300"<br/>  /&gt;<br/>&lt;/div&gt;</span></pre><p id="cb57" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，款式:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="9c86" class="mh mi iq md b gy mj mk l ml mm">// SCSS</span><span id="9c81" class="mh mi iq md b gy mq mk l ml mm">#dropZone,<br/>#animals {<br/>  display: flex;<br/>  flex-flow: row nowrap;<br/>  justify-content: space-between;<br/>  min-height: 200px;<br/>  margin-bottom: 20px;<br/>}</span><span id="35a4" class="mh mi iq md b gy mq mk l ml mm">#dropBox1,<br/>#dropBox2,<br/>#dropBox3,<br/>#dropBox4 {<br/>  display: flex;<br/>  flex-flow: column nowrap;<br/>  justify-content: center;<br/>  align-items: center;<br/>  height: 250px;<br/>  width: 250px;<br/>  border: 1px solid #aaaaaa;<br/>  padding: 1rem;<br/>}</span><span id="62c3" class="mh mi iq md b gy mq mk l ml mm">img {<br/>  height: 200px;<br/>  object-fit: cover;<br/>  width: 200px;<br/>}</span></pre><p id="83f6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，JavaScript代码:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="5c8d" class="mh mi iq md b gy mj mk l ml mm">// JS</span><span id="6823" class="mh mi iq md b gy mq mk l ml mm">function allowDrop(event) {<br/>  event.preventDefault();<br/>}</span><span id="ffc4" class="mh mi iq md b gy mq mk l ml mm">function drag(event) {<br/>  event.dataTransfer.setData("text", event.target.id);<br/>}</span><span id="7806" class="mh mi iq md b gy mq mk l ml mm">function drop(event) {<br/>  event.preventDefault();<br/>  var data = event.dataTransfer.getData("text");<br/>  event.target.appendChild(document.getElementById(data));<br/>}</span></pre><p id="c683" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这里你可以找到代码。我希望你喜欢它！</p></div></div>    
</body>
</html>