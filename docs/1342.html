<html>
<head>
<title>Comparing different ways to make HTTP requests in Javascript in 2020</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比较2020年用Javascript发出HTTP请求的不同方式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/comparing-different-ways-to-make-http-requests-in-javascript-39ab0f090788?source=collection_archive---------0-----------------------#2020-03-04">https://javascript.plainenglish.io/comparing-different-ways-to-make-http-requests-in-javascript-39ab0f090788?source=collection_archive---------0-----------------------#2020-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c74f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">简洁而有用——让它变得简单。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6b424bcba20ddd192d8c6cd0e1e1026f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LeYBjLHr6kmYIoSx-aHdDA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image of two monitors with code in their screens</figcaption></figure><p id="39dd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最近，我不得不决定一个大型javascript项目使用什么技术来进行ajax调用。如果您使用JavaScript，您有不同的机会发出呼叫请求。</p><p id="bae3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最初，有一些方法可以在不刷新页面的情况下从服务器中提取数据，但是它们通常依赖于笨拙的技术。微软开发了XMLHttpRequest浏览器来替代他们的Outlook电子邮件客户端。XMLHttpRequest在2006年成为web标准。</p><p id="84fe" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Fetch API是ES6在2015年推出的。通用的请求和响应接口提供了一致性，而Promises允许更简单的链接和异步/等待，无需回调。Fetch干净、优雅、易于理解，但是还有其他好的替代方法，我们将在本文中简要介绍它们。</p><p id="059b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了简单起见，我将把重点放在它们是什么、它们的语法以及每种选择的优缺点上。</p><ul class=""><li id="026c" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">XMLHttpRequest</li><li id="855e" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">JQuery.ajax</li><li id="2a8b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Qwest</li><li id="fa1f" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">超级代理</li><li id="e1e4" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Http客户端</li><li id="9b3f" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Axios</li><li id="db13" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">取得</li><li id="7e3d" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">既然已经弃用，我就不说了。</li></ul><p id="8a1e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的代码显示了使用不同替代方法的基本HTTP GET和POST示例。那我们开始吧。</p><h1 id="966a" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">XMLHttpRequest</h1><p id="a87c" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">XMLHttpRequest对象可用于从web服务器请求数据。它是这种比较的最古老的方法，尽管其他选项超过了它，但由于它的向后兼容性和成熟度，它仍然是有效和有用的。</p><p id="91cd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="1d48" class="nh mg iq nd b gy ni nj l nk nl">var req = new XMLHttpRequest();</span><span id="eae9" class="nh mg iq nd b gy nm nj l nk nl">//The onreadystatechange property<br/>//specifies a function to be <br/>//executed every time the status<br/>//of the XMLHttpRequest changes<br/>req.onreadystatechange = function() {<br/>    if (this.readyState == 4 &amp;&amp; this.status == 200) {<br/>       //The responseText property<br/>       //returns a text string           <br/>       console.log(xhttp.responseText)<br/>       //Do some stuff<br/>    }<br/>};</span><span id="ac1e" class="nh mg iq nd b gy nm nj l nk nl">req.open("GET", "http://dataserver/users", true);<br/>req.send();</span></pre><p id="5389" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="2e80" class="nh mg iq nd b gy ni nj l nk nl">var formData = new FormData();<br/>formData.append("name", "Murdock");<br/>var req = new XMLHttpRequest();<br/>req.open("POST", "http://dataserver/update");<br/>req.send(formData);</span></pre><p id="9028" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="fbb5" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">在所有浏览器中工作</li><li id="43e4" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">是一个本地浏览器API</li><li id="fd4a" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">没有必要从外部源加载它</li><li id="1c57" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">向后兼容性</li><li id="998e" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">成熟/稳定</li></ul><p id="5d7a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="44d1" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">笨拙而冗长的语法</li><li id="4b91" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">支持回调地狱</li><li id="4505" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Fetch会自动替换它</li></ul><h1 id="987c" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">JQuery.ajax</h1><p id="f502" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">直到不久前，库还被广泛用于进行HTTP异步请求。</p><p id="120a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">jQuery的所有Ajax方法都返回XMLHTTPRequest对象的超集</p><p id="2d52" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="08f4" class="nh mg iq nd b gy ni nj l nk nl">$.ajax({<br/>    url: 'http://dataserver/data.json'<br/>  }).done(function(data) {<br/>    // ...do some stuff whith data<br/>  }).fail(function() {<br/>    // Handle error<br/>});</span></pre><p id="ea82" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="2231" class="nh mg iq nd b gy ni nj l nk nl">$.ajax({<br/>  type: "POST",<br/>  url: 'http://dataserver/update',<br/>  data: data,<br/>  success: successCallBack,<br/>  error: errorCallBack,<br/>  dataType: dataType<br/>});</span></pre><p id="fb3b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="75ca" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">良好的支持和文档</li><li id="e41c" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">可配置对象</li><li id="c420" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">很多项目都是如此</li><li id="ba59" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">低学习曲线</li><li id="9627" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">您可以中止请求，因为它返回一个XMLHttpRequest对象。</li></ul><p id="00d6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="a7be" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">没有什么是本土</li><li id="4a6b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">有必要从外部源加载它</li><li id="ff1d" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">添加了所有的JQuery功能，而不仅仅是那些进行HTTP请求所必需的功能。</li></ul><h2 id="2f02" class="nh mg iq bd mh nn no dn ml np nq dp mp le nr ns mr li nt nu mt lm nv nw mv nx bi translated">Qwest</h2><p id="3cd6" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">Qwest是一个基于promises的简单ajax库，支持XmlHttpRequest2独特的数据，如ArrayBuffer、Blob和FormData。</p><p id="61bb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="5c70" class="nh mg iq nd b gy ni nj l nk nl">qwest.get('http://dataserver/data.json')<br/>     .then(function(xhr, response) {<br/>        // ...do some stuff whith data<br/>     });</span></pre><p id="0c66" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="d5d3" class="nh mg iq nd b gy ni nj l nk nl">qwest.post('http://dataserver/update', {<br/>        firstname: 'Murdock',       <br/>        age: 30<br/>     })<br/>     .then(function(xhr, response) {<br/>        // Make some useful actions<br/>     })<br/>     .catch(function(e, xhr, response) {<br/>        // Process the error<br/>     });</span></pre><p id="69bc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="d6b1" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">您可以建立一个请求限制</li><li id="8ed9" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">基于承诺的</li></ul><p id="bf02" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="aaed" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">XmlHttpRequest2并非在每个浏览器上都可用</li><li id="8670" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">没有什么是本土</li><li id="f0ec" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">有必要从外部源加载它</li></ul><h2 id="72fb" class="nh mg iq bd mh nn no dn ml np nq dp mp le nr ns mr li nt nu mt lm nv nw mv nx bi translated">超级代理</h2><p id="a7e9" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">SuperAgent是为灵活性、可读性和低学习曲线而创建的ajax API。它也适用于Node.js</p><p id="51c8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="700a" class="nh mg iq nd b gy ni nj l nk nl">request('GET', 'http://dataserver/data.json').then(<br/>success, failure);</span></pre><p id="b9d5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">的。query()方法接受对象，这些对象在与GET方法一起使用时将形成一个查询字符串。下面将产生路径/dataserver/search？名字=曼尼&amp;姓氏=佩克&amp;订单=desc。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="64f4" class="nh mg iq nd b gy ni nj l nk nl">request<br/>   .get('/dataserver/search')<br/>   .query({ name: 'Templeton' })<br/>   .query({ lastname: 'Peck' })<br/>   .query({ order: 'desc' })<br/>   .then(res =&gt; {console.dir(res)}<br/>});</span></pre><p id="d3d9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="1ac9" class="nh mg iq nd b gy ni nj l nk nl">request<br/>   .post('http://dataserver/update')<br/>   .send({ name: 'Murdock' })<br/>   .set('Accept', 'application/json')<br/>   .then(res =&gt; {<br/>      console.log('result' + JSON.stringify(res.body));<br/>   });</span></pre><p id="213b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="7edf" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">基于承诺的</li><li id="b721" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">适用于Nodejs和浏览器</li><li id="ba13" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">若要中止请求，请调用request.abort()方法</li><li id="619e" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">社区里有名的图书馆</li><li id="bd18" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">无缝接口进行HTTP请求</li><li id="07d5" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">出现故障时支持重试请求</li></ul><p id="e569" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="bbb1" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">它不支持像XMLHttpRequest那样监控加载进度</li><li id="af83" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">没有什么是本土</li><li id="85c8" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">有必要从外部源加载它</li></ul><h2 id="d272" class="nh mg iq bd mh nn no dn ml np nq dp mp le nr ns mr li nt nu mt lm nv nw mv nx bi translated">Http客户端</h2><p id="1154" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">Http-client允许您使用JavaScript的fetch API构建Http客户端。</p><p id="8e66" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="e2be" class="nh mg iq nd b gy ni nj l nk nl">//using ES6 modules<br/>import { createFetch, base, accept, parse } from 'http-client'</span><span id="1e4c" class="nh mg iq nd b gy nm nj l nk nl">const fetch = createFetch(<br/>  base('http://dataserver/data.json'),  <br/>  accept('application/json'),     <br/>  parse('json')                      <br/>)</span><span id="6f60" class="nh mg iq nd b gy nm nj l nk nl">fetch('http://dataserver/data.json').then(response =&gt; {<br/>  console.log(response.jsonData)<br/>})</span></pre><p id="2d48" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="d9e8" class="nh mg iq nd b gy ni nj l nk nl">//using ES6 modules<br/>import { createFetch, method, params } from 'http-client'</span><span id="4c61" class="nh mg iq nd b gy nm nj l nk nl">const fetch = createFetch(<br/>  params({ name: 'Murdock' }),<br/>  base('http://dataserver/update')<br/>)</span></pre><p id="bb2e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="836f" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">它在浏览器和节点上都可以工作</li><li id="0a86" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">由服务人员使用</li><li id="9222" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">基于承诺的</li><li id="59eb" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">为更好的CORS安全性提供头部防护</li></ul><p id="b0b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="f4cf" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">没有什么是本土</li><li id="5154" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">有必要从外部源加载它</li></ul><h1 id="1b0c" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">Axios</h1><p id="ecef" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">基于Promise的HTTP库，用于在浏览器和Nodejs上执行HTTP请求。</p><p id="af08" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="7ba1" class="nh mg iq nd b gy ni nj l nk nl">axios({<br/>  url: 'http://dataserver/data.json',<br/>  method: 'get'<br/>})</span></pre><p id="50b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="8478" class="nh mg iq nd b gy ni nj l nk nl">axios.post('http://dataserver/update', {<br/>    name: 'Murdock'<br/>  })<br/>  .then(function (response) {<br/>    console.log(response);<br/>  })<br/>  .catch(function (error) {<br/>    console.log(error);<br/>  });</span></pre><p id="d71d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="b814" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">使用承诺来避免回调地狱</li><li id="85bf" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">它在浏览器和节点上都可以工作</li><li id="69b2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">支持上传进度</li><li id="1ab7" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">可以设置响应超时</li><li id="516a" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">通过简单地传递一个配置对象来配置您的请求</li><li id="6779" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Axios已经实施了可取消承诺提案</li><li id="a091" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">自动将数据转换成JSON</li></ul><p id="8e78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="6709" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">没有什么是本土</li><li id="7c7f" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">有必要从外部源加载它</li></ul><h1 id="ad4c" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">取得</h1><p id="1529" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">Fetch是一个本地浏览器API，用来发出一个请求，代替XMLHttpRequest。Fetch使得网络请求比XMLHttpRequest更容易。Fetch API使用承诺来避免XMLHttpRequest回调地狱。</p><p id="1d50" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="e2f2" class="nh mg iq nd b gy ni nj l nk nl">//With ES6 fetch<br/>fetch('http://dataserver/data.json')<br/>  .then(data =&gt; {<br/>    // ...do some stuff whith data<br/>  }).catch(error =&gt; {<br/>    // Handle error<br/>});</span></pre><p id="118b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">邮政</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="ea1e" class="nh mg iq nd b gy ni nj l nk nl">fetch('http://dataserver/update', {<br/>  method: 'post',<br/>  headers: {<br/>    'Accept': 'application/json, text/plain, */*',<br/>    'Content-Type': 'application/json'<br/>  },<br/>  body: JSON.stringify({name: 'Murdock'})<br/>}).then(res=&gt;res.json())<br/>  .then(res =&gt; console.log(res));</span><span id="99e7" class="nh mg iq nd b gy nm nj l nk nl">//OR with ES2017 for example</span><span id="455b" class="nh mg iq nd b gy nm nj l nk nl">(async () =&gt; {<br/>  <br/>  const response = await fetch(‘http://dataserver/update’, {<br/>    method: ‘POST’,<br/>    headers: {<br/>      ‘Accept’: ‘application/json’,<br/>      ‘Content-Type’: ‘application/json’<br/>    },<br/>    body: JSON.stringify({name:’Murdock’})<br/>  });</span><span id="3145" class="nh mg iq nd b gy nm nj l nk nl">const result = await response.json();</span><span id="a73a" class="nh mg iq nd b gy nm nj l nk nl">console.log(result);<br/>})();</span></pre><p id="ed73" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">赞成的意见</p><ul class=""><li id="a7c7" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">是一个本地浏览器API</li><li id="5f17" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Fetch基本上是XMLHttpRequest做对了</li><li id="eca2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">不需要从外部源加载它</li><li id="0dee" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">使用承诺来避免回调地狱</li><li id="4055" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">不需要更多的依赖</li><li id="c6f4" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">友好且易于学习</li><li id="f485" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">兼容最近常用的大多数浏览器</li><li id="a899" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">是本机XMLHttpRequest对象的自然替换</li><li id="dcd0" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">低学习曲线</li></ul><p id="676d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">骗局</p><ul class=""><li id="e2a6" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">在处理JSON数据时，这是一个两步过程。第一个是发出请求，第二个是调用。响应上的json()方法。在Axios上，默认情况下会得到JSON响应。</li><li id="3089" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">从Fetch()返回的承诺仅在网络故障或任何阻止请求完成的情况下被拒绝。即使响应是HTTP 404或500，也不会拒绝HTTP错误状态</li><li id="a43a" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">缺少其他库的一些有用的特性，例如:取消请求</li><li id="74b2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">默认情况下，Fetch不会发送或接收来自服务器的cookies，如果站点依赖于维护用户会话，则会导致未经验证的请求。但是您可以通过添加{ <br/>凭证来启用:“同源。”<br/> }</li></ul><h2 id="621b" class="nh mg iq bd mh nn no dn ml np nq dp mp le nr ns mr li nt nu mt lm nv nw mv nx bi translated">结论</h2><p id="1571" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">Fetch是新标准，新版本的Chrome和Firefox都支持它，不需要使用任何额外的库。</p><p id="9556" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">建议花些时间了解Axios、SuperAgent或其他库的特征，因为它们都有适当的文档，易于使用，并且它们的学习曲线不会太长。在某些情况下，它们提供没有Fetch的特性。</p><p id="859b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我的例子中，我将使用Fetch，因为我不需要特殊的功能，Fetch在JavaScript中是原生的，对我的项目来说足够了。</p><p id="7c70" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，可以考虑通过我的<a class="ae ny" href="https://kesk.medium.com/membership" rel="noopener">个人资料</a>订阅Medium。谢谢大家！</p></div></div>    
</body>
</html>