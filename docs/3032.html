<html>
<head>
<title>Node.js Best Practices — Modern Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js最佳实践—现代特性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-js-best-practices-modern-features-3165f75595fb?source=collection_archive---------5-----------------------#2020-08-21">https://javascript.plainenglish.io/node-js-best-practices-modern-features-3165f75595fb?source=collection_archive---------5-----------------------#2020-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a7562a35e73b842eef5d889a8a847a15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XStMkHk0ItiiWq_T"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@kalenemsley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kalen Emsley</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7254" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看在编写节点应用程序时应该遵循的一些最佳实践。</p><h1 id="5f37" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用ES2015+</h1><p id="8572" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">从v4开始，Node就支持E2015和更高版本的功能。</p><p id="47d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们可以在非常早期的版本中使用这些特性。</p><p id="c883" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在没有理由不使用它们。</p><p id="9620" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不需要Babel来使用最新的功能。</p><p id="2b6a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">阶段4的大部分功能都是可用的。</p><p id="a318" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们不确定我们的Node版本是否支持我们想要的功能，我们可以检查<a class="ae kc" href="http://node.green/" rel="noopener ugc nofollow" target="_blank"> node.green </a>来确定。</p><h1 id="6d33" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用承诺</h1><p id="6920" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">承诺让我们以干净的方式编写异步代码。</p><p id="1c11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们让我们的生活变得容易多了。</p><p id="80ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而不是写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="540c" class="mn lc iq mj b gy mo mp l mq mr">fs.readFile('./foo.json', 'utf-8', (err, data) =&gt; {<br/>  if (err) {<br/>    return console.log(err)<br/>  }</span><span id="65fa" class="mn lc iq mj b gy ms mp l mq mr">  try {<br/>    JSON.parse(data)<br/>  } catch (ex) {<br/>    return console.log(ex)<br/>  }<br/>  console.log(data.name)<br/>})</span></pre><p id="ad7a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e1b2" class="mn lc iq mj b gy mo mp l mq mr">import * as Promise from "bluebird";<br/>const fs = Promise.promisifyAll(require("fs"));</span><span id="b929" class="mn lc iq mj b gy ms mp l mq mr">fs.readFileAsync('./foo.json')<br/>.then(JSON.parse)<br/>.then((data) =&gt; {<br/>  console.log(data.name)<br/>})<br/>.catch((e) =&gt; {<br/>  console.error('error reading file', e)<br/>})</span></pre><p id="dc54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这要干净得多，因为多重承诺的嵌套更少了。</p><p id="c6e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用Bluebird来承诺整个fs模块，所以我们可以使用所提供方法的承诺版本。</p><h1 id="c701" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用JavaScript标准样式</h1><p id="3816" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了让每个人的生活更轻松，我们可以对JavaScript代码使用标准样式。</p><p id="61e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样的话，我们就不用为格式问题争吵了。</p><p id="8e47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://github.com/feross/standard" rel="noopener ugc nofollow" target="_blank"> JavaScript标准样式</a>是一个有用的样式指南，它用自己的规则涵盖了大多数JavaScript语法。</p><p id="a614" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们不必对<code class="fe mt mu mv mj b">.eslintrc</code>、<code class="fe mt mu mv mj b">.jshintrc</code>和其他林挺配置文件做出决定。</p><p id="db9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们就用他们提供的。</p><h1 id="828d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Docker</h1><p id="cd5b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Docker让一切变得简单。</p><p id="6674" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它让我们可以独立运行我们的应用程序。</p><p id="5e5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们很轻。</p><p id="aa61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">部署不需要手动步骤。</p><p id="833e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">部署是不可变的。</p><p id="bed4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以轻松地用它在本地镜像生产环境。</p><h1 id="8d62" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">监控我们的应用</h1><p id="2321" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果用户使用我们的应用程序，我们必须确保它们处于运行状态。</p><p id="b142" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们知道的唯一方法就是监控他们。</p><p id="5947" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用像普罗米修斯这样的工具来完成。</p><p id="ff77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它会提醒我们任何问题。</p><p id="c006" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它还会显示我们的应用程序的CPU和内存使用情况。</p><p id="63f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也可以进行分布式跟踪和错误搜索。</p><p id="06c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">性能监控也是内置的。</p><p id="0e4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以用它来检查我们使用的NPM包中的安全漏洞。</p><h1 id="be80" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将消息传递用于后台流程</h1><p id="b402" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们有后台进程，我们应该在它们之间发送消息，以便在一端宕机时可以保留。</p><p id="3537" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以使用一些消息队列解决方案。例子包括:</p><ul class=""><li id="5e6d" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated"><a class="ae kc" href="https://www.rabbitmq.com/" rel="noopener ugc nofollow" target="_blank"> RabbitMQ </a></li><li id="ce80" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><a class="ae kc" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank">卡夫卡</a></li><li id="ca62" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><a class="ae kc" href="http://nsq.io/" rel="noopener ugc nofollow" target="_blank"> NSQ </a></li><li id="9cd2" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><a class="ae kc" href="https://aws.amazon.com/sqs/" rel="noopener ugc nofollow" target="_blank"> AWS SQS </a></li></ul><h1 id="f461" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用最新的LTS节点版本</h1><p id="6cca" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">LTS节点版本比非LTS版本受支持的时间更长。</p><p id="9c32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">支持包括安全补丁和其他错误修复。</p><p id="e914" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们会想要使用它们。</p><p id="3f3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了方便切换，我们可以使用<code class="fe mt mu mv mj b">nvm</code>。</p><p id="368e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们安装了ti，我们就可以运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0ae4" class="mn lc iq mj b gy mo mp l mq mr">nvm install 12.16.1<br/>nvm use 12.16.1</span></pre><p id="5726" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分别安装和使用12.16.1版本。</p><p id="bed2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以在docker文件中指定节点版本。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/dc19718be5d3137991772e7bb4909f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RMeaRPdmnIKT7RQ5"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@transplanttexan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Adam Perry</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="9a86" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="abb5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过一些现代技术让我们的生活变得更轻松，例如使用ES2015+和将我们的应用程序分类。</p><h2 id="3d1b" class="mn lc iq bd ld nl nm dn lh nn no dp ll ko np nq lp ks nr ns lt kw nt nu lx nv bi translated"><strong class="ak">简明英语JavaScript</strong></h2><p id="d77d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有三份出版物和一个YouTube频道吗？在<a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">找到一切的链接plainenglish.io </strong> </a>！</p></div></div>    
</body>
</html>