<html>
<head>
<title>Power of User Roles In TestCafe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TestCafe中用户角色的权力</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/power-of-user-roles-in-testcafe-b88458baae17?source=collection_archive---------3-----------------------#2020-10-21">https://javascript.plainenglish.io/power-of-user-roles-in-testcafe-b88458baae17?source=collection_archive---------3-----------------------#2020-10-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="666c" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">加速您的testCafe UI测试</h2><div class=""/><div class=""><h2 id="f019" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated"><em class="kl">避免让你的UI测试脚本反复运行相同的登录步骤</em></h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/51a38185284a9e7051673f0283863cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m1EZtYoxplMogCu1"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@jakegivens?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jake Givens</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e61d" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">长时间运行的UI测试套件可能会令人沮丧，并可能导致一系列问题，例如</p><ul class=""><li id="478d" class="lz ma in lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated"><strong class="lf ix">更长的反馈循环:</strong>长时间的执行可能会促使开发团队完全避免使用你的UI测试。</li><li id="6553" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><strong class="lf ix">耗时的模拟测试:</strong>测试你的测试中的任何变化都会花费更长的时间。</li><li id="74a5" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><strong class="lf ix">很难说服开发团队将这些集成到CI中:</strong>没有人喜欢等待几个小时在CI中完成部署，却发现由于前端测试中的错误选择器而失败。</li></ul><p id="514a" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">本质上，测试越快，反馈周期越短，越有可能有更多的人使用和信任这些测试。</p><p id="6678" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">传统上，当涉及到减少测试执行时间时，我们经常会提出像并行运行测试这样的解决方案，这确实节省了我们的时间，但是还可以做得更多。</p><p id="837b" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated"><strong class="lf ix">test cafe中的用户角色有哪些？</strong></p><p id="1689" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">TestCafe包含一个用户角色机制，允许您模拟用户登录网站的操作。</p><p id="0301" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">许多测试场景涉及来自多个用户的活动。TestCafe允许您隔离验证用户所需的测试操作(例如，输入凭据，单击“登录”)。在测试过程中，您可以通过一个方法调用在用户帐户之间切换。</p><p id="6418" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">角色<em class="mn">包含登录特定用户的代码。您可以在测试中为每个用户帐户定义一个角色。</em></p><p id="7fb9" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated"><strong class="lf ix">为什么要使用角色？</strong></p><p id="4887" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">如今，大多数应用程序都需要用户登录才能访问大部分功能。因此，大多数测试都需要登录。想象一下，有一个包含200个测试场景的大型测试套件，您可能需要登录200次。这显然要消耗很多时间。</p><p id="f783" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">另一个用例可能是，假设您的应用程序具有基于角色的访问。您可能想要编写一些场景来测试某些功能是否可以被允许用户访问。如果您必须在整个测试过程中登录尽可能多的不同用户，您会发现自己在重复登录过程。您的测试套件将会被重复的代码弄得乱七八糟，并且当您在多个场合让用户登录和退出系统时，您的测试将会明显变慢。</p><p id="c706" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">使用角色不仅可以解决这样的问题，还可以让你的代码看起来干净，并且可以提高测试的执行速度。</p><p id="5e60" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated"><strong class="lf ix">用户角色的特点:</strong></p><ul class=""><li id="ebfc" class="lz ma in lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated"><strong class="lf ix">基于对象的API。</strong>认证数据和逻辑存储在一个对象中，需要时容易传递和激活。</li><li id="bfd5" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><strong class="lf ix">单点登录。</strong>当您在同一会话中切换到以前使用的角色时，不会重复登录操作。如果您在每个挂钩之前激活了<a class="ae lc" href="https://devexpress.github.io/testcafe/documentation/guides/basic-guides/organize-tests.html#test-hooks" rel="noopener ugc nofollow" target="_blank">中的一个角色，那么在第一次测试之前，登录操作会运行一次。后续测试重用身份验证数据，以便它立即发生。</a></li><li id="a56d" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><strong class="lf ix">自动返回。</strong>浏览器会自动导航回您切换角色的页面。(如果需要，您可以禁用此行为。)</li><li id="835f" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">不需要注销。当您切换角色时，认证数据会自动清除。</li><li id="7f82" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><strong class="lf ix">多重认证支持。</strong>如果您在测试期间登录不同的服务/网站，来自cookie和浏览器存储的认证数据会在活动角色中累积。当您在同一测试中切换回该角色时，您将自动登录到所有网站。</li><li id="f6ed" class="lz ma in lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated"><strong class="lf ix">匿名角色。</strong>注销所有帐户的内置角色。</li></ul><p id="d01f" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated"><strong class="lf ix">如何创建用户角色？</strong></p><p id="4cc1" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">使用角色构造函数创建和初始化角色。传递登录页面URL，并通过输入用户名和密码进行登录。在本例中，我创建了两个角色，一个是管理员，另一个是员工。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="a8c5" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">如何在你的测试中使用用户角色？</p><p id="c41d" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">将角色导入到您的测试文件中，并将下面一行添加到您的测试中以触发角色。</p><pre class="kn ko kp kq gt mq mr ms mt aw mu bi"><span id="f041" class="mv mw in mr b gy mx my l mz na">await t.useRole(roleName)</span></pre><p id="7d5a" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated"><strong class="lf ix">例1 </strong></p><p id="9b6d" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">在本例中，有三个测试，每个测试都使用相同的名为“herokuLogin”的用户角色。对于执行的第一个测试，登录只发生一次，其他两次将使用已经创建的会话。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="1c36" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated"><strong class="lf ix">例二</strong>:</p><p id="3a99" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">注意，我们在两个测试中都使用了'<em class="mn"> roleEmployee' </em>。雇员的登录只发生一次，testCafe将存储cookies和会话相关信息以及保留的URL。</p><p id="d5e1" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">第二个测试将使用已经创建的会话。因此，员工不需要第二次登录。</p><p id="4435" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">此外，在不同的用户角色之间切换非常容易。没有必要注销，因为testCafe处理所有开箱即用的东西。这也让你的代码看起来更干净。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="9ebe" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">更多信息请访问“<a class="ae lc" href="https://devexpress.github.io/testcafe/documentation/guides/advanced-guides/authentication.html#user-roles" rel="noopener ugc nofollow" target="_blank"> TestCafe文档</a></p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><p id="c52f" class="pw-post-body-paragraph ld le in lf b lg lh jx li lj lk ka ll lm ln lo lp lq lr ls lt lu lv lw lx ly ig bi translated">代码可在我的git <a class="ae lc" href="https://github.com/rahulrana1/role_testCafe" rel="noopener ugc nofollow" target="_blank">这里</a>获得。如果有任何反馈，请随时联系我。</p></div></div>    
</body>
</html>