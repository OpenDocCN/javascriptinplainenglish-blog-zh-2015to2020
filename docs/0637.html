<html>
<head>
<title>Create HTML5 Native games in Ionic Capacitor apps using Phaser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Phaser在Ionic Capacitor应用程序中创建HTML5原生游戏</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-html5-native-games-in-ionic-capacitor-apps-using-phaser-d3040317ae65?source=collection_archive---------6-----------------------#2019-11-19">https://javascript.plainenglish.io/create-html5-native-games-in-ionic-capacitor-apps-using-phaser-d3040317ae65?source=collection_archive---------6-----------------------#2019-11-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/45736cdd6b545e4765828515c4aefe45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwPj0CfbHxAoGKTbEG_n2A.png"/></div></div></figure><p id="4d1e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这篇文章中，你将学习如何在Capacitor Ionic应用程序中使用Phaser创建HTML5游戏。我们将创建僵尸步行者和太空入侵者游戏，你可以在应用程序和浏览器中玩。《太空入侵者》是我在学校用JAVA开发的第一个游戏，所以它对我来说就像是一个“Hello World”游戏！</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/f82c796bfe7313aa4e0df7613eb7f5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*M-P_SP8Pg1rWrdGb1HhE_Q.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Space Invaders built in Ionic Capacitor with Phaser framework</figcaption></figure><p id="7cfd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">HTML5游戏可以使用Phaser框架制作，这是一个非常棒的2D游戏开发框架。电容器是混合应用程序世界的最新热点。它是对科尔多瓦的替代和改进。我们将在接下来的章节中了解更多。</p><blockquote class="lc ld le"><p id="badb" class="jv jw lf jx b jy jz ka kb kc kd ke kf lg kh ki kj lh kl km kn li kp kq kr ks ig bi translated"><strong class="jx io">本次演示由Enappd的</strong> <a class="ae lj" href="https://store.enappd.com/product/ionic-4-full-app/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> Ionic 4全App Starter </strong> </a> <strong class="jx io">提供支持。本教程完整源代码在Github repo—</strong><a class="ae lj" href="https://github.com/enappd/Ionic4-phaser" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">Ionic-4-phaser</strong></a><strong class="jx io">(ZMB _电容分支&amp;SI _电容分支)</strong>中</p></blockquote><p id="0ad7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来看看对每个包含的框架的简要介绍:</p><ol class=""><li id="1f53" class="lk ll in jx b jy jz kc kd kg lm kk ln ko lo ks lp lq lr ls bi translated">离子的</li><li id="71d0" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated">电容器</li><li id="d0f1" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated">相位器</li></ol><h1 id="244d" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">离子框架</h1><p id="941f" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">你可能已经知道离子，但我把它放在这里只是为了初学者。<strong class="jx io"> Ionic </strong>是一款混合移动app开发SDK。它提供了使用CSS、HTML5和Sass等Web技术开发混合移动应用程序的工具和服务。应用程序可以用这些网络技术构建，然后通过本地应用商店发布。这些应用程序可以通过利用<a class="ae lj" href="https://cordova.apache.org/" rel="noopener ugc nofollow" target="_blank"> Cordova </a>或Capacitor环境安装在设备上。</p><p id="010c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，换句话说——如果你用Android创建原生应用，你就用Java编码。如果你在iOS中创建原生应用，你用Obj-C或Swift编码。这两种语言都是强大但复杂的语言。<strong class="jx io">使用Cordova(和Ionic ),你可以为你的应用编写一段代码，它可以在iOS和Android上运行</strong>(和windows！)，HTML、CSS和JS的简单性也是如此。</p><p id="0f04" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">必须注意科尔多瓦/电容在其中的作用。Ionic只是一个由HTML、CSS、JS组成的UI包装器。因此，默认情况下，Ionic不能在iOS或Android设备中作为应用程序运行。Cordova/Capacitor是一个构建环境，它将这个Ionic web应用程序封装起来，并将其转换为一个可安装在设备上的应用程序，同时为这个应用程序提供对Camera等本地API的访问。</p><h1 id="1815" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">Phaser游戏框架</h1><p id="3b5b" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">Phaser于2013年首次发布，是一个2D HTML5游戏开发框架。它现在已经成为2D HTML5游戏中的一个巨大的名字。基于javascript，它可以很容易地集成到各种javascript框架中。👾 👾 👾</p><p id="e7d1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那么为什么要集成Phaser和Ionic呢？🚀 👾</p><p id="c9d8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">虽然Ionic让你能够以闪电般的速度创建应用程序和PWA，但你无法用它真正制作游戏。Phaser虽然在游戏构建方面很棒，但并不是真的要构建一个结构化的移动或网络应用。因此，用Phaser构建一个外观简洁的游戏应用或PWA需要一个HTML + CSS包装器，Ionic完美地填补了这个空白。</p><h1 id="e03e" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">什么是电容？</h1><p id="8090" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">Cordova帮助将Ionic web app构建成一个设备可安装的应用程序。但是Cordova有一些限制，电容器试图通过新的应用程序工作流程来克服这些限制。</p><p id="f84c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Capacitor是一个跨平台的应用程序运行时，可以轻松构建在iOS、Android、Electron、<em class="lf">和</em>网络上运行的web应用程序。Ionic人将这些应用称为“原生渐进式网络应用”，它们代表了混合应用之外的下一次发展。它是为Ionic构建的，但也可以运行其他框架。它只是一个运行时系统，将你的网络应用“容器化”，允许它在多个地方运行。有了电容器，你就可以在</p><ul class=""><li id="4ab5" class="lk ll in jx b jy jz kc kd kg lm kk ln ko lo ks nb lq lr ls bi translated">安卓应用</li><li id="667f" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">iOS应用程序</li><li id="7b99" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">在浏览器中作为渐进式网络应用程序，以及</li><li id="f8be" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">在使用电子桌面应用中</li></ul><p id="752e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本质上，电容器就像一个新鲜的，更灵活的科尔多瓦版本。它使得在各种平台上运行混合应用变得非常容易。</p><h1 id="0ee8" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">员额结构</h1><p id="4e4f" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">我们将遵循一个循序渐进的方法，在我们的Ionic 4电容应用程序中创建一个基于相位器的游戏。以下是步骤</p><ul class=""><li id="b073" class="lk ll in jx b jy jz kc kd kg lm kk ln ko lo ks nb lq lr ls bi translated">步骤1——创建一个基本的<strong class="jx io">离子4角</strong>应用程序</li><li id="05a2" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">步骤2-将Phaser包含在项目中</li><li id="93d1" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">步骤3 —在应用程序中集成电容</li><li id="98c0" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">步骤4-实现Phaser游戏</li><li id="846b" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">第五步——将游戏内置到手机应用程序中</li></ul><p id="895d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这就是我们在本教程中要构建的内容。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/6bfa0645cb3d7a5411f0441338ef1b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/1*VZyszKo1Ebsu7qT-5Z3InQ.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">A zombie walking — Using Phaser in capacitor app</figcaption></figure><p id="22a5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以让我们开始吧！</p><h1 id="109f" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第一步:创建一个基本的离子4角应用程序</h1><blockquote class="lc ld le"><p id="9323" class="jv jw lf jx b jy jz ka kb kc kd ke kf lg kh ki kj lh kl km kn li kp kq kr ks ig bi translated">我已经在<a class="ae lj" href="https://enappd.com/blog/how-to-create-an-ionic-4-app-for-beginners/13/" rel="noopener ugc nofollow" target="_blank">这篇博客</a>中详细报道了这个话题。</p></blockquote><p id="8df4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">简而言之，您需要采取的步骤如下</p><ul class=""><li id="1e8a" class="lk ll in jx b jy jz kc kd kg lm kk ln ko lo ks nb lq lr ls bi translated">确保您已经在系统中安装了node(在这篇博文发表时是V10.0.0)</li><li id="1ae0" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">使用npm安装<strong class="jx io"> ionic cli </strong>(我的ionic版本是^4.7.1)</li><li id="508a" class="lk ll in jx b jy lt kc lu kg lv kk lw ko lx ks nb lq lr ls bi translated">使用<code class="fe nd ne nf ng b">ionic start</code>创建Ionic应用程序</li></ul><p id="afc5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了本教程，您可以创建一个<code class="fe nd ne nf ng b">sidemenu</code>启动器。运行<code class="fe nd ne nf ng b">ionic start ioniser sidemenu</code>时，将安装节点模块。安装完成后，使用在浏览器上运行您的应用程序</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="9694" class="nl lz in ng b gy nm nn l no np">$ ionic serve</span></pre><p id="2c76" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">并检查一切运行正常。对我来说，它看起来像跟随。从附带的Github repo中复制代码，将其更改到游戏中。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/44cc98d18dc59a039ca20e155a935c23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H1h_3dUzlopbnG3vQULZrg.png"/></div></div></figure><h1 id="6026" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤2:在项目中包含Phaser</h1><p id="399b" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">Phaser非常容易包含在项目中。本质上，它只是一个需要包含在HTML5项目中的Javascript文件。有两种方法可以做到</p><p id="06c2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"><em class="lf"># 1——酷炫的“一劳永逸”方式(更快)</em> </strong></p><p id="08aa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从<a class="ae lj" href="https://phaser.io/download/stable" rel="noopener ugc nofollow" target="_blank"> Phaser官方下载</a>下载<code class="fe nd ne nf ng b"><em class="lf">phaser.min.js</em></code>，并将其与您的项目链接。出于演示的目的，我将把这个文件保存在<code class="fe nd ne nf ng b">assets</code>文件夹中，但是你也可以从CDN链接它。</p><p id="8289" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">将phaser.js文件包含在<code class="fe nd ne nf ng b">index.html</code>文件中，如下所示</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="232a" class="nl lz in ng b gy nm nn l no np">&lt;script src="assets/phaser.min.js"&gt;&lt;/script&gt;</span></pre><p id="8b35" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在您可以使用以下命令将phaser包含在您的组件<code class="fe nd ne nf ng b">.ts</code>文件中</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="0fc6" class="nl lz in ng b gy nm nn l no np">declare var Phaser;</span></pre><p id="4457" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">(要检查<code class="fe nd ne nf ng b">Phaser</code>包含什么，试着安慰变量或保存在<code class="fe nd ne nf ng b">this</code>中的变量<code class="fe nd ne nf ng b">defaultState</code>，你会对Phaser的构建有所了解。)</p><p id="43fc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"><em class="lf"># 2——复杂的“我是一个编码狂”方式</em> </strong></p><p id="a764" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从phaser下载npm包</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="e6b9" class="nl lz in ng b gy nm nn l no np">npm install phaser-ce</span></pre><p id="12e6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">准备<strong class="jx io"> webpack </strong>来编译phaser包，这样您就可以在。ts文件。您可能需要为此准备自己的webpack-config并安装额外的模块。此后，您可以将变量导入为</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="9e68" class="nl lz in ng b gy nm nn l no np">import "pixi";<br/>import "p2";<br/>import * as Phaser from "phaser-ce";</span></pre><p id="d1c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里给出了细节<a class="ae lj" href="https://github.com/photonstorm/phaser-ce#browserify--cjs" rel="noopener ugc nofollow" target="_blank"/>(上次我试过，这种方法在离子上有各种各样的错误，所以我将坚持使用方法#1)</p><h1 id="ac92" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤3 —在应用程序中集成电容</h1><p id="9625" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">电容器也可以连接到现有的离子app。要将电容器连接到您现有的Ionic应用程序，运行</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="3e47" class="nl lz in ng b gy nm nn l no np">$ <!-- -->ionic integrations enable capacitor</span></pre><p id="82e3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这将附加电容器到你的离子应用程序。在这之后，你必须<code class="fe nd ne nf ng b">init</code>电容器应用程序</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="f035" class="nl lz in ng b gy nm nn l no np">$ npx cap init YOUR_APP_NAME YOUR_APP_ID</span></pre><h1 id="6b3a" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤4:实现Phaser游戏</h1><blockquote class="lc ld le"><p id="3c7b" class="jv jw lf jx b jy jz ka kb kc kd ke kf lg kh ki kj lh kl km kn li kp kq kr ks ig bi translated"><strong class="jx io">你可以在</strong> <a class="ae lj" href="https://store.enappd.com/product/ionic-phaser-game-framework-ionic-4/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">中找到完整的代码</strong></a><strong class="jx io">【ZMB _电容支路】</strong></p></blockquote><p id="ad47" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">出于示例目的，我们将使用一个简单的<a class="ae lj" href="https://phaser.io/examples/v2/animation/animation-events" rel="noopener ugc nofollow" target="_blank">相位器示例</a>，我们将制作一个<strong class="jx io">僵尸</strong>行走。</p><p id="0005" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将关注启动器附带的<code class="fe nd ne nf ng b">home</code>组件。所以所有相关的javascript代码都将放在<code class="fe nd ne nf ng b">home.page.ts</code>文件中。用以下内容替换<code class="fe nd ne nf ng b">home.page.html</code>文件中的全部内容</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="00a2" class="nl lz in ng b gy nm nn l no np">&lt;ion-content&gt;<br/>  &lt;div id="phaser-example"&gt;&lt;/div&gt;<br/>&lt;/ion-content&gt;</span></pre><p id="6e56" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将识别javascript逻辑中的<code class="fe nd ne nf ng b">phaser-example</code>,并在这个div中实例化游戏。</p><p id="9469" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一个基本的Phaser游戏有三个默认函数——preload()、create()和update()</p><h2 id="cf30" class="nl lz in bd ma nr ns dn me nt nu dp mi kg nv nw mm kk nx ny mq ko nz oa mu ob bi translated">预载()</h2><p id="1a73" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">顾名思义，预载资产等。在我们的例子中，这个函数将加载僵尸和背景图像。</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="d6b9" class="nl lz in ng b gy nm nn l no np">preload() {</span><span id="8b6f" class="nl lz in ng b gy oc nn l no np">this.game.load.image('lazur', 'assets/thorn_lazur.png');</span><span id="5f39" class="nl lz in ng b gy oc nn l no np">this.game.load.spritesheet('mummy', 'assets/metalslug_mummy37x45.png', 37, 45, 18);</span><span id="c011" class="nl lz in ng b gy oc nn l no np">}</span></pre><h2 id="6e9d" class="nl lz in bd ma nr ns dn me nt nu dp mi kg nv nw mm kk nx ny mq ko nz oa mu ob bi translated">创建()</h2><p id="76d2" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">创建游戏实例并加载游戏状态。在我们的游戏中，这个函数将设置场景中的图像。我们还将在这里创建和设置动画监听器。</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="72b0" class="nl lz in ng b gy nm nn l no np">create() {</span><span id="8d77" class="nl lz in ng b gy oc nn l no np">// Set background</span><span id="cebd" class="nl lz in ng b gy oc nn l no np">this.back = this.game.add.image(0, -400, 'lazur');</span><span id="f708" class="nl lz in ng b gy oc nn l no np">this.back.scale.set(2);</span><span id="e121" class="nl lz in ng b gy oc nn l no np">this.back.smoothed = false;</span><span id="c23e" class="nl lz in ng b gy oc nn l no np">// Set mummy from a sprite</span><span id="a1e5" class="nl lz in ng b gy oc nn l no np">this.mummy = this.game.add.sprite(200, 360, 'mummy', 5);</span><span id="7aa6" class="nl lz in ng b gy oc nn l no np">this.mummy.scale.set(4);</span><span id="04b3" class="nl lz in ng b gy oc nn l no np">this.mummy.smoothed = false;</span><span id="2c22" class="nl lz in ng b gy oc nn l no np">// Set mummy animation</span><span id="b8a7" class="nl lz in ng b gy oc nn l no np">this.anim = this.mummy.animations.add('walk');</span><span id="9e86" class="nl lz in ng b gy oc nn l no np">this.anim.onStart.add(that.animationStarted, this);</span><span id="9f58" class="nl lz in ng b gy oc nn l no np">this.anim.onLoop.add(that.animationLooped, this);</span><span id="c3a8" class="nl lz in ng b gy oc nn l no np">this.anim.onComplete.add(that.animationStopped, this);</span><span id="a2a1" class="nl lz in ng b gy oc nn l no np">this.anim.play(10, true);</span><span id="92a8" class="nl lz in ng b gy oc nn l no np">}</span></pre><h2 id="93a2" class="nl lz in bd ma nr ns dn me nt nu dp mi kg nv nw mm kk nx ny mq ko nz oa mu ob bi translated">更新()</h2><p id="5b1e" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">更新循环，动作，物理互动等游戏状态。对于我们的游戏，这将通过移动背景来更新动画，以创建“行走”的效果</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="26d7" class="nl lz in ng b gy nm nn l no np">update() {if (this.anim.isPlaying) { this.back.x -= 1;}}</span></pre><p id="3dcc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">还有Tada！！！🎉 🎉🎉我们在<em class="lf">发球</em>窗口运行我们的游戏</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kt"><img src="../Images/9904dcfcee82b7accfdf7e6d161cb5d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*iTWUgMpxjmLFO9nXfnz31A.gif"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Basic Phaser game in Capacitor browser app</figcaption></figure><p id="6a1d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">同样，你可以用Ionic运行任何相位器游戏。相信我，Phaser 中有一些看起来不可思议的<a class="ae lj" href="https://phaser.io/examples" rel="noopener ugc nofollow" target="_blank">游戏。不久前我们做了一个马里奥复制品，还有一个太空入侵者！</a></p><p id="2686" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">⭐️️️️⭐️️️️⭐️️️️important️️⭐️️️️⭐️️️️⭐️️️️</strong></p><p id="2e04" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Phaser的实现可能会让您与<code class="fe nd ne nf ng b">this</code>的实现混淆。简而言之，一旦相位器场景被初始化，<code class="fe nd ne nf ng b">this</code>就包含了默认的游戏状态。作为一名Ionic开发人员，或者如果您遵循Ionic文档，您将使用<code class="fe nd ne nf ng b">this</code>来引用组件的类。所以你最终使用了冲突的<code class="fe nd ne nf ng b">this</code>。为了快速解决这个问题，我将离子<code class="fe nd ne nf ng b">this</code>分配给另一个变量<code class="fe nd ne nf ng b">that</code>(😅)然后用它指向类函数。</p><p id="8a11" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">常见的错误是声明<code class="fe nd ne nf ng b">that = this</code>。是的，它确实通过<code class="fe nd ne nf ng b">that</code>引用<code class="fe nd ne nf ng b">this</code>，但是一旦<code class="fe nd ne nf ng b">this</code>改变，<code class="fe nd ne nf ng b">that</code>也会改变，因此这样做没有意义。你可以使用<code class="fe nd ne nf ng b">that = Object.assign({},this)</code>，这是一个很好的标准代码。但是你会发现，这也不会导致我们想要的结果。因为在Ionic <code class="fe nd ne nf ng b">this</code>中包含了<code class="fe nd ne nf ng b">_prototype</code>内部的类<strong class="jx io">函数，要将这些函数复制到<code class="fe nd ne nf ng b">that</code>中，您应该这样定义它</strong></p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="88ef" class="nl lz in ng b gy nm nn l no np">that = Object.create(this.constructor.prototype);</span></pre><p id="4af8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后用<code class="fe nd ne nf ng b">that</code>代替<code class="fe nd ne nf ng b">this</code>调用函数</p><p id="a2b0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例如<code class="fe nd ne nf ng b">that.animationStarted</code>指向一个函数<code class="fe nd ne nf ng b">animationStarted</code>。在这里使用<code class="fe nd ne nf ng b">this</code>会抛出一个错误，因为<code class="fe nd ne nf ng b">create()</code>函数是一个相位器默认值，并且在<code class="fe nd ne nf ng b">this</code>中包含场景的默认状态</p><p id="481e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你对<code class="fe nd ne nf ng b">this</code>概念不太适应，你可以在<a class="ae lj" href="https://code.tutsplus.com/tutorials/fully-understanding-the-codethiscode-keyword--net-21117" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多。</p><p id="74a7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">(作为另一个变通办法，您可以将完整的javascript代码放在Ionic的类实现之外，或者更糟，放在<code class="fe nd ne nf ng b">index.html</code>的<code class="fe nd ne nf ng b">&lt;script&gt;&lt;/script&gt;</code>标签中，但这太麻烦了。你将无法用这种方式编写庞大的游戏代码)</p><h1 id="ce4c" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第五步:将游戏制作成手机应用</h1><p id="0fe1" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">使用Phaser构建电容器应用程序与构建常规电容器应用程序完全相同。对于那些不熟悉Ionic 4流程的人，首先构建ionic web资产</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="61fc" class="nl lz in ng b gy nm nn l no np">$ ionic build</span></pre><p id="2395" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后，使用以下任意命令向应用程序添加平台</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="951e" class="nl lz in ng b gy nm nn l no np">$ npx cap add android<br/>$ npx cap add ios</span></pre><p id="6322" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">添加平台后，您可以打开该平台的本机IDE，并在设备或模拟器中运行应用程序。</p><pre class="ku kv kw kx gt nh ng ni nj aw nk bi"><span id="59ad" class="nl lz in ng b gy nm nn l no np">$ npx cap open android // opens Android Studio<br/>$ npx cap open ios // opens Xcode</span></pre><p id="801d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可能希望使用<code class="fe nd ne nf ng b">window.innerWidth</code>和<code class="fe nd ne nf ng b">window.innerHeight</code>根据设备尺寸调整<code class="fe nd ne nf ng b">canvas</code>的尺寸。有了这个，你可以为所有的移动设备尺寸调整游戏画布。</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi od"><img src="../Images/05751dba45604b314317aaa4b5a5feca.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*iZ1Xv4a68TUsiWd1kUHtGg.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Zombie walking — Phaser game in Ionic Capacitor, running in Android device</figcaption></figure><p id="2bf2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">经过这些调整，游戏看起来如上。不错吧。👻</p><p id="4da3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">酷的是，你仍然可以像移动应用程序一样拥有<strong class="jx io">侧菜单</strong>或<strong class="jx io">标签</strong>，并在游戏中加入应用程序的所有常规功能(反之亦然)，如登录、注册等。利用离子插件。</p><h2 id="d3d8" class="nl lz in bd ma nr ns dn me nt nu dp mi kg nv nw mm kk nx ny mq ko nz oa mu ob bi translated">太空入侵者？</h2><p id="b4d9" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">想在爱奥尼亚制作自己的PUBG或太空入侵者游戏吗？我们有东西给你！我们在离子电容Github repo—<a class="ae lj" href="https://github.com/enappd/Ionic4-phaser" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">Ionic-4-phaser</strong></a><strong class="jx io">(SI _ Capacitor branch)</strong>中加入了太空入侵者游戏</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oe"><img src="../Images/f523db924d8520bd35f30202e515801f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*JGdK9H4TECzyH-EbWxKdtw.gif"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Space Invaders in Ionic + Phaser — Using Capacitor in Browser</figcaption></figure><p id="0092" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">从回购的<code class="fe nd ne nf ng b">SI_capacitor</code>分支运行代码，就能得到一个很酷的太空入侵者游戏app！在Android设备上看起来像这样</p><figure class="ku kv kw kx gt jo gh gi paragraph-image"><div class="gh gi od"><img src="../Images/531336f6fa53bb15c4d91b88df5a8c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*hUNSejP31GvFtq9rQ-pzwQ.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Space Invaders in Ionic + Phaser — Using Capacitor in Android</figcaption></figure><h1 id="79db" class="ly lz in bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">结论</h1><p id="142e" class="pw-post-body-paragraph jv jw in jx b jy mw ka kb kc mx ke kf kg my ki kj kk mz km kn ko na kq kr ks ig bi translated">Ionic在制作移动应用程序方面速度超快，而Phaser则非常适合制作2D HTML5游戏。Capacitor是一个很好的运行时环境，可以将web应用程序容器化，在各种平台上运行。结合离子，电容和相位器，你可以创建一些很酷的游戏应用。你也可以将游戏包含在一个常规的Ionic Capacitor应用程序中，这使得它更加通用。</p><blockquote class="lc ld le"><p id="7bf2" class="jv jw lf jx b jy jz ka kb kc kd ke kf lg kh ki kj lh kl km kn li kp kq kr ks ig bi translated"><strong class="jx io">本教程完整源代码在Github repo—</strong><a class="ae lj" href="https://github.com/enappd/Ionic4-phaser" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">Ionic-4-phaser</strong></a><strong class="jx io">(ZMB _电容分支&amp;SI _电容分支)</strong></p></blockquote><p id="3e92" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="lf">本文原载于</em><a class="ae lj" href="https://enappd.com" rel="noopener ugc nofollow" target="_blank"><em class="lf">【enappd.com】</em></a></p></div></div>    
</body>
</html>