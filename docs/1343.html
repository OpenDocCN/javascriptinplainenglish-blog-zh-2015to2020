<html>
<head>
<title>Build your own React toast notifications from scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始构建您自己的React toast通知</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-your-own-react-toast-notifications-from-scratch-c5e67357da4d?source=collection_archive---------1-----------------------#2020-03-04">https://javascript.plainenglish.io/build-your-own-react-toast-notifications-from-scratch-c5e67357da4d?source=collection_archive---------1-----------------------#2020-03-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="9823" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">没有使用库！</h2></div><h2 id="df14" class="kc kd in bd ke kf kg dn kh ki kj dp kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">在现代应用程序的世界里，你可以从互联网上获得任何现成的东西。</h2><p id="b4e6" class="pw-post-body-paragraph ky kz in la b lb lc jo ld le lf jr lg kl lh li lj kp lk ll lm kt ln lo lp lq ig bi translated">但是在某些情况下，你得到的比你需要的多，这可能会让你慢下来。通过我们的前端开发，当使用第三方库时，您会添加更多未使用的代码，并通过增加第一次有意义的绘制的时间来使您的用户体验变得更差。</p><p id="9fd1" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">在创建最小尺寸组件的过程中。我正在用React从头开始构建一个toast通知库。</p><p id="aba3" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated"><em class="lw">然而，如果你想跳过前面，我把本文中使用的所有代码都变成了一个npm包，你可以在这里找到:</em><a class="ae lx" href="https://www.npmjs.com/package/react-tiny-toast" rel="noopener ugc nofollow" target="_blank"><em class="lw">【https://www.npmjs.com/package/react-tiny-toast】</em></a><em class="lw">。</em></p><p id="c9fc" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated"><strong class="la io">有哪些吐司通知？<br/> </strong> Toast通知是简单的非模态弹出窗口，用于对当前活动的、可见的和交互的操作进行反馈。</p><p id="4c35" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">为了构建通知，我们需要一个toast管理器来帮助维护活动toast通知的列表。反过来，我们将活动的toast通知传递给react组件来显示它。在toast管理器和react组件之间传递数据。我们在吐司管理器中有一个<code class="fe ly lz ma mb b">subscribe</code>方法。它从我们的react组件接受一个<code class="fe ly lz ma mb b"><em class="lw">callback</em></code>方法，每当我们想要更新一个toast通知时，<code class="fe ly lz ma mb b">subscribe</code>方法就调用这个回调。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/b2bc6dcc0ba125cb80ad7989790d7ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*JgBPrbs9s90aYV5AqlK_bQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">our toast manager code.</figcaption></figure><p id="9e27" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">这里，我们的<em class="lw"> subscribe </em>方法通过一个<em class="lw">回调函数</em>传递，回调函数是在我们的React组件中定义的，当这个回调函数被新的toast消息调用时，我们使用React组件构建toast UI。因此使用它的应用程序需要一个React组件(<em class="lw"> ToastContainer，我们将在接下来的步骤</em>中添加)来呈现我们的toast消息。</p><p id="a9cf" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">接下来是<em class="lw"> ToastContainer </em>，它将<em class="lw">回调</em>传递给<em class="lw"> subscribe </em>方法，每次添加或删除toast消息时都会调用这个回调。使用回调，我们的UI组件可以了解任何添加或删除的toast消息。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/25b47a73cea144e9f72a331f3f348d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A8rmdJqMx4V_wuR_EAlunw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">On component mount, we subscribe to toastManager to notify our react-component about any new message additions.</figcaption></figure><p id="0790" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">结合使用<em class="lw">回调</em>函数和<em class="lw">分派</em>函数，我们更新了现有的Toast通知UI。此处<em class="lw">调度</em>由<em class="lw"> useReducer </em>返回以更新我们的状态(参考<a class="ae lx" href="https://reactjs.org/docs/hooks-reference.html#usereducer" rel="noopener ugc nofollow" target="_blank">此处</a>以了解更多关于<em class="lw"> useReducer </em>)。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/bbb0eb13eb9054f8b69ccfa0aa39ebf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*zGQ4LAr2DxKDBjGy3ej_YA.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Definition of our state using reducer function. using dispatch function returned by useReducer we update our present component which in turn updates the UI.</figcaption></figure><p id="ce33" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">基于从我们的回调传递给<em class="lw"> dispatch </em>函数的动作，我们使用作为第一个参数传递的reducer来更新我们的状态，同时使用<em class="lw"> useReducer </em>来定义我们的状态。请参考下面的代码:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/ef4dfbf1141e73ae2c2f23d6e9d61942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*bBFWx6b2cr6XUFclubtlJA.png"/></div></figure><p id="491b" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">在更新这里的状态时，我们的react组件用更新的toast消息重新呈现。</p><p id="92d5" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">接下来是用toast消息呈现组件的部分。我们的组件已经有了toast通知消息。在这样做之前，我们需要确保我们的toast通知不会干扰应用程序UI。为此，我们创建了自己的文档元素，在这里我们安装了toast通知。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/f7a02b1ffa59b5234a041a39ac16d3f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*j4f6cmGv-l0wmAmzpla8yQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">On component mount, we create a document element and append it to body.</figcaption></figure><p id="93d1" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">我们使用<em class="lw"> React </em> <em class="lw"> Portals </em>将我们的toast元素呈现到您的UI上。React门户帮助我们显示toast通知，而不考虑我们的组件，其中我们显示我们的toast被允许溢出或具有低z索引并对用户隐藏。</p><p id="1519" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">我们根据位置对toast通知进行分组，使用CSS样式来分配位置。传入React组件以呈现您自己的样式。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/a0f1076813f9f8527d846cb792af5352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RmZFtHzEMJgZKYtLI-cmbA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Rendering part of our toast message list.</figcaption></figure><p id="e8a6" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">使用演示故事书中的<code class="fe ly lz ma mb b">react-tiny-toast</code>的toast通知示例图像，其代码可以直接在您的应用程序中使用。点击这里[<a class="ae lx" href="http://playground.ashr81.now.sh/" rel="noopener ugc nofollow" target="_blank">http://playground.ashr81.now.sh/</a>]链接到演示应用<a class="ae lx" href="http://playground.ashr81.now.sh/" rel="noopener ugc nofollow" target="_blank">。您只需复制代码并将其粘贴到您的应用程序中。</a></p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mw"><img src="../Images/f48b0fc145ff297b609c8881f2bcbd3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8qJRRCVId-asjBNwxtDww.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Image from demo site with ready code that can be used on your application</figcaption></figure><p id="7a42" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated"><strong class="la io">奖励:</strong></p><p id="201b" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">为了避免为相同的动作多次祝酒，使用唯一的<code class="fe ly lz ma mb b">string</code>或<code class="fe ly lz ma mb b">number</code>来传入<code class="fe ly lz ma mb b">uniqueCode</code>属性。</p><p id="50ae" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">包装尺寸太小。它嵌入到您的应用程序中，没有任何性能下降。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mx"><img src="../Images/e579a8156b0c259c3b8a4dde6a59581d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QJ_GMiYVE9j2ZConzFNVA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Package size on Bundlephobia</figcaption></figure><p id="4e04" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">你可以在这里找到<code class="fe ly lz ma mb b">react-tiny-toast</code>的演示，带有选项的交互设置:</p><p id="e0bc" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">您可以通过将包添加到项目中来使用它。</p><p id="eec7" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">在此找到用法说明:</p><p id="9009" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated">演示链接:<a class="ae lx" href="https://playground.ashr81.now.sh/?path=/story/toast-options--playaround-with-different-toast-options" rel="noopener ugc nofollow" target="_blank">https://playground . ashr 81 . now . sh</a></p><div class="my mz gp gr na nb"><a href="https://www.npmjs.com/package/react-tiny-toast" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">反应-微小-吐司</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">开始使用"</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.npmjs.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np mi nb"/></div></div></a></div><div class="my mz gp gr na nb"><a href="https://github.com/ashr81/react-tiny-toast/tree/master/packages/react-tiny-toast" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">ashr 81/反应-微小-吐司</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">github.com</p></div></div><div class="nk l"><div class="nq l nm nn no nk np mi nb"/></div></div></a></div></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><p id="7958" class="pw-post-body-paragraph ky kz in la b lb lr jo ld le ls jr lg kl lt li lj kp lu ll lm kt lv lo lp lq ig bi translated"><strong class="la io">目标:</strong></p><ol class=""><li id="445c" class="ny nz in la b lb lr le ls kl oa kp ob kt oc lq od oe of og bi translated">为了避免臃肿的软件，只添加必需的选项，以保持包的大小非常小。</li><li id="ace9" class="ny nz in la b lb oh le oi kl oj kp ok kt ol lq od oe of og bi translated">您可以为toast通知添加自己的样式。</li></ol></div></div>    
</body>
</html>