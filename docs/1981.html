<html>
<head>
<title>Advanced Svelte Transition Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高级纤薄过渡功能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/advanced-svelte-transition-features-ca285b653437?source=collection_archive---------8-----------------------#2020-05-09">https://javascript.plainenglish.io/advanced-svelte-transition-features-ca285b653437?source=collection_archive---------8-----------------------#2020-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a6adcd80e15555f099ed97700e6186dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c04IQzz7qQiHIUTy"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@a5hleyrich?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ashley Rich</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a600" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Svelte是一个正在兴起的前端框架，用于开发前端web应用程序。</p><p id="f803" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它使用简单，让我们快速创建结果。</p><p id="732d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何使用高级的苗条转换特性，包括转换事件，本地和延迟转换。</p><h1 id="2fd1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">过渡事件</h1><p id="9469" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以为各种转换事件添加事件处理程序来完成日志记录之类的工作。</p><p id="5946" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以编写以下代码，在p元素被打开和关闭时为其添加动画，并显示动画的状态:</p><p id="d13c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.svelte</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dd6a" class="mq lc iq mh b gy mr ms l mt mu">&lt;script&gt;<br/> import { fly } from "svelte/transition";<br/> let visible = true;<br/> let status = "";<br/>&lt;/script&gt;</span><span id="88e8" class="mq lc iq mh b gy mv ms l mt mu">&lt;button on:click={() =&gt; visible = !visible}&gt;Toggle&lt;/button&gt;<br/>&lt;p&gt;Animation status: {status}&lt;/p&gt;<br/>{#if visible}<br/>&lt;p<br/>  transition:fly="{{ y: 200, duration: 2000 }}"<br/>  on:introstart="{() =&gt; status = 'intro started'}"<br/>  on:outrostart="{() =&gt; status = 'outro started'}"<br/>  on:introend="{() =&gt; status = 'intro ended'}"<br/>  on:outroend="{() =&gt; status = 'outro ended'}"<br/>&gt;<br/>  foo<br/>&lt;/p&gt;<br/>{/if}</span></pre><p id="69f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们为设置<code class="fe me mf mg mh b">status</code>的<code class="fe me mf mg mh b">introstart</code>、<code class="fe me mf mg mh b">outrostart</code>、<code class="fe me mf mg mh b">introend</code>和<code class="fe me mf mg mh b">outroend</code>事件添加了事件处理程序。</p><p id="6e68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在p标签中显示<code class="fe me mf mg mh b">status</code>。当我们点击切换按钮时，我们将看到动画发生并且<code class="fe me mf mg mh b">status</code>被更新。</p><h1 id="dc94" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">局部过渡</h1><p id="98cf" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过局部转换将转换应用于单个列表元素。例如，我们可以编写下面的代码来给列表中的每一项添加一个<code class="fe me mf mg mh b">slide</code>效果:</p><p id="305d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.svelte</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b5cd" class="mq lc iq mh b gy mr ms l mt mu">&lt;script&gt;<br/>  import { slide } from "svelte/transition";<br/>  let items = [];<br/>  const addItem = () =&gt; {<br/>    items = [...items, Math.random()];<br/>  };<br/>&lt;/script&gt;</span><span id="a552" class="mq lc iq mh b gy mv ms l mt mu">&lt;button on:click={addItem}&gt;Add Item&lt;/button&gt;<br/>{#each items as item}<br/>  &lt;div transition:slide&gt;<br/>    {item}<br/>  &lt;/div&gt;<br/>{/each}</span></pre><p id="1cce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在代码中，我们使用了<code class="fe me mf mg mh b">addItem</code>函数向数组中添加一个新数字。然后我们在标记中显示数组。</p><p id="2042" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">each</code>内部的div中，我们添加了<code class="fe me mf mg mh b">transition:slide</code>指令，以便在添加项目时应用幻灯片效果。</p><p id="5e8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，当我们单击Add Item时，我们将看到幻灯片效果。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/932adfea8c79a0309f038aeba357a97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OHLIsso0z0urSLTM"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@alschim?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexander Schimmeck</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="39b2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">延期过渡</h1><p id="7264" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有了Svelte，我们可以推迟过渡，这样我们就可以在多个元素之间协调动画。</p><p id="41d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">crossfade</code>功能来实现这一点。它创建了一对名为<code class="fe me mf mg mh b">send</code>和<code class="fe me mf mg mh b">receive</code>的转换。</p><p id="5c20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果元素被发送，那么它会寻找接收到的对应元素，并生成一个转换，将该元素转换到其对应元素的位置并淡出。</p><p id="667a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当接收到一个元素时，就会发生相反的情况。如果没有对应项，则使用<code class="fe me mf mg mh b">fallback</code>转换。</p><p id="4bd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以动画显示项目在两个列表之间的移动，如下所示:</p><p id="a214" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.svelte</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ea11" class="mq lc iq mh b gy mr ms l mt mu">&lt;script&gt;<br/>  import { cubicOut } from "svelte/easing";<br/>  import { crossfade } from "svelte/transition";</span><span id="84d5" class="mq lc iq mh b gy mv ms l mt mu">  const [send, receive] = crossfade({<br/>    duration: d =&gt; Math.sqrt(d * 200),</span><span id="5041" class="mq lc iq mh b gy mv ms l mt mu">    fallback(node, params) {<br/>      const style = getComputedStyle(node);<br/>      const transform = style.transform === "none" ? "" : style.transform;</span><span id="701a" class="mq lc iq mh b gy mv ms l mt mu">      return {<br/>        duration: 600,<br/>        easing: cubicOut,<br/>        css: t =&gt; `<br/>          transform: ${transform} scale(${t});<br/>          opacity: ${t}<br/>        `<br/>      };<br/>    }<br/>  });</span><span id="aaf9" class="mq lc iq mh b gy mv ms l mt mu">  let uid = 1;</span><span id="bd1a" class="mq lc iq mh b gy mv ms l mt mu">  let todos = [<br/>    { id: uid++, done: false, description: "write some docs" },<br/>    { id: uid++, done: false, description: "eat" },<br/>    { id: uid++, done: true, description: "buy milk" },<br/>    { id: uid++, done: false, description: "drink" },<br/>    { id: uid++, done: false, description: "sleep" },<br/>    { id: uid++, done: false, description: "fix some bugs" }<br/>  ];</span><span id="bd9d" class="mq lc iq mh b gy mv ms l mt mu">  const mark = (id, done) =&gt; {<br/>    const index = todos.findIndex(t =&gt; t.id === id);<br/>    todos[index].done = done;<br/>  };<br/>&lt;/script&gt;</span><span id="62fc" class="mq lc iq mh b gy mv ms l mt mu">&lt;style&gt;<br/>  #box {<br/>    display: flex;<br/>    flex-direction: row;<br/>  }<br/>&lt;/style&gt;</span><span id="8fe5" class="mq lc iq mh b gy mv ms l mt mu">&lt;div id='box'&gt;<br/>  &lt;div&gt;<br/>    Done:<br/>    {#each todos.filter(t =&gt; t.done) as todo}<br/>      &lt;div <br/>        in:receive="{{key: todo.id}}"<br/>        out:send="{{key: todo.id}}"<br/>      &gt;<br/>        {todo.description}<br/>        &lt;button on:click={mark(todo.id, false)}&gt;Not Done&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    {/each}<br/>  &lt;/div&gt;<br/>  &lt;div&gt;<br/>    Not Done:<br/>    {#each todos.filter(t =&gt; !t.done) as todo}<br/>      &lt;div<br/>        in:receive="{{key: todo.id}}"<br/>        out:send="{{key: todo.id}}"<br/>      &gt;<br/>        {todo.description}<br/>        &lt;button on:click={mark(todo.id, true)}&gt; Done&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    {/each}<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="3395" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们用<code class="fe me mf mg mh b">crossfade</code>函数创建了<code class="fe me mf mg mh b">send</code>和<code class="fe me mf mg mh b">receive</code>转换函数。</p><p id="aaca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当<code class="fe me mf mg mh b">send</code>没有对应的<code class="fe me mf mg mh b">receive</code>时，就会使用<code class="fe me mf mg mh b">fallback</code>动画，反之亦然，如果我们没有在两个元素之间移动一个元素，就会发生这种情况。</p><p id="9b55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回退动画只是对正在制作动画的元素进行一些缩放和不透明度更改。</p><p id="c177" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们为已完成和未完成的项目呈现2个todo列表。当我们单击todo项旁边的Done或Not Done按钮时，我们会看到一个淡入淡出效果，因为该项在包含div之间移动。</p><p id="c683" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是通过<code class="fe me mf mg mh b">in</code>和<code class="fe me mf mg mh b">out</code>动画实现的，我们传入一个带有<code class="fe me mf mg mh b">key</code>属性的对象，其值设置为<code class="fe me mf mg mh b">id</code>，这样Svelte就知道我们正在移动哪个元素。</p><h1 id="4ea9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c811" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当涉及多个元素时，我们可以使用<code class="fe me mf mg mh b">crossfade</code>来协调转换。</p><p id="75ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们使用局部过渡来动画显示正在呈现的列表项。</p><p id="e77d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们可以通过监听在转换过程中发出的事件来跟踪转换效果。</p><h2 id="6b53" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="4553" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="kf ir">JavaScript in Plain English</strong></a><a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！</p><p id="6116" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们总是有兴趣帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>