<html>
<head>
<title>ESLint — A Proofreader for your Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ESLint——您代码的校对者</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/eslint-a-proofreader-for-your-code-cd7e56ae391f?source=collection_archive---------6-----------------------#2020-09-29">https://javascript.plainenglish.io/eslint-a-proofreader-for-your-code-cd7e56ae391f?source=collection_archive---------6-----------------------#2020-09-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7fbe" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">设置和使用ESLint的实用指南</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/23e9764b6c12f6b3ea40b1683342c70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vppG1w45m6CX6aPLpyJtkw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">How to Maintain a High Quality Codebase?</figcaption></figure><h1 id="699a" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">我的旅程</h1><p id="8090" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">我不断地问自己，我如何维护一个高质量的代码库？很明显，答案很简单——维护一个好的编码标准。然而，不那么简单的是什么应该是这个标准的一部分，以及我如何执行这个标准。</p><p id="aa1f" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">我没有一个好的答案。我尽力想出了自己的标准，并试图在代码评审中强制执行这个标准。但这还不够。我的“标准”是不断变化的，事情不断地滑过代码审查。当我了解到ESLint后，这一切都改变了。</p><h1 id="620d" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">埃斯林特</h1><p id="8175" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated"><a class="ae ml" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> ESLint </a>是Javascript的linter。它的工作原理是分析您的代码，并在违反任何配置规则时向您发出警告。这些规则可以检测可疑的或关于编码质量或格式的问题。它类似于Google Doc或Microsoft Word的拼写和语法检查——本质上是对代码的自动校对！这正是我所需要的。我可以从ESLint的大量规则中创建一个编码标准，并让ESLint执行它们。</p><p id="1aff" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">事实证明，我已经在使用ESLint了——只是不是以一种有效的方式。<a class="ae ml" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> Create React App </a>附带原生ESLint配置，但非常基础。我需要更新这个配置，这样我的自动校对程序可以让我成为一个更好的开发人员。</p><h1 id="90e8" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">设置</h1><p id="b2df" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">首先，ESLint提供了一个方便的设置工具。运行<code class="fe mm mn mo mp b">npx eslint --init</code>，你将被询问一系列问题，这些问题将帮助ESLint创建你的初始设置。</p><blockquote class="mq"><p id="c1ea" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">您希望如何使用ESLint？仅检查语法、检查语法并查找问题，或者检查语法、查找问题并强制代码样式。</p></blockquote><p id="73ec" class="pw-post-body-paragraph lk ll in lm b ln na jo lp lq nb jr ls lt nc lv lw lx nd lz ma mb ne md me mf ig bi translated">我推荐选择<em class="nf">检查语法，发现问题，并执行代码风格</em>来充分利用ESLint。</p><blockquote class="mq"><p id="0e2b" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">你的项目使用什么类型的模块？JavaScript模块(导入/导出)，CommonJS(要求/导出)，或者都不是。</p><p id="ea51" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">你的项目使用哪个框架？React，Vue.js，或者都不是。</p><p id="99d9" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">您的项目使用TypeScript吗？是或不是。</p><p id="6828" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">你的代码在哪里运行？浏览器、节点或两者。</p></blockquote><p id="c637" class="pw-post-body-paragraph lk ll in lm b ln na jo lp lq nb jr ls lt nc lv lw lx nd lz ma mb ne md me mf ig bi translated">这些将取决于您的代码库。</p><blockquote class="mq"><p id="1699" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">您希望如何定义项目的样式？使用流行的风格指南，或者回答关于你的风格的问题，或者检查你的JavaScript文件。</p></blockquote><p id="d8c7" class="pw-post-body-paragraph lk ll in lm b ln na jo lp lq nb jr ls lt nc lv lw lx nd lz ma mb ne md me mf ig bi translated">我建议使用流行的风格指南。这将使您能够利用专家花费数千小时构建的风格指南。你可以免费得到它！</p><blockquote class="mq"><p id="d5aa" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">你想遵循哪种风格指南？<a class="ae ml" href="https://github.com/airbnb/javascript" rel="noopener ugc nofollow" target="_blank"> Airbnb </a>，<a class="ae ml" href="https://github.com/standard/standard" rel="noopener ugc nofollow" target="_blank"> Standard </a>，或者<a class="ae ml" href="https://github.com/google/eslint-config-google" rel="noopener ugc nofollow" target="_blank"> Google </a>。</p></blockquote><p id="fff8" class="pw-post-body-paragraph lk ll in lm b ln na jo lp lq nb jr ls lt nc lv lw lx nd lz ma mb ne md me mf ig bi translated">我强烈推荐使用Airbnb。据我所知，这是最流行的风格指南，我认为它是Javascript社区事实上的标准。</p><blockquote class="mq"><p id="4866" class="mr ms in bd mt mu mv mw mx my mz mf dk translated">您希望您的配置文件采用什么格式？JavaScript、YAML或JSON。</p></blockquote><p id="732e" class="pw-post-body-paragraph lk ll in lm b ln na jo lp lq nb jr ls lt nc lv lw lx nd lz ma mb ne md me mf ig bi translated">这取决于你，但是请记住——我们是Javascript开发者！</p><p id="189e" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">一旦问卷完成，ESLint将安装所有必要的依赖项，并在<code class="fe mm mn mo mp b">.eslintrc.js</code>中创建您的基本配置。</p><h1 id="e1b1" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">配置</h1><p id="f4a9" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">现在我们有了一个基本配置，让我们来了解它的功能。三个主要部分是<a class="ae ml" href="#2d54" rel="noopener ugc nofollow">规则</a>、<a class="ae ml" href="#3a02" rel="noopener ugc nofollow">插件</a>和<a class="ae ml" href="#e6de" rel="noopener ugc nofollow">扩展</a>。</p><h1 id="2d54" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">规则</h1><p id="ec84" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">在配置的<code class="fe mm mn mo mp b">rules</code>部分定义的规则决定了ESLint校对程序在你的代码中寻找什么。ESLint为<a class="ae ml" href="https://eslint.org/docs/rules/" rel="noopener ugc nofollow" target="_blank">提供了数百条帮助维护代码质量的规则。这些规则可以设置为<code class="fe mm mn mo mp b">off</code>、<code class="fe mm mn mo mp b">warn</code>或<code class="fe mm mn mo mp b">error</code>。<code class="fe mm mn mo mp b">off</code>什么都不做，<code class="fe mm mn mo mp b">warn</code>将记录错误，<code class="fe mm mn mo mp b">error</code>将记录错误并返回1退出代码，因此集成(如连续集成)将失败。</a></p><pre class="kd ke kf kg gt ng mp nh ni aw nj bi"><span id="4713" class="nk kt in mp b gy nl nm l nn no">module.exports = {<br/>  rules: {<br/>    'no-underscore-dangle': 'off',<br/>    'no-console': 'warn',<br/>    'no-empty': 'error',<br/>  },<br/>}</span></pre><p id="f587" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">有些规则还允许您使用附加配置选项来自定义规则，这样您就不必关闭整个规则。</p><pre class="kd ke kf kg gt ng mp nh ni aw nj bi"><span id="43d5" class="nk kt in mp b gy nl nm l nn no">module.exports = {<br/>  rules: {<br/>    'no-empty': ['error', { allowEmptyCatch: true }],<br/>  },<br/>}</span></pre><h1 id="3a02" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">插件</h1><p id="7d90" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">但规则远不止这些。ESLint还提供插件，定义在配置的<code class="fe mm mn mo mp b">plugins</code>部分，允许第三方自己开发规则。大多数已建立的框架，如<a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-react" rel="noopener ugc nofollow" target="_blank"> React </a>、<a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-jest" rel="noopener ugc nofollow" target="_blank"> Jest </a>和<a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-testing-library" rel="noopener ugc nofollow" target="_blank">测试库</a>，利用这一点并扩展ESLint的本地规则。事实上，我通常通过检查一个框架是否有自己的ESLint规则来评估它的成熟度！</p><pre class="kd ke kf kg gt ng mp nh ni aw nj bi"><span id="4a0c" class="nk kt in mp b gy nl nm l nn no">module.exports = {<br/>  plugins: ['react'],<br/>  rules: {<br/>    'react/no-deprecated': 'error',<br/>  },<br/>};</span></pre><h1 id="e6de" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">扩展ˌ扩张</h1><p id="2f6d" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">总的来说，有成千上万的ESLint规则。如果不花费数周时间去理解所有规则，您怎么可能决定启用哪些规则呢？你不需要——在配置的<code class="fe mm mn mo mp b">extends</code>部分定义的扩展会为你处理。像<a class="ae ml" href="https://www.npmjs.com/package/eslint-config-airbnb" rel="noopener ugc nofollow" target="_blank"> Airbnb的ESLint配置、</a>ESLint设置工具提供的一些扩展，如果你选择了Airbnb的风格指南，已经启用了数百个规则；如果您使用它们的扩展，也会为您启用这些规则。</p><p id="ec7e" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">以下是常见Javascript框架中一些值得注意的ESLint配置:</p><ul class=""><li id="4ecf" class="np nq in lm b ln mg lq mh lt nr lx ns mb nt mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b"><a class="ae ml" href="https://www.npmjs.com/package/eslint-config-airbnb" rel="noopener ugc nofollow" target="_blank">airbnb</a></code> — Airbnb的ESLint配置，用于其Javascript风格指南</li><li id="7e41" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b"><a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-react-hooks" rel="noopener ugc nofollow" target="_blank">plugin:react-hooks/recommended</a></code> —推荐用于<a class="ae ml" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">反应钩</a>的ESLint配置</li><li id="3419" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b"><a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-react" rel="noopener ugc nofollow" target="_blank">plugin:react/recommended</a></code> —为<a class="ae ml" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>推荐的ESLint配置</li><li id="051e" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b"><a class="ae ml" href="https://github.com/DianaSuvorova/eslint-plugin-react-redux" rel="noopener ugc nofollow" target="_blank">plugin:react-redux/recommended</a></code> —推荐用于<a class="ae ml" href="https://www.npmjs.com/package/react-redux" rel="noopener ugc nofollow" target="_blank"> React Redux </a>的ESLint配置</li><li id="a588" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b"><a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-jest" rel="noopener ugc nofollow" target="_blank">plugin:jest/recommended</a></code> —为<a class="ae ml" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>推荐的ESLint配置</li><li id="70f7" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b"><a class="ae ml" href="https://www.npmjs.com/package/eslint-plugin-testing-library" rel="noopener ugc nofollow" target="_blank">plugin:testing-library/r</a>eact</code>—<a class="ae ml" href="https://testing-library.com/" rel="noopener ugc nofollow" target="_blank">React测试库</a>的推荐ESLint配置</li></ul><h1 id="8ed6" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">覆盖+禁用</h1><p id="b979" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">使用扩展的一个副作用是您可能不喜欢它们的所有规则。幸运的是，您可以在<code class="fe mm mn mo mp b">rules</code>部分定制或关闭这些规则。</p><pre class="kd ke kf kg gt ng mp nh ni aw nj bi"><span id="c08f" class="nk kt in mp b gy nl nm l nn no">module.exports = {<br/>  extends: ['airbnb', 'plugin:react/recommended'],<br/>  rules: {<br/>    'no-empty': ['error', { allowEmptyCatch: true }],<br/>    'react/jsx-filename-extension': [<br/>      'error',<br/>      { extensions: ['.js', '.jsx'] }<br/>    ],<br/>  },<br/>};</span></pre><p id="fe56" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">即使喜欢一个规则，有时候也会遇到想暂时禁用的情况。您可以使用注释来实现这一点。</p><ul class=""><li id="65b1" class="np nq in lm b ln mg lq mh lt nr lx ns mb nt mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b">/* eslint-disable */</code>:禁用下面所有行的ESLint</li><li id="1721" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b">/* eslint-disable-line */</code>:禁用当前行的ESLint</li><li id="e057" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><code class="fe mm mn mo mp b">/* eslint-disable-next-line */</code>:禁用下一行的ESLint</li></ul><p id="c836" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">您还可以在禁用注释后指定(逗号分隔)规则，以专门禁用这些规则，而不是禁用所有规则。</p><pre class="kd ke kf kg gt ng mp nh ni aw nj bi"><span id="735d" class="nk kt in mp b gy nl nm l nn no">import React from 'react';<br/>import PropTypes from 'prop-types';</span><span id="4d41" class="nk kt in mp b gy od nm l nn no"><em class="nf">/* eslint-disable */</em><br/>import ReactDom from 'react-dom';<br/><em class="nf">/* eslint-enable */</em></span><span id="89e4" class="nk kt in mp b gy od nm l nn no"><em class="nf">/* eslint-disable-line arrow-body-style */</em> const App = () =&gt; {<br/>  return &lt;h1&gt;ESLint Demo&lt;/h1&gt;;<br/>};<br/>App.propTypes = {<br/>  <em class="nf">/* eslint-disable-next-line react/no-unused-prop-types, react-redux/no-unused-prop-types */</em><br/>  unused: PropTypes.string.isRequired,<br/>};</span><span id="da89" class="nk kt in mp b gy od nm l nn no">export default App;</span></pre><p id="9923" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated">当然，如果您发现自己一遍又一遍地禁用同一个规则，您可能要考虑永久禁用它。</p><h1 id="1b85" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">运转</h1><p id="d83e" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">现在我们已经有了想要的配置，终于到了运行ESLint的时候了。为此，将以下内容添加到您的<code class="fe mm mn mo mp b">package.json</code>中。</p><pre class="kd ke kf kg gt ng mp nh ni aw nj bi"><span id="0406" class="nk kt in mp b gy nl nm l nn no">{<br/>  "scripts": {<br/>    "lint": "eslint . ",<br/>    "lint:fix": "eslint . --fix",<br/>  },<br/>}</span></pre><p id="6e9b" class="pw-post-body-paragraph lk ll in lm b ln mg jo lp lq mh jr ls lt mi lv lw lx mj lz ma mb mk md me mf ig bi translated"><code class="fe mm mn mo mp b">npm run lint</code>将运行ESLint，任何错误和警告都将打印到控制台。修复并重复。<code class="fe mm mn mo mp b">npm run lint:fix</code>也会运行ESLint，但也会尝试并自动修复任何违反的规则。任何无法自动修复的规则都将被打印到控制台。</p></div><div class="ab cl oe of hr og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ig ih ii ij ik"><h1 id="36e0" class="ks kt in bd ku kv ol kx ky kz om lb lc jt on ju le jw oo jx lg jz op ka li lj bi translated">最后的想法</h1><p id="6fca" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">现在，您应该已经开始使用ESLint了。下一步是修复任何违规— <a class="ae ml" href="https://medium.com/javascript-in-plain-english/how-i-dealt-with-over-30-000-eslint-errors-640472eecc0" rel="noopener">我不得不自己处理超过30，000个错误</a>！但我认为从长远来看这是值得的。ESLint监督并指导我创建和维护高质量的代码库，这样我就不必纠结于小细节。相反，我可以专注于创造更好的产品。</p></div><div class="ab cl oe of hr og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ig ih ii ij ik"><h1 id="a2b0" class="ks kt in bd ku kv ol kx ky kz om lb lc jt on ju le jw oo jx lg jz op ka li lj bi translated">资源</h1><ul class=""><li id="f405" class="np nq in lm b ln lo lq lr lt oq lx or mb os mf nu nv nw nx bi translated"><a class="ae ml" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank">官方ESLint文档</a></li><li id="0b1e" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><a class="ae ml" href="https://github.com/mjchang/medium/tree/master/eslint" rel="noopener ugc nofollow" target="_blank">本文Github回购</a></li><li id="6f4c" class="np nq in lm b ln ny lq nz lt oa lx ob mb oc mf nu nv nw nx bi translated"><a class="ae ml" href="https://codesandbox.io/s/github/mjchang/medium/tree/master/eslint" rel="noopener ugc nofollow" target="_blank">本文的code sandbox</a></li></ul></div></div>    
</body>
</html>