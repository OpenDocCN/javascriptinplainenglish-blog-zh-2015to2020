<html>
<head>
<title>Easily Improve the Performance of your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻松提高React应用的性能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/easily-improve-performance-of-your-react-app-afc22ffe1cae?source=collection_archive---------5-----------------------#2020-02-24">https://javascript.plainenglish.io/easily-improve-performance-of-your-react-app-afc22ffe1cae?source=collection_archive---------5-----------------------#2020-02-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ef5e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解什么是PureComponents，以及如何使用它们来改进React应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/36883836d7d200b68a85ff8261c7bff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7WeY5LVzr0c01j0F"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@baciutudor?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tudor Baciu</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="03e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将了解如何轻松提高React应用程序的性能。</p><p id="df52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以让我们开始吧。</p><p id="8a4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们举一个简单的例子，向列表中添加一个项目，然后将所有添加的项目呈现在屏幕上。</p><p id="d93e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了视觉上的简单，我们将在一个文件中声明所有的组件，但是对于真正的应用程序，您应该在一个单独的文件中编写每个组件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="ead9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现场演示:<a class="ae kv" href="https://curcf.csb.app/" rel="noopener ugc nofollow" target="_blank">https://curcf.csb.app/</a></p><p id="0b02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来理解代码。</p><p id="6262" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.在<code class="fe lu lv lw lx b">AddItemForm</code>组件中，我们显示表单来接受用户输入。</p><p id="9179" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.在<code class="fe lu lv lw lx b">Items</code>组件中，我们遍历所有输入值，并在<code class="fe lu lv lw lx b">Item</code>组件中显示每个值</p><p id="2505" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.在<code class="fe lu lv lw lx b">AddItem</code>组件中，我们维护存储用户输入值的全局状态，并呈现<code class="fe lu lv lw lx b">AddItemForm</code>和<code class="fe lu lv lw lx b">Items</code>组件</p><p id="f524" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ly">如果您打开react devtools，在“组件”选项卡中单击滚轮图标并选择“组件渲染时高亮显示更新”复选框，然后您将能够看到组件何时被重新渲染</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lz"><img src="../Images/a84a6dc2c055bc5a12aea54fe7b07f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjMzDw_ahwfErGp_wnveNg.png"/></div></div></figure><p id="f508" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从<a class="ae kv" href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en" rel="noopener ugc nofollow" target="_blank">这里</a>安装chrome的扩展，如果你没有安装的话。</p><p id="d103" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，当您添加新项目时，您将看到对于添加的每个项目，整个项目列表都被重新呈现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/46c040428ec1f356b3955af979357fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IXN5rOVDAGFKMoU82xujXw.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image Describing Every item’s render</figcaption></figure><blockquote class="mb"><p id="5c7e" class="mc md iq bd me mf mg mh mi mj mk lr dk translated">实际上，react足够智能，因为我们已经为Items组件中的每个项目提供了唯一的键，react不会重新创建每个元素，而只是调用每个元素的render方法</p></blockquote><p id="21a3" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如您所见，对数组中的每个元素都调用了render方法。在这种情况下，这不是一个大的性能问题，因为我们只有几个项目，但如果我们显示1k或10k记录，那么这将是一个开销。</p><p id="a639" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，为了提高应用程序的性能，我们可以在<code class="fe lu lv lw lx b">Item</code>组件中实现<code class="fe lu lv lw lx b">shouldComponentUpdate</code>生命周期方法</p><p id="99c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lu lv lw lx b">shouldComponentUpdate</code>方法将<code class="fe lu lv lw lx b">nextProps</code>和<code class="fe lu lv lw lx b">nextState</code>作为它们的参数，并在<code class="fe lu lv lw lx b">render</code>方法之前被调用，因此如果我们从<code class="fe lu lv lw lx b">shouldComponentUpdate</code>返回false，将不会调用<code class="fe lu lv lw lx b">render</code>方法，也不会重新呈现组件。</p><p id="76e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了实现生命周期方法，我们将把<code class="fe lu lv lw lx b">Item</code>组件转换成基于类的组件。</p><pre class="kg kh ki kj gt mq lx mr ms aw mt bi"><span id="bd40" class="mu mv iq lx b gy mw mx l my mz">class Item extends React.Component {<br/> shouldComponentUpdate(nextProps, nextState) {<br/>  if (nextProps.item === this.props.item) {<br/>    return false;<br/>  }<br/> }<br/> <br/> render() {<br/>  return &lt;li&gt;{this.props.item}&lt;/li&gt;;<br/> }<br/>}</span></pre><p id="01f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们将添加的新值与项目的当前值进行比较。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/44e1a077224ea2df0c2490f77b2bf466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Aw7tD-yUsU3ZJnE74bsM9g.gif"/></div></div></figure><p id="ed79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如您现在所看到的，所有项目都没有被重新渲染，只有新添加的项目会被渲染。您也可以通过在<code class="fe lu lv lw lx b">Item</code>组件的<code class="fe lu lv lw lx b">render</code>方法中添加<code class="fe lu lv lw lx b">console.log(this.props.item);<br/></code>来验证它。</p><p id="ada2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代号:<a class="ae kv" href="https://codesandbox.io/s/cold-rain-y454e" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/cold-rain-y454e</a></p><p id="0ba5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现场演示:<a class="ae kv" href="https://y454e.csb.app/" rel="noopener ugc nofollow" target="_blank">https://y454e.csb.app/</a></p><p id="2ef6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">几个改进:</strong></p><ol class=""><li id="c147" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">由于我们只是在<code class="fe lu lv lw lx b">shouldComponentUpdate</code>方法中比较<code class="fe lu lv lw lx b">nextProp</code>值和当前属性值，我们可以通过扩展<code class="fe lu lv lw lx b">React.PureComponent</code>而不是<code class="fe lu lv lw lx b">React.Component</code>并删除<code class="fe lu lv lw lx b">shouldComponentUpdate</code>方法来简化代码。</li></ol><pre class="kg kh ki kj gt mq lx mr ms aw mt bi"><span id="893e" class="mu mv iq lx b gy mw mx l my mz">class Item extends React.PureComponent {<br/> render() {<br/>  return &lt;li&gt;{this.props.item}&lt;/li&gt;;<br/> }<br/>}</span></pre><p id="5087" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lu lv lw lx b">React.PureComponent</code>类似于<code class="fe lu lv lw lx b">React.Component</code>。两者的区别在于，<code class="fe lu lv lw lx b">React.Component</code>不实现<code class="fe lu lv lw lx b">shouldComponentUpdate()</code>，而<code class="fe lu lv lw lx b">React.PureComponent</code>用一个浅层的道具和状态比较来实现。</p><p id="5c80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代号:<a class="ae kv" href="https://codesandbox.io/s/hungry-frog-0tuqd" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/hungry-frog-0tuqd</a></p><p id="3065" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现场演示:<a class="ae kv" href="https://0tuqd.csb.app/" rel="noopener ugc nofollow" target="_blank">https://0tuqd.csb.app/</a></p><p id="0e9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.如果您的组件是一个功能组件，那么您可以通过将组件传递给<code class="fe lu lv lw lx b">React.memo</code>方法，而不是将其转换为类组件来添加<code class="fe lu lv lw lx b">shouldComponentUpdate </code>方法，这将给出与<code class="fe lu lv lw lx b">PureComponent</code>相同的结果，如下所示</p><pre class="kg kh ki kj gt mq lx mr ms aw mt bi"><span id="a655" class="mu mv iq lx b gy mw mx l my mz">const Item = React.memo(props =&gt; &lt;li&gt;{props.item}&lt;/li&gt;);</span></pre><p id="0754" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天到此为止。希望你今天学到了新东西。</p><p id="8227" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">别忘了直接在你的收件箱</strong> <a class="ae kv" href="https://yogeshchavan.dev" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里</strong> </a> <strong class="ky ir">订阅我的每周时事通讯，里面有惊人的技巧、诀窍和文章。</strong></p><h2 id="c183" class="mu mv iq bd nk nl nm dn nn no np dp nq lf nr ns nt lj nu nv nw ln nx ny nz oa bi translated">进一步阅读</h2><div class="ob oc gp gr od oe"><a rel="noopener  ugc nofollow" target="_blank" href="/5-tools-practices-to-help-you-develop-faster-in-react-b884c1b20fc2"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">帮助您在React中更快开发的5种工具和实践</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">React工具、技巧和最佳实践将帮助您更快地构建应用</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="on l"><div class="oo l op oq or on os kp oe"/></div></div></a></div><p id="6ebe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ly">更多内容请看</em><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ly">plain English . io</em></strong></a><em class="ly">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ly">免费周报</em> </strong> </a> <em class="ly">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ly">Twitter</em></strong></a><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ly">LinkedIn</em></strong></a><em class="ly"/><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ly">YouTube</em></strong></a><em class="ly"/><a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ly">不和</em> </strong> </a> <em class="ly">。</em></p></div></div>    
</body>
</html>