<html>
<head>
<title>Using Template Engines with Express</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Express中使用模板引擎</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-template-engines-with-express-704881d0f79c?source=collection_archive---------2-----------------------#2020-02-08">https://javascript.plainenglish.io/using-template-engines-with-express-704881d0f79c?source=collection_archive---------2-----------------------#2020-02-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6d9123e07fd88c4ddef9657935d15408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Aakr8Oonf-cDLF81"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@tranmautritam?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tran Mau Tri Tam</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bd08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了呈现带有快速路由的HTML响应，我们应该将它作为插入了变量的模板返回，而不是直接作为HTML字符串返回。</p><p id="f1e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模板很方便，我们可以用比HTML字符串更灵活的方式使用它们。</p><p id="4996" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何设置我们的应用程序的模板引擎，并返回HTML响应。</p><h1 id="9baf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">选择模板引擎</h1><p id="f1ec" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在Express中使用流行的模板引擎，比如Pug、Mustache和EJS。Express application generator的缺省值是Jade，但是我们也可以使用列出的其他值。</p><p id="751a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了渲染模板文件，我们可以设置应用程序设置。要设置模板文件夹，我们可以通过编写以下代码来设置<code class="fe me mf mg mh b">views</code>属性:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="94de" class="mq lc iq mh b gy mr ms l mt mu">app.set('views', './views')</span></pre><p id="7084" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它会将模板文件夹设置到我们应用程序的<code class="fe me mf mg mh b">views</code>目录。</p><p id="c1c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以通过设置<code class="fe me mf mg mh b">view engine</code>属性来设置我们想要使用的视图引擎，如下所示:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7b0b" class="mq lc iq mh b gy mr ms l mt mu">app.set('view engine', 'pug')</span></pre><p id="56bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装模板引擎库，我们可以运行如下代码:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4d43" class="mq lc iq mh b gy mr ms l mt mu">npm install pug --save</span></pre><p id="9ef0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的命令将安装<code class="fe me mf mg mh b">pug</code>视图引擎供我们使用。</p><h1 id="cefe" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用模板引擎呈现项目</h1><p id="01a3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">res.render</code>方法将变量呈现到模板中。</p><p id="d4d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们创建<code class="fe me mf mg mh b">views</code>文件夹来存储我们的模板，因为我们将<code class="fe me mf mg mh b">./views</code>文件夹设置为模板文件夹。</p><p id="dd29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们选择使用Pug作为我们的模板引擎，模板文件应该有<code class="fe me mf mg mh b">.pug</code>扩展名。</p><p id="b3eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">views</code>文件夹中，创建一个<code class="fe me mf mg mh b">index.pug</code>，然后将:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="76dc" class="mq lc iq mh b gy mr ms l mt mu">html<br/>  head<br/>    title= title<br/>  body<br/>    h1= message</span></pre><p id="9ebe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">title=</code>和<code class="fe me mf mg mh b">h1=</code>是我们的标签，<code class="fe me mf mg mh b">title</code>和<code class="fe me mf mg mh b">message</code>是Express用来从对象中获取值的键，我们将把这些值传递给<code class="fe me mf mg mh b">res.render</code>。</p><p id="bf07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以在与<code class="fe me mf mg mh b">views</code>文件夹相同的级别中创建<code class="fe me mf mg mh b">index.js</code>，并添加:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b4ae" class="mq lc iq mh b gy mr ms l mt mu">const express = require('express')<br/>const app = express()<br/>app.use(express.json())<br/>app.use(express.urlencoded({ extended: true }))<br/>app.set('views', './views');<br/>app.set('view engine', 'pug');</span><span id="065f" class="mq lc iq mh b gy mv ms l mt mu">app.get('/', (req, res, next) =&gt; {<br/>  res.render('index', { pageTitle: 'Hello', pageMessage: 'Hello there!' });<br/>})</span><span id="d62d" class="mq lc iq mh b gy mv ms l mt mu">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="08f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们调用了<code class="fe me mf mg mh b">res.render</code>来呈现一个HTML响应。对象:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="bd71" class="mq lc iq mh b gy mr ms l mt mu">{ pageTitle: 'Hello', pageMessage: 'Hello there!' }</span></pre><p id="fbad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将被传递给我们的<code class="fe me mf mg mh b">index.pug</code>模板。</p><p id="09a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">title</code>将<code class="fe me mf mg mh b">title</code>换成:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3792" class="mq lc iq mh b gy mr ms l mt mu">html<br/>  head<br/>    title= pageTitle<br/>  body<br/>    h1= pageMessage</span></pre><p id="cfc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">message</code>将被<code class="fe me mf mg mh b">'Hello there!'</code>取代。标签和等号右边的任何内容都将被上面给出的键值替换。</p><p id="132f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">换句话说，<code class="fe me mf mg mh b">pageTitle </code>和<code class="fe me mf mg mh b">pageMessage</code>属性‘值’是分别位于<code class="fe me mf mg mh b">title</code>和<code class="fe me mf mg mh b">h1</code>标签之间的值。</p><p id="9ae2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们得到了</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8de497e743943d3f840d8062e903648d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*NZveSR9C3jb5p2Uo8iiQZg.png"/></div></figure><p id="661e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们页面的标题将是<code class="fe me mf mg mh b">'Hello'</code>。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/8b3769c363e611349c86b291c61708c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ezkKgYUZ_CTHzR_j"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@star2dev?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Bruce Galpin</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="c066" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Pug语法</h1><p id="aa29" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">除了变量，我们还可以有动态表达式。循环和条件表达式是Pug的一部分。</p><h2 id="30af" class="mq lc iq bd ld my mz dn lh na nb dp ll ko nc nd lp ks ne nf lt kw ng nh lx ni bi translated">HTML标签</h2><p id="d4fb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Pug可以使用其他HTML标签。</p><p id="6588" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，链接可以写成如下形式:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="381e" class="mq lc iq mh b gy mr ms l mt mu">a(href='http://medium.com') Medium</span></pre><p id="fc3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，<code class="fe me mf mg mh b">Medium</code>位于<code class="fe me mf mg mh b">a</code>标记之间，<code class="fe me mf mg mh b">href=’http://medium.com'</code>分别是<code class="fe me mf mg mh b">href</code>属性和值。</p><h2 id="4ddb" class="mq lc iq bd ld my mz dn lh na nb dp ll ko nc nd lp ks ne nf lt kw ng nh lx ni bi translated">环</h2><p id="bc12" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们也可以用Pug写循环。例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1205" class="mq lc iq mh b gy mr ms l mt mu">const express = require('express')<br/>const app = express()<br/>app.use(express.json())<br/>app.use(express.urlencoded({ extended: true }))<br/>app.set('views', './views');<br/>app.set('view engine', 'pug');</span><span id="5f41" class="mq lc iq mh b gy mv ms l mt mu">app.get('/', (req, res, next) =&gt; {<br/>  res.render('index', { pageTitle: 'Hello', pageMessages: ['Hi', 'Bye'] });<br/>})</span><span id="91ed" class="mq lc iq mh b gy mv ms l mt mu">app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="92cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">index.js</code>和:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b06a" class="mq lc iq mh b gy mr ms l mt mu">html<br/>  head<br/>    title= pageTitle<br/>  body<br/>    ul<br/>      each pageMessage in pageMessages<br/>        li= pageMessage</span></pre><p id="959f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">views/index.pug</code>中，我们会得到:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/7160f843916ed99e3969e349ed4db7c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*fMii3_r8PSkHqY0J-3zJ3Q.png"/></div></figure><h2 id="42d2" class="mq lc iq bd ld my mz dn lh na nb dp ll ko nc nd lp ks ne nf lt kw ng nh lx ni bi translated">条件式</h2><p id="4d04" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以在Pug模板中添加条件表达式。例如，如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d1cb" class="mq lc iq mh b gy mr ms l mt mu">const express = require('express')<br/>const app = express()<br/>app.use(express.json())<br/>app.use(express.urlencoded({ extended: true }))<br/>app.set('views', './views');<br/>app.set('view engine', 'pug');</span><span id="3ac6" class="mq lc iq mh b gy mv ms l mt mu">app.get('/', (req, res, next) =&gt; {<br/>  res.render('index', { pageTitle: 'Hello', user: { type: 'member' }   });<br/>})<br/>app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="fc03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">index.js</code>和:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="75f0" class="mq lc iq mh b gy mr ms l mt mu">html<br/>  head<br/>    title= pageTitle<br/>  body<br/>    if user.type === 'anonymous'<br/>      p User type is anonyomous<br/>    else if user.type === 'member'<br/>      p User type is member<br/>    else<br/>      p User type is admin</span></pre><p id="be4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">views/index.pug</code>中，我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="574c" class="mq lc iq mh b gy mr ms l mt mu">'User type is member'</span></pre><p id="8f19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为<code class="fe me mf mg mh b">res.render</code>中的<code class="fe me mf mg mh b">user.type</code>被设置为<code class="fe me mf mg mh b">'member'</code>。</p><h1 id="cf6f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="87f8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们使用模板引擎来呈现HTML响应，那就很容易了。我们可以在<code class="fe me mf mg mh b">res.render</code>的第二个参数中传递一个对象来传递我们想要在模板中显示的值。</p><p id="1cd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用模板引擎，我们可以包含循环、条件和变量，使显示动态内容变得轻而易举。</p></div></div>    
</body>
</html>