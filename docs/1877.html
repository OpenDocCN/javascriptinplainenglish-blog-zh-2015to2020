<html>
<head>
<title>How to create a complex dynamic form in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中创建复杂的动态表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-complex-dynamic-form-in-angular-19a472af6060?source=collection_archive---------3-----------------------#2020-05-01">https://javascript.plainenglish.io/how-to-create-a-complex-dynamic-form-in-angular-19a472af6060?source=collection_archive---------3-----------------------#2020-05-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/57e12fc32976abbcc3414a43204f1e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0peOCl56jNr1KY2CswdDcQ.png"/></div></div></figure><p id="40cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">表单是web应用程序非常重要的一部分。有时我们会遇到表单元素是静态且定义良好的场景。有时候，web应用程序开发超越了静态表单，进入了动态表单。动态表单没有静态字段。动态窗体和控件可以基于某些事件生成。在本文中，我们将基于加号的点击来生成控件。点击减号按钮删除它。</p><p id="d30b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个芯片一样的结构，我们有加号和减号按钮来添加和删除文本字段。在本文中，我们举一个产品的例子。</p><h1 id="8861" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">角度设计</h1><p id="58b0" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">Angular支持两种动态控制设计。</p><ul class=""><li id="f08b" class="lz ma iq ka b kb kc kf kg kj mb kn mc kr md kv me mf mg mh bi translated"><strong class="ka ir">模板驱动- </strong>模板驱动表单中对角度模板有更多的控制。该模板非常强大，拥有Angular框架内置的大部分功能。我们只需要手工制作具有良好和干净设计的HTML。我正在使用这种方法。</li><li id="ae39" class="lz ma iq ka b kb mi kf mj kj mk kn ml kr mm kv me mf mg mh bi translated"><strong class="ka ir">反应型——</strong>再次非常强大，大部分的控制权都在组件上。需要Formbuilder来构建表单。</li></ul><h1 id="dd6f" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">构建动态组件</h1><p id="c8a3" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我们正在构建一个产品组件。产品有产品名称和产品代码。该产品还有另一个可选参数，即产品特性。产品功能包含功能名称、功能添加日期和功能描述。<strong class="ka ir"> <em class="mn">该功能可以随时添加。我们要添加的功能数量没有限制。屏幕看起来会像这样。</em> </strong></p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/46e327ffeb185c943f40eb744bb43b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VvENNR9h6uDY7UmXOAaDQQ.png"/></div></div></figure><h1 id="980a" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">模型设计</h1><p id="0d8d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">创建接口产品特征并将其传递给产品接口。产品界面像数组一样接受产品特性。下面是数据模型。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f8f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一步是创建子组件。是的，我正在这里创建一个子组件。因为在大多数企业应用程序中，我们应该创建一小组组件。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="b3e8" class="na kx iq mw b gy nb nc l nd ne">&lt;app-product-feature &gt;&lt;/app-product-feature&gt;</span></pre><p id="0edd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们必须将数据从子组件传递到父组件。所以这里定义parentProductFields函数，将数据设置到父组件中。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="58f9" class="na kx iq mw b gy nb nc l nd ne">&lt;app-product-feature (parentProductFields)="parentProductFields($event)"&gt;&lt;/app-product-feature&gt;</span></pre><p id="a761" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在父组件中创建parentProduct方法。该方法将设置this.productField，其类型为Product <productfeatures>。</productfeatures></p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="18c5" class="na kx iq mw b gy nb nc l nd ne">productField: Product&lt;productFeatures&gt; = {} as Product&lt;productFeatures&gt;;</span><span id="67a7" class="na kx iq mw b gy nf nc l nd ne">parentProductFields(value) {</span><span id="a40d" class="na kx iq mw b gy nf nc l nd ne">console.log(`calling hour recieved from parent is ${JSON.stringify(value)}`)</span><span id="2671" class="na kx iq mw b gy nf nc l nd ne">this.productField = value;</span><span id="d610" class="na kx iq mw b gy nf nc l nd ne">}</span></pre><p id="fafc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在产品目录下创建子组件产品特性。将父产品字段定义为@Output属性。parentProductFields属于产品类型<productfeatures>。</productfeatures></p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="43e3" class="na kx iq mw b gy nb nc l nd ne">@Output() parentProductFields = new EventEmitter&lt;Product&lt;productFeatures&gt;&gt;();</span></pre><p id="81ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用初始数据初始化。这里，产品id被初始化为1，其余的字段被初始化为空。产品特性数组保存一个对象，每当添加一个新特性时，我们将在特性数组中推送一个新特性对象。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="0a1b" class="na kx iq mw b gy nb nc l nd ne">productField: Product&lt;productFeatures&gt; = {</span><span id="5805" class="na kx iq mw b gy nf nc l nd ne">id: 1,</span><span id="96dc" class="na kx iq mw b gy nf nc l nd ne">productName: ‘’,</span><span id="0612" class="na kx iq mw b gy nf nc l nd ne">productCode: ‘’,</span><span id="5b4f" class="na kx iq mw b gy nf nc l nd ne">description: ‘’,</span><span id="37a4" class="na kx iq mw b gy nf nc l nd ne">productFeatures: [{</span><span id="c358" class="na kx iq mw b gy nf nc l nd ne">featureName:””,</span><span id="a5a9" class="na kx iq mw b gy nf nc l nd ne">featureAddedDate:””,</span><span id="8115" class="na kx iq mw b gy nf nc l nd ne">featureDescription:””</span><span id="c72d" class="na kx iq mw b gy nf nc l nd ne">}]</span><span id="e465" class="na kx iq mw b gy nf nc l nd ne">}</span></pre><p id="af77" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完整的产品组件将如下所示。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f175" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在手工制作HTML。在HTML产品名称中，产品代码是文本框。产品特性是一个动态表，我们通过迭代来生成动态组件。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="9154" class="na kx iq mw b gy nb nc l nd ne">&lt;tbody&gt;</span><span id="04a5" class="na kx iq mw b gy nf nc l nd ne">&lt;ng-template ngFor let-prod [ngForOf]=”productField.productFeatures” let-i=”index”&gt;<br/>&lt;tr&gt;&lt;td&gt;<br/>&lt;!-- Product feature here --&gt;</span><span id="c916" class="na kx iq mw b gy nf nc l nd ne">&lt;td&gt;</span><span id="9219" class="na kx iq mw b gy nf nc l nd ne">&lt;/tr&gt;<br/>&lt;/ng-template&gt;<br/>&lt;/tbody&gt;</span></pre><p id="21d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在开发这个控件的时候我发现了一个重要的事情。您必须为每个控件动态创建id。否则会创建控件的相同深层副本。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="0360" class="na kx iq mw b gy nb nc l nd ne">&lt;td&gt;</span><span id="635e" class="na kx iq mw b gy nf nc l nd ne">&lt;input class=”form-control minimal” <strong class="mw ir">id=”{{featureAddedDate + prod}}”</strong></span><span id="4f1f" class="na kx iq mw b gy nf nc l nd ne">[(ngModel)]=”prod.featureAddedDate”&gt;</span><span id="af50" class="na kx iq mw b gy nf nc l nd ne">&lt;/td&gt;</span></pre><p id="1d62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">完整HTML文件如下所示。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h2 id="4fe5" class="na kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated">添加产品功能</h2><p id="a6f5" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">要添加新产品功能，请添加以下代码行。此方法将新功能产品添加到this . product field . product features中</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="a2ec" class="na kx iq mw b gy nb nc l nd ne">addNewProdField(index: number): void {</span><span id="a26a" class="na kx iq mw b gy nf nc l nd ne">let prod: productFeatures = {</span><span id="3c46" class="na kx iq mw b gy nf nc l nd ne">“featureName”: “”,</span><span id="3aa2" class="na kx iq mw b gy nf nc l nd ne">“featureAddedDate”: “”,</span><span id="338b" class="na kx iq mw b gy nf nc l nd ne">“featureDescription”: “”</span><span id="7de9" class="na kx iq mw b gy nf nc l nd ne">} ;</span><span id="5516" class="na kx iq mw b gy nf nc l nd ne">this.productField.productFeatures.push(prod);</span><span id="5feb" class="na kx iq mw b gy nf nc l nd ne">console.log(`In method addNewProdField field index is ${index} and field is ${JSON.stringify(JSON.stringify( this.productField))}`);</span><span id="1a7b" class="na kx iq mw b gy nf nc l nd ne">this.parentProductFields.emit(this.productField);</span><span id="ed93" class="na kx iq mw b gy nf nc l nd ne">}</span></pre><h2 id="b759" class="na kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated">删除产品特征</h2><p id="841d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">若要删除产品功能，请从this . product field . product features拼接产品索引。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="05d5" class="na kx iq mw b gy nb nc l nd ne">removeNewProdField(index: number): void {</span><span id="5fc9" class="na kx iq mw b gy nf nc l nd ne">this.productField.productFeatures.splice(index, 1);</span><span id="7b49" class="na kx iq mw b gy nf nc l nd ne">console.log(`In method addNewProdField field index is ${index}`);</span><span id="1bd7" class="na kx iq mw b gy nf nc l nd ne">this.parentProductFields.emit(this.productField);</span><span id="0e51" class="na kx iq mw b gy nf nc l nd ne">}</span></pre><p id="1c2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要显示子组件数据的变化，请在父组件HTML中添加这一行。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="459f" class="na kx iq mw b gy nb nc l nd ne">&lt;pre&gt;</span><span id="b8c1" class="na kx iq mw b gy nf nc l nd ne">{{productField | json}}</span><span id="2793" class="na kx iq mw b gy nf nc l nd ne">&lt;/pre&gt;</span></pre><p id="3b49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在您可以看到添加字段的JSON数据。</p><pre class="mp mq mr ms gt mv mw mx my aw mz bi"><span id="3c8f" class="na kx iq mw b gy nb nc l nd ne">{<br/>  "id": 1,<br/>  "productName": "Netgear Wireless Router",<br/>  "productCode": "NG123",<br/>  "description": "",<br/>  "productFeatures": [<br/>    {<br/>      "featureName": "capacity",<br/>      "featureAddedDate": "05/01/2020",<br/>      "featureDescription": "123"<br/>    },<br/>    {<br/>      "featureName": "range",<br/>      "featureAddedDate": "05/01/2020",<br/>      "featureDescription": "123"<br/>    }<br/>  ]<br/>}</span></pre><h1 id="f352" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="7851" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">同样，我们可以将这个例子扩展到多种产品。使用*ngFor循环创建产品数组并显示。在这种情况下，我们应该有两个索引。一个指数代表产品，另一个指数代表产品特性。产品索引将有助于添加到产品阵列中，功能索引将有助于添加/删除产品功能。</p><p id="a330" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在stackblitz项目中附加完整的代码示例。实时项目。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nr mu l"/></div></figure><p id="f7e2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下载github项目以获得更多控制。</p><div class="ns nt gp gr nu nv"><a href="https://github.com/codingindepth/angular-dynamic-component-demo" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd ir gy z fp oa fr fs ob fu fw ip bi translated">编码深度/角度动态组件演示</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">由斯塔克布里兹·⚡️.创作通过创建一个……</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj jw nv"/></div></div></a></div></div></div>    
</body>
</html>