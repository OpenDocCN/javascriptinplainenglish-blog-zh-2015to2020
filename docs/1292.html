<html>
<head>
<title>The Core of Promises in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中承诺的核心</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-core-of-promises-in-javascript-4e4719de6c11?source=collection_archive---------5-----------------------#2020-02-25">https://javascript.plainenglish.io/the-core-of-promises-in-javascript-4e4719de6c11?source=collection_archive---------5-----------------------#2020-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d9136e0db68bc894a453e5458802958d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81qGhldzESYPFmG0mDJJ1A.png"/></div></div></figure><p id="adbd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们发现面试官问的一个常见的JavaScript概念是承诺。“解释什么是承诺”或“让我看看承诺是如何运作的。”那时，我们可能会回想起在我们的应用程序和<code class="fe kw kx ky kz b">.then(res =&gt; res.json())</code>中调用fetch API的场景。然而，我们当中有多少人能够真正解释什么是承诺的根源或承诺的核心基础？本博客旨在帮助所有迷失的叶。</p><h1 id="9a07" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">什么是承诺？</strong></h1><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Not quite, Mike Wheeler.</figcaption></figure><p id="6950" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">承诺是表示异步操作最终完成或失败的对象。这是对未来价值的一次性保证回报。对于异步操作，我们不确定返回值是什么，也不知道它什么时候会执行完。承诺是一个占位符，代表着具体的价值。为了帮助我们想象一个承诺在现实世界中会是什么样子，让我们假设我告诉我的猫，如果他和我击掌，我可能会给它一个奖励。我并不是在那个时候请他吃饭，而是告诉他，在他与我击掌之后，我可能会在不久的将来请他吃饭。</p><p id="da4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们学习承诺的基础时，有两件事我们需要理解。首先是如何创造一个承诺；如何创建一个返回承诺的函数？二是如何与承诺互动。</p><p id="c0ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通常，当您构建JavaScript应用程序时，您会向API发出请求。这个操作返回一个承诺，因为您正在发出一个HTTP请求，这需要时间。结果，你可能永远得不到它的价值，这是一个失败。或者它可能会成功，您可能会从API获得数据。因此，我们同时得到的返回对象是一个承诺。我们可以将回调附加到承诺上，而不是将回调传递给函数。</p><h1 id="84a6" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">创造承诺</strong></h1><p id="7ad4" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">让我们在这里创建一个名为willGiveCatATreat的承诺。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mn md l"/></div></figure><p id="c943" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们创建一个承诺时，我们传入一个带有两个参数的函数:<strong class="ka ir"> resolve </strong>和<strong class="ka ir"> reject </strong>，它们也是函数。如果我们叫“解决”，承诺将被解决，如果我们叫“拒绝”，承诺将被拒绝。如果我们既没有传递“resolve”也没有传递“reject ”,我们可以看到我们返回了一个promise对象，并且在第4行上状态被设置为“pending”。它既没有实现，也没有遭到拒绝。如果我立即调用“拒绝”，我们的承诺已经被拒绝，如第10行所示。如果我调用“resolve ”,我们的承诺的状态在第16行被设置为“resolved”。</p><p id="a9b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们让事情变得更令人兴奋一些，并在这里添加一些异步代码。我们将运行一个<code class="fe kw kx ky kz b">setTimeout()</code>，在3秒钟后，如果<code class="fe kw kx ky kz b">Math.random()</code>的结果大于0.5，则承诺被解决。如果<code class="fe kw kx ky kz b">Math.random()</code>小于0.5，则拒绝承诺。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mn md l"/></div></figure><h1 id="b214" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">与诺言为伍</strong></h1><p id="3e74" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">下一个重要的步骤是我们如何与承诺互动。如果这个承诺实现了，我们如何运行代码呢？被拒绝了怎么办？这就是<code class="fe kw kx ky kz b">.then()</code>的用武之地。</p><p id="b01f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每个承诺都有一个<strong class="ka ir">。然后()</strong>法。。然后()接受一个回调。如果该承诺被<strong class="ka ir">解决</strong>，第12 &amp; 13行将运行，并将console.log“万岁！！你得到了奖赏！！！😻".</p><p id="fe40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有另一种方法，我们可以调用一个承诺，这是<strong class="ka ir">。catch() </strong>。第15行&amp; 16将运行，如果承诺被<strong class="ka ir">拒绝</strong>并将console.log“对不起，猫，我撒谎了！没有招待你😿".</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mo md l"/></div></figure><p id="e84b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您在上面看到的，我们首先获得一个返回的promise对象，其状态设置为“pending”。等了3秒钟，我们终于看到承诺解决了！这只猫得到了一份礼物！😸</p><h1 id="8d75" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">从函数返回承诺</strong></h1><p id="4c24" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">另一件经常做的事情是从一个函数返回一个承诺，而不是像我们上面写的那样只做一个承诺。我们可以定义一个函数，<code class="fe kw kx ky kz b">const makeCatPromise</code>，这个函数会返回一个承诺。这是一种常见的模式，而不是从零开始构建一个承诺并将其保存到一个变量中。</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mn md l"/></div></figure><p id="f83b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将之前的<code class="fe kw kx ky kz b">willGiveCatATreat</code>函数变量改为<code class="fe kw kx ky kz b">makeCatPromise</code>，如第14行所示。我们也可以链上<code class="fe kw kx ky kz b">.catch()</code>18号线。我们可以将<code class="fe kw kx ky kz b">.then()</code>和<code class="fe kw kx ky kz b">.catch()</code>链接在一起，而不需要创建一个变量，也不需要再次引用承诺。如果承诺被解决，第16行运行。如果承诺被拒绝，第19行运行。</p><p id="2d27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是了。现在希望你能更好地谈论承诺！去参加那些技术面试吧！</p><h2 id="574d" class="mp lb iq bd lc mq mr dn lg ms mt dp lk kj mu mv lo kn mw mx ls kr my mz lw na bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="df5b" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到submissions@javascriptinplainenglish.com<a class="ae nb" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"/></a>给我们，我们会把你添加为作者。</p><p id="62e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还推出了三种新的出版物！请关注我们的新出版物:<a class="ae nb" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="ka ir">AI in Plain English</strong></a><a class="ae nb" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="ka ir">UX in Plain English</strong></a><a class="ae nb" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="ka ir">Python in Plain English</strong></a><strong class="ka ir"/>——谢谢，继续学习！</p><figure class="ly lz ma mb gt jr"><div class="bz fp l di"><div class="mc md l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Cat Tax</figcaption></figure></div></div>    
</body>
</html>