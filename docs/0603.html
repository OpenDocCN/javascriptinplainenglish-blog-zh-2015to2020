<html>
<head>
<title>Creating a searchable movie app using React, styled-components and React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React、styled-components和React Hooks创建一个可搜索的电影应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-a-searchable-movie-app-using-react-styled-components-and-react-hooks-8d149611d05c?source=collection_archive---------8-----------------------#2019-11-14">https://javascript.plainenglish.io/creating-a-searchable-movie-app-using-react-styled-components-and-react-hooks-8d149611d05c?source=collection_archive---------8-----------------------#2019-11-14</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/8fa79af679690f82aefebe3b962cdc05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v8f4s_aS7BdLolSz.png"/></div></div></figure><p id="1377" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">随着React Hooks成为新常态，它们无疑让我更加沉迷于React。前几天，我在这里评论了一个帖子<a class="ae kt" href="https://dev.to/manan30/comment/hk8a" rel="noopener ugc nofollow" target="_blank">，觉得我应该写这篇文章。在本文中，我们将完全使用React hooks使用</a><a class="ae kt" href="https://www.themoviedb.org/" rel="noopener ugc nofollow" target="_blank"> TMDb API </a>创建一个小型的可搜索电影数据库。我们还将看到如何创建100%可重用的组件。所以不要再拖延了，让我们开始吧。</p><h1 id="a664" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">项目设置</h1><p id="1378" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">让我们创建一个新的react应用程序。最好的方法是使用<code class="fe lx ly lz ma b">npx create-react-app movie-database</code>。接下来，我们想安装<code class="fe lx ly lz ma b">styled-components</code>来设计我们的应用程序，安装<code class="fe lx ly lz ma b">axios</code>来发出网络请求。使用<code class="fe lx ly lz ma b">npm i axios styled-components</code>或<code class="fe lx ly lz ma b">yarn add axios styled-components</code>安装它们。</p><p id="8741" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">安装好项目依赖项后，让我们在这里生成一个键<a class="ae kt" href="https://developers.themoviedb.org/3/getting-started/introduction" rel="noopener ugc nofollow" target="_blank">来访问TMDb API。因为顶部的链接有详细的步骤，所以我不打算在这里重复这些步骤。但是，如果你觉得在任何一个步骤上卡住了，请在下面留下你的评论。</a></p><p id="ef1c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我希望您能够成功地生成一个密钥！请复制密钥并将其粘贴到某个我们在某个时候会需要该密钥的地方。</p><h1 id="6097" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">概观</h1><p id="ff78" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">现在我们的项目都设置好了。让我们了解事情是如何进行的，以及我们将使用什么样的钩子。首先，对钩子做一些基本介绍。传统上，我们认为功能组件是没有状态和生命周期方法的哑组件。因此，这不允许我们制造有效的可重用组件和类组件，另一方面，有许多与它们相关联的模板，甚至执行一个简单的操作。但是，钩子完全改变了我们的思维方式。有了钩子，我们可以让任何功能组件有状态，甚至在其中执行生命周期操作。在本文中，我们将看到两个React挂钩，即<code class="fe lx ly lz ma b">useState</code>和<code class="fe lx ly lz ma b">useEffect</code>。<code class="fe lx ly lz ma b">useState</code>钩子允许我们将状态变量添加到我们的功能组件中，而<code class="fe lx ly lz ma b">useEffect</code>帮助我们完成通常在生命周期方法中完成的任务。React还允许我们定义自己的定制钩子，稍后会详细介绍。点击阅读更多关于React钩子<a class="ae kt" href="https://reactjs.org/docs/hooks-overview.html" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="a12f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此外，我们将使用<a class="ae kt" href="https://www.styled-components.com/" rel="noopener ugc nofollow" target="_blank">样式组件</a>来设计应用程序的样式，但你也可以使用CSS或任何其他预处理器。</p><p id="c91e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，让我们开始创建一些组件。首先，我们将创建一个网格组件来显示所有的电影。创建一个名为Grid的目录，并添加<code class="fe lx ly lz ma b">index.js</code>和<code class="fe lx ly lz ma b">styled.js</code>文件。</p><h1 id="2b34" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">网格组件</h1><h2 id="7808" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">网格/索引. js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="d6ee" class="mb kv in ma b gy mv mw l mx my">import React from 'react';<br/>import PropTypes from 'prop-types';<br/><br/>import GridItem from '../Item';<br/><br/>import GridContainer from './styled';<br/><br/>import Constants from '../../utils/Constants';<br/><br/>function Grid({ items }) {<br/>  return (<br/>    &lt;GridContainer&gt;<br/>      {items.map((item, i) =&gt; {<br/>        const idx = i;<br/>        return (<br/>          &lt;GridItem<br/>            key={idx}<br/>            title={item.title}<br/>            image={`${Constants.IMAGE_URL}/${item.poster_path}`}<br/>            overview={item.overview}<br/>            ratings={item.vote_average}<br/>          /&gt;<br/>        );<br/>      })}<br/>    &lt;/GridContainer&gt;<br/>  );<br/>}<br/><br/>Grid.propTypes = {<br/>  items: PropTypes.arrayOf(PropTypes.any)<br/>};<br/><br/>Grid.defaultProps = {<br/>  items: []<br/>};<br/><br/>export default Grid;</span></pre><h2 id="0efc" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">Grid/styled.js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="1c3c" class="mb kv in ma b gy mv mw l mx my">import styled from 'styled-components';<br/><br/>const GridContainer = styled.div`<br/>  display: flex;<br/>  width: 100%;<br/>  flex-direction: row;<br/>  flex-wrap: wrap;<br/>`;<br/><br/>export default GridContainer;</span></pre><ul class=""><li id="6287" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">让我们看看这个组件是如何工作的。<code class="fe lx ly lz ma b">Grid</code>组件将根据其子组件的宽度创建一个<code class="fe lx ly lz ma b">N X N</code>网格。你唯一需要传入的是一个<code class="fe lx ly lz ma b">items</code>数组。这是你的第一个可重用组件。你可以在任何项目中使用这个<code class="fe lx ly lz ma b">Grid</code>。您可以传入道具或使用任何其他组件作为其子组件。</li><li id="aaaa" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">在这个例子中，我创建了一个<code class="fe lx ly lz ma b">GridItem</code>组件作为<code class="fe lx ly lz ma b">Grid</code>的子组件。<code class="fe lx ly lz ma b">GridITem</code>组件的代码如下。创建一个名为GridItem的目录，并添加<code class="fe lx ly lz ma b">index.js</code>和<code class="fe lx ly lz ma b">styled.js</code>文件。</li></ul><h1 id="98eb" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">网格组件</h1><h2 id="35ad" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">GridItem/index.js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="2caa" class="mb kv in ma b gy mv mw l mx my">import React from 'react';<br/>import PropTypes from 'prop-types';<br/><br/>import {<br/>  Container,<br/>  Content,<br/>  Image,<br/>  Text,<br/>  FAB,<br/>  Separator,<br/>  Button<br/>} from './styled';<br/><br/>function Item({ image, title, overview, ratings }) {<br/>  return (<br/>    &lt;Container&gt;<br/>      &lt;Image image={image} /&gt;<br/>      &lt;Content&gt;<br/>        &lt;Text weight='bolder' relative&gt;<br/>          {title}<br/>        &lt;/Text&gt;<br/>        &lt;Text color='#BFC0CE' height&gt;<br/>          {overview}<br/>        &lt;/Text&gt;<br/>        &lt;FAB&gt;{ratings}&lt;/FAB&gt;<br/>        &lt;Separator /&gt;<br/>        &lt;Button&gt;Details&lt;/Button&gt;<br/>      &lt;/Content&gt;<br/>    &lt;/Container&gt;<br/>  );<br/>}<br/><br/>Item.propTypes = {<br/>  image: PropTypes.string,<br/>  title: "PropTypes.string,"<br/>  overview: PropTypes.string,<br/>  ratings: PropTypes.string<br/>};<br/><br/>Item.defaultProps = {<br/>  image: '',<br/>  title: "'',"<br/>  overview: '',<br/>  ratings: ''<br/>};<br/><br/>export default Item;</span></pre><h2 id="db50" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">grid item/style . js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="0d09" class="mb kv in ma b gy mv mw l mx my">import styled from 'styled-components';<br/><br/>const Container = styled.div`<br/>  display: inline-flex;<br/>  height: 150px;<br/>  width: calc(50% - 45px);<br/>  margin-top: 16px;<br/>  margin-bottom: 20px;<br/>  margin-right: 15px;<br/>  padding: 15px;<br/>  background: white;<br/>  box-shadow: 10px 5px 15px #e0e5ec;<br/>`;<br/><br/>const Image = styled.div`<br/>  height: 128px;<br/>  width: 90px;<br/>  margin-top: -32px;<br/>  background-color: white;<br/>  background-image: url(${props =&gt; props.image &amp;&amp; props.image});<br/>  background-position: center center;<br/>  background-repeat: no-repeat;<br/>  background-size: cover;<br/>  box-shadow: 3px 2px 4px #dbdee3;<br/>`;<br/><br/>const Content = styled.div`<br/>  height: 100%;<br/>  width: 100%;<br/>  margin-left: 20px;<br/>  margin-top: 5px;<br/>  margin-bottom: 15px;<br/>`;<br/><br/>const Text = styled.div`<br/>  position: relative;<br/>  margin-bottom: 15px;<br/>  height: ${props =&gt; props.height &amp;&amp; '3.6em'};<br/>  font-size: ${props =&gt; (props.size &amp;&amp; props.size) || '16px'};<br/>  font-weight: ${props =&gt; (props.weight &amp;&amp; props.weight) || ''};<br/>  color: ${props =&gt; (props.color &amp;&amp; props.color) || '#9D9FB0'};<br/>  overflow: hidden;<br/>  ::after {<br/>    content: '';<br/>    text-align: right;<br/>    position: absolute;<br/>    bottom: 0;<br/>    right: 0;<br/>    width: ${props =&gt; (props.relative &amp;&amp; '0') || '40%'};<br/>    height: 1.2em;<br/>    background: linear-gradient(<br/>      to right,<br/>      rgba(255, 255, 255, 0),<br/>      rgba(255, 255, 255, 1) 50%<br/>    );<br/>  }<br/>`;<br/><br/>const FAB = styled.div`<br/>  display: flex;<br/>  height: 48px;<br/>  width: 48px;<br/>  margin-top: -150px;<br/>  border-radius: 50%;<br/>  float: right;<br/>  color: white;<br/>  box-shadow: 4px 4px 10px #c9d8db;<br/>  background-color: #2879ff;<br/>  align-items: center;<br/>  justify-content: center;<br/>  font-size: 14px;<br/>  font-weight: bold;<br/>`;<br/><br/>const Separator = styled.hr`<br/>  position: relative;<br/>  height: 2px;<br/>  margin: 10px 0;<br/>  background: #f2f4f8;<br/>  border: none;<br/>`;<br/><br/>const Button = styled.div`<br/>  display: flex;<br/>  width: 64px;<br/>  padding: 5px;<br/>  margin-right: 5px;<br/>  float: right;<br/>  justify-content: center;<br/>  align-items: center;<br/>  font-size: 12px;<br/>  border-radius: 10px;<br/>  border: 2px solid #2879ff;<br/>  color: #2879ff;<br/>  cursor: pointer;<br/>  :hover {<br/>    background: #2879ff;<br/>    color: white;<br/>    box-shadow: 2px 0 7px #c9d8db;<br/>  }<br/>`;<br/><br/>export { Container, Content, Image, Text, FAB, Separator, Button };</span></pre><p id="4ddf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有了网格组件，让我们获取一些数据来显示。我们将使用axios从TMDb API获取数据。是时候展示我们之前创建的API密钥了。</p><p id="dd45" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们创建一个名为<code class="fe lx ly lz ma b">API.js</code>的文件，并使用下面的代码。</p><h1 id="5004" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">API.js</h1><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="1dcf" class="mb kv in ma b gy mv mw l mx my">import axios from 'axios';<br/><br/>const movies = type =&gt; {<br/>  return axios.get(<br/>    `${Constants.REQUEST_URL}/movie/${type}?api_key=${Constants.API_KEY}`<br/>  );<br/>};<br/><br/>export default { movies };</span></pre><p id="90ba" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在让我们将视图中的所有内容联系在一起，看看钩子是如何工作的。创建一个名为<code class="fe lx ly lz ma b">Main</code>的目录，并添加如下所示的两个文件。这是我们的主视图，我们的电影网格将在这里显示。</p><h1 id="36e6" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">主视图</h1><h2 id="6635" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">Main/styled.js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="5b14" class="mb kv in ma b gy mv mw l mx my">import styled from 'styled-components';<br/><br/>const RootContainer = styled.div`<br/>  height: 100vh;<br/>  width: 100vw;<br/>  display: inline-flex;<br/>`;<br/>const SideBarSection = styled.section`<br/>  width: 20%;<br/>  background-color: white;<br/>  box-shadow: 3px 0 15px #e5e9f0;<br/>`;<br/><br/>const ContentSection = styled.div`<br/>  height: 100%;<br/>  width: 100%;<br/>`;<br/><br/>const SearchBarSection = styled.section`<br/>  height: 38px;<br/>  width: 256px;<br/>  margin: 10px 0;<br/>  padding: 0 20px;<br/>`;<br/><br/>const MoviesGridSection = styled.section`<br/>  height: calc(100% - 88px);<br/>  width: calc(100% - 28px);<br/>  padding: 20px;<br/>  overflow-y: scroll;<br/>`;<br/><br/>export {<br/>  RootContainer,<br/>  SideBarSection,<br/>  ContentSection,<br/>  SearchBarSection,<br/>  MoviesGridSection<br/>};</span></pre><h2 id="d68f" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">main/索引. js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="da88" class="mb kv in ma b gy mv mw l mx my">import React, { useState, useEffect } from 'react';<br/><br/>import Search from '../../components/Search';<br/>import MoviesGrid from '../../components/Grid';<br/><br/>import Get from '../../api/Get';<br/>import Constants from '../../utils/Constants';<br/>import useSearch from '../../hooks/useSearch';<br/><br/>import {<br/>  RootContainer,<br/>  ContentSection,<br/>  MoviesGridSection,<br/>  SearchBarSection<br/>} from './styled';<br/><br/>Constants.FuseOptions.keys = ['title'];<br/><br/>function Main() {<br/>  const [movies, setMovies] = useState({});<br/>  const [movieType, setMovieType] = useState('');<br/><br/>  useEffect(() =&gt; {<br/>    try {<br/>      (async () =&gt; {<br/>        const popularMovies = await Get.movies('now_playing');<br/>        setMovies(state =&gt; {<br/>          const newState = { ...state };<br/>          newState.now_playing = popularMovies.data.results;<br/>          return newState;<br/>        });<br/>        setMovieType('now_playing');<br/>      })();<br/>    } catch (e) {<br/>      console.log({ e });<br/>    }<br/>  }, []);<br/><br/>  return (<br/>    &lt;RootContainer&gt;<br/>      &lt;ContentSection&gt;<br/>        &lt;MoviesGridSection&gt;<br/>          &lt;MoviesGrid items={results} /&gt;<br/>        &lt;/MoviesGridSection&gt;<br/>      &lt;/ContentSection&gt;<br/>    &lt;/RootContainer&gt;<br/>  );<br/>}<br/><br/>export default Main;</span></pre><ul class=""><li id="b551" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">在<code class="fe lx ly lz ma b">index.js</code>文件中，我们使用了<code class="fe lx ly lz ma b">useState</code>和<code class="fe lx ly lz ma b">useEffect</code>。让我们看看他们怎么做。</li><li id="f7c4" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">第一个<code class="fe lx ly lz ma b">useState</code>。我们都熟悉在类组件的构造函数中定义一个<code class="fe lx ly lz ma b">state object</code>。在功能组件中，我们可以使用<code class="fe lx ly lz ma b">useState</code>钩子定义有状态变量。</li><li id="ab44" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated"><code class="fe lx ly lz ma b">useState</code>不过是一个JavaScript函数，它接受一个初始值作为参数，并返回给我们一个数组。<code class="fe lx ly lz ma b">const [A, setA] = useState(0)</code>如。这里我们给<code class="fe lx ly lz ma b">useState</code>钩子传递一个初始值0，它返回给我们一个有两个条目的数组。第一个是该变量的当前值，第二个是设置该值的函数。</li><li id="04ec" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">作为比较，类组件中上述代码中的状态变量如下所示</li></ul><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="ece3" class="mb kv in ma b gy mv mw l mx my">this.state = {<br/>  movies: {},<br/>  movieType: ''<br/>};</span></pre><ul class=""><li id="d940" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">我们知道，每当我们在类组件中执行<code class="fe lx ly lz ma b">this.setState()</code>时，它都会被重新呈现。类似地，当我们调用由<code class="fe lx ly lz ma b">useState</code>返回的<code class="fe lx ly lz ma b">set</code>函数时，组件被重新呈现。在上面的点中调用<code class="fe lx ly lz ma b">setA()</code>会重新渲染组件。</li><li id="b49e" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">而这个简单来说就是<code class="fe lx ly lz ma b">useState</code>。最后，它允许你声明状态变量。</li><li id="ce1f" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">继续进行<code class="fe lx ly lz ma b">useEffect</code>。useEffect允许我们执行以前在生命周期方法中执行的任务。</li><li id="4dfa" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">useEffect要比useState复杂得多。它接受一个回调函数和一个可选的依赖数组作为参数。看起来是这样的<code class="fe lx ly lz ma b">useEffect(callback, &lt;dependencies&gt;)</code>。</li><li id="d56e" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated"><code class="fe lx ly lz ma b">callback</code>函数指定了效果应该做什么，而依赖数组告诉效果何时需要运行。</li><li id="0397" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">如果useEffect没有依赖关系数组，它将在每次渲染时运行，如果它是一个空数组，它将只在第一次渲染时运行，如果依赖关系数组有内容，它将在依赖关系改变时运行。</li><li id="2743" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">指定一个空数组可以用来执行我们通常在<code class="fe lx ly lz ma b">componentDidMount()</code>生命周期方法中执行的任务。因为我们只想在代码的<code class="fe lx ly lz ma b">useEffect</code>钩子中使用一个空数组后获取数据。</li></ul><p id="0614" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">继续使用<code class="fe lx ly lz ma b">npm start</code>运行应用程序，您将能够看到电影列表。</p><p id="a292" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">接下来，我们想在我们的应用程序中添加一个搜索。</p><ul class=""><li id="0bf0" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">在这个应用中，我们将使用<a class="ae kt" href="https://fusejs.io/" rel="noopener ugc nofollow" target="_blank"> Fuse.js </a>在我们的应用中执行模糊搜索。</li><li id="cdc2" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">继续使用<code class="fe lx ly lz ma b">npm install fuse.js</code>安装fuse.js模块。</li></ul><p id="8640" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，让我们在应用程序中添加一个搜索组件。创建一个名为Search的目录，并添加到<code class="fe lx ly lz ma b">index.js</code>和<code class="fe lx ly lz ma b">styled.js</code>文件中。</p><h1 id="bf33" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">搜索组件</h1><h2 id="ef16" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">搜索/index.js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="6cec" class="mb kv in ma b gy mv mw l mx my">import React from 'react';<br/>import { MdSearch } from 'react-icons/md';<br/>import PropTypes from 'prop-types';<br/><br/>import { SearchBarContainer, SearchIcon, SearchInput } from './styled';<br/><br/>function Search({ handler, value }) {<br/>  return (<br/>    &lt;SearchBarContainer&gt;<br/>      &lt;SearchIcon&gt;<br/>        &lt;MdSearch /&gt;<br/>      &lt;/SearchIcon&gt;<br/>      &lt;SearchInput<br/>        onChange={handler}<br/>        value={value}<br/>        placeholder='Search Movies'<br/>      /&gt;<br/>    &lt;/SearchBarContainer&gt;<br/>  );<br/>}<br/><br/>Search.propTypes = {<br/>  handler: PropTypes.func,<br/>  value: PropTypes.string<br/>};<br/><br/>Search.defaultProps = {<br/>  handler: () =&gt; {},<br/>  value: ''<br/>};<br/><br/>export default Search;</span></pre><h2 id="0d64" class="mb kv in bd kw mc md dn la me mf dp le kg mg mh li kk mi mj lm ko mk ml lq mm bi translated">search/style . js</h2><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="9852" class="mb kv in ma b gy mv mw l mx my">import styled from 'styled-components';<br/><br/>const SearchBarContainer = styled.div`<br/>  display: flex;<br/>  justify-content: center;<br/>  align-items: center;<br/>  height: 100%;<br/>  width: 100%;<br/>  border-bottom: 2px solid #dfe5ef;<br/>`;<br/><br/>const SearchIcon = styled.div`<br/>  display: inline-flex;<br/>  height: 24px;<br/>  width: 24px;<br/>  color: #9d9fb0;<br/>  font-size: 14px;<br/>  font-weight: bolder;<br/>  svg {<br/>    height: 100%;<br/>    width: 100%;<br/>  }<br/>`;<br/><br/>const SearchInput = styled.input`<br/>  height: 24px;<br/>  width: 100%;<br/>  margin-left: 10px;<br/>  border: none;<br/>  background-color: transparent;<br/>  color: #9d9fb0;<br/>  font-size: 14px;<br/>  font-weight: bolder;<br/>`;<br/><br/>export { SearchBarContainer, SearchIcon, SearchInput };</span></pre><ul class=""><li id="e938" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">我们将把这个组件添加到我们的<code class="fe lx ly lz ma b">Main</code>视图中。用下面的代码替换<code class="fe lx ly lz ma b">return</code>的内容。</li></ul><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="d882" class="mb kv in ma b gy mv mw l mx my">return (<br/>    &lt;RootContainer&gt;<br/>      &lt;ContentSection&gt;<br/>        &lt;SearchBarSection&gt;<br/>          &lt;Search handler={e =&gt; search(e.target.value)} value={searchTerm} /&gt;<br/>        &lt;/SearchBarSection&gt;<br/>        &lt;MoviesGridSection&gt;<br/>          &lt;MoviesGrid items={results} /&gt;<br/>        &lt;/MoviesGridSection&gt;<br/>      &lt;/ContentSection&gt;<br/>    &lt;/RootContainer&gt;<br/>  );</span></pre><ul class=""><li id="bc5f" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">现在我们将编写一个自定义钩子来为我们执行搜索。</li><li id="f134" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">创建一个名为<code class="fe lx ly lz ma b">useSearch.js</code>的新文件，并添加如下代码。</li></ul><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="4885" class="mb kv in ma b gy mv mw l mx my">import { useState } from 'react';<br/>import Fuse from 'fuse.js';<br/><br/>function search({ fuse, data, term }) {<br/>  const results = fuse.search(term);<br/>  return term ? results : data;<br/>}<br/><br/>function useSearch({ data = [], options }) {<br/>  const [searchTerm, setSearchTerm] = useState('');<br/>  const fuse = new Fuse(data, options);<br/>  const results = search({ fuse, data, term: searchTerm });<br/>  const reset = () =&gt; setSearchTerm('');<br/>  return { results, search: setSearchTerm, searchTerm, reset };<br/>}<br/><br/>export default useSearch;</span></pre><ul class=""><li id="9a94" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">正如你所看到的，我们正在使用<code class="fe lx ly lz ma b">useState</code> React钩子来创建一个定制钩子。这个钩子接受我们想要搜索的数组和传递给fuse.js的选项。</li><li id="b570" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">让我们在<code class="fe lx ly lz ma b">Main</code>视图中使用这个钩子。</li><li id="88a3" class="mz na in jx b jy ni kc nj kg nk kk nl ko nm ks ne nf ng nh bi translated">复制下面的代码，粘贴到<code class="fe lx ly lz ma b">Main</code>视图渲染函数中的<code class="fe lx ly lz ma b">useEffect</code>下面。</li></ul><pre class="mn mo mp mq gt mr ma ms mt aw mu bi"><span id="952f" class="mb kv in ma b gy mv mw l mx my">const { results, search, searchTerm } = useSearch({<br/>  data: movies[movieType],<br/>  options: Constants.FuseOptions<br/>});</span></pre><ul class=""><li id="14ce" class="mz na in jx b jy jz kc kd kg nb kk nc ko nd ks ne nf ng nh bi translated">这就是了，我们刚刚在应用程序中添加了搜索功能。你可以根据电影的名字来搜索它们。</li></ul><p id="40bf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如你所看到的，React钩子使得事情变得更加清晰和易于理解。我喜欢钩子，希望看完这篇文章后，你也会喜欢钩子。</p><p id="6be5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一如既往，如果你被困在某个地方，或者想讨论一些事情，或者给我一些反馈，请随时发表评论。</p><p id="7cab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">查看<a class="ae kt" href="https://manan30.github.io/movies-db/" rel="noopener ugc nofollow" target="_blank">演示</a>并完成<a class="ae kt" href="https://github.com/manan30/movies-db" rel="noopener ugc nofollow" target="_blank">代码</a>。</p><p id="6d8f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<a class="ae kt" href="https://twitter.com/Manan_30" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae kt" href="https://www.instagram.com/manan__joshi/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上找到我</p></div><div class="ab cl nn no hr np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ig ih ii ij ik"><p id="61e0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nu">原载于2019年11月14日</em><a class="ae kt" href="https://dev.to/manan30/creating-a-searchable-movie-app-using-react-styled-components-and-react-hooks-25ej" rel="noopener ugc nofollow" target="_blank"><em class="nu">https://dev . to</em></a><em class="nu">。</em></p></div></div>    
</body>
</html>