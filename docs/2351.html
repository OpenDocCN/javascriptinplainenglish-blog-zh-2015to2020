<html>
<head>
<title>Angular Template Type Checking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度模板类型检查</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-template-type-checking-e2c99c50f999?source=collection_archive---------1-----------------------#2020-06-16">https://javascript.plainenglish.io/angular-template-type-checking-e2c99c50f999?source=collection_archive---------1-----------------------#2020-06-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9ea0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Angular 9中，引入了一个全新的模板类型检查模式，叫做<code class="fe kl km kn ko b">strictTemplates</code>。让我告诉你它是什么，为什么你应该启用它。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/8f135b073bc6236e8a0618cf059291b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8EA0vqaROuPW5NR1vHRRcw.jpeg"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Picture courtesy of <a class="ae lf" href="https://unsplash.com/@olloweb" rel="noopener ugc nofollow" target="_blank">Agence Olloweb</a></figcaption></figure><p id="b773" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将看到Angular 9+的一个令人敬畏的新标志，您可以在将代码发布到产品之前启用并利用它来发现/修复问题。</p><h1 id="635f" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">什么是模板类型检查</h1><p id="214d" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">当你写TypeScript代码时，你知道只要你搞砸了，编译器就会对你大喊大叫。忘记定义类型了？忘记提供参数了？忘记返回值了？别担心，编译器会支持你的。它不会找到所有的东西(因为编译只是故事的一部分)，但是它会帮助你发现代码中明显的问题。</p><p id="47ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，你们可能都没有意识到这一点，但是Angular把你的模板转换成了类型脚本代码，不管那些是单独的HTML文件还是单个文件组件的一部分。</p><p id="61e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，如果模板被转换成TypeScript代码，那么这些可以像代码库的其余部分一样进行类型检查。是不是很牛逼？</p><p id="f713" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢模板类型检查，我们可以发现模板中嵌入的表达式的问题，并避免在运行时发现这些问题。</p><h1 id="e15d" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">模板类型检查模式</h1><p id="43e0" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">对于Angular 9，有三种不同的<a class="ae lf" href="https://angular.io/guide/template-typecheck#template-type-checking" rel="noopener ugc nofollow" target="_blank">模板类型检查</a>“模式”或“级别”:</p><ul class=""><li id="4d8d" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated">基础</li><li id="3a7a" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">全部</li><li id="5221" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">严格的</li></ul><p id="f3b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以猜到，基本模式不是很严格，你可能会看到积极的一面:“嘿，别烦我”。这种模式的工作方式与Angular以前的版本基本相同；它将只检查模板中的顶级表达式(例如，您使用的字段和属性存在于组件类中)。老实说，这种级别的类型检查真的是<em class="mx">弱</em>。当<code class="fe kl km kn ko b">fullTemplateTypeCheck</code>标志被设置为<code class="fe kl km kn ko b">false</code>时，基本模式被启用。</p><p id="4664" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你启用了“完整”模式，那么Angular会更加小心，它还会检查管道和嵌入视图(当你使用ngIf、ngFor、ng-template等工具时创建的)。总的来说，这种模式提供了额外的安全性，但是谁喜欢折中的方法呢？要启用它，将<code class="fe kl km kn ko b">fullTemplateTypeCheck</code>标志设置为<code class="fe kl km kn ko b">true</code>。</p><p id="d841" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，新的“严格”模式强制执行完整的模板类型检查，并在构建时捕获更多的错误。在严格模式下，启用“完整”模式检查，此外，还会检查更多内容:</p><ul class=""><li id="9fe3" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated">组件绑定和可分配性(服从TypeScript的<code class="fe kl km kn ko b">strictNullChecks</code>标志)</li><li id="9e7e" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">组件和指令的类型(包括泛型！)</li><li id="9cf4" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">上下文类型(例如，允许对循环进行全面的类型检查)</li><li id="7276" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">组件、指令、DOM &amp;动画绑定的事件对象(即<code class="fe kl km kn ko b">$event</code></li><li id="8575" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">对DOM元素的引用类型</li><li id="d325" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">安全导航表达</li><li id="9782" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">(可能更多)</li></ul><p id="1919" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Angular 9之前，我们需要启用/使用<a class="ae lf" href="https://angular.io/guide/aot-compiler" rel="noopener ugc nofollow" target="_blank"> AOT </a>模式来受益于额外的类型检查。现在，简单多了，也快多了。</p><p id="2f16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要启用严格模式，只需将<code class="fe kl km kn ko b">strictTemplates</code>标志设置为<code class="fe kl km kn ko b">true</code>。</p><p id="8503" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，这些标志是在您的“tsconfig.json”文件中配置的:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="d712" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我真的建议您启用TypeScript的严格模式，但那是另外一个故事了。</p><h1 id="85e6" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">严格还是不严格？</h1><p id="886d" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">那么应该使用哪种模板类型检查模式呢？</p><p id="b917" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你经常阅读我的博客或推特，你可能已经知道答案了:当然是严格模式！在任何情况下，严格模式很可能会成为Angular 10的默认模式！</p><p id="b2ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实上，根据你的项目，你可能需要一步一步地增加严格性，在进行过程中解决暴露出来的问题。</p><p id="76cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题是，对于一个大型项目，修复类型检查器发现的错误可能需要一段时间。对于TypeScript的严格模式，情况也是如此。</p><p id="8d48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是对于新的/年轻的项目，这真的很简单:从一开始就为Angular和TypeScript启用最严格的模式！</p><p id="e989" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顺便说一句，Angular团队已经写了一份很好的指南来帮助你<a class="ae lf" href="https://angular.io/guide/template-typecheck#troubleshooting-template-errors" rel="noopener ugc nofollow" target="_blank">解决模板错误</a>。正如该指南所指出的，您可以禁用特定的严格检查，而不是完全禁用严格类型检查，这样您就可以“大部分”保持在严格模式下，同时仍然受益于其他严格检查。也就是说，直到你能够回到完全成熟的严格模式。</p><p id="cd01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看官方文档，获取受支持的严格模式标志的完整列表。</p><h1 id="9de5" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">利益</h1><p id="bdc8" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">对我来说，好处是显而易见的:你越早发现潜在的错误，你的最终用户就会越高兴，无论如何。</p><p id="d490" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您不仅交付了质量更好的软件(作为一名软件工匠，这应该让您感觉良好)，而且最终，您还节省了时间，避免了生产中不必要的压力。</p><p id="0760" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于更好的类型检查而节省的时间可以用于交付更多的商业价值，这比半夜醒来修复编译器可能已经注意到的东西要有回报得多。</p><p id="4c45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何可以在构建时捕获的东西都应该被捕获；任何做不到的事情都应该被自动化测试发现。其余的应该由代码审查来捕捉。说够了；-)</p><h1 id="a211" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="482a" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">在本文中，我快速介绍了Angular 9支持的不同模板类型检查模式，包括令人惊叹的新“严格”模式。</p><p id="b969" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也试图说服你尽快启用严格模式。如果你已经读到这里，请不要让我失望；继续并立即启用它。我很好奇它为你的代码库:D捕捉了多少错误</p><p id="85aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天到此为止！</p><h1 id="0e69" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">喜欢这篇文章吗？</h1><p id="8ae4" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">如果你想了解关于软件/Web开发、TypeScript、Angular、React、Vue、Kotlin、Java、Docker/Kubernetes和其他很酷的主题的大量其他很酷的东西，那么不要犹豫<a class="ae lf" href="https://www.amazon.com/Learn-TypeScript-Building-Applications-understanding-ebook/dp/B081FB89BL" rel="noopener ugc nofollow" target="_blank">拿一本我的书</a>并订阅<a class="ae lf" href="https://mailchi.mp/fb661753d54a/developassion-newsletter" rel="noopener ugc nofollow" target="_blank">我的简讯</a>！</p></div></div>    
</body>
</html>