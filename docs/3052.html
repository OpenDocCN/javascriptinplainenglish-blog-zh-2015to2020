<html>
<head>
<title>Build Speech Recognition in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript构建语音识别</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-speech-recognition-in-javascript-93bfc5db0d5f?source=collection_archive---------2-----------------------#2020-08-24">https://javascript.plainenglish.io/how-to-build-speech-recognition-in-javascript-93bfc5db0d5f?source=collection_archive---------2-----------------------#2020-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="da02" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用TensorFlow.js构建语音识别。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c39d28833cada5c6dfeda103973da7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3cotFZGvdvvhQhTC"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Clay Banks</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="31df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天在本文中，我们将讨论如何使用<strong class="ky ir"> TensorFlow.js </strong>构建一个语音识别工具。实际上，当我们要构建人工智能、深度学习、机器学习时，我们经常会想到使用Python语言。但是使用JavaScript呢？它是一种强大的语言，我们可以利用一个叫做<strong class="ky ir">的框架</strong></p><p id="f8c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在深入讨论这个话题之前，让我们来看看关于<strong class="ky ir"> TensorFlow.js </strong>的讨论。</p><p id="51ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> TensorFlow.js </strong>是谷歌开发的一个JavaScript库，用于在浏览器和<strong class="ky ir"> Node.js </strong>中开发和部署机器学习项目。</p><p id="2e27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> TensorFlow.js </strong>不仅仅是一个库。这并不意味着您不应该使用TensorFlow.js，但我认为它是一个部署和开发ML应用程序的很好的库，让我们在本文的其余部分中了解一下。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="c472" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用TensorFlow.js开发项目</h1><p id="1ead" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">正如我之前所说，它是一个强大的库，我们可以使用许多不同的功能，如图像捕获、视频处理和语音识别。今天我决定做一个基本的语音识别项目。</p><p id="75b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这段代码中，我们可以通过麦克风收听并识别用户在说什么，最多几句话，因为我们对这个示例模型有一些限制。</p><p id="85c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要做的第一步是安装库。为了安装<strong class="ky ir"> TensorFlow.js，</strong>有几个选项。在我们的项目中，我们可以从CDN导入它。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="8ab9" class="nb ma iq mx b gy nc nd l ne nf">&lt;script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"&gt;&lt;/script&gt;<br/>&lt;script src="https://unpkg.com/@tensorflow-models/speech-commands"&gt;&lt;/script&gt;</span></pre><p id="b79d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后添加一些HTML来显示一些单词列表。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="b148" class="nb ma iq mx b gy nc nd l ne nf">&lt;div class="demo"&gt;<br/>    &lt;div&gt;<br/>        &lt;label class="form-switch"&gt;<br/>            &lt;input type="checkbox" id="audio-switch"&gt;<br/>            Microphone<br/>        &lt;/label&gt;<br/>        &lt;div id="demo-loading" class="hidden"&gt;Loading...&lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div id="sp-cmd-wrapper" class="grid"&gt;&lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="5f29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它包含一个复选框、一个加载元素和一个用于呈现单词列表的包装元素，所以我们接下来要做的是:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="68d1" class="nb ma iq mx b gy nc nd l ne nf">const wrapperElement = document.getElementById('sp-cmd-wrapper');<br/>for (let word of wordList) {<br/>    wrapperElement.innerHTML += `&lt;div id='word-${word}'&gt;${word}&lt;/div&gt;`;<br/>}</span></pre><p id="831d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要点击麦克风复选框，这将触发事件监听器开始监听测试演示工作条件的过程。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="c29a" class="nb ma iq mx b gy nc nd l ne nf">document.getElementById("audio-switch").addEventListener('change', (event) =&gt; {<br/>    if(event.target.checked) {<br/>        if(modelLoaded) {<br/>            startListening();<br/>        }else{<br/>            loadModel();<br/>        }<br/>    } else {<br/>        stopListening();<br/>    }   <br/>});</span></pre><p id="8e27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们有3种不同的场景，当用户启用复选框而模型未被加载时，在这种场景中，我们使用<strong class="ky ir"> loadModel() </strong>函数。当模型已经被加载时，我们触发监听过程。当用户禁用该复选框时，我们停止监听麦克风。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8efa" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">loadModel()</h1><p id="0cda" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">它负责创建一个实例并加载模型。当加载模型时，我们需要得到模型已经用<strong class="ky ir">识别器训练过的标签列表。</strong></p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="6776" class="nb ma iq mx b gy nc nd l ne nf">async function loadModel() { <br/>    // Show the loading element<br/>    const loadingElement = document.getElementById('demo-loading');<br/>    loadingElement.classList.remove('hidden');<br/>    <br/>    recognizer = speechCommands.create("BROWSER_FFT");  <br/>    await recognizer.ensureModelLoaded()<br/>    <br/>    words = recognizer.wordLabels();<br/>    modelLoaded = true;<br/>    <br/>    // Hide the loading element<br/>    loadingElement.classList.add('hidden');<br/>    startListening();<br/>}</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3e22" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">开始监听()</h1><p id="318d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated"><strong class="ky ir"> startListening() </strong>用于在模型加载后或用户启用麦克风时调用。它负责访问麦克风API，该API将评估模型，以了解我们能够识别哪个单词。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="6837" class="nb ma iq mx b gy nc nd l ne nf">function startListening() {<br/>    recognizer.listen(({scores}) =&gt; {<br/>    <br/>        scores = Array.from(scores).map((s, i) =&gt; ({score: s, word: words[i]}));<br/>      <br/>        scores.sort((s1, s2) =&gt; s2.score - s1.score);<br/>        const elementId = `word-${scores[0].word}`;<br/>        document.getElementById(elementId).classList.add('active');<br/>        <br/>        // This is just for removing the highlight after 2.5 seconds<br/>        setTimeout(() =&gt; {<br/>            document.getElementById(elementId).classList.remove('active');<br/>        }, 2500);<br/>    }, <br/>    {<br/>        probabilityThreshold: 0.70<br/>    });<br/>}</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8663" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">停止列表()</h1><p id="8494" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated"><strong class="ky ir">停止收听()</strong>用于停止访问麦克风及其评估。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="613a" class="nb ma iq mx b gy nc nd l ne nf">function stopListening(){<br/>    recognizer.stopListening();<br/>}</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="cef0" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">最终部署</h1><p id="8e26" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在，您需要在web上构建您的第一个语音识别模型。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="bcef" class="nb ma iq mx b gy nc nd l ne nf">&lt;script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"&gt;&lt;/script&gt;<br/>&lt;script src="https://unpkg.com/@tensorflow-models/speech-commands"&gt;&lt;/script&gt;<br/><br/>&lt;script type="text/javascript"&gt;<br/>    let recognizer;<br/>    let words;<br/>    const wordList = ["zero","one","two","three","four","five","six","seven","eight","nine", "yes", "no", "up", "down", "left", "right", "stop", "go"];<br/>    let modelLoaded = false;<br/>    <br/>    document.addEventListener('DOMContentLoaded', () =&gt; {<br/>        const wrapperElement = document.getElementById('sp-cmd-wrapper');<br/>        for (let word of wordList) {<br/>            wrapperElement.innerHTML += `&lt;div class='col-3 col-md-6'&gt;&lt;div id='word-${word}' class='badge'&gt;${word}&lt;/div&gt;&lt;/div&gt;`;<br/>        };<br/>        <br/>        document.getElementById("audio-switch").addEventListener('change', (event) =&gt; {<br/>            if(event.target.checked) {<br/>                if(modelLoaded) {<br/>                    startListening();<br/>                }else{<br/>                    loadModel();<br/>                }<br/>            } else {<br/>                stopListening();<br/>            }   <br/>        });<br/>    });<br/>    <br/>    async function loadModel() { <br/>        // Show the loading element<br/>        const loadingElement = document.getElementById('demo-loading');<br/>        loadingElement.classList.remove('hidden');<br/>     <br/>        recognizer = speechCommands.create("BROWSER_FFT");  <br/>        await recognizer.ensureModelLoaded()<br/>        <br/>        words = recognizer.wordLabels();<br/>        modelLoaded = true;<br/>        <br/>        // Hide the loading element<br/>        loadingElement.classList.add('hidden');<br/>        startListening();<br/>    }<br/>    <br/>    function startListening() {<br/>        recognizer.listen(({scores}) =&gt; {<br/>            scores = Array.from(scores).map((s, i) =&gt; ({score: s, word: words[i]}));<br/>            <br/>            // After that we sort the array by score descending<br/>            scores.sort((s1, s2) =&gt; s2.score - s1.score);<br/>            <br/>            // And we highlight the word with the highest score<br/>            const elementId = `word-${scores[0].word}`;<br/>            document.getElementById(elementId).classList.add('active');<br/>            <br/>            // This is just for removing the highlight after 2.5 seconds<br/>            setTimeout(() =&gt; {<br/>                document.getElementById(elementId).classList.remove('active');<br/>            }, 2500);<br/>        }, <br/>        {<br/>            probabilityThreshold: 0.70<br/>        });<br/>    }<br/>    <br/>    function stopListening(){<br/>        recognizer.stopListening();<br/>    }<br/>&lt;/script&gt;<br/><br/>&lt;div class="demo"&gt;<br/>    Please enable the microphone checkbox and authorize this site to access the microphone.<br/>    &lt;br /&gt;<br/>    Once the process finished loading speak one of the word bellow and see the magic happen.<br/>    &lt;br /&gt;&lt;br /&gt;<br/>    &lt;div&gt;<br/>        &lt;label class="form-switch"&gt;<br/>            &lt;input type="checkbox" id="audio-switch"&gt;<br/>            Microphone<br/>        &lt;/label&gt;<br/>        &lt;div id="demo-loading" class="hidden"&gt;Loading...&lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div id="sp-cmd-wrapper" class="grid"&gt;&lt;/div&gt;<br/>&lt;/div&gt;</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="89cc" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="5fa2" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我希望你会喜欢，无论你在这篇文章中学到了什么，都只是生成结果的几行代码。但是TensorFlow.js是一个强大的开发机器学习模型的库。</p><p id="1d54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>