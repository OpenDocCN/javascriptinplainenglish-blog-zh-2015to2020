<html>
<head>
<title>jQuery Tips — Ready State, Sizes, and Ajax</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">jQuery技巧——就绪状态、大小和Ajax</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/jquery-tips-ready-state-sizes-and-ajax-a9141c15a034?source=collection_archive---------5-----------------------#2020-07-22">https://javascript.plainenglish.io/jquery-tips-ready-state-sizes-and-ajax-a9141c15a034?source=collection_archive---------5-----------------------#2020-07-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8343f166bd2927778aa585c0c77599ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OS5E0MkyzLQtqKxq"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@globecityguide?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Globe City Guide 🌎</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6aae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管年代久远，jQuery仍然是操纵DOM的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些使用jQuery的技巧。</p><h1 id="1c2a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">$(文档)。没有jQuery的现成等效项</h1><p id="c9c4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建自己的函数，通过检查应用程序的加载状态来实现类似于<code class="fe me mf mg mh b">$(document).ready</code>的功能。</p><p id="0ce2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5414" class="mq lc iq mh b gy mr ms l mt mu">function ready(callback){  <br/>  if (document.readyState !== 'loading') {<br/>    callback();<br/>  } else if (document.addEventListener)  {<br/>    document.addEventListener('DOMContentLoaded', callback);<br/>  } else {<br/>    document.attachEvent('onreadystatechange', () =&gt; {<br/>      if (document.readyState === 'complete') {<br/>        callback();<br/>      }<br/>    });<br/>  }  <br/>}</span></pre><p id="c15a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过比较文档的<code class="fe me mf mg mh b">readyState</code>和<code class="fe me mf mg mh b">'loading'</code>状态来检查它。</p><p id="99df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果不是，那么DOM被加载，我们可以调用我们的<code class="fe me mf mg mh b">callback</code>。</p><p id="a397" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果不可用，那么我们为<code class="fe me mf mg mh b">DOMContentLoaded</code>添加一个事件监听器，它被加载，这意味着事件被触发，然后我们调用我们的<code class="fe me mf mg mh b">callback</code>。</p><p id="5aa3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们用<code class="fe me mf mg mh b">attachEvent</code>来观察<code class="fe me mf mg mh b">readystatechange</code>事件。这个只在IE 8或更早版本上使用，所以我们可能不需要这个。</p><h1 id="6342" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">获取屏幕、当前网页和浏览器窗口的大小</h1><p id="cb10" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用<code class="fe me mf mg mh b">height</code>和<code class="fe me mf mg mh b">width</code>方法得到屏幕的大小。</p><p id="41c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0cf0" class="mq lc iq mh b gy mr ms l mt mu">$(window).height();<br/>$(window).width();</span></pre><p id="eaea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分别获取视口的高度和宽度。</p><p id="ed88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以用<code class="fe me mf mg mh b">document</code>代替<code class="fe me mf mg mh b">window</code>来得到<code class="fe me mf mg mh b">document</code>的高度和宽度。</p><p id="eefc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b24b" class="mq lc iq mh b gy mr ms l mt mu">$(document).height();<br/>$(document).width();</span></pre><h1 id="e252" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用jQuery中止Ajax请求</h1><p id="169f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">jQuery返回的XHR对象有<code class="fe me mf mg mh b">abort</code>方法让我们取消请求。</p><p id="dbe3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9b46" class="mq lc iq mh b gy mr ms l mt mu">const xhr = $.ajax({<br/>  type: "POST",<br/>  url: "some.php",<br/>  data: "first_name=james&amp;last_name=smith",<br/>  success: (res) =&gt; {<br/>    alert(res);<br/>  }<br/>});</span><span id="7337" class="mq lc iq mh b gy mv ms l mt mu">xhr.abort()</span></pre><p id="af2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到由<code class="fe me mf mg mh b">$.ajax</code>返回的<code class="fe me mf mg mh b">xhr</code>对象，然后我们对它调用<code class="fe me mf mg mh b">abort</code>来取消它。</p><h1 id="a727" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用jQuery获取元素的ID</h1><p id="7c48" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用jQuery通过使用<code class="fe me mf mg mh b">attr</code>方法获得一个元素的ID。</p><p id="96b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f2fc" class="mq lc iq mh b gy mr ms l mt mu">$('.test').attr('id')</span></pre><p id="134f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用类<code class="fe me mf mg mh b">test</code>获得第一个元素的ID。</p><p id="761a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以通过调用<code class="fe me mf mg mh b">get</code>或使用括号来获取DOM对象，从而通过DOM对象获取它。</p><p id="37c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e603" class="mq lc iq mh b gy mr ms l mt mu">$('.test').get(0).id;</span></pre><p id="e501" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ff1d" class="mq lc iq mh b gy mr ms l mt mu">$('.test')[0].id;</span></pre><p id="1321" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者我们可以使用<code class="fe me mf mg mh b">prop</code>方法编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="62df" class="mq lc iq mh b gy mr ms l mt mu">$('.test').prop('id')</span></pre><h1 id="2035" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用jQuery将选项作为JavaScript对象添加到Select from中</h1><p id="2458" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用<code class="fe me mf mg mh b">append</code>方法将<code class="fe me mf mg mh b">options</code>对象作为<code class="fe me mf mg mh b">select</code>的子对象添加到选择下拉列表中。</p><p id="e2ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="daac" class="mq lc iq mh b gy mr ms l mt mu">for (const o of options) {<br/>  $('#mySelect')<br/>    .append(<br/>      $("&lt;option&gt;&lt;/option&gt;")<br/>        .attr("value", o)<br/>        .text(o)<br/>    ); <br/>}</span></pre><p id="f1a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">$</code>创建了<code class="fe me mf mg mh b">option</code>元素，并向选项元素添加了一个值属性和文本。</p><h1 id="d080" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">管理jQuery Ajax调用后的重定向请求</h1><p id="8d44" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">通过在<code class="fe me mf mg mh b">success</code>回调中进行重定向，Wed可以在jQuery Ajax调用后管理重定向请求。</p><p id="d757" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4be3" class="mq lc iq mh b gy mr ms l mt mu">$.ajax({<br/>  type: "POST",<br/>  url: reqUrl,<br/>  data: reqBody,<br/>  dataType: "json",<br/>  success: (data) =&gt; {<br/>    window.location.href = data.redirect;<br/>  }<br/>});</span></pre><p id="f245" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">ajax</code>发出POST请求。</p><p id="29fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过传入URL和body来做到这一点。</p><p id="9c39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">dataType</code>设置为JSON，用JSON有效负载发出请求。</p><p id="562c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">success</code>回调中，我们从响应数据中获取重定向URL，它在第一个参数中。</p><p id="f940" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过将它设置为<code class="fe me mf mg mh b">window.location.href</code>来进行重定向。</p><h1 id="536c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用jQuery更改超链接的href</h1><p id="6c19" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">attr</code>方法改变超链接的<code class="fe me mf mg mh b">href</code>。</p><p id="4a13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="39f0" class="mq lc iq mh b gy mr ms l mt mu">$("a[href='http://www.google.com/']").attr('href', 'http://www.example.com/')</span></pre><p id="bce3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">href</code>设置为<code class="fe me mf mg mh b">http://www.google.com</code>的链接替换为<code class="fe me mf mg mh b">http://www.example.com</code>。</p><p id="ae55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">attr</code>将属性名作为第一个参数，将值作为第二个参数。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/701c9249b350a2e142795c37c654fee8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TT0kZK_KqBXKZzLP"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@lukaslinden?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lukas L</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="befe" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="16c0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以动态地改变链接的href。</p><p id="9aca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以获得视窗或文档的宽度和高度。</p><p id="3d64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Ajax请求可以被中止。</p><p id="1f4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以动态添加下拉选项。</p><h1 id="4ce8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单英语的JavaScript</h1><p id="af4d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>