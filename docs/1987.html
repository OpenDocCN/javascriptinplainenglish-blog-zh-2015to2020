<html>
<head>
<title>TypeScript: Discriminated Unions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript:有区别的联合</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typescript-discriminated-unions-ebe5dc0a76c7?source=collection_archive---------14-----------------------#2020-05-09">https://javascript.plainenglish.io/typescript-discriminated-unions-ebe5dc0a76c7?source=collection_archive---------14-----------------------#2020-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/e67a5f679e1c4d16eb0b4ab07081fc50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-0t1gxRxmvdUIRqbqBT2A.png"/></div></div></figure><div class=""/><div class=""><h2 id="5160" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">将另一个错误来源外包给TypeScript编译器</h2></div><h2 id="e5c6" class="kq kr jb bd ks kt ku dn kv kw kx dp ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">简介:联合类型</strong></h2><p id="da86" class="pw-post-body-paragraph lm ln jb lo b lp lq kc lr ls lt kf lu kz lv lw lx ld ly lz ma lh mb mc md me ij bi translated">TypeScript的一个最简单但最强大的特性是能够将多种类型组合成一个所谓的<strong class="lo jc">联合类型:</strong>一个表示X是以下类型之一的类型。例如:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="26b6" class="kq kr jb mk b gy mo mp l mq mr">type m = ....;<br/>type n = ....;</span><span id="c3fd" class="kq kr jb mk b gy ms mp l mq mr">type x = m | n;</span></pre><p id="3cc6" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">在上面的例子中，<code class="fe my mz na mk b">x</code> <em class="nb"> </em>或者是类型<code class="fe my mz na mk b">m</code>或者是类型<code class="fe my mz na mk b">n</code> <em class="nb">。</em>你可以用<code class="fe my mz na mk b">|</code>符号连接多个类型，以创建一个联合类型。<em class="nb"> <br/> </em>该功能的一个简单用例是当你有一个函数想要根据输入类型以不同的方式运行时。</p><p id="89ca" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">这里记载了<a class="ae nc" href="https://www.typescriptlang.org/docs/handbook/advanced-types.html#union-types" rel="noopener ugc nofollow" target="_blank">的一个实际例子</a>如下:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Unions: Practical Example</figcaption></figure><p id="96c1" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">在上面的代码中，<code class="fe my mz na mk b">padLeft</code>函数可以与类型<code class="fe my mz na mk b">string | number</code>一起工作。它在运行时检查输入变量的类型，然后评估结果。</p><p id="fae4" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">但这只是冰山一角。unions真正闪光的地方是它们在运行时能够被识别，并且能够被彻底检查以发现缺失的用例。</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><h2 id="0f41" class="kq kr jb bd ks kt ku dn kv kw kx dp ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">受歧视的工会</strong></h2><p id="bda4" class="pw-post-body-paragraph lm ln jb lo b lp lq kc lr ls lt kf lu kz lv lw lx ld ly lz ma lh mb mc md me ij bi translated">这个术语来自集合论，用来表示一个<em class="nb">数据结构，它可以采用几种不同的，但是固定的类型。在TypeScript中，我们可以如下使用有区别的联合:</em></p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Discriminated Unions in TypeScript: Fig 2</figcaption></figure><p id="2abd" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">正如我们所见，基于<code class="fe my mz na mk b">kind</code>属性(称为<em class="nb">判别式</em>)，我们可以在运行时区分对象的类型，并访问其他属性。<br/>为代码生成的JavaScript如下所示:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Generated JavaScript for code in Fig2</figcaption></figure><p id="ee9f" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">除此之外，受歧视工会的另一个强大用例是它们提供如下<strong class="lo jc">详尽检查</strong>的能力:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Discriminated Unions: Exhaustive Checks</figcaption></figure><p id="8cfa" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">我们添加了一个新的命名类型<code class="fe my mz na mk b">Dog</code>。假设开发人员忘记更新switch语句；在这种情况下，TypeScript编译器足够聪明，能够意识到switch语句并不详尽，因而无法编译。这是因为我们试图将<code class="fe my mz na mk b">Dog</code>类型分配给<code class="fe my mz na mk b">never</code>类型。</p><p id="73c4" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">详尽检查的一个更实际的用例如下:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Error Handling using Discriminated Unions in TypeScript</figcaption></figure><p id="e738" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">现在我们可以添加任意多的错误类型，而不必担心处理不同类型的所有代码；这项工作已经被卸载到TypeScript编译器😃</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><h2 id="8b38" class="kq kr jb bd ks kt ku dn kv kw kx dp ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">结论</strong></h2><p id="fe7d" class="pw-post-body-paragraph lm ln jb lo b lp lq kc lr ls lt kf lu kz lv lw lx ld ly lz ma lh mb mc md me ij bi translated">总而言之，TypeScript中有区别的联合提供了另一个抽象层，并为开发人员提供了基于公共属性类型处理给定对象的不同用例的能力，同时知道TypeScript编译器正在努力防止未经检查的代码进入生产环境，可以安心睡觉。</p><p id="cdc3" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated"><strong class="lo jc">参考文献<br/></strong>【1】:<a class="ae nc" href="https://en.wikipedia.org/wiki/Tagged_union" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Tagged_union</a></p><p id="beb1" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">-<a class="ae nc" href="https://www.typescriptlang.org/docs/handbook/advanced-types.html" rel="noopener ugc nofollow" target="_blank">https://www . typescriptlang . org/docs/handbook/advanced-types . html</a></p><h2 id="1384" class="kq kr jb bd ks kt ku dn kv kw kx dp ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="0c6b" class="pw-post-body-paragraph lm ln jb lo b lp lq kc lr ls lt kf lu kz lv lw lx ld ly lz ma lh mb mc md me ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意吧:<a class="ae nc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="lo jc">JavaScript in Plain English</strong></a><a class="ae nc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="lo jc">AI in Plain English</strong></a>，<a class="ae nc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="lo jc">UX in Plain English</strong></a>，<a class="ae nc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="lo jc">Python in Plain English</strong></a><strong class="lo jc"/>—谢谢，继续学习！</p><p id="f718" class="pw-post-body-paragraph lm ln jb lo b lp mt kc lr ls mu kf lu kz mv lw lx ld mw lz ma lh mx mc md me ij bi translated">此外，我们总是有兴趣帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae nc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="lo jc">submissions @ plain English . io</strong></a><strong class="lo jc"/>，并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>