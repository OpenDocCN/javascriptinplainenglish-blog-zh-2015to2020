<html>
<head>
<title>How to Dockerize your Angular 10 App for Production</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Angular 10应用程序用于生产</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-10-on-docker-to-production-61ee6e84006?source=collection_archive---------3-----------------------#2020-09-11">https://javascript.plainenglish.io/angular-10-on-docker-to-production-61ee6e84006?source=collection_archive---------3-----------------------#2020-09-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="8e68" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">创建和部署Angular docker映像从未如此简单。在本文档中，我们将对我们的<a class="ae ki" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular </a>应用程序进行文档化，并继续部署构建的映像。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/7cd97f12f2441c3cdb70cb0f122e0c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CdKA5RVy277WRCn5RNOsDg.png"/></div></div></figure><h2 id="232a" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">为什么要将你的前端角度应用程序Dockerize。？</h2><ol class=""><li id="7467" class="lo lp in jm b jn lq jr lr jv ls jz lt kd lu kh lv lw lx ly bi translated"><strong class="jm io">改进型</strong><a class="ae ki" href="https://www.infoworld.com/article/3271126/what-is-cicd-continuous-integration-and-continuous-delivery-explained.html" rel="noopener ugc nofollow" target="_blank">T5】CI/CD</a><strong class="jm io">。</strong></li></ol><p id="ed78" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对应用程序进行dockerizing带来的健全性和效率是无价的。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="0fa6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这可以通过在您的<a class="ae ki" href="https://www.infoworld.com/article/3271126/what-is-cicd-continuous-integration-and-continuous-delivery-explained.html" rel="noopener ugc nofollow" target="_blank"> CI管道中包含docker构建流程来进一步改进。</a>您将节省大量时间，并减轻许多头痛，尤其是如果您有一个定义明确的CI/CD。</p><p id="344e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。复制&amp;可扩展性</strong></p><p id="018c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您的应用程序将是自包含的，因此可以使用像<a class="ae ki" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>这样的容器编排工具按需自动伸缩。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mb ma l"/></div></figure><p id="d0d4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 3。应用版本</strong></p><p id="cab7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">您构建的docker映像可以用版本名进行标记，从而作为应用程序某个状态的参考(这将证明在恢复到稳定版本/状态时非常有用)。比如myapp:1.0.0。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mc ma l"/></div></figure><p id="3990" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这些镜像版本作为<a class="ae ki" href="https://docs.docker.com/registry/" rel="noopener ugc nofollow" target="_blank">注册表</a>存储在所有代码托管平台中，最流行的存储库是<a class="ae ki" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub。</a></p><h2 id="e131" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">先决条件</h2><ol class=""><li id="88af" class="lo lp in jm b jn lq jr lr jv ls jz lt kd lu kh lv lw lx ly bi translated"><a class="ae ki" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank">角度的基本知识。</a></li><li id="a171" class="lo lp in jm b jn md jr me jv mf jz mg kd mh kh lv lw lx ly bi translated"><a class="ae ki" href="https://docs.docker.com/get-started/" rel="noopener ugc nofollow" target="_blank">码头工人的基础知识。</a></li><li id="107f" class="lo lp in jm b jn md jr me jv mf jz mg kd mh kh lv lw lx ly bi translated"><a class="ae ki" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank"> Nginx的基础知识。</a></li></ol><h2 id="6782" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">构建并服务于您的角度应用</h2><p id="5cb4" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">因此，您已经构建了自己的angular应用程序，并希望在本地提供服务，以便测试服务器将如何呈现您的捆绑应用程序。</p><p id="f52d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们可以使用一个有用的npm包<a class="ae ki" href="https://www.npmjs.com/package/http-server" rel="noopener ugc nofollow" target="_blank"> http-server </a>来提供捆绑的应用程序。</p><p id="c6b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第一步:安装Http-Server </strong></p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="f776" class="kv kw in mm b gy mq mr l ms mt">npm i http-server</span></pre><p id="1670" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第二步:分发文件夹</strong></p><p id="6277" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在项目文件夹中运行以下命令:</p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="2d3f" class="kv kw in mm b gy mq mr l ms mt">http-server ./dist</span></pre><p id="6ae5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Http-server在端口<strong class="jm io"> 8080、</strong>上提供服务，因此请前往此地址<strong class="jm io"/><a class="ae ki" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"><em class="mu">http://localhost:8080</em></a><em class="mu"/>查看应用程序。</p><h2 id="1db3" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">Docker设置</h2><p id="d088" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">基本上，<strong class="jm io"> Docker容器/图像</strong>是一个包含所有依赖项的自包含应用程序，可以是小服务，如卡片处理、时事通讯服务。</p><p id="19b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">而<a class="ae ki" href="https://docs.docker.com/engine/reference/builder/#:~:text=A%20Dockerfile%20is%20a%20text,can%20use%20in%20a%20Dockerfile%20." rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> DockerFile </strong> </a>包含关于如何构建包含所有依赖关系的容器的指令。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mv ma l"/></div></figure><p id="7003" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在接下来的步骤中，我们将设置构建映像所需的docker配置，然后继续构建和运行映像。</p><p id="2b12" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第一步:创建DockerFile </strong></p><p id="1646" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> DockerFile </strong>包含构建docker映像(容器)的指令。<br/>在你的项目的根目录下创建这个没有扩展名的文件<a class="ae ki" href="https://docs.docker.com/engine/reference/builder/#:~:text=A%20Dockerfile%20is%20a%20text,can%20use%20in%20a%20Dockerfile%20." rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> DockerFile </strong> </a>。</p><p id="bd93" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">该文件的内容将包括:</p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="ce7a" class="kv kw in mm b gy mq mr l ms mt">FROM nginx:1.15.8</span><span id="c0c9" class="kv kw in mm b gy mw mr l ms mt">EXPOSE 80</span><span id="36f3" class="kv kw in mm b gy mw mr l ms mt">COPY conf/default.conf /etc/nginx/conf.d/</span><span id="d410" class="kv kw in mm b gy mw mr l ms mt">RUN rm -rf /usr/share/nginx/html/*</span><span id="8137" class="kv kw in mm b gy mw mr l ms mt">COPY dist /usr/share/nginx/html</span><span id="8236" class="kv kw in mm b gy mw mr l ms mt">CMD ["nginx", "-g", "daemon off;"]</span></pre><p id="270a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">以上配置将构建一个<a class="ae ki" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank"> Nginx服务器</a>映像，在端口80上为您的应用程序提供服务。</p><p id="2603" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第二步:创建Nginx配置文件。<br/> 在上面的dockerFile配置(第3行)中，Docker正在期待一个配置文件(<code class="fe mx my mz mm b">default.conf</code> ) <strong class="jm io"> </strong>，我们需要创建该文件并将其传递给Docker映像。当我们需要修改Nginx配置时，这将非常有用。</p><p id="714b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在项目根文件夹中创建这个文件夹<strong class="jm io">。/conf </strong></p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="54d0" class="kv kw in mm b gy mq mr l ms mt">mkdir ./conf</span></pre><p id="b46e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">继续创建Nginx配置文件</p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="4296" class="kv kw in mm b gy mq mr l ms mt">default.conf</span></pre><p id="24ab" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">文件的内容(随意修改):</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mc ma l"/></div></figure><p id="792b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">此时，映像配置已经完成，我们准备好构建映像了。</p><p id="d014" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第三步:构建docker映像</strong></p><p id="a510" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在这一步中，我们将构建angular应用程序docker映像。首先，我们需要确保我们已经构建了应用程序(这个过程可以包含在CI中)。</p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="26e9" class="kv kw in mm b gy mq mr l ms mt">ng build --prod</span></pre><p id="3a45" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要构建映像，运行以下命令(其中<app_name>是您的应用程序名称):</app_name></p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="5c72" class="kv kw in mm b gy mq mr l ms mt">docker build -t &lt;APP_NAME&gt; .</span></pre><p id="b311" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第四步:运行docker镜像</strong></p><p id="8051" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在docker文件中，我们将<strong class="jm io">端口80 </strong>指定为应用程序将运行的端口(<strong class="jm io">公开</strong>)，为了让我们在运行映像(容器)之外访问它，我们将需要在外部公开应用程序，为此，我们将<a class="ae ki" href="https://en.wikipedia.org/wiki/Port_forwarding" rel="noopener ugc nofollow" target="_blank">端口5100 上的应用程序进行</a>端口转发(您可以选择当前未使用的任何其他端口)。</p><p id="c0fa" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要运行docker映像，请运行以下命令:</p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="75f2" class="kv kw in mm b gy mq mr l ms mt">docker run -p 5100:80 &lt;DOCKER_IMAGE&gt;</span></pre><p id="8029" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要查看应用程序，请访问以下地址:</p><pre class="kk kl km kn gt ml mm mn mo aw mp bi"><span id="5829" class="kv kw in mm b gy mq mr l ms mt"><a class="ae ki" href="http://localhost:5100" rel="noopener ugc nofollow" target="_blank">http://localhost:5100</a></span></pre><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="na ma l"/></div></figure><h2 id="7a8f" class="kv kw in bd kx ky kz dn la lb lc dp ld jv le lf lg jz lh li lj kd lk ll lm ln bi translated">在生产中运行映像</h2><p id="b0d3" class="pw-post-body-paragraph jk jl in jm b jn lq jp jq jr lr jt ju jv mi jx jy jz mj kb kc kd mk kf kg kh ig bi translated">现在您已经构建并测试了docker映像，您希望在生产中运行它。有很多方法可以让映像运行:</p><p id="cd63" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><a class="ae ki" href="https://github.com/docker/compose" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> 1。docker-compose </strong> </a></p><p id="c0d4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是目前最简单的方法让你的图像启动并运行，但不建议大规模使用。<a class="ae ki" href="https://docs.docker.com/compose/production/" rel="noopener ugc nofollow" target="_blank">阅读_更多</a></p><p id="67d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> 2。Kubernetes <br/> </strong>这个容器编排工具将使你能够轻松地管理和自动扩展你的应用程序，并且是我最喜欢的。</p><p id="2bad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">还有其他容器编排工具(<a class="ae ki" href="https://phoenixnap.com/blog/container-orchestration-tools" rel="noopener ugc nofollow" target="_blank">列表</a>)。请随意设置和探索它们。</p><p id="03bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">希望你发现这很有帮助，你的阅读伴随着笑声。我确实相信教育应该是有趣的。请随意留下任何评论或建议，或者一些掌声。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><a href="https://www.buymeacoffee.com/GeoffDeveloper"><div class="gh gi nb"><img src="../Images/22f31cfdc97285a6a1be974ebc34200d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*Ql4uAvVggfVc2TDPuVxw1Q.png"/></div></a></figure><p id="1eeb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">多love️！</p><p id="f037" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mu">你可以在</em><a class="ae ki" href="https://twitter.com/GeoffreyMahugu" rel="noopener ugc nofollow" target="_blank"><em class="mu">Twitter</em></a><em class="mu">上关注我，或者如果你愿意与我合作，你可以在</em> <a class="ae ki" href="https://geoffreymahugu.com" rel="noopener ugc nofollow" target="_blank"> <em class="mu"> Portfolio Link获取我的联系人。</em> </a></p><p id="d944" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mu">更多内容请看</em><a class="ae ki" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mu">plain English . io</em></a></p></div></div>    
</body>
</html>