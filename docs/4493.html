<html>
<head>
<title>Simplifying Code With Maps in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript中的地图简化代码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simplifying-code-with-maps-in-javascript-7552323c6629?source=collection_archive---------15-----------------------#2020-12-15">https://javascript.plainenglish.io/simplifying-code-with-maps-in-javascript-7552323c6629?source=collection_archive---------15-----------------------#2020-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5f672a132f68c42c4a13110f758d4f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OIyS0KPLS_yh_LaX.jpg"/></div></div></figure><p id="ff9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">开发人员经常发现自己处于需要根据各种条件返回不同结果的情况。经常发生这种情况的一个具体例子是，当我们想要根据一些可以切换的状态变量在组件内部呈现不同的JSX时。</p><p id="53b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，代码通常看起来像这样:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="f861" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有一个简单的例子，我们有一个数据卡，作为一些分析仪表板的一部分，具有预定义的样式和布局。该卡允许在<code class="fe lc ld le lf b">sessions</code>和<code class="fe lc ld le lf b">post</code>数据之间切换。唯一改变的元素是卡片图标和标题，所以引入<code class="fe lc ld le lf b">cardType</code>布尔函数是有意义的，基于它可以呈现适当的图标和标题。此外，正确类型的数据将基于此切换显示。</p><p id="bc60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">除了代码重复之外，这种方法还有另一个问题。让我们假设我们的组件现在有一个额外的数据类型要显示— <code class="fe lc ld le lf b">pageViews</code>。此时，作为第一步，我们需要将切换按钮重构为可用类型的下拉列表。接下来，我们可以引入一个<code class="fe lc ld le lf b">switch</code>语句来代替冗长的<code class="fe lc ld le lf b">if/else</code>条件。因此，更新后的组件将如下所示:</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="262a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码看起来不那么重复，如果我们需要显示更多类型的数据，很容易添加新的<code class="fe lc ld le lf b">case</code>和下拉选项。然而，我们仍然可以做得更好。如果我们可以根据<code class="fe lc ld le lf b">dataType</code>的值从某种配置对象中获取<code class="fe lc ld le lf b">title</code>和<code class="fe lc ld le lf b">Icon</code>会怎么样？听起来我们需要数据类型和组件变量之间的某种映射。这就是我们可以使用数据结构的地方。</p><p id="8189" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae lg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" rel="noopener ugc nofollow" target="_blank"> Map </a>是ES6的加法，只是一个键值对的集合。历史上在JS中，对象被用于存储这样的字典对，然而Map比对象有一些优势。Map通过插入键来保持键的顺序，而对于对象则不是这样，因为对象的顺序没有保证。<br/> 2。Map可以有任何值作为它的键，而对于对象，它只有字符串和符号。<br/> 3。映射可以直接迭代，而对象在大多数情况下需要在此之前进行某种转换(例如使用<code class="fe lc ld le lf b">Object.keys</code>、<code class="fe lc ld le lf b">Object.values</code>或<code class="fe lc ld le lf b">Object.entries</code>)。<br/> 4。同样，使用<code class="fe lc ld le lf b">size</code>道具可以轻松确定地图的大小。必须使用上述方法之一将对象转换为数组。<br/> 5。在频繁添加/删除操作的情况下，Map具有一定的性能优势。</p><p id="2065" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们已经熟悉了地图，让我们重构我们的组件来利用这个数据结构。</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="c24c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，在将<code class="fe lc ld le lf b">switch</code>重构为地图之后，组件变得更加精简了。起初，这个地图可能看起来有点奇怪，看起来像一个多维数组。第一个元素是键，第二个元素是值。因为键和值可以是任何东西，所以我们将数据类型映射到数组，其中第一个元素是title，第二个元素是icon组件。通常从这个嵌套数组中获取这两个值需要一点工作，但是<a class="ae lg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" rel="noopener ugc nofollow" target="_blank">析构赋值</a>语法使它变得很容易。这种语法的另一个好处是，我们可以给我们的变量起任何名字，这在我们想把<code class="fe lc ld le lf b">title</code>或<code class="fe lc ld le lf b">Icon</code>改名为其他名字时很方便，而不用修改映射本身。贴图是在组件外部声明的，因此不会在每次渲染时不必要地重新创建。</p><p id="f278" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">既然我们这样做了，为什么不把下拉选项的数组也重构为一个地图呢？选项只是值和标签之间的映射，这是一个完美的映射用例！</p><figure class="kw kx ky kz gt jr"><div class="bz fp l di"><div class="la lb l"/></div></figure><p id="61e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于Map没有<code class="fe lc ld le lf b">map</code>方法，所以需要先转换成数组。这可以通过使用<a class="ae lg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#Spread_in_array_literals" rel="noopener ugc nofollow" target="_blank">阵列排列</a>或<a class="ae lg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from" rel="noopener ugc nofollow" target="_blank">阵列来完成。这里我们再次受益于析构赋值，所以我们可以很容易地在map方法的回调中访问<code class="fe lc ld le lf b">label</code>和<code class="fe lc ld le lf b">value</code>，然后用这些键和它们的值创建一个对象。</a></p><p id="faff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最终的结果看起来非常简洁和易于维护，我们只需要对地图做一些修改，以防添加更多的日期类型。</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="dc50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lo">最初发表于</em><a class="ae lg" href="https://claritydev.net/blog/simplifying-code-with-maps-in-javascript/" rel="noopener ugc nofollow" target="_blank"><em class="lo">https://claritydev.net</em></a><em class="lo">。</em></p></div></div>    
</body>
</html>