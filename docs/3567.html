<html>
<head>
<title>Securing React Applications with Auth0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Auth0保护React应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/securing-react-applications-with-auth0-333180f8ea06?source=collection_archive---------4-----------------------#2020-10-09">https://javascript.plainenglish.io/securing-react-applications-with-auth0-333180f8ea06?source=collection_archive---------4-----------------------#2020-10-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="87cb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Auth0引导新React应用程序的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/719f559a73a78f089e8984e681993b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*00QMhMQjrnReh0xDJQCfqw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Created by the author with <a class="ae kv" href="https://www.canva.com/" rel="noopener ugc nofollow" target="_blank">Canva</a></figcaption></figure><p id="8c8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您正在寻找一个关于如何创建一个新的React应用程序并使用Auth0作为登录提供者的全面指南，那么这篇文章就是为您准备的。我将从头到尾进行一次完整的演示，展示它是如何完成的，并在此过程中给出一些指导。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="f369" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">为什么对登录提供者使用Auth0？</h2><p id="33da" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我工作的初创公司从一开始就在他们的应用程序中使用Auth0。我们将它设置为web应用程序和React本地移动应用程序的登录提供者。</p><p id="919d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Auth0通过为您的用户处理所有登录、注册和密码管理来提供价值。您无需构建登录和密码管理的用户界面，即可获得所有这些功能。</p><p id="93ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这为您的工程团队节省了大量的前期时间，因为他们不必自己构建和维护所有这些。Auth0还可以免费使用一定数量的每日活跃用户，这是相当慷慨的。请注意，在最初的免费预览窗口期间，您可以使用一些高级功能，但除非在最初的预览期结束后切换到付费帐户，否则您将无法使用这些功能。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="0b5c" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">使用Auth0获取设置</h2><p id="91c3" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在我们开始构建我们的演示应用程序之前，您需要为自己设置一个Auth0帐户。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/d5b3a98fdbd1654e14297442b292a8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-HlkCQ_Tih_6BY7RFsf4xQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://auth0.com/" rel="noopener ugc nofollow" target="_blank">Visit Auth0 site</a></figcaption></figure><p id="ce2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">成功创建帐户后，您将进入以下屏幕。我们将需要创建一个新的单页应用程序。首先点击菜单中的应用程序选项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/390d1e55adf7a430e065134ea425f446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JKnnyMWCzGRw19BeiZZMdQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by author</figcaption></figure><p id="91cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将带您进入应用程序列表。我们需要单击“创建应用程序”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/de8dc340f6e0900dab13465622288e3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3YiqZIPKAVLJGZXl-U3cDQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by author</figcaption></figure><p id="63b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该对话框将询问新应用程序的名称，我们希望选择“单页Web应用程序”选项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/aa2e582c24bf975ecc18e77e38e9603c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7jytCwv7fUAAz2xvr3wAw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by author</figcaption></figure><p id="a355" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建应用程序后，您可以看到域、客户端ID和客户端密码。当我们构建应用程序时，您将需要参考这些信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/4859b6fe4b2171e4d97f04419af0d270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GjuHuFB9G7fZnRa0-ROElQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by author</figcaption></figure><p id="1129" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们进入应用程序之前，还有一个步骤。您需要在三个字段中输入运行应用程序的URL。你可以在下面我输入的截图中看到:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="f14b" class="lz ma iq nd b gy nh ni l nj nk"><a class="ae kv" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></span></pre><p id="a2f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认情况下，Create React应用程序在端口3000上运行，所以这就是我在这里输入的内容。如果你想在另一个端口上运行，你可以切换到那个端口。</p><p id="94ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，当您想要将应用程序部署到其他地方时，也需要添加该URL。您可以添加任意数量的URL作为逗号分隔值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/e55d57766c0050a9870e086f8891a037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XFFG_nGT_ND_eZ8T11_JXQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by the author</figcaption></figure><p id="26bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就包括了我们需要的所有配置。现在我们可以继续设置演示应用程序了。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="6e2f" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">演示应用程序</h2><p id="1771" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">现在我们已经配置好了一切，我们可以开始编码了。首先，我们将使用Create React App引导一个新的应用程序，然后通过npm安装Auth0包。</p><p id="4d1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在终端中运行以下命令来创建应用程序，安装Auth0-React SDK，最后运行应用程序。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="aa8d" class="lz ma iq nd b gy nh ni l nj nk">npx create-react-app auth0-react-demo<br/>cd auth0-react-demo/<br/>npm install @auth0/auth0-react<br/>yarn start</span></pre><p id="e5a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Auth0使用React上下文来管理用户的身份验证状态。我们添加的第一个代码是将Auth0提供程序添加到应用程序的根目录。您将需要用我们之前创建的Auth0应用程序中的值替换<em class="nm">域</em>和<em class="nm">客户端Id </em>。</p><p id="65cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">T5】src/index . jsT7】</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="4aeb" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">反应引导和登录</h2><p id="1164" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们还将在我们的应用程序中添加React Bootstrap，以便利用它提供的预构建组件，并为我们的演示添加一点风格。</p><p id="088e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在终端中运行以下命令，从npm安装React引导。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="c9d9" class="lz ma iq nd b gy nh ni l nj nk">npm install react-bootstrap bootstrap</span></pre><p id="50d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了可用的引导组件，我们将更新我们的<em class="nm"> App.js </em>文件，如下所示。</p><p id="5141" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="nm"> src/App.js </em> </strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="b6a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在UI的顶部添加了一个导航栏和一个按钮，作为我们的登录按钮。为了重定向到默认的Auth0登录屏幕，我们将使用来自<em class="nm"> useAuth0 </em>的<em class="nm">loginwithrirect</em>函数。</p><p id="7bbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们运行我们的应用程序，并单击登录按钮，我们应该重定向到登录屏幕。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/7e4316919b92dfcb6efa63f9c1a29eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*myod6Bvf3YfawlUXLZgQeA.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screen capture by the author</figcaption></figure><p id="80d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认登录后，您可以选择使用Google帐户登录，或者使用电子邮件和密码创建自己的登录帐户。</p><p id="fa71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我选择了一个Google帐户进行首次登录，Auth0将询问您是否允许访问您的个人资料。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/e3bc1adf6b12ff9f85d0bc3e7909e8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oaaczbnY8xfzHyJYltd8g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by the author</figcaption></figure><p id="9163" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您已经注册了一个用户，如果您转到Auth0 admin中的用户列表，您将在您的列表中看到该用户，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/c86358512521d77ef845bec1b57a53ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qreQd900o1gbe04YvsgoZg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by the author</figcaption></figure><p id="2752" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击列表中的用户会将您带到他们的详细信息页面。在这里，您可以看到用户的完整信息和历史记录，还可以执行更新用户或重置密码等操作。</p><p id="89b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你在邮件下面看，你会看到一条<em class="nm">已验证的</em>消息。如果您使用的是Auth0，您可以选择要求用户在他们的帐户实际激活之前，按照发送到他们电子邮件的验证链接进行操作。默认情况下，此设置是关闭的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/3ac38523304b4b4b0ac674cce1f429b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0CYspBVI-_f_sqPAxHSBg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screenshot by the author</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="0077" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">注销</h2><p id="c61c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">下一步是让我们的用户能够注销他们当前的会话。我们希望首先能够检查用户是否登录，并根据他们的身份验证状态切换显示哪个按钮。让我们展示一下这是如何做到的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e8d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用来自<em class="nm"> useAuth0的<em class="nm"> isAuthenticated </em>标志来检查用户是否通过了身份验证。我们的逻辑非常简单。如果为真，我们希望注销按钮，以便用户可以结束他们的会话，如果为假，我们显示登录按钮。</em></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="03ef" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">用户概要</h2><p id="340c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们演示的最后一部分是在用户登录后显示他们的个人资料。我们将为用户配置文件创建一个新组件。</p><p id="ce2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"><em class="nm">src/user profile . js</em></strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="7cda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们再次使用<em class="nm"> isAuthenticated </em>来确保用户在显示他们的个人资料之前已经登录。我们还从Auth0上下文中的<em class="nm">用户</em>对象获取所有用户详细信息。</p><p id="331c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后一步是简单地将这个新的概要组件添加到我们的主App.js文件中。完成这一更改后，文件的最终版本将如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="b1a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加了配置文件后，我们现在可以看到从登录到注销的完整用户会话。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/f979f2396e8ed9e008f3cd906ead7cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AHKTB_wgZc0PU0_NXs2nuw.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screen capture by the author</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="7e2a" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">使用Auth0深入挖掘</h2><p id="0186" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">所以我们的演示完全正常，但这绝对只是Auth0的皮毛。它提供许多功能和服务，例如:</p><ul class=""><li id="9118" class="nu nv iq ky b kz la lc ld lf nw lj nx ln ny lr nz oa ob oc bi translated">使用JavaScript规则从数据库向用户配置文件添加角色的能力。这只是Auth0中规则威力的一个例子，基本上有无限的可能性</li><li id="35cd" class="nu nv iq ky b kz od lc oe lf of lj og ln oh lr nz oa ob oc bi translated">许多社交提供商，如谷歌、脸书、苹果、LinkedIn等等。</li><li id="1d6a" class="nu nv iq ky b kz od lc oe lf of lj og ln oh lr nz oa ob oc bi translated">一长串扩展名</li><li id="aea5" class="nu nv iq ky b kz od lc oe lf of lj og ln oh lr nz oa ob oc bi translated">通过文本消息向用户发送代码来设置登录的能力(我在React本地应用程序中使用了这个特性)</li><li id="5529" class="nu nv iq ky b kz od lc oe lf of lj og ln oh lr nz oa ob oc bi translated">更多！</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="98b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这为在React应用程序中包含Auth0提供了一个温和的介绍。如果您正在寻找处理身份管理的东西，请确保检查Auth0。感谢阅读！</p></div></div>    
</body>
</html>