<html>
<head>
<title>JavaScript: Call Stack Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript:调用堆栈解释</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-call-stack-explained-fd9df1c49d2e?source=collection_archive---------0-----------------------#2020-02-01">https://javascript.plainenglish.io/node-call-stack-explained-fd9df1c49d2e?source=collection_archive---------0-----------------------#2020-02-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/adf33c46b41d3de46e0b202f9449adf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*CCHexfHNCNo-f8aw3rbRew.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="3b63" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">大约一年前，正如我的投资组合所说，我是一名高级JavaScript开发人员。但是在孤独的时候，当我问自己JavaScript是如何工作的或者什么是JavaScript。我不完全确定。我听说V8是一个术语，Chrome的运行时并不知道它是什么意思，当我问其他开发者朋友时，他们用单线程、回调等词给出了定义。当我问谷歌同样的问题时，它说，“<strong class="kb ir"> <em class="kx"> JavaScript是单线程非阻塞异步并发语言</em> </strong> <a class="ae jy" href="https://emojipedia.org/disappointed-face/" rel="noopener ugc nofollow" target="_blank">😞</a>”。什么？这些大词把我弄糊涂了，所以我又搜索了一些，然后它说"<strong class="kb ir"> <em class="kx"> JavaScript有一个调用栈，一个事件循环，一个回调队列，和一些其他的API东西</em> </strong>😞".读完这些东西后，我把“<strong class="kb ir"> Senior </strong>”从我的个人资料中删除，成为一名JavaScript开发者😞。经过一年的学习和研究，我想我现在明白了这一点，我想与你分享。由于我们狭隘的思想无法在一篇文章中涵盖所有内容，我们将分部分讨论这一点。在这一部分，我将解释“调用堆栈”关键字。</p><h1 id="b632" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">什么是调用栈？</h1><p id="b5f6" class="pw-post-body-paragraph jz ka iq kb b kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ma ku kv kw ij bi translated">调用堆栈是一种后进先出(LIFO)数据结构，包含执行将恢复的地址，通常还包含每个调用的局部变量和参数。让我们通过一个简单的例子来理解调用栈。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/3a74a1477d2a1fedb0cb8af6be6e25e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8VwCosp20GuNz7FKDtXmLw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="1cdd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">当我们进入一个函数时，我们把一些东西放到栈中，如果我们从一个函数返回，我们弹出栈顶，这是栈所能做的。让我们一行一行地运行这段代码，检查它到底是如何工作的。</p><p id="b59a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第一步</strong></p><p id="77a5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果你运行这个文件，有一个主函数，就像文件本身一样，所以，我们把它推到堆栈上。然后我们有一些函数定义，它们不会马上执行，最后，我们有打印方块，对，所以打印方块是一个函数调用，所以我们把"<em class="kx"> printSquare </em>"推到堆栈上。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/99cc4aca01ad364208ab87f5a59d89d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmL-XPdlit5FuDxLvPRcWw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="23e3" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第二步</strong></p><p id="58da" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">将“<em class="kx"> printSquare </em>”放入堆栈后，它调用了“<em class="kx"> square </em>函数，所以我们将正方形放入堆栈。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/703ab348396ef817b554e2203af32071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHvc4BArOnXfo7Afg6LFMg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="e206" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第三步</strong></p><p id="bfbd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">再次“<em class="kx">平方</em>”函数调用“<em class="kx">乘</em>”，所以我们把那个也放入堆栈。我们没有从堆栈中弹出任何东西，因为到目前为止没有返回任何东西，一个函数调用另一个函数作为返回语句，堆栈被填满。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/15d76e5edb7645f46b5e93d76788ca26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMHto93YS40k14edZi9g4A.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="2724" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第四步</strong></p><p id="12bd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在所有这些函数调用之后，现在我们得到一个返回语句。</p><pre class="mc md me mf gt mk ml mm mn aw mo bi"><span id="da8a" class="mp kz iq ml b gy mq mr l ms mt">return a * b;</span></pre><p id="ea49" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以我们弹出堆栈，从堆栈中移除“<em class="kx">乘</em>”。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/703ab348396ef817b554e2203af32071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHvc4BArOnXfo7Afg6LFMg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="c27d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第五步</strong></p><p id="5730" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在我们从"<em class="kx"> square </em>"函数中得到return语句的结果。所以我们也把它从堆栈中删除。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/99cc4aca01ad364208ab87f5a59d89d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmL-XPdlit5FuDxLvPRcWw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="8e52" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第六步</strong></p><p id="7d35" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在，在成功执行了"<em class="kx"> square </em>"函数之后，我们有一个要执行的语句。</p><pre class="mc md me mf gt mk ml mm mn aw mo bi"><span id="da3f" class="mp kz iq ml b gy mq mr l ms mt">console.log(squared);</span></pre><p id="65ea" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">它打印分配给变量“<em class="kx">平方</em>”的“<em class="kx">平方</em>”函数的结果。现在我们的筹码是这样的。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/a69cff27ee1816fe2372d4693452e378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_kM8Daqs-W7BvoO0zrHiQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="9360" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第7步</strong></p><p id="3d49" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在执行完这个"<em class="kx"> console.log </em>之后，它也会从堆栈中弹出，只剩下"<em class="kx">print square(4)</em>"&amp;"<em class="kx">main()</em>"函数:(。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/99cc4aca01ad364208ab87f5a59d89d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmL-XPdlit5FuDxLvPRcWw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="f44f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">第7步</strong></p><p id="7363" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">现在终于在完成程序的所有仪式和步骤后"<em class="kx"> printSquare(4) </em>"将从堆栈中弹出，然后是"<em class="kx"> main() </em>"函数。现在我们的堆栈又是空的和孤独的。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/67604a5bf0c510a4d6c15876d45cfd29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuDVubcFtoFp9oFCtwr4rw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><h1 id="b733" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">什么是堆栈跟踪？</h1><p id="8976" class="pw-post-body-paragraph jz ka iq kb b kc lw ke kf kg lx ki kj kk ly km kn ko lz kq kr ks ma ku kv kw ij bi translated">你曾经试图理解浏览器控制台中显示的错误日志吗？有时我们仅仅通过阅读第一行就忽略了，但是如果我们仔细观察，它们非常有助于判断错误来自哪里以及错误的后果是什么。让我们看看这个例子。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/1d6523af38ec47024124011f3d5fa5cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKPLZwBUwqtpN7NXzkTqjw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="1b32" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这里baz()在调用一个函数bar()，bar()在调用一个函数foo() &amp;我们亲爱的foo()抛出错误。现在，如果我们查看浏览器的日志，它会给我们一个很好的错误跟踪，以及它是如何产生的。这就是我们所说的“<strong class="kb ir">栈迹</strong>”。</p><p id="a4af" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">什么是堆栈溢出？</strong></p><p id="c669" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">不，我们不是在谈论著名的stackoverflow.com网站，而是一个通常用于v8引擎和JavaScript的术语。了解堆栈溢出发生的时间和原因。请看下一张图片。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/6967628d62efb64896251a4e2b47b0df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EsLqLzMbR5sgyxlQJf5yvA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="441e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这里我们调用foo()函数，它再次调用foo()函数。让我们看看我们的堆栈会发生什么情况。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/e50d9e7c0fa378dbfc4c0e1efaf2c436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NUsgJVw8tHXOg5jQi52BLg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="3110" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">一段时间后，我们的Chrome显示“我们不希望你调用同一个函数16K次，所以我们对你很失望，这就是为什么我给出一个错误”。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mb"><img src="../Images/13e8ec9de98af3359622f6816c8f8bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0NeKWwgvXWJOTTYpsPbfDg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Credits: <a class="ae jy" href="https://2014.jsconf.eu/" rel="noopener ugc nofollow" target="_blank">JS Conference</a></figcaption></figure><p id="30a5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以这就是如何调用stack works。在接下来的文章中，我们将讨论事件循环、回调队列、V8引擎的工作以及NodeJS如何在V8引擎上工作。</p><p id="950a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">更新<br/> </strong>下面是该系列的另外两篇文章，可以更好地理解JavaScript。</p><div class="mu mv gp gr mw mx"><a href="https://medium.com/javascript-in-plain-english/js-single-thread-non-blocking-explained-d5de012a33cf" rel="noopener follow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd ir gy z fp nc fr fs nd fu fw ip bi translated">JavaScript中的单线程和非阻塞是什么意思？</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">一次性理解JavaScript可能会很困难，也很忙乱。我读了很多教程，但没有得到…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">medium.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl js mx"/></div></div></a></div><div class="mu mv gp gr mw mx"><a href="https://medium.com/javascript-in-plain-english/javascript-event-loop-explained-dd9520a58544" rel="noopener follow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd ir gy z fp nc fr fs nd fu fw ip bi translated">JavaScript事件循环解释</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">通过实例对事件循环进行简单解释，以便更好地理解。</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">medium.com</p></div></div><div class="ng l"><div class="nm l ni nj nk ng nl js mx"/></div></div></a></div><p id="98f8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">感谢阅读||写学习。</strong></p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi nn"><img src="../Images/8fa3b0fe054a13c3766d159ba831adc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/1*puO9QPsENQ5ww1QKNuf6tw.gif"/></div></div></figure></div></div>    
</body>
</html>