<html>
<head>
<title>Opinionated Create React App With Useful Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">固执己见用有用的库创建React应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/opinionated-create-react-app-with-useful-libraries-f92bce7cc572?source=collection_archive---------5-----------------------#2020-04-08">https://javascript.plainenglish.io/opinionated-create-react-app-with-useful-libraries-f92bce7cc572?source=collection_archive---------5-----------------------#2020-04-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="00a5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用有用的库创建react应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b9e046fe3de0b2ae6b9cba346142baaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lK8DqxRW7pYqaZnZHJDDfw.png"/></div></div></figure><p id="03c5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">作为多年的前端开发经验，我将向您展示我在大多数项目中使用的React设置。</p><h1 id="51de" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">回购示例</h1><p id="04ec" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">以下是完整代码库的链接，以供参考:</p><div class="mk ml gp gr mm mn"><a href="https://github.com/manakuro/opinionated-create-react-app-example" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">manakuro/固执己见-创建-反应-应用程序-示例</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">这个项目是用Create React App引导的。键入脚本反应-应用程序-重新布线/自定义-cra风格-组件…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">github.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb kp mn"/></div></div></a></div><h1 id="86a1" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">设置创建React应用程序</h1><p id="5ecc" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">对于我的大多数React项目，我使用TypeScript是因为:</p><ul class=""><li id="1ead" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">静态类型让你很容易理解代码库(自文档化)。</li><li id="b218" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">组件让你知道什么道具是需要的，什么是不需要的。</li><li id="de09" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">如果所需的属性没有通过，TypeScript将立即警告您。</li><li id="f9d9" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">如果您使用可能为空的变量，Typescript会警告您，以便您可以避免不必要的运行时错误，如undefined。</li><li id="c52c" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">编辑器可以告诉你代码建议，让你的开发速度快得令人难以置信</li></ul><p id="5375" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最初，TypeScript中的代码可能看起来很简单，但是一旦你习惯了，你会发现它非常有用。</p><p id="7ccf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，让我们用TypeScript模板创建react应用程序:</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="71b3" class="nv lo iq nr b gy nw nx l ny nz">npx create-react-app my-react-app --typescript</span></pre><h1 id="f250" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">图书馆</h1><ul class=""><li id="7d49" class="nc nd iq kt b ku mf kx mg la oa le ob li oc lm nh ni nj nk bi translated"><a class="ae od" href="https://github.com/timarney/react-app-rewired" rel="noopener ugc nofollow" target="_blank">react-app-rewired</a>/<a class="ae od" href="https://www.npmjs.com/package/customize-cra" rel="noopener ugc nofollow" target="_blank">customize-CRA</a></li><li id="16df" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://github.com/commitizen/cz-cli" rel="noopener ugc nofollow" target="_blank"> commitzen </a></li><li id="ddc7" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">风格系统</li><li id="e3cc" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">主题用户界面</li><li id="9c13" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">玩笑</li><li id="c95d" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://testing-library.com/" rel="noopener ugc nofollow" target="_blank">反应-测试-库</a></li><li id="af5a" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">Wallaby.js</li></ul><h1 id="3c5d" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">发展环境</h1><p id="7960" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">首先，我将介绍一些用于高效开发的库。以下是其中的一些:</p><ul class=""><li id="f614" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated"><a class="ae od" href="https://github.com/commitizen/cz-cli" rel="noopener ugc nofollow" target="_blank"> commitzen </a></li><li id="7d67" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://github.com/timarney/react-app-rewired" rel="noopener ugc nofollow" target="_blank">react-app-rewired</a>/<a class="ae od" href="https://www.npmjs.com/package/customize-cra" rel="noopener ugc nofollow" target="_blank">customize-CRA</a></li><li id="4355" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">eslint/beauty/lint-staged</li></ul><h2 id="9c50" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">委员会</h2><p id="5d4e" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated"><a class="ae od" href="http://commitizen.github.io/cz-cli/" rel="noopener ugc nofollow" target="_blank"> commitzen </a>允许您使用交互式命令行界面填写必需的提交字段。</p><p id="9dda" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在提交之前，会出现下面的界面，您可以选择已经更改的提交类型。之后，commitzen将生成消息并自动提交。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/e8a9272df77069b6268f7c8cc3e92e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/0*XUdA8osegbX4iQWV.png"/></div></figure><p id="a473" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">虽然你可以定制提交消息模板，但是如果你不挑剔的话，你可以使用<a class="ae od" href="https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines" rel="noopener ugc nofollow" target="_blank"> AngularJS的提交消息约定</a>，这是前端开发中的一个流行约定，和其他库一样，<a class="ae od" href="https://github.com/vuejs/vue/blob/dev/package.json#L145-L149" rel="noopener ugc nofollow" target="_blank"> Vue.js </a></p><p id="c258" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那么，让我们来看看它是如何工作的。</p><p id="df3e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装commitzen和cz-conventi on-changelog:</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="84d7" class="nv lo iq nr b gy nw nx l ny nz">yarn add -D commitizen cz-conventional-changelog</span></pre><p id="907f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并在package.json中配置它:</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="3b8c" class="nv lo iq nr b gy nw nx l ny nz">"scripts": {<br/>  "start": "react-scripts start",<br/>  "build": "react-scripts build",<br/>  "test": "react-scripts test",<br/>  "eject": "react-scripts eject",<br/><strong class="nr ir">  "commit": "git-cz"</strong><br/>},</span><span id="f0f9" class="nv lo iq nr b gy oq nx l ny nz">...<br/><strong class="nr ir">"config": {<br/>  "commitizen": {<br/>    "path": "./node_modules/cz-conventional-changelog"<br/>  }<br/>}</strong></span></pre><p id="e66b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们按<code class="fe or os ot nr b">git add .</code>和<code class="fe or os ot nr b">yarn commit</code>运行:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/b68a0dd5f05ecabc70a4d0cb4f5a8d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jEdyey01Wf8YJBMcWbSYDw.gif"/></div></div></figure><h2 id="c296" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">react-app-重新布线/定制-cra</h2><p id="88ff" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">Create React App不允许你在默认不弹出的情况下自定义babel插件、eslint或jest设置。为了不弹出来，我们可以用<a class="ae od" href="https://github.com/timarney/react-app-rewired" rel="noopener ugc nofollow" target="_blank"> react-app-rewired </a>和<a class="ae od" href="https://github.com/arackaf/customize-cra/blob/3046d395878afc0e6ad8508f9be5a90edb46b9ef/readme.md" rel="noopener ugc nofollow" target="_blank"> customize-cra </a>。</p><p id="a06f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装react-app-rewired和自定义-cra:</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="21c3" class="nv lo iq nr b gy nw nx l ny nz">yarn add -D react-app-rewired customize-cra</span></pre><p id="62a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在根目录下创建一个<code class="fe or os ot nr b">config-overrides.js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="4d33" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并将package.json中的<em class="ox"> start </em>、<em class="ox"> build </em>和<em class="ox"> test </em>脚本修改成这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><h2 id="61a2" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">eslint/beauty/lint-staged</h2><p id="bc38" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">设置react-app-rewired后，就可以在项目中使用eslintrc.js了。</p><p id="4014" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以，还是装eslint更漂亮吧。</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="b9b8" class="nv lo iq nr b gy nw nx l ny nz">yarn add -D eslint eslint-config-prettier eslint-plugin-prettier prettier</span></pre><p id="e8a3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并添加eslintrc.js:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="43b8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Create React App提供了一个预置的基础配置，默认为<code class="fe or os ot nr b">react-app</code>。因此，我强烈建议您扩展它，并在其中添加您的规则。</p><p id="b856" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个eslint设置中也启用了beauty。所以，当你运行命令<code class="fe or os ot nr b">eslint —fix</code>时，eslint和prettier都会检测并修复代码。</p><p id="e1ec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我的编辑器中，我通常连接<code class="fe or os ot nr b">eslint — fix</code>来保存文件。所以，每次我保存文件，它都会自动格式化代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/96df9cf817b0ef7565ba38a329a9ba4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-QUD4vOBYvR4QRS_mMo0tw.gif"/></div></div></figure><p id="c5f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在VS代码中，可以像本文一样启用linter on save，<a class="ae od" href="https://alligator.io/workflow/auto-eslinting/" rel="noopener ugc nofollow" target="_blank">林挺on Save with Visual Studio Code和ESLint </a>。</p><p id="87ea" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们将设置lint-staged，在提交之前检查代码的格式是否正确。</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="fbb2" class="nv lo iq nr b gy nw nx l ny nz">yarn add -D lint-staged</span></pre><p id="939f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并将配置和脚本添加到package.json:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="168d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在运行commit之前，lint-stage将仅针对暂存文件运行，并强制eslint格式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/cc05fbd33daf92aa1c6ede5f70b3bc05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ChlSqoqsIERJQkJh9jg6Og.gif"/></div></div></figure><h1 id="5b47" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">用户界面</h1><p id="6ded" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">在前端开发中，我一直在努力解决UI组件bug或CSS代码混乱等问题。发生这种情况是因为每个开发人员创建了他们自己的UI组件和CSS代码，而没有注意到一个类似的组件已经被制作出来了。如果这种情况持续一段时间，您将会遇到以下问题:</p><ul class=""><li id="ab4a" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">很多不一致的风格</li><li id="5efa" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">大量重复的UI组件</li><li id="5332" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">大量不必要的设计和开发时间</li></ul><p id="8fc2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了避免这些问题，您需要保持我们的UI组件的一致性。创建可重用的组件使您的开发速度更快，还提供了一致的用户界面，帮助您的用户导航并与网站交互，而不会产生混淆。</p><p id="5593" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了实现这一点，我使用styled-system，因为:</p><ul class=""><li id="ef23" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">你可以编写没有命名冲突的CSS(对于CSS面条问题)</li><li id="c35d" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">您可以根据设计系统编写代码(针对不一致的风格问题)</li><li id="f626" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">您可以编写可重用的组件(针对重复的UI组件问题)</li></ul><p id="6ff2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那么，让我们来看看它是如何工作的。</p><h2 id="0796" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">风格系统</h2><p id="2709" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">风格化系统设计了一套将道具映射到设计系统的工具，也有一堆为CSS提供功能的API。它支持CSS-in-JS库，如styled-component、emotion，甚至支持Vue.js。</p><h2 id="e29c" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">主题用户界面</h2><p id="3505" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">主题UI 是基于设计原则创建可重用组件的风格化系统的下一个发展。主题用户界面的特点如下:</p><ul class=""><li id="9e33" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">风格系统的下一次进化</li><li id="8022" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">基于实用程序的原子CSS方法的创造者</li><li id="7397" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">使用<code class="fe or os ot nr b">sx</code>道具的主题风格</li><li id="915d" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">Style <a class="ae od" href="https://mdxjs.com/" rel="noopener ugc nofollow" target="_blank"> MDX </a>内容带有简单、富于表现力的API</li><li id="3098" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">使用<a class="ae od" href="https://github.com/KyleAMathews/typography.js" rel="noopener ugc nofollow" target="_blank">typhony . js</a>主题</li><li id="671e" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">几乎与任何UI组件库兼容</li><li id="8bee" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">与现有的<a class="ae od" href="https://styled-system.com/" rel="noopener ugc nofollow" target="_blank">风格的系统</a>组件一起工作</li><li id="b8c0" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">快速移动优先的响应风格</li><li id="587f" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">内置对黑暗模式的支持</li><li id="74d2" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">原始页面布局组件</li><li id="fc51" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">用于<a class="ae od" href="https://gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank">盖茨比</a>网站和主题的插件</li><li id="c46f" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">完全可定制的强大主题</li><li id="a69b" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">使用标准的<a class="ae od" href="https://system-ui.com/theme" rel="noopener ugc nofollow" target="_blank">主题规范</a>构建互操作性</li><li id="902b" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">用<a class="ae od" href="https://emotion.sh/" rel="noopener ugc nofollow" target="_blank">情感</a>为限定范围的样式构建</li></ul><p id="14f9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">属性可以让你内联任何元素，也可以使用主题中的值。因此，如果你给道具添加值<code class="fe or os ot nr b">bg: highlight</code>，主题UI将引用主题中的值<code class="fe or os ot nr b">colors: { highlight: “#663399”}</code>，这非常有用，因为你可以使它更通用，而不是为每个组件使用一个特定的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/086dd8f267b21c6821e3b6b7d974e27a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S5ehONEqAixf6AKd5ajqNQ.png"/></div></div></figure><p id="76ff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装主题用户界面:</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="c533" class="nv lo iq nr b gy nw nx l ny nz">yarn add theme-ui<br/>yarn add -D @types/theme-ui</span></pre><p id="ff91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<code class="fe or os ot nr b">App.tsx</code>中设置主题提供者:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="8ba1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe or os ot nr b">ThemeProvider</code>是主题UI中的一个内置提供者，它通过上下文API向其下的所有React组件提供一个主题。</p><p id="6199" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe or os ot nr b">&lt;Global /&gt;</code>组件将一个基本的CSS应用到HTML中作为全局样式。</p><p id="013a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们给<code class="fe or os ot nr b">src/styles/theme.ts</code>添加一个主题:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="d67f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是基于来自<a class="ae od" href="https://www.npmjs.com/package/@theme-ui/presets" rel="noopener ugc nofollow" target="_blank"> them-ui/presets </a>的预置，但是你可以在你的项目上定制你想要的任何东西。如果您的团队使用设计系统，您可以将其应用到主题中。</p><p id="95c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此套件中还提供了以下预设:</p><ul class=""><li id="e881" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/system" rel="noopener ugc nofollow" target="_blank">系统</a></li><li id="fb88" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/funk" rel="noopener ugc nofollow" target="_blank">放克</a></li><li id="0ed0" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/future" rel="noopener ugc nofollow" target="_blank">未来</a></li><li id="8122" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/roboto" rel="noopener ugc nofollow" target="_blank">机器人</a></li><li id="f875" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/dark" rel="noopener ugc nofollow" target="_blank">黑暗</a></li><li id="90e6" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/deep" rel="noopener ugc nofollow" target="_blank">深</a></li><li id="900c" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/swiss" rel="noopener ugc nofollow" target="_blank">瑞士</a></li><li id="4cba" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/tosh" rel="noopener ugc nofollow" target="_blank"> tosh </a></li><li id="5d6f" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/bootstrap" rel="noopener ugc nofollow" target="_blank">自举</a></li><li id="e83d" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/bulma" rel="noopener ugc nofollow" target="_blank">布尔玛</a>(在制品)</li><li id="1737" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://theme-ui.com/presets/tailwind" rel="noopener ugc nofollow" target="_blank">顺风</a></li></ul><p id="8af9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以在<a class="ae od" href="https://theme-ui.com/demo/" rel="noopener ugc nofollow" target="_blank">演示</a>页面上播放预设。</p><p id="527f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，让我们使用主题UI组件重写欢迎页面:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="49ab" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我喜欢用这种方式编写代码的原因是:</p><ul class=""><li id="96e8" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">你不再需要考虑CSS命名冲突了</li><li id="6c8b" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">你可以通过定义主题来保持风格的一致性</li><li id="a7ec" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">通过使用基本组件，如Box、Flex、Text等，可以避免创建重复的组件。即使有微小的差异，只是添加风格道具，没有必要创造一个新的。</li></ul><p id="cc40" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">主题UI中有一堆有用的特性，我甚至无法在这里描述。我建议你在<a class="ae od" href="https://theme-ui.com/" rel="noopener ugc nofollow" target="_blank">文档</a>中查看它们。</p><h1 id="d232" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">测试</h1><p id="0ec4" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">以下是我在项目中使用的一些测试库:</p><ul class=""><li id="9a21" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated"><a class="ae od" href="https://testing-library.com/" rel="noopener ugc nofollow" target="_blank">反应-测试-库</a></li><li id="c98a" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">玩笑</li><li id="6b02" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated"><a class="ae od" href="https://wallabyjs.com/" rel="noopener ugc nofollow" target="_blank"> Wallaby.js </a></li></ul><h2 id="3db6" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">反应测试库</h2><p id="534d" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我已经使用<a class="ae od" href="https://enzymejs.github.io/enzyme/" rel="noopener ugc nofollow" target="_blank">酶</a>有一段时间了，这是一个测试React组件的非常好的工具。通过使用浅层渲染，您可以将组件与它们所渲染的子组件隔离开来，这比使用<code class="fe or os ot nr b">mount</code>进行完全渲染更轻便高效。</p><p id="724e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过提供模拟真实用户行为的API，Enyzme允许我们专注于实现。</p><p id="f2a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">嘲讽函数和组件很容易让我写一个测试，但我也是:</p><ul class=""><li id="93d5" class="nc nd iq kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">在重构实现时，努力更新关于嘲讽的测试代码。</li><li id="c1cb" class="nc nd iq kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">对真实用户行为的覆盖面没有安全感。</li></ul><p id="4e92" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以最近我改变了写测试的心态。我关注更多用户的行为，因为如果预期的结果是安全的，您可以轻松地重构实现并更改代码。它还能让你对你的产品充满信心，给你的用户高质量的产品。</p><p id="6843" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">react-testing-library适合这种情况，因为它们提供了有用的API，使我们能够更加关注用户的行为。</p><p id="e242" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这些实用程序处理的是DOM而不是组件实例，并且鼓励按照预期的方式使用组件的测试。</p><p id="d142" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae od" href="https://testing-library.com/docs/guiding-principles" rel="noopener ugc nofollow" target="_blank">指导原则</a>说:</p><blockquote class="pb pc pd"><p id="9214" class="kr ks ox kt b ku kv jr kw kx ky ju kz pe lb lc ld pf lf lg lh pg lj lk ll lm ij bi translated">你的测试越像你的软件被使用的方式，它们就越能给你信心。</p></blockquote><p id="e4a6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">另外<a class="ae od" href="https://github.com/goldbergyoni/javascript-testing-best-practices#-%EF%B8%8F-33-whenever-possible-test-with-a-realistic-and-fully-rendered-component" rel="noopener ugc nofollow" target="_blank">JavaScript-测试-最佳实践</a>鼓励你完全渲染组件来测试用户的行为:</p><blockquote class="pb pc pd"><p id="f0b6" class="kr ks ox kt b ku kv jr kw kx ky ju kz pe lb lc ld pf lf lg lh pg lj lk ll lm ij bi translated">只要规模合理，就像用户一样从外部测试组件，完全呈现UI，对其进行操作，并断言所呈现的UI的行为符合预期。避免各种各样的嘲弄、部分和肤浅的渲染——这种方法可能会由于缺乏细节而导致未被捕获的错误，并且由于测试弄乱了内部结构而使维护变得更加困难(参见“支持黑盒测试”)。如果其中一个子组件明显变慢(例如动画)或使设置变得复杂——考虑明确地用一个假的替换它</p></blockquote><p id="9e42" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">虽然它们之间有利弊，实际上也有权衡，如果你像我一样在测试上有困难，你可以考虑尝试一下。</p><h2 id="c23a" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated">Wallaby.js</h2><p id="49da" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">Wallaby.js 是一个测试工具，当你改变时，它立即运行你的JavaScript或TypeScript测试，并在你的代码编辑器中以惊人的速度显示结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/e07ae009e64b05d7c8f302e809ff1d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J4JbtDDvCTzotHxW.gif"/></div></div></figure><p id="230a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当您更改测试代码时，Wallaby.js会自动检测错误并显示预期结果。</p><p id="81fe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这非常有用，可以提高您的开发效率。</p><p id="2a32" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我已经谈过如何使用Wallaby.js，在<a class="ae od" href="https://medium.com/better-programming/blazingly-fast-testing-with-wallaby-js-61383d60d7f9" rel="noopener">用Wallaby.js </a>进行惊人的快速测试，所以你可以检查一下。</p><h1 id="6930" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">结论</h1><p id="9f56" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">就是这样。我强调了开发、UI和测试库。我将在后面的帖子中讨论API和处理表单。</p><p id="15e7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望这件作品能让你感兴趣。</p><h2 id="0651" class="nv lo iq bd lp oe of dn lt og oh dp lx la oi oj lz le ok ol mb li om on md oo bi translated"><strong class="ak">用简单英语写的一段JavaScript笔记:</strong></h2><p id="c646" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到<a class="ae od" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">submissions@javascriptinplainenglish.com</a>给我们，我们会把你添加为作者。</p></div></div>    
</body>
</html>