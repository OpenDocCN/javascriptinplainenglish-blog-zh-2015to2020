<html>
<head>
<title>Updating a value in a nested array of objects in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在“反应”中更新对象嵌套数组中的值</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-updating-a-value-in-state-array-7bae7c7eaef9?source=collection_archive---------0-----------------------#2020-02-03">https://javascript.plainenglish.io/react-updating-a-value-in-state-array-7bae7c7eaef9?source=collection_archive---------0-----------------------#2020-02-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3790" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何只更新一个状态中对象数组中的一个值</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1b858730ad1303dc96e670ac8c89e3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SXWru8s0UhrTv-_qmDIL9Q.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">“Red and Blue Pelikan Br 40 Eraser on White Surface” by <a class="ae kv" href="https://www.pexels.com/@pixabay" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="ae29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们有一个包含一系列待办事项的组件，如下所示:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="f1bc" class="lx ly iq lt b gy lz ma l mb mc">state = {<br/>  todos: [<br/>   {id: 1, <br/>    title: "Eat breakfast",<br/>    completed: false},<br/>   {id: 2,<br/>    title: "Make bed",<br/>    completed: false}<br/>  ]<br/>}</span></pre><p id="5b62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们怎么能只在一个对象中更改key的值呢？</p><h1 id="b4d7" class="md ly iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">第一步:找到元素</h1><p id="9101" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们首先要找到对象数组中的索引，或者对象在数组中的位置。您可以通过任何键、id或名称或您认为有用的任何其他键来查找元素。我们将使用我们从函数中获得的id。通过给定元素的id和它在数组中的<strong class="ky ir">索引找到该元素(例如通过使用方法)。findIndex())</strong></p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="f30f" class="lx ly iq lt b gy lz ma l mb mc">const elementsIndex = this.state.todos.findIndex(element =&gt; <a class="ae kv" href="http://element.id/" rel="noopener ugc nofollow" target="_blank">element.id</a> == id )</span></pre><h1 id="2b85" class="md ly iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">第2步:创建状态数组的副本</h1><p id="a000" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">因为我们不应该<a class="ae kv" href="https://reactjs.org/docs/state-and-lifecycle.html#do-not-modify-state-directly" rel="noopener ugc nofollow" target="_blank">直接修改状态</a>，让我们通过<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" rel="noopener ugc nofollow" target="_blank"> ES6扩展运算符</a>功能创建它的副本，并将其保存到一个变量中。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="6547" class="lx ly iq lt b gy lz ma l mb mc">let newArray = [...this.state.todos]</span></pre><h1 id="6a6a" class="md ly iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated"><strong class="ak">第3步:更新一个值</strong></h1><p id="6319" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">以下是我们的步骤:<br/> 1。让我们重新定义一个我们想要更新的对象，用括号表示它的索引。<br/> 2 .让我们创建对象的副本(再次扩展运算符)，然后重写我们想要的一个键的一个值。在这种情况下，我们将把“完成”键从假转换为真，所以我们使用！来否定当前值。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="2e2c" class="lx ly iq lt b gy lz ma l mb mc">newArray[elementsIndex] = {...newArray[elementsIndex], completed: !newArray[elementsIndex].completed}</span></pre><p id="05fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:虽然“todos”是一个数组，这也是索引很重要的原因，但是toDoItem是一个对象，对象是无序的集合。因此，您只能无序选择一个将被更新的值。</p><h1 id="9e47" class="md ly iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">第4步:设置状态</h1><p id="a781" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">将<code class="fe mz na nb lt b">newArr</code>作为“todos”的值传递:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="f209" class="lx ly iq lt b gy lz ma l mb mc">this.setState({<br/>todos: newArray,<br/>});</span></pre></div></div>    
</body>
</html>