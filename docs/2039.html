<html>
<head>
<title>Learning JavaScript by Implementing Lodash Methods — Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过实现Lodash方法—函数来学习JavaScript</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/learning-javascript-by-implementing-lodash-methods-functions-7aa6b2fbbc96?source=collection_archive---------8-----------------------#2020-05-14">https://javascript.plainenglish.io/learning-javascript-by-implementing-lodash-methods-functions-7aa6b2fbbc96?source=collection_archive---------8-----------------------#2020-05-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4b79471ae9135355829221ee682ee51f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KCtgy7PTzUawxqkx"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@roaming_angel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Angel Luciano</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7dd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Lodash是一个非常有用的工具库，让我们可以轻松地处理对象和数组。</p><p id="7fcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，现在JavaScript标准库正在赶上诸如Lodash之类的库，我们可以用简单的方法实现许多功能。</p><p id="b051" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何实现一些Lodash方法来将函数转换成不同的形式。</p><h1 id="ef74" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe lz ma mb mc b">bind</code></h1><p id="8513" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">Lodash <code class="fe lz ma mb mc b">bind</code>函数返回一个我们设置的值为<code class="fe lz ma mb mc b">this</code>的函数，并且部分应用了一些参数。</p><p id="89ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过返回一个调用传入函数的<code class="fe lz ma mb mc b">bind</code>方法的函数来实现这一点，并返回部分应用了参数的函数。</p><p id="dd06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以编写以下代码:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="9ae8" class="mq lc iq mc b gy mr ms l mt mu">const bind = (fn, thisArg, ...partials)=&gt; { <br/>  return (...args) =&gt; fn.apply(thisArg, [...partials, ...args])<br/>}</span></pre><p id="2afd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们采用了<code class="fe lz ma mb mc b">fn</code>函数、<code class="fe lz ma mb mc b">thisArg</code>作为<code class="fe lz ma mb mc b">this</code>的值，以及<code class="fe lz ma mb mc b">partials</code>，这是一个要用<code class="fe lz ma mb mc b">fn</code>调用的参数数组。</p><p id="9a60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用JavaScript的函数的<code class="fe lz ma mb mc b">apply</code>方法调用<code class="fe lz ma mb mc b">fn</code>并将<code class="fe lz ma mb mc b">thisArg</code>作为第一个参数来设置<code class="fe lz ma mb mc b">fn</code>中<code class="fe lz ma mb mc b">this</code>的值和一个参数数组，我们使用spread操作符对其进行扩展。</p><p id="29d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们首先展开<code class="fe lz ma mb mc b">partials</code>来首先应用它们，然后我们展开在返回的函数中接收的<code class="fe lz ma mb mc b">args</code>。</p><p id="cbe2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么当我们这样称呼它的时候:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="cb31" class="mq lc iq mc b gy mr ms l mt mu">function greet(greeting, punctuation) {<br/>  return `${greeting} ${this.user}${punctuation}`;<br/>}</span><span id="d5f3" class="mq lc iq mc b gy mv ms l mt mu">const object = {<br/>  'user': 'joe'<br/>};<br/>const bound = bind(greet, object, 'hi');<br/>console.log(bound('!'))</span></pre><p id="a446" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到控制台日志应该记录“嗨，乔！”因为我们将<code class="fe lz ma mb mc b">greet</code>中<code class="fe lz ma mb mc b">this</code>的值设置为<code class="fe lz ma mb mc b">object</code>。然后我们首先应用<code class="fe lz ma mb mc b">'hi'</code>的部分参数，然后用感叹号调用<code class="fe lz ma mb mc b">bound</code>。</p><h1 id="6552" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe lz ma mb mc b">bindKey</code></h1><p id="2d76" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lz ma mb mc b">bindKey</code>类似于<code class="fe lz ma mb mc b">bind</code>,除了我们可以用它对一个对象的方法应用与<code class="fe lz ma mb mc b">bind</code>相同的操作。</p><p id="e07d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它也不允许我们改变<code class="fe lz ma mb mc b">this</code>的值，并保持该值作为该方法所在的原始对象。</p><p id="e791" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以如下实现<code class="fe lz ma mb mc b">bindKey</code>:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="c58d" class="mq lc iq mc b gy mr ms l mt mu">const bindKey = (object, key, ...partials) =&gt; {<br/>  return (...args) =&gt; object[key].apply(object, [...partials, ...args])<br/>}</span></pre><p id="ffa8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们将<code class="fe lz ma mb mc b">object</code>、<code class="fe lz ma mb mc b">key</code>和<code class="fe lz ma mb mc b">partials</code>作为参数。其中<code class="fe lz ma mb mc b">object</code>是带有我们想要调用<code class="fe lz ma mb mc b">bindKey</code>的方法的对象。</p><p id="74eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lz ma mb mc b">key</code>是我们想要应用部分参数的方法的关键，而<code class="fe lz ma mb mc b">partials</code>有要应用的参数。</p><p id="a2fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以如下运行它:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="03da" class="mq lc iq mc b gy mr ms l mt mu">const object = {<br/>  user: 'joe',<br/>  greet(greeting, punctuation) {<br/>    return `${greeting} ${this.user} ${punctuation}`;<br/>  }<br/>};<br/>const bound1 = bindKey(object, 'greet', 'hi');<br/>console.log(bound1('!'))</span><span id="8c07" class="mq lc iq mc b gy mv ms l mt mu">object.greet = function(greeting, punctuation) {<br/>  return `${greeting} ya ${this.user} ${punctuation}`;<br/>};</span><span id="f27b" class="mq lc iq mc b gy mv ms l mt mu">const bound2 = bindKey(object, 'greet', 'hi');<br/>console.log(bound2('!'))</span></pre><p id="b0cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们有带有<code class="fe lz ma mb mc b">greet</code>方法的<code class="fe lz ma mb mc b">object</code>，它返回一个引用<code class="fe lz ma mb mc b">this.user</code>的字符串，应该是<code class="fe lz ma mb mc b">'joe'</code>。</p><p id="f981" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe lz ma mb mc b">object</code>调用我们的<code class="fe lz ma mb mc b">bindKey</code>函数，以及我们想要用来调用返回函数的参数，这些参数将被设置为<code class="fe lz ma mb mc b">bound1</code>。</p><p id="7e3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在此阶段，<code class="fe lz ma mb mc b">bound1</code>将<code class="fe lz ma mb mc b">'hi'</code>设置为<code class="fe lz ma mb mc b">greeting</code>的值。然后当我们调用<code class="fe lz ma mb mc b">bound1</code>时，我们将<code class="fe lz ma mb mc b">'!'</code>传递给它，它用<code class="fe lz ma mb mc b">punctuation</code>调用<code class="fe lz ma mb mc b">bound1</code>。</p><p id="4a39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们从控制台日志中得到<code class="fe lz ma mb mc b">'hi joe !’</code>。</p><p id="9ddd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后我们把<code class="fe lz ma mb mc b">object.greet</code>换了一个不同的功能。现在，当我们像在倒数第二行那样调用<code class="fe lz ma mb mc b">bindKey</code>时，我们得到了<code class="fe lz ma mb mc b">bound2</code>函数，该函数将<code class="fe lz ma mb mc b">'hi'</code>字符串作为值off <code class="fe lz ma mb mc b">greeting</code>应用于<code class="fe lz ma mb mc b">object.greet</code>方法。</p><p id="7728" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当我们调用<code class="fe lz ma mb mc b">bound2</code>时，我们将<code class="fe lz ma mb mc b">'!'</code>应用为<code class="fe lz ma mb mc b">punctuation</code>的值。因此，我们在控制台日志输出中记录了字符串<code class="fe lz ma mb mc b">'hi ya joe !’</code>。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/aa58c7f33d49b534ca370fdc771d2664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XRwb5vi-BPoo9_WQ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@o_l_l_a?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Olya Kuzovkina</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2aa3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe lz ma mb mc b">delay</code></h1><p id="54b9" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">Lodash <code class="fe lz ma mb mc b">delay</code>方法在给定的等待时间(毫秒)后运行一个函数。它还带有可选参数，我们可以用这些参数调用我们的函数。</p><p id="eacd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lz ma mb mc b">setTimeout</code>函数实现我们自己的函数，如下所示:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="ef0c" class="mq lc iq mc b gy mr ms l mt mu">const delay = (fn, wait, ...args) =&gt; {<br/>  setTimeout((...args) =&gt; fn(...args), wait, ...args)<br/>}</span></pre><p id="91a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们只调用了<code class="fe lz ma mb mc b">setTimeout</code>作为第一个参数。第二个参数有<code class="fe lz ma mb mc b">wait</code>时间，而<code class="fe lz ma mb mc b">args</code>是将被传递到回调的参数，这是所有后续的参数。</p><p id="6f5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回调采用<code class="fe lz ma mb mc b">args</code>方法，然后应用传入函数<code class="fe lz ma mb mc b">fn</code>。</p><p id="dc4d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们这样称呼它时:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="1e08" class="mq lc iq mc b gy mr ms l mt mu">delay((text) =&gt; {<br/>  console.log(text);<br/>}, 1000, 'foo');</span></pre><p id="deea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到<code class="fe lz ma mb mc b">'foo'</code>是由我们在1秒钟后传递到<code class="fe lz ma mb mc b">delay</code>的函数记录的。</p><h1 id="b050" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="fcec" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">为了实现<code class="fe lz ma mb mc b">bind</code>和<code class="fe lz ma mb mc b">bindKey</code> Lodash方法，我们可以使用JavaScript函数的<code class="fe lz ma mb mc b">apply</code>方法来更改<code class="fe lz ma mb mc b">this</code>的值，并将参数应用于传入的函数。</p><p id="9274" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lz ma mb mc b">setTimeout</code>函数创建自己的Lodash <code class="fe lz ma mb mc b">delay</code>方法，延迟函数调用和调用回调的参数需要几毫秒。</p><h2 id="8d07" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">简明英语团队备注</strong></h2><p id="4de6" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一句如下的话来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"> <strong class="kf ir"> JavaScript简单明了</strong> </a>、<a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener">T21【AI】简单明了 </a>、<a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX</strong></a>、<a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener">、<strong class="kf ir"> Python简单明了</strong>、</a>、<strong class="kf ir">T33】——谢谢你们，继续学习吧！我们还推出了一个YouTube，希望您通过订阅我们的简单英语频道</strong> 来支持我们</p><p id="6f81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像往常一样，简单英语想要帮助推广好的内容。如果您有任何想提交给我们的出版物的文章，请发邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>并附上您的中位用户名和您感兴趣的写作内容，我们将回复您！</p></div></div>    
</body>
</html>