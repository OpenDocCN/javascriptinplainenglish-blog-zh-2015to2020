<html>
<head>
<title>Simple Feature Flags in a React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React应用程序中的简单特征标志</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simple-feature-flags-in-a-react-app-1fd77acd96dd?source=collection_archive---------4-----------------------#2020-05-06">https://javascript.plainenglish.io/simple-feature-flags-in-a-react-app-1fd77acd96dd?source=collection_archive---------4-----------------------#2020-05-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="1d9a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">需求是为新开发的页面和特性设置特性标志，这样我们就可以在不暴露新特性的情况下将代码部署到产品中，但仍然可以通过其他方式访问它们。</p><p id="079e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">基本上，“功能标志”为QAs或其他人在真实环境中测试我们的应用程序提供了一种方法，而无需删除以前的UI。</p><p id="2955" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">有像<a class="ae ki" href="https://launchdarkly.com/" rel="noopener ugc nofollow" target="_blank">launch crystally</a>这样的第三方服务，但我只是需要一些简单和免费的东西。解决方案是创建一个名为<strong class="jm io"> feature-flags.js </strong>的共享文件，该文件导出一个包含可用标志的对象，该对象将存储在localStorage中。该对象是扁平的，带有一个以页面名称为前缀的camel case键，并带有所切换的特性标志的后缀。《出埃及记》</p><pre class="kj kk kl km gt kn ko kp kq aw kr bi"><span id="f05a" class="ks kt in ko b gy ku kv l kw kx">const featureFlags = {<br/>  deploymentApp: getFlagState('IS_DEPLOYMENT_APP', 'deploymentApp'),<br/>  exploreV2: getFlagState('IS_EXPLORER_V2', 'exploreV2')<br/>};</span></pre><p id="5b38" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">可以从查询参数、本地存储或环境变量中设置功能标志。下面是<code class="fe ky kz la ko b">getFlagState</code>在代码中的样子:</p><figure class="kj kk kl km gt lb"><div class="bz fp l di"><div class="lc ld l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk"><a class="ae ki" href="https://gist.github.com/mannyyang/32b290f9f6375706bda2ba5903fc2e20" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/mannyyang/32b290f9f6375706bda2ba5903fc2e20</a></figcaption></figure><p id="f3e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在它们可以使用了，我需要一种方法来打开/关闭它们。每次通过控制台编辑本地存储都是一件痛苦的事情。对此的解决方案是提供一个隐藏的/dev页面，通过切换来打开某些特性标志。</p><figure class="kj kk kl km gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi li"><img src="../Images/b28c3c526b3177138cb88f2ea797ee2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*mDqVkog7ovgYHzjTboaC3w.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Feature Flag Widget</figcaption></figure><p id="1829" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">开发页面和功能标志小部件按钮的示例代码。“应用”按钮重新加载页面。</p><figure class="kj kk kl km gt lb"><div class="bz fp l di"><div class="lc ld l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk"><a class="ae ki" href="https://gist.github.com/mannyyang/e5293afe498dd0490535a40bee4008e4" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/mannyyang/e5293afe498dd0490535a40bee4008e4</a></figcaption></figure><p id="fd0d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">然后我们可以导入并在需要的地方使用它。</p><pre class="kj kk kl km gt kn ko kp kq aw kr bi"><span id="d791" class="ks kt in ko b gy ku kv l kw kx">async function load() {<br/>  if (featureFlags.exploreV2) {<br/>    return import('explore')<br/>      .then((<em class="lp">app</em>) =&gt; { apps.explore = app; });<br/>  }</span><span id="c1f2" class="ks kt in ko b gy lq kv l kw kx">  return import('explore/legacy')<br/>    .then((<em class="lp">app</em>) =&gt; { apps.explore = app; });<br/>}</span></pre><p id="8781" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">简单和甜蜜，并保持您的功能旗帜组织。</p><p id="5959" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">来源:</strong></p><ul class=""><li id="dd8f" class="lr ls in jm b jn jo jr js jv lt jz lu kd lv kh lw lx ly lz bi translated"><a class="ae ki" href="https://github.com/jayf/javascript-feature-flags/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">https://github . com/jayf/JavaScript-feature-flags/blob/master/readme . MD</a></li><li id="592c" class="lr ls in jm b jn ma jr mb jv mc jz md kd me kh lw lx ly lz bi translated"><a class="ae ki" href="https://featureflags.io/" rel="noopener ugc nofollow" target="_blank">https://featureflags.io/</a></li></ul></div></div>    
</body>
</html>