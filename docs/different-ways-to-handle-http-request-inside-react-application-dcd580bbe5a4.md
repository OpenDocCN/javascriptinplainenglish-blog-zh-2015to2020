# React 应用程序中处理 HTTP 请求的不同方法

> 原文：<https://javascript.plainenglish.io/different-ways-to-handle-http-request-inside-react-application-dcd580bbe5a4?source=collection_archive---------2----------------------->

## 在这篇文章中，我们将集中讨论向远程数据库发送请求并在我们的界面中显示请求的不同方法。

![](img/d6ec748386d47b0bbbf35efbbf7c2eed.png)

[Unsplash](http://unsplash.com/)

制作 UI 组件是制作 React 应用程序的基础。我们仍然可以创建可以改变数据的大型 web 应用程序，而不需要重新加载页面。哪一部分是创建 SPA 应用程序的最佳部分？当处理向远程服务器发送 HTTP 请求时，有多种方式请求数据以及如何处理数据。

这里我们用四种方式来概括它:

*   在一条直线上的
*   集中的
*   使用自定义挂钩
*   使用库

# 在一条直线上的

这是提出要求最简单直接的方式。发出请求并处理响应。

```
fetch("/articles").then(response => response.json());
```

它现在是最简单的形式，但在现实世界中，我们可能还需要添加错误处理，设置和更新我们的状态，将加载器添加到我们的应用程序中。将这些添加到我们的应用程序中，我们将得到类似这样的代码。

如果我们正在处理非常简单的应用程序，只有有限的调用次数，这可能看起来可以实现。但是在一个更大的应用程序中，我们有端点链，我们需要调用，这显然是一种更复杂的维护和读取方式。我们需要解决的问题太多了。考虑状态，更新它，设置加载和删除它，考虑错误处理，检查响应状态，声明空数组依赖，因此 **UseEffect** 只执行一次。

因此，内联调用以后会变得更加危险。在开发的后期，在我们的应用程序中避免这种类型的调用是非常好的。

# 集中的

当我们在一个文件夹和位置中专门为我们的 HTTP 调用添加服务的不同层被称为集中式。对于这种方法，我们通常在应用程序中将其命名为*服务或用户服务*。

这是一个我们定义的专用服务层的例子，通过普通的 JavaScript 和 **export** 指令来完成文章。它将作为 *getArticle* 功能的集中位置。

我们现在可以 ***将*** 这个函数导入到我们特定的组件文件中，并在那里使用这个函数。

在示例代码中，我们已经导入了之前导出的 articleService。这样做的好处是，我们可以随着应用程序的增长轻松扩展它，并且我们还实现了一致性。我们可以根据需要指定我们想要从特定的*服务*中导入的特定功能。

毕竟，使用这种方法，我们将减少和重用我们的函数调用，并从一个单一的集中位置提供服务。

# 使用自定义挂钩

自定义钩子只是一个 JavaScript 函数，它的名字以单词 use 为前缀，用于调用其他钩子。它还有助于将可重用的逻辑片段提取到可重用的功能中。实际上，它们是普通的 JavaScript 函数，可以在自身内部使用另一个钩子。

这是一个关于我们如何创建句柄加载状态来获取数据的例子。这是另一个由状态挂钩管理的状态变量。这意味着如果我们想要实现一个加载状态，我们可以设置状态变量并相应地更新`useFetch()`函数。使用这个简单的钩子简化了整个调用。

在这个演示中，我们将 URL 传递给了我们用一个空选项创建的 *useFetch()* 自定义挂钩，以获取我们从服务器获取的数据。获取数据后，代码从响应对象中提取数据并显示在屏幕上。

# 使用图书馆

向服务器发出 HTTP 请求需要大量的库。我们将进入一些流行的前三名图书馆，这在实现这一目的时变得非常方便。但是您仍然可以使用一个本地浏览器 API 来发出请求，代替 XMLHttpRequest，XMLHttpRequest 也提供了一种简单、合理的异步获取资源的方法。

## [Axio](https://yarnpkg.com/package/axios) s

这是我们可以使用的最受欢迎的图书馆之一。Axios 是基于承诺的，因此我们可以利用**异步，等待**更多可读的异步代码。我们还可以拦截和取消请求，并且有内置的客户端保护来防止跨站点请求伪造。使用起来非常简单。

```
axios.get(`https://restcountries.eu/rest/v2/all`)
 .then(res => {
 const countries = res.data;
 this.setState({ countries });
})
```

## [超级代理](https://github.com/visionmedia/superagent)

这是一个轻量级的渐进式 AJAX API，具有灵活性、可读性和较低的学习难度。它对初学者非常友好，即使是不了解 JavaScript 的开发人员也能轻松实现它。我们可以在代码中随意调用 SuperAgent，他们自己的例子通常将其别名为`request`而不是`ajax`。

## SWR/反应查询

这是新的，也是我个人最喜欢的获取数据的库之一。它非常方便，因为它带有[反应查询](https://github.com/tannerlinsley/react-query)或 [swr](https://swr.now.sh/) 、缓存、重试、焦点重取、重复查询、轻量级、类型严格、面向 JAMstack。这个库背后的主要策略是首先从缓存返回数据(陈旧的)，然后发送获取请求(重新验证)，最后是最新的数据。有了 SWR 组件，我们将不断自动获得一系列数据更新。

在这个例子中，useSWR 钩子接受一个*键*字符串和一个 *getArticle* 函数。`*key*`是数据的唯一标识符(通常是 API URL ),将被传递给 *getArticle* 。它可以是任何返回数据的异步函数。

对于我的大多数应用程序，我已经开始把它作为我的首选。这在使我们的 UI 更快和更具反应性方面非常方便和有效😍

# 结论

仍然有数百种方法和库可以从 React 应用程序发送 HTTP 请求。但是我个人做我使用和推荐使用的组合**国家管理，** [**SWR**](https://swr.vercel.app/) 。

谢谢你阅读它。我希望这能帮助你们了解 JavaScript 生态系统中处理 HTTP 请求的不同方式，特别是 REST 架构。

编码快乐！