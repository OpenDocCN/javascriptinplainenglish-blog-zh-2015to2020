<html>
<head>
<title>How to Handle Input Value Changes in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何处理React中输入值的变化</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-handle-input-value-changes-in-react-1835754b7cc4?source=collection_archive---------2-----------------------#2019-11-25">https://javascript.plainenglish.io/how-to-handle-input-value-changes-in-react-1835754b7cc4?source=collection_archive---------2-----------------------#2019-11-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="aef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在在</strong><a class="ae kl" href="http://jauyeung.net/subscribe/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://jauyeung.net/subscribe/</strong></a><strong class="jp ir">订阅我的邮件列表。</strong></p><p id="50ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在推特上关注我</strong><a class="ae kl" href="https://twitter.com/AuMayeung" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">https://twitter.com/AuMayeung</strong></a></p><p id="9ff9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">React的一个特殊特性是您必须自己处理输入值的更改。否则，用户无法看到他们输入的内容，因为状态中没有设置该值。</p><p id="2199" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要更新输入值并将其设置为组件的状态，首先我们必须添加:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="9b5f" class="kv kw iq kr b gy kx ky l kz la">const [title, setTitle] = React.useState("");</span></pre><p id="c750" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建函数<code class="fe lb lc ld kr b">setTitle</code>来设置<code class="fe lb lc ld kr b">title</code>的值。</p><p id="a4af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们添加了一个处理函数来从输入中获取值并设置它:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a6ca" class="kv kw iq kr b gy kx ky l kz la">const handleTitleChange = ev =&gt; setTitle(ev.target.value);</span></pre><p id="c302" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lb lc ld kr b">ev.target.value</code>有输入值。</p><p id="386d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后当我们添加输入时，我们必须像这样添加:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="5272" class="kv kw iq kr b gy kx ky l kz la">&lt;input<br/> type="text"<br/> name="title"<br/> placeholder="Title"<br/> value={title || ""}<br/> onChange={handleTitleChange}<br/> isInvalid={!title}<br/>/&gt;</span></pre><p id="df28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将<code class="fe lb lc ld kr b">handleTitleChange</code>函数传递给<code class="fe lb lc ld kr b">onChange</code>道具，这样<code class="fe lb lc ld kr b">title</code>就会被设置。然后一旦它被设置，那么<code class="fe lb lc ld kr b">value</code> prop将被填充，用户将能够看到他们输入的值。</p><p id="e190" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将制作一个简单的日历应用程序，用户可以在其中拖动日期范围并添加日历条目。用户还可以点击现有的日历条目并编辑该条目。也可以删除现有条目。用于添加和编辑日历条目的表单将有一个日期和时间选择器来选择日期和时间。</p><p id="e6eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">React有许多日历小部件，我们可以添加到我们的应用程序中。其中之一是反应大日历。它有很多特点。它有一个月，一周，和每日日历。此外，您可以通过“后退”和“前进”按钮轻松导航到今天或任何其他日期。您也可以拖过日历中的日期范围来选择日期范围。有了它，你可以对日期做任何你想做的操作。</p><p id="369d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将把后端的数据保存在一个JSON文件中。</p><p id="4941" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用React来构建我们的应用程序。首先，我们运行:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="7245" class="kv kw iq kr b gy kx ky l kz la">npx create-react-app calendar-app</span></pre><p id="d13e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建项目。</p><p id="0ab5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们必须安装几个软件包。我们将使用Axios处理对后端的HTTP请求，使用Bootstrap处理样式，使用MobX处理简单的状态管理，使用React Big Calendar处理日历组件，使用React Datepicker处理表单中的日期和时间选择器，使用React Router处理路由。</p><p id="8c18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装它们，我们运行:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="f562" class="kv kw iq kr b gy kx ky l kz la">npm i axios bootstrap mobx mobx-react moment react-big-calendar react-bootstrap react-datepicker react-router-dom</span></pre><p id="dbe2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装好所有的包后，我们就可以开始写代码了。首先，我们用以下代码替换<code class="fe lb lc ld kr b">App.js</code>中的现有代码:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="3299" class="kv kw iq kr b gy kx ky l kz la">import React from "react";<br/>import { Router, Route } from "react-router-dom";<br/>import HomePage from "./HomePage";<br/>import { createBrowserHistory as createHistory } from "history";<br/>import Navbar from "react-bootstrap/Navbar";<br/>import Nav from "react-bootstrap/Nav";<br/>import "./App.css";<br/>import "react-big-calendar/lib/css/react-big-calendar.css";<br/>import "react-datepicker/dist/react-datepicker.css";<br/>const history = createHistory();</span><span id="6569" class="kv kw iq kr b gy le ky l kz la">function App({ calendarStore }) {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;Router history={history}&gt;<br/>        &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>          &lt;Navbar.Brand href="#home"&gt;Calendar App&lt;/Navbar.Brand&gt;<br/>          &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>          &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>            &lt;Nav className="mr-auto"&gt;<br/>              &lt;Nav.Link href="/"&gt;Home&lt;/Nav.Link&gt;<br/>            &lt;/Nav&gt;<br/>          &lt;/Navbar.Collapse&gt;<br/>        &lt;/Navbar&gt;<br/>        &lt;Route<br/>          path="/"<br/>          exact<br/>          component={props =&gt; (<br/>            &lt;HomePage {...props} calendarStore={calendarStore} /&gt;<br/>          )}<br/>        /&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="3d9f" class="kv kw iq kr b gy le ky l kz la">export default App;</span></pre><p id="39b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在这里添加了React Bootstrap顶部栏，并带有一个到主页的链接。此外，我们在这里添加了主页的路由，并传入了MobX <code class="fe lb lc ld kr b">calendarStore</code>。</p><p id="1ee0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我们在这里导入日期选择器和日历的样式，这样我们就可以在整个应用程序中使用它们。</p><p id="ee78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe lb lc ld kr b">App.css</code>中，将现有代码替换为:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="05cc" class="kv kw iq kr b gy kx ky l kz la">.page {<br/>  padding: 20px;<br/>}</span><span id="d5af" class="kv kw iq kr b gy le ky l kz la">.form-control.react-datepicker-ignore-onclickoutside,<br/>.react-datepicker-wrapper {<br/>  width: 465px !important;<br/>}</span><span id="37cd" class="kv kw iq kr b gy le ky l kz la">.react-datepicker__current-month,<br/>.react-datepicker-time__header,<br/>.react-datepicker-year-header,<br/>.react-datepicker__day-name,<br/>.react-datepicker__day,<br/>[class^="react-datepicker__day--*"],<br/>.react-datepicker__time-list-item {<br/>  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans",<br/>    "Droid Sans", "Helvetica Neue", sans-serif;<br/>}</span></pre><p id="af1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要为页面添加一些填充，请更改日期选择器输入的宽度并更改日期选择器的字体。</p><p id="a42c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在<code class="fe lb lc ld kr b">src</code>文件夹中创建一个名为<code class="fe lb lc ld kr b">CalendarForm.js</code>的文件，并添加:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="43c3" class="kv kw iq kr b gy kx ky l kz la">import React from "react";<br/>import Form from "react-bootstrap/Form";<br/>import Col from "react-bootstrap/Col";<br/>import DatePicker from "react-datepicker";<br/>import Button from "react-bootstrap/Button";<br/>import {<br/>  addCalendar,<br/>  editCalendar,<br/>  getCalendar,<br/>  deleteCalendar<br/>} from "./requests";<br/>import { observer } from "mobx-react";</span><span id="5569" class="kv kw iq kr b gy le ky l kz la">const buttonStyle = { marginRight: 10 };</span><span id="9966" class="kv kw iq kr b gy le ky l kz la">function CalendarForm({ calendarStore, calendarEvent, onCancel, edit }) {<br/>  const [start, setStart] = React.useState(null);<br/>  const [end, setEnd] = React.useState(null);<br/>  const [title, setTitle] = React.useState("");<br/>  const [id, setId] = React.useState(null);</span><span id="ccf3" class="kv kw iq kr b gy le ky l kz la">React.useEffect(() =&gt; {<br/>    setTitle(calendarEvent.title);<br/>    setStart(calendarEvent.start);<br/>    setEnd(calendarEvent.end);<br/>    setId(calendarEvent.id);<br/>  }, [<br/>    calendarEvent.title,<br/>    calendarEvent.start,<br/>    calendarEvent.end,<br/>    calendarEvent.id<br/>  ]);</span><span id="7b38" class="kv kw iq kr b gy le ky l kz la">const handleSubmit = async ev =&gt; {<br/>    ev.preventDefault();<br/>    if (!title || !start || !end) {<br/>      return;<br/>    }</span><span id="7b33" class="kv kw iq kr b gy le ky l kz la">if (+start &gt; +end) {<br/>      alert("Start date must be earlier than end date");<br/>      return;<br/>    }<br/>    const data = { id, title, start, end };<br/>    if (!edit) {<br/>      await addCalendar(data);<br/>    } else {<br/>      await editCalendar(data);<br/>    }<br/>    const response = await getCalendar();<br/>    const evs = response.data.map(d =&gt; {<br/>      return {<br/>        ...d,<br/>        start: new Date(d.start),<br/>        end: new Date(d.end)<br/>      };<br/>    });<br/>    calendarStore.setCalendarEvents(evs);<br/>    onCancel();<br/>  };<br/>  const handleStartChange = date =&gt; setStart(date);<br/>  const handleEndChange = date =&gt; setEnd(date);<br/>  const handleTitleChange = ev =&gt; setTitle(ev.target.value);</span><span id="636a" class="kv kw iq kr b gy le ky l kz la">const deleteCalendarEvent = async () =&gt; {<br/>    await deleteCalendar(calendarEvent.id);<br/>    const response = await getCalendar();<br/>    const evs = response.data.map(d =&gt; {<br/>      return {<br/>        ...d,<br/>        start: new Date(d.start),<br/>        end: new Date(d.end)<br/>      };<br/>    });<br/>    calendarStore.setCalendarEvents(evs);<br/>    onCancel();<br/>  };</span><span id="7e91" class="kv kw iq kr b gy le ky l kz la">return (<br/>    &lt;Form noValidate onSubmit={handleSubmit}&gt;<br/>      &lt;Form.Row&gt;<br/>        &lt;Form.Group as={Col} md="12" controlId="title"&gt;<br/>          &lt;Form.Label&gt;Title&lt;/Form.Label&gt;<br/>          &lt;Form.Control<br/>            type="text"<br/>            name="title"<br/>            placeholder="Title"<br/>            value={title || ""}<br/>            onChange={handleTitleChange}<br/>            isInvalid={!title}<br/>          /&gt;<br/>          &lt;Form.Control.Feedback type="invalid"&gt;{!title}&lt;/Form.Control.Feedback&gt;<br/>        &lt;/Form.Group&gt;<br/>      &lt;/Form.Row&gt;</span><span id="1475" class="kv kw iq kr b gy le ky l kz la">&lt;Form.Row&gt;<br/>        &lt;Form.Group as={Col} md="12" controlId="start"&gt;<br/>          &lt;Form.Label&gt;Start&lt;/Form.Label&gt;<br/>          &lt;br /&gt;<br/>          &lt;DatePicker<br/>            showTimeSelect<br/>            className="form-control"<br/>            selected={start}<br/>            onChange={handleStartChange}<br/>          /&gt;<br/>        &lt;/Form.Group&gt;<br/>      &lt;/Form.Row&gt;</span><span id="d7c8" class="kv kw iq kr b gy le ky l kz la">&lt;Form.Row&gt;<br/>        &lt;Form.Group as={Col} md="12" controlId="end"&gt;<br/>          &lt;Form.Label&gt;End&lt;/Form.Label&gt;<br/>          &lt;br /&gt;<br/>          &lt;DatePicker<br/>            showTimeSelect<br/>            className="form-control"<br/>            selected={end}<br/>            onChange={handleEndChange}<br/>          /&gt;<br/>        &lt;/Form.Group&gt;<br/>      &lt;/Form.Row&gt;<br/>      &lt;Button type="submit" style={buttonStyle}&gt;<br/>        Save<br/>      &lt;/Button&gt;<br/>      &lt;Button type="button" style={buttonStyle} onClick={deleteCalendarEvent}&gt;<br/>        Delete<br/>      &lt;/Button&gt;<br/>      &lt;Button type="button" onClick={onCancel}&gt;<br/>        Cancel<br/>      &lt;/Button&gt;<br/>    &lt;/Form&gt;<br/>  );<br/>}</span><span id="3bf1" class="kv kw iq kr b gy le ky l kz la">export default observer(CalendarForm);</span></pre><p id="961b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是用于添加和编辑日历条目的表单。我们在这里通过添加<code class="fe lb lc ld kr b">Form</code>组件来添加反应引导表单。<code class="fe lb lc ld kr b">Form.Control</code>也来自同一个图书馆。我们将其用于<code class="fe lb lc ld kr b">title</code>文本输入。</p><p id="bb81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其他2个字段是开始和结束日期。我们在这里使用反应日期选择器让用户选择日历条目的开始和结束日期。此外，我们启用时间选择器让用户选择时间。</p><p id="a73a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个字段都有更改处理程序来更新状态中的值，以便用户可以看到他们输入的内容，并在以后提交数据。变更处理程序为<code class="fe lb lc ld kr b">handleStartChange</code>、<code class="fe lb lc ld kr b">handleEndChange</code>和<code class="fe lb lc ld kr b">handleTitleChange</code>。我们用<code class="fe lb lc ld kr b">useState</code>钩子生成的设置函数来设置状态。</p><p id="6a76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用<code class="fe lb lc ld kr b">useEffect</code>回调将<code class="fe lb lc ld kr b">calendarEvent</code>中的字段设置为状态。我们在<code class="fe lb lc ld kr b">useEffect</code>函数的第二个参数中把所有我们想设置的字段传递给数组，这样只要<code class="fe lb lc ld kr b">calendarEvent</code> prop的最新值传入，状态就会被更新。</p><p id="b151" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe lb lc ld kr b">handleSubmit</code>功能中，点击表单保存按钮时调用。我们必须调用<code class="fe lb lc ld kr b">ev.preventDefault</code>以便使用Ajax提交表单数据。</p><p id="0469" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果数据验证通过，我们将提交数据并获取最新数据，并将它们存储在我们的<code class="fe lb lc ld kr b">calendarStore</code> MobX存储中。</p><p id="b639" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将<code class="fe lb lc ld kr b">observer</code>包裹在<code class="fe lb lc ld kr b">CalendarForm</code>组件之外，这样我们总是可以从<code class="fe lb lc ld kr b">calendarStore</code>获得最新的值。</p><p id="dbe3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们创建我们的主页。在<code class="fe lb lc ld kr b">src</code>文件夹中创建<code class="fe lb lc ld kr b">HomePage.js</code>文件并添加:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="8265" class="kv kw iq kr b gy kx ky l kz la">import React from "react";<br/>import { Calendar, momentLocalizer } from "react-big-calendar";<br/>import moment from "moment";<br/>import Modal from "react-bootstrap/Modal";<br/>import CalendarForm from "./CalendarForm";<br/>import { observer } from "mobx-react";<br/>import { getCalendar } from "./requests";</span><span id="68ef" class="kv kw iq kr b gy le ky l kz la">const localizer = momentLocalizer(moment);</span><span id="92ff" class="kv kw iq kr b gy le ky l kz la">function HomePage({ calendarStore }) {<br/>  const [showAddModal, setShowAddModal] = React.useState(false);<br/>  const [showEditModal, setShowEditModal] = React.useState(false);<br/>  const [calendarEvent, setCalendarEvent] = React.useState({});<br/>  const [initialized, setInitialized] = React.useState(false);</span><span id="c4fa" class="kv kw iq kr b gy le ky l kz la">const hideModals = () =&gt; {<br/>    setShowAddModal(false);<br/>    setShowEditModal(false);<br/>  };</span><span id="c8c3" class="kv kw iq kr b gy le ky l kz la">const getCalendarEvents = async () =&gt; {<br/>    const response = await getCalendar();<br/>    const evs = response.data.map(d =&gt; {<br/>      return {<br/>        ...d,<br/>        start: new Date(d.start),<br/>        end: new Date(d.end)<br/>      };<br/>    });<br/>    calendarStore.setCalendarEvents(evs);<br/>    setInitialized(true);<br/>  };</span><span id="c37e" class="kv kw iq kr b gy le ky l kz la">const handleSelect = (event, e) =&gt; {<br/>    const { start, end } = event;<br/>    const data = { title: "", start, end, allDay: false };<br/>    setShowAddModal(true);<br/>    setShowEditModal(false);<br/>    setCalendarEvent(data);<br/>  };</span><span id="103e" class="kv kw iq kr b gy le ky l kz la">const handleSelectEvent = (event, e) =&gt; {<br/>    setShowAddModal(false);<br/>    setShowEditModal(true);<br/>    let { id, title, start, end, allDay } = event;<br/>    start = new Date(start);<br/>    end = new Date(end);<br/>    const data = { id, title, start, end, allDay };<br/>    setCalendarEvent(data);<br/>  };</span><span id="1bf9" class="kv kw iq kr b gy le ky l kz la">React.useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      getCalendarEvents();<br/>    }<br/>  });</span><span id="32aa" class="kv kw iq kr b gy le ky l kz la">return (<br/>    &lt;div className="page"&gt;<br/>      &lt;Modal show={showAddModal} onHide={hideModals}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Add Calendar Event&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;</span><span id="c0ce" class="kv kw iq kr b gy le ky l kz la">&lt;Modal.Body&gt;<br/>          &lt;CalendarForm<br/>            calendarStore={calendarStore}<br/>            calendarEvent={calendarEvent}<br/>            onCancel={hideModals.bind(this)}<br/>            edit={false}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;</span><span id="1bf0" class="kv kw iq kr b gy le ky l kz la">&lt;Modal show={showEditModal} onHide={hideModals}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Edit Calendar Event&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;</span><span id="3432" class="kv kw iq kr b gy le ky l kz la">&lt;Modal.Body&gt;<br/>          &lt;CalendarForm<br/>            calendarStore={calendarStore}<br/>            calendarEvent={calendarEvent}<br/>            onCancel={hideModals.bind(this)}<br/>            edit={true}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;<br/>      &lt;Calendar<br/>        localizer={localizer}<br/>        events={calendarStore.calendarEvents}<br/>        startAccessor="start"<br/>        endAccessor="end"<br/>        selectable={true}<br/>        style={{ height: "70vh" }}<br/>        onSelectSlot={handleSelect}<br/>        onSelectEvent={handleSelectEvent}<br/>      /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="1333" class="kv kw iq kr b gy le ky l kz la">export default observer(HomePage);</span></pre><p id="c07f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们获取日历条目，并在这里的日历中填充它们。从后端检索条目，然后保存到存储中。在<code class="fe lb lc ld kr b">useEffect</code>回调中，我们设置在页面加载时获取项目。我们只在<code class="fe lb lc ld kr b">initialized</code>为假时才这样做，所以我们不会在每次页面渲染时都重新加载数据。</p><p id="79eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了打开添加日历条目的模式，我们用处理程序设置了<code class="fe lb lc ld kr b">onSelectSlot</code>属性，这样我们就可以调用<code class="fe lb lc ld kr b">setShowAddModal</code>和<code class="fe lb lc ld kr b">setCalendarEvent</code>来设置打开模式，并在打开添加日历事件模式之前设置日期。</p><p id="c804" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似地，我们用<code class="fe lb lc ld kr b">handleSelectEvent</code>处理函数设置<code class="fe lb lc ld kr b">onSelectEvent</code>模态，以便打开编辑模态并设置现有条目的日历事件数据。</p><p id="1a82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个模态内部都有<code class="fe lb lc ld kr b">CalendarForm</code>组件。我们将关闭模态的函数传入表单，这样我们就可以从表单中关闭它们。此外，我们传入<code class="fe lb lc ld kr b">calendarStore</code>和<code class="fe lb lc ld kr b">calendarEvent</code>，以便它们可以在<code class="fe lb lc ld kr b">CalendarForm</code>中被操纵。</p><p id="5a45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将<code class="fe lb lc ld kr b">observer</code>包装在<code class="fe lb lc ld kr b">CalendarForm</code>组件之外，这样我们总是从<code class="fe lb lc ld kr b">calendarStore</code>获得最新的值。</p><p id="b1ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe lb lc ld kr b">index.js</code>中，我们将现有代码替换为:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="6d2c" class="kv kw iq kr b gy kx ky l kz la">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import "./index.css";<br/>import App from "./App";<br/>import * as serviceWorker from "./serviceWorker";<br/>import { CalendarStore } from "./store";<br/>const calendarStore = new CalendarStore();</span><span id="bfa3" class="kv kw iq kr b gy le ky l kz la">ReactDOM.render(<br/>  &lt;App calendarStore={calendarStore} /&gt;,<br/>  document.getElementById("root")<br/>);</span><span id="a305" class="kv kw iq kr b gy le ky l kz la">// If you want your app to work offline and load faster, you can change<br/>// unregister() to register() below. Note this comes with some pitfalls.<br/>// Learn more about service workers: <a class="ae kl" href="https://bit.ly/CRA-PWA" rel="noopener ugc nofollow" target="_blank">https://bit.ly/CRA-PWA</a><br/>serviceWorker.unregister();</span></pre><p id="451b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样我们就可以将MobX <code class="fe lb lc ld kr b">calendarStore</code>传入根<code class="fe lb lc ld kr b">App</code>组件。</p><p id="e778" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在<code class="fe lb lc ld kr b">src</code>文件夹中创建一个<code class="fe lb lc ld kr b">requests.js</code>文件，并添加:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="7973" class="kv kw iq kr b gy kx ky l kz la">const APIURL = "<a class="ae kl" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a>";<br/>const axios = require("axios");</span><span id="f172" class="kv kw iq kr b gy le ky l kz la">export const getCalendar = () =&gt; axios.get(`${APIURL}/calendar`);</span><span id="7aeb" class="kv kw iq kr b gy le ky l kz la">export const addCalendar = data =&gt; axios.post(`${APIURL}/calendar`, data);</span><span id="053d" class="kv kw iq kr b gy le ky l kz la">export const editCalendar = data =&gt;<br/>  axios.put(`${APIURL}/calendar/${data.id}`, data);</span><span id="2d06" class="kv kw iq kr b gy le ky l kz la">export const deleteCalendar = id =&gt; axios.delete(`${APIURL}/calendar/${id}`);</span></pre><p id="e712" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是进行HTTP调用来操作日历条目的函数。</p><p id="ec58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在<code class="fe lb lc ld kr b">src</code>文件夹中创建<code class="fe lb lc ld kr b">store.js</code>并添加:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a897" class="kv kw iq kr b gy kx ky l kz la">import { observable, action, decorate } from "mobx";</span><span id="d268" class="kv kw iq kr b gy le ky l kz la">class CalendarStore {<br/>  calendarEvents = [];</span><span id="45b8" class="kv kw iq kr b gy le ky l kz la">setCalendarEvents(calendarEvents) {<br/>    this.calendarEvents = calendarEvents;<br/>  }<br/>}</span><span id="e08f" class="kv kw iq kr b gy le ky l kz la">CalendarStore = decorate(CalendarStore, {<br/>  calendarEvents: observable,<br/>  setCalendarEvents: action<br/>});</span><span id="74d6" class="kv kw iq kr b gy le ky l kz la">export { CalendarStore };</span></pre><p id="e469" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">保存商店中的商品，供我们的所有组件访问。</p><p id="881d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe lb lc ld kr b">index.html</code>中，将现有代码替换为:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="f151" class="kv kw iq kr b gy kx ky l kz la">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;meta name="theme-color" content="#000000" /&gt;<br/>    &lt;meta<br/>      name="description"<br/>      content="Web site created using create-react-app"<br/>    /&gt;<br/>    &lt;link rel="apple-touch-icon" href="logo192.png" /&gt;<br/>    &lt;!--<br/>      manifest.json provides metadata used when your web app is installed on a<br/>      user's mobile device or desktop. See <a class="ae kl" href="https://developers.google.com/web/fundamentals/web-app-manifest/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/fundamentals/web-app-manifest/</a><br/>    --&gt;<br/>    &lt;link rel="manifest" href="%PUBLIC_URL%/manifest.json" /&gt;<br/>    &lt;!--<br/>      Notice the use of %PUBLIC_URL% in the tags above.<br/>      It will be replaced with the URL of the `public` folder during the build.<br/>      Only files inside the `public` folder can be referenced from the HTML.</span><span id="8c07" class="kv kw iq kr b gy le ky l kz la">Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will<br/>      work correctly both with client-side routing and a non-root public URL.<br/>      Learn how to configure a non-root public URL by running `npm run build`.<br/>    --&gt;<br/>    &lt;title&gt;Calendar App&lt;/title&gt;<br/>    &lt;link<br/>      rel="stylesheet"<br/>      href="<a class="ae kl" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"<br/>      crossorigin="anonymous"<br/>    /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;<br/>    &lt;div id="root"&gt;&lt;/div&gt;<br/>    &lt;!--<br/>      This HTML file is a template.<br/>      If you open it directly in the browser, you will see an empty page.</span><span id="862b" class="kv kw iq kr b gy le ky l kz la">You can add webfonts, meta tags, or analytics to this file.<br/>      The build step will place the bundled scripts into the &lt;body&gt; tag.</span><span id="850b" class="kv kw iq kr b gy le ky l kz la">To begin the development, run `npm start` or `yarn start`.<br/>      To create a production bundle, use `npm run build` or `yarn build`.<br/>    --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3994" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加引导CSS并重命名标题。</p><p id="ffa1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在所有的艰苦工作都完成了。我们所要做的就是使用位于https://github.com/typicode/json-server的JSON服务器NPM包作为我们的后端。</p><p id="b19e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过运行以下命令进行安装:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="e360" class="kv kw iq kr b gy kx ky l kz la">npm i -g json-server</span></pre><p id="c3bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后通过运行以下命令来运行它:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="446e" class="kv kw iq kr b gy kx ky l kz la">json-server --watch db.json</span></pre><p id="a145" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe lb lc ld kr b">db.json</code>中，将现有内容替换为:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="55bd" class="kv kw iq kr b gy kx ky l kz la">{<br/>  "calendar": []<br/>}</span></pre><p id="00ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们通过在应用程序的项目文件夹中运行<code class="fe lb lc ld kr b">npm start</code>来运行应用程序，当程序要求您在不同的端口中运行时，选择yes。</p><p id="e73c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，您应该会看到:</p><figure class="km kn ko kp gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/4cf5ab1ae276ecfd369d07fc46749681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVSwI8xu0V51j20BS3cVZQ.png"/></div></div></figure><figure class="km kn ko kp gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/12d227cd27921066586a8dade216e1c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J_MKWkKk1X22Wq36yl5BDQ.png"/></div></div></figure><figure class="km kn ko kp gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/70dffd4792c3250369f37ffbc8796b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dNxcYzzt1Vzb1d7ncYi3mg.png"/></div></div></figure><figure class="km kn ko kp gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/7757cb895a717de02294139e9972145a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-snucxNKbNL3ljR_s5Q_w.png"/></div></div></figure></div></div>    
</body>
</html>