<html>
<head>
<title>Rxjs Filtering Operators — Distinctness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rxjs过滤运算符—区分度</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/rxjs-filtering-operators-distinctness-fb4c78bc1dd?source=collection_archive---------2-----------------------#2020-02-27">https://javascript.plainenglish.io/rxjs-filtering-operators-distinctness-fb4c78bc1dd?source=collection_archive---------2-----------------------#2020-02-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0badfea634ea72f85ad6a9f41e751a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CZV_dnmjfRvVW9qK"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@kelarn?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kelly Arnold</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2cf5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Rxjs是一个用于进行反应式编程的库。创建操作符对于从各种数据源生成供观察者订阅的数据非常有用。</p><p id="31e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些过滤操作符，包括<code class="fe lb lc ld le b">distinct</code>、<code class="fe lb lc ld le b">distinctUntilChanged</code>和<code class="fe lb lc ld le b">distinctUntilKeyChanged</code>操作符。</p><h1 id="52f4" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">明显的</h1><p id="af7a" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">distinct</code>操作符发出来自源可观察的项目，这些项目与来自源的先前项目不同。</p><p id="dcff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它有两个可选参数。第一个是<code class="fe lb lc ld le b">keySelector</code>函数，它让我们选择想要检查哪个值是不同的。</p><p id="c9e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个是可选的<code class="fe lb lc ld le b">flushes</code>,用于清除操作者的内部哈希表。</p><p id="80b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个新的可观察对象，该对象发出不同的值。</p><p id="d48e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个简单的例子:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="7c89" class="mq lg iq le b gy mr ms l mt mu">import { of } from "rxjs";<br/>import { distinct } from "rxjs/operators";</span><span id="4616" class="mq lg iq le b gy mv ms l mt mu">of(3, 3, 3, 3, 3, 3, 35, 5, 7, 8, 4, 6, 3, 5, 2, 4, 2)<br/>  .pipe(distinct())<br/>  .subscribe(x =&gt; console.log(x));</span></pre><p id="3b58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有以下具有重复值的可观察值:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="0d36" class="mq lg iq le b gy mr ms l mt mu">of(3, 3, 3, 3, 3, 3, 35, 5, 7, 8, 4, 6, 3, 5, 2, 4, 2)</span></pre><p id="700a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来自它的值被<code class="fe lb lc ld le b">pipe</code> d传递给<code class="fe lb lc ld le b">distinct()</code>操作符以过滤掉重复的值。</p><p id="3599" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="23b7" class="mq lg iq le b gy mr ms l mt mu">3<br/>35<br/>5<br/>7<br/>8<br/>4<br/>6<br/>2</span></pre><p id="cac2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从<code class="fe lb lc ld le b">console.log</code>开始。</p><p id="5cca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以检查某个条目的某个键是否不同，如下所示:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="ffe1" class="mq lg iq le b gy mr ms l mt mu">import { of } from "rxjs";<br/>import { distinct } from "rxjs/operators";</span><span id="5c9b" class="mq lg iq le b gy mv ms l mt mu">const people = [<br/>  { age: 4, name: "Joe" },<br/>  { age: 7, name: "Jane" },<br/>  { age: 5, name: "Jane" }<br/>];</span><span id="e64c" class="mq lg iq le b gy mv ms l mt mu">of(...people)<br/>  .pipe(distinct(p =&gt; p.name))<br/>  .subscribe(x =&gt; console.log(x));</span></pre><p id="763b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的代码将<code class="fe lb lc ld le b">people</code>数组作为<code class="fe lb lc ld le b">of</code>操作符的参数展开，该操作符发出<code class="fe lb lc ld le b">people</code>数组中的对象。然后，发出的值被<code class="fe lb lc ld le b">pipe</code> d到<code class="fe lb lc ld le b">distinct</code>操作符中，该操作符选择<code class="fe lb lc ld le b">name</code>属性来检查清晰度。</p><p id="b3bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">则仅发射具有不同<code class="fe lb lc ld le b">name</code>值的对象。</p><p id="4ad9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们得到:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="781a" class="mq lg iq le b gy mr ms l mt mu">{age: 4, name: "Joe"}<br/>{age: 7, name: "Jane"}</span></pre><p id="e03f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为可观察对象。</p><h1 id="a895" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">distinctUntilChanged</h1><p id="dd16" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">distinctUntilChanged</code>发射从源发出的所有可观察到的项目，这些项目与来自源的前一个项目相比是不同的。</p><p id="9d36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它有两个可选参数，这是一个<code class="fe lb lc ld le b">compare</code>函数，用于测试一个项目是否与前一个项目不同。第二个参数是<code class="fe lb lc ld le b">keySelector</code>函数，用于返回我们想要检查的键值。</p><p id="18d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个简单的例子如下:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="3a29" class="mq lg iq le b gy mr ms l mt mu">import { of } from "rxjs";<br/>import { distinctUntilChanged } from "rxjs/operators";</span><span id="ee6a" class="mq lg iq le b gy mv ms l mt mu">of(1, 1, 5, 5, 6, 7, 8, 8, 8, 8, 9)<br/>  .pipe(distinctUntilChanged())<br/>  .subscribe(x =&gt; console.log(x));</span></pre><p id="a32e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从<code class="fe lb lc ld le b">of(1, 1, 5, 5, 6, 7, 8, 8, 8, 8, 9)</code>到<code class="fe lb lc ld le b">distinctUntilChanged</code>操作器的值是<code class="fe lb lc ld le b">pipe</code> d，之前发出的值与当前发出的值进行核对，看它们是否相同。</p><p id="43c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="0044" class="mq lg iq le b gy mr ms l mt mu">1<br/>5<br/>6<br/>7<br/>8<br/>9</span></pre><p id="d3dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为发出的值不同于之前发出的值。</p><p id="d922" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于发射对象的可观察对象，我们可以通过向<code class="fe lb lc ld le b">distinctUntilChanged</code>操作符传递一个函数来检查属性值是否相同，如下所示:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="4d11" class="mq lg iq le b gy mr ms l mt mu">import { of } from "rxjs";<br/>import { distinctUntilChanged } from "rxjs/operators";<br/>const people = [<br/>  { age: 4, name: "Joe" },<br/>  { age: 7, name: "Jane" },<br/>  { age: 5, name: "Jane" }<br/>];<br/>of(...people)<br/>  .pipe(distinctUntilChanged((p, q) =&gt; p.name === q.name))<br/>  .subscribe(x =&gt; console.log(x));</span></pre><p id="8e9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一部分和最后一部分的工作方式与前面的示例类似。不同的是，现在我们有了<code class="fe lb lc ld le b">(p, q) =&gt; p.name === q.name</code>函数来检查先前发射的对象的<code class="fe lb lc ld le b">name</code>值是否与当前发射的相同。</p><p id="0f33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="8ab2" class="mq lg iq le b gy mr ms l mt mu">{age: 4, name: "Joe"}<br/>{age: 7, name: "Jane"}</span></pre><p id="61ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为<code class="fe lb lc ld le b">console.log</code>的输出。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/2512621d003bedb6725d35d83e55aa6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*06HQlTBWTZySMk18"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@fdelgado?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Francisco Delgado</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="ef71" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">distinctUntilKeyChanged</h1><p id="f07c" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">distinctUntilKeyChanged</code>返回一个发出源可观察值的可观察值，该值通过与先前从源发出的对象的键进行比较来区分。</p><p id="02a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着，如果给定键的值不同于先前发出的对象键的值，将会发出一个项。</p><p id="1a26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它最多需要两个参数。第一个是<code class="fe lb lc ld le b">key</code>，它是一个带有object属性的字符串，用于查找每一项。</p><p id="35d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个是可选的<code class="fe lb lc ld le b">compare</code>函数，调用它来测试一个项目是否不同于之前从源Observable发出的项目。</p><p id="ef8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个可观察对象，该可观察对象从源可观察对象中发出一个项目，该项目具有与先前从源发出的项目不同的属性值。</p><p id="9aa8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以重写前面的例子:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="bebb" class="mq lg iq le b gy mr ms l mt mu">import { of } from "rxjs";<br/>import { distinctUntilChanged } from "rxjs/operators";<br/>const people = [<br/>  { age: 4, name: "Joe" },<br/>  { age: 7, name: "Jane" },<br/>  { age: 5, name: "Jane" }<br/>];<br/>of(...people)<br/>  .pipe(distinctUntilChanged((p, q) =&gt; p.name === q.name))<br/>  .subscribe(x =&gt; console.log(x));</span></pre><p id="0d33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">变成:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="02ce" class="mq lg iq le b gy mr ms l mt mu">import { of } from "rxjs";<br/>import { distinctUntilKeyChanged } from "rxjs/operators";<br/>const people = [<br/>  { age: 4, name: "Joe" },<br/>  { age: 7, name: "Jane" },<br/>  { age: 5, name: "Jane" }<br/>];<br/>of(...people)<br/>  .pipe(distinctUntilKeyChanged("name"))<br/>  .subscribe(x =&gt; console.log(x));</span></pre><p id="294c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们应该得到和以前一样的结果。我们所做的只是改变:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="4015" class="mq lg iq le b gy mr ms l mt mu">distinctUntilChanged((p, q) =&gt; p.name === q.name)</span></pre><p id="925e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">收件人:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="aa70" class="mq lg iq le b gy mr ms l mt mu">distinctUntilKeyChanged("name")</span></pre><p id="8ae8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe lb lc ld le b">distinct</code>操作符，通过比较对象的原始值或属性值，获得从可观察源发出的不同值。</p><p id="f48c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">distinctUntilChanged</code>和<code class="fe lb lc ld le b">distinctUntilKeyChanged</code>让我们从一个源可观测物发出的项目不同于先前由源可观测物发出的项目。同样，它可以通过对象的原始值或属性值进行比较。</p></div></div>    
</body>
</html>