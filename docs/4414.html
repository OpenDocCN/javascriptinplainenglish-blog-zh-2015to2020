<html>
<head>
<title>Node.js | A Light Intro to Events, Streams, Process, and Standard I/O (STDIO)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js |对事件、流、流程和标准I/O (STDIO)的简单介绍</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-js-a-light-intro-to-events-streams-process-and-standard-i-o-stdio-c747966380c5?source=collection_archive---------4-----------------------#2020-12-09">https://javascript.plainenglish.io/node-js-a-light-intro-to-events-streams-process-and-standard-i-o-stdio-c747966380c5?source=collection_archive---------4-----------------------#2020-12-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0c72b2e4fa34abae7e6e9cacac23405b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fm5oWIrN7vPhRr9y"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@altumcode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">AltumCode</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3e7e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">本文是对一些Node.js基础知识的简单介绍。打开一个类似Unix的操作系统，使用命令“node yourFile.js”运行代码，感觉很受鼓舞。</p><p id="3391" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将介绍:<br/> -流程对象<br/> -事件<br/> -流和标准输入输出</p><h1 id="9cd2" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">过程对象</h1><p id="d661" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">什么是过程？进程是处理器正在处理的程序的实例。一个过程有许多属性。Node.js引入了process对象来揭示流程属性。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="846b" class="mk kz in mg b gy ml mm l mn mo">//Here we count 'keys' of the process object.<br/>"use strict";  <br/>console.log(Object.keys(process).length); //68</span></pre><p id="c10c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如您所见，process对象的这个实例有68个属性。</p><h1 id="d762" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">输出:</strong></h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="a506" class="mk kz in mg b gy ml mm l mn mo">68</span></pre><p id="df3f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如下所示，我们可以检查进程ID和进程内存使用情况。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="62b8" class="mk kz in mg b gy ml mm l mn mo">"use strict";<br/>console.log(process.pid);  <br/>console.table(process.memoryUsage());</span></pre><h1 id="d943" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="bc17" class="mk kz in mg b gy ml mm l mn mo">10379<br/>┌───────────┬──────────┐<br/>│  (index)  │  Values  │<br/>├───────────┼──────────┤<br/>│    rss    │ 31129600 │<br/>│ heapTotal │ 6537216  │<br/>│ heapUsed  │ 3988936  │<br/>│ external  │   8272   │<br/>└───────────┴──────────┘</span></pre><h1 id="1653" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">事件</h1><p id="c17f" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">Node.js流程对象也是一个EventEmitter实例。这意味着它可以使用“on”方法侦听事件，并且可以使用“emit”方法发出事件。</p><div class="mp mq gp gr mr ms"><a href="https://nodejs.org/dist/latest-v14.x/docs/api/events.html#events_class_eventemitter" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">Node.js v15.3.0文档</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">编辑描述</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">nodejs.org</p></div></div></div></a></div><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="c64f" class="mk kz in mg b gy ml mm l mn mo">"use strict";<br/>// Here we create an event with 'hello' namespace<br/>  <br/>process.on('hello', () =&gt; console.log('hello'))</span><span id="84e2" class="mk kz in mg b gy nb mm l mn mo">process.emit('hello')</span></pre><h1 id="c3cc" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="62b1" class="mk kz in mg b gy ml mm l mn mo">hello</span></pre><p id="0ce4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当一个进程退出时，它发出一个“退出”事件。并将退出代码传递给事件侦听器的回调函数。<br/> <br/>回调函数定义中的任何同步代码都会被执行。异步代码不会。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="001c" class="mk kz in mg b gy ml mm l mn mo">"use strict";<br/>// The process object is listening for an "exit" event<br/>  <br/>process.on('exit', (code) =&gt; {<br/>  setTimeout(() =&gt; console.log('This wont be logged'))<br/>  console.log('This will be logged')<br/>  console.log(code); // exit code <br/>});</span></pre><p id="af63" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">退出代码0表示该过程成功完成。</strong></p><h1 id="7dae" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="a464" class="mk kz in mg b gy ml mm l mn mo"><br/><br/>This will be logged<br/>0<br/><br/>  </span></pre><p id="48f7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们看看当我们抛出一个错误时会发生什么。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="04a0" class="mk kz in mg b gy ml mm l mn mo"><br/>"use strict";<br/>process.on('exit', (code) =&gt; {<br/>  setTimeout(() =&gt; console.log('This wont be logged'))<br/>  console.log('This will be logged')<br/>  console.log(code); // exit code    <br/>});</span><span id="e293" class="mk kz in mg b gy nb mm l mn mo">throw new Error();</span></pre><p id="6e76" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">退出代码1表示进程因出错而退出。</strong></p><h1 id="0500" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="2ca1" class="mk kz in mg b gy ml mm l mn mo"><br/>This will be logged<br/>1<br/>/home/ec2-user/environment/process.js:9<br/>throw new Error();<br/>^Error<br/>    at Object.&lt;anonymous&gt; (/home/ec2-user/environment/process.js:9:7)</span></pre><p id="39e9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们还可以使用“events”模块和“event emitter”类创建一些普通的事件发射器实例。许多节点对象(包括流、HTTP请求、响应)都继承自EventEmitter。</p><p id="0e9d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们看一个简单的事件实例。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="21f8" class="mk kz in mg b gy ml mm l mn mo"><br/>"use strict";<br/>const EventEmitter = require('events')</span><span id="e030" class="mk kz in mg b gy nb mm l mn mo">//Initialize an event to myEvent</span><span id="72a2" class="mk kz in mg b gy nb mm l mn mo">const myEvent = new EventEmitter()</span><span id="53dd" class="mk kz in mg b gy nb mm l mn mo">// setup a listener for an event</span><span id="a233" class="mk kz in mg b gy nb mm l mn mo">myEvent.on('hello world', () =&gt; console.log('hello world'))</span><span id="79a6" class="mk kz in mg b gy nb mm l mn mo">// emit events</span><span id="bba0" class="mk kz in mg b gy nb mm l mn mo">myEvent.emit('hello world');<br/>myEvent.emit('hello world');<br/>myEvent.emit('hello world');<br/></span></pre><h1 id="ff88" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="50a1" class="mk kz in mg b gy ml mm l mn mo"><br/>hello world<br/>hello world<br/>hello world<br/></span></pre><h1 id="368a" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">流和标准IO(标准IO)</h1><div class="mp mq gp gr mr ms"><a href="https://en.wikipedia.org/wiki/Standard_streams" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">标准流</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">在计算机程序设计中，标准流是计算机之间互连的输入和输出通信通道。</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">en.wikipedia.org</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh jt ms"/></div></div></a></div><blockquote class="ni nj nk"><p id="a1ea" class="ka kb nl kc b kd ke kf kg kh ki kj kk nm km kn ko nn kq kr ks no ku kv kw kx ig bi translated">在计算机程序设计中，当计算机程序开始执行时，标准流是计算机程序与其环境之间互连的输入和输出通信通道。三个输入/输出(I/O)连接称为标准输入(stdin)、标准输出(stdout)和标准错误(stderr)。</p></blockquote><p id="9024" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从上面的引用中，我们收集到该流程有三个流，一个流入stdin，两个流出stdout和stderr。</p><p id="3cbd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里我们使用管道方法，它类似于我们在shell中使用的` | `操作符。我们使用管道将process.stdin的输出发送到process.stdout。</p><p id="b802" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nl">默认情况下，stdin将通过键盘从命令行获取数据。stdout也将输出到命令行。继续输入一些数据:</em></p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="67d2" class="mk kz in mg b gy ml mm l mn mo">"use strict";<br/>process.stdin.pipe(process.stdout)</span></pre><p id="0301" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">类型:你好[return]你是谁[return]</p><h1 id="dbad" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="b729" class="mk kz in mg b gy ml mm l mn mo">hello<br/>hello<br/>Who are you<br/>Who are you</span></pre><p id="1f8d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们用管道将数据从stderr中导出。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="f577" class="mk kz in mg b gy ml mm l mn mo">"use strict";<br/>process.stdin.pipe(process.stderr)</span></pre><p id="fa43" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">类型:错误消息[return]错误消息* [return]</p><h1 id="7aa8" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="c036" class="mk kz in mg b gy ml mm l mn mo">error messafge<br/>error messafge<br/>error message*<br/>error message*</span></pre><p id="ae92" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当从Readable stream类继承的流接收数据时，它会发出一个事件“data”。</p><p id="ea44" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当一个流显示数据时，它通常默认显示为一个“缓冲区”实例。Node.js通过缓冲区来处理二进制数据。<br/> <br/>这意味着我们必须调用Buffer.prototype.toString()将数据转换成可工作的字符串。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="350f" class="mk kz in mg b gy ml mm l mn mo">"use strict";<br/>// The stdin stream is listening for 'data' using the on method</span><span id="9ad9" class="mk kz in mg b gy nb mm l mn mo">process.stdin.on('data', (data) =&gt; {<br/>  console.log("hello from the process Object")<br/>  console.log(data);<br/>  console.log(`Thanks for the data: ${data.toString().toUpperCase()}`);<br/>})</span></pre><p id="b4bd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第一行是我打的。所有其他输出行都是从数据事件创建的，该事件是在我通过键盘将数据写入stdin流时触发的。</p><h1 id="bfa9" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">输出:</h1><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="4b52" class="mk kz in mg b gy ml mm l mn mo">Hello, take this data // typed<br/>hello from the process Object<br/>&lt;Buffer 48 65 6c 6c 6f 2c 20 74 61 6b 65 20 74 68 69 73 20 64 61 74 61 0a&gt;<br/>Thanks for the data: HELLO, TAKE THIS DATA</span></pre><p id="6fb9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">还可以使用Streams模块创建流。</p><div class="mp mq gp gr mr ms"><a href="https://nodejs.org/dist/latest-v14.x/docs/api/stream.html" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd io gy z fp mx fr fs my fu fw im bi translated">Node.js v15.3.0文档</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">源代码:lib/stream.js流是一个抽象接口，用于处理Node.js中的流数据</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">nodejs.org</p></div></div></div></a></div><p id="0061" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">感谢阅读。下次见！</p><p id="ed37" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nl">更多内容尽在</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank">T5】plain English . ioT7】</a></p></div></div>    
</body>
</html>