<html>
<head>
<title>A Guide to CLIs with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">node . js CLIs指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-guide-to-clis-with-node-js-5f00b06abf7b?source=collection_archive---------24-----------------------#2020-10-26">https://javascript.plainenglish.io/a-guide-to-clis-with-node-js-5f00b06abf7b?source=collection_archive---------24-----------------------#2020-10-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3d05" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">构建完整命令行应用程序的一站式指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/74dc399ab63634e38f19dcb6de95d247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L1PlqwY7eOY2Y2MN"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@jakewalker?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jake Walker</a> on <a class="ae ks" href="https://unsplash.com/s/photos/computer-terminal?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0539" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有没有想过<code class="fe lp lq lr ls b">create-react-app .</code>、<code class="fe lp lq lr ls b">git init</code>或者简单的<code class="fe lp lq lr ls b">node -v</code>是如何运作的？这些是CLI或命令行界面。我很确定我们中的大多数人在生活的某个时候使用过CLI。即使是我们每天使用的命令，比如<code class="fe lp lq lr ls b">ls</code>或<code class="fe lp lq lr ls b">cd</code>也是CLI。</p><p id="2abc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">今天，我将向您展示如何使用我们在CLIs中找到的一些常见功能来设置一个非常简单的CLI。没什么太复杂的……让我们直接进入CLIs吧</p><h1 id="3b7c" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">什么是CLi</h1><p id="6edb" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">CLI是我们在终端运行的命令，用来做一些事情。如果你想要维基百科的定义🙄-</p><blockquote class="mq mr ms"><p id="576b" class="kt ku mt kv b kw kx jo ky kz la jr lb mu ld le lf mv lh li lj mw ll lm ln lo ig bi translated"><em class="in">命令行界面以文本行的形式处理对计算机程序的命令。处理接口的程序被称为命令行解释器或命令行处理器。操作系统在外壳中实现命令行界面，以交互方式访问操作系统功能或服务~ </em> <a class="ae ks" href="https://en.wikipedia.org/wiki/Command-line_interface" rel="noopener ugc nofollow" target="_blank"> <em class="in">维基百科</em> </a></p></blockquote><h1 id="8b1d" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">为什么需要CLi？</h1><p id="8590" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">在GUI(图形用户界面)的现代世界里，你可能会问为什么我们应该了解CLIs？它们不是在80年代使用的吗？我同意你的观点💯百分比。它们已经过时了，但是许多旧的应用程序仍然使用CLIs。默认情况下，与GUI应用程序相比，终端/命令提示符通常具有更多的权限和访问权限。UX允许100个权限运行一个应用程序是不好的。此外，人们把它当作开发者的“最好的朋友”(除了谷歌)。</p><h1 id="bbec" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">为什么要用节点构建CLI</h1><p id="9de4" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">主要优势是我们通过Node获得的超过100万个软件包的生态系统。使用这些，我们可以避免样板代码，并轻松实现功能。我们也可以跨项目重用代码/组件</p><h1 id="f596" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">开始使用CLi</h1><p id="b032" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">在做任何其他事情之前，我们需要创建一个<code class="fe lp lq lr ls b">package.json</code>。</p><ol class=""><li id="1ba2" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated">创建一个空文件夹</li><li id="2055" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated">运行<code class="fe lp lq lr ls b">npm init</code>并快速填写选项。否则，运行<code class="fe lp lq lr ls b">npm init -y</code>NPM自动填充选项。</li></ol><p id="f075" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们创建我们的JavaScript文件，我给它命名为<code class="fe lp lq lr ls b">cli.js</code>。这是一个常见的惯例，文件会立即告诉我们它的功能。我将在我们的文件中添加一个<code class="fe lp lq lr ls b">console.log('CLI')</code>，这样我们就可以知道一切都正常了。</p><p id="44c9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们需要更新<code class="fe lp lq lr ls b">package.json</code>来运行我们的CLI。将<code class="fe lp lq lr ls b">bin</code>属性添加到文件中。</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="09cf" class="np lu in ls b gy nq nr l ns nt">"bin": {<br/>  "hello-world": "cli.js"<br/>}</span></pre><p id="ab89" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">属性<code class="fe lp lq lr ls b">hello-world</code>是我们想要运行的命令名，<code class="fe lp lq lr ls b">cli.js</code>是文件名。如果您想要使用另一个名称或者您的文件存储在不同的路径中，请相应地更新它。</p><p id="3ec9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们安装我们的NPM软件包。在您的终端/命令提示符下运行以下命令-</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="127c" class="np lu in ls b gy nq nr l ns nt">npm i -g .</span></pre><p id="c6ff" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们过去都遇到过<code class="fe lp lq lr ls b">npm install</code>。我们添加了<code class="fe lp lq lr ls b">-g</code>标志，这样NPM就可以在全球范围内安装这个包。<code class="fe lp lq lr ls b">.</code>告诉NPM将软件包安装在这个文件夹中。NPM安装在<code class="fe lp lq lr ls b">package.json</code>的<code class="fe lp lq lr ls b">main</code>属性中的文件。如果您已经从<code class="fe lp lq lr ls b">cli.js</code>更改了文件名，请确保更新<code class="fe lp lq lr ls b">package.json</code>中的<code class="fe lp lq lr ls b">main</code>属性。</p><p id="22e6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们可以运行我们之前设置的命令名(<code class="fe lp lq lr ls b">hello-world</code>)，我们的CLI应该会启动。</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="bb0b" class="np lu in ls b gy nq nr l ns nt">hello</span></pre><p id="99d0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然而，我们得到以下错误-</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/1d08eb0a398f21e591f08d36788f55ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/0*OcWwzYNWnjcNosQR.png"/></div></figure><p id="25b6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个错误似乎告诉我们，编译器不能理解我们有JavaScript代码。所以，告诉编译器应该使用<code class="fe lp lq lr ls b">node</code>来运行我们的文件。为此，我们使用一个<a class="ae ks" href="https://en.wikipedia.org/wiki/Shebang_(Unix)#:~:text=In%20computing%2C%20a%20shebang%20is,bang%2C%20or%20hash%2Dpling." rel="noopener ugc nofollow" target="_blank"> shebang </a>。将以下代码添加到文件的顶部。</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="b63d" class="np lu in ls b gy nq nr l ns nt">#!/usr/bin/env node</span></pre><blockquote class="mq mr ms"><p id="8445" class="kt ku mt kv b kw kx jo ky kz la jr lb mu ld le lf mv lh li lj mw ll lm ln lo ig bi translated">确保这是正确的顶部，它才能正常工作</p></blockquote><p id="5fc8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是节点的路径。我们告诉*nix系统我们文件的解释器应该在指定的路径。在windows中，这一行将被忽略，因为它被指定为注释，但NPM将在软件包安装时选择它。</p><p id="081a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">好了，现在应该可以了。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/c7290b194c3ba141d4f54751490f3957.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/0*uIfB7p6cq3zxq-vs.png"/></div></figure><p id="5e3d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">除了记录一些数据，我们在CLI中实际上没有做任何事情。让我们从实现CLIs中的通用特性开始。</p><h1 id="5913" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">提示</h1><p id="5ea4" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">提示是问用户的问题。您可能在JavaScript中通过调用<code class="fe lp lq lr ls b">prompt()</code>函数遇到过它。我将使用<a class="ae ks" href="https://www.npmjs.com/package/prompts" rel="noopener ugc nofollow" target="_blank">提示</a>包。这个包简化了允许我们提示用户，并且只需要几行代码就可以得到响应。</p><p id="fcf2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过运行以下命令来安装它</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="2a53" class="np lu in ls b gy nq nr l ns nt">npm i prompts</span></pre><p id="b4bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来，将下面的代码添加到您的文件中，我们将一起浏览它。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div></figure><blockquote class="mq mr ms"><p id="3a34" class="kt ku mt kv b kw kx jo ky kz la jr lb mu ld le lf mv lh li lj mw ll lm ln lo ig bi translated">生命是被立即调用的函数表达式。它缩短了将函数表达式保存到变量并调用它的时间。</p></blockquote><p id="4d01" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们的基本CLI如下所示-</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/e3dd224c368d30580abdb710472e0611.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/0*EWvyqnSnN9j1rTS4.png"/></div></figure><p id="f441" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">很棒吧？我觉得终端看起来有点沉闷，让我们给它上色吧！</p><h1 id="9aff" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">用粉笔上色</h1><p id="e332" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">你知道终端是如何添加颜色的吗？ANSI转义码用于此(听起来像是监狱的代码)。如果你曾经尝试过阅读二进制文件，阅读ANSI是非常相似的。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/2c7e94161804708e938ed1eef8823c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*IYRIFpWqHkaiCwXg.gif"/></div></figure><p id="2feb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">谢天谢地，有一些软件包可以帮助我们解决这个问题。在本教程中，我将使用<a class="ae ks" href="https://www.npmjs.com/package/chalk" rel="noopener ugc nofollow" target="_blank">粉笔</a>。</p><p id="8775" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过运行安装它-</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="cab2" class="np lu in ls b gy nq nr l ns nt">npm i chalk</span></pre><p id="c408" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们从用以下内容替换原来的<code class="fe lp lq lr ls b">console.log()</code>开始:</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="5d5c" class="np lu in ls b gy nq nr l ns nt">console.log(chalk.bgCyan.white(`Hello ${response.value}`)); <br/>console.log(chalk.bgYellowBright.black(`Welcome to "Hello World with CLIs"`));</span></pre><p id="eb2b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如您所见，第一个<code class="fe lp lq lr ls b">log</code>链接了<code class="fe lp lq lr ls b">bgCyan</code>和<code class="fe lp lq lr ls b">white</code>方法。查看<a class="ae ks" href="https://github.com/chalk/chalk#readme" rel="noopener ugc nofollow" target="_blank">官方文件</a>了解更多信息。</p><p id="710d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这之后，我们的代码看起来像这样-</p><p id="c84e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是一个好的开始，现在让我们提高字体大小。我几乎什么都看不见。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/42def276bf839dc1be15696c892002d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/0*sgTlBX0IcxT1CEdU.jpg"/></div></figure><h1 id="7cf4" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">玩字体</h1><p id="4830" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">通过JavaScript改变字体是相当困难的，我花了很多时间寻找一个能做到这一点的包。谢天谢地，我明白了。我们将使用<a class="ae ks" href="https://www.npmjs.com/package/cfonts" rel="noopener ugc nofollow" target="_blank"> cfonts </a>套件。继续运行以下程序安装它-</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="e512" class="np lu in ls b gy nq nr l ns nt">npm i cfonts</span></pre><p id="1268" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先用以下内容替换我们之前的<code class="fe lp lq lr ls b">console.log</code></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="ccae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们的Hello World CLI看起来像这样-</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ob"><img src="../Images/54feeab4781bc6f76ef4bc59d954735b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MST01umBnuV_0Vrx.png"/></div></div></figure><p id="5be1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们添加一些基本的参数，比如<code class="fe lp lq lr ls b">-n</code>或<code class="fe lp lq lr ls b">--name</code>和<code class="fe lp lq lr ls b">-v</code>或<code class="fe lp lq lr ls b">--version</code>。我们将使用<a class="ae ks" href="https://www.npmjs.com/package/yargs" rel="noopener ugc nofollow" target="_blank"> yargs </a>套件来简化流程。如果您不想使用它，可以使用<code class="fe lp lq lr ls b">process.argv</code>访问参数。</p><p id="a2f0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先安装<code class="fe lp lq lr ls b">yargs</code>组件。</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="9421" class="np lu in ls b gy nq nr l ns nt">npm i yargs</span></pre><p id="9e64" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们把它导入我们的代码-</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="8b56" class="np lu in ls b gy nq nr l ns nt">const yargs = require('yargs/yargs');<br/>const { hideBin } = require('yargs/helpers');<br/>const argv = yargs(hideBin(process.argv)).argv;</span></pre><p id="935d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe lp lq lr ls b">argv</code>代表用户指定的所有参数。我们用<code class="fe lp lq lr ls b">hideBin()</code>方法去掉参数前的<code class="fe lp lq lr ls b">--</code>。示例-</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="0c68" class="np lu in ls b gy nq nr l ns nt">hideBin('--example'); // output -&gt; example</span></pre><p id="db44" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们可以为所提供的参数添加一系列<code class="fe lp lq lr ls b">IF and ELSEIF</code>检查。您也可以使用<code class="fe lp lq lr ls b">switch</code>语句。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="00af" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因为package.json本质上是一个javascript对象，所以我们可以从其中提取属性。<code class="fe lp lq lr ls b">yargs</code>提供指定参数的对象。我们可以检查所需的属性。还有一个<code class="fe lp lq lr ls b">else</code>检查，看用户是否没有给出任何参数。现在让我向您展示CLIs中的其他一些常见功能。</p><h1 id="8aa3" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">装载机</h1><p id="ba97" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">在CLI中，异步和耗时的操作非常常见。我们不想让用户认为他的计算机已经挂起。我们将为加载器使用<a class="ae ks" href="https://www.npmjs.com/package/ora" rel="noopener ugc nofollow" target="_blank">或</a>包。首先安装<code class="fe lp lq lr ls b">ora</code> -</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="45fd" class="np lu in ls b gy nq nr l ns nt">npm i ora</span></pre><p id="4a59" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们需要这个包并设置一个简单的加载器-</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="d5d7" class="np lu in ls b gy nq nr l ns nt">const ora = require('ora');<br/>const spinner = ora('Loading...').start();</span></pre><p id="c4d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个加载程序将永远运行，因为我们没有停止它。我们没有任何花费大量时间的代码(API请求、数据处理等)，我们将使用<code class="fe lp lq lr ls b">setTimeout()</code>来模拟加载的结束。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="0845" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我已经把我们的生命函数放在了我们的<code class="fe lp lq lr ls b">setTimeout()</code>里面，这样它只有在加载完成后才会被执行。我们的加载程序运行<code class="fe lp lq lr ls b">2000</code>毫秒或<code class="fe lp lq lr ls b">2</code>秒。</p><p id="1bf1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们快速重构一下。我们的<code class="fe lp lq lr ls b">setTimeout()</code>中有一个回调函数，它可以被设置为<code class="fe lp lq lr ls b">async</code>。我们现在可以删除<code class="fe lp lq lr ls b">IIFE</code>功能了。</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="9116" class="np lu in ls b gy nq nr l ns nt">setTimeout(async () =&gt; {<br/>  spinner.stop();<br/>  // Body of IIFE function goes here.<br/><br/>}, 2000);</span></pre><p id="b3c1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">关于<a class="ae ks" href="https://www.npmjs.com/package/ora" rel="noopener ugc nofollow" target="_blank">或</a>还有很多，查看<a class="ae ks" href="https://github.com/sindresorhus/ora#readme" rel="noopener ugc nofollow" target="_blank">官方文件</a>了解更多。</p><h1 id="b539" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">列表</h1><p id="87d8" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">还记得我们为争论设置的<code class="fe lp lq lr ls b">IF ELSEIF</code>吗？让我们添加一个列出所有命令的<code class="fe lp lq lr ls b">--help</code>参数。列表是CLI的一个非常重要的部分。我正在使用一个有用的软件包<a class="ae ks" href="https://www.npmjs.com/package/listr" rel="noopener ugc nofollow" target="_blank"> listr </a>来处理这些列表。让我们将下面的代码添加到我们的文件中有<code class="fe lp lq lr ls b">IF</code>检查的地方。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="8f81" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们为<code class="fe lp lq lr ls b">--help</code>创建了一个新的if检查。在其中，我们将一组任务传递给了<code class="fe lp lq lr ls b">Listr</code>类。这基本上会列出以下内容。这可以通过<code class="fe lp lq lr ls b">console.log()</code>来完成，但是我之所以使用<code class="fe lp lq lr ls b">listr</code>是因为在任务数组的每个对象中，我们也可以用一个箭头函数来指定一个任务属性。查看<a class="ae ks" href="https://github.com/SamVerschueren/listr#readme" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多信息。</p><p id="1e4e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们的命令行界面看起来像这样-</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/fa1bb985ad71155673adf83026a0f3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/0*Y1xCbmJQDLnUKMa7.png"/></div></figure><h1 id="76d5" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">从代码执行命令</h1><p id="6cd9" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">许多CLI想要访问其他CLI并运行命令，如<code class="fe lp lq lr ls b">git init</code>或<code class="fe lp lq lr ls b">npm install</code>等。出于本教程的目的，我使用了包<a class="ae ks" href="https://www.npmjs.com/package/execa" rel="noopener ugc nofollow" target="_blank"> execa </a>。首先安装模块:</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="1208" class="np lu in ls b gy nq nr l ns nt">npm i execa</span></pre><p id="921c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，需要文件顶部的模块</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="ecfa" class="np lu in ls b gy nq nr l ns nt">const execa = require('execa');</span></pre><p id="7d3d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们的参数条件的<code class="fe lp lq lr ls b">ELSE</code>块中，添加以下代码。如果您还记得，我们已经有一个<code class="fe lp lq lr ls b">console.log()</code>要求我们指定一个命令。让我们运行前面的<code class="fe lp lq lr ls b">--help</code>命令，并列出可用的命令。</p><pre class="kd ke kf kg gt nl ls nm nn aw no bi"><span id="f141" class="np lu in ls b gy nq nr l ns nt">else {<br/>  console.log('Please specify a command');<br/><br/>  const { stdout } = await execa('hello-world', ['--help']);<br/>  console.log(stdout);<br/>}</span></pre><p id="c275" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们调用<code class="fe lp lq lr ls b">execa()</code>函数并传入命令的名称。然后，在一个数组中，我们传递要提供的参数。我们将<code class="fe lp lq lr ls b">await</code>这个，然后析构输出。然后，我们将记录输出以模拟运行该命令。</p><p id="8b57" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们的CLI最终应该是这样的-</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/fc97ff51373f9ff89c5b0e263255170e.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/0*96UPlE1Z4v9EZqZO.png"/></div></figure><p id="fcd2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">作为奖励，我列出了一些在开发CLI时可以使用的包。</p><h1 id="aff9" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">资源</h1><p id="92a5" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">这些是在开发CLI时可能对您有所帮助的软件包列表。请记住，这绝不是一份详尽的清单。NPM上有超过100万个包裹，不可能一一涵盖。</p><h2 id="0899" class="np lu in bd lv od oe dn lz of og dp md lc oh oi mf lg oj ok mh lk ol om mj on bi translated">输入</h2><ol class=""><li id="9d16" class="mx my in kv b kw ml kz mm lc oo lg op lk oq lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/prompts" rel="noopener ugc nofollow" target="_blank">提示</a></li><li id="a43b" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/inquirer" rel="noopener ugc nofollow" target="_blank">询问者</a></li><li id="b674" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/enquirer" rel="noopener ugc nofollow" target="_blank">询问者</a></li><li id="0e08" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated">cli提示</li><li id="0212" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://npmjs.com/package/email-prompt" rel="noopener ugc nofollow" target="_blank">邮件提示</a></li></ol><h2 id="842c" class="np lu in bd lv od oe dn lz of og dp md lc oh oi mf lg oj ok mh lk ol om mj on bi translated">彩色输出</h2><ol class=""><li id="4de0" class="mx my in kv b kw ml kz mm lc oo lg op lk oq lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/chalk" rel="noopener ugc nofollow" target="_blank">粉笔</a></li><li id="7862" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/kleur" rel="noopener ugc nofollow" target="_blank">克勒</a></li></ol><p id="55df" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">装载机</strong></p><ol class=""><li id="7e9e" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/cli-spinners" rel="noopener ugc nofollow" target="_blank"> cli-spinners </a></li><li id="d8da" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated">cli-spinner </li><li id="0215" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/ora" rel="noopener ugc nofollow" target="_blank">奥拉</a></li></ol><p id="b98a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">输出周围的方框</strong></p><ol class=""><li id="9248" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated"><a class="ae ks" href="http://npm.im/boxen" rel="noopener ugc nofollow" target="_blank">博森</a></li><li id="be7f" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated">对话框</li><li id="d407" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.npmjs.com/package/ascii-art" rel="noopener ugc nofollow" target="_blank"> ascii-art </a></li></ol><h2 id="9ebf" class="np lu in bd lv od oe dn lz of og dp md lc oh oi mf lg oj ok mh lk ol om mj on bi translated">命令行界面框架</h2><p id="4fd6" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated"><a class="ae ks" href="https://oclif.io/" rel="noopener ugc nofollow" target="_blank"> Oclif </a>是一个用于在Node.js中构建CLI的开源框架。使用一些标志或者有子命令的高级CLI来创建CLI。oclif使您可以很容易地为您的公司、服务或您自己的开发需求构建CLIs。</p><p id="f5ba" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">就这样了，伙计们，谢谢你们阅读这篇文章。希望你们喜欢。如果你觉得这个帖子有用或者喜欢，请跟我来，获得关于新帖子的通知。如果你有问题，在评论中问他们，我会尽力回答。</p></div><div class="ab cl or os hr ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="ig ih ii ij ik"><p id="7dce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mt">原载于2020年3月5日</em> <a class="ae ks" href="https://dev.to/akashshyam/a-guide-to-clis-with-node-js-2obn" rel="noopener ugc nofollow" target="_blank"> <em class="mt"> dev.to </em> </a> <em class="mt"/></p><p id="cae1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mt">多内容于</em> <a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="mt">中</em></strong></a></p></div></div>    
</body>
</html>