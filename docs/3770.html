<html>
<head>
<title>How to Store Login Sessions with LocalStorage and SessionStorage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用LocalStorage和SessionStorage存储登录会话</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/implementing-login-case-using-localstorage-and-sessionstorage-bfddce5d2198?source=collection_archive---------0-----------------------#2020-10-24">https://javascript.plainenglish.io/implementing-login-case-using-localstorage-and-sessionstorage-bfddce5d2198?source=collection_archive---------0-----------------------#2020-10-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1008" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">保存SessionStorage中当前登录的用户和LocalStorage中所有用户的信息，全部使用普通JavaScript！</h2></div><p id="73b2" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">JavaScript是一种轻量级脚本语言，但它提供了如此多的功能，从制作动态网页到创建服务器、移动应用程序等等。现代JavaScript可以使用的两个重要功能是LocalStorage和SessionStorage。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/4ac6224ed0b7dc43ef75ecf93d1df260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*h7xqCMlXeL9q0u2rbHviRA.gif"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">The Demo</figcaption></figure><h1 id="8bf6" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">本地存储与会话存储</h1><p id="1f20" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">两者都可以从Inspect Element &gt; Application &gt; local storage或SessionStorage中访问。它们的名称说明了它们之间的区别，两者都存储信息，但是SessionStorage为当前会话存储信息，而LocalStorage将信息存储在系统的本地。</p><p id="6506" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><em class="mm">当你改变你当前的标签页或浏览器窗口时，会话就会过期，因此，信息会自动丢失，而LS不会这样工作！</em></p><p id="96bb" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">因此，为了存储用户ID和密码等用户信息，我们将使用LocalStorage，并且当前登录的用户信息将在SessionStorage本身中可见！很酷的东西👩🏻‍💻！</p><h2 id="2c7f" class="mn lq in bd lr mo mp dn lv mq mr dp lz km ms mt mb kq mu mv md ku mw mx mf my bi translated">实施时间</h2><p id="07c4" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">HTML表单看起来像这样，我们将从这个表单中提取用户名和密码，并在我们的JS代码中使用它。</p><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="f988" class="mn lq in na b gy ne nf l ng nh">...<br/>&lt;body&gt;<br/>  &lt;div&gt;<br/>    &lt;ul id="listuser"&gt;<br/>      &lt;h3&gt; All users here: &lt;/h3&gt;<br/>    &lt;/ul&gt; <br/>  &lt;/div&gt;<br/>  <br/>&lt;form onsubmit="return false"&gt;</span><span id="540c" class="mn lq in na b gy ni nf l ng nh">&lt;div class="container"&gt;</span><span id="1456" class="mn lq in na b gy ni nf l ng nh">&lt;label for="uname"&gt;&lt;b&gt;Username&lt;/b&gt;&lt;/label&gt;<br/>&lt;input type="text" placeholder="Enter Username" id= "uname"                  name="uname" required&gt;</span><span id="07e1" class="mn lq in na b gy ni nf l ng nh">&lt;label for="psw"&gt;&lt;b&gt;Password&lt;/b&gt;&lt;/label&gt;<br/>&lt;input type="password" placeholder="Enter Password" id="psw" name="psw" required&gt;</span><span id="bcda" class="mn lq in na b gy ni nf l ng nh">&lt;button type="submit" onclick="Login()"&gt;Login&lt;/button&gt;<br/>    <br/>&lt;/div&gt;<br/>&lt;/form&gt;<br/>&lt;/body&gt;<br/>...</span></pre><p id="e0ad" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">用户ID和密码作为对象数组存储在LS中。为此，我们将创建一个数组，并将每个用户的对象推送到数组中。密码必须以加密形式存储在本地存储器中，否则很容易被提取出来。</p><p id="641d" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><em class="mm">函数btoa('string ')对传递的字符串进行编码，而atob('encoded_string ')对编码后的字符串进行解码。</em></p><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="c15f" class="mn lq in na b gy ne nf l ng nh">function Login()<br/>{<br/> var a = new Array();<br/> up1 = new Object();<br/> up2 = new Object();<br/> <br/>up1={<br/> name:’<a class="ae nj" href="mailto:abcd@gmail.com" rel="noopener ugc nofollow" target="_blank">abcd@gmail.com</a>’,<br/> password:btoa(’abc@12')<br/>};</span><span id="b57b" class="mn lq in na b gy ni nf l ng nh">up2={<br/> name:’<a class="ae nj" href="mailto:bcd@gmail.com" rel="noopener ugc nofollow" target="_blank">bcd@gmail.com</a>’,<br/> password:btoa(’bcd@12')<br/>};</span><span id="56cd" class="mn lq in na b gy ni nf l ng nh">a.push(up1);<br/>a.push(up2);</span></pre><h2 id="b4c5" class="mn lq in bd lr mo mp dn lv mq mr dp lz km ms mt mb kq mu mv md ku mw mx mf my bi translated">提取当前登录的用户信息</h2><p id="8ad1" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">简单地说，提交的表单中的用户名和密码将是当前用户的详细信息，我们将使用setItem方法将它们存储在SessionStorage中，该方法接受一个<strong class="kf io"> <em class="mm"> (key，value)对</em> </strong>。类似地，如果您想要取出值，请使用getItem('key ')。请记住，这里的密钥类似于— array['array_name'][userID]</p><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="d462" class="mn lq in na b gy ne nf l ng nh">var username = document.getElementById(‘uname’).value;<br/>var password = document.getElementById(‘psw’).value;</span><span id="ac5b" class="mn lq in na b gy ni nf l ng nh">sessionStorage.setItem(“currentloggedin”,username);</span></pre><p id="3085" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><strong class="kf io"> <em class="mm">存储用户对象的数组。LocalStorage只存储字符串值，Json.stringify()为我们做了这件事！</em>T13】</strong></p><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="8778" class="mn lq in na b gy ne nf l ng nh">localStorage.setItem('all_users',JSON.stringify(a));</span></pre><h2 id="2285" class="mn lq in bd lr mo mp dn lv mq mr dp lz km ms mt mb kq mu mv md ku mw mx mf my bi translated">登录后在网页上显示用户</h2><p id="8001" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">是时候解析我们存储在上面的对象数组，并动态显示作为<li>元素附加到<ul>的用户列表了。在Login()函数中，添加以下代码:</ul></li></p><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="334b" class="mn lq in na b gy ne nf l ng nh">a=JSON.parse((localStorage.getItem("all_users")));</span><span id="7977" class="mn lq in na b gy ni nf l ng nh">a.push({name: username, password: password});</span><span id="d35d" class="mn lq in na b gy ni nf l ng nh">localStorage.setItem('name',JSON.stringify(a));</span><span id="dd81" class="mn lq in na b gy ni nf l ng nh">for(var i=0; i&lt;a.length; i++)<br/>  {<br/>   var li = document.createElement("li");<br/>   li.innerHTML=a[i]['name'];<br/>   document.getElementById("listuser").appendChild(li);<br/>  }</span></pre><h1 id="f5e7" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">附加情况:用户认证</h1><p id="6600" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">我将使用<strong class="kf io"><em class="mm">JavaScript map</em></strong>来检查来自LocalStorage的用户信息的有效性，并声明成功登录，如果用户名和密码记录存在于LocalStorage中。为此，我们需要将用户信息以对象数组的形式转换为Hash-map。</p><h2 id="601d" class="mn lq in bd lr mo mp dn lv mq mr dp lz km ms mt mb kq mu mv md ku mw mx mf my bi translated"><strong class="ak">JavaScript中的Map()——优化</strong></h2><p id="cbc6" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">JS使用。map()函数，其中的对象可以作为[键，值]对存储，并且可以作为<strong class="kf io"><em class="mm">hashmap[键] = value访问；</em> </strong></p><p id="54d5" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">在这里，我将电子邮件ID存储为密钥，将密码存储为值。请记住使用atob(“密码”)对其进行解码，以便与存储在LocalStorage中的密码进行比较。</p><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="d070" class="mn lq in na b gy ne nf l ng nh">function Login()<br/>{<br/>   const hash = Object.fromEntries(<br/>   a.map(e =&gt; [e.name, e.password])<br/>)</span><span id="c9d1" class="mn lq in na b gy ni nf l ng nh">var username = document.getElementById('uname').value;<br/>var password = document.getElementById('psw').value;</span><span id="bbe8" class="mn lq in na b gy ni nf l ng nh">for (let key of hash) <br/>{<br/>    <br/>    if(key[0] === username &amp;&amp; key[1]===atob(password))<br/>     {<br/>         alert('Login successful');<br/>     }<br/> <br/>else<br/>     {<br/>         alert('Login fail');<br/>     }<br/>}</span></pre><p id="a58a" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">Object.fromEntries()帮助我们检索所有对象，每个对象数组都使用map()函数转换或映射到一个hashmap条目。这是在本地存储中存储东西的更优化和更有效的方式。</p><h1 id="9a18" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated"><strong class="ak">迭代包含用户信息的哈希表</strong></h1><p id="8380" class="pw-post-body-paragraph kd ke in kf b kg mh jo ki kj mi jr kl km mj ko kp kq mk ks kt ku ml kw kx ky ig bi translated">迭代地图有许多复杂的方法，从使用reduce()函数到使用Object.assign()。</p><h2 id="f125" class="mn lq in bd lr mo mp dn lv mq mr dp lz km ms mt mb kq mu mv md ku mw mx mf my bi translated"><strong class="ak">使用还原剂()</strong></h2><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="030f" class="mn lq in na b gy ne nf l ng nh">var hashmap = a.reduce(function(map, obj) {<br/>    map[obj.key] = obj.val;<br/>    return map;<br/>}, {});</span></pre><h2 id="b120" class="mn lq in bd lr mo mp dn lv mq mr dp lz km ms mt mb kq mu mv md ku mw mx mf my bi translated"><strong class="ak"> 2 .使用对象. assign( ) </strong></h2><pre class="la lb lc ld gt mz na nb nc aw nd bi"><span id="21d5" class="mn lq in na b gy ne nf l ng nh">const hashmap = Object.assign({}, ...(&lt;{}&gt;a.map(s =&gt; ({[s.key]:s.value}))));</span></pre><p id="6471" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated"><em class="mm">迭代哈希表最简单的方法是对循环</em>  <em class="mm">运行</em> <strong class="kf io"> <em class="mm">，返回(键、值)对，可分别作为键[0]和键[1]访问。</em></strong></p></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="46d5" class="pw-post-body-paragraph kd ke in kf b kg kh jo ki kj kk jr kl km kn ko kp kq kr ks kt ku kv kw kx ky ig bi translated">JavaScript真的很有趣，它总是包含一些未被发现的特性！继续探索并从中创造创新！</p></div></div>    
</body>
</html>