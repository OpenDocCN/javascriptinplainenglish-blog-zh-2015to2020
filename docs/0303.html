<html>
<head>
<title>React Component building and publishing workflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React组件构建和发布工作流</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-component-building-and-publishing-workflow-c7bb815dd2c?source=collection_archive---------4-----------------------#2019-09-15">https://javascript.plainenglish.io/react-component-building-and-publishing-workflow-c7bb815dd2c?source=collection_archive---------4-----------------------#2019-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ffc12cc26db58d83be30a09832237385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Enkcn-vHRL596oFyvBW9Hw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Credit: <a class="ae kc" href="https://s3.amazonaws.com/ckl-website-static/wp-content/uploads/2017/07/Banner_css-1280x680.png" rel="noopener ugc nofollow" target="_blank">Cheesecake Labs</a></figcaption></figure><p id="2079" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React开发人员每天都在使用类似的组件代码。但并不是所有的都<strong class="kf ir">简化了React组件构建和发布工作流程</strong>。</p><h1 id="a5ac" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">在我们讨论构建和发布工作流之前，这里是我们需要它的原因。</strong></h1><p id="f351" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><strong class="kf ir">#原因1: </strong>我们的大部分React代码都是可重用的，并且我们很有可能在另一个项目中需要相同的React组件。</p><p id="98de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">#原因2: </strong>为了在我们所有的React项目中保持代码的一致性。</p><p id="2ede" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">#理由3: </strong>为开源做贡献的机会。我们可以发布组件，并让其他人也使用它！</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><p id="4b41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你知道NPM的包装是怎么做的。然而，当涉及到发布我们在项目中使用的React组件时，我们犹豫了。</p><h1 id="639a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">你犹豫的原因</h1><ul class=""><li id="148f" class="ml mm iq kf b kg lz kk ma ko mn ks mo kw mp la mq mr ms mt bi translated">构建一个可在NPM上发布的新React组件需要付出很多努力。</li><li id="9df2" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">你觉得浪费时间在你的项目中安装和更新已发布的包是不值得的。</li><li id="b433" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">您希望您的组件位于components文件夹中，并且当组件代码被更改时，您希望您的项目“实时重新加载”。</li></ul><h1 id="67cb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">当我还是个新手的时候，我曾经发布过这样一个React组件…</h1><p id="5370" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我曾经创建了一个新的Git存储库。</p><p id="03a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后设置所有的<code class="fe mz na nb nc b">babel</code>和<code class="fe mz na nb nc b">webpack</code>的东西。</p><p id="688d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我会编写React组件代码。</p><p id="b362" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我会手动编译它，并用<code class="fe mz na nb nc b">npm publish</code>发布到<code class="fe mz na nb nc b">npm</code>。</p><p id="a053" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了测试React组件，我将使用<code class="fe mz na nb nc b">npm i -S that-react-component</code>在我的项目目录中手动安装该组件。</p><p id="f337" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有“实时重新加载”…我必须更新组件库中的包，并更新我的项目中的模块。</p><h2 id="3c2a" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">那个过程有多糟糕。我知道这很糟糕。所以，我停止开源React组件。我让它们存在于我的项目目录中。如果我需要一个组件，我会将组件文件复制粘贴到另一个项目中。就这样继续下去。直到我了解到…</h2><p id="807a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe mz na nb nc b">create-react-library</code>和<code class="fe mz na nb nc b">npm link</code>！</p><p id="67c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我刚刚在GitHub搜索框里闲逛，输入一些奇怪的东西，然后我发现了<code class="fe mz na nb nc b">create-react-library</code>。</p><figure class="nq nr ns nt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/e33fecc35603929920bf2aac061c87d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tt-8-gpw-xLZu0heaMZ57g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Credit: <a class="ae kc" href="https://sapyard.com/wp-content/uploads/2017/10/SAP-Workflow-SAPYard.png" rel="noopener ugc nofollow" target="_blank">SAPYard</a></figcaption></figure><h1 id="e378" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">这里有一个更好的方法。</h1><h2 id="4cdc" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">第一步</h2><p id="8db9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">所以，每当你知道你正在为正在进行的项目构建一个组件时，想想…</p><ul class=""><li id="0d97" class="ml mm iq kf b kg kh kk kl ko nu ks nv kw nw la mq mr ms mt bi translated">如果您可能需要其他项目的组件。</li><li id="2845" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">如果这个组件对其他开发者有用。</li><li id="5d66" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">如果您的组件逻辑和用例不是非常特定于项目的。</li><li id="96de" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">或者出于理智的考虑，您希望您的项目文件不那么杂乱。</li></ul><p id="2b20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">如果您认为这些理由中的任何一个是正确的，那么您应该考虑将组件构建为一个可重用的组件，该组件被打包为一个模块。</strong></p><p id="a291" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果是，则转到步骤2。</p><h2 id="f2bb" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">第二步</h2><p id="ccc6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">通过终端访问存储所有项目的主文件夹，并运行以下命令👇</p><pre class="nq nr ns nt gt nx nc ny nz aw oa bi"><span id="3a90" class="nd lc iq nc b gy ob oc l od oe">$ npx create-react-library &lt;COMPONENT_NAME&gt; # then answer few basic prompts<br/>$ cd &lt;COMPONENT_NAME&gt; # enter in that directory</span></pre><p id="ae6a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">瞧！您得到了React组件样板代码设置。</strong></p><h2 id="6fdd" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">第三步</h2><p id="1d1c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在终端中执行以下操作👇</p><pre class="nq nr ns nt gt nx nc ny nz aw oa bi"><span id="2e5c" class="nd lc iq nc b gy ob oc l od oe">$ npm i # this will install your component modules<br/>$ cd example &amp;&amp; npm i # install CRA modules<br/>$ npm start</span></pre><p id="a800" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行上述命令将安装React组件和创建React应用程序示例所需的模块。</p><h2 id="b4a2" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">第四步</h2><p id="28fa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">让我们浏览一下项目的文件结构。</p><pre class="nq nr ns nt gt nx nc ny nz aw oa bi"><span id="fdad" class="nd lc iq nc b gy ob oc l od oe">project<br/>│   README.md<br/>│   package.json<br/>|   ...   <br/>│<br/>└───example<br/>│   │   package.json<br/>│   │   ...<br/>│<br/>└───src<br/>    │   package.json<br/>    │   ...</span></pre><p id="8875" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，无论何时你在<code class="fe mz na nb nc b">src/</code>中对你的库或者对示例应用的<code class="fe mz na nb nc b">example/src</code>做出改变，<code class="fe mz na nb nc b">create-react-app</code>都会实时重新加载你的本地开发服务器，这样你就可以实时迭代你的组件了！</p><figure class="nq nr ns nt gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/b4db418f9392d7e80b48f1be61c90aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/1*mgIabNcs-qtTnzsf72SO2Q.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Credit: <a class="ae kc" href="https://github.com/transitive-bullshit/create-react-library" rel="noopener ugc nofollow" target="_blank">CRL Repository</a></figcaption></figure><h2 id="a77a" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated"><strong class="ak">第五步</strong></h2><p id="16f3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">那么，如果<strong class="kf ir">您希望组件与您正在进行的项目</strong>一起工作，而不必在<code class="fe mz na nb nc b">npm</code>上更新和发布，该怎么办呢？</p><p id="d683" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，<code class="fe mz na nb nc b">npm link</code>来救援了！</p><p id="7474" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在你的组件根目录下，运行<code class="fe mz na nb nc b">$ npm link</code>。这使得您的组件对所有项目都可用！</p><h2 id="24cd" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated"><strong class="ak">第六步</strong></h2><p id="ef80" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">现在通过终端，<strong class="kf ir">到达正在进行的项目目录</strong>，运行<br/> <code class="fe mz na nb nc b">$ npm link &lt;COMPONENT_NAME&gt;</code>。</p><p id="e75d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样。你连接了两个世界！</p><p id="0636" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">让你的组件目录和正在进行的项目都实时观看和编译代码。</strong></p><h2 id="f22d" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated"><strong class="ak">第七步</strong></h2><p id="41dc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">是时候在您的项目中使用该组件了！<br/>您可以以正常方式导入和使用该组件。</p><pre class="nq nr ns nt gt nx nc ny nz aw oa bi"><span id="b5ee" class="nd lc iq nc b gy ob oc l od oe">import ThatAwesomeComponent from '&lt;COMPONENT_NAME&gt;'</span></pre><p id="db1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当您在浏览器中更新组件代码和刷新项目时，您会看到事情变得生动起来！</p><h2 id="e78a" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">走吧。你自己试试！</h2></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="bbb0" class="lb lc iq bd ld le og lg lh li oh lk ll lm oi lo lp lq oj ls lt lu ok lw lx ly bi translated">发布React组件</h1><p id="2205" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">既然您想要发布/部署/发布您的React组件…</p><ul class=""><li id="85fd" class="ml mm iq kf b kg kh kk kl ko nu ks nv kw nw la mq mr ms mt bi translated">确保你有好的文档来支持你的代码。</li><li id="7173" class="ml mm iq kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">此外，检查您的版本号。如果你觉得还行，还能用，就该发表了！</li></ul><pre class="nq nr ns nt gt nx nc ny nz aw oa bi"><span id="1b68" class="nd lc iq nc b gy ob oc l od oe">$ npm publish</span></pre><p id="5672" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样。您的文件将被建立并公布在NPM注册！</p><p id="28e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想让你的构建不那么臃肿，用下面的 <code class="fe mz na nb nc b"><strong class="kf ir">.npmignore</strong></code> <strong class="kf ir">文件发布组件。</strong></p><pre class="nq nr ns nt gt nx nc ny nz aw oa bi"><span id="1dbf" class="nd lc iq nc b gy ob oc l od oe"># it is also configured for TypeScript Components<br/>src<br/>example<br/>.vscode<br/>.eslintrc<br/>.prettierrc<br/>package-lock.json<br/>tsconfig.json<br/>tsconfig.test.json<br/>.gitignore<br/>node_modules<br/>.travis.yml<br/>rollup.config.js</span></pre><h1 id="0840" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">你忘了一件事！</h1><p id="85f9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">不要忘记<code class="fe mz na nb nc b">npm unlink</code>正在进行的项目目录中的组件，这样你就可以使用“真实的”和“发布的”组件。当开发组件时，您可以再次链接它。</p><p id="06e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要取消链接，从项目目录中执行<code class="fe mz na nb nc b">$ npm unlink &lt;COMPONENT_NAME&gt;</code>。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="734b" class="lb lc iq bd ld le og lg lh li oh lk ll lm oi lo lp lq oj ls lt lu ok lw lx ly bi translated">链接</h1><p id="c48a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><a class="ae kc" href="https://github.com/transitive-bullshit/create-react-library" rel="noopener ugc nofollow" target="_blank">https://github.com/transitive-bullshit/create-react-library</a><br/>T3】https://codurance.com/2016/12/21/how-to-use-npm-link</p><h1 id="115e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c3ad" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果以正确的方式构建和发布，React组件会更棒。</p><h2 id="568a" class="nd lc iq bd ld ne nf dn lh ng nh dp ll ko ni nj lp ks nk nl lt kw nm nn lx no bi translated">关于我</h2><p id="5676" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><strong class="kf ir">我是Kumar Abhirup，一名来自印度的16岁JavaScript React开发人员</strong>，每天都在学习新东西。</p><p id="ab23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://twitter.com/kumar_abhirup" rel="noopener ugc nofollow" target="_blank">在Twitter上与我联系</a>🐦<br/> <a class="ae kc" href="https://kumar.now.sh" rel="noopener ugc nofollow" target="_blank">我的个人网站和作品集</a> 🖥️</p><p id="9b45" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请在下面评论你更好的方法，以及改进这篇文章的建议。:)</p></div></div>    
</body>
</html>