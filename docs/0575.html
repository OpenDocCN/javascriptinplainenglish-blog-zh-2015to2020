<html>
<head>
<title>The most simple Contentful + React tutorial using a NextJS application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NextJS应用程序的最简单的Contentful + React教程</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-most-simple-contentful-react-tutorial-using-a-nextjs-application-8d0ce4596ad6?source=collection_archive---------1-----------------------#2019-11-11">https://javascript.plainenglish.io/the-most-simple-contentful-react-tutorial-using-a-nextjs-application-8d0ce4596ad6?source=collection_archive---------1-----------------------#2019-11-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a10b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个非常简单的JAM Stack how-to教程，使用Contentful和React，而不必掌握+1000工具作为先决条件。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0203f46a016ee2ec23943c69829b5ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7a_E5fEi3M2OKE784Gahsg.png"/></div></div></figure><p id="02a3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上个月看了那么多关于Contentful或者Prismic之类的无头CMS的教程。但是每次人们都倾向于与许多工具共享存储库，例如Docker、一些书呆子式的CSS-in-js库和其他一些东西，这使得初学者的学习曲线变得如此艰难。</p><p id="6e8a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">🙅🏻‍♂️By这样做，人们将不必仅仅试图理解内容并作出反应，他们还必须掌握许多概念，这将导致许多挫折和可能的头痛🤯。</p><p id="e731" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">👨🏻‍🎓今天我想和你分享的是<strong class="kt ir">一个非常简单的例子，没有太多的依赖和要求</strong>。对于需要不断部署和改进的大型应用程序来说，这可能不是最适合的设置。但是足够简单，可以自信地开始使用Contentful和React，因此您可以尝试这些令人敬畏的工具。</p><p id="1602" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你会喜欢，让我们开始吧。我们走吧！</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><h1 id="859a" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">🗓摘要</h1><ol class=""><li id="f85f" class="mm mn iq kt b ku mo kx mp la mq le mr li ms lm mt mu mv mw bi translated"><strong class="kt ir">👨🏻‍🔬什么是无头CMS和Contentful？</strong></li><li id="2602" class="mm mn iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated"><strong class="kt ir"> 🦸🏻‍♂️:什么是NextJS，它与React相比如何？</strong></li><li id="ad93" class="mm mn iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated"><strong class="kt ir">🚀演示时间:使用Contentful和React列出作者的小文章</strong></li><li id="de8f" class="mm mn iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated"><strong class="kt ir">💁🏻‍♂️你可能也会对… </strong>感兴趣</li></ol></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><h1 id="29f1" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated"><strong class="ak">👨🏻‍🔬什么是无头CMS和Contentful？</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/9e1f9df794a32ab00c92e11f3716691c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BjNA1Qpb4Cm1riZA.png"/></div></figure><p id="5811" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Contentful是一个强大的、高度可扩展的无头内容管理软件(CMS)。它是在专有许可下作为基于云的解决方案分发的。定价是基于订阅的，但你有一个相当合理的免费层。</p><p id="96c7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它允许您管理和组织任何类型的内容，如您的页面布局，您的文章在一个智能和可扩展的后台。</p><h2 id="81ed" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated">🧟‍♂️:什么是无头CMS，它与传统CMS有何不同？</h2><p id="e0c4" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated">无头CMS是一种只将数据作为JSON(或任何其他类型的数据)有效载荷来交付的CMS。它不提供任何类型的前端代码，如HTML页面或CSS。它只交付用于稍后构建视图的小块数据，这就是<strong class="kt ir"> </strong> <a class="ae ns" href="https://en.wikipedia.org/wiki/Separation_of_concerns" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">通过网络</strong>分离关注点 </a> <strong class="kt ir">的原理。</strong></p><p id="53a6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个UI实现被委托给开发人员，他们可以使用任何他想要的东西来呈现内容。</p><ul class=""><li id="b840" class="mm mn iq kt b ku kv kx ky la nt le nu li nv lm nw mu mv mw bi translated">像<strong class="kt ir"> Laravel </strong>、<strong class="kt ir"> Spring </strong>或<strong class="kt ir"> Symfony </strong>这样的后端框架…</li><li id="c081" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">…或前端框架，如<strong class="kt ir"> ReactJS </strong>、<strong class="kt ir"> VueJS </strong>、<strong class="kt ir"> Angular </strong>或任何类似的框架。</li></ul><p id="d518" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那些前端框架在著名的<strong class="kt ir"> JAMSTACK </strong>架构中非常流行，代表<strong class="kt ir"> Ja </strong> vascript、<strong class="kt ir"> A </strong> PI和<strong class="kt ir"> M </strong> arkup。</p><p id="4c8f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">无头CMS是以数据和内容为中心的，他们擅长这个。</strong></p><p id="be3f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们知道了我们将使用的后端工具，让我们看看将使用什么来显示我们的数据。</p><h1 id="4ab0" class="lu lv iq bd lw lx nx lz ma mb ny md me jw nz jx mg jz oa ka mi kc ob kd mk ml bi translated"><strong class="ak"> 🦸🏻‍♂️:什么是NextJS，它与React相比如何？</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/934fb511daba9ddc1665ef84fda46c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DPnmYwmu-851x_nz"/></div></div></figure><p id="4b1b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你读了这篇文章，你可能已经知道了ReactJS。为了便于演示，我们将使用一个基于它的工具，一个名为<strong class="kt ir"> NextJS的框架。</strong></p><p id="6c4b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">NextJS由一家提供基于云的服务(<a class="ae ns" href="http://zeit.co/" rel="noopener ugc nofollow" target="_blank">zeit.co</a>)的大公司开发和支持，它是一个由ReactJS制成的服务器<strong class="kt ir">ide</strong>R<strong class="kt ir">R</strong>渲染框架(SSR ),允许使用SSR或静态渲染来构建高性能的web应用程序。</p><p id="ee77" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">💡</strong> <em class="od">如果你想了解更多关于SSR、JAMstack以及相关的东西，</em> <strong class="kt ir"> <em class="od">我会在本文末尾掉一些链接。</em> </strong></p><h2 id="32cb" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated">⚡️NextJS作为简化应用程序开发的工具</h2><p id="f9c0" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated">NextJS默认使用基于目录的导航。简单地说，根据我们在<code class="fe oe of og oh b">pages</code>文件夹中的文件，框架将自动生成应用路由器。</p><ul class=""><li id="97be" class="mm mn iq kt b ku kv kx ky la nt le nu li nv lm nw mu mv mw bi translated">拥有<code class="fe oe of og oh b">pages/index.js</code>将使应用程序在<code class="fe oe of og oh b">/</code>端点上响应。</li><li id="49ad" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">拥有<code class="fe oe of og oh b">pages/blog.js</code>将使应用程序在<code class="fe oe of og oh b">/blog</code>端点上响应。</li><li id="0346" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">拥有<code class="fe oe of og oh b">pages/tag/react.js</code>会让app在<code class="fe oe of og oh b">/tag/react</code>端点响应等等。</li><li id="f67c" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">任何其他URL将被重定向到默认的404页面，您当然可以覆盖它。</li></ul><p id="f132" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用这种模式，我们可以非常快速地制作一个非常简单的应用程序，这正是本文的主题:快速而简单。</p><p id="ed7c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">说够了。演示时间！</p><h1 id="acfc" class="lu lv iq bd lw lx nx lz ma mb ny md me jw nz jx mg jz oa ka mi kc ob kd mk ml bi translated"><strong class="ak">🚀演示时间:使用Contentful和React列出作者的小文章</strong></h1><p id="4adc" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated">下面的截图是我们将要构建的最后一个页面的截图。这是一个简单的双卡页面，包含从远程内容丰富的数据库中获取的数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/781f90bcf851aa3240930260b10cff79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xpwImPBwTUffUbrU4wlwDQ.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">We all know that Batman is the best.</figcaption></figure><p id="6dcd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从使用命令<code class="fe oe of og oh b">git clone <a class="ae ns" href="https://github.com/ScreamZ/react-contentful-nextjs-tutorial.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ScreamZ/react-contentful-nextjs-tutorial.git</a></code>克隆存储库下面的<a class="ae ns" href="https://github.com/ScreamZ/react-contentful-nextjs-tutorial" rel="noopener ugc nofollow" target="_blank">开始。</a></p><p id="0ff0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">💡为了简单起见，使用Contentful 的导出工具<a class="ae ns" href="https://www.contentful.com/developers/docs/tutorials/cli/import-and-export/" rel="noopener ugc nofollow" target="_blank">已经为您自动完成了所有工作，下面只是对已经完成的工作的解释。如果你喜欢的话，你可以自己繁殖。</a></strong></p><h2 id="c8c6" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated">❶使用JS SDK配置前端集成的内容</h2><p id="7ddd" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated"><strong class="kt ir"> ➡️创建一个账户和一个新的空位</strong></p><p id="2f21" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这个演示中，我们需要一个空白的内容空间，如果你还没有一个内容丰富的账户，就从创建一个开始<a class="ae ns" href="https://www.contentful.com/sign-up/" rel="noopener ugc nofollow" target="_blank">https://www.contentful.com/sign-up/</a>。</p><p id="8399" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完成后，继续选择<code class="fe oe of og oh b">free space</code>和<code class="fe oe of og oh b">Create an empty space</code>创建一个新的空间，如下所述:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/fef78d11de0e7f01649774c429155214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SChnHTJf1KejoaikFJVi1A.png"/></div></div></figure><p id="8bb6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">精彩！您的共享空间现已创建。我们现在需要一些访问键来与Contentful API对话。</p><p id="db36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> ➡️创建内容交付和管理密钥</strong></p><p id="cf9e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在演示中，我们需要两种类型钥匙:</p><ul class=""><li id="a333" class="mm mn iq kt b ku kv kx ky la nt le nu li nv lm nw mu mv mw bi translated">一个<strong class="kt ir">管理API密匙</strong>，它将用于把我创建的测试内容导入到你的内容空间。</li><li id="a92a" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">和一个<strong class="kt ir">内容交付密钥</strong>，它将用于在前端代码中访问来自SDK的内容。</li></ul><p id="9ea1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">首先从内容交付键开始:</strong>要得到那个:进入你的空间click️ <strong class="kt ir">设置</strong>，然后<strong class="kt ir"> API键</strong>点击<strong class="kt ir">添加API键</strong>创建一个新的指向<code class="fe oe of og oh b">master</code>环境的键。将其命名为you which，但请注意<code class="fe oe of og oh b">Space ID</code>和<code class="fe oe of og oh b">Content Delivery API — Access token</code>，我们稍后会用到它们。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2227d05938d45c6da606b5decca90904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ukLM8tYVvMxGxBlffxDUQ.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">Here is my Example Key 1</figcaption></figure><p id="0947" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">您现在可以创建一个内容管理密钥</strong>，用于数据导入。点击<code class="fe oe of og oh b">Content management tokens</code>选项卡，点击<code class="fe oe of og oh b">Generate personal token</code>。就像其他人一样，留着这个代币，我们很快就会用到它。</p><p id="b848" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> ➡️使用CLI将内容和资产导入contentful】</strong></p><p id="2c64" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Contentful CLI已经被添加到您的<code class="fe oe of og oh b">package.json</code>中的<code class="fe oe of og oh b">devDependencies</code>中，所以您现在需要的是使用我们上面取的<code class="fe oe of og oh b">space id</code>和<code class="fe oe of og oh b">management key</code>的值来填充工作区根目录下的<code class="fe oe of og oh b">import.json</code>文件，它们的名字不言自明。不要更改<code class="fe oe of og oh b">content-file</code>键，这是我们将使用的转储文件夹的路径。</p><pre class="kg kh ki kj gt on oh oo op aw oq bi"><span id="d9d9" class="nd lv iq oh b gy or os l ot ou">{<br/>  "spaceId": "your_space_id",<br/>  "managementToken": "your_management_api_token",<br/>  "content-file": "dump/export.json"<br/>}</span></pre><p id="4554" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">空间ID用于标识您组织内的空间，管理密钥用于使用API管理内容丰富的空间中的内容创建。</p><p id="b01a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完成后，保存并运行以下命令:</p><ul class=""><li id="3bf2" class="mm mn iq kt b ku kv kx ky la nt le nu li nv lm nw mu mv mw bi translated"><code class="fe oe of og oh b">npm install</code></li><li id="fc61" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated"><code class="fe oe of og oh b">npx contentful space import --config import.json</code>开始将<code class="fe oe of og oh b">dump</code>文件夹的内容导入到您的内容空间。</li></ul><p id="8eba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你的应用程序几乎已经准备好了，现在我将详细说明后台已经做了什么来获得这个数据集。</p><p id="672e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> ➡️解释为生成此内容转储所做的工作</strong></p><p id="9359" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，我创建了两个内容模型，它们是带有一些字段的内容的“类”。这用于按语义类别存储数据。</p><p id="5cda" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我有一个<code class="fe oe of og oh b">article</code>和一个<code class="fe oe of og oh b">author</code>内容模型，分别有5个和2个字段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/f8c18bd6cc9b16be286c0c9439e4fd2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NSudr0aocfzu6GIahcPyeQ.png"/></div></div></figure><p id="719c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">文章模型具有一对一的作者关系，它包含日期、标题、图像(也是一对一的资产关系)和一个名为body的丰富内容字段。</p><p id="57b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">还要注意右下角的内容类型ID是<code class="fe oe of og oh b">article</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4e9e0337d22d4591549152f512feb263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZm3iMVrEU0PwqpMPt-qmw.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">Article entity</figcaption></figure><p id="6b0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">作者模型是一个哑2文本字段，包含作者的名和姓。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eebb1d44b7a882e15edbcfdea167bcf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQrFX_EGiK6kadVyDtsawA.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">Author entity</figcaption></figure><p id="6a10" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后我创建了5个内容:</p><ul class=""><li id="b609" class="mm mn iq kt b ku kv kx ky la nt le nu li nv lm nw mu mv mw bi translated">一个作者，也就是我。</li><li id="b768" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">两篇文章，一篇带<strong class="kt ir">🦇蝙蝠侠</strong>和一个with️ <strong class="kt ir"> ⚡️Flash </strong>。</li><li id="6461" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">我创建了两个资产实体，它们是我们两个主角的照片。</li></ul><p id="b628" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">事实上，这很简单…如果你想创建更多，只需进入顶部导航栏的<code class="fe oe of og oh b">content</code>菜单，然后开始。(不要忘记发布，状态显示在右上角)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7615560907abdaef27ac1894fa29b24f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_tY8f73CS9diiQojYiOStA.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk">That guy is badass… isn’t ?</figcaption></figure><p id="9384" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们已经完成了后端和数据，现在让我们看看如何查询所有这些数据。</p><h2 id="6df6" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated">❷理解使用NextJS和react构建的前端代码</h2><p id="d3a1" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated">前端是使用组件的React函数而不是类来构建的。这样以后，您可以利用React的钩子用法。</p><p id="70d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">UI由<a class="ae ns" href="https://picturepan2.github.io/spectre/index.html" rel="noopener ugc nofollow" target="_blank">和<strong class="kt ir">驱动👻</strong></a> <strong class="kt ir"> </strong>厉鬼一个微小的前端框架，布局简单。</p><p id="3830" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于我们只有一个页面用于列出文章，我们将创建一个独特的<code class="fe oe of og oh b">pages/index.js</code>文件，它将解析为我们上面看到的<code class="fe oe of og oh b">http://localhost:3000/</code> URL。</p><p id="032b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> ➡️填充配置并运行应用程序</strong></p><p id="8e82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先用我们上面生成的密钥填充工作区根文件夹中的<code class="fe oe of og oh b">config.json</code>文件。SDK将使用它来查询您的内容空间中的内容。</p><pre class="kg kh ki kj gt on oh oo op aw oq bi"><span id="9103" class="nd lv iq oh b gy or os l ot ou">{<br/>  "space": "",<br/>  "accessToken": ""<br/>}</span></pre><p id="e20c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后在你的控制台上运行<code class="fe oe of og oh b">npm run dev</code>。这将从npm获取依赖项并启动应用程序。</p><p id="e364" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，在你的浏览器中打开<a class="ae ns" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>，你应该可以让应用程序处理这两篇文章。</p><p id="7170" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">太好了，让我们详细看看这是怎么发生的。</p><p id="a52e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">主页面</strong></p><p id="ca66" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那个主页面组件，你可以在<code class="fe oe of og oh b">pages/index.js</code>找到它，我加了一些注释来解释是怎么回事。</p><p id="b924" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">简而言之，每次您在浏览器中访问<code class="fe oe of og oh b">/</code> URL时，都会调用<code class="fe oe of og oh b">getInitialProps</code>函数，它将使用Javascript SDK根据指定的空间ID和内容交付密钥从内容丰富的数据库中获取数据。</p><p id="ba70" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后在页面组件的props中注入那些文章的数组，一个循环遍历它以显示<code class="fe oe of og oh b">Post</code>组件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/a026f28758ffaf84dec2496b620236a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8j434EJzdqT6GZ3ZB9j2Q.png"/></div></div></figure><p id="4b1d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">岗位组件</strong></p><p id="981a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这也很简单，我只需解析Contentful文章中的值，以便将其显示在UI上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/0c46c7fac5bc0336e57b45c90931ef36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KCzmdoIc4zDMAjtXgSdLmA.png"/></div></div></figure><p id="7e63" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">一个小注意:</strong>我们在文章模型中使用了一个富内容字段类型。为了做到这一点，我们需要将AST代码转换成HTML，Contentful已经使用一个小库提供了这个功能:<code class="fe oe of og oh b"><a class="ae ns" href="https://www.contentful.com/developers/docs/javascript/tutorials/rendering-contentful-rich-text-with-javascript/" rel="noopener ugc nofollow" target="_blank">@contentful/rich-text-html-renderer</a></code>。</p><p id="6966" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们到了。随时添加更多的文章，并看到内容在每个页面调用变化！</p><h2 id="b5e2" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated">❸构建并运行生产服务器或使用静态渲染</h2><p id="094f" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated">从现在开始，我们在开发模式中使用next，您现在可以使用<code class="fe oe of og oh b">npm run build</code>编译生产服务器，这将为生产优化JS包。完成后，您可以运行<code class="fe oe of og oh b">npm start</code>来获得一个SSR ready服务器，该服务器将运行<code class="fe oe of og oh b">getInitialProps</code>来获取每个请求的最新内容，或者运行<code class="fe oe of og oh b">npm run export</code>来查询一次，并在<code class="fe oe of og oh b">out</code>文件夹中生成页面的静态版本，该版本可以托管在诸如Netlify、Now、Firebase Hosting之类的CDN或您自己的服务器上，如NginX。</p><p id="348a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你对此感兴趣，只需留下评论，我可以更新文章来展示一个例子。</p><p id="4b71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">🙏🏻感谢您的阅读，希望这有所帮助。</strong></p><h1 id="0f01" class="lu lv iq bd lw lx nx lz ma mb ny md me jw nz jx mg jz oa ka mi kc ob kd mk ml bi translated">💁🏻‍♂️，你可能也会感兴趣…</h1><h2 id="ab91" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated"><strong class="ak"> ➡️什么是JS应用的服务器端渲染？</strong></h2><ul class=""><li id="15d0" class="mm mn iq kt b ku mo kx mp la mq le mr li ms lm nw mu mv mw bi translated"><a class="ae ns" href="https://ssr.vuejs.org/" rel="noopener ugc nofollow" target="_blank">https://ssr.vuejs.org/</a>是理解SSR的好向导，即使它是基于VueJS的。</li><li id="ac80" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated"><a class="ae ns" href="https://nextjs.org/features/server-side-rendering" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/features/server-side-rendering</a></li></ul><h2 id="6077" class="nd lv iq bd lw ne nf dn ma ng nh dp me la ni nj mg le nk nl mi li nm nn mk no bi translated">➡️果酱堆</h2><ul class=""><li id="b3f0" class="mm mn iq kt b ku mo kx mp la mq le mr li ms lm nw mu mv mw bi translated">这是一本关于JAM Stack架构的很棒的指南<a class="ae ns" href="https://jamstack.org/" rel="noopener ugc nofollow" target="_blank">https://jamstack.org/</a>。</li><li id="03f1" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated"><a class="ae ns" href="https://jamstack.wtf/" rel="noopener ugc nofollow" target="_blank">https://jamstack.wtf/</a></li><li id="b410" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated"><a class="ae ns" href="https://www.gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank">https://www.gatsbyjs.org/</a></li></ul><h1 id="54da" class="lu lv iq bd lw lx nx lz ma mb ny md me jw nz jx mg jz oa ka mi kc ob kd mk ml bi translated">🚛收尾/TLDR；📦</h1><p id="2ea0" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la np lc ld le nq lg lh li nr lk ll lm ij bi translated">所有的文章代码都存放在下面的库中:<a class="ae ns" href="https://github.com/ScreamZ/react-contentful-nextjs-tutorial" rel="noopener ugc nofollow" target="_blank">https://github.com/ScreamZ/react-contentful-nextjs-tutorial</a>。</p><p id="5572" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您只需要生成内容交付和内容管理密钥，并相应地填充<code class="fe oe of og oh b">import.json</code>和<code class="fe oe of og oh b">config.json</code>，然后使用<code class="fe oe of og oh b">import.json</code>运行内容导入。如果你不知道怎么做，就看看那篇文章的第二部分。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><ul class=""><li id="aa78" class="mm mn iq kt b ku kv kx ky la nt le nu li nv lm nw mu mv mw bi translated">Contentful是一个基于云的无头CMS，它高度可扩展和强大，即使它可能有点贵。</li><li id="9b9e" class="mm mn iq kt b ku mx kx my la mz le na li nb lm nw mu mv mw bi translated">NextJS是一个基于ReactJS的SSR/static generator框架，它允许构建针对SEO和性能进行优化的强大的产品级React应用程序。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oy oz l"/></div></figure></div></div>    
</body>
</html>