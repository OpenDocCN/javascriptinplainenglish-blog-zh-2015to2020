<html>
<head>
<title>Introduction to Vue.js Directives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue.js指令简介</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/introduction-to-vue-js-directives-8bdfccefb023?source=collection_archive---------6-----------------------#2020-04-07">https://javascript.plainenglish.io/introduction-to-vue-js-directives-8bdfccefb023?source=collection_archive---------6-----------------------#2020-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3848cc9e7fc6be5a419c22c3243856b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xZKHfeCCcRPY_Rfh"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mrtonyyeung?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tony Yeung</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="df33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js是一个易于使用的web应用框架，我们可以用它来开发交互式前端应用。</p><p id="2462" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Vue.js指令操作DOM。</p><h1 id="fcd7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基础</h1><p id="2eef" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">除了使用像<code class="fe me mf mg mh b">v-for</code>和<code class="fe me mf mg mh b">v-if</code>这样的内置指令，Vue还允许我们注册或拥有自定义指令。</p><p id="33e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这对于不能用组件轻松完成的低级DOM操作很有用。</p><p id="f57f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以制作一个如下:</p><p id="d34f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/index.js</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a142" class="mq lc iq mh b gy mr ms l mt mu">Vue.directive("focus", {<br/>  inserted(el) {<br/>    el.focus();<br/>  }<br/>});</span><span id="040c" class="mq lc iq mh b gy mv ms l mt mu">const vm = new Vue({<br/>  el: "#app"<br/>});</span></pre><p id="4271" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">index.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="18e0" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae kc" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;input v-focus /&gt;<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ac97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们定义了<code class="fe me mf mg mh b">focus</code>指令，通过给它添加一个<code class="fe me mf mg mh b">v-</code>前缀来引用它。</p><p id="3267" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当DOM元素被插入DOM时,<code class="fe me mf mg mh b">focus</code>指令调用DOM元素上的<code class="fe me mf mg mh b">focus</code>。<code class="fe me mf mg mh b">inserted</code>方法是一个钩子，当应用了指令的元素被插入DOM时，它处理这种情况。</p><p id="6460" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">el</code>参数有DOM元素，这就是为什么我们可以对它调用<code class="fe me mf mg mh b">focus</code>方法。</p><p id="fb17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，当我们加载页面时，我们会看到<code class="fe me mf mg mh b">input</code>元素被聚焦。这是<code class="fe me mf mg mh b">focus</code>指令的工作。</p><p id="5a18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的代码全局注册了该指令。我们也可以在本地注册该指令，如下所示:</p><p id="9194" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/index.js</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4579" class="mq lc iq mh b gy mr ms l mt mu">const focus = {<br/>  inserted(el) {<br/>    el.focus();<br/>  }<br/>};</span><span id="835c" class="mq lc iq mh b gy mv ms l mt mu">const vm = new Vue({<br/>  el: "#app",<br/>  directives: {<br/>    focus<br/>  }<br/>});</span></pre><p id="1304" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">index.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c929" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae kc" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;input v-focus /&gt;<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="1b7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后<code class="fe me mf mg mh b">focus</code>指令将只对注册它的组件可用。</p><h1 id="cda7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">钩子函数</h1><p id="8f41" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">指令可以有以下钩子函数。它们都是可选的。</p><ul class=""><li id="4f29" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated"><code class="fe me mf mg mh b">bind</code> —仅在指令首次绑定到元素时调用一次。它用于一次性设置工作</li><li id="13e4" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">inserted</code> —当绑定元素插入其父节点时调用。它保证了父节点的存在。</li><li id="afc2" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">updarted</code> —在包含组件VNode更新之后但可能在子组件更新之前调用。VNode是虚拟DOM中的一个节点，代表虚拟节点。</li><li id="122c" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">componentUpdated</code> —当包含组件的VNode及其子组件的VNode更新时调用</li><li id="43c5" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">unbind</code> —当指令与元素解除绑定时，仅调用一次</li></ul><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/64b2b0fc6a34ee9e15910435fde05c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XPuCbfFatTXMxUaz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@meduana?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Meduana</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="db90" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">指令挂钩参数</h1><p id="c330" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">上面的挂钩接受以下参数:</p><h2 id="c515" class="mq lc iq bd ld nl nm dn lh nn no dp ll ko np nq lp ks nr ns lt kw nt nu lx nv bi translated">埃尔</h2><p id="81b3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">指令绑定到的元素。它可以用来操作DOM</p><h2 id="881e" class="mq lc iq bd ld nl nm dn lh nn no dp ll ko np nq lp ks nr ns lt kw nt nu lx nv bi translated">有约束力的</h2><p id="215e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">包含以下属性的对象:</p><ul class=""><li id="a553" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated"><code class="fe me mf mg mh b">name</code> —不带<code class="fe me mf mg mh b">v-</code>前缀的指令名称</li><li id="aab6" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">value</code> —传递给指令的值。例如，如果我们有<code class="fe me mf mg mh b">v-foo='1'</code>，那么值就是<code class="fe me mf mg mh b">1</code>。</li><li id="c263" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">oldValue</code> —前一个值。这仅适用于<code class="fe me mf mg mh b">update</code>和<code class="fe me mf mg mh b">compoentUpdated</code>。无论值是否改变，它都是可用的。</li><li id="e8d1" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">expression</code> —字符串形式的绑定表达式。例如，如果我们有<code class="fe me mf mg mh b">v-foo='1 + 2'</code>，那么它就是<code class="fe me mf mg mh b">1 + 2</code>。</li><li id="02ca" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">arg</code>—传入指令的参数。例如，如果我们有<code class="fe me mf mg mh b">v-foo:bar</code>，那么<code class="fe me mf mg mh b">arg</code>就是<code class="fe me mf mg mh b">‘bar‘</code>。</li><li id="4dc5" class="mw mx iq kf b kg nf kk ng ko nh ks ni kw nj la nb nc nd ne bi translated"><code class="fe me mf mg mh b">modifiers</code> —带有修改器的对象。如果我们有<code class="fe me mf mg mh b">v-foo.bar.baz</code>，那么它将是<code class="fe me mf mg mh b">{ bae: true, baz: true }</code>。</li></ul><p id="a2e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了<code class="fe me mf mg mh b">el</code>之外的都是只读的。</p><p id="4e91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以显示从参数传递的数据，如下所示:</p><p id="dc8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">src/index.js</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6e35" class="mq lc iq mh b gy mr ms l mt mu">const foo = {<br/>  inserted(el, binding, vnode) {<br/>    const stringify = JSON.stringify;<br/>    el.innerHTML = `<br/>      name: <br/>        ${stringify(binding.name)}<br/>      &lt;br&gt;<br/>      value:  <br/>       ${stringify(binding.value)}<br/>      &lt;br&gt;<br/>      expression:<br/>        ${stringify(binding.expression)}<br/>      &lt;br&gt;<br/>      argument<br/>       ${stringify(binding.arg)}<br/>      &lt;br&gt;<br/>      modifiers:<br/>        ${stringify(binding.modifiers)}<br/>      &lt;br&gt;<br/>      vnode keys:<br/>       ${Object.keys(vnode).join(", ")}`;<br/>  }<br/>};</span><span id="1046" class="mq lc iq mh b gy mv ms l mt mu">const vm = new Vue({<br/>  el: "#app",<br/>  directives: {<br/>    foo<br/>  }<br/>});</span></pre><p id="b8b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">index.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c3c0" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae kc" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;div v-foo:bar.baz="1 + 2"&gt;&lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="88fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8138" class="mq lc iq mh b gy mr ms l mt mu">name: "foo"<br/>value: 3<br/>expression: "1 + 2"<br/>argument "bar"<br/>modifiers: {"baz":true}<br/>vnode keys: tag, data, children, text, elm, ns, context, fnContext, fnOptions, fnScopeId, key, componentOptions, componentInstance, parent, raw, isStatic, isRootInsert, isComment, isCloned, isOnce, asyncFactory, asyncMeta, isAsyncPlaceholder</span></pre><h1 id="3da6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="44b0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以定义自己的Vue指令，通过将它们绑定到特定的DOM元素来操作DOM元素，然后运行这些元素的方法。</p><p id="de5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它通过在Vue操纵虚拟节点的某些阶段运行钩子来工作。</p><p id="415f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">钩子将DOM element对象作为第一个参数，并将一个<code class="fe me mf mg mh b">binding</code>对象作为第一个参数，该对象包含关于指令的数据，如名称、传入的值、修饰符和参数。</p><p id="1076" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来自JavaScript的简单英语提示:我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到<a class="ae kc" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">submissions@javascriptinplainenglish.com</a>给我们，我们会把你添加为作者。</p></div></div>    
</body>
</html>