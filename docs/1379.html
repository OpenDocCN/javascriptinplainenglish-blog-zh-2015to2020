<html>
<head>
<title>Easily deploy your Node.js web app using Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker轻松部署Node.js web应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/easily-deploy-your-node-js-web-app-using-docker-481959138d15?source=collection_archive---------8-----------------------#2020-03-08">https://javascript.plainenglish.io/easily-deploy-your-node-js-web-app-using-docker-481959138d15?source=collection_archive---------8-----------------------#2020-03-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="dd97" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">码头工人</h2><div class=""/><div class=""><h2 id="7dec" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">将您的应用程序容器化，使开发更容易</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/83fc9670629ef271d342b3d4517a5620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fu88IqG8NM1qiR_eCjmaIQ.png"/></div></div></figure><p id="6ba4" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">应用程序依赖性很难跟踪。</p><p id="cad6" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">Docker解决了这个问题，它让我们将一个应用程序及其所有依赖项打包到一个映像中。然后，可以将该映像作为容器部署到一台新机器上，该机器具有完全配置好的环境。</p><p id="1dc4" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">在本教程中，我们将构建一个简单的<code class="fe lt lu lv lw b">Hello World</code> Node.js web应用程序。然后，我们将添加一个docker文件，让我们定义如何安装以及安装哪些依赖项才能使应用程序正常工作的说明。使用这个文件，我们将构建一个新的Docker映像，并将其作为一个容器部署在本地机器上。</p><h1 id="6cb1" class="lx ly in bd lz ma mb mc md me mf mg mh kc mi kd mj kf mk kg ml ki mm kj mn mo bi translated">先决条件</h1><ol class=""><li id="01a1" class="mp mq in kz b la mr ld ms lg mt lk mu lo mv ls mw mx my mz bi translated"><a class="ae na" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"> Node.js </a></li><li id="1189" class="mp mq in kz b la nb ld nc lg nd lk ne lo nf ls mw mx my mz bi translated">码头工人</li></ol><h1 id="b554" class="lx ly in bd lz ma mb mc md me mf mg mh kc mi kd mj kf mk kg ml ki mm kj mn mo bi translated">创建简单的Node.js应用程序</h1><p id="d7e9" class="pw-post-body-paragraph kx ky in kz b la mr jx lc ld ms ka lf lg ng li lj lk nh lm ln lo ni lq lr ls ig bi translated">创建项目所在的目录。命名为<code class="fe lt lu lv lw b">simple-nodejs-docker</code>。</p><p id="4fb1" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">创建一个名为<code class="fe lt lu lv lw b">package.json</code>的新文件。该文件将包含对项目和所需依赖项的描述。</p><pre class="km kn ko kp gt nj lw nk nl aw nm bi"><span id="9aef" class="nn ly in lw b gy no np l nq nr">{<br/>   "name": "simple-nodejs-docker",<br/>   "version": "1.0.0",<br/>   "main": "app.js",<br/>   "dependencies": {<br/>     "express": "^4.16.3"<br/>   },<br/>   "scripts": {<br/>     "start": "node app.js"<br/>   }<br/> }</span></pre><p id="2572" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">创建一个新文件，<code class="fe lt lu lv lw b">app.js</code>。使用Express，我们将提供一个简单/端点，它将使用<code class="fe lt lu lv lw b">Hello Docker's World!</code>进行响应。</p><pre class="km kn ko kp gt nj lw nk nl aw nm bi"><span id="d21f" class="nn ly in lw b gy no np l nq nr">const express = require("express");<br/>const app = express();<br/><br/>app.get("/", (req, res) =&gt; res.send("Hello Docker's World!"));<br/>	app.listen(3000, () =&gt; {<br/>	console.log("Node.js app listening on port 3000!");<br/>});</span></pre><h1 id="f6a8" class="lx ly in bd lz ma mb mc md me mf mg mh kc mi kd mj kf mk kg ml ki mm kj mn mo bi translated">运行web应用程序</h1><p id="78d1" class="pw-post-body-paragraph kx ky in kz b la mr jx lc ld ms ka lf lg ng li lj lk nh lm ln lo ni lq lr ls ig bi translated">通过运行以下命令来安装依赖项，</p><pre class="km kn ko kp gt nj lw nk nl aw nm bi"><span id="adaa" class="nn ly in lw b gy no np l nq nr">npm install</span></pre><p id="aa7f" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">启动应用程序。</p><p id="81f6" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">该应用程序应在<a class="ae na" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>上运行</p><p id="6b8b" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">不错！让我们继续前进。</p><h1 id="7ae0" class="lx ly in bd lz ma mb mc md me mf mg mh kc mi kd mj kf mk kg ml ki mm kj mn mo bi translated">将web应用程序归档</h1><p id="be39" class="pw-post-body-paragraph kx ky in kz b la mr jx lc ld ms ka lf lg ng li lj lk nh lm ln lo ni lq lr ls ig bi translated">创建一个新文件，<code class="fe lt lu lv lw b">Dockerfile</code></p><pre class="km kn ko kp gt nj lw nk nl aw nm bi"><span id="28d4" class="nn ly in lw b gy no np l nq nr">FROM node:9-slim<br/>WORKDIR /app<br/>COPY package*.json ./<br/>RUN npm install<br/>COPY . .<br/>CMD ["npm", "start"]</span></pre><ul class=""><li id="8d46" class="mp mq in kz b la lb ld le lg ns lk nt lo nu ls nv mx my mz bi translated"><code class="fe lt lu lv lw b">FROM node:9-slim</code>:从<a class="ae na" href="https://hub.docker.com/_/node/" rel="noopener ugc nofollow" target="_blank"> DockerHub </a>中提取包含运行Node.js的最小包的基础映像。</li><li id="fdd6" class="mp mq in kz b la nb ld nc lg nd lk ne lo nf ls nv mx my mz bi translated"><code class="fe lt lu lv lw b">WORKDIR /app</code>:设置项目的工作目录。</li><li id="129e" class="mp mq in kz b la nb ld nc lg nd lk ne lo nf ls nv mx my mz bi translated"><code class="fe lt lu lv lw b">COPY package*.json /app</code>:将package.json和package-lock.json都复制到app目录下。注意，我们在不同的步骤中复制package.json和应用程序的其余部分。Docker可以缓存现有的图像层，因此如果应用程序代码发生了变化，但package.json保持不变，node_modules不会被重新安装。</li><li id="cf2c" class="mp mq in kz b la nb ld nc lg nd lk ne lo nf ls nv mx my mz bi translated"><code class="fe lt lu lv lw b">RUN npm install</code>:安装package.json中提到的包。</li><li id="b213" class="mp mq in kz b la nb ld nc lg nd lk ne lo nf ls nv mx my mz bi translated"><code class="fe lt lu lv lw b">COPY . /app</code>:将应用程序的其余部分复制到目录中。</li><li id="bc58" class="mp mq in kz b la nb ld nc lg nd lk ne lo nf ls nv mx my mz bi translated"><code class="fe lt lu lv lw b">CMD ["npm", "start"]</code>:启动应用程序。</li></ul><h1 id="59b3" class="lx ly in bd lz ma mb mc md me mf mg mh kc mi kd mj kf mk kg ml ki mm kj mn mo bi translated">构建Docker映像</h1><p id="2621" class="pw-post-body-paragraph kx ky in kz b la mr jx lc ld ms ka lf lg ng li lj lk nh lm ln lo ni lq lr ls ig bi translated">我们现在可以启动Docker并通过运行命令使用<code class="fe lt lu lv lw b">DockerFile</code>构建一个映像，</p><pre class="km kn ko kp gt nj lw nk nl aw nm bi"><span id="200b" class="nn ly in lw b gy no np l nq nr">docker build . -t sssaini/simple-docker</span></pre><p id="e6de" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">现在让我们通过运行命令将图像作为容器运行，</p><pre class="km kn ko kp gt nj lw nk nl aw nm bi"><span id="ad6b" class="nn ly in lw b gy no np l nq nr">docker run -p 3001:3000 sssaini/simple-docker</span></pre><p id="a388" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">如果一切顺利，我们的应用程序应该在<a class="ae na" href="http://localhost:3001" rel="noopener ugc nofollow" target="_blank"> http://localhost:3001 </a>上运行。</p><h1 id="a2c7" class="lx ly in bd lz ma mb mc md me mf mg mh kc mi kd mj kf mk kg ml ki mm kj mn mo bi translated">后续步骤</h1><p id="c26a" class="pw-post-body-paragraph kx ky in kz b la mr jx lc ld ms ka lf lg ng li lj lk nh lm ln lo ni lq lr ls ig bi translated">在本教程中，我们创建了一个简单的node.js web应用程序，并将其封装成一个轻量级Docker映像。然后，我们将该映像作为容器部署在本地机器上。</p><p id="3776" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">在接下来的步骤中，我们可以将这个图像上传到<a class="ae na" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub仓库</a>供以后使用。</p><p id="caa1" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">在<a class="ae na" href="https://twitter.com/sssaini_" rel="noopener ugc nofollow" target="_blank">推特</a>上找到我，我们聊聊:)</p></div><div class="ab cl nw nx hr ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ig ih ii ij ik"><p id="0d06" class="pw-post-body-paragraph kx ky in kz b la lb jx lc ld le ka lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated"><em class="od">原载于2020年3月8日</em><a class="ae na" href="https://saasbase.dev/deploy-your-node-js-web-using-docker/" rel="noopener ugc nofollow" target="_blank"><em class="od">https://SaaS base . dev</em></a><em class="od">。</em></p></div></div>    
</body>
</html>