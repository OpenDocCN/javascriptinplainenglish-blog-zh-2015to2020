<html>
<head>
<title>Pass Dependencies to a Factory Provider in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Angular中将依赖项传递给工厂提供者</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/pass-dependencies-to-a-factory-provider-in-angular-9073502cae4?source=collection_archive---------3-----------------------#2020-07-11">https://javascript.plainenglish.io/pass-dependencies-to-a-factory-provider-in-angular-9073502cae4?source=collection_archive---------3-----------------------#2020-07-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="88f6" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">需要将其他服务作为依赖项传递给工厂提供者吗？</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/ce39f6e89c1286c17357257272de886f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RmArQPDsgbKwUKGP.png"/></div></div></figure><p id="27bc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你直接来看这篇文章，这是上一篇关于“我们如何使用Angular Factory Provider实例化服务”的文章。</p><div class="lk ll gp gr lm ln"><a href="https://medium.com/@hengky.kaiqi/instantiate-a-service-using-an-angular-factory-provider-38670aea4a94" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">使用角度工厂提供者实例化服务</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">需要在服务中通过构造函数注入一个变量？</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb km ln"/></div></div></a></div><p id="1c71" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文中，我们将继续讨论Angular Factory Provider，并回答您的问题“我们需要将其他服务作为依赖项传递给工厂提供者怎么样？”</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="a7fd" class="mj mk in bd ml mm mn mo mp mq mr ms mt jt mu ju mv jw mw jx mx jz my ka mz na bi translated">咖啡时间</h1><p id="e69a" class="pw-post-body-paragraph ko kp in kq b kr nb jo kt ku nc jr kw kx nd kz la lb ne ld le lf nf lh li lj ig bi translated">首先，让我们做些伸展运动，并喝杯咖啡😃</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/385491c61ea00b7818bb5c35b40f9cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WzkE3kGkqe0Byfrd"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><a class="ae nl" href="https://www.pexels.com/photo/beverage-break-breakfast-brown-414630/" rel="noopener ugc nofollow" target="_blank">pexels.com</a></figcaption></figure><p id="5b5a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">完成了吗？我们走吧！</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="4937" class="mj mk in bd ml mm mn mo mp mq mr ms mt jt mu ju mv jw mw jx mx jz my ka mz na bi translated">问题</h1><p id="d4a5" class="pw-post-body-paragraph ko kp in kq b kr nb jo kt ku nc jr kw kx nd kz la lb ne ld le lf nf lh li lj ig bi translated">这里，我们有一个<em class="nm"> LoggerService </em>，它实现了一个简单的日志消息，并在构造函数中添加了一个变量(<em class="nm"> isEnabled </em>)来控制我们的日志功能是否启用。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/6a5d8c2f0c7288d2d30175af8f1c4637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*No8WUiqGMc5z_7rf152JHQ.png"/></div></div></figure><p id="73ca" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们使用<em class="nm"> useFactory </em>属性和<em class="nm"> loggerFactory </em>函数来实例化<em class="nm"> LoggerService </em>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/a57ca100617af049e8eb24d877ffba57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-I-PeK-_z7uVh30pfhbWNw.png"/></div></div></figure><p id="7596" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">那么问题是，如果我们需要将另一个服务作为依赖项传递给<em class="nm"> LoggerService </em>怎么办？</p><p id="8b2f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">假设我们有另一个名为<em class="nm">message formatter</em><strong class="kq io"><em class="nm">的服务。</em> </strong>这个依赖项允许我们格式化我们的日志记录消息，获取消息和日志记录类型，然后它将作为字符串输出返回。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/11a211314d93e126e69fa6b3aadf1b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__hY_4ln3d1lc8mjGCw7ow.png"/></div></div></figure><p id="daa9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我们转到app.module.ts，用Angular的依赖注入机制注册我们的<em class="nm"> MessageFormatter </em>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/08785c8cd2dd9e9f2d5397dc48a72d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cn11-Dfmf65I1JsKybuwCw.png"/></div></div></figure><p id="ff24" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，让我们在我们的<em class="nm"> LoggerService中使用<em class="nm"> MessageFormatter </em>。</em></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nr"><img src="../Images/14dea37ff95bed13a12ed0362d441e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SLxnx34uKal4zclWbTBuVg.png"/></div></div></figure><p id="8a54" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，如果我们运行这个程序，我们将得到一个错误“没有为' messageFormatter '提供一个参数。”因为我们的<em class="nm"> FactoryProvider </em>函数只接受一个布尔值(<em class="nm"> isEnabled </em>)。</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="6f28" class="mj mk in bd ml mm mn mo mp mq mr ms mt jt mu ju mv jw mw jx mx jz my ka mz na bi translated">解决方案1</h1><p id="ec2c" class="pw-post-body-paragraph ko kp in kq b kr nb jo kt ku nc jr kw kx nd kz la lb ne ld le lf nf lh li lj ig bi translated">然后我们需要扩展我们的<em class="nm"> FactoryProvider </em>函数来传递我们的<em class="nm">message formatter</em><strong class="kq io"><em class="nm">的实例。</em> </strong></p><p id="1b59" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们可以像这样直接在工厂函数中实例化对象。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ns"><img src="../Images/e83418fa2c551f2a5d8459ab7a45242b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pB5qOK0zDcIL4UpBMwbShA.png"/></div></div></figure><p id="af98" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是，如果我们这样做，我们就不会在Angular中实现依赖注入机制。</p><p id="6df6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后呢？怎么会？🤔</p></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="7ac7" class="mj mk in bd ml mm mn mo mp mq mr ms mt jt mu ju mv jw mw jx mx jz my ka mz na bi translated">解决方案2</h1><p id="a46d" class="pw-post-body-paragraph ko kp in kq b kr nb jo kt ku nc jr kw kx nd kz la lb ne ld le lf nf lh li lj ig bi translated">我们可以这样注射它:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ns"><img src="../Images/384fe46667823fd00272edea270bec47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oX62AiW_1zCtNS6jGL_u4A.png"/></div></div></figure><p id="1783" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了告诉角度依赖注入器注入该依赖，我们需要定义如下所示的<strong class="kq io"> <em class="nm"> deps </em> </strong>属性:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ns"><img src="../Images/c55dc768053fe9b7af80fd8602c03ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkmTQmsrn3JV_sQ_mGEBqg.png"/></div></div></figure><p id="c9ae" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">所以基本上，我们的<em class="nm"> FactoryProvider </em>函数接受参数的数量，在这里，在<strong class="kq io"> <em class="nm"> deps </em> </strong>属性中，我们可以指定一个应该传递给我们的工厂函数的依赖数组。</p><p id="45eb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果我们保存它，现在我们可以看到这样的控制台日志输出</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/5e480f973e6594a44f087bb2cfe98909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LMGxRXWOE6UQ_YVsTX9VjA.png"/></div></div></figure></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><h1 id="7f85" class="mj mk in bd ml mm mn mo mp mq mr ms mt jt mu ju mv jw mw jx mx jz my ka mz na bi translated">编码</h1><p id="24a1" class="pw-post-body-paragraph ko kp in kq b kr nb jo kt ku nc jr kw kx nd kz la lb ne ld le lf nf lh li lj ig bi translated">如果你想看完整的代码，你可以去我的GitHub仓库的分支"<a class="ae nl" href="https://github.com/hengkysanjaya123/angular-factory-provider/tree/pass-dependencies-to-factory-provider" rel="noopener ugc nofollow" target="_blank">传递依赖关系到工厂提供者</a>"</p><div class="lk ll gp gr lm ln"><a href="https://github.com/hengkysanjaya123/angular-factory-provider/tree/pass-dependencies-to-factory-provider" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd io gy z fp ls fr fs lt fu fw im bi translated">hengkysanjaya 123/角度-工厂-提供商</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">此项目是使用Angular CLI版本9.1.10生成的。为开发服务器运行ng serve。导航到…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">github.com</p></div></div><div class="lw l"><div class="nu l ly lz ma lw mb km ln"/></div></div></a></div></div><div class="ab cl mc md hr me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ig ih ii ij ik"><p id="80b2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">谢谢大家！我希望你能从这篇文章中找到一些新的见解😀</p><p id="9d56" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">干杯，</p><p id="10b1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">亨基·桑佳亚</p></div></div>    
</body>
</html>