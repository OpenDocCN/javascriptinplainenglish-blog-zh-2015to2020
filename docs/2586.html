<html>
<head>
<title>JavaScript Tips — Errors, Auto-Resizing Text Area, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript提示-错误、自动调整文本区域大小等</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-tips-errors-auto-resizing-text-area-and-more-8e5d56cf037a?source=collection_archive---------15-----------------------#2020-07-06">https://javascript.plainenglish.io/javascript-tips-errors-auto-resizing-text-area-and-more-8e5d56cf037a?source=collection_archive---------15-----------------------#2020-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e2a77370295ac162f9c15bec8fc3ca53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XKZf0aRaNgYd49AL"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@sool_lorieto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Soledad Lorieto</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e23a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="c031" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">替换字符串中的所有逗号</h1><p id="4b2b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">replace</code>方法替换字符串中的所有逗号。</p><p id="0506" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="12c1" class="mq lc iq mh b gy mr ms l mt mu">const str = 'foo,bar,baz';<br/>const newStr = str.replace(/,/g, '-');</span></pre><p id="1bb9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">newStr</code>就是<code class="fe me mf mg mh b">“foo-bar-baz”</code>。</p><h1 id="dc29" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">扩展JavaScript中错误的好方法？</h1><p id="d7ab" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">extends</code>关键字扩展<code class="fe me mf mg mh b">Error</code>类。</p><p id="ff24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7c88" class="mq lc iq mh b gy mr ms l mt mu">class SpecialError extends Error {<br/>  constructor(message) {<br/>    super(message);<br/>    this.name = 'special error';<br/>  }<br/>}</span></pre><p id="6230" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了一个<code class="fe me mf mg mh b">SpecialError</code>类，它继承了<code class="fe me mf mg mh b">Error</code>类。</p><p id="17d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以设置自己的<code class="fe me mf mg mh b">name</code>以区别于<code class="fe me mf mg mh b">Error</code>实例。</p><h1 id="8954" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用逗号将字符串转换为数组</h1><p id="9381" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">split</code>方法将带逗号的字符串转换成数组。</p><p id="0bb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写作；</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dd86" class="mq lc iq mh b gy mr ms l mt mu">const string = "1,2,3";<br/>const array = string.split(",");<br/>console.log(array);</span></pre><p id="460e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个<code class="fe me mf mg mh b">string</code>，我们称之为<code class="fe me mf mg mh b">split</code>，用逗号将字符串分割成一个数组。</p><h1 id="470d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加或更新查询字符串参数</h1><p id="30bb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要添加或更新查询字符串参数，可以使用该查询字符串创建<code class="fe me mf mg mh b">URLSearchParams</code>实例。</p><p id="12fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用键和值在上面调用<code class="fe me mf mg mh b">set</code>来设置参数。</p><p id="f80a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1a69" class="mq lc iq mh b gy mr ms l mt mu">const searchParams = new URLSearchParams(window.location.search)<br/>searchParams.set("foo", "baz");<br/>const newURL = `${window.location.pathname}?${searchParams.toString()}`;<br/>history.pushState(null, '', newURL);</span></pre><p id="bf8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在浏览器搜索栏中用<code class="fe me mf mg mh b">window.location.search</code>得到查询字符串。</p><p id="0a19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用它的键和值来调用<code class="fe me mf mg mh b">set</code>。</p><p id="93a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们通过调用<code class="fe me mf mg mh b">URLSearchParams</code>实例上的<code class="fe me mf mg mh b">toString</code>得到查询字符串。</p><p id="8a4f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将路径名和查询字符串结合在一起。</p><p id="e238" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用新的URL调用<code class="fe me mf mg mh b">pushState</code>来用新的查询字符串重新加载页面。</p><h1 id="31b9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在新窗口而不是选项卡中打开网址</h1><p id="078c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了总是在新窗口而不是标签中打开一个URL，我们可以将第三个参数传递给<code class="fe me mf mg mh b">window.open</code>窗口的宽度和高度。</p><p id="2d84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6be2" class="mq lc iq mh b gy mr ms l mt mu">window.open(url, '_blank', "height=200,width=200");</span></pre><p id="460d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三个参数有窗口的规格。</p><h1 id="ec7f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">检查变量是否为数字</h1><p id="5280" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过<code class="fe me mf mg mh b">isNaN</code>和<code class="fe me mf mg mh b">isFinite</code>功能来检查变量是否是数字。</p><p id="4d21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b849" class="mq lc iq mh b gy mr ms l mt mu">!isNaN(parseFloat(num)) &amp;&amp; isFinite(num);</span></pre><p id="d782" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">parseFloat</code>试图将<code class="fe me mf mg mh b">num</code>解析成一个浮点数。</p><p id="d3b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用<code class="fe me mf mg mh b">isNaN</code>来检查返回值。</p><p id="018e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还通过<code class="fe me mf mg mh b">num</code>到<code class="fe me mf mg mh b">isFinite</code>来检查这一点。</p><p id="f19f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果两个表达式都是<code class="fe me mf mg mh b">true</code>，那么我们知道我们得到了一个有限的数。</p><h1 id="8e6c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">创建自动调整大小的文本区域</h1><p id="78f6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了创建一个自动调整大小的文本区域，我们可以监听输入事件。</p><p id="9467" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以将输入事件监听器中文本区域的高度设置为<code class="fe me mf mg mh b">scrollHeight</code>加12个像素。</p><p id="ed97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">scrollHeight</code>获取文本的全高。</p><p id="5d31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="35a1" class="mq lc iq mh b gy mr ms l mt mu">&lt;textarea&gt;&lt;/textarea&gt;</span></pre><p id="e9ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建文本区域。</p><p id="61e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a2ff" class="mq lc iq mh b gy mr ms l mt mu">function resizeTextarea(ev) {<br/>  this.style.height = 'auto';<br/>  this.style.height = `${this.scrollHeight}px`;<br/>}<br/>const textArea = document.querySelector('textarea');<br/>textArea.addEventListener('keyup', resizeTextarea);</span></pre><p id="13dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">'auto'</code>将高度重置为原始高度。</p><p id="a597" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将高度设置为<code class="fe me mf mg mh b">scrollheight </code>，使其成为文本的高度。</p><h1 id="62d3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为什么我们不应该使用document.write？</h1><p id="c38a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该使用<code class="fe me mf mg mh b">document.write</code>在屏幕上渲染HTML。</p><p id="2f6c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它不适用于XHTML。</p><p id="800e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它在页面完成加载并覆盖页面后运行。</p><p id="8320" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它会在遇到它的地方运行。</p><p id="02de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它不像我们处理DOM那样写内容，而且很容易产生错误，因为我们是在页面上写字符串的内容。</p><p id="5ab1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们不应该使用<code class="fe me mf mg mh b">document.write</code>将内容写到屏幕上。</p><h1 id="faa8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">检查URL是否有给定的字符串</h1><p id="1c21" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在<code class="fe me mf mg mh b">window.location.href</code>上使用<code class="fe me mf mg mh b">indexOf</code>方法来检查URL是否包含给定的字符串。</p><p id="d959" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5542" class="mq lc iq mh b gy mr ms l mt mu">window.location.href.indexOf("foo") &gt; -1</span></pre><p id="bba5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查<code class="fe me mf mg mh b">'foo'</code>是否在当前页面的URL中。</p><p id="e989" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果返回值是-1，这意味着它不在URL中。</p><p id="b41f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，它就在URL中。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/457bbf4e4063fae0788371c7b87ec444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f_lgnGAidfZQgBHw"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@dibert?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">David Dibert</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="a59b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="e8bb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">URLSearchParams</code>构造函数来解析和操作查询字符串。</p><p id="3350" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">window.open</code>可以打开一个新窗口。</p><p id="40f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">Error</code>构造函数可以用子类扩展。</p><h2 id="3905" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">简单英语的JavaScript</h2><p id="1431" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？在<a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">plain English . io</strong></a>和<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">找到它们订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>