<html>
<head>
<title>Best way to trace Errors in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">跟踪角度误差的最佳方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/best-way-to-trace-errors-in-angular-632bdc40421a?source=collection_archive---------11-----------------------#2020-05-18">https://javascript.plainenglish.io/best-way-to-trace-errors-in-angular-632bdc40421a?source=collection_archive---------11-----------------------#2020-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/01193da54e4f092a97ab3f8d06433e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqRmb78S_0TMCEqk9AKDWw.jpeg"/></div></div></figure><p id="3d0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当构建健壮且无错误的web应用程序时，处理错误是必不可少的。开发团队必须跟踪在生产或开发阶段发生的所有错误。为了做到这一点，应用程序必须有一些日志记录功能，比如向API发送错误。</p><p id="9f36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大多数日志记录都是手动完成的。我们将我们的功能打包到try-catch块或一些异步错误回调中，捕获异常并将其发送到服务器。</p><p id="3dd8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">也许这个解决方案管用。这确实是浪费时间，而且还有很高的风险，有人会忘记跟踪错误。</p><p id="f511" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文中，我将向您展示全局错误跟踪程序，它在内部使用自身来向我们显示错误消息。<a class="ae kw" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular Docs </a>中没有记载，我在挖掘Angular源代码的时候偶然发现了它。</p><h1 id="4f33" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">错误处理程序类</strong></h1><p id="5fa6" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在角度源代码里面有一个叫做<code class="fe ma mb mc md b"><a class="ae kw" href="https://github.com/angular/angular/blob/master/packages/core/src/error_handler.ts" rel="noopener ugc nofollow" target="_blank">error_handler</a></code>的类。它有一个单一的责任，记录每一个发生在角度应用程序内部的错误。</p><p id="f5b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每当应用程序内部发生错误时(错误的HTTP请求，字段未定义等)。)，由Angular Core本身捕获一个错误，并使用<code class="fe ma mb mc md b">error_handler</code>类将其记录到控制台中。</p><p id="8c91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe ma mb mc md b">error_handler</code>类由Angular DI(依赖注入)创建。因此，Angular注入，这个类本身，就像我们在Component中注入一些服务一样。这就是为什么我们可以提供自己的<code class="fe ma mb mc md b">MyErrorHandler</code>类，并将其附加到<code class="fe ma mb mc md b">ErrorHandler</code>提供商。</p><h1 id="3172" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">我的错误处理器</h1><p id="84bc" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">让我们创建一个名为<code class="fe ma mb mc md b">MyErrorHandler</code>的类(名称可以是任何东西)，并在那里定义<code class="fe ma mb mc md b">handleError(error:any)</code>方法。</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="009f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后将其添加到<code class="fe ma mb mc md b">HandleError</code>提供程序，而不是本地的<code class="fe ma mb mc md b">error_handler</code>类。</p><p id="c8c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://gist.github.com/lukaonik/aa3ecd528459fcc83e52d5b6280a11a8" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/luka onik/aa 3 ECD 528459 FCC 83 e 52 D5 b 6280 a 11 a 8</a></p><p id="82c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，当Angular将注入<code class="fe ma mb mc md b">ErrorHandler</code>类时，它将得到我们的<code class="fe ma mb mc md b">MyErrorHandler</code>实例，并且所有人都将调用我们的定制函数，而不是本地函数。</p><h2 id="8da1" class="mk ky iq bd kz ml mm dn ld mn mo dp lh kj mp mq ll kn mr ms lp kr mt mu lt mv bi translated">增强功能</h2><p id="185d" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">如果我们处于生产环境中，我们还可以向服务器发送错误，如果我们处于开发阶段，则在控制台中输出错误。我们所要做的就是，继承原生的<code class="fe ma mb mc md b">error_handler</code>类，如果我们处于开发模式，就调用它的<code class="fe ma mb mc md b">handleError</code>方法</p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h2 id="e061" class="mk ky iq bd kz ml mm dn ld mn mo dp lh kj mp mq ll kn mr ms lp kr mt mu lt mv bi translated">来自简明英语团队的说明</h2><p id="1514" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae kw" href="https://plainenglish.io" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> plainenglish.io </strong> </a>上找到所有这些——关注我们的出版物并<a class="ae kw" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">订阅我们的YouTube频道</strong> </a> <strong class="ka ir">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>