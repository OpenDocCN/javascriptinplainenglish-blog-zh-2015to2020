<html>
<head>
<title>How to use the latest JavaScript features in any browser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在任何浏览器中使用最新的JavaScript特性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-the-latest-javascript-features-in-any-browser-f047f5c426a8?source=collection_archive---------5-----------------------#2020-03-26">https://javascript.plainenglish.io/use-the-latest-javascript-features-in-any-browser-f047f5c426a8?source=collection_archive---------5-----------------------#2020-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3650" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">实用介绍，从聚合填充到传输填充</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/26215bb8e356f6ccd3499a05916b97e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gTFV4inx3uD5192A9EiGwA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo of Lukas in Pexels showing a keyboard and two closed fists</figcaption></figure><p id="2938" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">JavaScript是一种发展非常迅速的语言，有时我们想使用它的最新功能，但是如果我们的浏览器或环境不直接允许，我们将不得不转换它，以便它可以做到这一点。</p><p id="ebfb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Transpiling是将一种语言编写的源代码转换成另一种具有可比抽象级别的语言。因此，在JavaScript的情况下，transpiler采用旧浏览器不理解的语法，并将它们转换成它们理解的语法。</p><h2 id="a85b" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">聚合填充与传输填充</h2><p id="27a7" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这两种方法的目的是一样的:我们可以编写代码，使用我们的目标环境中没有实现的新特性，然后应用上述过程之一。</p><p id="196b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">聚合填充是代码或工作区的一部分，其中对现代功能进行了编码，以便在旧版本的浏览器上运行。</p><p id="6a33" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Transpiling是两个词的组合:转换和编译。有时，较新的语法不能用polyfills复制，这里是我们使用transpiler的地方。</p><p id="e2d2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设我们使用的是不支持ES6规范中引入的Number.isNaN特性的旧浏览器。要使用此功能，我们需要为该方法创建一个polyfill，但我们只希望在浏览器上还没有polyfill时构建它。</p><p id="4da4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，我们将创建一个模拟isNaN功能行为的函数，并将其添加到Number prototype属性中。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="ae12" class="lr ls iq mq b gy mu mv l mw mx">//Simulates the isNaN feature<br/>if (!Number.isNan) {//not already available.<br/>    Number.prototype.isNaN = function isNaN(n) {<br/>        return n !== n;<br/>    };<br/>}</span><span id="71fb" class="lr ls iq mq b gy my mv l mw mx">let myNumber = 100;<br/>console.log(myNumber.isNaN(100));</span></pre><p id="c743" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们将为一个新发明的特性转换代码，在这个特性中，我们将假设大多数浏览器不能执行它，在这种情况下，我们不能创建一个polyfill来模拟这个行为。我们希望在internet explorer 11上运行以下代码，因此我们将使用transpiler对其进行转换:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f246" class="lr ls iq mq b gy mu mv l mw mx">class mySuperClass {<br/>  constructor(name) {<br/>    this.name = name;<br/>  }</span><span id="aa81" class="lr ls iq mq b gy my mv l mw mx">hello() {<br/>    return "Hello:" +this.name;<br/>  }<br/>}</span><span id="1e03" class="lr ls iq mq b gy my mv l mw mx">const mySuperClassInstance = new mySuperClass("Rick");<br/>console.log(mySuperClassInstance.hello()); <br/>//Hello Rick</span></pre><p id="8ba4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">结果代码已经用<a class="ae mz" href="https://babeljs.io/en/repl" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">巴别塔在线传输器</strong></a><strong class="kx ir"/>传输，现在，<strong class="kx ir"> </strong>我们可以在internet explorer 11:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="859b" class="lr ls iq mq b gy mu mv l mw mx">"use strict";</span><span id="2a3b" class="lr ls iq mq b gy my mv l mw mx">function _instanceof(left, right) { if (right != null &amp;&amp; typeof Symbol !== "undefined" &amp;&amp; right[Symbol.hasInstance]) { return !!right[Symbol.hasInstance](left); } else { return left instanceof right; } }</span><span id="d8b6" class="lr ls iq mq b gy my mv l mw mx">function _classCallCheck(instance, Constructor) { if (!_instanceof(instance, Constructor)) { throw new TypeError("Cannot call a class as a function"); } }</span><span id="8b76" class="lr ls iq mq b gy my mv l mw mx">function _defineProperties(target, props) { for (var i = 0; i &lt; props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }</span><span id="89c9" class="lr ls iq mq b gy my mv l mw mx">function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }</span><span id="2482" class="lr ls iq mq b gy my mv l mw mx">var mySuperClass = /*#__PURE__*/function () {<br/>  function mySuperClass(name) {<br/>    _classCallCheck(this, mySuperClass);</span><span id="bc6b" class="lr ls iq mq b gy my mv l mw mx">this.name = name;<br/>  }</span><span id="4602" class="lr ls iq mq b gy my mv l mw mx">_createClass(mySuperClass, [{<br/>    key: "hello",<br/>    value: function hello() {<br/>      return "Hello:" + this.name;<br/>    }<br/>  }]);</span><span id="3de7" class="lr ls iq mq b gy my mv l mw mx">return mySuperClass;<br/>}();</span><span id="6fda" class="lr ls iq mq b gy my mv l mw mx">var mySuperClassInstance = new mySuperClass("Rick");<br/>console.log(mySuperClassInstance.hello()); //Hello Rick</span></pre><p id="a4cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">JavaScript最常见的transpilers之一是Babel。Babel是一个帮助在不同版本的JavaScript之间进行编译的工具，可以通过节点包管理器(npm)安装。</p><p id="6f45" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Babel已经成为将ECMAScript应用程序编译成ECMAScript版本的标准，该版本可以在不支持ECMAScript应用程序的浏览器中运行。Babel可以编译ECMAScript的其他版本，如React JSX。</p><p id="4216" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在接下来的步骤中，我们将看到如何使用Babel在安装了旧Nodejs的Linux机器上转换和执行前面的“mySuperMethod”类。在Windows 10或macOS等其他操作系统中，在接下来的步骤中，我们将看到如何使用Babel在安装了旧Nodejs的Linux机器中转换和执行之前的“mySuperMethod”类。在Windows 10或macOS等其他操作系统中，要遵循的步骤类似。</p><p id="ec4a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:<em class="na">你需要在你的机器上安装</em> <a class="ae mz" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> <em class="na"> Node.js </em> </a> <em class="na">。pm是作为Node.js安装程序中的一个特性添加的</em></p><ol class=""><li id="37e0" class="nb nc iq kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated">打开命令行，创建一个名为babelExample的目录:</li></ol><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="2353" class="lr ls iq mq b gy mu mv l mw mx">/mkdir babelExample<br/>/cd babelExample</span></pre><p id="9b05" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.创建一个<a class="ae mz" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>项目，并保留默认值。以下命令将创建一个名为package.json的文件:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="41bc" class="lr ls iq mq b gy mu mv l mw mx"><a class="ae mz" href="https://docs.npmjs.com/cli/init" rel="noopener ugc nofollow" target="_blank">npm init</a></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/79f57d9152ff188f424935d1766c86b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*9Vr8T71sWnkXpMEeFeuwSw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">package.json file image after executing the npm init command</figcaption></figure><p id="c81b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里“index.js”(可以是另一个)是我们应用程序的入口点。在这里，我们将放入javascript代码，因此创建一个index.js文件并放入以下代码:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="9c47" class="lr ls iq mq b gy mu mv l mw mx">class mySuperClass {<br/>  constructor(name) {<br/>    this.name = name;<br/>  }</span><span id="84c4" class="lr ls iq mq b gy my mv l mw mx">hello() {<br/>    return "Hello:" +this.name;<br/>  }<br/>}</span><span id="0a9f" class="lr ls iq mq b gy my mv l mw mx">const mySuperClassInstance = new mySuperClass("Rick");<br/>console.log(mySuperClassInstance.hello()); <br/>//Hello Rick</span></pre><p id="3a22" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.虽然我们可以在全球范围内安装Babel CLI，但最好是在本地逐个项目地安装。下一个命令将添加node_modules目录，并修改package.json文件以添加Babel的依赖项:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="aee8" class="lr ls iq mq b gy mu mv l mw mx">npm install -save-dev @babel/core @babel/cli</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/50457b757315da5998eb54b6363f162c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*dp_jnVa5YeBAPp1MDg-zWQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">package.json image with babel dependencies</figcaption></figure><p id="7982" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.将. babelrc配置文件添加到项目根文件夹中，并启用es 2015+转换插件。</p><p id="3058" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:<em class="na">在Babel中，每个变压器都是一个插件，我们可以单独安装。每个预设都是相关插件的集合。使用一个</em> <strong class="kx ir"> <em class="na">预置的</em> </strong> <em class="na">，我们就不用独立安装更新几十个插件了。</em></p><p id="e3e0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为所有ES6功能安装预设(包含一组插件):</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="687b" class="lr ls iq mq b gy mu mv l mw mx">npm install @babel/preset-env --save-dev</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/f62900779473ee04e3926c48abc3a174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*pWq8uX0turri10aG-TXaIw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">package.json image with babel preset-env dependency</figcaption></figure><p id="f9e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">编辑您的。babelrc文件，并添加以下配置，这将为ES6启用转换。</p><p id="2179" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">。babelrc文件:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="034c" class="lr ls iq mq b gy mu mv l mw mx">{<br/>  "presets": ["@babel/preset-env"]<br/>}</span></pre><p id="1244" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">5.使用</p><p id="e0b4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:<em class="na">如果你使用的是Windows 10 PowerShell，对你的文件进行编码时要小心，因为运行Babel时可能会出现解析错误。建议文件的编码为UTF-8。</em></p><ul class=""><li id="ce09" class="nb nc iq kx b ky kz lb lc le nd li ne lm nf lq nn nh ni nj bi translated">in: index.js</li><li id="076c" class="nb nc iq kx b ky no lb np le nq li nr lm ns lq nn nh ni nj bi translated">out:out文件夹(Babel将在这里留下传输的文件)</li></ul><p id="768a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">直接在控制台中执行下一个命令:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="b55f" class="lr ls iq mq b gy mu mv l mw mx">./node_modules/.bin/babel index.js -d out</span></pre><p id="1615" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">npm脚本将下面一行添加到package.json文件中:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="014e" class="lr ls iq mq b gy mu mv l mw mx">"build": "babel index.js -d out"</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0b30bc95d3199082162b6cb57b2b29ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*IAlvZL-QsbkAhrB2ayu9LA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image of package.json after adding the build script</figcaption></figure><p id="3ce7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">执行以下命令:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c478" class="lr ls iq mq b gy mu mv l mw mx">npm run build</span></pre><p id="73f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这两种情况下，您都可以在/out文件夹中获得已传输的文件，以便在不支持ES6类语法的浏览器中工作:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="7043" class="lr ls iq mq b gy mu mv l mw mx">"use strict";</span><span id="deb5" class="lr ls iq mq b gy my mv l mw mx">function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }</span><span id="eba7" class="lr ls iq mq b gy my mv l mw mx">function _defineProperties(target, props) { for (var i = 0; i &lt; props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }</span><span id="9899" class="lr ls iq mq b gy my mv l mw mx">function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }</span><span id="951e" class="lr ls iq mq b gy my mv l mw mx">var mySuperClass = /*#__PURE__*/function () {<br/>  function mySuperClass(name) {<br/>    _classCallCheck(this, mySuperClass);</span><span id="af78" class="lr ls iq mq b gy my mv l mw mx">this.name = name;<br/>  }</span><span id="006f" class="lr ls iq mq b gy my mv l mw mx">_createClass(mySuperClass, [{<br/>    key: "hello",<br/>    value: function hello() {<br/>      return "Hello:" + this.name;<br/>    }<br/>  }]);</span><span id="7aea" class="lr ls iq mq b gy my mv l mw mx">return mySuperClass;<br/>}();</span><span id="7ddb" class="lr ls iq mq b gy my mv l mw mx">var mySuperClassInstance = new mySuperClass("Rick");</span><span id="6dcf" class="lr ls iq mq b gy my mv l mw mx">console.log(mySuperClassInstance.hello());</span></pre><p id="d4a8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">结论</strong></p><p id="a194" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">JavaScript语言在不断变化，多亏了这些工具，我们可以编写具有新语法和新功能的代码，这些新功能尚未被所有浏览器版本实现。</p><p id="b653" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我希望你喜欢这篇文章。谢谢你阅读我。</p></div></div>    
</body>
</html>