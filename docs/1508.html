<html>
<head>
<title>How to get up and running with Cypress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何开始使用Cypress</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/cypress-setup-boiler-plate-1eb566502bb6?source=collection_archive---------5-----------------------#2020-03-25">https://javascript.plainenglish.io/cypress-setup-boiler-plate-1eb566502bb6?source=collection_archive---------5-----------------------#2020-03-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e533" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">自动化测试的下一件大事</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9ea53b68e117d08f7dfc7689d5ddd599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u__EtvCDDIds41F3"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e5f2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们从cypress.io自己的口号开始这个故事</p><blockquote class="lp lq lr"><p id="ebe3" class="kt ku ls kv b kw kx jo ky kz la jr lb lt ld le lf lu lh li lj lv ll lm ln lo ig bi translated">网络已经进化了。<br/>终于，检测也有了。</p></blockquote><p id="7a4a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我真的相信cypress作为一个框架是近几年来自动化测试领域发生的最美妙的事情之一。它是企业采用的最具成长性的端到端测试框架之一。</p><p id="d5d1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">快速阅读它是如何工作的—<a class="ae ks" href="https://www.cypress.io/how-it-works" rel="noopener ugc nofollow" target="_blank">https://www.cypress.io/how-it-works</a></p><p id="b6dc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">尽管cypress已经提供了非常好的文档，但我对本文的想法是提供boiler plate setup来开始一个框架，而不是原生的cypress测试。</p><p id="bcfe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">涵盖本文中的以下主题:</p><ul class=""><li id="6d68" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated">视频/截图配置</li><li id="84f2" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">摩卡牛逼记者</li><li id="9ded" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">柏树仪表板</li><li id="fc5c" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">Github集成</li><li id="eb6e" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">CICD码头工人</li><li id="de64" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">珀西的视觉测试</li><li id="a0c6" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">主题</li></ul><h2 id="272b" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated"><strong class="ak">快速柏树设置</strong></h2><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="f3e1" class="mk ml in ne b gy ni nj l nk nl">mkdir cypress-boiler-plate &amp;&amp; cd cypress-boiler-plate<br/>npm init -y<br/>npm i cypress<br/>npx cypress open<br/>npx cypress run </span></pre><h2 id="ca89" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated"><a class="ae ks" href="https://docs.cypress.io/guides/references/configuration.html#Global" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">视频/截图配置</strong> </a></h2><p id="d9a4" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">如果在<code class="fe nr ns nt ne b">cypress.json</code>中没有指定，视频和截图的默认路径分别是<code class="fe nr ns nt ne b">cypress/videos</code>和<code class="fe nr ns nt ne b">cypress/screenshots</code></p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="bb79" class="mk ml in ne b gy ni nj l nk nl">cypress.json -&gt;</span><span id="2374" class="mk ml in ne b gy nu nj l nk nl">{<br/>    "screenshotsFolder": "screenshots", <br/>    "videosFolder": "videos"<br/>}</span></pre><p id="5fa7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这将在<code class="fe nr ns nt ne b">cypress-boiler-plate</code>和<code class="fe nr ns nt ne b">screenshots</code>下创建<code class="fe nr ns nt ne b">videos</code>目录，以防测试中出现任何故障或<code class="fe nr ns nt ne b">cy.screenshot()</code>。默认情况下<code class="fe nr ns nt ne b">misc.spec.js</code>带有<code class="fe nr ns nt ne b">cy.screenshot()</code>。</p><h2 id="51d1" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated"><strong class="ak">摩卡牛逼记者</strong></h2><p id="0592" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">上面的执行将在终端上显示测试结果。可以利用<a class="ae ks" href="https://mochajs.org/#reporters" rel="noopener ugc nofollow" target="_blank">摩卡内置的</a>如<code class="fe nr ns nt ne b">SPEC</code>、<code class="fe nr ns nt ne b">DOT MATRIX</code>、<code class="fe nr ns nt ne b">NYAN</code>、<code class="fe nr ns nt ne b">TAP</code> …以及<code class="fe nr ns nt ne b">mocha-teamcity-reporter</code>、<code class="fe nr ns nt ne b">mocha-junit-reporter</code>。老实说，这些并不是非常花哨的记者，另一个缺点是它为每个<code class="fe nr ns nt ne b">spec</code>创建一个<code class="fe nr ns nt ne b">xml</code>文件，并且很难将它们合并成一个。</p><p id="f9ba" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">尝试使用<code class="fe nr ns nt ne b">cypress.json</code>中的以下配置执行代码</p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="0149" class="mk ml in ne b gy ni nj l nk nl">{<br/>      "screenshotsFolder": "screenshots",<br/>      "videosFolder": "videos",<br/>      "reporter": "junit",<br/>      "reporterOptions": {<br/>          "mochaFile": "results/my-test-output-[hash].xml"<br/>      }<br/>}</span></pre><p id="5266" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">执行<code class="fe nr ns nt ne b">npx cypress run</code>后，输出会是这样</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/f8dd9212fcf92867aadf30e8dc8dca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWQTJwZYiqet6nCDUN5h0A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">junit reporter output</figcaption></figure><p id="099f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，你需要像摩卡牛逼的第三方记者。下面是使它工作所需的一些包。如果你想知道为什么需要这么多其他的包，请在这里<a class="ae ks" href="https://docs.cypress.io/guides/tooling/reporters.html#Examples" rel="noopener ugc nofollow" target="_blank">随意阅读。</a></p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="117c" class="mk ml in ne b gy ni nj l nk nl">npm i mochawesome mocha mochawesome-merge@2.0.1 mochawesome-report-generator -D</span></pre><p id="5ce0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们用mochawesome reporter更新配置文件<code class="fe nr ns nt ne b">cypress.json</code></p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="50e2" class="mk ml in ne b gy ni nj l nk nl">{<br/>    "screenshotsFolder": "screenshots",<br/>    "videosFolder": "videos",<br/>    "reporter": "mochawesome",<br/>    "reporterOptions": {<br/>        "reportDir": "reports/mochawesome-report",<br/>        "overwrite": false,<br/>        "html": false,<br/>        "json": true<br/>     }<br/>}</span></pre><p id="cf93" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，如果您执行<code class="fe nr ns nt ne b">npx cypress run</code>，它将为每个规格创建单独的报告文件。因此，为了更好地报告，我们必须使用其他包将它们合并成一个包。添加一个新文件，命名为<code class="fe nr ns nt ne b">cy-runner.sh</code>,复制下面的内容</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">cy-runner.sh</figcaption></figure><p id="ce5d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">打开<code class="fe nr ns nt ne b">package.json</code>并更新<code class="fe nr ns nt ne b">scripts</code></p><pre class="kd ke kf kg gt nd ne nf ng aw nh bi"><span id="16a1" class="mk ml in ne b gy ni nj l nk nl">"scripts": {<br/>    "cy:run": "sh cy-runner.sh"<br/>},</span></pre><p id="5582" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不要使用<code class="fe nr ns nt ne b">npx cypress run</code>，而是使用<code class="fe nr ns nt ne b">npm run cy:run</code>来执行你的测试。在执行这个命令时，合并的mochawesome报告应该会自动在google chrome中打开。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/4c72343503e2bccfc642445d1db25762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*PtQ8p2mFuySDaDFYZgDWag.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">cypress dir after adding mochawesome report</figcaption></figure><h2 id="0892" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated"><a class="ae ks" href="https://www.cypress.io/dashboard/" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">柏树仪表盘设置</strong> </a></h2><p id="c53c" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">这是cypress为有效的测试管理提供的最酷的特性之一(对于免费帐户也是如此)。</p><p id="a6fd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在您的终端中执行<code class="fe nr ns nt ne b">npx cypress open</code>，这将打开<strong class="kv io"> <em class="ls">测试运行器</em> </strong>。单击运行(中间选项卡)</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nz"><img src="../Images/c26d10f085e18e9fb8cc7cb238d15871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZMjnHcmmXQjpY6fjULtxQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Cypress Test Runner</figcaption></figure><p id="c803" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">点击<strong class="kv io"> <em class="ls">设置项目记录</em> </strong>和<strong class="kv io"> <em class="ls">登录仪表板。</em> </strong> <a class="ae ks" href="https://dashboard.cypress.io/login" rel="noopener ugc nofollow" target="_blank">使用您的google/github帐户登录仪表板</a>。</p><p id="fb00" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">成功登录后，它应该带你回到测试运行和设置项目。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oa"><img src="../Images/1bffcd2319587136000d1a32ffab7476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mri8bLko_XjPyM7eB0TtaQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Setup Project after successful login</figcaption></figure><p id="b2d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">项目设置后，您应该看到<code class="fe nr ns nt ne b">projectId</code>和<code class="fe nr ns nt ne b">key</code>来记录您的执行。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ob"><img src="../Images/8006b9b2ec5b52beff187097a0820869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tn2jM8GIy1FDQdeJ2DqDAA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">projectId and key provided by cypress for dashboard integration</figcaption></figure><p id="6352" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">打开<code class="fe nr ns nt ne b">cypress.json</code>添加<code class="fe nr ns nt ne b">projectId:”ouk63g"</code>键(用您在测试转轮上看到的任何值替换该值)。此外，更新<code class="fe nr ns nt ne b">cy-runner.sh</code>，用<code class="fe nr ns nt ne b">npx cypress run --record --key 628bbf4f-987a-44a2-83dc-a5f690b1bf60</code>替换<code class="fe nr ns nt ne b">npx cypress run</code>，保留<code class="fe nr ns nt ne b">--spec</code>参数，以防您运行特定的测试规范。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="16f9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在让我们尝试使用<code class="fe nr ns nt ne b">npm run cy:run</code>来执行测试。执行应以<strong class="kv io">记录的运行</strong> : &lt;到仪表板&gt;的url结束。您的本地mochawesome报告仍将保存在本地。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oc"><img src="../Images/39b66a7e57a7e5cf3568c331e3e28ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rj7bdexVYZodaJ7A21qnuQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Execution using Dashboard Key</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/cacb5b1712ccb243522732c6f1cc3b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhUPDP7-m1szhG3F57aCjg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Cypress Dashboard</figcaption></figure><h2 id="4c44" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated"><strong class="ak"> Github集成</strong></h2><p id="e943" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">目前，您可能已经注意到在上面的仪表板快照中有分支、作者、提交等字段。一旦dashboard与Github集成在一起，它就会被填充。</p><p id="4a07" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要集成，点击左侧窗格中的<strong class="kv io"> <em class="ls">项目设置</em> </strong>，向下滚动到<strong class="kv io"> <em class="ls"> GitHub集成</em> </strong>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/96916a049f260d3e5ad993e56f432158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJi8p9jO9ZBrKcteWCHmcw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Github Integration</figcaption></figure><p id="a16c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">点击<strong class="kv io"> <em class="ls">安装Cypress Github应用</em> </strong>并按照指示提供对您的特定存储库的访问。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi od"><img src="../Images/052c2b5fbc5db49db5f8ae7c84b214f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rk1WlojWMeHfCvoBGD2GlA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">github repo integration</figcaption></figure><p id="67de" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">回到终端，再次执行测试<code class="fe nr ns nt ne b">npm run cy:run</code>，它应该开始添加git提交的结果，看起来像这样</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/18c68d522525e465d32cc632dd6d1766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgsR2B8uTU10CZBcyEN0SQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">git commits sync with cypress dashboard</figcaption></figure><h2 id="56e5" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated">CICD码头工人</h2><p id="e265" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">是时候构建<code class="fe nr ns nt ne b">dockerfile</code>来使用docker执行测试，为CICD工具做好准备了。</p><p id="d472" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">创建一个新文件，并将其命名为dockerfile — <code class="fe nr ns nt ne b">touch dockerfile</code>,复制到下面的文件中</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nw nx l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">dockerfile</figcaption></figure><p id="0d5a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">构建映像— <code class="fe nr ns nt ne b">docker build -t cypressboilerplate .</code> <br/>执行测试— <code class="fe nr ns nt ne b">docker run -v "`pwd`/execution-report":/mnt/execution-report -v "`pwd`/videos":/mnt/videos -v "`pwd`/screenshots":/mnt/screenshots -it cypressboilerplate</code></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/102fcf6672947215381324d9cd573456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFZsK-cbQNjeUm4LuqFQiA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Cypress Test Execution Using Docker</figcaption></figure><ul class=""><li id="4d96" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated"><code class="fe nr ns nt ne b">cypressboilerplate</code>是图像名称。确保在<code class="fe nr ns nt ne b">build</code>和<code class="fe nr ns nt ne b">run</code>命令中进行更改，以防您想要更新它。</li><li id="3d66" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">注释掉<code class="fe nr ns nt ne b">cy-runner.sh</code>中的第15行，因为如果在容器内运行，报告不会自动打开</li><li id="c3d9" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated"><code class="fe nr ns nt ne b">-v "'pwd'":/mnt</code>安装此卷将帮助您更新测试并立即运行它们，而无需重新构建映像</li></ul><p id="f9ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">就这样，你的测试是可移植的，可以在CICD工具中运行了</strong></p><h2 id="e143" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated"><a class="ae ks" href="https://docs.percy.io/docs/cypress" rel="noopener ugc nofollow" target="_blank">珀西的视觉测试</a></h2><p id="1cd8" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">作为本文的一部分，我想讨论的最后一个主题是视觉测试。这是我参与的大多数项目所需要的，除非只有后端测试，所以我想在这里包括它的设置。</p><ul class=""><li id="b564" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated">注册<a class="ae ks" href="https://percy.io/login" rel="noopener ugc nofollow" target="_blank">珀西</a>账户，如果你还没有的话。</li><li id="3f43" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">一旦登录并创建了一个新项目，复制<code class="fe nr ns nt ne b">PERCY_TOKEN</code></li><li id="1518" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">进入终端，运行<code class="fe nr ns nt ne b">npm i @percy/cypress -D</code>安装percy的包</li><li id="d045" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">在<code class="fe nr ns nt ne b">cypress/<strong class="kv io">support</strong>/command.js</code>中添加以下代码:<br/> <code class="fe nr ns nt ne b">import '@percy/cypress';</code></li><li id="f8c2" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">在<code class="fe nr ns nt ne b">cypress/<strong class="kv io">plugins</strong>/index.js</code>中添加以下代码:<br/> <code class="fe nr ns nt ne b">const percyHealthCheck = require('@percy/cypress/task')<br/> module.exports = (on, config) =&gt;{<br/> on("task", percyHealthCheck)<br/>}</code></li><li id="97d0" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">通过在cy-runner.sh中添加以下内容作为第一行来设置PERCY _ TOKEN:<br/><code class="fe nr ns nt ne b">export PERCY_TOKEN= &lt;your token copied in second step&gt;</code></li><li id="4c23" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">转到任何可用的样本测试规范，我正在使用<code class="fe nr ns nt ne b">cypress/integration/examples/actions.spec.js</code></li><li id="0b55" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">在第11行的<code class="fe nr ns nt ne b">cy.visit</code>命令后添加以下代码到本规范<code class="fe nr ns nt ne b">cy.percySnapshot('Action Page')</code>的第一次测试中。</li><li id="ae62" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">最后一步是更改<code class="fe nr ns nt ne b">cy-runner.sh<br/></code>中的命令，将<code class="fe nr ns nt ne b">npx cypress run</code>更新为<code class="fe nr ns nt ne b">npx percy exec -- cypress run</code> <br/>保持所有其他参数——record和——spec不变</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/e7c0746cba5965d08af55be70973ce5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64_Kj13hRTG59_q35kr66Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Percy/Cypress execution</figcaption></figure><p id="4b7f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">就这样，你已经准备好使用percy和cypress进行视觉测试了。</strong></p><h2 id="5be4" class="mk ml in bd mm mn mo dn mp mq mr dp ms lc mt mu mv lg mw mx my lk mz na nb nc bi translated">主题设置</h2><p id="a90c" class="pw-post-body-paragraph kt ku in kv b kw nm jo ky kz nn jr lb lc no le lf lg np li lj lk nq lm ln lo ig bi translated">cypress提供的一个很酷的东西是你可以添加额外的插件。这样可以更容易地将<strong class="kv io"> <em class="ls">测试者</em> </strong>的主题从无聊的浅白色背景改为黑暗/万圣节主题，作为标准插件的一部分。</p><ul class=""><li id="9539" class="lw lx in kv b kw kx kz la lc ly lg lz lk ma lo mb mc md me bi translated">安装包<code class="fe nr ns nt ne b">npm i cypress-dark -D</code></li><li id="eeb3" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">转到<code class="fe nr ns nt ne b">cypress/support/index.js</code>并添加<code class="fe nr ns nt ne b">require('cypress-dark/src/halloween')</code>或正常黑暗<code class="fe nr ns nt ne b">require('cypress-dark')</code></li><li id="bd3a" class="lw lx in kv b kw mf kz mg lc mh lg mi lk mj lo mb mc md me bi translated">打开测试运行器<code class="fe nr ns nt ne b">npx cypress open</code>，执行任何测试，您的测试运行器应该如下所示:)</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/133b07243f8a022d2985db0a6ba43da4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bogglAr8Bps1HeK5EA_9Xw.png"/></div></div></figure></div><div class="ab cl of og hr oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ig ih ii ij ik"><p id="f9f6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">代码可在git <a class="ae ks" href="https://github.com/puneetpunj/cypress-boiler-plate" rel="noopener ugc nofollow" target="_blank">这里</a>获得。让我知道任何反馈意见。</p><p id="7823" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">用简单英语写的JavaScript的注释:我们总是对帮助推广高质量的内容感兴趣。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到<a class="ae ks" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">submissions@javascriptinplainenglish.com</a>给我们，我们会把你添加为作者。</p></div></div>    
</body>
</html>