<html>
<head>
<title>Getting Started Back End Development with Restify</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Restify开始后端开发</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-started-back-end-development-with-restify-136482e123f5?source=collection_archive---------10-----------------------#2020-11-28">https://javascript.plainenglish.io/getting-started-back-end-development-with-restify-136482e123f5?source=collection_archive---------10-----------------------#2020-11-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/814a00e1407e288406d1cd8e12518140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2dCLrWbNq-7DYHAK"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@janpadilla?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jan Padilla</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="12d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Restify是一个简单的节点后端框架。</p><p id="dd41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看如何用Restify创建一个简单的后端应用程序。</p><h1 id="d840" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">快速启动</h1><p id="100b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要开始Restify，我们可以通过运行以下命令来安装<code class="fe me mf mg mh b">restify</code>包:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="357a" class="mq lc iq mh b gy mr ms l mt mu">npm i restify</span></pre><p id="5ccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以编写第一个应用程序:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4c95" class="mq lc iq mh b gy mr ms l mt mu">var restify = require('restify');</span><span id="8895" class="mq lc iq mh b gy mv ms l mt mu">function respond(req, res, next) {<br/>  res.send(`hello ${req.params.name}`);<br/>  next();<br/>}</span><span id="9b15" class="mq lc iq mh b gy mv ms l mt mu">var server = restify.createServer();<br/>server.get('/hello/:name', respond);<br/>server.head('/hello/:name', respond);</span><span id="aa32" class="mq lc iq mh b gy mv ms l mt mu">server.listen(8080, function() {<br/>  console.log('%s listening at %s', server.name, server.url);<br/>});</span></pre><p id="dfb0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导入<code class="fe me mf mg mh b">restify</code>包。</p><p id="46e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">req</code>、<code class="fe me mf mg mh b">res</code>和<code class="fe me mf mg mh b">next</code>参数创建我们的<code class="fe me mf mg mh b">respond</code>函数。</p><p id="2448" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">req</code>已经请求数据。</p><p id="ac07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们用它提供的方法创建我们的响应。</p><p id="59dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">next</code>是调用下一个中间件的函数。</p><p id="fbde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">restify.createServer</code>方法创建了我们的服务器。</p><p id="aad3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe me mf mg mh b">get</code>方法定义了我们的路由，以定义一个GET路由。</p><p id="237f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是URL。</p><p id="c0e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">:name</code>是URL参数的占位符。</p><p id="2845" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以像使用<code class="fe me mf mg mh b">respond</code>功能一样使用<code class="fe me mf mg mh b">req.params.name</code>来访问参数值。</p><p id="2658" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">server.head</code>针对HTTP谓词在给定路径上安装一个链。</p><p id="7713" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要它来让我们倾听请求。</p><p id="e9da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们转到<code class="fe me mf mg mh b">https://localhost:8000/hello/name</code>时，我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c40d" class="mq lc iq mh b gy mr ms l mt mu">"hello name"</span></pre><p id="f3b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在屏幕上。</p><p id="3c8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">URL参数根据它们的位置自动映射。</p><h1 id="3229" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Sinatra风格的处理器链</h1><p id="c992" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以有一系列的路由处理器。</p><p id="e4f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="085a" class="mq lc iq mh b gy mr ms l mt mu">var restify = require('restify');</span><span id="64d8" class="mq lc iq mh b gy mv ms l mt mu">function respond(req, res, next) {<br/>  res.send(`hello ${req.params.name}`);<br/>  next();<br/>}</span><span id="5f44" class="mq lc iq mh b gy mv ms l mt mu">var server = restify.createServer();<br/>server.get('/', function(req, res, next) {<br/>  res.send('home')<br/>  return next();<br/>});</span><span id="1ec4" class="mq lc iq mh b gy mv ms l mt mu">server.post('/foo',<br/>  function(req, res, next) {<br/>    req.someData = 'foo';<br/>    return next();<br/>  },<br/>  function(req, res, next) {<br/>    res.send(req.someData);<br/>    return next();<br/>  }<br/>);</span><span id="55d7" class="mq lc iq mh b gy mv ms l mt mu">server.listen(8080, function() {<br/>  console.log('%s listening at %s', server.name, server.url);<br/>});</span></pre><p id="8951" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加获取和发布路由。</p><p id="566d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">邮路有两个中间站。</p><p id="6932" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe me mf mg mh b">next</code>以便调用下一个。</p><p id="f6fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，当我们向<code class="fe me mf mg mh b">https://localhost:8080/foo</code>发出POST请求时，我们看到<code class="fe me mf mg mh b">'foo'</code>是响应。</p><p id="74e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有3个不同的处理程序链。</p><p id="b186" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pre</code>是路由前运行的处理器链。</p><p id="ad2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">use</code>是一个处理程序链运行后的路由。</p><p id="188f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe me mf mg mh b">{httpVerb}</code>是一个运行在特定路线上的处理程序链。</p><p id="6b06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下代码来运行一个<code class="fe me mf mg mh b">pre</code>中间件:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="bfeb" class="mq lc iq mh b gy mr ms l mt mu">var restify = require('restify');</span><span id="c360" class="mq lc iq mh b gy mv ms l mt mu">function respond(req, res, next) {<br/>  res.send(`hello ${req.params.name}`);<br/>  next();<br/>}</span><span id="3a70" class="mq lc iq mh b gy mv ms l mt mu">var server = restify.createServer();<br/>server.pre(restify.plugins.pre.dedupeSlashes());</span><span id="2770" class="mq lc iq mh b gy mv ms l mt mu">server.get('/', function(req, res, next) {<br/>  res.send('home')<br/>  return next();<br/>});</span><span id="135e" class="mq lc iq mh b gy mv ms l mt mu">server.post('/foo',<br/>  function(req, res, next) {<br/>    req.someData = 'foo';<br/>    return next();<br/>  },<br/>  function(req, res, next) {<br/>    res.send(req.someData);<br/>    return next();<br/>  }<br/>);</span><span id="ae77" class="mq lc iq mh b gy mv ms l mt mu">server.listen(8080, function() {<br/>  console.log('%s listening at %s', server.name, server.url);<br/>});</span></pre><p id="04ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在运行任何其他东西之前运行<code class="fe me mf mg mh b">dedupeSlashes</code>中间件，以去除请求中多余的斜线。</p><p id="1f74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在运行路线处理器之前运行<code class="fe me mf mg mh b">server.use</code>处理器。</p><p id="1907" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用它，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="cab9" class="mq lc iq mh b gy mr ms l mt mu">var restify = require('restify');</span><span id="cb2a" class="mq lc iq mh b gy mv ms l mt mu">function respond(req, res, next) {<br/>  res.send(`hello ${req.params.name}`);<br/>  next();<br/>}</span><span id="c7e3" class="mq lc iq mh b gy mv ms l mt mu">var server = restify.createServer();<br/>server.use(function(req, res, next) {<br/>  console.warn('run for all routes!');<br/>  return next();<br/>});<br/>server.get('/', function(req, res, next) {<br/>  res.send('home')<br/>  return next();<br/>});</span><span id="fea7" class="mq lc iq mh b gy mv ms l mt mu">server.post('/foo',<br/>  function(req, res, next) {<br/>    req.someData = 'foo';<br/>    return next();<br/>  },<br/>  function(req, res, next) {<br/>    res.send(req.someData);<br/>    return next();<br/>  }<br/>);</span><span id="7a00" class="mq lc iq mh b gy mv ms l mt mu">server.listen(8080, function() {<br/>  console.log('%s listening at %s', server.name, server.url);<br/>});</span></pre><p id="4425" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">use</code>处理器将在运行路线处理器之前运行。</p><h1 id="afe5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="ee7a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以轻松地用Restify创建简单的后端应用程序。</p><p id="e0f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>