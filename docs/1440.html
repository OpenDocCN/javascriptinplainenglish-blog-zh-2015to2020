<html>
<head>
<title>How to set up Apollo GraphQL in Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Next.js中设置Apollo GraphQL</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/setting-upapollo-graphql-in-next-js-a1b36726c836?source=collection_archive---------7-----------------------#2020-03-16">https://javascript.plainenglish.io/setting-upapollo-graphql-in-next-js-a1b36726c836?source=collection_archive---------7-----------------------#2020-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/b6574e098f7ea4d539a43c1194ceeb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Hva7hcsFWulFUPhrEWui1A.jpeg"/></div></figure><h1 id="a0cc" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">Next.js是目前的热门</h1><p id="2057" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我说“当前”,是因为我们都知道在网络世界中——技术发展速度极快！在撰写本文时，Next.js是最热门的React框架之一，这是有充分理由的。它提供服务器端渲染，并且开箱即用。它还包括自动代码分割、基于文件系统的路由和“零设置”热代码重载等等。我不会在这里详细介绍，因为有大量的文章强调了Next.js的好处。</p><h1 id="00f7" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">适合这项工作的工具</h1><p id="177b" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最近，我有幸与Next.js合作了一个项目。当涉及到设计技术堆栈时，归结起来就是理解需求并为工作选择正确的工具。我的项目的要求非常简单。</p><ul class=""><li id="f1e2" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">构建一个管理员门户，管理员可以在其中查看客户详细信息、订单历史和库存。</li><li id="628b" class="lq lr iq ku b kv mb kz mc ld md lh me ll mf lp lx ly lz ma bi translated">该应用程序将是小型轻量级的——支持少数管理员</li></ul><p id="c1bd" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp ij bi translated">基于这些简单的需求，在选择使用哪种技术时，它会敞开大门。因为应用程序将是小而轻的，我们不需要一个成熟的独立后端服务器。使用Next.js，我们可以在一个应用程序中同时提供客户端和服务器端代码。下面是这个项目选择Next.js的其他几个原因。</p><h2 id="31ee" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">几乎没有设置</h2><p id="6e2b" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">开箱即用——next . js为我们提供了一个熟悉的React框架，它很简单，因此我们可以立即开始开发，最大限度地减少配置和设置时间。</p><h2 id="678f" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">开箱即用的快速服务器</h2><p id="9a86" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Next.js的一个非常酷的特性是，它运行一个开箱即用的Express服务器，因此您可以开始编写api路径。我选择在这个项目中实现Apollo GraphQL，我将带您了解如何设置。</p><h2 id="8a27" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">出色的文档和支持</h2><p id="0dde" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">当涉及到选择特定的技术时，文档是非常重要的。有时，当涉及到文档和支持时，使用最新和最好的是一把双刃剑。但是在Next.js的例子中，文档是丰富的并且易于浏览。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h1 id="894b" class="ju jv iq bd jw jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn ng kp kq kr bi translated">我们开始吧</h1><p id="bacb" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我假设您已经安装了Next.js。在撰写本文时，Next.js的最新版本是9.3.0。让我们通过运行<strong class="ku ir"> npm init next-app <em class="nh"> </em> </strong>创建一个新的Next.js项目，并将该项目命名为<strong class="ku ir"> <em class="nh"> </em> next-graphql-app </strong>。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="25f3" class="mj jv iq nn b gy nr ns l nt nu">npm init next-app</span></pre><p id="69e8" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp ij bi translated">接下来，切换到目录并启动Next.js应用程序，并验证一切正常。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0406" class="mj jv iq nn b gy nr ns l nt nu">➜  ~  cd next-graphql-app<br/>➜  next-graphql-app git:(master) npm run dev</span></pre><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/718c8b828de180aa49e6776126bbf142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QTA8RBfDGAKzp0z6INcajg.png"/></div></div></figure></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h1 id="1bf5" class="ju jv iq bd jw jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn ng kp kq kr bi translated">设置GraphQL</h1><h2 id="39a4" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">安装项目依赖项</h2><p id="5e64" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">首先，让我们安装依赖项。我们将使用<strong class="ku ir"> apollo-server-micro </strong>包。在这个演示中，我们还将使用<strong class="ku ir"> lodash </strong>。打开您喜欢的终端并运行以下命令来安装依赖项。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0ce7" class="mj jv iq nn b gy nr ns l nt nu">npm i apollo-server-micro lodash</span></pre><h2 id="8a41" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">文件夹结构</h2><p id="d6c0" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们在VSCode中打开项目，并创建几个新文件。</p><ul class=""><li id="95ab" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">/next-graph QL-app/pages/API/graph QL/index . js</li><li id="9287" class="lq lr iq ku b kv mb kz mc ld md lh me ll mf lp lx ly lz ma bi translated">/next-graph QL-app/pages/API/graph QL/resolvers . js</li><li id="3b3a" class="lq lr iq ku b kv mb kz mc ld md lh me ll mf lp lx ly lz ma bi translated">/next-graph QL-app/pages/API/graph QL/typedefs . js</li></ul><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi oa"><img src="../Images/7b19edbb78e3edf41491b493b62ce397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6R4Uh1_frxPsD3dV54Hk2g.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk">You folder structure should look similar to this at this point in time</figcaption></figure><h2 id="6763" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">设置GraphQL API路由</h2><p id="278f" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们使用<strong class="ku ir"> index.js </strong> —这是我们的api入口点，我们将在这里设置GraphQL。将下面的代码复制到index.js文件中。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="a2be" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">TypeDefs</h2><p id="a9f1" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">修改typeDef.js文件，如下所示:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="7767" class="mj jv iq bd jw mk ml dn ka mm mn dp ke ld mo mp ki lh mq mr km ll ms mt kq mu bi translated">下决心者</h2><p id="3b65" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">同样，修改resolvers . js——这里我们有一个3个用户的数组。<strong class="ku ir"> getUser </strong>查询将通过<strong class="ku ir"> id </strong>找到一个用户，并返回用户的对象。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="of og l"/></div></figure><h1 id="7209" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">测试我们的GraphQL端点</h1><p id="ecf4" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们启动Next.js应用程序，如果它还没有运行的话。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="2ee6" class="mj jv iq nn b gy nr ns l nt nu">npm run dev</span></pre><p id="67d8" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp ij bi translated">一旦应用程序准备就绪，打开你最喜欢的浏览器，进入<a class="ae oh" href="http://localhost:3000/api/graphql" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/API/graph QL</a></p><p id="552c" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp ij bi translated">如果一切都正确挂钩，这应该会拉起GraphQL操场，我们可以测试我们的查询。</p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi oi"><img src="../Images/c78f75a955b9f78b6e9cb9f1de51a373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZgALGf_9Cc55uVKxinhZMQ.png"/></div></div></figure></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h1 id="dc0d" class="ju jv iq bd jw jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn ng kp kq kr bi translated">结论</h1><p id="a686" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们做到了！良好的..那很容易。我们现在有了一个带有Apollo GraphQL后端的React应用程序。这就是我喜欢Next.js的原因，它减少了配置的时间，所以你可以专注于重要的事情，代码和应用程序本身。Apollo GraphQL的启动和运行只需要3个文件和几行代码。我希望这篇文章对您有所帮助——快乐编码！</p><p id="209d" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp ij bi translated">我在业余时间写这些文章是为了消遣。如果你喜欢这篇文章，请在下面留下你的喜欢和评论！可以关注我上 <a class="ae oh" href="https://medium.com/@this.kevinluu" rel="noopener"> <em class="nh">中</em> </a> <em class="nh">和</em> <a class="ae oh" href="https://twitter.com/kluu_10" rel="noopener ugc nofollow" target="_blank"> <em class="nh">推特</em> </a> <em class="nh">。感谢支持！</em></p></div></div>    
</body>
</html>