<html>
<head>
<title>How to Write Better JavaScript Modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何写出更好的JavaScript模块</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-write-better-javascript-modules-5c9c269086c9?source=collection_archive---------5-----------------------#2020-08-03">https://javascript.plainenglish.io/how-to-write-better-javascript-modules-5c9c269086c9?source=collection_archive---------5-----------------------#2020-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c4fcf791443565d9d836f37f82d882d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uZLDCUboGDscH-Gz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@belart84?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artem Beliaikin</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9019" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看在编写JavaScript模块时应该遵循的一些最佳实践。</p><h1 id="d68b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">首选指定的导出</h1><p id="9460" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">命名导出必须以导出成员的名称导入。</p><p id="4a40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这不同于默认导出，默认导出可以以任何名称导入。</p><p id="ca4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，命名导出比默认导出更容易混淆。</p><p id="a2ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不要写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a8f3" class="mn lc iq mj b gy mo mp l mq mr">export default class Person {<br/>  constructor(name) {<br/>    this.name = name;<br/>  }</span><span id="f74b" class="mn lc iq mj b gy ms mp l mq mr">  greet() {<br/>    return `Hello, ${this.name}!`;<br/>  }<br/>}</span></pre><p id="7eda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0d28" class="mn lc iq mj b gy mo mp l mq mr">export class Person {<br/>  constructor(name) {<br/>    this.name = name;<br/>  }</span><span id="da2c" class="mn lc iq mj b gy ms mp l mq mr">  greet() {<br/>    return `Hello, ${this.name}!`;<br/>  }<br/>}</span></pre><p id="d821" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个示例可以用任何名称导入。</p><p id="51ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个必须作为<code class="fe mt mu mv mj b">Person</code>导入。</p><p id="5535" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们正在使用的文本编辑器具有自动完成功能，那么它也可以处理命名导出。</p><h1 id="b8a8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">导入期间不工作</h1><p id="093a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该对导出的代码做任何事情。</p><p id="b1e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们用一个有效的表达式导出一些东西，很容易得到意想不到的结果。</p><p id="ff92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，以下导出是不好的:</p><p id="6c19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">config.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7c3e" class="mn lc iq mj b gy mo mp l mq mr">export const config = {<br/>  data: JSON.parse(str)<br/>};</span></pre><p id="cc10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在导出完成后，工作仍然会被完成，所以我们得到最新的值。</p><p id="dd5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们进口它的时候，<code class="fe mt mu mv mj b">JSON.parse</code>就叫做。</p><p id="7159" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着导入速度会变慢。</p><p id="203d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="aee2" class="mn lc iq mj b gy mo mp l mq mr">import { config } from 'config';</span></pre><p id="8c0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后<code class="fe mt mu mv mj b">JSON.parse</code>就会运行。</p><p id="f59b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让<code class="fe mt mu mv mj b">JSON.parse</code>以一种懒惰的方式运行，我们可以写:</p><p id="c259" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">config.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7d74" class="mn lc iq mj b gy mo mp l mq mr">let parsedData = null;</span><span id="94e3" class="mn lc iq mj b gy ms mp l mq mr">export const config  = {<br/>  get data() {<br/>    if (parsedData === null) {<br/>      parsedData = JSON.parse(str);<br/>    }<br/>    return parsedData;<br/>  }<br/>};</span></pre><p id="af19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们将解析后的字符串缓存在<code class="fe mt mu mv mj b">parsedData</code>中。</p><p id="e398" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">JSON.parse</code>仅在<code class="fe mt mu mv mj b">parsedData</code>为<code class="fe mt mu mv mj b">null</code>时运行。</p><h1 id="d748" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">高内聚模块</h1><p id="57b7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">内聚性描述了一个模块中的组件属于一起的程度。</p><p id="c8b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该确保一个模块属于同一个模块。</p><p id="eec2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们应该在一个模块中有相关的实体。</p><p id="d59b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以用做算术运算的函数制作一个<code class="fe mt mu mv mj b">math</code>模块。</p><p id="7320" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><p id="577f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">math.js</code></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7b83" class="mn lc iq mj b gy mo mp l mq mr">export const add = (a, b) =&gt; a + b;<br/>export const subtract = (a, b) =&gt; a - b;<br/>export const multiply = (a, b) =&gt; a * b;<br/>export const divide = (a, b) =&gt; a / b;</span></pre><p id="baf4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的函数做相似的事情，所以它们属于一个模块。</p><p id="eb4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有低内聚的模块，那么就很难理解这个模块有什么。</p><p id="5a3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个模块里不相关的东西就是没有意义。</p><h1 id="8cb4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免长的相对路径</h1><p id="648c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果它们嵌套很深，就很难找到一个模块。</p><p id="ec6a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该避免深度嵌套以避免长的相对路径。</p><p id="bc97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以与其写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="919c" class="mn lc iq mj b gy mo mp l mq mr">import { addDates } from '../../date/add';<br/>import { subtractDates }   from '../../date/subtract';</span></pre><p id="36ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f0c8" class="mn lc iq mj b gy mo mp l mq mr">import { addDates } from './date/add';<br/>import { subtractDates } from './date/subtract';</span></pre><p id="08c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们将它们放在节点包中，我们可以使用绝对路径:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fd6d" class="mn lc iq mj b gy mo mp l mq mr">import { addDates } from 'utils/date/add';<br/>import { subtractDates } from 'utils/date/subtract';</span></pre><p id="1ee7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们把所有东西都放在一个<code class="fe mt mu mv mj b">utils</code>包中，这样我们就可以在一个绝对路径中引用它。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5bdab1cfd5b826bf3cb23551f4bf055e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MzRZtHYed6y8FiF0"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@blizzard88?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Grant Durr</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="9088" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="4e84" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该制作内聚的模块，以便更容易理解它们。</p><p id="1e47" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，命名导出比默认导出更好。</p><p id="c67d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该导出在导出过程中有效的代码，因为它们会在我们导入时运行。</p><h2 id="5f0f" class="mn lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated"><strong class="ak">简单英语的JavaScript</strong></h2><p id="3aa1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码获得更多类似内容，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>