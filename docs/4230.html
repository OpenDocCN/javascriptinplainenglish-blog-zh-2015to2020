<html>
<head>
<title>How to enforce HTTPS on Heroku deployed apps i.e. React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Heroku部署的应用上实施HTTPS，即React</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-enforce-https-on-heroku-deployed-apps-i-e-react-6dd30f9fc4c?source=collection_archive---------8-----------------------#2020-11-26">https://javascript.plainenglish.io/how-to-enforce-https-on-heroku-deployed-apps-i-e-react-6dd30f9fc4c?source=collection_archive---------8-----------------------#2020-11-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="14bc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">普通的JavaScript加上一些React魔法解决了这个问题！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3230eeb38441e21a4aaf3119651cd08a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hMwT2ZRu1XJzdop2.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo <a class="ae kv" href="https://coursework.vschool.io/deploying-mern-with-heroku/" rel="noopener ugc nofollow" target="_blank">V School</a></figcaption></figure><p id="b2d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个问题困扰了我一段时间，我不喜欢我在网上找到的任何解决方案，然后我的脑袋灵光一现！</p><p id="0d4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React now为我们提供了React Hooks，现代web开发的第七大世界奇迹。这如何解决我们的问题？</p><p id="37f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以编写一个自定义的钩子，它会在我们每次渲染页面时触发。假设你已经运行了你的React应用程序，继续为你的定制钩子创建一个文件夹和一个名为<strong class="ky ir"> useRedirectToHttps.js </strong>的文件</p><p id="e620" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<strong class="ky ir"> useRedirectToHttps.js </strong>中，我们将创建一个名为<code class="fe ls lt lu lv b">useRedirectToHttps</code>的钩子，并在每次渲染时调用一个<code class="fe ls lt lu lv b">useEffect()</code>。useEffect的工作非常简单，获取当前的URL，检查它是否是HTTPS，然后重定向到带有HTTPS的页面</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="c4cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在任何React组件中，您都可以调用:</p><pre class="kg kh ki kj gt ly lv lz ma aw mb bi"><span id="24ac" class="mc md iq lv b gy me mf l mg mh">useRedirectToHttps() </span></pre><p id="ac3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">瞧啊。你的应用程序每次都会将用户重定向到HTTPS网站🎉</p><p id="74c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">PS。关于我们在这里使用的JavaScript属性，有几点需要注意</p><p id="e50e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">window . location . protocol</strong>—返回您当前用来访问网站的协议的字符串表示形式— <strong class="ky ir">注意，它也有一个冒号，而不仅仅是协议。</strong></p><p id="9465" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">window . location . replace(" https://…"</strong>—将用户重定向到https，并通过从浏览器历史记录中删除条目来消除用户返回HTTP的可能性。</p><p id="fe76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> location.pathname </strong> —是一个react-router的好东西，它允许我们检查我们此刻在哪里，或者，如果你不使用react-router，你也可以解析从window.location.href返回的字符串。</p></div></div>    
</body>
</html>