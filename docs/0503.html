<html>
<head>
<title>Better Understanding of Timers in JavaScript: SetTimeout vs RequestAnimationFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更好地理解JavaScript中的计时器:SetTimeout与RequestAnimationFrame</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/better-understanding-of-timers-in-javascript-settimeout-vs-requestanimationframe-bf7f99b9ff9b?source=collection_archive---------0-----------------------#2019-10-30">https://javascript.plainenglish.io/better-understanding-of-timers-in-javascript-settimeout-vs-requestanimationframe-bf7f99b9ff9b?source=collection_archive---------0-----------------------#2019-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/70adda82c1cbcd0b4274c1998bd3870d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ze4PBl_Pt2_SqaZC"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@chiro?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">photo-nic.co.uk nic</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3a48" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> T </span>如今，JavaScript计时器功能被许多项目广泛使用。当您想要将一些函数延迟到其他函数执行之后，它们尤其有用。</p><p id="5cac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将讨论JavaScript中的每个计时器函数，以及如何或何时使用它们。最后，当您使用它们时，我会提醒您。</p><h1 id="9cd2" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">目录</h1><ul class=""><li id="7b3f" class="mi mj iq kf b kg mk kk ml ko mm ks mn kw mo la mp mq mr ms bi translated">定时器简介<br/> -设置定时器超时<br/> -设置间隔<br/> -请求动画帧</li><li id="8a55" class="mi mj iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">深入探讨<br/>-set time out vs set interval vs request animationframe</li><li id="5a80" class="mi mj iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">事情要小心</li></ul></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><h1 id="5d58" class="lk ll iq bd lm ln nf lp lq lr ng lt lu lv nh lx ly lz ni mb mc md nj mf mg mh bi translated">定时器简介</h1><p id="5133" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">JavaScript中有四个计时器函数。</p><blockquote class="nn no np"><p id="8a90" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">setTimeout —在指定的毫秒数后调用函数或计算表达式的函数。</p><p id="98e6" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">set interval——以指定的时间间隔调用函数或计算表达式的函数。setInterval将继续调用该函数，直到调用clearInterval。</p><p id="17ce" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">requestAnimationFrame——一个类似setTimeout的函数，但是被Mozilla改进了。</p></blockquote><h2 id="7d38" class="nu ll iq bd lm nv nw dn lq nx ny dp lu ko nz oa ly ks ob oc mc kw od oe mg of bi translated">设置超时</h2><p id="0c9c" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">假设您有一个客户想每秒打印1分钟。他给了你一个包含[1…60]的数组。现在，您必须每秒打印一次。</p><p id="c990" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我们不能像往常一样在数组上循环，因为它会一次打印出所有的数字。<em class="nq"> setTimeout </em>将一个函数作为它的第一个参数，并在<em class="nq"> x </em>毫秒内执行它，您已经将此时间传递给了<em class="nq"> setTimeout </em>作为第二个参数。</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0066" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">想象一下<em class="nq">循环</em>功能会打印出什么。</p><p id="56e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nq">填充</em>是初始化某个值的数组的好方法。在该示例中，数组将被填充零，因为默认情况下<code class="fe om on oo op b">new Array(60)</code>返回<em class="nq">未定义</em>。</p><figure class="og oh oi oj gt jr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/005dfa6568e6a6ebabfca786d9a3f11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*496o8JSaGblWyfEa_EFPOw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Browser compatibility of Array.prototype.fill. Check out <a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/fill#Browser_compatibility" rel="noopener ugc nofollow" target="_blank">here</a></figcaption></figure><blockquote class="nn no np"><p id="88a2" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">注意:并非所有浏览器都完全支持填充。工业工程不支持它。如果你也应该考虑在各种浏览器中使用填充方法，你应该为IE的填充方法想出一个不同的算法。</p></blockquote><p id="064c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是<em class="nq"> setTimeout </em>可以使用的地方。</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0d3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">价值[1…60]会按照我们的预期每秒打印一次，我们的客户也会很高兴！:D</p><h2 id="6f9b" class="nu ll iq bd lm nv nw dn lq nx ny dp lu ko nz oa ly ks ob oc mc kw od oe mg of bi translated">设置间隔</h2><p id="7a3d" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">上次他让我们打印[1…60]时，他对我们为他所做的一切非常满意。所以他让我们再帮他一次。但这次，他想重复打印每秒[1…60]次的整个任务。我们做什么呢</p><p id="1b65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好吧，我认为我们可以在这个任务中重用第一个产品。所以，问题是，我们知道如何每秒打印[1…60]，但我们怎么能重复呢？</p><pre class="og oh oi oj gt or op os ot aw ou bi"><span id="cd67" class="nu ll iq op b gy ov ow l ox oy">function task1(array) {<br/>  printPerSecond(array);<br/>}</span><span id="7a97" class="nu ll iq op b gy oz ow l ox oy">setTimeout(() =&gt; task1([1...60]), 0);<br/>setTimeout(() =&gt; task1([1...60]), 1000);<br/>setTimeout(() =&gt; task1([1...60]), 2000);<br/>setTimeout(() =&gt; task1([1...60]), 3000);<br/>setTimeout(() =&gt; task1([1...60]), 4000);<br/>...</span></pre><p id="bdae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嗯，这种方式看起来不太优雅。因为我们应该按照他让我们重复的次数来重复<code class="fe om on oo op b">setTimeout(() =&gt; {}, ...)</code>部分。</p><p id="0688" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，您可以使用<em class="nq"> setInterval，</em>非常适合这种情况。</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><blockquote class="nn no np"><p id="0af8" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">注意:setInterval的使用方法和setTimeout完全一样。这意味着即使你调用setInterval，它也不会马上开始。</p></blockquote><h2 id="5dea" class="nu ll iq bd lm nv nw dn lq nx ny dp lu ko nz oa ly ks ob oc mc kw od oe mg of bi translated">requestAnimationFrame</h2><p id="6bb1" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">几个月后，他早上打电话给我们。</p><p id="4761" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“我想改变算法。我想快速打印[1…]。对，连续打印数字，永远不要停！”</p><p id="7f3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在他想要不同的东西。所以它不再打印[1…60],我们应该打印从1开始的数字。那么我们如何做到这一点呢？</p><p id="3487" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<em class="nq"> setTimeout </em>通过执行一个函数来打印给定的数字并再次递归调用它自己。但是这种方式有一个性能问题。我会在这篇文章的后面向你解释原因。</p><p id="a487" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nq"> requestAnimationFrame </em>每当浏览器准备开始下一个重画任务时，执行一个回调函数。</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><blockquote class="nn no np"><p id="4552" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">注意:这种用法不是最佳实践！我们将在这篇文章的后面对此进行更多的讨论。</p></blockquote><p id="ea0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">复制代码并在浏览器控制台或IDE上运行。你可以看到数字打印得非常快。</p><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pa"><img src="../Images/4f225d8678ff2831b5dd308f629459cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gZWJokXtg5oO_kMz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@marcosartorinet?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marco Sartori</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="4e49" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">深潜</h1><p id="15b6" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">现在，我想你已经理解了<em class="nq"> setTimeout </em>、<em class="nq"> setInterval </em>和<em class="nq"> requestAnimationFrame </em>的基本概念。</p><p id="c992" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的JavaScript计时器在创建时都会返回时间戳<em class="nq">。这个<em class="nq">时间戳</em>是在一个名为<em class="nq">活动超时列表</em>的列表中找到回调函数的关键。例如，一旦你用100毫秒生成了<em class="nq"> setTimeout </em>，JavaScript将你的回调函数存储在<em class="nq">活动超时列表</em>中后，返回<em class="nq">时间戳</em>，并在上面写一个备忘录，“在100毫秒内执行”。</em></p><p id="cb28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你应该知道JavaScript是基于单线程的语言，这意味着一次只能运行一个任务。那你在<em class="nq"> setTimeout </em>里的回调函数呢？</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="a652" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查此代码并在您的浏览器控制台中运行它。尽管有<em class="nq"> setTimeout，</em>应该在100毫秒内执行，但它似乎不会这么快运行。打印出<code class="fe om on oo op b">'print'</code>好像至少要几秒钟吧？是的。因为JavaScript是基于单线程的。所以，由于<code class="fe om on oo op b">cnt</code>被<em class="nq"> for-loop增加，</em>你的<em class="nq"> setTimeout </em>必须等到它完成<em class="nq">。</em></p><p id="23e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着您在<em class="nq"> setTimeout </em>中设置的100毫秒并不意味着回调函数将在100毫秒内的准确时间被调用。</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="pb ol l"/></div></figure><p id="1338" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<em class="nq"> setTimeout(也叫setInterval) </em>的另一个问题是，有时，甚至有时会导致浏览器丢失一帧。这是什么意思？</p><h1 id="d000" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">为什么我的网站这么慢？是因为你没有尊重16ms！</h1><p id="b665" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">你可能听说过什么是FPS，<em class="nq">帧每秒</em>。这就是让用户觉得你的浏览器不慢的价值的重要性。这实际上不仅仅是关于网络。动画、电影或任何其他应该连续向用户展示某些东西的材料，理想的每秒帧数是60。这样用户就不会觉得慢或者有延迟。</p><p id="c2be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">60FPS意味着每秒60帧。有了这个事实，我们就可以得出那个计算。</p><pre class="og oh oi oj gt or op os ot aw ou bi"><span id="b8b6" class="nu ll iq op b gy ov ow l ox oy">60FPS = 60 frames per second = 16 ms per frame</span></pre><p id="0670" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一帧的最佳时间是16ms，它不会让用户厌烦等待你的页面。而我们上面讲的<em class="nq"> setTimeout </em>就不能满足这个条件。</p><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pc"><img src="../Images/a703463ff2a47dbb7a8ac0bedf71019d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KmOiKHbzv0ZiDZzfe0CPLg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">setTimeout can cause the browser to miss a frame</figcaption></figure><p id="28f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://developers.google.com/web/fundamentals/performance/rendering/optimize-javascript-execution" rel="noopener ugc nofollow" target="_blank"> <em class="nq">点击这里查看更多关于这个</em> </a>。</p><h2 id="d076" class="nu ll iq bd lm nv nw dn lq nx ny dp lu ko nz oa ly ks ob oc mc kw od oe mg of bi translated">结论</h2><p id="3052" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko nk kq kr ks nl ku kv kw nm ky kz la ij bi translated">如果你用JS定时器运行动画，我建议你只使用<em class="nq"> requestAnimationFrames </em>，除非有特殊原因要使用<em class="nq"> setTimeout </em>。</p><h1 id="5b91" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">要小心的事情</h1><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pd"><img src="../Images/c0abc160d9f28041149def374c44a33c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Rc_jWYZsJD_Q35Qx"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@frostroomhead?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Rodion Kutsaev</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a412" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当你在JavaScript中使用定时器函数时，有一件事你必须知道。是时候停止定时器功能了。</p><p id="50da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我前面说过，JavaScript定时器函数在生成时返回<em class="nq">时间戳</em>，它是找到回调函数的关键。另一个与生成和执行定时器功能同样重要的问题是如何停止定时器功能。</p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="26aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看到，以<em class="nq">时间戳</em>为参数调用<em class="nq"> clearTimeout </em>和<em class="nq"> clearInterval </em>可以停止<em class="nq"> setTimeout </em>和<em class="nq"> setInterval </em>。当你使用完定时器功能后，清除它总是好的。</p><p id="b9b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事情是<em class="nq"> requestAnimationFrame </em>。下面是关于<a class="ae kc" href="https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe" rel="noopener ugc nofollow" target="_blank"><em class="nq">requestAnimationFrame如何工作</em> </a>的链接。如果你想了解更多信息，你可以点击它。</p><blockquote class="nn no np"><p id="1f3d" class="kd ke nq kf b kg kh ki kj kk kl km kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">… <br/> 3。将目标的<a class="ae kc" href="https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frame-callback-identifier" rel="noopener ugc nofollow" target="_blank">动画帧回调标识符</a>加1，结果为handle。<br/> 4。让回调成为目标的<a class="ae kc" href="https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#list-of-animation-frame-callbacks" rel="noopener ugc nofollow" target="_blank">动画帧回调的映射</a>。<br/> …</p></blockquote><p id="588a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当<em class="nq"> setTimeout </em>在<em class="nq"> x毫秒</em>(技术上来说，<em class="nq"> x + y毫秒</em>正如我在本文前面解释的那样)被执行时，<em class="nq"> requestAnimationFrame </em>保持在名为<em class="nq">动画帧请求回调列表</em>的列表中。</p><p id="720a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">创建的<em class="nq"> requestAnimationFrame </em>越多，列表中的处理程序就越多。并且每次调用回调函数后，都必须将它从列表中删除。</strong></p><figure class="og oh oi oj gt jr"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="2ca9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意<em class="nq"> cancelAnimationFrame </em>，它从列表中去掉了回调函数，每次在生成新的<em class="nq"> requestAnimationFrame </em>之前都会被调用。</p><p id="41a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我使用<em class="nq">画布</em>在仪表板上工作时，我没有调用<em class="nq"> cancelAnimationFrame </em>。后来怎么样了？由于网络浏览器几天没有关闭，计时器标识符在2M上空出现。页面完全停了，让我在那个问题上困了五天多才解决。</p></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><p id="b5f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">谢谢你看我的帖子！希望你理解JavaScript定时器函数。</p></div></div>    
</body>
</html>