<html>
<head>
<title>React — Component communication using PubSubJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React —使用PubSubJS的组件通信</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-component-communication-using-pubsubjs-1bec85388b1e?source=collection_archive---------3-----------------------#2020-02-03">https://javascript.plainenglish.io/react-component-communication-using-pubsubjs-1bec85388b1e?source=collection_archive---------3-----------------------#2020-02-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d35c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在之前位于<a class="ae kl" href="https://medium.com/@bugz.app.developer/easy-tutorial-on-react-callbacks-fad6a51cc8f1" rel="noopener">这里</a>的帖子中，我已经讨论了关于使用回调的子- &gt;父通信。</p><p id="eba4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这一篇中，我想讨论一些更非传统的东西——不相关组件之间的<strong class="jp ir">通信。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/24de013e89c0f6fb0882b4141b4a5ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kTqlCOkDW660r5DTTK93-A.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae kl" href="https://unsplash.com/@noah0220?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Yuxiang Zhang</a> on <a class="ae kl" href="https://unsplash.com/s/photos/arrows?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="4b30" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍pub subjects</h1><p id="15b1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">PubSubJS是一个用JavaScript编写的基于<a class="ae kl" href="http://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering" rel="noopener ugc nofollow" target="_blank">主题的</a> <a class="ae kl" href="http://en.wikipedia.org/wiki/Publish/subscribe" rel="noopener ugc nofollow" target="_blank">发布/订阅</a>库。</p><p id="460b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多信息请点击此处—<a class="ae kl" href="https://www.npmjs.com/package/pubsub-js" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/pubsub-js</a></p><h1 id="2ef6" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">装置</h1><p id="f74e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">使用下面的命令包含库</p><pre class="kn ko kp kq gt mf mg mh mi aw mj bi"><span id="a978" class="mk ld iq mg b gy ml mm l mn mo">npm i pubsub-js</span></pre><h1 id="6427" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">高级图表</h1><p id="dc2f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">这是一个简单的概念。</p><p id="55a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">发布者发布主题。</p><p id="0767" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">订阅者订阅一个主题，并读取与该主题相关的数据。</p><p id="26ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是Apache Kafka等系统中的普遍模式。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/650bf710dc863a0baecc6917823a6605.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*jF8CgllMQHrMzbWN3L_5Wg.jpeg"/></div></figure><h1 id="1cf6" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">源组件</h1><p id="c274" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在源组件中添加以下代码</p><pre class="kn ko kp kq gt mf mg mh mi aw mj bi"><span id="f6ae" class="mk ld iq mg b gy ml mm l mn mo"><strong class="mg ir">import </strong>PubSub <strong class="mg ir">from 'pubsub-js'</strong>;</span><span id="7d61" class="mk ld iq mg b gy mq mm l mn mo">const pushToTopic = () =&gt; {<br/>    PubSub.publish(<strong class="mg ir">'MY_TOPIC'</strong>, 'random data');<br/>}</span></pre><p id="15aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的代码定义了一个函数，它将一个<strong class="jp ir">‘随机数据’</strong>字符串发布到一个主题名<strong class="jp ir">‘MY _ TOPIC’中。</strong></p><p id="7d18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在一个useEffect钩子或者一个按钮点击时调用这个函数。</p><h1 id="a3c9" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">目标组件</h1><p id="fbb1" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">将以下代码添加到目标组件中</p><pre class="kn ko kp kq gt mf mg mh mi aw mj bi"><span id="6104" class="mk ld iq mg b gy ml mm l mn mo"><strong class="mg ir">import </strong>PubSub <strong class="mg ir">from 'pubsub-js'</strong>;</span><span id="1805" class="mk ld iq mg b gy mq mm l mn mo"><strong class="mg ir">const </strong>mySubscriber = (msg, data) =&gt; {<br/><br/>    <strong class="mg ir">switch </strong>(msg) {<br/>        <strong class="mg ir">case 'MY_TOPIC'</strong>:<br/>             console.log(data);<br/>             break;<br/>        <strong class="mg ir">default</strong>:<br/>            <strong class="mg ir">break</strong>;<br/>    }<br/>};</span><span id="57b2" class="mk ld iq mg b gy mq mm l mn mo"><em class="mr">useEffect</em>(() =&gt; {<br/>    PubSub.subscribe(<strong class="mg ir">'MY_TOPIC'</strong>, mySubscriber);<br/>});</span></pre><p id="d527" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里发生了几件事</p><ul class=""><li id="fb40" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated">我们在useEffect挂钩中添加了subscribe方法</li><li id="4aac" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">我们提供了一个函数<strong class="jp ir"> mySubscriber，</strong>，它接受主题和输入数据。</li></ul><h1 id="91b9" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">摘要</h1><p id="a770" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">把它连接在一起，下面的事情正在发生</p><ul class=""><li id="7d4e" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated">源组件将数据发布到主题</li><li id="1dd6" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">目标订阅主题，接收可用的数据，并在提供的函数中执行进一步的处理。</li></ul><p id="0387" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个例子设计得非常简单，但是我希望它展示了使用PubSubJS来创建即时反应的组件的可能性，即使它们是不相关的，即不属于同一个父对象。</p><p id="30be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请让我知道这是否有帮助。</p></div></div>    
</body>
</html>