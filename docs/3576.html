<html>
<head>
<title>Create a Calendar Web Component with Stencil.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Stencil.js创建一个日历Web组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-calendar-with-stencil-js-web-component-deb091456df3?source=collection_archive---------4-----------------------#2020-10-10">https://javascript.plainenglish.io/create-a-calendar-with-stencil-js-web-component-deb091456df3?source=collection_archive---------4-----------------------#2020-10-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/f39f49a682b9f2c7cfc8e7f188406fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flrGmGkGF3JcwfDoca4QpQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Calendar built with Stencil.js, with a material like design</figcaption></figure><p id="e222" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">为什么与Angular、React或其他框架相比，Stencil (Web组件)可能是您项目的理想选择？</p><p id="0cb0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">看你想实现什么了。我喜欢和Angular一起工作，但是有些情况下Stencil是更好的选择或者理想的伴侣。</p><p id="7fe8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">例如，我在一家公司工作，该公司与另一家公司共享他们的一些组件，他们使用Angular，如果你有类似的需求，你可以考虑对你想要共享的组件使用Stencil，因为组件会小得多，使用HTML标准，在任何地方集成它们都会容易得多。</p><p id="a976" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">对于本教程，我假设您已经熟悉:</p><ul class=""><li id="48b7" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">Javascript(类型脚本)</li><li id="61f1" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">命令行</li><li id="2571" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">半铸钢ˌ钢性铸铁(Cast Semi-Steel)</li><li id="44ee" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">NPM</li></ul><p id="dd5f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在这里你可以阅读更多关于你为什么想要使用Stencil的信息。</p><p id="7c81" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在这篇文章中，我想和你一起用模板实现一个简单的日历。它将有一个简单的设计，几个事件，和公开暴露的属性。</p><p id="0ba9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，我们从命令行生成一个新的模板项目:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="a6da" class="lv lw in lr b gy lx ly l lz ma">npm init stencil</span></pre><p id="a2eb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">命令行提示将询问您希望如何初始化您的模板项目选择&gt;<strong class="kb io">组件</strong>，项目名称<strong class="kb io">模板日历</strong>，或者您喜欢的任何名称，并用y确认</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="d4ba" class="lv lw in lr b gy lx ly l lz ma"># switch into the new project folder<br/>cd stencil-calendar</span><span id="de5c" class="lv lw in lr b gy mb ly l lz ma"># install the dependencies<br/>npm install</span></pre><p id="2d57" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们现在有了一个新的文件夹模板日历，其中包含了新组件的基本结构。我们删除了utils文件夹中的文件、my-component文件夹中以e2e.ts和spec.ts结尾的用于测试的文件以及readme.md文件，这样就可以更容易地专注于我们将要处理的部分。在my-component.tsx文件中，我们还需要删除utils文件的用法。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="2402" class="lv lw in lr b gy lx ly l lz ma"># delete<br/>import { format } from '../../utils/utils';</span><span id="19fe" class="lv lw in lr b gy mb ly l lz ma">private getText(): string {<br/>  return format(this.first, this.middle, this.last);<br/>}</span><span id="7806" class="lv lw in lr b gy mb ly l lz ma"><em class="mc">/**<br/> * The first name<br/> */<br/></em>@Prop() first: string;<br/><br/><em class="mc">/**<br/> * The middle name<br/> */<br/></em>@Prop() middle: string;<br/><br/><em class="mc">/**<br/> * The last name<br/> */<br/></em>@Prop() last: string;</span><span id="1850" class="lv lw in lr b gy mb ly l lz ma"># replace following in the render function <br/>&lt;div&gt;Hello, World! I'm {this.getText()}&lt;/div&gt;</span><span id="2a54" class="lv lw in lr b gy mb ly l lz ma"># by just a div<br/>&lt;div&gt;&lt;/div&gt;</span></pre><p id="d3d2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">对于本教程，有三个感兴趣的文件:index.html、my-webcomponent.tsx和my-webcomponent.css</p><p id="81ac" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，我们快速查看一下index.html文件，在文件头中有两个脚本导入，用于加载src/components文件夹中的组件，在文件体中，我们使用了组件(您可以删除这两个属性):</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="1397" class="lv lw in lr b gy lx ly l lz ma">&lt;my-component&gt;&lt;/my-component&gt;</span></pre><p id="b850" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，我们来看看my-component.tsx，它的结尾是tsx，而不是ts，因为在渲染函数中，我们使用JSX来声明HTML结构。这是将HTML写入javascript文件的好方法。你可以在这里阅读更多相关信息<a class="ae ll" href="https://stenciljs.com/docs/templating-jsx" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a2b9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">Stencil使用Typescript Decorators @Component()，我们向它传递一个config对象。在模板<a class="ae ll" href="https://stenciljs.com/docs/decorators" rel="noopener ugc nofollow" target="_blank">中阅读更多关于装饰者的内容。我们定义了标签名“我的组件”，你可以选择任何你喜欢的，但不要忘记改变它也在index.html文件中。我们将styleUrl和参数shadow设置为true，这意味着组件的结构和样式是从“普通”DOM封装的。你可以在这里阅读更多关于影子王国</a><a class="ae ll" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="5735" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在渲染函数中，我们为组件定义HTML结构，你可以使用HTML标签，也可以使用你在模板项目中定义的其他组件。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="953f" class="lv lw in lr b gy lx ly l lz ma"><strong class="lr io">@Component</strong>({<br/>  tag: 'my-component',<br/>  styleUrl: 'my-component.css',<br/>  shadow: true,<br/>})<br/>export class MyComponent {<br/>  <strong class="lr io">render</strong>() {<br/>    return &lt;div&gt;&lt;/div&gt;;<br/>  }<br/>}</span></pre><p id="bd87" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最后一个文件是my-component.css文件，它将保存组件的样式。</p><p id="9738" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们现在用逻辑一步一步地填充my-webcomponent.tsx文件。</p><p id="960f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">首先，我们定义属性。稍后，您可以将标签上的这些属性传递给组件，例如<my-component show-fill-days="”false”"/>。在组件中，使用camelcase定义属性，在标记上使用dash-case设置属性。<a class="ae ll" href="https://stenciljs.com/docs/properties" rel="noopener ugc nofollow" target="_blank">模版文件属性</a>。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="dab5" class="lv lw in lr b gy lx ly l lz ma"><strong class="lr io">@Prop</strong>() dayNames = [<br/>  'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'<br/>];<br/><strong class="lr io">@Prop</strong>() monthNames = [<br/>  'Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'<br/>];<br/><strong class="lr io">@Prop</strong>() showFillDays = true;</span></pre><p id="e549" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">然后，我们定义几个状态变量，当一个变量有这样的修饰时，这个类变量的每次变化都会调用render方法。<a class="ae ll" href="https://stenciljs.com/docs/state" rel="noopener ugc nofollow" target="_blank">模版对接状态</a>。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="e4f8" class="lv lw in lr b gy lx ly l lz ma"><strong class="lr io">@State</strong>() date = Calendar.<em class="mc">getToday</em>();<strong class="lr io"><br/>@State</strong>() daysInMonth: number[];<br/><strong class="lr io">@State</strong>() selectedDate: CalendarEntry;<br/><strong class="lr io">@State</strong>() eventDates = [];</span></pre><p id="4511" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">然后，我们定义了两个事件，当日历中的某一天或某个月发生变化时，这两个事件将被触发。<a class="ae ll" href="https://stenciljs.com/docs/events" rel="noopener ugc nofollow" target="_blank">模版文件事件</a>。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="ce3b" class="lv lw in lr b gy lx ly l lz ma"><strong class="lr io">@Event</strong>({<br/>  eventName: 'dayChanged',<br/>  composed: true,<br/>  cancelable: true,<br/>  bubbles: true,<br/>}) dayChanged: EventEmitter&lt;CalendarEntry&gt;;<br/><strong class="lr io">@Event</strong>({<br/>  eventName: 'monthChanged',<br/>  composed: true,<br/>  cancelable: true,<br/>  bubbles: true,<br/>}) monthChanged: EventEmitter&lt;CalendarEntry&gt;;</span></pre><p id="65be" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最后一个变量我们稍后会用到一些内部的东西:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="d465" class="lv lw in lr b gy lx ly l lz ma">private fillStartCount: number;<br/>private fillEndCount: number;<br/>readonly today: CalendarEntry;</span></pre><p id="409c" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在构造函数中，我们今天用一个类的函数进行初始化，这个类我们后来放入utils文件夹:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="fb04" class="lv lw in lr b gy lx ly l lz ma">constructor() {<br/>  this.today = Calendar.<em class="mc">getToday</em>();<br/>}</span></pre><p id="8d66" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们在日期属性中添加了一个观察器，这个函数在日期改变时被调用，观察日期将改变所选择的日期并赋予它另一种样式。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="7a46" class="lv lw in lr b gy lx ly l lz ma"><strong class="lr io">@Watch</strong>('date')<br/>watchDate(date: CalendarEntry): void {<br/>  if ('month' in date &amp;&amp; 'year' in date) {<br/>    this.selectedDate = date;<br/>  }<br/>}</span></pre><p id="7413" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们使用一个生命周期方法来初始化日历，它在渲染函数之前被触发，在这里看到模板<a class="ae ll" href="https://stenciljs.com/docs/component-lifecycle" rel="noopener ugc nofollow" target="_blank">的完整生命周期</a>。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="26f6" class="lv lw in lr b gy lx ly l lz ma"><strong class="lr io">componentWillLoad</strong>() {<br/>  this.setCalendarDetails();<br/>}</span></pre><p id="13d9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">接下来，我们定义一些内部函数，我希望方法和变量的命名足够清楚，这样你就可以很容易地读懂每一行的目的。如果有什么不清楚的地方，欢迎在下面的评论中提问。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="336d" class="lv lw in lr b gy lx ly l lz ma">setCalendarDetails(): void {<br/>  const date = this.getValidDate();<br/>  const calendar = new Calendar(date.year, date.month);<br/>  this.daysInMonth = calendar.getCalendarDays();<br/><br/>  this.fillStartCount = calendar.getFillStartCount();<br/>  this.fillEndCount = (calendar.daysInCalendar - calendar.getFillEndCount());<br/>}<br/><br/>getValidDate(): CalendarEntry {<br/>  let date = this.date;<br/>  if (!('month' in this.date &amp;&amp; 'year' in this.date)) {<br/>    date = this.today;<br/>  }<br/><br/>  return date;<br/>}<br/><br/>dayChangedHandler(calendarEntry: CalendarEntry): void {<br/>  this.dayChanged.emit(calendarEntry);<br/>}<br/><br/>daySelectedHandler = (day): void =&gt; {<br/>  this.selectedDate = {<br/>    day,<br/>    month: this.date.month,<br/>    year: this.date.year<br/>  };<br/>  this.dayChangedHandler(this.selectedDate);<br/>}<br/><br/>monthChangedHandler(calendarEntry: CalendarEntry): void {<br/>  this.monthChanged.emit(calendarEntry);<br/>}<br/><br/>switchToPreviousMonth = (): void =&gt; {<br/>  if (this.date.month !== 1) {<br/>    this.date.month -= 1;<br/>  } else {<br/>    this.date.month = 12;<br/>    this.date.year -= 1;<br/>  }<br/><br/>  if (typeof this.date !== 'undefined') {<br/>    delete this.date.day;<br/>  }<br/><br/>  this.setCalendarDetails();<br/>  this.monthChangedHandler(this.date);<br/>}<br/><br/>switchToNextMonth = (): void =&gt; {<br/>  if (this.date.month !== 12) {<br/>    this.date.month += 1;<br/>  } else {<br/>    this.date.month = 1;<br/>    this.date.year += 1;<br/>  }<br/><br/>  delete this.date.day;<br/><br/>  this.setCalendarDetails();<br/>  this.monthChangedHandler(this.date);<br/>}<br/><br/>getDigitClassNames = (day: number, month: number, year: number, index: number): string =&gt; {<br/>  let classNameDigit = [];<br/>  if (day.toString().length === 1) {<br/>    classNameDigit.push('padding-single-digit');<br/>  }<br/><br/>  if (this.isToday(day, month, year, index)) {<br/>    classNameDigit.push('active');<br/>  }<br/><br/>  if (this.isSelectedDay(day, index)) {<br/>    classNameDigit.push('selected');<br/>  }<br/><br/>  if (this.eventDates.includes(day)) {<br/>    classNameDigit.push('has-event');<br/>  }<br/><br/>  return classNameDigit.join(' ');<br/>}<br/><br/>isToday(day: number, month: number, year: number, index: number): boolean {<br/>  return this.today.day === day<br/>    &amp;&amp; this.today.month === month<br/>    &amp;&amp; this.today.year === year<br/>    &amp;&amp; this.today.year === year<br/>    &amp;&amp; !(index &lt; this.fillStartCount || index &gt;= this.fillEndCount);<br/>}<br/><br/>isSelectedDay(day: number, index: number) {<br/>  return typeof this.selectedDate !== 'undefined'<br/>    &amp;&amp; this.selectedDate.day === day<br/>    &amp;&amp; this.selectedDate.month === this.date.month<br/>    &amp;&amp; this.selectedDate.year === this.date.year<br/>    &amp;&amp; !(index &lt; this.fillStartCount || index &gt;= this.fillEndCount);<br/>}</span></pre><p id="aca3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">组件类的最后一部分是render函数。我们利用三个点击事件来改变月份和设置选定的日期。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="b0b5" class="lv lw in lr b gy lx ly l lz ma">render() {<br/>  const date = this.getValidDate();<br/><br/>  return (<br/>    &lt;div class="calendar material"&gt;<br/>      &lt;header&gt;<br/>        &lt;span <strong class="lr io">onClick</strong>={this.switchToPreviousMonth}&gt;<br/>          {'&lt;'}<br/>        &lt;/span&gt;<br/>        &lt;span&gt;{this.monthNames[date.month - 1]} {date.year}&lt;/span&gt;<br/>        &lt;span <strong class="lr io">onClick</strong>={this.switchToNextMonth}&gt;<br/>           {'&gt;'}<br/>        &lt;/span&gt;<br/>      &lt;/header&gt;<br/>      &lt;div class="day-names"&gt;<br/>        {this.dayNames.map(dayName =&gt; &lt;span&gt;{dayName}&lt;/span&gt;)}<br/>      &lt;/div&gt;<br/>      &lt;div class="days-in-month"&gt;<br/>        {this.daysInMonth.map((day, index) =&gt; {<br/>          const classNameDigit = this.getDigitClassNames(day, date.month, date.year, index);<br/>          if (index &lt; this.fillStartCount || index &gt;= this.fillEndCount) {<br/>            return (<br/>              &lt;span class="disabled"&gt;{this.showFillDays ? day : ''}&lt;/span&gt;<br/>            );<br/>          } else {<br/>            return (<br/>              &lt;span <strong class="lr io">onClick</strong>={() =&gt; this.daySelectedHandler(day)}&gt;<br/>                &lt;i class={classNameDigit}&gt;<br/>                  {day}<br/>                &lt;/i&gt;<br/>              &lt;/span&gt;<br/>            );<br/>          }<br/>        })}<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="13e5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们组件的样式:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="1747" class="lv lw in lr b gy lx ly l lz ma">// src/components/my-component/my-component.css</span><span id="e339" class="lv lw in lr b gy mb ly l lz ma">.calendar {<br/>  width: 50%;<br/>  font-family: Arial, sans-serif;<br/>  padding: 1rem;<br/>}<br/><br/>.calendar &gt; * {<br/>  line-height: 3.5rem;<br/>}<br/><br/>header {<br/>  display: flex;<br/>  justify-content: space-between;<br/>  color: #666;<br/>  font-weight: bold;<br/>  font-size: 1.1rem;<br/>}<br/><br/>.calendar span {<br/>  flex-grow: 30;<br/>  width: calc(100% / 7);<br/>  text-align: center;<br/>}<br/><br/>.calendar header span:first-child,<br/>.calendar header span:last-child{<br/>  flex-grow: .1;<br/>  cursor: pointer;<br/>}<br/><br/>.day-names {<br/>  display: flex;<br/>}<br/><br/>.days-in-month {<br/>  display: flex;<br/>  flex-wrap: wrap;<br/>}<br/><br/>.days-in-month span {<br/>  cursor: pointer;<br/>  position: relative;<br/>}<br/><br/>.days-in-month i {<br/>  padding: .8rem;<br/>  font-style: normal;<br/>  position: relative;<br/>  width: 100%;<br/>}<br/><br/>.days-in-month i.padding-single-digit {<br/>  padding: .8rem 1.1rem;<br/>}<br/><br/>.days-in-month span.disabled {<br/>  color: #ccc;<br/>  cursor: default;<br/>}<br/><br/>/** Material style **/<br/>.material .days-in-month span:hover:not(.disabled) i:not(.selected) {<br/>  background: #e6d2f1;<br/>  border-radius: 50%;<br/>}<br/><br/>.material .days-in-month i.active {<br/>  border: 2px solid #000;<br/>  border-radius: 50%;<br/>  padding: .6rem;<br/>}<br/><br/>.material .days-in-month i.selected {<br/>  background: #902dc6;<br/>  color: #fff;<br/>  border-radius: 50%;<br/>}<br/><br/>.material .days-in-month i.has-event:before {<br/>  content: ' \25CF';<br/>  font-size: .7rem;<br/>  position: absolute;<br/>  top: .4rem;<br/>  left: 1.18rem;<br/>  color: #902dc6;<br/>}<br/><br/>.material .days-in-month i.selected.has-event:before {<br/>  color: #fff;<br/>}<br/><br/>.material .days-in-month i.active.has-event:before {<br/>  top: .1rem;<br/>  left: 1.1rem;<br/>}</span></pre><p id="9bac" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在utils文件夹中，我们添加了两个文件:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="bacb" class="lv lw in lr b gy lx ly l lz ma">// utils/calendar-entry.ts</span><span id="a251" class="lv lw in lr b gy mb ly l lz ma">export class CalendarEntry {<br/>  day?: number;<br/>  month: number;<br/>  year: number;<br/>}</span></pre><p id="8a26" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">一些用于处理日历的助手方法，捆绑到一个类中:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="1e51" class="lv lw in lr b gy lx ly l lz ma">// utils/calendar.ts</span><span id="36e3" class="lv lw in lr b gy mb ly l lz ma">import { CalendarEntry } from './calendar-entry';<br/><br/>export class Calendar {<br/>  readonly year: number;<br/>  readonly month: number;<br/>  readonly daysInCalendarWithFiveRows = 42;<br/>  readonly daysInCalendarWithFourRows = 35;<br/>  readonly daysInCalendarWithThreeRows = 28;<br/><br/>  public daysInCalendar = this.daysInCalendarWithFourRows;<br/><br/>  private fillStartCount = 0;<br/>  private fillEndCount = 0;<br/>  private currentMonthCount: number;<br/>  private fillCount = [6, 0, 1, 2, 3, 4, 5];<br/><br/>  constructor(year: number, month: number) {<br/>    this.year = year;<br/>    this.month = month;<br/>  }<br/><br/>  public getCalendarDays(): number[] {<br/>    const daysOfCurrentMonth = this.getDaysOfCurrentMonth();<br/>    const fillStartCount = this.fillCount[this.getFirstDayOfMonth()];<br/>    const fillEndCount = this.daysInCalendarWithFourRows - (daysOfCurrentMonth.length + fillStartCount);<br/><br/>    this.currentMonthCount = daysOfCurrentMonth.length;<br/>    this.fillStartCount = fillStartCount;<br/>    this.fillEndCount = fillEndCount;<br/><br/>    const fillStart = fillStartCount &gt; 0 ? this.getDaysOfLastMonth(fillStartCount) : [];<br/>    const fillEnd = this.getDaysOfNextMonth(fillEndCount);<br/><br/><br/>    return fillStart.concat(daysOfCurrentMonth).concat(fillEnd);<br/>  }<br/><br/>  private getDaysOfCurrentMonth(): number[] {<br/>    return this.getDaysOfMonth(this.month);<br/>  }<br/><br/>  private getDaysOfLastMonth(fillStartCount: number): number[] {<br/>    const daysOfMonth = this.getDaysOfMonth(this.month - 1);<br/><br/>    return daysOfMonth.slice(-fillStartCount);<br/>  }<br/><br/>  private getDaysOfNextMonth(endCount: number): number[] {<br/>    const daysOfMonth = this.getDaysOfMonth(this.month + 1);<br/><br/>    let slicedDays;<br/>    if (endCount &lt;= -1) {<br/>      endCount = this.daysInCalendarWithFiveRows - (this.currentMonthCount + this.fillStartCount);<br/>      slicedDays = daysOfMonth.slice(0, endCount);<br/>      this.daysInCalendar = this.daysInCalendarWithFiveRows;<br/>      this.fillEndCount = endCount;<br/>    } else if (endCount === 7 &amp;&amp; (this.currentMonthCount + this.fillStartCount) === 28) {<br/>      endCount = this.daysInCalendarWithThreeRows - (this.currentMonthCount + this.fillStartCount);<br/>      slicedDays = daysOfMonth.slice(0, endCount);<br/>      this.daysInCalendar = this.daysInCalendarWithThreeRows;<br/>      this.fillEndCount = endCount;<br/>    } else {<br/>      slicedDays = daysOfMonth.slice(0, endCount);<br/>    }<br/><br/>    return slicedDays;<br/>  }<br/><br/>  private getDaysOfMonth(month: number): number[] {<br/>    const daysOfMonth = new <strong class="lr io"><em class="mc">Date</em></strong>(this.year, month, 0).getDate();<br/><br/>    return <strong class="lr io"><em class="mc">Array</em></strong>.from({length: daysOfMonth}, (_, i) =&gt; i + 1);<br/>  }<br/><br/>  public getFirstDayOfMonth(): number {<br/>    return new <strong class="lr io"><em class="mc">Date</em></strong>(this.year, this.month - 1, 1).getDay();<br/>  }<br/><br/>  public getFillStartCount(): number {<br/>    return this.fillStartCount;<br/>  }<br/><br/>  public getFillEndCount(): number {<br/>    return this.fillEndCount;<br/>  }<br/><br/>  public static <em class="mc">getToday</em>(): CalendarEntry {<br/>    return {<br/>      day: new <strong class="lr io"><em class="mc">Date</em></strong>().getDate(),<br/>      month: new <strong class="lr io"><em class="mc">Date</em></strong>().getMonth() + 1,<br/>      year: new <strong class="lr io"><em class="mc">Date</em></strong>().getFullYear()<br/>    };<br/>  }<br/>}</span></pre><p id="7bc3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最后，我们可以运行我们的实现，看看它是如何工作的，在项目文件夹中的命令行上运行:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="f0b2" class="lv lw in lr b gy lx ly l lz ma">npm start</span></pre><p id="aaac" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在index.html文件中，您可以设置我们定义的属性。</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="be53" class="lv lw in lr b gy lx ly l lz ma">&lt;my-component <strong class="lr io">show-fill-days</strong>="false"&gt;&lt;/my-component&gt;</span><span id="03fe" class="lv lw in lr b gy mb ly l lz ma">&lt;script&gt;<br/>  const calendar = document.querySelector('my-component');<br/>  calendar.<strong class="lr io">dayNames </strong>= [<br/>    'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa', 'So'<br/>  ];<br/>  calendar.<strong class="lr io">monthNames </strong>= [<br/>    'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'<br/>  ];<br/>&lt;/script&gt;</span></pre><p id="dc20" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">你可以在不同的月份之间切换，选择一天，它就会高亮显示。它有一个非常基本的样式，如果你喜欢玩日历，你可以添加更多的逻辑到日历中，如果你想实现你的想法，分享它们会很好。</p><p id="9828" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">点击这里访问Github上的项目资源库<a class="ae ll" href="https://github.com/pguso/stencil-calendar" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8180" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我希望你喜欢这个教程，非常欢迎你的反馈。</p><p id="d07e" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="mc">更多内容尽在</em><a class="ae ll" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank">T5】plain English . ioT7】</a></p></div></div>    
</body>
</html>