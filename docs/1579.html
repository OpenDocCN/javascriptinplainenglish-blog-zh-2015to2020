<html>
<head>
<title>5 Examples Of React Higher Order Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5反应高阶组分的例子</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/5-examples-of-react-higher-order-components-d3069affd4c0?source=collection_archive---------2-----------------------#2020-04-03">https://javascript.plainenglish.io/5-examples-of-react-higher-order-components-d3069affd4c0?source=collection_archive---------2-----------------------#2020-04-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/01ca668f80d9743969b95b54e5a93268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X0MYZOxnaOhcWGLn.jpg"/></div></div></figure><h1 id="baaa" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">为什么是高阶组件(HOC) </strong></h1><p id="be7b" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">冗余代码在编程领域不受欢迎，高阶组件(HOC)通常用于减少冗余</p><ul class=""><li id="c132" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">HOC是一个以一个分量作为输入，输出一个分量的函数。</li></ul><p id="04db" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir">【输入分量===输出分量；仅逻辑变化使用变化使用HOC] </strong></p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="a972" class="mp jz iq bd ka mq mr dn ke ms mt dp ki lh mu mv km ll mw mx kq lp my mz ku na bi translated">每当发生<strong class="ak"> <em class="nb">装载</em> </strong>时，1ST_ HOC向服务器发送事件</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6915" class="mp jz iq nh b gy nl nm l nn no">// withMountEvent.js</span><span id="b0cc" class="mp jz iq nh b gy np nm l nn no">function withMountEvent(InputComponent, componentName) {<strong class="nh ir"> // 1</strong></span><span id="6c96" class="mp jz iq nh b gy np nm l nn no"> return class OutputComponent extends Component {</span><span id="7816" class="mp jz iq nh b gy np nm l nn no">  componentDidMount() {</span><span id="c21c" class="mp jz iq nh b gy np nm l nn no">    sendMountEvent(componentName);</span><span id="e1a0" class="mp jz iq nh b gy np nm l nn no">  }</span><span id="1e6e" class="mp jz iq nh b gy np nm l nn no">  render() {</span><span id="1034" class="mp jz iq nh b gy np nm l nn no">    return &lt;InputComponent {...this.props} /&gt;;</span><span id="c2df" class="mp jz iq nh b gy np nm l nn no">  }</span><span id="2f2f" class="mp jz iq nh b gy np nm l nn no"> };</span><span id="4f6b" class="mp jz iq nh b gy np nm l nn no">}</span><span id="e973" class="mp jz iq nh b gy np nm l nn no">// MyComponent.jsx</span><span id="48f8" class="mp jz iq nh b gy np nm l nn no">function MyComponent() {</span><span id="d252" class="mp jz iq nh b gy np nm l nn no">  // ...</span><span id="e90e" class="mp jz iq nh b gy np nm l nn no">}</span><span id="3590" class="mp jz iq nh b gy np nm l nn no">export default withMountEvent(MyComponent, 'MyComponent'); <strong class="nh ir">// 2</strong></span></pre><p id="69fd" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir"> // 1 : </strong> <code class="fe nq nr ns nh b">withMountEvent</code>功能是特设的。换句话说，一个叫做<code class="fe nq nr ns nh b">sendMountEvent</code>的普通函数是使用<code class="fe nq nr ns nh b">withMountEvent</code>函数实现的</p><p id="3573" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir"> // 2 : </strong>如果一个组件想要使用一个名为<code class="fe nq nr ns nh b">sendMountEvent</code>的公共函数，则该组件作为HOC的输入</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="27b8" class="mp jz iq bd ka mq mr dn ke ms mt dp ki lh mu mv km ll mw mx kq lp my mz ku na bi translated">发送“已安装”是否发生的2ND_ HOC</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="3b70" class="mp jz iq nh b gy nl nm l nn no">function withHasMounted(inputComponent) {</span><span id="83b5" class="mp jz iq nh b gy np nm l nn no">  return class OutputComponent extends React.Component {</span><span id="2745" class="mp jz iq nh b gy np nm l nn no">    state = {</span><span id="899e" class="mp jz iq nh b gy np nm l nn no">      hasMounted: false,</span><span id="2a78" class="mp jz iq nh b gy np nm l nn no">    };</span><span id="8618" class="mp jz iq nh b gy np nm l nn no">  componentDidMount() {</span><span id="96e3" class="mp jz iq nh b gy np nm l nn no">    this.setState({ hasMounted: true });</span><span id="a2f4" class="mp jz iq nh b gy np nm l nn no">  }</span><span id="d9d8" class="mp jz iq nh b gy np nm l nn no">  render() {</span><span id="3442" class="mp jz iq nh b gy np nm l nn no">    const { hasMounted } = this.state;</span><span id="8abc" class="mp jz iq nh b gy np nm l nn no">    return &lt;inputComponent {...this.props} hasMounted={hasMounted} /&gt;; <strong class="nh ir">// 1</strong></span><span id="be47" class="mp jz iq nh b gy np nm l nn no">  }</span><span id="daa6" class="mp jz iq nh b gy np nm l nn no"> };</span><span id="b358" class="mp jz iq nh b gy np nm l nn no">}</span></pre><p id="7346" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir"> //1 : </strong> <code class="fe nq nr ns nh b">hasMounted</code>属性被传递给输出组件</p><p id="2c78" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir">有用案例:</strong>在一个服务器渲染的项目中，有一种情况是你想只从客户端渲染一些组件。如果组件是在挂载生命周期之后<strong class="ky ir">呈现的，那么它只从客户端呈现，所以上面的代码变得非常有用</strong></p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="e6c6" class="mp jz iq bd ka mq mr dn ke ms mt dp ki lh mu mv km ll mw mx kq lp my mz ku na bi translated">基于登录状态呈现不同组件的3RD_ HOC</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="9ea4" class="mp jz iq nh b gy nl nm l nn no">function withOnlyLogin(InputComponent) {</span><span id="e956" class="mp jz iq nh b gy np nm l nn no">  return function({ isLogin, ...rest}) {</span><span id="6825" class="mp jz iq nh b gy np nm l nn no">    if (isLogin) {</span><span id="415d" class="mp jz iq nh b gy np nm l nn no">      return &lt;InputComponent {...rest} /&gt;;</span><span id="e6df" class="mp jz iq nh b gy np nm l nn no">    } else {</span><span id="deb4" class="mp jz iq nh b gy np nm l nn no">      return &lt;p&gt;You are not authenticated&lt;/p&gt;;</span><span id="8583" class="mp jz iq nh b gy np nm l nn no">    }</span><span id="1948" class="mp jz iq nh b gy np nm l nn no">  };</span><span id="e37d" class="mp jz iq nh b gy np nm l nn no">}</span></pre><ul class=""><li id="9b1f" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">如果<strong class="ky ir">是Login === true </strong>，则渲染输入组件，否则显示<strong class="ky ir">“您未通过身份验证”</strong></li><li id="4dff" class="lu lv iq ky b kz nt ld nu lh nv ll nw lp nx lt mb mc md me bi translated">简单的代码，但是没有<code class="fe nq nr ns nh b">withOnlyLogin</code> HOC，你可能需要一个代码来检查每个组件的登录状态(这是非常多余的)</li><li id="f5ac" class="lu lv iq ky b kz nt ld nu lh nv ll nw lp nx lt mb mc md me bi translated">在HOC中，可以使用一些属性并传递其余的属性<code class="fe nq nr ns nh b">...rest</code></li></ul></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="0c51" class="mp jz iq bd ka mq mr dn ke ms mt dp ki lh mu mv km ll mw mx kq lp my mz ku na bi translated">用于调试的4TH_ HOC</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="7da6" class="mp jz iq nh b gy nl nm l nn no">function withDebug(InputComponent) {</span><span id="b384" class="mp jz iq nh b gy np nm l nn no">  return class OutputComponent extends InputComponent {</span><span id="2bb7" class="mp jz iq nh b gy np nm l nn no">    render() {</span><span id="4368" class="mp jz iq nh b gy np nm l nn no">      return (</span><span id="9bad" class="mp jz iq nh b gy np nm l nn no">        &lt;React.Fragment&gt;</span><span id="f2b9" class="mp jz iq nh b gy np nm l nn no">          &lt;p&gt;props: {JSON.stringify(this.props)}&lt;/p&gt; <strong class="nh ir">// 1</strong></span><span id="56e2" class="mp jz iq nh b gy np nm l nn no">          &lt;p&gt;props: {JSON.stringify(this.props)}&lt;/p&gt;</span><span id="5f7b" class="mp jz iq nh b gy np nm l nn no">          {super.render()} <strong class="nh ir">// 2</strong></span><span id="a395" class="mp jz iq nh b gy np nm l nn no">       &lt;/React.Fragment&gt;</span><span id="5a68" class="mp jz iq nh b gy np nm l nn no">      );</span><span id="a6d2" class="mp jz iq nh b gy np nm l nn no">    }</span><span id="59cb" class="mp jz iq nh b gy np nm l nn no"> };</span><span id="2f95" class="mp jz iq nh b gy np nm l nn no">}</span></pre><p id="d3c5" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir"> // 1 : </strong>使用<code class="fe nq nr ns nh b">this</code>访问输入组件的状态和属性</p><p id="aa51" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir"> // 2: </strong>调用<code class="fe nq nr ns nh b">render</code>方法输入组件。换句话说，<code class="fe nq nr ns nh b">withDebug</code> HOC一直显示输入组件的道具&amp;状态</p><p id="6f1d" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><strong class="ky ir"> HOC使用类继承</strong></p><p id="3282" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mf lj lk ll mg ln lo lp mh lr ls lt ij bi translated"><em class="ny">上面的例子使用了使用类继承的HOC</em></p><ul class=""><li id="7946" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">OutputComponent <code class="fe nq nr ns nh b">OutputComponent</code>可以访问InputComponent <code class="fe nq nr ns nh b">InputComponent</code>的实例</li><li id="01b4" class="lu lv iq ky b kz nt ld nu lh nv ll nw lp nx lt mb mc md me bi translated">换句话说，OutputComponent可以访问输入组件的props、状态、变量、方法、生命周期的实例</li></ul><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="03ca" class="mp jz iq nh b gy nl nm l nn no">function withSomething(InputComponent) {</span><span id="288e" class="mp jz iq nh b gy np nm l nn no">  return class OutputComponent extends InputComponent {</span><span id="242b" class="mp jz iq nh b gy np nm l nn no">  // ...</span><span id="71c2" class="mp jz iq nh b gy np nm l nn no">  };</span><span id="959d" class="mp jz iq nh b gy np nm l nn no">}</span></pre></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="8200" class="mp jz iq bd ka mq mr dn ke ms mt dp ki lh mu mv km ll mw mx kq lp my mz ku na bi translated">第5个_多个hoc</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="bcac" class="mp jz iq nh b gy nl nm l nn no">withDubg(withDiv(myComponent));</span></pre><ul class=""><li id="42e3" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">可以使用多个hoc，但是使用太多的hoc对性能没有好处&amp;使调试变得困难</li></ul><h2 id="e744" class="mp jz iq bd ka mq mr dn ke ms mt dp ki lh mu mv km ll mw mx kq lp my mz ku na bi translated"><strong class="ak">用简单英语写的JavaScript的一个注释:</strong></h2><p id="6b7a" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，请用你的Medium用户名发邮件到<a class="ae nz" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">submissions@javascriptinplainenglish.com</a>给我们，我们会把你添加为作者。</p></div></div>    
</body>
</html>