<html>
<head>
<title>JavaScript Events Handlers — oncontextmenu and oncuechange</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript事件处理程序— oncontextmenu和oncuechange</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-events-handlers-oncontextmenu-and-oncuechange-fd6474fdf96e?source=collection_archive---------5-----------------------#2020-01-22">https://javascript.plainenglish.io/javascript-events-handlers-oncontextmenu-and-oncuechange-fd6474fdf96e?source=collection_archive---------5-----------------------#2020-01-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn js jt ju jv gh gi paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gh gi jr"><img src="../Images/273c7ecc5fecf6a96b04f9fa073dba77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GBZCaxroXuFV_H_m"/></div></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">Photo by <a class="ae kg" href="https://unsplash.com/@shagal_sajid?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Shagal Sajid</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="faad" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在JavaScript中，事件是应用程序中发生的动作。它们是由各种事情触发的，比如输入、提交表单、调整大小等元素变化，或者应用程序运行时发生的错误等。我们可以分配一个事件处理器来处理这些事件。发生在DOM元素上的事件可以通过为相应事件的DOM对象的属性分配一个事件处理程序来处理。我们将仔细看看<code class="fe jn jo jp jq b">oncontextmenu</code>和<code class="fe jn jo jp jq b">oncuechange</code>事件处理程序。</p><h1 id="30e6" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">oncontextmenu</h1><p id="418a" class="pw-post-body-paragraph kh ki iq kj b kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le ij bi translated"><code class="fe jn jo jp jq b">oncontextmenu</code>属性让我们给它分配一个事件处理函数来处理<code class="fe jn jo jp jq b">contextmenu</code>事件。当在浏览器选项卡上单击鼠标右键时，会触发该事件。除非默认行为被阻止，否则浏览器上下文菜单将被激活。例如，我们可以通过写入以下命令来禁用右键单击:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="7e8b" class="mq lg iq jq b gy mr ms l mt mu">document<!-- -->.oncontextmenu = (event) =&gt; {<br/>  event.preventDefault();<br/>}</span></pre><p id="3b1c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我们还可以通过使用<code class="fe jn jo jp jq b">MouseEvent</code>对象的<code class="fe jn jo jp jq b">cilentX</code>和<code class="fe jn jo jp jq b">cilentY</code>属性来获得右击的位置，该对象是我们从事件处理函数的参数中得到的。例如，我们可以编写下面的HTML代码来把文本放到右键单击的位置:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="8e8f" class="mq lg iq jq b gy mr ms l mt mu">&lt;p id='pos'&gt;</span><span id="96df" class="mq lg iq jq b gy mv ms l mt mu">&lt;/p&gt;</span></pre><p id="b01d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后，我们可以编写以下JavaScript代码来获取右键单击的坐标，然后使用调用事件处理函数时在参数中传递的<code class="fe jn jo jp jq b">MouseEvent</code>对象的<code class="fe jn jo jp jq b">cilentX</code>和<code class="fe jn jo jp jq b">cilentY</code>属性，设置我们在上面编写的<code class="fe jn jo jp jq b">p</code>元素中显示的文本:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="ccf5" class="mq lg iq jq b gy mr ms l mt mu">const pos = document.getElementById('pos');<br/>document.oncontextmenu = (e) =&gt; {<br/>  console.log(e);<br/>  pos.innerHTML = `You right clicked on (${e.clientX}, ${e.clientY})`;<br/>}</span></pre><p id="1769" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b">MouseEvent</code>对象有许多属性。它们是:</p><ul class=""><li id="f9f3" class="mw mx iq kj b kk kl ko kp ks my kw mz la na le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">altKey</code> —一个布尔只读属性，如果触发鼠标事件时Qlt键被按下，则返回<code class="fe jn jo jp jq b">true</code>。</li><li id="0985" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">button</code> —只读属性，指示触发鼠标事件时按下的按钮号(如果适用)。</li><li id="ba63" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">buttons</code> —一个只读属性，当触发鼠标事件时按钮被按下(如果有)。</li><li id="ea98" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">clientX</code> —只读属性，具有鼠标指针在文档坐标中的X坐标。</li><li id="23c7" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">clientY</code> —只读属性，具有鼠标指针在本地文档坐标中的Y坐标。</li><li id="70cc" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">ctrlKey</code>—boolean只读，如果触发鼠标事件时按下了控制键，则返回<code class="fe jn jo jp jq b">true</code>。</li><li id="de13" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">metaKey</code>—boolean只读，如果触发鼠标事件时元键已按下，则返回<code class="fe jn jo jp jq b">true</code>。元键是Macintosh键盘上的command或Apple键，是Windows键盘上的Windows键。</li><li id="c19e" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">movementX</code> —一个只读的，它具有鼠标指针相对于上一次mousemove事件位置的X坐标。</li><li id="06a2" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">movementY</code> —只读属性，包含鼠标指针相对于上一次mousemove事件位置的Y坐标。</li><li id="bb0b" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">offsetX</code> —一个只读属性，具有鼠标指针相对于目标节点填充边缘位置的X坐标</li><li id="a757" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">offsetY </code> —只读属性，具有鼠标指针相对于目标节点填充边缘位置的Y坐标</li><li id="5c09" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">pageX</code> —只读属性，具有鼠标指针相对于整个文档的X坐标。</li><li id="596f" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">pageY</code> —一个只读属性，即鼠标指针相对于整个文档的Y坐标。</li><li id="de45" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">region</code> —只读属性，返回受事件影响的点击区域的ID。如果没有命中区域受到影响，则返回<code class="fe jn jo jp jq b">null</code>。</li><li id="acbb" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">relatedTarget</code> —只读属性，具有事件的辅助目标(如果有的话)。</li><li id="5111" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">screenX</code> —一个只读属性，具有鼠标指针在全局(屏幕)坐标中的X坐标。</li><li id="9e6e" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">screenY</code> —一个只读属性，具有鼠标指针在全局(屏幕)坐标中的Y坐标。</li><li id="ef21" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">shiftKey</code> —一个布尔只读属性，如果触发鼠标事件时按下了shift键，则返回<code class="fe jn jo jp jq b">true</code>。</li><li id="2d4a" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">which</code> —只读，当鼠标事件被触发时按钮被按下。</li><li id="1225" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">mozPressure</code> —一个只读的，它具有生成事件时施加到触摸或平板设备上的压力量。该值介于<code class="fe jn jo jp jq b">0.0</code>(最小压力)和<code class="fe jn jo jp jq b">1.0</code>(最大压力)之间。这是一个不推荐使用的(非标准)属性。我们应该使用<code class="fe jn jo jp jq b">PointerEvent</code>对象的<code class="fe jn jo jp jq b">pressure</code>属性。</li><li id="c911" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">mozInputSource</code> —只读属性，具有生成事件的设备类型(下面列出的<code class="fe jn jo jp jq b">MOZ_SOURCE_*</code>常量之一)。我们可以确定鼠标事件是由实际的鼠标还是由触摸事件生成的，或者检测用户使用该属性与之交互的其他输入源。</li><li id="2a0f" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">webkitForce</code> —一个只读属性，包含单击时施加的压力量</li><li id="c53f" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">x</code> —只读属性，是<code class="fe jn jo jp jq b">clientX</code>的别名。</li><li id="4788" class="mw mx iq kj b kk nf ko ng ks nh kw ni la nj le nb nc nd ne bi translated"><code class="fe jn jo jp jq b">y</code> —只读属性，是<code class="fe jn jo jp jq b">clientY</code>的别名。</li></ul><figure class="mi mj mk ml gt jv gh gi paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gh gi nk"><img src="../Images/6321946ba073a7ac08ccf0d372ed93d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*twBFSsF38u5cpRPD"/></div></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">Photo by <a class="ae kg" href="https://unsplash.com/@marceloleal80?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marcelo Leal</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="9292" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">oncuechange</h1><p id="d5fe" class="pw-post-body-paragraph kh ki iq kj b kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le ij bi translated"><code class="fe jn jo jp jq b">oncuechange</code>属性让我们分配一个事件处理程序来处理<code class="fe jn jo jp jq b">cuechange</code>事件，该事件在<code class="fe jn jo jp jq b">TextTrack</code>改变了当前显示的提示时被触发。该事件被发送到呈现轨迹的<code class="fe jn jo jp jq b">TextTrack</code>和<code class="fe jn jo jp jq b">track</code>元素。例如，我们可以用它来记录视频中显示的标题，如下面的代码所示。首先，我们添加视频的HTML代码和视频的字幕轨道:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="434c" class="mq lg iq jq b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Cue Change&lt;/title&gt;<br/>    &lt;link href="main.css" rel="stylesheet" /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;video controls width="250" src="./media/friday.mp4"&gt;<br/>      &lt;track<br/>        default<br/>        kind="captions"<br/>        srclang="en"<br/>        src="./media/friday.vtt"<br/>        id="video-track"<br/>      /&gt;</span><span id="6c96" class="mq lg iq jq b gy mv ms l mt mu">Sorry, your browser doesn't support embedded videos.<br/>    &lt;/video&gt;</span><span id="e593" class="mq lg iq jq b gy mv ms l mt mu">&lt;script src="main.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="674f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后在<code class="fe jn jo jp jq b">main.js</code>中，我们添加以下JavaScript代码:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="d92a" class="mq lg iq jq b gy mr ms l mt mu">const videoTrack = document.getElementById("video-track");<br/>videoTrack.oncuechange = e =&gt; {<br/>  console.log(e);<br/>};</span></pre><p id="249b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">从上面代码的<code class="fe jn jo jp jq b">console.log</code>输出中，我们应该得到如下所示的内容:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="ce6f" class="mq lg iq jq b gy mr ms l mt mu">bubbles: false<br/>cancelBubble: false<br/>cancelable: false<br/>composed: false<br/>currentTarget: null<br/>defaultPrevented: false<br/>eventPhase: 0<br/>isTrusted: true<br/>path: (6) [track#video-track, video, body, html, document, Window]<br/>returnValue: true<br/>srcElement: track#video-track<br/>target: track#video-track<br/>timeStamp: 11405.27500025928<br/>type: "cuechange"</span></pre><p id="ce3f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">新的<code class="fe jn jo jp jq b">console.log</code>输出应该在显示新的标题时出现，这与改变提示以及触发<code class="fe jn jo jp jq b">cuechanged</code>事件时相同。我们可以从<code class="fe jn jo jp jq b">target.track.activeCues</code>属性中获取标题/提示文本。<code class="fe jn jo jp jq b">activeCues</code>属性是一个<code class="fe jn jo jp jq b">TextTrackCueList</code>，它是一个类似数组的对象，所以我们可以用<code class="fe jn jo jp jq b">for...of</code>遍历它，并对它使用spread操作符。例如，我们可以编写以下代码:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="e43d" class="mq lg iq jq b gy mr ms l mt mu">const videoTrack = document.getElementById("video-track");<br/>videoTrack.oncuechange = e =&gt; {<br/>  console.log([...e.target.track.activeCues].map(t =&gt; t.text).join(" "));<br/>};</span></pre><p id="6eff" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">然后我们会得到上面视频的字幕轨道的行:</p><pre class="mi mj mk ml gt mm jq mn mo aw mp bi"><span id="b0d1" class="mq lg iq jq b gy mr ms l mt mu">Hildy!<br/>How are you?<br/>Tell me, is the lord of the universe in?<br/>Yes, he's in - in a bad humor<br/>Somebody must've stolen the crown jewels<br/>...</span></pre><p id="ce9a" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b">console.log</code>输出行一直持续到视频结束。</p><p id="bc65" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">属性让我们给它分配一个事件处理函数来处理事件。当在浏览器选项卡上单击鼠标右键时，会触发该事件。这对于检测右键单击事件和禁用页面上的右键单击非常方便。<code class="fe jn jo jp jq b">oncuechange</code>属性让我们分配一个事件处理程序来处理<code class="fe jn jo jp jq b">cuechange</code>事件，该事件在<code class="fe jn jo jp jq b">TextTrack</code>改变了当前显示的提示时被触发。该事件被发送到呈现轨迹的<code class="fe jn jo jp jq b">TextTrack</code>和<code class="fe jn jo jp jq b">track</code>元素。我们可以用<code class="fe jn jo jp jq b">event.target.track</code>属性获取跟踪数据，该属性可用于传递给<code class="fe jn jo jp jq b">oncurchange</code>事件处理程序的<code class="fe jn jo jp jq b">Event</code>对象。</p></div></div>    
</body>
</html>