<html>
<head>
<title>Querying SQL Server with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js查询SQL Server</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/querying-sql-server-with-node-js-f5567dea5fa4?source=collection_archive---------0-----------------------#2019-11-02">https://javascript.plainenglish.io/querying-sql-server-with-node-js-f5567dea5fa4?source=collection_archive---------0-----------------------#2019-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3fe3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">连接、查询、显示和关闭</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1723b3ec019f508bd928db3399e86654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySUS6PGMRaEkcQcU4jZd0w.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by Tobias Fischer on <a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kw"><p id="ceef" class="kx ky iq bd kz la lb lc ld le lf lg dk translated">JavaScript在node.js中运行时，是一种用于与数据库交互的强大语言。</p></blockquote><p id="bd84" class="pw-post-body-paragraph lh li iq lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb lg ij bi translated">我在这个领域的典型用例是拥有一个<a class="ae kv" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda函数</a>，运行<a class="ae kv" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> node.js </a>，作为我的前端和后端数据库之间的中间件组件，执行一个或多个<a class="ae kv" href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" rel="noopener ugc nofollow" target="_blank"> CRUD </a>操作。</p><p id="e847" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">在我们开始创建中间件组件之前，我们需要有一个工作的基础。</p><blockquote class="mh mi mj"><p id="cd1b" class="lh li mk lj b lk mc jr lm ln md ju lp ml me ls lt mm mf lw lx mn mg ma mb lg ij bi translated">在本文中，我们将讨论连接到一个<a class="ae kv" href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads" rel="noopener ugc nofollow" target="_blank"> Microsoft SQL Server数据库</a>，从一个表中请求数据(查询)，然后关闭连接的最低要求。</p></blockquote><p id="9720" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">一旦我们有了基本的方法，在以后的文章中，我们可以专注于巩固它，扩展它，并创建一个完整的CRUD组件。</p><p id="3d1a" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><strong class="lj ir">为什么不给我看一整套CRUD操作</strong>？因为我喜欢从简单的东西开始，然后从那里开始。</p><h2 id="4bd4" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lq mx my mz lu na nb nc ly nd ne nf ng bi translated">假设</h2><p id="a3da" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">我假设您已经可以访问SQL Server数据库，其中至少有一个您想要查询的表。如果没有，</p><ul class=""><li id="f284" class="nm nn iq lj b lk mc ln md lq no lu np ly nq lg nr ns nt nu bi translated"><em class="mk"> SQL Server Express和Developer Editions是免费的！并且可以在这里</em>  <em class="mk">下载</em> <a class="ae kv" href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads" rel="noopener ugc nofollow" target="_blank"> <em class="mk">。</em></a></li><li id="af61" class="nm nn iq lj b lk nv ln nw lq nx lu ny ly nz lg nr ns nt nu bi translated"><em class="mk"> SQL Server Management Studio也是免费的！并且可以在这里下载</em><a class="ae kv" href="https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"><em class="mk"/></a><em class="mk">。</em></li></ul><p id="0040" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">我将直接编写node.js代码，因此将假设您可以访问Visual Studio代码(VSCode)或Visual Studio。如果没有，</p><ul class=""><li id="be28" class="nm nn iq lj b lk mc ln md lq no lu np ly nq lg nr ns nt nu bi translated">VSCode免费！并且可以在这里下载<a class="ae kv" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="113d" class="nm nn iq lj b lk nv ln nw lq nx lu ny ly nz lg nr ns nt nu bi translated">Visual Studio社区版是免费的！并且可以在这里下载<a class="ae kv" href="https://visualstudio.microsoft.com/downloads/" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><p id="8122" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">并安装node.js。如果没有，</p><ul class=""><li id="5fe3" class="nm nn iq lj b lk mc ln md lq no lu np ly nq lg nr ns nt nu bi translated">Nodejs可以在这里下载<a class="ae kv" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><p id="4adc" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">为了使本文简明扼要，我将不讨论如何安装和配置这些项目。这正是这篇文章所需要的。</p><h1 id="85bf" class="oa mp iq bd mq ob oc od mt oe of og mw jw oh jx mz jz oi ka nc kc oj kd nf ok bi translated">设置</h1><h2 id="514b" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lq mx my mz lu na nb nc ly nd ne nf ng bi translated"><strong class="ak">我的SQL Server安装</strong></h2><p id="e557" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">我的SQL Server实例和数据库(公司)带有一个表(雇员。)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/553f524d4d771c089b5999da8b4e5437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvUvJTxwahquMGKWW2CTdQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">SQL Server Instance, Database and Table</figcaption></figure><blockquote class="mh mi mj"><p id="dfdc" class="lh li mk lj b lk mc jr lm ln md ju lp ml me ls lt mm mf lw lx mn mg ma mb lg ij bi translated">我们的目标是检索绩效评分为4的员工的EmpId、FirstName、LastName和Title。</p></blockquote><p id="8594" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><strong class="lj ir">SQL查询</strong></p><p id="6bcf" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">如在SQL Server Management Studio (SSMS)中编写和测试的。)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/c9d4dc8bd38e1beb3cd2abaf4eda8e6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*xliOiI5G_OEE0RV5J3FBHg.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The SQL Query</figcaption></figure><h1 id="2bdf" class="oa mp iq bd mq ob oc od mt oe of og mw jw oh jx mz jz oi ka nc kc oj kd nf ok bi translated">我们开始吧</h1><p id="fc63" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">为node.js安装SQL Server驱动程序(<em class="mk"> mssql </em>)</p><p id="0dbd" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><em class="mk">我假设你已经设置好运行node.js了。如果没有，这里有一个很好的使用VSCode的教程。</em>T13】</p><ol class=""><li id="906b" class="nm nn iq lj b lk mc ln md lq no lu np ly nq lg on ns nt nu bi translated">创建一个您希望在其中工作的文件夹</li><li id="bab7" class="nm nn iq lj b lk nv ln nw lq nx lu ny ly nz lg on ns nt nu bi translated">打开VSCode，从“文件”菜单中打开该文件夹。</li><li id="3498" class="nm nn iq lj b lk nv ln nw lq nx lu ny ly nz lg on ns nt nu bi translated">进入<strong class="lj ir">终端菜单</strong>并选择<strong class="lj ir">新终端。</strong></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/b73858b27e6ca6a97b457455a8fc3260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rip6YXDutaxL6sxsz_FA7Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Opens PowerShell</figcaption></figure><p id="3c0d" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">4.在终端窗口中，键入<em class="mk"> npm init </em>并接受默认值以创建package.json文件。</p><p id="f7fe" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">5.<strong class="lj ir">重要的一步</strong>。键入<em class="mk"> npm install mssql </em>来安装驱动程序。这将建立一个<strong class="lj ir"> <em class="mk"> node_modules </em> </strong>文件夹，您可能想要浏览它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/3c9d2ea16238d163eb569efb8058ae68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OliNUtoOY7N2BDPBX8pGQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">We are ready to roll!</figcaption></figure><h1 id="f1c1" class="oa mp iq bd mq ob oc od mt oe of og mw jw oh jx mz jz oi ka nc kc oj kd nf ok bi translated">代码和结果</h1><p id="7500" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">由于我们的package.json使用<em class="mk"> index.js </em>作为主文件，<strong class="lj ir">创建一个名为index.js </strong>的文件。(根据需要随意命名文件并修改您的package.json。)</p><p id="d8a7" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">完整的代码和结果如下。查看这段代码，阅读下面的信息，然后将其输入到index.js中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/b0da8c1dc0e84c332000cf50d2b7b5ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mBRcFPqSco17_eej8XORGg.jpeg"/></div></div></figure><h2 id="928a" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lq mx my mz lu na nb nc ly nd ne nf ng bi translated">说明</h2><p id="c3cd" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">首先，我们访问了SQl Server的数据库驱动程序，第3行。</p><p id="0e1f" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">接下来，第6–11行，我们设置了所需的配置，告诉我们的代码如何找到我们的<strong class="lj ir">数据库实例</strong>、访问它所需的<strong class="lj ir">凭证</strong>以及我们想要访问的<strong class="lj ir">数据库</strong>。</p><p id="0667" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">下一步，第14行，建立连接。如果我们想先测试连接，我们可以跳过第19–31行，直接停止。如果你有困难，我建议你这样做。如果您输入了查询代码，只需将其注释掉。</p><p id="4839" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">为了创建查询，我们创建一个<strong class="lj ir">请求</strong>对象。我们为请求对象的查询方法指定所需的参数。</p><p id="0184" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">我们做的最后一件事是<strong class="lj ir">关闭</strong>连接。如果要执行更多操作，请保持打开状态。</p><h2 id="735a" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lq mx my mz lu na nb nc ly nd ne nf ng bi translated">维奥拉。数据</h2><p id="58f8" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">返回的数据实际上是一个相对复杂的对象。为了更详细地处理这个问题，你需要解析它。</p><p id="5316" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">注意第29行(刚刚添加的)和原始数据对象的输出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/9f33168b6813b1579b6106ae05970aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*AAu_129Kxu8Jf5_UelEJUg.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Raw data.</figcaption></figure><h1 id="da14" class="oa mp iq bd mq ob oc od mt oe of og mw jw oh jx mz jz oi ka nc kc oj kd nf ok bi translated">结论</h1><p id="8793" class="pw-post-body-paragraph lh li iq lj b lk nh jr lm ln ni ju lp lq nj ls lt lu nk lw lx ly nl ma mb lg ij bi translated">为了巩固我们的步骤，我们安装了驱动程序，指定了要连接的内容以及我们希望如何连接。打开连接，查询并关闭连接。</p><p id="406e" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">我们能做得更多吗？还能更结实吗？哦，是的！</p><p id="9569" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">在以后的文章中，我们不仅会执行额外的CRUD操作，还会将这些操作放入AWS Lambda函数中，使用<a class="ae kv" href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/welcome.html" rel="noopener ugc nofollow" target="_blank"> AWS JavaScript SDK </a>连接前端，最终得到一个全栈应用程序。</p><p id="58c7" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">我们刚刚触及了许多权力的表面。</p><p id="bf57" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><strong class="lj ir">感谢您花时间阅读和编写代码。</strong></p><p id="9c9a" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">问题或疑问对任何提到的项目，发送一个问题。我的目标是你的成功。</p><h2 id="fa89" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lq mx my mz lu na nb nc ly nd ne nf ng bi translated">补充项目</h2><ul class=""><li id="2105" class="nm nn iq lj b lk nh ln ni lq os lu ot ly ou lg nr ns nt nu bi translated"><a class="ae kv" href="https://link.medium.com/X9rvWUZlo1" rel="noopener"> Object.assign() </a></li><li id="0564" class="nm nn iq lj b lk nv ln nw lq nx lu ny ly nz lg nr ns nt nu bi translated"><a class="ae kv" href="https://link.medium.com/USs9sPFoyZ" rel="noopener"> JavaScript类</a></li><li id="331a" class="nm nn iq lj b lk nv ln nw lq nx lu ny ly nz lg nr ns nt nu bi translated"><a class="ae kv" href="https://link.medium.com/bdr1puAKS0" rel="noopener">比较JavaScript中的对象</a></li></ul><p id="45ab" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">你也可以享受，</p><div class="ov ow gp gr ox oy"><a href="https://medium.com/javascript-in-plain-english/querying-sql-server-in-node-js-using-async-await-5cb68acf2144" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ir gy z fp pd fr fs pe fu fw ip bi translated">使用Async/Await在Node.js中查询SQL Server</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">一种更简洁的数据库查询方式</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">medium.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm kp oy"/></div></div></a></div></div></div>    
</body>
</html>