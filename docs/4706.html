<html>
<head>
<title>Run Automated Step-by-Step Browser Scenarios for Instruction or Demo from Node.js applications with Playwright</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用剧作家从Node.js应用程序运行自动化的分步浏览器场景，以获得指导或演示</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/run-automated-step-by-step-browser-scenarios-for-instruction-or-demo-from-nodejs-applications-with-1092e457516e?source=collection_archive---------12-----------------------#2020-12-31">https://javascript.plainenglish.io/run-automated-step-by-step-browser-scenarios-for-instruction-or-demo-from-nodejs-applications-with-1092e457516e?source=collection_archive---------12-----------------------#2020-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7b8d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">允许用户在场景之前、之后和期间与浏览器进行交互。</h2></div><p id="bd8b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">本文中的演示展示了三个场景(荷兰、法国、英国)。每个国家都有介绍——使用维基百科上的特定页面和部分，以及通过支持网站。标注用于解释场景和每个动作。气球文本用于进一步引导用户，</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/5170d0863c3b2fd01e2132ad1a439a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*DgLpqYVD8n-otX87.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Using Playwright — the vanilla Wikipedia site has been extended with a toolbar for managing a scenario, a callout to provide context and balloon text for in situ support for the end user</figcaption></figure><p id="8727" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这张截屏显示了场景<em class="lo">荷兰之旅</em>第一幕的开始。用户按Play，显示标注，为查询字段显示气球文本，剧作家开始在搜索字段中键入字符“The Netherlands”。</p><p id="a1ef" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下面的动画展示了荷兰的完整场景——从按下播放按钮开始第一幕。这个场景有四幕——开场、历史、体育和文化。每一幕都从播放按钮开始。可以跳过动作，可以重置场景(到开始)，并且可以选择其他场景。这里唯一的用户交互是按下播放按钮来触发每个动作。然而:用户可以在幕间浏览维基百科——浏览器会话对用户是免费的。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="lp lq l"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Brief demo of the Netherlands scenario created using Playwright and my custom scenario director. This type of scenario can be created for almost every website or web application.</figcaption></figure><p id="446c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">注意:这个演示是用普通维基百科创建的。未更改的站点被加载到通过剧作家实例化的Chromium浏览器中。所有进一步的操作都是从Node.js应用程序中应用的。</p><p id="1e15" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">act可以使用Node.js中的剧作家来操作网站——它还可以完全访问浏览器DOM和JavaScript上下文。例如，动作可以:填充字段、突出显示文本、按下按钮、滚动页面、打开链接、进行选择、悬停在元素上、在选项卡之间切换。</p><p id="d1b6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这个例子的所有资料都可以在GitHub上找到:<a class="ae lr" href="https://github.com/lucasjellema/playwright-scenarios/tree/main/step-by-step" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/lucasjellema/剧作家-场景/tree/main/分步走</a>。注意:这篇文章旨在给你一些启发，向你展示剧作家的潜力。这当然不是一个现成的解决方案，也不是专业干净编码的好例子。请正确解释它的意图。并请分享你的想法。你认为我所描述的怎么样？有意义吗？你能找到自己应用它的方法吗？你有什么建议给我吗？请让我知道！</p><h1 id="1ba5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">介绍</h1><p id="045e" class="pw-post-body-paragraph kg kh iq ki b kj mk jr kl km ml ju ko kp mm kr ks kt mn kv kw kx mo kz la lb ij bi translated">在过去的几周里，我和剧作家做了许多有趣的事情。以编程方式与运行任何web应用程序或网站的浏览器进行交互的选项非常强大。它为自动化浏览器操作开辟了许多机会，既有无头的(用于测试、RPA、集成、屏幕抓取、健康检查、自动化报告)，也有头的(原型制作、说明、演示、deeplink快捷方式、定制SaaS)。</p><p id="6f57" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我已经在之前的几篇文章中描述了我使用剧作家所取得的一些成就。这些包括:将快捷键处理程序注入到在剧作家嵌入式浏览器中运行的任何web应用程序中(例如用于截图或下载所有图像)，将工具栏添加到任何网页中，在WhatsApp Web UI上创建用于与WhatsApp一起工作的API，在Google Translate上创建translation REST API，在SaaS web应用程序中创建导航到完全初始化的上下文的Deepmark Booklinks，从IMDb检索电影的JSON报告。有关详细信息，请参见:</p><ul class=""><li id="9bcf" class="mp mq iq ki b kj kk km kn kp mr kt ms kx mt lb mu mv mw mx bi translated">如果有一个免费的、不知疲倦的浏览器运营商，你能做些什么？！介绍剧作家。</li><li id="533d" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated"><a class="ae lr" href="https://medium.com/javascript-in-plain-english/inject-generic-floating-toolbar-into-any-web-application-or-site-using-playwright-d26eb116153a?source=your_stories_page-------------------------------------" rel="noopener">使用剧作家</a>将通用浮动工具栏注入任何网站</li><li id="f1c0" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated"><a class="ae lr" href="https://medium.com/javascript-in-plain-english/use-playwright-to-inject-shortcut-keys-into-any-web-page-for-example-to-download-all-images-59195cf557a5?source=your_stories_page-------------------------------------" rel="noopener">使用剧作家将数据注入任何网页</a></li><li id="9fde" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated"><a class="ae lr" href="https://medium.com/javascript-in-plain-english/how-to-apify-whatsapp-programmatic-interaction-with-whatsapp-from-node-using-playwright-227326796bf6?source=your_stories_page-------------------------------------" rel="noopener">我构建了一个API，用于发送&amp;接收WhatsApp消息</a></li></ul><p id="e840" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我确定的下一个挑战——也是本文讨论的最后一个挑战——是使用剧作家，我想创建一个web应用程序或web站点的演示。剧作家命令用于执行网页中的动作。特别的是，这些动作被分步骤分组(又名<em class="lo">动作</em>)。这些步骤共同构成了一个场景。使用工具栏—用户可以播放一个动作、暂停执行、跳过(一个动作)、重置(将执行返回到第一个动作)。在自动化步骤的执行之间，用户可以自由地与网页交互。演示步骤(也称为acts)不一定要执行，或者它们不一定是唯一要做的事情。每个步骤都可以有一个标题和描述，并显示在标注中。该图显示了描述当前行为和场景的标注。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/24051e4deaa2e0c429d28cfd6fdc986e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*V-mZ_wU9ObDYS2qj.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The user controls the scenario execution from the toolbar. The callout is used to provide information about the current scenario and act</figcaption></figure><p id="9a05" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">此外，与动作中的步骤(也称为场景)相关联的可以是文本气球或带文本的箭头，它们可以放置在页面上靠近在步骤中操作的元素的位置。图中显示了一个示例。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/83d67eb768cf114e6d406c47eb63aed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*VfoNoY47nhVyK2vE.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Balloon texts can be included in scenarios to provide inline guidance to the users</figcaption></figure><p id="5ee9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">通过这种方式，可以创建演示脚本或教程，在真实的web环境中牵着用户的手。用户可以选择让准备好的场景进行下去，或者进行干预、贡献或事件接管(部分)。</p><p id="e057" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我为维基百科创建了多个场景(荷兰，法国，英国)，用户可以选择一个场景来执行。在任何时候，用户都可以决定运行不同的场景。</p><p id="d0ad" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">实现的核心是一段非常简单的代码，它利用剧作家库来启动浏览器、创建浏览器上下文和打开网页。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/48048b54d0fbf7f95ecdfbbc603d5464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*ZmlfCScVY4rfBwcc.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The core of running a web application in Playwright with added toolbar and callout components (CSS styling, HTML elements and JavaScript)</figcaption></figure><p id="70b8" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">步骤1调用一个函数，将工具栏添加到浏览器上下文中的每个页面，每次都是在页面导航或重新加载以及DOM重新构建之后。此工具栏包含运行场景(以及在场景之间切换、暂停执行、重置场景)的控件。工具栏是通过<em class="lo">的</em>功能导演的；这个函数处理关于场景执行的工具栏事件。</p><p id="d686" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">第2步是将标注对象插入到当前页面。这是通过在函数<em class="lo"> injectCalloutIntoPage </em>中直接操纵DOM来实现的。初始场景的标题和描述被传递以显示在标注中。</p><p id="0826" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><em class="lo">场景状态</em>对象包含所有场景，并跟踪哪个场景是当前场景，以及用户在该场景中已经走了多远。暂停状态也记录在该对象中。</p><p id="0de4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">使用标题和描述以及嵌套的步骤或动作来定义场景。每一幕都有标题、描述和动作。动作是在执行动作时调用的函数。该函数操纵标注、气泡或气球帮助以及浏览器UI控件、DOM元素和JavaScript上下文。以下是NL场景的一个小示例:</p><ol class=""><li id="5a55" class="mp mq iq ki b kj kk km kn kp mr kt ms kx mt lb nd mv mw mx bi translated">定义场景的标题和描述</li><li id="01b0" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb nd mv mw mx bi translated">用场景中的场景(又名行为)定义阵列；每个动作都有一个标题和描述，显示在标注中</li><li id="6d5d" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb nd mv mw mx bi translated">每一个行为都有一个行动。这个动作是服务器端JavaScript函数(Node.js context ),它接收当前(剧作家)页面对象作为输入；这个函数通常会在浏览器中的网页上下文中计算选择器表达式和JavaScript语句。本例中的第一个操作是编写一个气球帮助文本，在搜索字段中键入字符串“The Netherlands ”,然后按搜索按钮。当页面重新加载荷兰的详细信息后，会显示一个新的气球帮助文本。注意:调用waitForUnpause()是为了验证用户是否暂停了执行；在这种情况下，这些呼叫将被阻塞，直到暂停结束</li><li id="b446" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb nd mv mw mx bi translated">第二个动作是调用scrollToElement(一个自定义Node.js函数)的示例，将页面滚动到使用function page检索的元素句柄<em class="lo"> republic </em>。$()和具有特定标题属性值的链接元素的选择器。这种滚动是在浏览器中以平滑的方式执行的，因此用户可以看到滚动的发生。</li></ol><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/35828472e09f7cc0800a41026e80c29d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*lAhbkAQG28zSuzyA.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">An example of how scenarios are composed from acts (or scenes) that contain actions with the code to invoke Playwright and the browser DOM</figcaption></figure><p id="ca91" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">scrollToElement函数非常简单:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/d32c8321d8d5f5372bd3776c70ea5712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*qsABAc2726TXbH7v.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Node.js function that executes a JS snippet in the browser context to leverage the default scroll behavior in the browser</figcaption></figure><p id="1b4b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">该函数使用剧作家函数page.evaluate()将特定元素句柄的DOM元素传递给在浏览器上下文中执行的JavaScript函数。该函数利用DOM元素函数scrollIntoView()来完成这项艰巨的工作。</p><p id="8bfc" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">场景可以做的另一个例子是突出显示文本。这也被证明是相当简单的。一个链接位于一个特定的文本内容中(关于马克斯·维斯塔潘，因此元素名为maxText)。随后，执行一个浏览器端代码片段，它获取该链接的<p>父链接，将其整个innerHTML封装在<mark>标签中，并将这个<p>元素滚动到视图中。</p></mark></p></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/88166a4f442271b4234065dc90d5c9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*ibp0wun-_cLBZMwA.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Node.js code that through Playwright locates a link element with specified title attribute value and then highlights all content inside the link’s parent element (a &lt;P&gt; element)</figcaption></figure><p id="1658" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">它有点粗糙。使用<a class="ae lr" href="https://javascript.info/selection-range" rel="noopener ugc nofollow" target="_blank">范围和选择对象</a>是更精确的方法。然而，在这个例子中，它为我实现了这个技巧:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/72463a57d7633a33b82a5a43a735e6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5HNtb6Q8rqWvew5wWBHIQ.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The effect of the function overhead: all text inside the &lt;P&gt; is highlighted by the browser (because of the &lt;mark&gt;&lt;/mark&gt; tags that were added</figcaption></figure><p id="57a2" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这段代码将鼠标悬停在一个链接上，显示一个关于伦勃朗的弹出窗口:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/9802feb782ca2669bf1b2cc26e12b0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJoLpG6HPNSHohyQ4n6n7Q.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The action code makes the mouse hover over a link that causes a popup to appear</figcaption></figure><p id="9172" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">再举一个例子:一个动作可以打开一个新的浏览器标签，加载相关数据并激活该标签。并切换回原始选项卡。这是一个小片段:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nj"><img src="../Images/5c7b9dd7dc54e6e943ce246cf336d950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCbGVQS-AYE8zbFbG4wfIg.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Playwright instructions in the Node.js application to create a new page (== browser tab), bring it to front, wait 5 seconds and bring the original tab back into focus</figcaption></figure><p id="6c9d" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这是表演结束时用户将看到的结果:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/df2a78623ab0fbcc102f2ed4bbd77357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q5YblJFErUj1XevC5um96w.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The current act has opened a second tab, loaded a relevant context document; in 5 seconds, the main Wikipedia tab will get focus again</figcaption></figure><p id="c31e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">director() 函数是事情的核心:它处理关于场景的工具栏事件(播放、重置、跳过、暂停、切换)。这些事件在浏览器上下文中被捕获，并从工具栏链接上的onclick事件处理程序传递到Node.js上下文。该语句创建了从浏览器到Node.js的桥梁。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nk"><img src="../Images/991feb94ea8a80c348171632c8279546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1oA04AVYi4njg3RRFozhiQ.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Overview of the Playwright scenario director. On the right the embedded Playwright browser that loads Wikipedia and gets the toolbar, callout and bubble help injected. User actions on the toolbar trigger the Node.js <em class="kf">director() function to manipulate the scenario status and execute its acts</em></figcaption></figure><p id="fe46" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">director() 函数是事情的核心:它处理关于场景的工具栏事件(播放、重置、跳过、暂停、切换)。这些事件在浏览器上下文中被捕获，并从工具栏链接上的onclick事件处理程序传递到Node.js上下文。该语句创建了从浏览器到Node.js的桥梁:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/422e1311e8a53ab6dba3861ed1b77a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*fyCvFsCaME0OteyB.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Make Node.js function <em class="kf">director available in the browser context — as window.directorFunction</em></figcaption></figure><p id="41b2" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对context.exposeBinding的调用确保Node.js函数director将作为<em class="lo"> directorFunction </em>在窗口对象上的浏览器中的任何地方可用。该函数从工具栏中的onclick处理程序调用。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/f0f5b859c3130acfa42ca418c2941b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*A5dSZgfgsbc1JAqi.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Notice how the onclick event handlers all invoke the window.directorFunction — which is in reality a proxy for a Node.js function</figcaption></figure><p id="21e2" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在来看看director()函数本身。它接收来自剧作家的源对象(包含页面和浏览器上下文)和来自onclick处理程序的指令输入参数，以指示触发了哪个动作(下一个也称为播放、跳过、重置、暂停、切换)。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7ff3ae91a0bcd084806ef716fd114483.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/0*56R1fHve7vpya8oW.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The Node.js director() function that handles all toolbar events regarding scenarios</figcaption></figure><p id="c8dc" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">根据<em class="lo">指令</em>的值，该函数将操作<em class="lo"> scenarioStatus </em>对象，该对象跟踪当前场景及其状态(下一个动作，暂停与否)。例如，对于skip，下一个动作简单地递增。暂停表示暂停或取消暂停(用作切换开关)，除了操作<em class="lo">场景状态</em>中的标志之外，什么也不做。也许我应该加上一个视觉指示。重置意味着将下一幕重置为0或场景的开始。开关被解释为<em class="lo">选择下一个场景</em>。调用populateCallOut()是为了将标注与当前场景及其即将到来的下一个动作同步。</p><p id="8928" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">最后<em class="lo">下一个</em>又名play是执行动作的触发器，意味着调用其功能。一旦一个动作正在执行，导演就不能停止它。但是，操作本身可能会检查场景暂停状态，并通过等待暂停结束来执行它。</p><h1 id="f244" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">资源</h1><p id="159e" class="pw-post-body-paragraph kg kh iq ki b kj mk jr kl km ml ju ko kp mm kr ks kt mn kv kw kx mo kz la lb ij bi translated">本文的所有代码都在GitHub上:<a class="ae lr" href="https://github.com/lucasjellema/playwright-scenarios/tree/main/step-by-step" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/lucasjellema/剧作家-场景/tree/main/step-by-step </a></p><p id="f7c6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">CodePen On Speech Bubbles作者@ rajeshdn—<a class="ae lr" href="https://codepen.io/RajRajeshDn/pen/oZdRJw" rel="noopener ugc nofollow" target="_blank">https://codepen.io/RajRajeshDn/pen/oZdRJw</a></p><p id="c653" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">关于CSS中高级定位的文章:<a class="ae lr" href="https://www.internetingishard.com/html-and-css/advanced-positioning/" rel="noopener ugc nofollow" target="_blank">https://www . internetingishard . com/html-and-CSS/Advanced-positioning/</a></p><p id="1ef5" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">CSS —滚动行为—<a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-behavior" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/CSS/Scroll-Behavior</a></p><p id="3318" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">StackOverflow —获取DOM元素的X和Y坐标—<a class="ae lr" href="https://stackoverflow.com/questions/442404/retrieve-the-position-x-y-of-an-html-element-relative-to-the-browser-window" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/442404/retrieve-the-position-X-Y-of-an-html-element-relative-to-the-browser-window</a></p><p id="d730" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">W3 Schools —如何创建标注元素—【https://www.w3schools.com/howto/howto_js_callout.asp T2】</p><p id="46eb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">由<a class="ae lr" href="https://dev.to/comscience" rel="noopener ugc nofollow" target="_blank">kapeel kokane</a>—<a class="ae lr" href="https://dev.to/comscience/highlight-searched-text-on-a-page-with-just-javascript-17b3" rel="noopener ugc nofollow" target="_blank">https://dev . to/com science/highlight-Searched-text-on-a-page-with-just-Javascript-17 B3</a></p><p id="1e2e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">剧作家1.7.0新选择器—针对CSS文本选择器—<a class="ae lr" href="https://github.com/microsoft/playwright/blob/v1.7.0/docs/selectors.md#css-extension-visible" rel="noopener ugc nofollow" target="_blank">https://github . com/Microsoft/剧作家/blob/v 1 . 7 . 0/docs/selectors . MD # CSS-extension-visible</a></p><p id="411f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">剧作家文档:</p><ul class=""><li id="f757" class="mp mq iq ki b kj kk km kn kp mr kt ms kx mt lb mu mv mw mx bi translated">page-bringToFront()—<a class="ae lr" href="https://playwright.dev/docs/api/class-page/#pagebringtofront" rel="noopener ugc nofollow" target="_blank">https://stronger . dev/docs/API/class-page/# pagebringtofront</a></li><li id="5c57" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated">page-type()—<a class="ae lr" href="https://playwright.dev/docs/api/class-page/#pagetypeselector-text-options" rel="noopener ugc nofollow" target="_blank">https://剧作家. dev/docs/API/class-page/# pagetypeselector-text-options</a>和<a class="ae lr" href="https://playwright.dev/docs/input#type-characters" rel="noopener ugc nofollow" target="_blank">https://playwright.dev/docs/input#type-characters</a></li><li id="a864" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated">page—addStyleTag()—<a class="ae lr" href="https://playwright.dev/docs/api/class-page/#pageaddstyletagstyle" rel="noopener ugc nofollow" target="_blank">https://剧作家. dev/docs/API/class-page/# pageaddstyletagstyle</a></li><li id="a28b" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated">page—addScriptTag()—<a class="ae lr" href="https://playwright.dev/docs/api/class-page/#pageaddscripttagscript" rel="noopener ugc nofollow" target="_blank">https://剧作家. dev/docs/API/class-page/# pageaddscripttagscript</a></li><li id="bbcb" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated">page—hover()—<a class="ae lr" href="https://playwright.dev/docs/api/class-page#pagehoverselector-options" rel="noopener ugc nofollow" target="_blank">https://剧作家. dev/docs/API/class-page # pagehover selector-options</a></li><li id="203e" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated">CSS和文本选择器—<a class="ae lr" href="https://playwright.dev/docs/selectors#text-and-textlight" rel="noopener ugc nofollow" target="_blank">https://playwright.dev/docs/selectors#text-and-textlight</a></li><li id="cef0" class="mp mq iq ki b kj my km mz kp na kt nb kx nc lb mu mv mw mx bi translated">page—wait and wait for selector()—<a class="ae lr" href="https://playwright.dev/docs/navigations#custom-wait-1" rel="noopener ugc nofollow" target="_blank">https://playwright.dev/docs/navigations#custom-wait-1</a></li></ul></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="7c23" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">TL；</strong> <em class="lo">博士:运行浏览器动作的演示或说明。允许用户暂停和跳过动作，重置和切换场景。允许用户在场景之前、之后和期间与浏览器进行交互。开源的剧作家库来自一个自定义的Node.js应用程序，其中定义了场景——使用了大量的CSS选择器和DOM操作。</em></p><p id="892e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><em class="lo">原载于2020年12月31日</em><a class="ae lr" href="https://technology.amis.nl/frontend-technology/run-automated-step-by-step-browser-scenarios-for-instruction-or-demo-from-nodejs-applications-with-playwright/" rel="noopener ugc nofollow" target="_blank"><em class="lo">https://technology . amis . nl</em></a><em class="lo">。</em></p></div></div>    
</body>
</html>