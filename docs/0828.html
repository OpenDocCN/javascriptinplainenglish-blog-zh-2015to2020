<html>
<head>
<title>Dynamic Emails With Vue.js &amp; MJML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Vue.js和MJML的动态电子邮件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/dynamic-emails-with-vue-js-mjml-116ed00eee85?source=collection_archive---------0-----------------------#2019-12-18">https://javascript.plainenglish.io/dynamic-emails-with-vue-js-mjml-116ed00eee85?source=collection_archive---------0-----------------------#2019-12-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/9300ad8e19ae57b7a951779ed5e83502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*70JoLZSMJA7C9hFmOT1haw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk"><a class="ae jd" href="https://www.freepik.com/free-photos-vectors/background" rel="noopener ugc nofollow" target="_blank">https://www.freepik.com/free-photos-vectors/background</a></figcaption></figure><div class=""/><div class=""><h2 id="852e" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">让我们再次让电子邮件变得棒极了！</h2></div><h2 id="467a" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">形势</h2><p id="82d5" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我需要创建包含动态数据的电子邮件，在所有设备和邮件客户端上看起来都很棒。</p><figure class="ml mm mn mo gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mk"><img src="../Images/306fe794bdf56d87d0df7f47b2052dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OPk_v4h1y6xdps92ln59oA.png"/></div></div></figure><h2 id="2d3b" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">问题</h2><p id="ec6d" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">邮件客户端仍然处于数字黑暗时代。</p><p id="5570" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">今天，一些最流行的邮件客户端不支持基本的网络功能；或者更糟，他们选择以不可预测的方式呈现HTML。我在看你<a class="ae jd" href="https://litmus.com/blog/a-guide-to-rendering-differences-in-microsoft-outlook-clients" rel="noopener ugc nofollow" target="_blank">前景</a>！这种一致性的缺乏会使构建跨平台兼容的电子邮件成为一场彻头彻尾的噩梦。然而，幸运的是，我们有几个工具可以让这个过程不那么痛苦。其中一个就是<a class="ae jd" href="https://mjml.io/" rel="noopener ugc nofollow" target="_blank"> MJML </a>。</p><p id="7baa" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">MJML是一种简单、轻量级的标记语言，可以在所有邮件客户端和设备上创建一致的电子邮件。然而，MJML和其他电子邮件创建工具一样，并没有提供一种简单的方法来创建带有动态数据的模板。</p><h2 id="9443" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">解决方案</h2><p id="0f83" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">创建一个使用Vue渲染MJML的微服务。</p><p id="d984" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">Vue是一个强大的操纵HTML的javascript库。乍一看，Vue可能没那么有用。它不是为电子邮件设计的，更重要的是，你不能在电子邮件中运行JavaScript。那么为什么它会有用呢？</p><p id="fea8" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">由于Vue开发团队的辛勤工作，我们可以利用Vue的服务器端渲染功能。因此，我们可以设置一个服务器来将我们的Vue应用程序编译成基本的HTML。那么如果我们用MJML代替HTML呢？</p><h2 id="ec96" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">该过程</h2><p id="5151" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">基本思想是使用Vue的服务器端渲染器用数据填充MJML模板。那么MJML可以很容易地编译成HTML。</p><p id="4071" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated"><strong class="lt jh"> MJML + Vue </strong> &gt; <strong class="lt jh"> Vue编译器</strong> &gt; <strong class="lt jh"> MJML编译器</strong> &gt; <strong class="lt jh">牛逼HTML邮件</strong></p><h2 id="ea83" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">设置</strong></h2><p id="9f8a" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">首先使用<a class="ae jd" href="https://mjml.io/documentation/" rel="noopener ugc nofollow" target="_blank"> MJML </a>创建一个电子邮件模板。</p><pre class="ml mm mn mo gt mu mv mw mx aw my bi"><span id="d80b" class="kv kw jg mv b gy mz na l nb nc">&lt;mjml&gt;<br/>  &lt;mj-body&gt;<br/>    &lt;mj-section&gt;<br/>      &lt;mj-column&gt;<br/>        &lt;mj-text&gt;<br/>          MJML + Vue is:<br/>        &lt;/mj-text&gt;<br/>        &lt;mj-text&gt;<br/>          Awesome!<br/>        &lt;/mj-text&gt;<br/>      &lt;/mj-column&gt;<br/>    &lt;/mj-section&gt;<br/>  &lt;/mj-body&gt;<br/>&lt;/mjml&gt;</span></pre><p id="6789" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">使用Vue的<a class="ae jd" href="https://vuejs.org/v2/guide/syntax.html" rel="noopener ugc nofollow" target="_blank">模板语法</a>添加一些逻辑。</p><pre class="ml mm mn mo gt mu mv mw mx aw my bi"><span id="ba32" class="kv kw jg mv b gy mz na l nb nc">&lt;mjml&gt;<br/>  &lt;mj-body&gt;<br/>    &lt;mj-section <strong class="mv jh">v-if="list"</strong>&gt;<br/>      &lt;mj-column&gt;<br/>        &lt;mj-text&gt;<br/>          MJML + Vue is:<br/>        &lt;/mj-text&gt;<br/>        &lt;mj-text <strong class="mv jh">v-for="(item, index) in list"</strong>&gt;<br/>          <strong class="mv jh">{{index}}</strong>. <strong class="mv jh">{{item}}</strong><br/>        &lt;/mj-text&gt;<br/>      &lt;/mj-column&gt;<br/>    &lt;/mj-section&gt;<br/>  &lt;/mj-body&gt;<br/>&lt;/mjml&gt;</span></pre><p id="c251" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">创建一个节点服务器来呈现你的电子邮件。然后在节点服务器内部，创建一个新的Vue <a class="ae jd" href="https://vuejs.org/v2/guide/instance.html" rel="noopener ugc nofollow" target="_blank">实例</a>，并使用我们刚刚创建的MJML模板。</p><pre class="ml mm mn mo gt mu mv mw mx aw my bi"><span id="cde7" class="kv kw jg mv b gy mz na l nb nc">import vue from 'vue';</span><span id="7e10" class="kv kw jg mv b gy nd na l nb nc">var app = new vue({<br/>  template: [ Your Vue+MJML template Goes Here ]<br/>})</span></pre><p id="cf60" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">添加一些要注入到模板中的数据。</p><pre class="ml mm mn mo gt mu mv mw mx aw my bi"><span id="8550" class="kv kw jg mv b gy mz na l nb nc">import vue from 'vue';</span><span id="0419" class="kv kw jg mv b gy nd na l nb nc">var app = new vue({<br/>  <strong class="mv jh">data: {<br/>    list: [<br/>      "Easy",<br/>      "Quick",<br/>      "Powerful",<br/>    ]<br/>  },</strong><br/>  template: [ Your Vue+MJML template Goes Here ]<br/>})</span></pre><p id="a35d" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">使用Vue的<a class="ae jd" href="https://vuejs.org/v2/guide/ssr.html" rel="noopener ugc nofollow" target="_blank">服务器端渲染器</a>渲染Vue应用程序。</p><pre class="ml mm mn mo gt mu mv mw mx aw my bi"><span id="477c" class="kv kw jg mv b gy mz na l nb nc">import vue from 'vue';<br/>import { createRenderer } from 'vue-server-renderer';</span><span id="5104" class="kv kw jg mv b gy nd na l nb nc">var app = new vue({<br/>  data: {<br/>    list: [<br/>      "Easy",<br/>      "Quick",<br/>      "Powerful",<br/>    ]<br/>  },<br/>  template: [ Your Vue+MJML template Goes Here ]<br/>})</span><span id="1558" class="kv kw jg mv b gy nd na l nb nc"><strong class="mv jh">createRenderer.renderToString(app, (err, vue_render)=&gt;{})</strong></span></pre><p id="b1c7" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">最后获取输出，并通过MJML编译器进行处理。</p><pre class="ml mm mn mo gt mu mv mw mx aw my bi"><span id="92a3" class="kv kw jg mv b gy mz na l nb nc">import vue from 'vue';<br/>import { createRenderer } from 'vue-server-renderer';<br/>import mjml from 'mjml';</span><span id="dfc3" class="kv kw jg mv b gy nd na l nb nc">var app = new vue({<br/>  data: {<br/>    list: [<br/>      "Easy",<br/>      "Quick",<br/>      "Powerful",<br/>    ]<br/>  },<br/>  template: [ Your MJML Goes Here ]<br/>})</span><span id="1def" class="kv kw jg mv b gy nd na l nb nc">createRenderer.renderToString(app, (err, vue_render)=&gt;{<br/>  <strong class="mv jh">var finished_email_template = MJML(vue_render).html;</strong><br/>})</span></pre><p id="0414" class="pw-post-body-paragraph lr ls jg lt b lu mp kh lw lx mq kk lz le mr mb mc li ms me mf lm mt mh mi mj ij bi translated">你留下的是一封动态生成的坚如磐石的电子邮件，随时可以发送出去！！！</p><h2 id="a903" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">看看它的实际效果</h2><p id="ac6d" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">要查看使用Node.js的完整实现，请查看我的Github:<a class="ae jd" href="https://github.com/JamesClow/Vue-MJML" rel="noopener ugc nofollow" target="_blank">https://github.com/JamesClow/Vue-MJML</a></p><h1 id="3f6d" class="ne kw jg bd kx nf ng nh la ni nj nk ld km nl kn lh kp nm kq ll ks nn kt lp no bi translated">感谢阅读！</h1></div></div>    
</body>
</html>