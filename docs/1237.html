<html>
<head>
<title>Turning legacy websites into progressive single page apps with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React将传统网站转变为渐进式单页面应用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/turning-legacy-websites-into-progressive-single-page-apps-with-react-530c0830e0c1?source=collection_archive---------3-----------------------#2020-02-16">https://javascript.plainenglish.io/turning-legacy-websites-into-progressive-single-page-apps-with-react-530c0830e0c1?source=collection_archive---------3-----------------------#2020-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/87d7b312e5006f7bc749ebccf87ce6cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l5C1e3HZpWnpeyhbNYmc8Q.jpeg"/></div></div></figure><p id="69ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大多数开发人员不喜欢从事遗留项目，原因有很多。最明显的一个事实是，与他们在最近精心制作的绿地项目中的工作相比，他们的生产率大幅下降。然而，管理层通常期望他们以相同的步调工作，而不管正在讨论的项目。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="5e4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设您的任务是在Laravel 5.1中创建一个复杂的工作申请表，这个PHP项目自从两年前前任首席开发人员离职去冰岛当导游以来就没人碰过了。</p><p id="4fc4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该表单应允许用户选择他们的工作领域，根据这一点，所有相关的工作清单将从服务器上提取。您知道，当一个输入字段的值依赖于另一个输入字段时，表单往往会变得复杂，更不用说当您可能需要处理异步代码以便从服务器加载更多数据时。你头脑中的声音告诉你，你只有三个选择:</p><ol class=""><li id="8a58" class="ld le iq ka b kb kc kf kg kj lf kn lg kr lh kv li lj lk ll bi translated">运行create-react-app my-awesome-form，使用最热门的工具从头开始编写整个系统的代码(包括Redux、TypeScript、Mongodb、Firebase函数、微服务架构以及过去6个月在YouTube上观看教程时学到的所有东西)。</li><li id="7ab6" class="ld le iq ka b kb lm kf ln kj lo kn lp kr lq kv li lj lk ll bi translated">继续当前的设置，并将表单分成两个独立的路径:choose_job_field和complete_application(后者可能会获得所选的job字段作为查询参数)。</li><li id="7979" class="ld le iq ka b kb lm kf ln kj lo kn lp kr lq kv li lj lk ll bi translated">做两者的混合。</li></ol><p id="1dfa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一种选择几乎总是次优的，应该不惜一切代价避免。今天的greenfield项目在几年后将成为遗留项目，因此，最好将时间花在实现新特性上，而不是追逐最新的框架或库。</p><p id="edae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二种选择更好，但代价是灾难性的用户体验。这在15年前是可以接受的，但现在已经不那么“酷”了。</p><p id="a8ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您只剩下第三种选择，幸运的是，本文将向您展示如何做到这一点。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="3ae2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">渐进式单页面应用</strong>(不要与渐进式web应用混淆)<strong class="ka ir"> </strong>是传统的服务器端渲染网站，带有一些使用React等SPA技术创建的UI元素。如果您运行的是Laravel 5.7，将React集成到您的项目中只是一个命令的问题:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="7dd2" class="ma mb iq lw b gy mc md l me mf">php artisan preset react</span></pre><p id="38f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将在您的资源目录中创建一个示例组件。您可以通过运行以下命令来启动开发模式:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="5414" class="ma mb iq lw b gy mc md l me mf">php artisan serve &amp;&amp; npm run watch</span></pre><p id="0ac0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你正在使用其他的框架(比如Spring Boot)或者Laravel的旧版本，你仍然可以很容易地利用laravel-mix包。首先在项目的根目录下创建<strong class="ka ir"> package.json </strong>和<strong class="ka ir"> webpack.mix.js </strong>文件，内容如下:</p><p id="db5f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">package.json:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="f7cc" class="ma mb iq lw b gy mc md l me mf">{<br/>  "private": true,<br/>  "scripts": {<br/>    "dev": "npm run development",<br/>    "development": "cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",<br/>    "watch": "npm run development -- --watch",<br/>    "watch-poll": "npm run watch -- --watch-poll",<br/>    "hot": "cross-env NODE_ENV=development node_modules/webpack-dev-server/bin/webpack-dev-server.js --inline --hot --config=node_modules/laravel-mix/setup/webpack.config.js",<br/>    "prod": "npm run production",<br/>    "production": "cross-env NODE_ENV=production node_modules/webpack/bin/webpack.js --no-progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js"<br/>  },<br/>  "devDependencies": {<br/>    "@babel/preset-react": "^7.0.0",<br/>    "axios": "^0.19",<br/>    "cross-env": "^5.1",<br/>    "jquery": "^3.2",<br/>    "laravel-mix": "^4.0.7",<br/>    "lodash": "^4.17.13",<br/>    "popper.js": "^1.12",<br/>    "react": "^16.2.0",<br/>    "react-dom": "^16.2.0",<br/>    "resolve-url-loader": "^2.3.1",<br/>    "sass": "^1.15.2",<br/>    "sass-loader": "^7.1.0"<br/>  }<br/>}</span></pre><p id="3c11" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">webpack.mix.js:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="e2cb" class="ma mb iq lw b gy mc md l me mf">// webpack.mix.js</span><span id="8dfb" class="ma mb iq lw b gy mg md l me mf">const mix = require(‘laravel-mix’);</span><span id="2d0f" class="ma mb iq lw b gy mg md l me mf">mix.react(‘resources/js/app.js’, ‘public/js’)<br/> .sass(‘resources/sass/app.scss’, ‘public/css’);<br/>mix.disableNotifications();</span></pre></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="cf67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在运行:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="7fc2" class="ma mb iq lw b gy mc md l me mf">npm install</span></pre></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="c593" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后在公共目录中创建css和js文件夹(如果它们还不存在的话)，并将<strong class="ka ir"> js/app.js、sass/app.scss </strong>和<strong class="ka ir">js/components/form component . js</strong>文件添加到resources文件夹:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="2011" class="ma mb iq lw b gy mc md l me mf">// resources/js/app.js</span><span id="2409" class="ma mb iq lw b gy mg md l me mf">require('./components/FormComponent');</span></pre><p id="57ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">resources/sass/app.scss:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="fecb" class="ma mb iq lw b gy mc md l me mf">// resources/sass/app.scss</span><span id="a976" class="ma mb iq lw b gy mg md l me mf">body {<br/>  background-color: #fff;<br/>}</span><span id="9a76" class="ma mb iq lw b gy mg md l me mf">h1 {<br/>  color: #000;<br/>}</span></pre><p id="7709" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">资源/js/components/form component . js:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="5f43" class="ma mb iq lw b gy mc md l me mf">// resources/js/components/FormComponent.js:</span><span id="f27a" class="ma mb iq lw b gy mg md l me mf">import React from 'react';<br/>import ReactDOM from 'react-dom';</span><span id="101a" class="ma mb iq lw b gy mg md l me mf">export const FormComponent = () =&gt; {<br/>  return (<br/>    &lt;&gt;<br/>      &lt;h1&gt;Truly Amazing Form Component in React&lt;/h1&gt; <br/>    &lt;/&gt;<br/>  );<br/>};</span><span id="2e28" class="ma mb iq lw b gy mg md l me mf">if (document.getElementById('form-component')) {<br/>  ReactDOM.render( &lt;FormComponent /&gt; , document.getElementById('form-component'));<br/>}</span></pre></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="a827" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，您的文件夹结构应该如下所示:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/481a7797f0cbd31e57af0fa31e1dcc85.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*tFMopa_bXReF1nw3IaXCfg.jpeg"/></div></figure><p id="77b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您现在可以运行:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="1930" class="ma mb iq lw b gy mc md l me mf">npm run watch</span></pre></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="8842" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您已经准备好为表单添加一个路线和一个控制器。下一步将根据您使用的服务器框架而有所不同，但总体思路是将<strong class="ka ir"> app.js </strong>和<strong class="ka ir"> app.css </strong>加载到控制器呈现的视图中:</p><p id="01c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">app/Http/表单控制器. php:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="518f" class="ma mb iq lw b gy mc md l me mf">// app/Http/FormController.php</span><span id="bde2" class="ma mb iq lw b gy mg md l me mf">&lt;?php</span><span id="d94b" class="ma mb iq lw b gy mg md l me mf">namespace App\Http\Controllers;<br/>use App;<br/>use Illuminate\Routing\Controller as BaseController;<br/>class FormController extends BaseController {<br/>  public function __construct()<br/>  {<br/>    parent::__construct();<br/>  }<br/>  <br/>  public function main() {<br/>    return view('complicated_form');<br/>  }<br/>}<br/>?&gt;</span></pre><p id="6813" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">resources/views/complicated _ form . blade:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="5fc8" class="ma mb iq lw b gy mc md l me mf">&lt;!-- resources/views/complicated_form.blade --&gt;<br/>&lt;html&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="form-component"&gt;&lt;/div&gt;<br/>    &lt;script type="text/javascript" src="/js/app.js?v={{filemtime(public_path().'/js/app.js')}}"&gt;&lt;/script&gt;<br/>    &lt;link rel="stylesheet" href="/css/app.css?v={{filemtime(public_path().'/css/app.css')}}" type="text/css"&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3b25" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">别忘了在app/Http/routes.php中公开路由:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="9d57" class="ma mb iq lw b gy mc md l me mf">&lt;?php<br/> // …<br/> Route::get(‘/form’, [‘as’ =&gt; ‘form’, ‘uses’ =&gt; ‘FormController@main’]);<br/> // …<br/>?&gt;</span></pre></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="c546" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在您可以运行您的php / java / other服务器来查看惊人的结果:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/fd3b97ce4d26a56984e24757b55b4695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQAyAt7VuNoIVJIrFp6hrg.png"/></div></div></figure><p id="19b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文展示了一种使用ReactJS实现预期目的的简单技术——与现有项目集成。如果你还有任何问题，请在下面的评论区留下。</p></div></div>    
</body>
</html>