<html>
<head>
<title>Best of Modern JavaScript — Module Details</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代JavaScript精华—模块细节</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/best-of-modern-javascript-module-details-9e1e7198a3ba?source=collection_archive---------9-----------------------#2020-10-23">https://javascript.plainenglish.io/best-of-modern-javascript-module-details-9e1e7198a3ba?source=collection_archive---------9-----------------------#2020-10-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1f340c80ece3ce9b1bf7c0db5d9009ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-wfeUSewtsk16uVw"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@justinveenema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Justin Veenema</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4265" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自2015年以来，JavaScript有了巨大的进步。</p><p id="c894" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在用起来比以前舒服多了。</p><p id="193a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究ES6模块系统的设计。</p><h1 id="7c17" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用变量来指定我要从哪个模块导入</h1><p id="dc42" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">import</code>函数指定导入哪个模块。</p><p id="004d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它接受一个带有模块路径的字符串。</p><p id="35bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="607c" class="mq lc iq mh b gy mr ms l mt mu">(async () =&gt; {<br/>  const foo = await import("./foo");<br/>  //...<br/>})();</span></pre><p id="7092" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe me mf mg mh b">import</code>功能导入模块。</p><p id="e1ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它需要一个字符串，所以我们可以传入一个动态生成的字符串。</p><p id="7ca4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个承诺，所以我们使用<code class="fe me mf mg mh b">await</code>来获得解析的值。</p><h1 id="bf42" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">有条件或按需导入模块</h1><p id="51b3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">使用<code class="fe me mf mg mh b">import</code>函数，我们可以有条件地或按需导入一个函数。</p><p id="3218" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="152c" class="mq lc iq mh b gy mr ms l mt mu">(async () =&gt; {<br/>  if (Math.random() &lt; 0.5) {<br/>    const foo = await import("./foo");<br/>    //...<br/>  }<br/>})();</span></pre><p id="05d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有条件地导入模块。</p><h1 id="dc19" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在Import语句中使用变量</h1><p id="0d13" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不能在导入语句中使用变量。</p><p id="5da9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们不能写这样的东西:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3830" class="mq lc iq mh b gy mr ms l mt mu">import foo from 'bar-' + SUFFIX;</span></pre><p id="b353" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是用<code class="fe me mf mg mh b">import</code>函数，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="22e9" class="mq lc iq mh b gy mr ms l mt mu">(async () =&gt; {<br/>  if (Math.random() &lt; 0.5) {<br/>    const foo = await import(`bar-${SUFFIX}`);<br/>    //...<br/>  }<br/>})();</span></pre><h1 id="aeef" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在<code class="fe me mf mg mh b">import</code>语句中使用析构</h1><p id="c101" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不能在<code class="fe me mf mg mh b">import</code>语句中使用嵌套析构。</p><p id="349b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是有道理的，因为出口只能在最高层进行。</p><p id="48c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它看起来像析构，但语法不同。</p><p id="5bca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">进口是静态的，出口是动态的。</p><p id="0888" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们不能写这样的东西:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d442" class="mq lc iq mh b gy mr ms l mt mu">import { foo: { bar } } from 'some_module';</span></pre><h1 id="c7d3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">指定出口</h1><p id="c034" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有了命名导出，我们可以用对象来实现静态结构。</p><p id="fda5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们用一个对象创建一个默认的导出，那么我们就不能静态地分析这个对象。</p><p id="4f83" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对象可以有任何属性，并且可以嵌套。</p><h1 id="7019" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe me mf mg mh b">eval()</code>一个模块的代码</h1><p id="59a0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不能在模块代码上调用<code class="fe me mf mg mh b">eval</code>。</p><p id="3f49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模块对于<code class="fe me mf mg mh b">eval</code>来说级别太高。</p><p id="a1b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">eval</code>接受不允许使用<code class="fe me mf mg mh b">import</code>或<code class="fe me mf mg mh b">export</code>关键字的脚本。</p><h1 id="11e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ES6模块的优势</h1><p id="bb0a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">ES6模块有几个好处。</p><p id="b717" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们包括更紧凑的语法。</p><p id="2fb8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">静态模块结构也有助于消除死代码、静态检查、优化等。</p><p id="92d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们检查循环依赖。</p><p id="0a5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用标准模块系统，我们消除了多个模块系统的碎片。</p><p id="d076" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用旧模块系统的一切都将迁移到ES6标准模块。</p><p id="4207" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不再需要使用对象作为名称空间。</p><p id="28eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该功能现在由模块提供。</p><p id="8853" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像<code class="fe me mf mg mh b">Math</code>和<code class="fe me mf mg mh b">JSON</code>这样的对象充当隔离实体的名称空间。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/64c06e01d660580e149ad7f00797032c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VwTHhuqPHmxONtg9"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@berkaygumustekin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Berkay Gumustekin</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7a84" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c68b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">与旧的非标准模块系统相比，ES6模块为我们提供了许多优势。</p><p id="7b3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它们可以动态导入。</p><p id="aa2c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们允许各种优化。</p><p id="966d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码获得更多类似内容，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>