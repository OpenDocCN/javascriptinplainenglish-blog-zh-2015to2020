<html>
<head>
<title>Learning JavaScript by Implementing Lodash Methods — Combining Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过实现Lodash方法学习JavaScript组合值</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/learning-javascript-by-implementing-lodash-methods-combining-values-34246376b4b6?source=collection_archive---------7-----------------------#2020-05-15">https://javascript.plainenglish.io/learning-javascript-by-implementing-lodash-methods-combining-values-34246376b4b6?source=collection_archive---------7-----------------------#2020-05-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/74c755af6b548999c6931f3156e5492d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DPBQydOkYK5k5S0v"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@phoedobus?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Edoardo Busti</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f7bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Lodash是一个非常有用的工具库，让我们可以轻松地处理对象和数组。</p><p id="7fcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，现在JavaScript标准库正在赶上诸如Lodash之类的库，我们可以用简单的方法实现许多功能。</p><p id="ac6c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何实现Lodash方法来处理集合中的组合项。</p><h1 id="e4bb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe lz ma mb mc b">reduce</code></h1><p id="0a43" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">Lodash <code class="fe lz ma mb mc b">reduce</code>方法通过调用<code class="fe lz ma mb mc b">iteratee</code>函数将集合中的值组合成一个值，该函数采用一个<code class="fe lz ma mb mc b">accumulator</code>参数和到目前为止组合的值，第二个参数是要为数组版本组合的项。</p><p id="8da9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对象版本接受具有累积值的<code class="fe lz ma mb mc b">result</code>、具有对象值的<code class="fe lz ma mb mc b">value</code>和具有正在处理的对象的键的<code class="fe lz ma mb mc b">key</code>。</p><p id="3eaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在运行<code class="fe lz ma mb mc b">iteratee</code>之前，它还使用一个可选的<code class="fe lz ma mb mc b">accumulator</code>对象和<code class="fe lz ma mb mc b">accumulator</code>参数的初始值。</p><p id="8b5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以编写下面的代码:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="2f6b" class="mq lc iq mc b gy mr ms l mt mu">const reduce = (collection, iteratee, accumulator) =&gt; {<br/>  if (Array.isArray(collection)) {<br/>    return collection.reduce(iteratee, accumulator)<br/>  } else {<br/>    let reduced = accumulator;<br/>    for (const key of Object.keys(collection)) {<br/>      iteratee(reduced, collection[key], key)<br/>    }<br/>    return reduced;<br/>  }<br/>}</span></pre><p id="ce97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们检查<code class="fe lz ma mb mc b">collection</code>是否是一个数组。如果是，那么我们在数组实例上调用<code class="fe lz ma mb mc b">reduce</code>，用<code class="fe lz ma mb mc b">iteratee</code>函数作为回调，用<code class="fe lz ma mb mc b">accumulator</code>作为初始值。</p><p id="9797" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们用<code class="fe lz ma mb mc b">accumulator</code>作为初始值创建一个新的<code class="fe lz ma mb mc b">reduced</code>变量。</p><p id="38b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用<code class="fe lz ma mb mc b">iteratee</code>遍历<code class="fe lz ma mb mc b">collection</code>对象的键，它将<code class="fe lz ma mb mc b">reduced</code>值、给定键的值和键本身作为参数。</p><p id="7a21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们返回<code class="fe lz ma mb mc b">reduced</code>对象，它有组合的结果。</p><p id="735d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们可以这样称呼它:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="b729" class="mq lc iq mc b gy mr ms l mt mu">const result = reduce({<br/>  'a': 1,<br/>  'b': 2,<br/>  'c': 1<br/>}, (result, value, key) =&gt; {<br/>  (result[value] || (result[value] = [])).push(key);<br/>  return result;<br/>}, {});</span></pre><p id="8327" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们用一个对象和一个带有<code class="fe lz ma mb mc b">result</code>、<code class="fe lz ma mb mc b">value</code>和<code class="fe lz ma mb mc b">key</code>参数的<code class="fe lz ma mb mc b">iteratee</code>函数调用了我们自己的<code class="fe lz ma mb mc b">reduce</code>方法。然后在函数中，我们通过用<code class="fe lz ma mb mc b">value</code>填充结果对象的键来组合这些值，并将这些键推入数组。</p><p id="4764" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="155b" class="mq lc iq mc b gy mr ms l mt mu">{<br/>  "1": [<br/>    "a",<br/>    "c"<br/>  ],<br/>  "2": [<br/>    "b"<br/>  ]<br/>}</span></pre><p id="942c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为<code class="fe lz ma mb mc b">result</code>的值。</p><p id="4a15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以用一个数组调用我们的<code class="fe lz ma mb mc b">reduce</code>函数，如下所示:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="cbd8" class="mq lc iq mc b gy mr ms l mt mu">const result = reduce([1, 2], (sum, n) =&gt; {<br/>  return sum + n;<br/>}, 0);</span></pre><p id="1be0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到<code class="fe lz ma mb mc b">result</code>是3。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/6a1f033970ee724612b31130385e9bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bmxo0D3MYha3mySs"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Brett Jordan</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="0383" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><code class="fe lz ma mb mc b">reduceRight</code></h1><p id="8d22" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lz ma mb mc b">reduceRight</code>方法类似于<code class="fe lz ma mb mc b">reduce</code>，除了从结束到开始组合数值。</p><p id="3f77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用类似于<code class="fe lz ma mb mc b">reduce</code>的方式实现它，如下所示:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="a8b6" class="mq lc iq mc b gy mr ms l mt mu">const reduceRight = (collection, iteratee, accumulator) =&gt; {<br/>  if (Array.isArray(collection)) {<br/>    return collection.reverse().reduce(iteratee, accumulator)<br/>  } else {<br/>    let reduced = accumulator;<br/>    const keys = Object.keys(collection)<br/>    for (let i = keys.length - 1; i &gt;= 0; i--) {<br/>      iteratee(reduced, collection[keys[i]], keys[i])<br/>    }<br/>    return reduced;<br/>  }<br/>}</span></pre><p id="4706" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，在数组的情况下，我们通过使用与<code class="fe lz ma mb mc b">reduce</code>实现相同的参数调用<code class="fe lz ma mb mc b">reduce</code>来反转数组。</p><p id="de0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以相反的顺序遍历对象的键。在循环中，我们对每个项目调用<code class="fe lz ma mb mc b">iteratee</code>。<code class="fe lz ma mb mc b">iteraee</code>函数采用与我们传递给<code class="fe lz ma mb mc b">reduce</code>的参数相同的参数。</p><p id="ae42" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以如下调用<code class="fe lz ma mb mc b">reduceRight</code>:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="fb7e" class="mq lc iq mc b gy mr ms l mt mu">const result = reduceRight({<br/>  'a': 1,<br/>  'b': 2,<br/>  'c': 1<br/>}, (result, value, key) =&gt; {<br/>  (result[value] || (result[value] = [])).push(key);<br/>  return result;<br/>}, {});</span></pre><p id="43c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们得到<code class="fe lz ma mb mc b">result</code>是:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="5fbc" class="mq lc iq mc b gy mr ms l mt mu">{<br/>  "1": [<br/>    "c",<br/>    "a"<br/>  ],<br/>  "2": [<br/>    "b"<br/>  ]<br/>}</span></pre><p id="f745" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们以逆序遍历对象条目。</p><p id="591e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用一个数组调用<code class="fe lz ma mb mc b">reduceRight</code>，如下所示:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="272d" class="mq lc iq mc b gy mr ms l mt mu">const result = reduceRight([1, 2], (sum, n) =&gt; {<br/>  return sum + n;<br/>}, 0);</span></pre><p id="1ed4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们得到的结果和<code class="fe lz ma mb mc b">reduce</code>一样，都是3。</p><h1 id="52c1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="6467" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lz ma mb mc b">reduce</code>和<code class="fe lz ma mb mc b">reducerRight</code>方法可以用数组的现有数组方法来完成。我们可以用<code class="fe lz ma mb mc b">iteratee</code>函数和<code class="fe lz ma mb mc b">accumulator</code>调用数组实例上的<code class="fe lz ma mb mc b">reduce</code>。</p><p id="f4ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于对象来说，就更复杂了。我们必须通过获取键来遍历这些项，并将键和值传递给<code class="fe lz ma mb mc b">iteratee</code>函数，该函数将<code class="fe lz ma mb mc b">result</code>作为第一个参数。第二个参数是<code class="fe lz ma mb mc b">value</code>，第三个是<code class="fe lz ma mb mc b">key</code>。</p><h2 id="48cf" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">来自简明英语团队的说明</h2><p id="3ce2" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">简明英语刚刚推出了一个YouTube频道！我们希望您现在就通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅来支持我们！</strong> </a></p></div></div>    
</body>
</html>