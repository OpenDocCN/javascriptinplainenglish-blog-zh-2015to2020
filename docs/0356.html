<html>
<head>
<title>Launch an App to a Kubernetes Cluster in 8 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过8个步骤启动Kubernetes集群的应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-launch-your-app-to-a-kubernetes-cluster-50b5b5637fba?source=collection_archive---------8-----------------------#2019-09-23">https://javascript.plainenglish.io/how-to-launch-your-app-to-a-kubernetes-cluster-50b5b5637fba?source=collection_archive---------8-----------------------#2019-09-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/6334973b761bfcf32b3d713a4a18d7d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K-z2mMRicA0zJIOs"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@callumgalloway?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Callum Galloway</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl ka kb hr kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="ig ih ii ij ik"><p id="ea5a" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">要求</p><ul class=""><li id="2bda" class="lf lg in kj b kk kl ko kp ks lh kw li la lj le lk ll lm ln bi translated">谷歌云SDK:<a class="ae jz" href="https://cloud.google.com/sdk/docs/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/sdk/docs/</a></li><li id="6ea4" class="lf lg in kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">https://kubernetes.io/docs/tasks/tools/install-kubectl/<a class="ae jz" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank"/></li><li id="da9a" class="lf lg in kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">https://docs.docker.com/install/<a class="ae jz" href="https://docs.docker.com/install/" rel="noopener ugc nofollow" target="_blank">码头工人</a></li><li id="8a02" class="lf lg in kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">https://nodejs.org/en/</li></ul><p id="ae32" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">回购链接:<a class="ae jz" href="https://github.com/raymundoxmartinez/StoreService" rel="noopener ugc nofollow" target="_blank">https://github.com/raymundoxmartinez/StoreService</a></p><h1 id="5bce" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">第一步:</strong>创建一个App</h1><p id="df2d" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">对于这一部分，我们将使用express创建一个基本的应用程序来生成一个简单的web服务器，而不使用视图引擎。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/84f88c6278cccb4498348a760be5b370.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*PDEWpSLtQMshbo9KsI1DCg.png"/></div></figure><p id="015d" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该得到以下文件结构:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9ae513fe26bdabee6d3ca722e952836d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*O87RCHoI_rmN0g1TjGIfIg.png"/></div></figure><p id="a7a5" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">让我们对应用程序做一些更改。首先，我们将更改服务器正在监听的端口。</p><p id="dbf1" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">导航到<em class="nc"> bin/www </em></p><p id="0a76" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">改变这一点:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/7b59584d9d4e2ac1fc5a59c3e6277e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Es8BHj-gF4ShY_hlT3irvg.png"/></div></div></figure><p id="7185" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">对此:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/3e3b8b96000aed71ecccc5a5e17b8a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGdbsz7OJ7fwmFHBFjC4cQ.png"/></div></div></figure><p id="df7e" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">我们所做的只是将端口号从3000更改为8080。</p><p id="382d" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">接下来，我们将编辑<em class="nc"> /users </em>路由的响应</p><p id="dc8f" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">导航至<em class="nc"> routes/users.js </em></p><p id="ed8c" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">改变这一点:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/afce8874eee46a268150e0922f5ec07c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Ore1TwfgjIpQou0FyyX0Mg.png"/></div></figure><p id="abcc" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">对此:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/e0a15eb729ba196db8c0742de8108080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*eSOPaNWd6m_cQKk_GtMQ1w.png"/></div></figure><p id="d8c4" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在运行您的服务器</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/a08e22711e66bd683683acd127cb7deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*7aG3FdnqAjjC5kmEDkPElA.png"/></div></figure><p id="770c" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">并在Postman上测试您的服务。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/f1deb498eac31999459c80778f122221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7VJqeDtcT_QaM8oDZg6SKg.png"/></div></div></figure><p id="b9c1" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">我们现在有一个工作服务！</p><h1 id="4d78" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">步骤2:创建Docker图像</strong></h1><p id="0b22" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">首先，我们将向根目录添加一个Dockerfile文件。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/def402c4898868383f321f113c983b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*VDI6XPJog0BUa-IZMbCiog.png"/></div></figure><p id="484f" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您的docker文件应该如下所示:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/b8377bc1be59adff91ba6a71665e0d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0TKkdNKkjUcPBIlR_hl4tg.png"/></div></div></figure><p id="f585" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">注意，<em class="nc"> CMD ["节点"，"。/bin/www"] </em>是运行应用程序的命令。如果您有不同的命令(例如<em class="nc"> node server.js ),请更改该命令。</em></p><p id="6574" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">下次运行:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/828c6c70e39aa58b30c8e5eb6ab8a787.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*5XOT6Q2noVU2E866oxEolw.png"/></div></figure><p id="3a87" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">在根目录中构建并标记docker映像。</p><p id="c60e" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该会得到这样的结果:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/8aeba3373b8ee0ade0a2b7852dfe7523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*WKVwsyBbyFiNs0ppyk3Mhw.png"/></div></figure><p id="9fd0" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">通过运行以下命令查看您的图像</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b1961cbf215b02ed9e06dc07851dc021.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*Tu-xzhshtHeyPSYlt-skrA.png"/></div></figure><p id="b4e3" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该能够看到构建图像的列表。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/bf9470f726195a99a83392ad72b705be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fg5gYHS5ebvxGoyWwUFwNg.png"/></div></div></figure><p id="e0e7" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在让我们运行容器！！</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/bcacbdb7d6ec32485bd8dcd4336acaec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*s-2HyNB_NVzu66JUaYLWeQ.png"/></div></figure><p id="e08a" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">这里，我们将服务器8080的端口映射到容器端口49160。</p><p id="a5bb" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">让我们在Postman上测试我们的容器:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/742f7b99a331a56f4536eedace1f773d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qSb6U9J1L2jXMjmRjzrXgQ.png"/></div></div></figure><p id="b539" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">太好了！</p><p id="f53d" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在我们正在与docker容器中的服务进行通信！</p><h1 id="29cb" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">步骤3: </strong>将图像推送到注册表</h1><p id="5874" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">让我们在Google云平台中创建一个新项目。</p><p id="94f4" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">登录gcloud:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/be0f5f7b150ee613a40e0cda003b1582.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*-xZZmWAAOI-oS-Nqcjkr8w.png"/></div></figure><p id="a6c7" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在授权您的gcloud帐户连接docker:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ns"><img src="../Images/6e713ea9569fcc8174f73b11c5ffa66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*SBZ4vHEmjTcd8iC0MHaGXg.png"/></div></div></figure><p id="7b46" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该看到这个:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/e05cf0613066f878550429e5d69c004c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHL-YYCYMKExOPQlV7vwiw.png"/></div></div></figure><p id="b5b5" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在，让我们标记映像并将其推送到gcloud存储库:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nu"><img src="../Images/8324fa562ec116ca5b5ac6551ffd677a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQPdWJTeXZiSsABhfW_sIQ.png"/></div></div></figure><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/16102945119e3fa953abcc56ea58bd93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*rhCM7hgcUSO8DpDGulXTdA.png"/></div></figure><p id="84f9" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">检查容器注册表以确保您的映像已成功推送。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nw"><img src="../Images/d12988948750eb26db4ca1cb5c91a21a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJkUpo3MSuRSVeerdNh_Ew.png"/></div></div></figure><p id="e815" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">噪音。</p><h1 id="7cda" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">步骤4: 创建一个集群</h1><p id="45e5" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">转到gcloud平台，创建一个新集群。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nx"><img src="../Images/1c9360af9f5f09755e36cfdd9ad59a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNcdmXvioErsEUNDW5SwMA.png"/></div></div></figure><p id="27fe" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">将集群重命名为<em class="nc"> store-cluster </em>，并将位置类型更改为r<em class="nc">regional</em>。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ny"><img src="../Images/75f90d7b1e7f1fa97b0ee2c33a70c616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmzjxkbpEu37EIHha8_R2A.png"/></div></div></figure><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nz"><img src="../Images/e9f3376ee054110eb55da046c514e359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fST4Ye-4eDmIKW8XWBRW-g.png"/></div></div></figure><p id="ffbf" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在确保您<strong class="kj io">启用了istio设置！！</strong></p><p id="2b86" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">我们将使用此功能与集群通信。</p><h1 id="5976" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">步骤5:配置设置，将Kubernetes与您的新集群连接起来</strong></h1><p id="8ecc" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">连接到您在步骤3中创建的项目:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/0de0ca91f2ba5c6b183f27046b26a9b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*vzhp2u5uiULo6ryy-xvcWw.png"/></div></figure><p id="2433" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在，连接到步骤4中创建的集群:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ob"><img src="../Images/59caa4ca572994667e131e91e81e1e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngqkO0sjN2hTrgPfVBcMXQ.png"/></div></div></figure><p id="3b9c" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">检查kubernetes是否正在与您的gcloud集群通信:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/08c1776a5f8667b6731478c82b1f4248.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*EYgXw_iQFlYBTkZlPu68ig.png"/></div></figure><p id="9f1b" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该看到gke _ YOUR _ PROJECT _ ID _ REGION _ CLUSTER _ NAME</p><p id="5893" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">快到了！！！</p><h1 id="7849" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">步骤6:创建一个定义服务的Yaml文件</h1><p id="a65e" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">在根目录中创建名为store-service.yaml的新文件</p><p id="ec1f" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">该文件包含3个部分:</p><ul class=""><li id="7a51" class="lf lg in kj b kk kl ko kp ks lh kw li la lj le lk ll lm ln bi translated">服务</li><li id="0b36" class="lf lg in kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">服务帐户</li><li id="9a58" class="lf lg in kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">部署</li></ul><p id="38ec" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated"><strong class="kj io">服务:</strong></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi od"><img src="../Images/33c8c5cd994071fdee366edd1760b866.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*85eNvIAEReDPmwWxmGAjTA.png"/></div></figure><p id="18df" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">请确保在该部分的末尾包含“--”。</p><p id="edfa" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated"><strong class="kj io">服务账户:</strong></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/ffbb3a75067057f3ba3657b659da1da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*YmKops5AqJSICBaEuJLfWg.png"/></div></figure><p id="297c" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated"><strong class="kj io">部署:</strong></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi of"><img src="../Images/da445cbcfa2e15d34dbea042179e4979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iur1-PzP4gGjvHQkcmE24w.png"/></div></div></figure><p id="6238" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">将“URL_TO_DOCKER_IMAGE”替换为步骤3中推送到注册表的图像的URL。</p><p id="afc8" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您可以在容器注册表部分找到url</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi og"><img src="../Images/3f207cce4e812b3cfea18915a45895cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gHfuPYn02eddlqu1qTXsiQ.png"/></div></div></figure><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oh"><img src="../Images/ba860662786cfcd74d81f605a33acfe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CXdhBU50IPXkqxs6iFUMMA.png"/></div></div></figure><p id="bc07" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">点击<em class="nc">储存</em>储存库。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oi"><img src="../Images/7b1d6f3803836aaf7d90678a086db8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JpbhcwmeDTByGzHKGesDTA.png"/></div></div></figure><p id="9a90" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在复制“完整映像名称”并将其添加到上面的部署部分。</p><p id="b1fb" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">让我们部署我们的容器吧！</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1df78e10655a7c2bfe0c36f5623906a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*tLo7eiw4ZfGVUosCtCcJBQ.png"/></div></figure><p id="3f96" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">检查服务是否已成功部署:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/4448e2ce188b3a133a1ef67d408bc49b.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*zoqtyJYd-1reg0jEIbWBcA.png"/></div></figure><p id="6aab" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该看到:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ol"><img src="../Images/e42bb1ad89725ce68028112baebaf76e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEwJ2OYjecICUPMT-fQAKw.png"/></div></div></figure><p id="efec" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">检查已部署容器的状态:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a8478119df905c8553e06c9a2f99094d.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*R4RdYbM5t6eWGXoYnNlJKg.png"/></div></figure><p id="5a47" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该看到:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi on"><img src="../Images/e557050b2335114a45a323c521ce4362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w46WU_4hiuJ5q6tzoig8IQ.png"/></div></div></figure><p id="417c" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">太好了，现在让我们打开我们服务的门户吧！！</p><h1 id="67eb" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">步骤7:创建网关Yaml文件</h1><p id="2204" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">向根目录添加一个名为store-gateway.yaml的新文件。</p><p id="fa45" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">该文件有两个部分:</p><ul class=""><li id="9246" class="lf lg in kj b kk kl ko kp ks lh kw li la lj le lk ll lm ln bi translated">门</li><li id="00fa" class="lf lg in kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">虚拟服务</li></ul><p id="4c5c" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated"><strong class="kj io">网关:</strong></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oo"><img src="../Images/cd441ab2a1f73c9f217ca5708e041711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q37XOsrdygCiPkgaJ-1cXA.png"/></div></div></figure><p id="e48a" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated"><strong class="kj io">虚拟服务:</strong></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi op"><img src="../Images/57776e13dcedfdd45bee353b2fce07da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FmDDstHda7Jt70H6voXBCw.png"/></div></div></figure><p id="517d" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">部署网关:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/cabbba5d65355ba47577e6daf60e3e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*7pf-Jvv7RY5_7JhsC5aCsw.png"/></div></figure><p id="70c6" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">检查它是否部署成功。</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi or"><img src="../Images/d0db65887726da12a560e2e1a7b317cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*_aTjzdJG7smYyPb2J45KdA.png"/></div></figure><p id="0015" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该看到:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div class="gh gi os"><img src="../Images/ea36a01bee55bde66dc689259967d838.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*_2Y91Kt3ssCLjXl9Dn6AlQ.png"/></div></figure><p id="87d2" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在是测试的时候了！:D</p><h1 id="929a" class="lt lu in bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">步骤8:测试您的服务</h1><p id="d529" class="pw-post-body-paragraph kh ki in kj b kk mr km kn ko ms kq kr ks mt ku kv kw mu ky kz la mv lc ld le ig bi translated">让我们获取上面创建的网关的IP地址。</p><p id="a202" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">运行:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ot"><img src="../Images/e39befc45cde481682cc2fce47cb5979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xlLBu_7JnZjWsK2YxKhUQg.png"/></div></div></figure><p id="2820" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">您应该看到:</p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ou"><img src="../Images/1018080486fed657030a6c1c758c5e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLPZ9NKtN8eZWWRCfeAyyA.png"/></div></div></figure><p id="bd41" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">复制外部IP。</p><p id="7839" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在，请致电Postman测试您的服务:</p><p id="1fc3" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated"><a class="ae jz" href="http://EXTERNAL-IP:80/users" rel="noopener ugc nofollow" target="_blank"><strong class="kj io"><em class="nc">http://EXTERNAL-IP:80/users</em></strong></a></p><figure class="mx my mz na gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/b9dcb6ca70764c556f38e5bbfb05b1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Pw5cwYovmyB9UMRJvtmAw.png"/></div></div></figure><p id="3ab5" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">令人满意！</p><p id="9fa7" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">现在你可以自由探索docker、gcloud和kubernetes的极限了。</p><p id="c33e" class="pw-post-body-paragraph kh ki in kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ig bi translated">祝你旅途愉快！！</p></div></div>    
</body>
</html>