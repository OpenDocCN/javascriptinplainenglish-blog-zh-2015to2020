<html>
<head>
<title>Opinionated Redux Setup with Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Typescript的固执己见的Redux设置</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/opinionated-redux-setup-with-typescript-eb71eb619716?source=collection_archive---------13-----------------------#2020-05-16">https://javascript.plainenglish.io/opinionated-redux-setup-with-typescript-eb71eb619716?source=collection_archive---------13-----------------------#2020-05-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/cea66393139e6df424c4035b7efbab5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5GmJjeYDYxddysV4s1tLYw.jpeg"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk">Photo by <a class="ae ja" href="https://unsplash.com/@steve_j?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Steve Johnson</a> on <a class="ae ja" href="https://unsplash.com/s/photos/opinion?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="24e7" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">什么，另一个关于如何设置Redux的帖子。我想分享我是如何通过构建一个简单的应用程序从weather.gov获取天气警报来设置我的Redux商店的。</p><p id="b961" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们从引导一个React应用程序开始。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="0742" class="lh li jd ld b gy lj lk l ll lm">npx create-react-app weather --template typescript</span></pre><p id="66b2" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这将为我们提供一个boiler plate React应用程序，所以让我们继续安装Redux依赖项。我们还将安装react-redux和redux-logger的类型，并安装axios来发出我们的请求。</p><p id="9d99" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">纱线:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="3ab8" class="lh li jd ld b gy lj lk l ll lm">yarn add redux react-redux axios<br/>yarn add --dev @types/react-redux redux-logger @types/redux-logger</span></pre><p id="732e" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">NPM:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="c0b4" class="lh li jd ld b gy lj lk l ll lm">npm i -S redux react-redux axios<br/>npm i -D @types/react-redux redux-logger @types/redux-logger</span></pre><p id="2154" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Redux logger是在控制台中查看状态变化的一种很好的方式，这样您就可以监视数据是如何流经Redux存储的。</p><figure class="ky kz la lb gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi ln"><img src="../Images/14dfc928340054f1313f5a9d63c7f85c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XyQNjxMZP7kmsqB7jN7Hxw.png"/></div></div></figure><p id="8191" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们继续并删除锅炉板文件，然后使目录结构。我也喜欢有一个基于应用程序所属部分的文件夹。所以我要做一个<code class="fe lo lp lq ld b">components</code>、<code class="fe lo lp lq ld b">context</code>和<code class="fe lo lp lq ld b">store</code>文件夹。在主src目录中，我将有一个<code class="fe lo lp lq ld b">index.tsx</code>文件，在组件中，我将有一个<code class="fe lo lp lq ld b">App.tsx</code>文件。</p><p id="5542" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们继续设置我们的主文件和应用程序组件:</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="4097" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的应用程序不多，但我们会实现的。让我们为商店设置锅炉板。当考虑商店时，我们将有一个天气键。那把钥匙应该包含我们的警报。让我们在商店中创建一个名为<code class="fe lo lp lq ld b">weather</code>的子文件夹。</p><p id="e230" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，让我们在<code class="fe lo lp lq ld b">weatherTypes.ts</code>文件中定义我们的类型:</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="1c52" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在类型中，我们利用Typescript中的enum为Redux提供我们的类型。我们还定义了我们的警报是什么样子，以及天气预报器的状态是什么样子。</p><p id="b0c4" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们创建我们的Reducer文件。</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="aa0b" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的减速器看起来不一样，那就是它里面没有开关盒。原因是当我们使用有限状态机时，我们希望重用我们的reducer函数。如果我们把api的不同部分拉进来，我们可以把我们的开始和失败类型映射到一个reducer，这样我们的代码就枯竭了，只需要声明新的reducer来处理成功的动作。</p><p id="2706" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">createReducer函数是一个高阶函数，它接受初始状态，并且是一个对象，其键值对链接到我们的Reducer函数。然后，它将状态和动作输入到reducer中。该文件如下所示:</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="212c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在是我们行动的时候了。我们只需要一个动作来获取天气警报。我们将利用react-redux包中钩子的能力，并将我们的动作分配给一个useCallback钩子来记忆函数。该文件如下所示:</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="0f23" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们建立我们的商店。我们将有一个<code class="fe lo lp lq ld b">index.ts</code>、<code class="fe lo lp lq ld b">reducers.ts</code>和<code class="fe lo lp lq ld b">useActions.tsx</code>文件。下面是它们的样子:</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="a462" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这三个文件是将商店结合在一起的粘合剂。我将reducers和actions导入到这些文件中，并将所有内容组合在一起。</p><p id="678e" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，我想做的下一件事是定义一个包含我的行为的上下文。我在src下创建了一个名为Contexts的文件夹，并创建了一个名为<code class="fe lo lp lq ld b">ActionsContext.tsx</code>的文件。</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="51f8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们的商店现在已经设置好了，让我们继续构建几个组件来测试我们的商店。我们将构建一个应用程序组件、一个容器和一个组件来处理每个警报。</p><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><figure class="ky kz la lb gt ip"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="772c" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">借助react-redux挂钩的强大功能，我们能够生成清晰易读且易于维护的代码。我知道这是很多信息，但谢谢你花时间阅读我如何喜欢我的redux。你觉得你的redux怎么样？</p><h1 id="ea5b" class="lt li jd bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated"><strong class="ak">用简单英语写的便条</strong></h1><p id="1c0d" class="pw-post-body-paragraph ka kb jd kc b kd mq kf kg kh mr kj kk kl ms kn ko kp mt kr ks kt mu kv kw kx ig bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae ja" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc je"> plainenglish.io </strong> </a>找到所有这些内容——关注我们的出版物并<a class="ae ja" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kc je">订阅我们的YouTube频道</strong> </a> <strong class="kc je">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>