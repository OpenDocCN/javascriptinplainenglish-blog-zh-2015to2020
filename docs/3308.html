<html>
<head>
<title>The JavaScript operator you are probably not using</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您可能没有使用的JavaScript操作符</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-operator-you-are-probably-not-using-1105a3010c8a?source=collection_archive---------9-----------------------#2020-09-17">https://javascript.plainenglish.io/the-operator-you-are-probably-not-using-1105a3010c8a?source=collection_archive---------9-----------------------#2020-09-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9a43611b3b137c77e231335fe2c8219e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*houwvl_NC8UphtV7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mohdali_31?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mohdammed Ali</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5b65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你在谷歌上搜索<code class="fe lb lc ld le b">javascript operators</code>这个词，然后点击<a class="ae kc" href="https://www.w3schools.com/js/js_operators.asp" rel="noopener ugc nofollow" target="_blank">的第一个结果</a>——这个神秘的操作者将无处可寻。至少在2020年9月，你必须点击第四个<strong class="kf ir"><em class="lf"/></strong>结果，然后在页面上搜索它，否则，它真的很容易被忽略，因为它不包含在任何漂亮的表格中。</p><h1 id="7c30" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">秘密够多了。</h1><p id="d06f" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">我说的是<code class="fe lb lc ld le b">Nullish Coalescing Operator</code> — <code class="fe lb lc ld le b">??</code>，它是一个二元逻辑运算符，与<code class="fe lb lc ld le b">||</code>(逻辑or)和<code class="fe lb lc ld le b">&amp;&amp;</code>(逻辑and)相同，只是它不做类型强制，实际上它类似于<code class="fe lb lc ld le b">||</code>，语法如下:</p><blockquote class="mj"><p id="25b8" class="mk ml iq bd mm mn mo mp mq mr ms la dk translated">leftExp？？rightExp</p></blockquote><p id="55fb" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">如果<code class="fe lb lc ld le b">leftExp</code>等于<code class="fe lb lc ld le b">null</code>或<code class="fe lb lc ld le b">undefined</code>，表达式将返回<code class="fe lb lc ld le b">rightExp</code>，没有<code class="fe lb lc ld le b">truthy</code>或<code class="fe lb lc ld le b">falsy</code>的转换发生，结果无法预料，比如<code class="fe lb lc ld le b">0</code>没有通过我们的数字检查，因为它是<code class="fe lb lc ld le b">falsy</code></p><p id="cbf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看来我们可以把<code class="fe lb lc ld le b">||</code>换成<code class="fe lb lc ld le b">??</code>然后就到此为止了？</p><h1 id="a868" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">不，这是为什么</h1><p id="7225" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">首先，这个操作符非常新，Chrome仅从2020年2月发布的版本80开始支持它，并且它需要JavaScript服务器端的节点v 14(2020年4月)。</p><figure class="mz na nb nc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/cd47ff1dce60ad11faa65b403dc808fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gWjrklEBgolF8Xf9zZFASw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">browser support</figcaption></figure><p id="3de4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其次，用<code class="fe lb lc ld le b">??</code>嵌套一个表达式仍然会进行类型转换，一个很好的例子是<code class="fe lb lc ld le b">if</code>语句:</p><pre class="mz na nb nc gt nd le ne nf aw ng bi"><span id="6200" class="nh lh iq le b gy ni nj l nk nl">if(0 ?? -1) {<br/>   console.log("a number!")<br/>}</span></pre><p id="c82e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">日志永远不会执行，我们将从表达式中得到<code class="fe lb lc ld le b">0</code>，但是在<code class="fe lb lc ld le b">if</code>的布尔上下文中，它仍然被认为是<code class="fe lb lc ld le b">falsy</code>。</p><p id="78b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，当用其他逻辑操作符链接它时，它的返回值仍然会受到类型转换的影响，这使得很难在心里处理。它还需要一组额外的括号:</p><pre class="mz na nb nc gt nd le ne nf aw ng bi"><span id="f489" class="nh lh iq le b gy ni nj l nk nl">let a = true &amp;&amp; (0 ?? false); // 0</span><span id="e8e6" class="nh lh iq le b gy nm nj l nk nl">let b = (0 ?? "bar") || "foo"; // "foo"</span><span id="6d71" class="nh lh iq le b gy nm nj l nk nl">let c = null ?? "bar" ?? "foo"; // "bar"</span><span id="da28" class="nh lh iq le b gy nm nj l nk nl">let d = (0 ?? "foo") &amp;&amp; "bar"; // 0</span></pre><h1 id="e4f9" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">不过也不全是坏事</h1><p id="e259" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">你可以用它很好地缩短赋值操作中边缘情况的检查，不需要显式地检查<code class="fe lb lc ld le b">null</code>和<code class="fe lb lc ld le b">undefined</code>，这应该在逻辑or的情况下完成。</p><pre class="mz na nb nc gt nd le ne nf aw ng bi"><span id="9c06" class="nh lh iq le b gy ni nj l nk nl">let a = 0;<br/>let b = a ?? -1;</span><span id="c3b2" class="nh lh iq le b gy nm nj l nk nl">let c = 0;<br/>let d = c !== null &amp;&amp; c !== undefined ? c : -1;</span></pre><p id="b5b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看一下前面的例子，逻辑OR的链接毫无意义，但是用<code class="fe lb lc ld le b">??</code>代替它意义重大。</p><pre class="mz na nb nc gt nd le ne nf aw ng bi"><span id="53c0" class="nh lh iq le b gy ni nj l nk nl">let b = 0 ?? "bar" ?? "foo"; // 0</span></pre><p id="0298" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是无法保存和。</p><h1 id="3da9" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">我应该取消联合吗？</h1><p id="f53f" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">如果项目允许，我个人会这样做，但只是在做任务检查时，因为表情比常规的<code class="fe lb lc ld le b">null</code>或<code class="fe lb lc ld le b">undefiend</code>检查更悦目，而且思维过程更快。</p><p id="78be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与其他逻辑操作符链接在一起确实会造成精神紧张，因为不再仅仅涉及<code class="fe lb lc ld le b">truthy</code>和<code class="fe lb lc ld le b">falsly</code>检查，还会涉及额外的<code class="fe lb lc ld le b">null/undefined</code>检查，这些检查随后会被转换为<code class="fe lb lc ld le b">truthy/falsy</code>——为了保持代码的整洁和连贯，应该避免使用它们。</p><h2 id="aaa2" class="nh lh iq bd li nn no dn lm np nq dp lq ko nr ns lu ks nt nu ly kw nv nw mc nx bi translated"><strong class="ak">简单英语的JavaScript</strong></h2><p id="3e43" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>