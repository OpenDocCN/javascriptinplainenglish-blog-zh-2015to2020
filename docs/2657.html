<html>
<head>
<title>JavaScript Best Practices — Interfaces, Tests, Async Code, and Comments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—接口、测试、异步代码和注释</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-interfaces-tests-async-code-and-comments-3f2fa174ab72?source=collection_archive---------9-----------------------#2020-07-12">https://javascript.plainenglish.io/javascript-best-practices-interfaces-tests-async-code-and-comments-3f2fa174ab72?source=collection_archive---------9-----------------------#2020-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f9c555dc26073e25a912e1d8b9d45ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NHjEiAO70BHMEqm3"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f96c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使代码易于阅读和维护，我们应该遵循一些最佳实践。</p><p id="0f90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看我们应该遵循的一些最佳实践，以使每个人的生活更轻松。</p><h1 id="2280" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">界面分离原理</h1><p id="5b2c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">即使JavaScript没有显式接口，我们也不应该让外部代码依赖于它们不使用的接口。</p><p id="c24e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该创造他们都能使用的界面。</p><p id="e02f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们不是用大量的方法来编写类，而是把它们分成更小的类。</p><p id="910e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也使他们不会有一个以上的责任。</p><h1 id="f406" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">测试</h1><p id="61dd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">测试对保持软件质量很重要。</p><p id="1a99" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以自动化其中的大部分，使我们的工作更容易。</p><p id="9978" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有些事情我们应该意识到。</p><h1 id="829b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">每个测试一个概念</h1><p id="3021" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该通过在每次测试中测试一个概念来简化测试。</p><p id="1755" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9802" class="mn lc iq mj b gy mo mp l mq mr">import assert from "assert";<br/><br/>describe("Rectangle", () =&gt; {<br/>  it("handles dimension changes", () =&gt; {<br/>    let rectangle;<br/><br/>    rectangle = new Rectangle(1, 2);<br/>    rectangle.setWidth(30);<br/>    assert.equal(30, rectangle.getWidth());<br/><br/>    rectangle = new Rectangle(1, 2);<br/>    rectangle.setHeight(30);<br/>    assert.equal(30, rectangle.getHeight());<br/>  });<br/>});</span></pre><p id="62a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e830" class="mn lc iq mj b gy mo mp l mq mr">import assert from "assert";<br/><br/>describe("Rectangle", () =&gt; {<br/>  it("changes height", () =&gt; {<br/>    const rectangle = new Rectangle(1, 2);<br/>    rectangle.setWidth(30);<br/>    assert.equal(30, rectangle.getWidth());<br/>  });<br/><br/>  it("changes width", () =&gt; {<br/>    const rectangle = new Rectangle(1, 2);<br/>    rectangle.setHeight(30);<br/>    assert.equal(30, rectangle.getHeight());<br/>  });<br/>});</span></pre><p id="818d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了两个测试，而不是一个。</p><h1 id="2735" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">异步ˌ非同步(asynchronous)</h1><p id="140f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">JavaScript代码是异步的，所以我们必须写很多异步回调函数。</p><h1 id="d6e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用承诺，而不是回电</h1><p id="8df8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该用承诺来做异步操作。</p><p id="9c75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们不得不做多个操作，这就特别有用。</p><p id="cc57" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0306" class="mn lc iq mj b gy mo mp l mq mr">import { writeFile, readFile } from "fs";<br/><br/>readFile(<br/>  <!-- -->'./foo.txt',<br/>  (<!-- -->err, data)<!-- -->) =&gt; {<br/>    if (err) {<br/>      console.error(err);<br/>    } else {<br/>      writeFile("./bar.txt", <!-- -->data<!-- -->, writeErr =&gt; {<br/>        if (writeErr) {<br/>          console.error(writeErr);<br/>        } else {<br/>          console.log("File written");<br/>        }<br/>      });<br/>    }<br/>  }<br/>);</span></pre><p id="94e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c725" class="mn lc iq mj b gy mo mp l mq mr">const fs = require("fs");<br/>const { promisify } = require("util");<br/><br/>const writeFile = promisify(fs.writeFile);<br/>const readFile = promisify(fs.readFile);</span><span id="ee26" class="mn lc iq mj b gy ms mp l mq mr">async function main() {<br/>  const data = await writeFile("/foo.txt");<br/>  await writeFile("./<!-- -->bar.txt<!-- -->", data);<br/>}</span></pre><p id="3330" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe mt mu mv mj b">async</code>和<code class="fe mt mu mv mj b">await</code>来链接承诺。</p><p id="17cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">util.promisify</code>将一些异步函数转换成承诺。</p><h1 id="d692" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">错误处理</h1><p id="8614" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">错误处理很重要。</p><p id="6121" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该忽略被发现的错误。</p><p id="3b81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="59dd" class="mn lc iq mj b gy mo mp l mq mr">try {<br/>  doSomething();<br/>} catch (error) {<br/>  console.log(error);<br/>}</span></pre><p id="4349" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7d81" class="mn lc iq mj b gy mo mp l mq mr">try {<br/>  doSomething();<br/>} catch (error) {<br/>  console.error(error);<br/>  notifyError(error);<br/>}</span></pre><p id="6112" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">console.error</code>或另一个函数或两者都用，使错误变得明显。</p><h1 id="0fee" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要忽视被拒绝的承诺</h1><p id="97f6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该忽视被拒绝的承诺。</p><p id="1dee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="98ab" class="mn lc iq mj b gy mo mp l mq mr">getdata()<br/>  .then(data =&gt; {<br/>    doSomething(data);<br/>  })<br/>  .catch(error =&gt; {<br/>    console.log(error);<br/>  });</span></pre><p id="7c8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="052d" class="mn lc iq mj b gy mo mp l mq mr">getdata()<br/>  .then(data =&gt; {<br/>    doSomething(data);<br/>  })<br/>  .catch(error =&gt; {<br/>    console.error(error);<br/>    notifyError(error);<br/>  });</span></pre><p id="7ebc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe mt mu mv mj b">console.error</code>或另一个函数或者两者都用，使错误变得明显。</p><h1 id="e085" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">格式化</h1><p id="b2f9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该争论格式问题。</p><p id="7d91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是浪费时间。</p><h1 id="6da2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用一致的大写</h1><p id="4896" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该在代码中使用一致的大写字母。</p><p id="c5c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们将常量的名称大写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="544c" class="mn lc iq mj b gy mo mp l mq mr">const DAYS_IN_WEEK = 7;</span></pre><p id="2cc0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，对于大多数其他标识符，我们使用camel case:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3e8c" class="mn lc iq mj b gy mo mp l mq mr">function eraseDatabase() {}</span></pre><p id="ec37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于构造函数或类，我们使用Pascal case:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9351" class="mn lc iq mj b gy mo mp l mq mr">class Animal {}</span></pre><h1 id="efbb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">函数调用者和被调用者应该接近</h1><p id="0477" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该让调用者和被调用者离得很近，这样我们就不必跳来跳去地阅读我们的代码。</p><p id="6918" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5ae9" class="mn lc iq mj b gy mo mp l mq mr">class Foo {<br/>  foo(){}<br/><br/>  bar() {<br/>    this.foo();<br/>  }<br/>}</span></pre><p id="198f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们尽可能让他们在一起。</p><p id="f64d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这比:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a038" class="mn lc iq mj b gy mo mp l mq mr">class Foo {<br/>  foo(){}</span><span id="bebb" class="mn lc iq mj b gy ms mp l mq mr">  baz(){}</span><span id="5326" class="mn lc iq mj b gy ms mp l mq mr">  qux(){}</span><span id="42b8" class="mn lc iq mj b gy ms mp l mq mr">  bar() {<br/>    this.foo();<br/>  }<br/>}</span></pre><p id="30bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须通过多种方法来读取这些内容。</p><h1 id="bf1d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">评论</h1><p id="260f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该评论那些不能被代码告知的事情。</p><p id="3a74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7af3" class="mn lc iq mj b gy mo mp l mq mr">// loop through objects<br/>for (const item of items) {<br/>  //...<br/>}</span></pre><p id="ead1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以省略它，因为代码已经告诉了我们它的作用:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d704" class="mn lc iq mj b gy mo mp l mq mr">for (const item of items) {<br/>  //...<br/>}</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/dccc252b5d41b4e9f20b6e69c3b34f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3Jw_95huxZKi2NLS"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@chrishcush?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christian Bowen</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="88d3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="4625" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该有小界面，这样我们就不必依赖大界面，因为大界面中的项目并没有被完全使用。</p><p id="8e8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试应该有一个单一的概念。</p><p id="c31e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对异步代码使用承诺。</p><p id="759e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">函数调用者和被调用者应该靠得很近。</p><p id="c24b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该写注释来重复代码中所说的内容。</p><h2 id="ee35" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated">简单英语的JavaScript</h2><p id="3572" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码获得更多类似内容，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>