<html>
<head>
<title>React Redux Deep Dive: State Management in React with Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Redux深潜:React with Redux中的状态管理</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-redux-deep-dive-state-management-in-react-with-redux-b9af8b039bcc?source=collection_archive---------6-----------------------#2020-11-29">https://javascript.plainenglish.io/react-redux-deep-dive-state-management-in-react-with-redux-b9af8b039bcc?source=collection_archive---------6-----------------------#2020-11-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/3e91f6d35a354231c52cde2ede364215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_N4nKDnGqOAsz2Pc.jpg"/></div></div></figure><h1 id="a0cb" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h1><p id="516a" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在React的世界里，高效的状态管理是开发人员为了制作一个可靠的网站而必须执行的最重要的事情之一，Redux是实现这一点的最佳方式之一。<br/>在这篇文章中，我们将看到如何开始使用Redux，并使用它来轻松管理React应用程序中的状态。</p><h1 id="a340" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">Redux是什么？</h1><h2 id="1162" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated">Redux是JavaScript应用程序的可预测状态容器。</h2><p id="cbdb" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Redux用于以不可变的方式管理和更新状态。<br/>这意味着，当对状态进行更改时，现有状态不会更新为新值，而是创建现有数据的新引用，进行更改并以此替换旧状态。</p><h1 id="8c71" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">为什么是Redux？</h1><p id="5ec4" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Redux有助于创建一个单一的真相来源。Redux允许您在一个地方维护您的所有数据，使生活变得更加轻松。您所有的数据存储和操作都发生在一个地方。介绍到此为止..是时候把手弄脏了。</p><h1 id="f058" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">我们要建造什么？</h1><p id="08c0" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">我们将建立一个简单的应用程序，我们可以管理两个实体，职位和待办事项。可以在这里看一下已经完成的网站<a class="ae md" href="https://senshiii.github.io/React-Redux-101/" rel="noopener ugc nofollow" target="_blank">。我们会的</a></p><ul class=""><li id="2cfe" class="me mf in kv b kw mg la mh le mi li mj lm mk lq ml mm mn mo bi translated"><code class="fe mp mq mr ms b">Loading Posts and Todos from the JSON PlaceHolder API</code></li><li id="ac66" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ml mm mn mo bi translated"><code class="fe mp mq mr ms b">Adding a Post or Todo</code></li><li id="79f1" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ml mm mn mo bi translated"><code class="fe mp mq mr ms b">Deleting a Post or Todo</code></li></ul><p id="764e" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">我们将在这个项目中使用的主要包是</p><h1 id="9c9b" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">设置项目</h1><ol class=""><li id="43ff" class="me mf in kv b kw kx la lb le nb li nc lm nd lq ne mm mn mo bi translated">您可以从这个<a class="ae md" href="https://github.com/senshiii/React-Redux-101" rel="noopener ugc nofollow" target="_blank"> repo </a>中克隆项目。主分支使用基于类的组件。如果你喜欢钩子，就克隆钩子分支。克隆完成后，运行<code class="fe mp mq mr ms b">npm install</code>。</li><li id="76ba" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ne mm mn mo bi translated">在你的浏览器中安装<a class="ae md" href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd" rel="noopener ugc nofollow" target="_blank"> Redux开发工具</a>作为扩展。Redux开发工具提供了一个界面来跟踪您的状态变化，状态信息，行动，允许我们恢复到以前的状态版本，等等..</li></ol><h1 id="30ac" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">了解冗余流</h1><p id="3662" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">redux流的三个主要组成部分包括:</p><p id="8c28" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated"><strong class="kv io">Store:</strong>Store是数据和逻辑的中枢，这是您的应用程序订阅的内容。</p><p id="e7d0" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated"><strong class="kv io">动作:</strong>动作基本上是从您的应用程序“分派”的事件。动作由它们的“类型”唯一标识，这用于触发商店数据中的特定变化。动作基本上是一个具有类型属性的对象。我们还可以将该对象中的附加数据发送给reducer，这些数据将在reducer函数的action参数中提供。</p><pre class="nf ng nh ni gt nj ms nk nl aw nm bi"><span id="d58e" class="lr jw in ms b gy nn no l np nq">const action = { type: 'ACTION_TYPE_1' } <br/>const anotherAction = { type: 'ACTION_TYPE_2', data: 'ANY TYPE OF DATA: OBJECT, STRING, ETC...' }</span></pre><p id="e143" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated"><strong class="kv io">Reducer:</strong>Reducer可以被认为是一个事件监听器，它监听动作，然后更新状态(如果需要的话)并返回新的和更新的状态。缩减器是接受旧状态和动作对象并返回更新/新状态的函数。</p><pre class="nf ng nh ni gt nj ms nk nl aw nm bi"><span id="3665" class="lr jw in ms b gy nn no l np nq">const reducer = (prevState, action) =&gt; { <br/>   /* STUFF HAPPENS */ <br/>   return updatedState <br/>}</span></pre><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/519facbe4b04bb4efc90d7545a5e762f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyBne5FfevVF_foKrF2tLA.png"/></div></div></figure><p id="7810" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">Redux流从一个特定“类型”的动作开始，由于某些事件，该动作从应用程序UI被分派。动作被缩减器接受，然后缩减器根据动作的“类型”改变状态。它可能只会改变国家的某一部分。其余的数据被重新创建并保留。</p><p id="ced6" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">在上图中，<strong class="kv io">根减速器</strong>块中有两个小减速器块。这是因为一个商店可以有多个<strong class="kv io">片/片</strong>状态。每个状态片段都有自己的动作列表，并有自己独立的缩减器。然而，重要的是要注意，商店只能接受一个缩小，即根缩小。因此，单个切片被组合成一个根归约器，单个切片可以通过映射到一个对象来访问，我们将在后面看到。</p><p id="af5e" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">另一个需要理解的<strong class="kv io">超级重要的</strong>概念是当<em class="ns">异步任务</em>参与时的冗余流。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/8475bbc44b9be7b4e31cf77111357f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z8riSAA12PDMD7NJgOdzIw.png"/></div></div></figure><p id="54c5" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">Redux存储本身无法执行异步任务。所有操作同步发生。但是几乎所有现实生活中的应用程序都需要执行异步任务。</p><p id="43d4" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">那么我们如何做到这一点呢？我们使用<strong class="kv io"> thunks </strong>作为<strong class="kv io">中间件</strong>。Thunks只不过是一个返回另一个函数的函数。</p><p id="7c8c" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">因此，为了执行一个异步任务，我们调度一个thunk…异步任务被执行，并且在完成时，必要的动作被调度。查看上面的图表以可视化流程。</p><h1 id="6428" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">浏览代码</h1><p id="95d9" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">看一下我们看到的src文件夹</p><p id="e89f" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">有4个组件:</p><ul class=""><li id="7c3b" class="me mf in kv b kw mg la mh le mi li mj lm mk lq ml mm mn mo bi translated">帖子—显示所有帖子、加载和错误消息。显示Post组件列表。</li><li id="1a57" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ml mm mn mo bi translated">待办事项—显示所有待办事项、加载和错误消息。显示待办事项组件列表。</li><li id="3daf" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ml mm mn mo bi translated">待办事项—显示单个待办事项</li><li id="20a6" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ml mm mn mo bi translated">帖子—显示单个帖子</li></ul><p id="51c3" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">主容器是显示文章和Todos组件的父组件。</p><p id="7092" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">让我们先检查一下存储文件夹中的文件。</p><h2 id="b111" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak"> store/index.js </strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/ae1533f53d0928b31e883e19668da279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lfMuFis1YIHrDIB1KJcpGg.png"/></div></div></figure><p id="1a2d" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">该文件设置将在React应用程序中使用的商店。首先，我们从设置商店所需的库中导入必要的东西。</p><p id="704a" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">我们还从reducers文件夹中导入rootReducer。</p><p id="5ca4" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">接下来，我们设置Redux开发工具。(有关连接Redux开发工具的更多信息，请查看此处的<a class="ae md" href="https://github.com/zalmoxisus/redux-devtools-extension" rel="noopener ugc nofollow" target="_blank"/>)</p><p id="768c" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">继续，现在我们使用createStore方法创建商店并传入<em class="ns"> rootReducer </em>并使用add <em class="ns"> thunk </em>作为使用<em class="ns"> applyMiddleware </em>函数的中间件。</p><p id="6aa1" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">如果您想在生产中隐藏redux dev工具，您可以这样做。</p><pre class="nf ng nh ni gt nj ms nk nl aw nm bi"><span id="d2df" class="lr jw in ms b gy nn no l np nq">const composeEnhancers = process.env.NODE_ENV === 'development' ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose : compose;</span></pre><h2 id="4306" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak"> store/types.js </strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/be7625a2d3737dc10b348c9da3e70b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c6ITU3V1XoFI8zejdGhUIw.png"/></div></div></figure><p id="849a" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">这个文件列出了所有不同的动作类型，这些动作类型在调度动作时会用到，在决定调度动作时也会在reducer中用到。</p></div><div class="ab cl nu nv hr nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ig ih ii ij ik"><p id="390c" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">“操作”和“减速器”文件夹具有类似的结构。对于每个状态片段，在各自的文件夹中都有一个动作文件和reducer文件。actions文件夹中的索引文件导出所有动作，reducer文件夹中的索引文件导出上面的存储文件使用的rootReducer。</p><p id="872a" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">我将解释这个国家的一部分。对于另一个片(Todo)，概念是相同的。</p><h2 id="b684" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak"> actions/post-actions.js </strong></h2><p id="4e19" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">如前所述，动作是一个对象，我们将使用函数来返回对象。这是最常用的模式。我们会遇到两种函数。一个直接返回动作对象，另一个返回thunk。<br/>从动作文件中导出的函数是将要从React应用程序中调用的函数。</p><h2 id="c9df" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak">直接返回动作obj的示例函数:</strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/5ce8bbe64512279d4213ce4a712e5cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mkbjggj0wTslAsAv6mDZsQ.jpeg"/></div></div></figure><p id="77ac" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">第一个函数只返回动作对象。第二个函数只是返回带有一些通过参数接收的附加数据的对象。</p><h2 id="b1b8" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak">返回thunk的函数示例:</strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nr"><img src="../Images/f1f69d2c590fc3066e6d32eabbda4cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mr7GvrXS1pvKu-Bni3tgKg.png"/></div></div></figure><p id="6d9e" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">这个函数返回另一个函数(基本上是一个thunk)，它有一个参数dispatch，用于在异步任务完成之前和/或之后调度事件。<br/>如代码所示，在这个函数的开始，我们通过调用loadPostsStart函数来调度<strong class="kv io"> LOADING_POSTS </strong>动作。<br/>当成功提取帖子后，调用setPosts函数并传递提取的帖子作为参数，从而调度<strong class="kv io"> SET_POSTS </strong>动作。最后，如果有错误，我们通过调用setError函数来调度<strong class="kv io"> POST_ERROR </strong>动作。</p><p id="2484" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">对于我们执行的每种类型的操作，我们都要编写所需的函数。如果操作涉及任何异步任务，我们编写一个thunk函数和其他函数，当异步任务结束时，这些函数将分派事件。</p><p id="d1a8" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">这是另一个使用参数的thunk。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/c38252747adf1c80b79a3bbd15787a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmKBOHNOeAJboIH3jKI6NQ.png"/></div></div></figure><h2 id="9a04" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak"> actions/index.js </strong></h2><p id="831c" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在这个文件中，来自不同文件的所有操作都在一个对象中导入和导出，该对象将在React组件中使用，以调度操作。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/409705ff30bf8a8dc61a196be6175207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CerrjvGPbDrZI1SDjhXysg.png"/></div></div></figure><h2 id="a04f" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak">减速器/后置减速器. js </strong></h2><p id="4849" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">在每个reducer文件中，首先定义初始状态，然后是reducer函数。在reducer函数中，开关盒用于确定动作的类型，然后进行相关的更改，并返回更新后的状态对象。在默认情况下，返回当前状态。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/7ab88b9aeb5e296c6ba9e2fb287bdb8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1zKtxfQTtgBL9cNz08KZg.png"/></div></div></figure><p id="81cc" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">更新状态时要记住的最重要的一点是，必须重新创建整个状态，或者换句话说，我们需要对现有状态进行深度克隆，更新一些部分并返回更新后的状态。</p><p id="0635" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">如果您使用数组、嵌套对象或对象数组，并且您会经常使用它们，那么深度克隆就非常重要。</p><p id="5f81" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">执行所有这些的深度克隆的最好和最简单的方法是使用JSON.parse()和JSON.stringify()。</p><p id="c06d" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">这是一个更新文章的动作，它是一个对象数组。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/81f78d132870360c630888fffa2a16c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXGUyL4MyAao1Ua3I7eMlw.png"/></div></div></figure><p id="7ccf" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">这是一个添加帖子的动作。在这里我们可以看到，首先posts数组是深度克隆的。然后用新帖子创建一个数组，所有旧帖子都被添加到这个数组中。最后，更新后的状态被返回，先前的状态被重新创建并保留(…state)，posts数组被更新。</p><p id="ffce" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">您可以在每一步查看reducer文件中的注释。</p><h2 id="84e3" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated"><strong class="ak"> reducers/index.js </strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/d445f96607519b270e8d87c0cdc7ea69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bq9BSa1aMn-_wpC2ejT6Ww.png"/></div></div></figure><p id="5a1a" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">在这个文件中，我们将所有的归约器合并成一个归约器，通常称为rootReducer。注意，当我们调用combineReducers时，我们将每个reducer(属于一个特定的状态片)映射到一个对象的属性。这用于区分React应用程序中状态的不同部分。</p><h1 id="52ee" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">将商店连接到React应用程序</h1><p id="4953" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">现在，最后一步是将商店连接到我们的React应用程序。</p><h2 id="1019" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated">第一步。<strong class="ak">src/index . js中的提供者</strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/c2d4a64f0e8e9c099e46c795c9ccdffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J73fo1KYfErBEjnzGrO8Vw.png"/></div></div></figure><p id="c51b" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">我们导入提供者组件和商店，并将其传递给商店道具。整个应用程序由提供者组件包装。</p><h2 id="02d3" class="lr jw in bd jx ls lt dn kb lu lv dp kf le lw lx kj li ly lz kn lm ma mb kr mc bi translated">第二步。<strong class="ak"> mapStateToProps和mapDispatchToProps </strong></h2><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nt"><img src="../Images/9b9d3a2c8eb4f267ff01111a37e7f188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i6Y9TttRbrvIv7XRYqFj6Q.png"/></div></div></figure><p id="568b" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">我们需要创建两个常数-</p><ol class=""><li id="058f" class="me mf in kv b kw mg la mh le mi li mj lm mk lq ne mm mn mo bi translated">mapStateToProps具有一个参数state的函数，可用于从状态的不同部分提取数据，并将它们映射到组件中作为属性可用的属性。<br/>例如:Posts、loadingPosts(提取自posts切片)、todos(提取自todos切片)等。可以通过props.posts、props.todos等方式访问。</li><li id="fd5b" class="me mf in kv b kw mt la mu le mv li mw lm mx lq ne mm mn mo bi translated">mapDispatchToProps —带有一个参数调度的函数，用于映射调用带有可选附加数据的调度函数来调度某个事件的函数。这些也可以作为连接组件中的道具。</li></ol><p id="e24e" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">最后，我们调用connect，传递mapStateToProps和mapDispatchToProps对象，然后传递我们的组件。然后我们通常在应用程序中使用这些作为道具。</p><p id="e604" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated"><em class="ns">您可以使用mapStateToProps(省略第二个参数)或mapDispatchToProps(将null作为第一个参数传递)来调用connect。</em></p><h1 id="4722" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用Redux开发工具</h1><p id="ccf1" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">单击此圆形图标打开Redux开发工具。您可以检查所有已调度的操作。在右边的部分，您可以查看所有内容、操作、整个状态数据、状态数据的差异等。</p><figure class="nf ng nh ni gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ob"><img src="../Images/b02bbdde539d95571da4842d4861b4e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZiEmo18YjwojSA8y2u6qg.jpeg"/></div></div></figure></div><div class="ab cl nu nv hr nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ig ih ii ij ik"><p id="6465" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">就这样了。希望您对Redux如何与React一起工作有一个坚实的基本理解。摆弄代码。你总能从<a class="ae md" href="https://react-redux.js.org/using-react-redux/connect-mapstate" rel="noopener ugc nofollow" target="_blank">官方文件</a>中学到更多。请随意提出任何拉动请求。会很高兴见到他们。下次见。👋❤</p><p id="c1cd" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated">我的更多文章:</p><ul class=""><li id="8284" class="me mf in kv b kw mg la mh le mi li mj lm mk lq ml mm mn mo bi translated">如何构建你的React应用:<a class="ae md" href="https://medium.com/swlh/demystifying-the-folder-structure-of-a-react-app-c60b29d90836" rel="noopener">https://medium . com/swlh/demystifying-the-folder-structure-of-a-React-app-c 60 b 29d 90836</a></li></ul></div><div class="ab cl nu nv hr nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ig ih ii ij ik"><p id="6145" class="pw-post-body-paragraph kt ku in kv b kw mg ky kz la mh lc ld le my lg lh li mz lk ll lm na lo lp lq ig bi translated"><em class="ns">原载于2020年11月29日</em><a class="ae md" href="https://dev.to/senshiii/react-redux-deep-dive-state-management-in-react-with-redux-5299" rel="noopener ugc nofollow" target="_blank"><em class="ns">https://dev . to</em></a><em class="ns">。</em></p></div></div>    
</body>
</html>