<html>
<head>
<title>Build a Cryptocurrency Tracker with Next.js and Apollo GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Next.js和Apollo GraphQL构建加密货币追踪器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-a-cryptocurrency-tracker-with-next-js-and-apollo-graphql-c776cff6b8bf?source=collection_archive---------6-----------------------#2020-03-24">https://javascript.plainenglish.io/build-a-cryptocurrency-tracker-with-next-js-and-apollo-graphql-c776cff6b8bf?source=collection_archive---------6-----------------------#2020-03-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b6d0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">跟踪比特币、以太币、莱特币和其他加密货币的价格！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a357e63ca07a7cc5570f18f6629fc57b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*akklBC0ffXgUz6w4"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Austin Distel</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="6187" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="bad7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">凭借在<a class="ae kv" href="https://github.com/zeit/next.js/" rel="noopener ugc nofollow" target="_blank"> Github </a>上超过<em class="mk"> 45，000 </em>位明星和超过<em class="mk"> 300，000 </em> <a class="ae kv" href="https://www.npmjs.com/package/next" rel="noopener ugc nofollow" target="_blank"> npm </a>周下载量，<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>是目前该领域最热门的React框架之一。它提供了开箱即用的服务器端渲染，针对速度进行了优化，并且相对快速且易于启动和运行。我现在不会深入探讨<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>的所有好处，因此我们可以专注于构建我们的加密货币跟踪应用程序！</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="d063" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">我们正在建造的东西</h1><p id="526f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本文中，我们将使用<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>和<a class="ae kv" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank"> Apollo GraphQL </a>构建一个加密货币追踪应用程序。该应用程序将通过轮询间隔从<a class="ae kv" href="https://p.nomics.com/cryptocurrency-bitcoin-api" rel="noopener ugc nofollow" target="_blank"> Nomics API </a>获取数据来显示前30种加密货币的价格。让我们快速浏览一下特性。</p><ul class=""><li id="559d" class="mx my iq lq b lr mz lu na lx nb mb nc mf nd mj ne nf ng nh bi translated">在主页上，我们将在一个格式精美的表格中显示前30种加密货币的列表。</li><li id="6c11" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated">每一行都是可选择的——当选择时，会弹出一个模式，显示硬币在过去一天的详细数据。</li><li id="0db7" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated">在模式弹出窗口中—用户可以将日期范围从1天更改为7天、30天、365天和年初至今。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/fced6639cd2ec882f680955676432f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G8WFGIDemYc_bNLF2Qan2g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Home Page — Displays the top 30 cryptocurrencies</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/f4305c56b47a835a74d4d7621e74a55b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhwjV0pSyxYzfW7W6YVWYw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Coin Details Modal — Displays detailed information on selected coin</figcaption></figure><p id="7c1d" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">您可以在我的github上找到完整的项目:</p><div class="ns nt gp gr nu nv"><a href="https://github.com/kluu1/next-crypto-tracker" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd ir gy z fp oa fr fs ob fu fw ip bi translated">kluu1/下一个加密跟踪器</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">用Apollo graph QL-kluu 1/next-crypto-tracker在Next.js中构建一个加密货币跟踪器</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj kp nv"/></div></div></a></div></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="e9f8" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">先决条件</h1><p id="f6f4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在开始之前，让我们先了解一下本教程的一些先决条件。</p><ul class=""><li id="e213" class="mx my iq lq b lr mz lu na lx nb mb nc mf nd mj ne nf ng nh bi translated">节点版本10.x —对于<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>是必需的</li><li id="a322" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated">经济学家AP(T21)I key——用于获取加密货币价格</li><li id="e38e" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated"><a class="ae kv" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React.js </a>知识</li><li id="1774" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated"><a class="ae kv" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>知识</li><li id="8c3b" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated"><a class="ae kv" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>的知识</li><li id="97f9" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated"><a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>的一些知识</li></ul></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="4650" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">项目设置</h1><p id="4837" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我假设你已经安装了<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>。在撰写本文时，<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>的最新版本是9.3.0。</p><p id="2c73" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">让我们开始创建一个新的<a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>项目，在终端中运行<code class="fe ok ol om on b"><strong class="lq ir">npm init next-app</strong></code> <strong class="lq ir"> <em class="mk"> </em> </strong>，并将该项目命名为<strong class="lq ir"><em class="mk"/>next-crypto-tracker</strong>。</p><pre class="kg kh ki kj gt oo on op oq aw or bi"><span id="64c0" class="os kx iq on b gy ot ou l ov ow">npm init next-app</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="46a9" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">构建GraphQL服务器</h1><p id="a441" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，我们将使用<a class="ae kv" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank"> Apollo GraphQL </a>构建后端，从<a class="ae kv" href="https://nomics.com/" rel="noopener ugc nofollow" target="_blank"> Nomics </a>获取加密货币数据。然后我们可以将数据返回到前端进行渲染。让我们在您最喜欢的源代码编辑器中打开项目，并创建一些新文件。</p><ul class=""><li id="232b" class="mx my iq lq b lr mz lu na lx nb mb nc mf nd mj ne nf ng nh bi translated"><code class="fe ok ol om on b">/pages/api/index.js</code></li><li id="4817" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated"><code class="fe ok ol om on b">/pages/api/resolvers.js</code></li><li id="2fda" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated"><code class="fe ok ol om on b">/pages/api/typeDefs.js</code></li></ul><h2 id="f3fe" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">设置TypeDefs</h2><p id="ab94" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们打开<code class="fe ok ol om on b">/pages/api/typeDefs.js</code>并定义GraphQL模式和查询。这个文件描述了我们的数据的外观和类型。我们将公开两个查询，一个用于获取前30个硬币的列表，另一个用于按时间间隔(1d、7d、30d、365d、ytd)获取特定硬币及其详细数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">typeDef defines the data structure and queries</figcaption></figure><h2 id="d331" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">设置解析器</h2><p id="f677" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">接下来，我们构建解析器来获取和返回数据。打开<code class="fe ok ol om on b">/pages/api/resolvers.js</code>，修改成如下图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">resolvers tells us how to handle our queries</figcaption></figure><p id="7f35" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">这里，我们有解析器来处理我们的查询，<code class="fe ok ol om on b">getCoins</code>和<code class="fe ok ol om on b">getCoinDetails</code>。</p><p id="0144" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">我们使用<code class="fe ok ol om on b">getCoins</code>来获取加密货币的列表。默认情况下，<a class="ae kv" href="https://nomics.com/" rel="noopener ugc nofollow" target="_blank"> Nomics </a>将返回所有加密货币——这比我们想要的数据要多。我们使用slice方法返回前30个加密货币，因此我们不会返回大量数据。</p><p id="3cfe" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated"><code class="fe ok ol om on b">getCoinDetails</code>解析器将获取特定硬币的数据，并在一个时间间隔(1d、7d、30d、365d、ytd)内返回其数据。</p><h2 id="d506" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">设置GraphQL服务器</h2><p id="f0f3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最后，打开<code class="fe ok ol om on b">/api/graphql/index.js</code>并添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><p id="1f56" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">我们导入typeDefs和解析器来创建我们的Apollo服务器。然后我们在<code class="fe ok ol om on b">/api/graphql</code>路径上创建了处理程序。</p><h2 id="c029" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">测试我们的GraphQL服务器</h2><p id="c0b1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我们深入前端之前，让我们测试一下我们的后端是否设置好并正常运行。从您的终端，运行项目根目录下的<code class="fe ok ol om on b">npm run dev</code>来启动应用程序。一旦应用程序编译完成并准备就绪，请在浏览器中访问<a class="ae kv" href="http://localhost:3000/api/graphql" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/API/graph QL</a>。让我们测试我们的查询。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pk"><img src="../Images/a6e4adcab954371e4df26a317dbaf816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQTo7TNHsPq8D16Pnz8E7A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Testing the getCoins query</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pk"><img src="../Images/95319059e0b01418fe10fa33d97563c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UDZSuT4VzuLKQErosTr47Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Testing the getCoinDetails query</figcaption></figure><p id="f5a7" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">这就是设置Apollo GraphQL服务器的基本内容。我们现在可以开始构建前端了。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="e2e1" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">构建前端</h1><p id="3ddc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在我们可以将注意力转移到构建应用程序的前端。我们将从在我们的应用程序中配置和设置Apollo客户端开始。然后，我们将设置组件和页面。在我们开始之前，让我们为我们将在整个应用程序中使用的过滤器和查询创建一些文件。</p><p id="be66" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">在根目录下创建一个新文件夹<code class="fe ok ol om on b">utils</code>和一个新文件<code class="fe ok ol om on b">/utils/filters.js</code>。这里，我们有一个用于格式化货币并将十进制值转换为百分比的过滤器。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/utils/filters.js</figcaption></figure><p id="726a" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">接下来，创建一个新文件来存储我们的GraphQL查询，<code class="fe ok ol om on b">/utils/queries.js</code>。<code class="fe ok ol om on b">getCoinDetails</code>查询有两个参数，<code class="fe ok ol om on b">coinid</code>和<code class="fe ok ol om on b">interval</code>，这两个参数都是字符串类型，并且是必需的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/utils/queries.js</figcaption></figure><h2 id="35b2" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">配置Apollo客户端</h2><p id="933d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在<code class="fe ok ol om on b">utils</code>文件夹中创建一个新文件<code class="fe ok ol om on b">apollo-client.js</code>，并添加以下代码。这个文件将创建一个新的Apollo客户机。我们导出它，以便在我们的入口点<code class="fe ok ol om on b">_app.js</code>中使用它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/utils/apollo-client.js</figcaption></figure><h2 id="48e9" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">_app.js页面</h2><p id="3e4d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">创建一个新文件<code class="fe ok ol om on b">/pages/_app.js</code>。这将是我们所有页面的入口点。这是我们从刚刚创建的<code class="fe ok ol om on b">apollo-client.js</code>文件中导入Apollo客户端并将其传递给Apollo Provider的地方。然后，我们将整个应用程序包装在Apollo提供程序中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/pages/_app.js</figcaption></figure><h2 id="4070" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">布局组件</h2><p id="5f51" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">接下来，让我们着手构建布局。该布局是一个包装组件，将在其中呈现我们的所有页面。这是我们设置标题内容和标题的地方。让我们在<code class="fe ok ol om on b">/components/_App/Layout.js</code>中创建该文件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/components/_App/Layout.js</figcaption></figure><h2 id="0fa1" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">标题组件</h2><p id="c594" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在来看标题组件。创建一个新文件<code class="fe ok ol om on b">/components/_App/Header.js</code>并复制以下代码。这是我们的标题，将显示在我们的应用程序的顶部。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/components/_App/Header.js</figcaption></figure><h2 id="531b" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">可共溶成分</h2><p id="f576" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在我们有了布局，让我们构建一些核心组件。硬币表组件将为传递到该组件的硬币列表呈现一个格式化的表。创建一个新文件<code class="fe ok ol om on b">/components/Index/CoinsTable.js</code>。</p><p id="415a" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">每一行都是可选的。当您选择该行时，会弹出一个模态，显示关于该硬币的详细信息。注意，在第45行，我们将选择的硬币传递给模型，这样模型就可以获取选择的硬币的详细数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><code class="fe ok ol om on b">/components/Index/CoinsTable.js</code></figcaption></figure><h2 id="8ae8" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">硬币细节模型</h2><p id="44d2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">好吧，让我们处理硬币细节模型。创建一个新文件<code class="fe ok ol om on b">/components/Index/CoinDetailsModal.js</code>并粘贴下面的代码。注意，在第7行，我们从将从CoinsTable传入的props中析构了coinDetails。有了这些数据，我们就能获取硬币的详细信息。</p><p id="9640" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">当一个模态第一次弹出时，它显示过去一天所选硬币的详细信息。用户可以选择其他时间间隔，如7天、30天、365天和年初至今。</p><p id="1992" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">请注意第57行，我决定将表格组件化，将硬币细节显示到一个单独的文件中，因为这个文件变得相当大。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><code class="fe ok ol om on b">/components/Index/CoinDetailsModaljs</code></figcaption></figure><h2 id="4e8d" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">硬币细节模型表</h2><p id="9509" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">创建一个新文件<code class="fe ok ol om on b">/components/Index/CoinDetailsModalTable.js</code>。如上所述，该组件以模态显示表格，其中包含所选硬币的详细数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><code class="fe ok ol om on b">/components/Index/CoinDetailsModalTable.js</code></figcaption></figure><h2 id="2424" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">主页</h2><p id="dabb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">转到主页，创建一个新文件<code class="fe ok ol om on b">/pages/index.js</code>。在页面加载时，我们将获取排名前30位的加密货币的列表，并将它们传递到我们在前面几节中构建的CoinsTable组件中。</p><p id="16af" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">由于硬币数据不断变化，我已经将<code class="fe ok ol om on b">fetchPolicy</code>设置为<code class="fe ok ol om on b">network-only</code>，所以我们不会缓存任何结果。我还设置了5000毫秒的轮询间隔，即5秒。你可以随意改变这个时间间隔！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">/pages/index.js</figcaption></figure><h2 id="6847" class="os kx iq bd ky ox oy dn lc oz pa dp lg lx pb pc li mb pd pe lk mf pf pg lm ph bi translated">测试我们的应用</h2><p id="6639" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在让我们运行并测试我们的应用程序！打开您的终端并导航到项目的根目录，然后运行<code class="fe ok ol om on b">npm run dev</code>。一旦应用程序编译完毕，在浏览器中打开<a class="ae kv" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>。如果一切正常，您应该会看到类似下面的截图！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/fced6639cd2ec882f680955676432f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G8WFGIDemYc_bNLF2Qan2g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Home Page — Displays the top 30 cryptocurrencies</figcaption></figure><p id="6a9f" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">现在选择一枚硬币，并检查模态！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/57e756bb298fea936af28cad661386e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1o_dwjOGAMzcitLHzlp_IQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Coin Details Modal for XRP</figcaption></figure><p id="826d" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">最后，选择不同的时间间隔，并验证数据是否反映了这种变化。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/9dcd80d4776d4eb9dbd9e4351e6ce209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*coEkn8hj2325fnbaRCMJjQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Selected 30 D for XRP</figcaption></figure><p id="d7b1" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">就这样结束了！</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="fbf6" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">摘要</h1><p id="c559" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们回顾一下。我们首先关注用Apollo GraphQL服务器设置我们的后端。然后，我们将重点转移到前端，在那里我们连接了Apollo客户端并构建了我们的组件和页面。多亏了Next.js，这一切只需要一点点配置就能实现。如果你有兴趣将这个项目展示给全世界，可以看看我的文章“<a class="ae kv" href="https://medium.com/javascript-in-plain-english/how-to-deploy-a-next-js-app-to-heroku-d33bd86c2a2b" rel="noopener">如何将Next.js应用程序部署到Heroku </a>”。</p><div class="ns nt gp gr nu nv"><a href="https://medium.com/javascript-in-plain-english/how-to-deploy-a-next-js-app-to-heroku-d33bd86c2a2b" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd ir gy z fp oa fr fs ob fu fw ip bi translated">如何将Next.js应用程序部署到Heroku</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在几分钟内将带有Apollo GraphQL API的Next.js应用程序快速部署到Heroku</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">medium.com</p></div></div><div class="oe l"><div class="pn l og oh oi oe oj kp nv"/></div></div></a></div><p id="8aa1" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">我希望你喜欢这篇文章，它或者有趣或者对你有帮助。给我所有的密码朋友..继续拥抱我的朋友！2020快乐！🚀</p><p id="6105" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx np lz ma mb nq md me mf nr mh mi mj ij bi translated">我在业余时间写这些文章是为了娱乐。如果你喜欢这篇文章，请在下面留下你的喜欢和评论！可以关注我上 <a class="ae kv" href="https://medium.com/@this.kevinluu" rel="noopener"> <em class="mk">中</em> </a> <em class="mk">和</em> <a class="ae kv" href="https://twitter.com/kluu_10" rel="noopener ugc nofollow" target="_blank"> <em class="mk">推特</em> </a> <em class="mk">。感谢支持！</em></p></div></div>    
</body>
</html>