<html>
<head>
<title>Address Geocoding with Google Geocoding API, VueJs, and Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google地理编码API、VueJs和Firebase进行地址地理编码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/address-geocoding-with-google-geocoding-api-vuejs-and-firebase-694c0922df52?source=collection_archive---------2-----------------------#2020-08-17">https://javascript.plainenglish.io/address-geocoding-with-google-geocoding-api-vuejs-and-firebase-694c0922df52?source=collection_archive---------2-----------------------#2020-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c25f1616b2bb75ffa9b8c4e6ce656075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggOhemR-JIQPCSA83i1eHA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://www.pexels.com/@aksonsat-uanthoeng-393797?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Aksonsat Uanthoeng</a> from <a class="ae kc" href="https://www.pexels.com/photo/close-up-photo-of-assorted-color-of-push-pins-on-map-1078850/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="f88e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在你作为专业开发人员的职业生涯中，很有可能会要求你对地址进行地理编码。在我最近的三份工作中，有两份是我亲自做的。事实上，在我的上一家公司，我被要求每天做一些基于位置的事情。</p><p id="5b25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不管是哪家公司，位置在许多软件、网络和移动应用中都扮演着重要角色。无论你是在某个地方登记，还是试图找到你的公司离用户最近的地方，了解一些基本情况都会有所帮助。因此，在本文中，我将向您展示如何使用Google Maps和地理编码API、VueJs和Firebase对地址进行地理编码，并将其显示在地图上。</p><h1 id="ac77" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Google地理编码API设置</h1><p id="0f87" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果你还没有谷歌账户(这些人真的存在吗？)创建一个并前往<a class="ae kc" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a>。</p><p id="9851" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您还没有想要使用的项目，您必须创建一个新项目。在左上角，您会看到一个项目下拉列表。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/c281ca71bdc7780984ba0eecd0e96378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*2TcOawrES2eBJe2QCgWvVg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Google Project</figcaption></figure><p id="9364" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你点击下拉菜单，将会显示一个模式，让你能够创建一个新的项目。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/0aad8b013434a5bf4dbf9f344d8eaea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bE_jNvSdyCP-TH8YvN4LkQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Google Developer Console Projects</figcaption></figure><p id="1049" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建项目后，在下拉列表中选择它，然后在左侧菜单中单击Library。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/3e6caf299f0d35f58eb551d50038cc7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*VjmTs8Ckd0CmmOqdmNXmNg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Google Developer Library</figcaption></figure><h2 id="0e2f" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">地理编码API</h2><p id="a7ab" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在搜索框中，搜索“地理编码”，找到地理编码API并单击它。然后你会被带到一个屏幕，在那里你可以启用它。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/e09590e114a711eee07d635706220e34.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Y0AdlhUoCXTD7sPPtvXmOA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Geocoding API</figcaption></figure><h2 id="0e41" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">映射JavaScript API</h2><p id="5d94" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">启用地理编码API后，搜索Google Maps JavaScript API。导航到API页面并启用它。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b87f0802678a93e626d9587873ff7c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*ogpJ3xL-buSNDkOZC2o00g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Google Maps JavaScript API</figcaption></figure><h2 id="42d4" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">资格证书</h2><p id="6aa7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要使用这些API，我们需要创建一个API键。要创建一个，请转到控制台的<a class="ae kc" href="https://console.developers.google.com/apis/credentials" rel="noopener ugc nofollow" target="_blank">凭证部分</a>。在那里，仔细检查您是否选择了正确的项目，然后单击CREATE CREDENTIALS。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/9797e58601be6daa9101eb4a7ed0fe93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G9g5kry-JvWmUnk-ynsbEQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Create Credentials</figcaption></figure><p id="47ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击按钮后，会出现一个下拉菜单。在下拉列表中选择API密钥。一旦创建了API密钥，就复制它以备后用。</p><h2 id="86b2" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">启用计费</h2><p id="bdb3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">您还必须启用计费来使用API。为此，导航到他们的<a class="ae kc" href="https://support.google.com/googleapi/answer/6158867?hl=en" rel="noopener ugc nofollow" target="_blank">指令</a>并按照步骤操作。不要担心费用，因为你每个月有200美元的信用额度。根据定价，你必须对40，000个请求进行地理编码，才能开始计算成本。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/f80dc51938529716589fbe3fd4119450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZuR-8CHA81nGU4vS2rSiA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Pricing</figcaption></figure><p id="3d55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你非常担心，那就制定一个预算，在达到要求后关闭服务。在一切关闭之前，我把我的测试账户设置为每月1美元。你可以在这里找到更多关于T8的信息。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><h1 id="96c3" class="lb lc iq bd ld le ni lg lh li nj lk ll lm nk lo lp lq nl ls lt lu nm lw lx ly bi translated">Firebase项目设置</h1><p id="e51c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们需要做的第一件事是在Firebase中建立一个项目。前往<a class="ae kc" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank">https://firebase.google.com/</a>创建一个账户，然后点击“前往控制台”。接下来，点击“添加项目”按钮，给它起你喜欢的名字。单击其他选项，选择默认值。</p><p id="2f28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，单击左侧菜单中的“数据库”。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/74315078fe411e99a9bdc922289dbc40.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/0*7arnumB8aYjbQHOx.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Firebase Database</figcaption></figure><h2 id="4f5e" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">Firestore</h2><p id="93a9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">然后，在屏幕顶部单击“创建数据库”。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/4c5914703715f1b6614d7a4919fec3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4MD8KjvuMU8FV0ct.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Firestore Database Creation</figcaption></figure><p id="e342" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，选择在测试模式下启动，并选择默认的服务器位置。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/9b40c81fb895488fc03467d3e765c7e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/0*CgBlXA6Ozgs6JfFG.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Firestore Test Mode</figcaption></figure><p id="e60d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="nq">警告</em> </strong> <em class="nq">:这将使你的数据库对任何人开放读写。如果您要在生产设置中使用它，请熟悉</em> <a class="ae kc" href="https://firebase.google.com/docs/firestore/security/get-started" rel="noopener ugc nofollow" target="_blank"> <em class="nq"> Firestore规则</em> </a> <em class="nq">并实现</em> <a class="ae kc" href="https://firebase.google.com/docs/auth" rel="noopener ugc nofollow" target="_blank"> <em class="nq">认证</em> </a> <em class="nq">。</em></p><h2 id="cfb4" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">Firebase CLI</h2><p id="4a9b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Firebase使得在我们的项目中安装样板函数变得非常简单。在我的上一篇文章中，我们注册了Firebase，并将配置添加到我们的项目中，但是对于功能，我们需要在我们的计算机上全局安装<a class="ae kc" href="https://firebase.google.com/docs/cli" rel="noopener ugc nofollow" target="_blank"> Firebase CLI </a>。为此，打开您的终端并运行以下命令:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="e30c" class="ml lc iq ns b gy nw nx l ny nz">npm install -g firebase-tools</span></pre><p id="3e50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们已经安装了它，我们需要将其同步到我们的帐户。在命令提示符下运行以下命令并登录:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="74ba" class="ml lc iq ns b gy nw nx l ny nz">firebase login</span></pre><h1 id="16b3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Vue项目设置</h1><p id="d084" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要创建我们的Vue项目，打开您的终端，cd到您想要的目录，并运行以下命令:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="ee0b" class="ml lc iq ns b gy nw nx l ny nz">npx @vue/cli create google-address-geocoding</span></pre><p id="2c05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，选择默认预设(默认(babel，eslint))。这将创建一个标准的Vue项目，我们将工作了。完成后，在<a class="ae kc" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS代码</a>中打开项目。</p><h2 id="3892" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">初始化Firebase</h2><p id="a005" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在VS代码中，打开一个新终端(Terminal =&gt; New Terminal)并运行以下命令:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="6a0d" class="ml lc iq ns b gy nw nx l ny nz">firebase init</span></pre><p id="1a79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">选择以下选项:</strong></p><ul class=""><li id="628d" class="oa ob iq kf b kg kh kk kl ko oc ks od kw oe la of og oh oi bi translated">你准备好继续了吗？(是/否)— <strong class="kf ir"> Y </strong></li><li id="1184" class="oa ob iq kf b kg oj kk ok ko ol ks om kw on la of og oh oi bi translated">您想为此文件夹设置哪些Firebase CLI功能？— <strong class="kf ir">功能</strong></li><li id="498f" class="oa ob iq kf b kg oj kk ok ko ol ks om kw on la of og oh oi bi translated">请选择一个选项:<strong class="kf ir">使用现有项目|选择我们之前设置的项目</strong></li><li id="a19f" class="oa ob iq kf b kg oj kk ok ko ol ks om kw on la of og oh oi bi translated">你想用什么语言写云函数？— JavaScript</li><li id="1bc5" class="oa ob iq kf b kg oj kk ok ko ol ks om kw on la of og oh oi bi translated">你想使用ESLint来捕捉可能的错误并加强风格吗？— <strong class="kf ir"> Y </strong></li><li id="c106" class="oa ob iq kf b kg oj kk ok ko ol ks om kw on la of og oh oi bi translated">您想现在安装与npm的依赖关系吗？— <strong class="kf ir"> Y </strong></li></ul><p id="5fbb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您会注意到我们的项目中有一个名为“functions”的新文件夹。在该文件夹中，有一个index.js文件。这是我们编写所有地理编码函数的地方。</p><h2 id="ab10" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">安装依赖项</h2><p id="5745" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">接下来，安装一些我们将用于我们的应用程序的包。在终端中运行以下命令:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="b83e" class="ml lc iq ns b gy nw nx l ny nz">npm install firebase vue2-google-maps axios bootstrap-vue</span></pre><h2 id="89ed" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">将Firebase添加到Vue</h2><p id="92c9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">现在我们可以用Firebase连接我们的Vue前端了。回到Firebase控制台，点击您的项目。在页面的中间，你会看到一个网络图标。点击那个。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/e4c6e3710be9626a967e61f75c59b852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H87Z2d4ncZuD0vaJ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Firebase Web Start</figcaption></figure><p id="e93a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给你的应用取一个昵称，然后点击下一步。然后你会看到一些代码。在<script>标签里面复制一切。&lt;/root&gt;</script></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi op"><img src="../Images/a1eb505f226f09199a3e21af8b960e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L2XkGyOJPb6UXKTF.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Firebase Config</figcaption></figure><p id="ad86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在回到您的Vue项目，打开src/main.js。在这个文件中，我们将添加Bootstrap Vue、Google Maps和Firebase。然后，我们将创建一个Firestore实例，并将其导出。您的main.js文件应该如下所示:</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="oq or l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">main.js</figcaption></figure><h2 id="7ace" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">地址表单和谷歌地图</h2><p id="423e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在src/App.vue中，我们将添加表单来输入地址。在该表单下，将有谷歌地图，我们将显示我们地理编码和保存的所有地址的地图引脚。</p><p id="0eb0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于表单，我将使用<a class="ae kc" href="https://bootstrap-vue.org/" rel="noopener ugc nofollow" target="_blank"> Bootstrap-Vue </a>。这个包给了我们所有包装在方便组件中的引导程序的样式(我强烈推荐你查看他们的<a class="ae kc" href="https://bootstrap-vue.org/docs" rel="noopener ugc nofollow" target="_blank">文档</a>)。</p><p id="facc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，删除App.vue中的boiler-plate hello world组件和徽标。然后，在export default标记中，添加一个数据属性来保存表单值和保存的位置。我们还将为表单提交添加一个占位符方法:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="065c" class="ml lc iq ns b gy nw nx l ny nz">data: () =&gt; ({<br/> savedLocations: []<br/> formData: {<br/>  street: '',<br/>  city: '',<br/>  state: '',<br/>  zip: ''<br/> } <br/>}),<br/>methods: {<br/> async handleFormSubmit() {}<br/>}</span></pre><p id="1764" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在模板标签中，让我们添加表单和google maps:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="1902" class="ml lc iq ns b gy nw nx l ny nz">&lt;template&gt;<br/> &lt;div id="app" class="container mt-5"&gt;<br/>  &lt;b-form @submit.prevent="handleFormSubmit"&gt;<br/>   &lt;b-row&gt;<br/>    &lt;b-col md="6"&gt;<br/>     &lt;b-form-group label="Street"&gt;<br/>      &lt;b-form-input v-model="street"&gt;&lt;/b-form-input&gt;<br/>     &lt;/b-form-group&gt;<br/>    &lt;/b-col&gt;<br/>   &lt;/b-row&gt;<br/>   &lt;b-row&gt;<br/>    &lt;b-col md="3"&gt;<br/>     &lt;b-form-group label="City"&gt;<br/>      &lt;b-form-input v-model="city"&gt;&lt;/b-form-input&gt;<br/>     &lt;/b-form-group&gt;<br/>    &lt;/b-col&gt;<br/>    &lt;b-col md="3"&gt;<br/>     &lt;b-form-group label="State"&gt;<br/>      &lt;b-form-input v-model="state"&gt;&lt;/b-form-input&gt;<br/>     &lt;/b-form-group&gt;<br/>    &lt;/b-col&gt;<br/>    &lt;b-col md="3"&gt;<br/>     &lt;b-form-group label="Zip"&gt;<br/>      &lt;b-form-input v-model="zip"&gt;&lt;/b-form-input&gt;<br/>     &lt;/b-form-group&gt;<br/>    &lt;/b-col&gt;<br/>   &lt;/b-row&gt;<br/>   &lt;b-button type="submit" variant="primary"&gt;Submit&lt;/b-button&gt;<br/>  &lt;/b-form&gt;</span><span id="6fa0" class="ml lc iq ns b gy os nx l ny nz">&lt;GmapMap<br/>   :center="{lat:39, lng:-95}"<br/>   :zoom="4"<br/>   map-type-id="roadmap"<br/>   style="width: 100%; height: 500px; margin-top:60px;"<br/>  &gt;<br/>   &lt;div v-if="savedLocations.length &gt; 0"&gt;<br/>    &lt;GmapMarker<br/>    :key="index"<br/>    v-for="(l, index) in savedLocations"<br/>    :position="{lat:l.geoPoint.latitude, lng:l.geoPoint.longitude}"<br/>    /&gt;<br/>   &lt;/div&gt;<br/> &lt;/GmapMap&gt;<br/> &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><h1 id="8a88" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">燃烧基函数</h1><p id="a17d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">现在我们已经准备好了Vue应用程序，我们可以开始编写Firebase函数，该函数将对地址进行地理编码，并将其保存在我们的<a class="ae kc" href="https://firebase.google.com/products/firestore" rel="noopener ugc nofollow" target="_blank"> Firestore数据库</a>中。但是，在开始之前，我们需要在functions文件夹中安装一些包。</p><p id="049c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在VS代码中打开终端，将cd放入functions文件夹。然后运行以下命令:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="b9bc" class="ml lc iq ns b gy nw nx l ny nz">npm i axios cors</span></pre><p id="6f8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，导航到functions/index.js文件，并将其添加到functions import下:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="1af5" class="ml lc iq ns b gy nw nx l ny nz">const admin = require('firebase-admin');<br/>admin.initializeApp();</span><span id="13d8" class="ml lc iq ns b gy os nx l ny nz">const Firestore = admin.firestore;<br/>const db = Firestore();</span><span id="66a1" class="ml lc iq ns b gy os nx l ny nz">const axios = require("axios");<br/>const cors = require("cors")({<br/> origin: true<br/>});</span><span id="91d5" class="ml lc iq ns b gy os nx l ny nz">const googleMapsApiKey = "YOUR_GOOGLE_API_KEY";</span></pre><p id="ec38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以开始编码了。在该文件中，您将看到一个helloWorld函数示例。取消对它的注释，将名称更改为geocodeAddressAndSave，然后清理它。</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="67c5" class="ml lc iq ns b gy nw nx l ny nz">exports.geocodeAddressAndSave = functions.https.onRequest((request, response) =&gt; {<br/> response.send();<br/>});</span></pre><p id="dd5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们查看<a class="ae kc" href="https://developers.google.com/maps/documentation/geocoding/start" rel="noopener ugc nofollow" target="_blank"> Google Maps API文档</a>，我们会发现我们需要请求这个URL端点对一个地址进行地理编码:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/5614701b3c078705d1352be3c0432a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cuE4nHFz-wtdwITOSxegSA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Google Request URL</figcaption></figure><p id="2a1a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要将两个主要部分传递给这个URL请求。第一个是<strong class="kf ir">地址</strong>，第二个是你的<strong class="kf ir"> API密匙</strong>。对于地址，我们将在Firebase函数请求的主体中传递它。API键被硬编码在index.js文件的顶部。</p><p id="f86b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们得到一个有效的响应，我们解析它并提取出我们需要的部分。如果你对传回的所有数据感兴趣，请查看<a class="ae kc" href="https://developers.google.com/maps/documentation/geocoding/overview#geocoding" rel="noopener ugc nofollow" target="_blank">文档</a>。一旦我们有了我们需要的东西，我们将把它保存在Firestore中，并将数据返回到我们的Vue应用程序。为了优雅地处理错误，我们将把一切都包装在一个try/catch中。</p><p id="d6ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，index.js文件应该是这样的:</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="oq or l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">index.js — Firebase Function</figcaption></figure><h2 id="da0e" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">部署</h2><p id="8303" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要部署Firebase功能，请打开终端并运行以下命令:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="cd9e" class="ml lc iq ns b gy nw nx l ny nz">firebase deploy --only function</span></pre><p id="32d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">部署完成后，转到Firebase控制台，单击左侧菜单中的functions，并将URL复制到该函数下。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ou"><img src="../Images/7e32598e680292b46701301e2cc3c966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJmIR-TSMbD64goeN21EPA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Firebase Function URL</figcaption></figure><h1 id="14d7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">从Vue调用Firebase函数</h1><p id="528b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">现在我们已经准备好了Firebase函数，我们可以从我们的Vue项目中调用它。在我们之前创建的占位符表单提交方法中，我们可以发出一个axios请求，并从表单中传递地址。因此，导航到App.vue并将axios添加到脚本标记的顶部:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="8f9b" class="ml lc iq ns b gy nw nx l ny nz">import axios from 'axios';</span></pre><p id="3607" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的handleFormSubmit方法中添加以下代码，去掉脚本标记(必须将这些标记用于格式化):</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="oq or l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">handleFormSubmit</figcaption></figure><h2 id="e159" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">页面加载的位置</h2><p id="b748" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们需要做的最后一件事是在页面加载时加载我们的pin。为此，我们将从main.js中获取Firestore的实例。在App.vue中的脚本标记的顶部添加以下内容:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="ef99" class="ml lc iq ns b gy nw nx l ny nz">import { db } from "./main";</span></pre><p id="4ef1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们将使用一个名为beforeMount的Vue生命周期挂钩来加载保存的位置。在导出默认值中添加以下内容:</p><pre class="mf mg mh mi gt nr ns nt nu aw nv bi"><span id="2c93" class="ml lc iq ns b gy nw nx l ny nz">async beforeMount() {<br/> const snap = await db.collection("locations").get();</span><span id="62f6" class="ml lc iq ns b gy os nx l ny nz">snap.docs.forEach((doc) =&gt; {<br/>  this.savedLocations.push(doc.data());<br/> });<br/>}</span></pre><p id="8562" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加完所有内容后，您的App.vue文件应该如下所示:</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="oq or l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">App.vue Final</figcaption></figure><h1 id="da04" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="e7b7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这就是全部了。现在，您拥有了一个对您传递给它的任何有效地址进行地理编码的函数，以及一个显示过去地理编码地址结果的前端。总而言之，这可能比你想象的要容易。一如既往，让我知道你对这个项目的看法。下次再见，祝编码愉快！</p><p id="a940" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">bit bucket Repo:<a class="ae kc" href="https://bitbucket.org/TheDiligentDev/google-address-geocoding/src/master/" rel="noopener ugc nofollow" target="_blank">https://bit bucket . org/the diligent dev/Google-address-geocoding/src/master/</a></p><h2 id="5fb5" class="ml lc iq bd ld mm mn dn lh mo mp dp ll ko mq mr lp ks ms mt lt kw mu mv lx mw bi translated">如果您喜欢通过观看来学习，本文还有一个视频版本:</h2><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="ov or l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Address Geocoding Video Tutorial</figcaption></figure></div></div>    
</body>
</html>