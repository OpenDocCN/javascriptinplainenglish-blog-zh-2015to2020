<html>
<head>
<title>React Functions, GSAP Timelines and hooks. Oh my!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应函数，GSAP时间线和挂钩。我的天啊。</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-functions-gsap-timelines-and-hooks-oh-my-ec7620b6bdc6?source=collection_archive---------3-----------------------#2020-05-20">https://javascript.plainenglish.io/react-functions-gsap-timelines-and-hooks-oh-my-ec7620b6bdc6?source=collection_archive---------3-----------------------#2020-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e70c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对一个老故事的经典复述</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cade6f5cb4c5077e3bfd9631243f1d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nub4ZaHSwvkKc0cTnU8k4A.jpeg"/></div></div></figure><p id="e794" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我喜欢反应钩。代码更干净了，开发人员也更开心了，但是在很长一段时间里，我实际上无法让GSAP时间线与它们一起工作，所以我默认使用“动画组件”，因为我喜欢称它们为替我做脏活。基本上，我做了一个基于类的组件，只包含我正在制作的东西，但是通过阅读文档的能力和一点批判性思维，我偶然发现了一些革命性的东西(就我而言)。</p><h1 id="b085" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">钩子的简要说明</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/48a42f68528fc8e2c753d247b274b877.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*bguw1ec3NINLeasEa7N8fw.jpeg"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Hook (1991)</figcaption></figure><p id="62af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">钩子是操纵数据的一种方式，就像基于类的组件让你操纵数据一样。有几个你已经知道了，像useState(它取代了setState)，useEffect(它基本上是一个生命周期中所有的方法)和useMemo (memoize一个只有在某些事情改变时才应该改变的值)。</p><p id="a97f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">很简单，对吧？不对。这些是由外星人编写的复杂函数，作为前端开发人员执行我们的命令。现在你在问自己:“Alek，这些废话是什么，这些填充文本将如何使我成为一名更好的程序员？”。我正要说呢，别担心。</p><h1 id="f442" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">先决条件</h1><p id="df02" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">要继续，你需要知道几件事。如果传递一个空的依赖数组，useEffect钩子基本上就像componentDidMount一样。如果数组有值，它是componentDidUpdate。或者你可以同时做这两件事，没关系，它处理道具/状态的变化。UseRef创建对DOM元素的引用。UseState是非常简单明了的，它允许你在功能组件中使用状态。</p><h1 id="2ef6" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">GSAP和时间表</h1><p id="6f85" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">除非你生活在岩石下，否则你会在网上用GSAP制作动画。它有一个伟大而简单的API和动画，但在一个功能组件中使用它可能会很棘手。为什么？因为没有常数。每次函数重新渲染时，值都会被重置，这将使所有动画无效，并将它们重置回原点。</p><p id="b2a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们试着编写一些永远不会成功的代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/0c43420243d2b97143f7657928465763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WM4CwS2M5e_u1f4OP268bQ.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">the code</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/80f7269cbfbee78ede5c6bcea3f60782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGQpn72WiZuucaWGCWGhVw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">the result (literally that’s it, nothing else works)</figcaption></figure><p id="0f63" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那么，为什么什么都没发生呢？理论上这应该行得通，但事实并非如此。常量实际上不是常量，每当组件重新呈现时，它们都会被重新初始化。当它或它的父级的状态改变时，就会发生这种情况。这就是React，我们对此又爱又恨。我们如何解决这个问题？好吧，我们需要在记忆中保留最初的GSAP时间线，这样才能工作。每当组件重新呈现时，时间线应该保持其原始值。</p><h1 id="431a" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">解决方案</h1><p id="d892" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">幸运的是，这非常简单。我们有一个钩子可以做到这一点。这是经常被忽视的使用备忘录挂钩。useMemo挂钩返回一个计算值，该值仅在依赖数组中的内容发生变化时才发生变化。如果你在依赖数组中什么都不传入，它基本上创建了一个类的静态属性——它永远不会改变！所以我们需要做的是设置时间线，使用GSAP时间线的记忆值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/dda88ccdcd873a611aa5a206be014b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVb0W5KfEW-vPjA_0uqCyA.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">It’s that simple.</figcaption></figure><p id="a776" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是怎么回事，为什么会起作用？因为我们使用了useMemo钩子并传入了一个空的依赖数组，所以时间轴值在组件的整个生命周期中保持不变。它永远不会改变，因为依赖数组没有任何东西可以迫使它改变。如果我们没有用useMemo钩子传递它，它将在每次组件重新呈现时用一个空的时间线重新初始化。</p><h1 id="7b05" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">结果呢</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="32cf" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">社交——跟踪我</h1><p id="4c7c" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">我是一名全栈开发者。我举重(不是现在，因为整个COVID的事情)。我看动漫。我写JavaScript，我没有斯德哥尔摩综合症。</p><p id="3d1e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">🔗<a class="ae mu" href="https://alekangelov.com" rel="noopener ugc nofollow" target="_blank">网站</a></p><p id="a9ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">🔒<a class="ae mu" href="https://www.linkedin.com/in/alekangelov/" rel="noopener ugc nofollow" target="_blank">领英</a></p><p id="e9f6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">🦜 <a class="ae mu" href="https://twitter.com/39strife" rel="noopener ugc nofollow" target="_blank">推特</a></p></div></div>    
</body>
</html>