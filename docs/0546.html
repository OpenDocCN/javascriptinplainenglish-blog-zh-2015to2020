<html>
<head>
<title>A Practical Use Case for JavaScript’s Object.assign()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript的Object.assign()的一个实际用例</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-practical-use-case-for-javascripts-object-assign-3c37e2e42d42?source=collection_archive---------4-----------------------#2019-11-06">https://javascript.plainenglish.io/a-practical-use-case-for-javascripts-object-assign-3c37e2e42d42?source=collection_archive---------4-----------------------#2019-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d285" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将数据库记录集对象分配给JavaScript类对象</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/91905677945f04a0286bf627823e9b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LvFSLMeSFEFDrlirgoLaOQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by Louis Hansel on <a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="8256" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">用例</h2><p id="531f" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" rel="noopener ugc nofollow" target="_blank"> Object.assign() </a>有很多。但是，在基本级别上，它将一个对象的属性分配给另一个对象。</p><p id="c523" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">语法是，</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="54ca" class="kw kx iq mr b gy mv mw l mx my">Object.assign(target, ...sources)</span></pre><p id="6e41" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我将向您介绍Object.assign()以及如何使用它来帮助用数据填充JavaScript类。特别是从数据库查询返回的数据。</p><p id="cca4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在上一篇文章中，我讨论了用node.js 查询SQL Server数据库的<a class="ae kv" href="https://link.medium.com/5tVIHlNvyZ" rel="noopener">。我将使用那篇文章的组件来演示如何使用Object.assign()。</a></p><h2 id="b4f4" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">对象.分配基础</h2><p id="6c8b" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">如上所示，语法是，</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="5167" class="kw kx iq mr b gy mv mw l mx my">Object.assign(target, ...sources)</span></pre><ul class=""><li id="ea29" class="mz na iq lu b lv ml ly mm lf nb lj nc ln nd mk ne nf ng nh bi translated"><strong class="lu ir">目标</strong> —这是您想要分配的对象。在我们的例子中是一个类对象的实例。</li><li id="2aad" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated"><strong class="lu ir">来源</strong> —这些是数据将来自的来源。在我们的案例中，只有一个来源。一个数据库记录(集)。</li></ul><p id="2462" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">如<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" rel="noopener ugc nofollow" target="_blank"> MDN上关于Object.assign </a>所述，</p><blockquote class="nn no np"><p id="8d90" class="ls lt nq lu b lv ml jr lx ly mm ju ma nr mn mc md ns mo mf mg nt mp mi mj mk ij bi translated">如果目标对象中的属性具有相同的键，它们将被源对象中的属性覆盖。较新的源的属性同样会覆盖较早的属性。</p><p id="f588" class="ls lt nq lu b lv ml jr lx ly mm ju ma nr mn mc md ns mo mf mg nt mp mi mj mk ij bi translated"><code class="fe nu nv nw mr b">Object.assign()</code>方法只将<em class="iq">可枚举的</em>和<em class="iq">拥有的</em>属性从源对象复制到目标对象。它在源上使用<code class="fe nu nv nw mr b">[[Get]]</code>,在目标上使用<code class="fe nu nv nw mr b">[[Set]]</code>,因此它将调用getters和setters。因此，它<em class="iq">分配</em>属性，而不仅仅是复制或定义新属性。</p></blockquote><p id="eba4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">最后一段对我们来说非常重要。</p><blockquote class="nx"><p id="44a2" class="ny nz iq bd oa ob oc od oe of og mk dk translated">它将调用getters和setters</p></blockquote><p id="f751" class="pw-post-body-paragraph ls lt iq lu b lv oh jr lx ly oi ju ma lf oj mc md lj ok mf mg ln ol mi mj mk ij bi translated">正如我稍后将重申的，我们的类拥有存储数据所需的<a class="ae kv" href="https://link.medium.com/5tVIHlNvyZ" rel="noopener">属性</a>以及存储数据所需的<strong class="lu ir"> <em class="nq"> set() </em> </strong>方法是非常重要的。</p><p id="9f23" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">虽然您可以在MDN上查看Object.assign()的例子，但是我想展示第一个例子，也是最基本的一个例子，因为它实际上适用于我们想要实现的目标。</p><p id="86ab" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">MDN上的示例</strong></p><p id="6eea" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">const target = { a: 1，b:2 }；<br/>常量源= { b: 4，c:5 }；<br/>const returned target = object . assign(target，source)；<br/> console.log(目标)；<br/> //预期输出:Object { a: 1，b: 4，c:5 }<br/>console . log(returned target)；<br/> //预期输出:对象{ a: 1，b: 4，c: 5 }</p><p id="c598" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在他们的例子中，他们将一个对象(源)分配给目标对象。最终结果是它们有相同的数据。</p><p id="afc8" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">为什么这个简单的例子对我们有用？我将在本文的下一节中更详细地介绍，但在基本层面上，我们的数据库数据将如下所示。</p><p id="a2d4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">{EmpId: "000001 "，名字: " Bob "，姓氏:" Jones "，头衔:"律师" }</p><blockquote class="nn no np"><p id="5d7d" class="ls lt nq lu b lv ml jr lx ly mm ju ma nr mn mc md ns mo mf mg nt mp mi mj mk ij bi translated">为定义明确的类对象赋值的完美结构。</p></blockquote><p id="5029" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">换句话说，如果我们有一个能够存储EmpId、FirstName、LastName和Title的JavaScript类，我们就可以从数据库对象和<strong class="lu ir"> <em class="nq">返回数据，并将其放入我们自己的数据结构中。</em> </strong></p><h2 id="5186" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">从数据库返回的记录(集)的结构</h2><p id="174f" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">让我们看看node.js中数据库查询返回的数据是什么样子的。</p><p id="7b14" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">此图像包含代码片段和控制台输出。点击<a class="ae kv" href="https://link.medium.com/5tVIHlNvyZ" rel="noopener">此处</a>查看<a class="ae kv" href="https://link.medium.com/5tVIHlNvyZ" rel="noopener">查询SQL Server数据库</a>的完整代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/8744b4ab24954f222da651c529af5faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JrjeVdEJFNpPrkzcRkAFcw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">console.log(data)</figcaption></figure><p id="e85e" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">注意第60行，<strong class="lu ir"> sqlRequest.query() </strong>，这是我们从数据库请求数据的地方。</p><p id="78da" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">现在，关注控制台输出。当使用console.log( <strong class="lu ir"> data </strong>)时，我们看到从数据库返回的数据是一个格式良好的对象数组，四个记录中的每一个都有一个。</p><p id="d378" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><em class="nq">遗憾的是，在我们对其采取措施之前，这些数据都保存在控制台中。</em></p><p id="4a11" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">如果我们查看第一条记录，<strong class="lu ir"> data.recordset[0] </strong>，我们会看到，</p><p id="9511" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">{EmpId: "000001 "，名字: " Fred "，姓氏:" Jones "，头衔:"律师" }</p><h2 id="552a" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">JavaScript类</h2><p id="da8d" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">所以现在我们只需要一个定义良好的JavaScript类来放置记录集数据。</p><p id="bf61" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">记住一个<em class="nq">类只是一个蓝图</em>，它是创建一个对象的类的实例，我们可以在这个对象中放置数据。</p><p id="9c39" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">JavaScript类应该用属性和必要的<strong class="lu ir"> <em class="nq"> set() </em> </strong>方法很好地定义，以便将从数据库返回的数据存储到这些类属性中。在这里找到了<a class="ae kv" href="https://link.medium.com/5tVIHlNvyZ" rel="noopener">的类结构类型。</a></p><blockquote class="nn no np"><p id="c49e" class="ls lt nq lu b lv ml jr lx ly mm ju ma nr mn mc md ns mo mf mg nt mp mi mj mk ij bi translated">回想一下前面的语句，<strong class="lu ir"> Object.assign() </strong>将使用目标的<strong class="lu ir"> set() </strong>方法将数据放入<strong class="lu ir">目标</strong>对象的属性中。</p></blockquote><p id="865d" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们的类至少应该如下所示(我确实包含了一个类方法showEmployeeInfo()，这样我们就可以在使用Object.assign()后验证数据是否确实存储在类对象中。_</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/b283edf47e7ed641eaee28e7d0ef2f47.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*nmaqrRRl-wvZBZrLNR89ug.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Notice the setters. Object.assign will use these.</figcaption></figure><p id="44ff" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们的Employee类具有存储EmpId、FirstName、LastName和Title所需的属性，以及Object.assign()将数据放入属性所需的set()方法。</p><h2 id="8dde" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">使用Object.assign</h2><p id="aa99" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在我们的演示中，为了只关注Object.assign()，我们将代码限制为只存储一个记录(集合)。当然，一个循环可以用来创建不止一个类对象(Employee ),还可能创建一个数组来存储我们所有的雇员。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/527f39bbf55530609f07447500c2a9ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJS5771KJFhUBY3wMGT11Q.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Notice the last two lines</figcaption></figure><p id="787a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">注意第92–95行以及控制台输出。</p><ul class=""><li id="1cbf" class="mz na iq lu b lv ml ly mm lf nb lj nc ln nd mk ne nf ng nh bi translated">我们在第92行创建了一个空的Employee对象emp。</li><li id="3dc4" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">为了比较，我们显示了原始对象数据data.recordset[0]，第93行。</li><li id="bbb9" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated"><strong class="lu ir">使用Object.assign()将原始数据分配给Employee对象，第94行。</strong></li><li id="f4be" class="mz na iq lu b lv ni ly nj lf nk lj nl ln nm mk ne nf ng nh bi translated">调用类方法来验证原始数据在雇员对象中，第95行。</li></ul><p id="c091" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">维奥拉。</p><h1 id="4364" class="op kx iq bd ky oq or os lb ot ou ov le jw ow jx li jz ox ka lm kc oy kd lq oz bi translated">结论</h1><p id="05cc" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">相当酷。我们现在有了一种将格式良好的(数据库或非数据库)对象分配给类对象的方法。有了我们自己的数据结构中的数据，我们可以根据需要操纵它，也可以利用我们决定包含的任何类方法。</p><p id="e1e4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">感谢您的阅读和快乐编码！</p></div></div>    
</body>
</html>