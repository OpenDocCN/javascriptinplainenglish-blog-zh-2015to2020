<html>
<head>
<title>Building a PWA was our best idea ever</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建造公共工程部是我们有史以来最好的主意</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-a-pwa-was-our-best-idea-ever-b7b233726b41?source=collection_archive---------0-----------------------#2020-07-27">https://javascript.plainenglish.io/building-a-pwa-was-our-best-idea-ever-b7b233726b41?source=collection_archive---------0-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3f8f751cb5e71012f469d08bf0b0d017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2pYVCiBB41A9ymLXMJFxQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">The Coronavirus App has been helping the world track the spread of COVID-19 since January 28</figcaption></figure><p id="1030" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">今年早些时候，我们建立了第一个新冠肺炎PWA，谦虚地命名为“<a class="ae la" href="https://coronavirus.app" rel="noopener ugc nofollow" target="_blank">冠状病毒应用</a>”(如果你无法访问这个链接，请查看<a class="ae la" href="https://www.notion.so/Why-can-t-I-access-coronavirus-app-859a165044e4474d8191a5ab1dd23c7f" rel="noopener ugc nofollow" target="_blank">这个</a>)。渐进式网络应用程序(或PWA)很棒。它们提供了两个世界的最佳之处:它们看起来和感觉上都像本地应用，但在引擎盖下，它们实际上是网站——用标准的HTML、CSS和Javascript构建。</p><p id="3184" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这个动荡的时代，冠状病毒应用程序是一个PWA的事实不仅有所帮助——这可能是它成功的主要原因之一。</p><h2 id="d7bb" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">重新控制你自己的应用程序</h2><p id="89cc" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">我们能够很快推出我们的PWA。我们在1月25日提出了这个应用的想法。然后在1月28日推出。从创意到发布只需3天，这种转变是本机应用根本无法实现的。发布Android或iOS应用程序需要将其上传到各自的应用程序商店。仅仅是最初的审查过程——苹果/谷歌检查你的应用程序不包含欺诈——通常需要更长的时间。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">ABC News had a segment about the Coronavirus App on February 3rd.</figcaption></figure><p id="83b8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">能够快速发布意味着我们最大化了获得媒体报道的变化。事实上，我们得到了<a class="ae la" href="https://www.businessinsider.com/wuhan-coronavirus-app-where-is-how-dangerous-number-infections-2020-1" rel="noopener ugc nofollow" target="_blank">商业内幕</a>、<a class="ae la" href="https://www.forbes.com/sites/johnkoetsier/2020/02/05/ai-predicts-coronavirus-could-infect-25b-and-kill-53m-doctors-say-thats-not-credible-and-heres-why/#366d095511cd" rel="noopener ugc nofollow" target="_blank">、福布斯</a>、美国广播公司新闻以及更多媒体的惊人报道。</p><p id="50bf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当你访问域名<a class="ae la" href="https://coronavirus.app" rel="noopener ugc nofollow" target="_blank"> coronavirus.app </a>时，你现在看到的应用程序看起来也与我们推出时有着根本的不同。在发布后的7个月里，我们进行了数百次小的更新和至少3次完整的设计修改。我们能够根据用户的反馈快速迭代。部署新版本的应用程序很快——使用我们正在使用的<a class="ae la" href="https://github.com/firebase/firebase-tools" rel="noopener ugc nofollow" target="_blank"> Firebase CLI工具</a>不到2分钟。而且也不需要app stores的批准。我们部署应用程序，更改版本号以确保我们用户的浏览器自动获得所有文件的最新版本，然后我们就完成了。</p><p id="3661" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">发布几个月后，谷歌和苹果<a class="ae la" href="https://www.forbes.com/sites/thomasbrewster/2020/03/24/google-bans-coronavirus-apps-but-after-400000-downloads/#238191ee34c0" rel="noopener ugc nofollow" target="_blank">都宣布禁止未经国家政府或医疗机构批准的冠状病毒相关应用</a>进入各自的应用商店。我们非常幸运。如果我们选择在商店上推出这款应用，几个月后它就会被撤下。</p><p id="6d7f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用PWAs，它是您的域、您的客户端代码和您的服务器。你能控制一切。</p><h2 id="5b1f" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">你可以保留100%</h2><p id="05e4" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">如果你使用应用内购买，你必须向苹果和/或谷歌支付30%的收入。如果你不想使用应用内购买，那么……你根本不能在你的应用中向用户收费(至少理论上是这样)。</p><p id="2f15" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">应用商店的承诺是成为分销渠道。十年前，你可以发布一个应用程序，仅此一项就能为你带来新用户。这真是太棒了。</p><p id="d375" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这在2020年还有意义吗？Google Play 上大约有<a class="ae la" href="https://www.statista.com/statistics/266210/number-of-available-applications-in-the-google-play-store/" rel="noopener ugc nofollow" target="_blank">300万个应用。尝试上传一个应用程序，然后不做任何其他事情。你有可能总共获得两次下载:你和你的联合创始人。</a></p><p id="1485" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于开发者来说，应用商店似乎已经成为一种必要的邪恶，而不是一种有用的工具。他们没有做你期望他们做的事情——也就是说，做一个分销渠道——但他们仍然向你收取大笔费用。越来越多的公司<a class="ae la" href="https://venturebeat.com/2018/12/28/netflix-permanently-pulls-itunes-billing-for-new-users/" rel="noopener ugc nofollow" target="_blank">正在远离应用内购买</a>，但即便如此也不是没有一些障碍。</p><p id="6c17" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有了PWAs，就没有应用商店，也没有应用内购买。你可以实现任何你喜欢的支付系统(如果你还没有，试试<a class="ae la" href="https://stripe.com" rel="noopener ugc nofollow" target="_blank"> Stripe </a>)。你可以保留你辛辛苦苦挣来的所有美元。</p><h2 id="14da" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">更少的代码，更好的产品</h2><p id="db40" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">PWA最大的优点之一就是只需要维护一个代码库。当然，您可以使用<a class="ae la" href="https://reactnative.dev/" rel="noopener ugc nofollow" target="_blank"> React Native </a>，但是这看起来更像是一种变通方法，而不是真正的解决方案。</p><p id="9c17" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">将你的应用构建成PWA会使它更快更简单(除非你是那些讨厌Javascript的人之一，在这种情况下，太糟糕了，你不走运了！).</p><p id="fd93" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们的整个冠状病毒应用程序非常容易维护和更新，因为它本质上是3个文件:</p><ul class=""><li id="65d4" class="mf mg iq ke b kf kg kj kk kn mh kr mi kv mj kz mk ml mm mn bi translated">运行在<a class="ae la" href="https://firebase.google.com/docs/functions" rel="noopener ugc nofollow" target="_blank"> Firebase云函数</a>上的<em class="mo"> Server.js </em> (180Kb)，其中包含我们的<a class="ae la" href="https://coronavirus.app/api" rel="noopener ugc nofollow" target="_blank"> API </a>的所有代码，以及我们用来从政府网站收集数据的所有<a class="ae la" href="https://cloud.google.com/scheduler" rel="noopener ugc nofollow" target="_blank">预定函数</a>。它还包含我们的基本HTML模板，我们在其中添加了<a class="ae la" href="https://progressier.com" rel="noopener ugc nofollow" target="_blank"> Progressier脚本</a>，为应用程序提供了PWA的所有功能。</li><li id="0230" class="mf mg iq ke b kf mp kj mq kn mr kr ms kv mt kz mk ml mm mn bi translated"><em class="mo"> Client.js </em> (197Kb)，里面包含了你访问app时浏览器将执行的所有前端代码。</li><li id="9d47" class="mf mg iq ke b kf mp kj mq kn mr kr ms kv mt kz mk ml mm mn bi translated"><em class="mo"> Style.css </em> (125Kb)，包含所有的css。</li></ul><p id="1662" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">(此外，我们正在使用的仅有的三个第三方客户端库是用于地图的<a class="ae la" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank">传单</a>，用于图表的<a class="ae la" href="https://www.chartjs.org/" rel="noopener ugc nofollow" target="_blank"> Charts.js </a>，以及用于你可以用时间做的所有酷东西的<a class="ae la" href="https://momentjs.com/" rel="noopener ugc nofollow" target="_blank"> Moment.js </a>)。</p><p id="d738" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">PWAs感觉像是网络的自然进化——让开发者更快、更容易地快速构建大规模的东西。见鬼……这甚至让非开发人员也很容易做到。毕竟，冠状病毒应用程序<a class="ae la" href="https://www.linkedin.com/in/kevinbasset/" rel="noopener ugc nofollow" target="_blank">是由营销人员</a>开发的。</p><p id="dd7d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当脸书在2004年推出时，他们不得不购买/租用和维护服务器。现在我们有了AWS、GCP和Azure，所以我们不必关心底层基础设施中发生的任何事情。由于它也是这个星球上最大的科技公司的动力，你可以非常确定基础设施本身是一流的。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/59ac82833e9bc3696de8e82451873f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FfPDuZb_cM1rr1vC"/></div></div></figure><p id="bfde" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">3月23日是我们最美好的一天。仅在这24小时内，冠状病毒应用程序就获得了2，182，787个用户和4，822，155次页面浏览。这就是让这款应用屈服的原因。我们达到了谷歌云平台允许的GPU调用量的硬性限制，这导致了自发布以来我们仅有的2小时停机时间。幸运的是，Firebase support很快增加了我们的配额。这是一个罕见的事件。大多数应用程序不太可能达到这个极限。</p><p id="6320" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在我看来，Progressier在应用程序方面有着类似的使命:构建现代应用程序的底层基础设施——这些基础设施将直接存在于网络上，不受原生应用程序的限制——所以你不必关心幕后发生的事情。</p><h2 id="783e" class="lb lc iq bd ld le lf dn lg lh li dp lj kn lk ll lm kr ln lo lp kv lq lr ls lt bi translated">功能差距正在缩小</h2><p id="6449" class="pw-post-body-paragraph kc kd iq ke b kf lu kh ki kj lv kl km kn lw kp kq kr lx kt ku kv ly kx ky kz ij bi translated">然而，这并不完全是黑白分明的。PWAs也有缺点。你可以用一个本地应用做什么是有差距的。你可以用PWA。但这一差距正在逐年缩小。</p><p id="0309" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因为你的PWA是在你的用户浏览器中运行的，所以有一些烦人的事情需要注意。不同的浏览器对Javascript和CSS的理解略有不同。因此，对于我们开发的每一个功能，我们都必须在Chrome、Safari、Firefox、Edge以及Mac、PC、iPad、Android平板电脑、新款iPhone和旧款iPhone上进行测试。让某个特定的东西在任何地方都完美地工作是很棘手的，所以你求助于一些丑陋的手段。</p><p id="7c4c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有趣的是——因为我不是苹果用户，我曾经蹲在美丽的台北<a class="ae la" href="https://goo.gl/maps/MdCd8MsntRnGWDhj7" rel="noopener ugc nofollow" target="_blank">苹果旗舰店的地下室里。我会编码、部署，然后在商店里到处跑，在我能接触到的每一台苹果设备上测试我的改变。不过，那是在我发现这个叫做</a><a class="ae la" href="https://www.browserstack.com/" rel="noopener ugc nofollow" target="_blank">浏览器堆栈</a>的神奇产品之前。</p><figure class="lz ma mb mc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/32b35aa42b24f427fb73e2986d110701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCOBvpo5k4R6qMNtX5jLUA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Unsurprisingly, we rank #1 for “coronavirus app” on Google</figcaption></figure><p id="4326" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此外，如果你足够幸运地购买了一个看起来像冠状病毒一样纯粹的域名，你肯定会享受到随之而来的搜索引擎优化。pwa使应用程序更易访问。没有要下载的内容。没有强制安装。没有搜索可做。你输入网址，嘣，这就是应用程序。</p><p id="2faf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">优化在线转换的一个很好的步骤是减少流程结束所需的步骤。艾滋病人正是这样做的。获得应用程序的步骤越少，人们实际使用你的应用程序的几率就越大。</p><p id="82ee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">事实上，一些业务<a class="ae la" href="https://ymedialabs.com/progressive-web-apps" rel="noopener ugc nofollow" target="_blank">强调了PWA实施后各种关键绩效指标的显著改善</a>，如在页面、转化或收入上花费的时间增加。</p><p id="7af0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">PWAs的一个非常好的特性是人们可以在他们的手机(和桌面)上安装你的应用。).能够占据用户主屏幕的空间显然是非常有价值的——并且对保持用户有很大帮助。</p><p id="964e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">PWAs很棒。我不认为冠状病毒应用程序会被1000多万人使用，如果我们没有把它变成PWA的话。</p><p id="a228" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这也激发了Progressier的灵感，它将很快允许任何人在他们自己的网站和应用程序中免费使用我们的PWA实现。顺便说一下，我们改进后的PWA实现将比我们在冠状病毒应用程序上的实现好7到10倍。</p><p id="ec4d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对Progressier感到兴奋吗？关于冠状病毒App的问题？请在下面的评论中告诉我们。</p></div></div>    
</body>
</html>