<html>
<head>
<title>How to Build a Plugin for Docusaurus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为Docusaurus构建一个插件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-a-plugin-for-docusaurus-v2-dd54d627a94e?source=collection_archive---------14-----------------------#2020-10-12">https://javascript.plainenglish.io/how-to-build-a-plugin-for-docusaurus-v2-dd54d627a94e?source=collection_archive---------14-----------------------#2020-10-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="a424" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">从零到插件</h2><div class=""/><div class=""><h2 id="375f" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">关于如何为Docusaurus v2构建和发布自己的插件的简要指南</h2></div><p id="8466" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">在<a class="ae lh" href="https://claimr.tools/" rel="noopener ugc nofollow" target="_blank">声明</a>时，我们已经为我们的<a class="ae lh" href="https://developer.claimr.tools/" rel="noopener ugc nofollow" target="_blank">开发者和文档网站</a>使用<a class="ae lh" href="https://v2.docusaurus.io/" rel="noopener ugc nofollow" target="_blank"> Docusaurus v2 </a>有一段时间了。在使用了几个月后，我们可以自信地说，我们对自己的选择非常满意。</p><p id="66ae" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">Docusaurus附带电池，因此您可以立即获得大量价值，同时它足够灵活，如果您喜欢不同的东西，可以根据您的需求进行定制。此外，他们的文档是极好的，正如你所期望的，一个框架的存在归功于它创建文档网站的能力。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi li"><img src="../Images/e1c15ae30f075ce483f77afab6e51b03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jn2w4Z-8EVMDdWTMH4_CKQ.png"/></div></div></figure><h1 id="47d5" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">docu-什么？</h1><p id="db38" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">对于任何不熟悉Docusaurus的人来说，Docusaurus是一个由脸书创建的开源框架，用于为他们所有的开源工具制作文档网站。如果您一直在从事一些NodeJS项目，那么您可能已经使用了由Docusaurus 生成的<a class="ae lh" href="https://docusaurus.io/en/users" rel="noopener ugc nofollow" target="_blank">文档，仅举几个例子:</a><a class="ae lh" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>、<a class="ae lh" href="https://facebook.github.io/create-react-app/" rel="noopener ugc nofollow" target="_blank"> Create React App </a>和<a class="ae lh" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>。</p><p id="5d88" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">现在，脸书正在开发Docusaurus的下一代产品，名为Docusaurus v2。这使得它成为一个高性能的静态站点生成器，可以快速创建各种类型的网站。对文档的支持仍然是一等公民，但是现在您可以自由地使用它来创建您想要的任何东西。官方上它仍然处于alpha阶段，但是根据我们的经验，它已经非常稳定了，脸书鼓励新项目采用Docusaurus v2。</p><h1 id="c179" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">为什么我需要插件？</h1><p id="9ce9" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">插件存在于Docusaurus生态系统中的主要原因是可重用性。有很多代码都有一个通用的目的，通过插件，你可以在这些项目之间共享这些代码。Docusaurus使用插件将创建博客或文档页面的逻辑从核心Docusaurus中分离出来。插件也可以用来增加不直接面向用户的功能，例如，有官方插件可以优化图片，添加谷歌分析或创建网站地图。</p><p id="5e6e" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">官方插件非常有用，但是可能你的用例对它们不满意。在ClaimR的案例中，我们使用的是不同于Google Analytics的分析提供商。插件在这里非常有用，因为您可以使用它们在每个生成的页面中注入跟踪代码。</p><h1 id="bf9b" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">该过程</h1><p id="7d42" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">让我们先来看一下创建你自己的插件的过程，稍后我们将一步一步地来深入研究每一个插件。对于上下文，我们将遵循将GoatCounter分析添加到我们的文档中的过程，该文档现在位于<a class="ae lh" href="https://www.npmjs.com/package/docusaurus-plugin-goatcounter" rel="noopener ugc nofollow" target="_blank"> npm </a>的<strong class="kn ix">docusaurus-plugin-goat counter</strong>中。查看官方插件的<a class="ae lh" href="https://github.com/facebook/docusaurus/tree/master/packages" rel="noopener ugc nofollow" target="_blank">源代码</a>对于如何实现适合你的用例的插件很有帮助。我们使用“@ docusaurus/plugin-Google-analytics”作为我们的起点。</p><ol class=""><li id="0559" class="mr ms in kn b ko kp kr ks ku mt ky mu lc mv lg mw mx my mz bi translated"><strong class="kn ix">本地原型</strong> Docusaurus允许你在与当前项目相同的源代码中创建一个插件。这让你可以试验并很快得到结果。</li><li id="8f72" class="mr ms in kn b ko na kr nb ku nc ky nd lc ne lg mw mx my mz bi translated"><strong class="kn ix">将插件移动到单独的代码库</strong>引导一个新项目，Docusaurus插件的代码库将位于其中。</li><li id="4122" class="mr ms in kn b ko na kr nb ku nc ky nd lc ne lg mw mx my mz bi translated"><strong class="kn ix">发布你的插件</strong>最后，我们将把你的插件发布到NPM，这样你就可以把它包含在你所有的项目中了。</li></ol><h1 id="49b3" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">1.本地原型制作</h1><p id="2143" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">Docusaurus v2的文档<a class="ae lh" href="https://v2.docusaurus.io/docs/using-plugins#creating-plugins" rel="noopener ugc nofollow" target="_blank">简要介绍了如何创建插件。那些指令的目标是在你当前的项目中直接创建一个新的插件。我们发现这大大降低了进入门槛，并允许快速实验。如果你正在构建一个大的插件，那么你可能想跳过这一步，从一个单独的代码库开始构建，因为这也会给你类型提示，因为我们将添加TypeScript。</a></p><p id="8bde" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated"><a class="ae lh" href="https://github.com/ClaimR/developer-website/commit/28becd61873c3dc77566b5699e61b3289bbf38cd" rel="noopener ugc nofollow" target="_blank">这</a>是将GoatCounter分析的初始版本添加到我们的项目中的完整提交。这里我们将使用一个稍微简化的版本，这样我们可以专注于核心功能。对于不熟悉GoatCounter的人来说，我们需要插件将以下HTML添加到每个页面:</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7f04" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">首先创建<code class="fe nh ni nj nk b">plugins/goatcounter/index.js</code>并添加以下内容:</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="2544" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">现在，在<code class="fe nh ni nj nk b">docusaurus.config.js</code>中添加你的插件:</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="441a" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">重启Docusaurus，现在每个页面都应该将你的分析包含在HTML中了🎉。</p><h1 id="2a8a" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">2.创建独立插件</h1><p id="af07" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">将插件放在与Docusaurus网站相同的代码库中可能更容易进行原型开发。但是，它不允许重用这段逻辑。另外，你的Docusaurus网站可能没有使用TypeScript，我们可以将它添加到我们的插件项目中，为我们的插件提供类型提示。</p><p id="0323" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">为了引导我们的项目，我们将使用<a class="ae lh" href="https://tsdx.io/" rel="noopener ugc nofollow" target="_blank"> TSDX </a>，它为我们建立了一个完整的TypeScript开发包。</p><pre class="lj lk ll lm gt nl nk nm nn aw no bi"><span id="ea37" class="np lv in nk b gy nq nr l ns nt">npx tsdx create docusaurus-plugin-goatcounter</span></pre><p id="af3d" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">然后添加Docusaurus的类型。我们显式定义了所需的函数，因为“latest”标签不是最新的。最新版本见<a class="ae lh" href="https://www.npmjs.com/package/@docusaurus/types" rel="noopener ugc nofollow" target="_blank"> npm </a>。</p><pre class="lj lk ll lm gt nl nk nm nn aw no bi"><span id="c7fd" class="np lv in nk b gy nq nr l ns nt">yarn add --dev @docusaurus/types@2.0.0-alpha.65</span></pre><p id="25a6" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">现在，您可以复制<code class="fe nh ni nj nk b">plugins/goatcounter/index.js</code>的内容，并将其放在新项目的<code class="fe nh ni nj nk b">src/index.ts</code>中。</p><p id="e5af" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">因为我们要从普通JS迁移到TypeScript，所以我们需要一些小的修改。替换这个来自<code class="fe nh ni nj nk b">plugins/goatcounter/index.js</code>:</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="19f3" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">有了这个在<code class="fe nh ni nj nk b">src/index.ts</code>:</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="bcb6" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">为了测试你的插件，在你新创建的插件目录下运行<code class="fe nh ni nj nk b">yarn build &amp;&amp; yarn link</code>。然后在您的Docusaurus项目中，运行<code class="fe nh ni nj nk b">yarn link docusaurus-plugin-goatcounter</code>并修改<code class="fe nh ni nj nk b">docusaurus.config.js</code>以将插件作为包导入，而不是文件:</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h1 id="44a4" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">3.发布您的插件</h1><p id="1cd3" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">发布你的插件就像运行<code class="fe nh ni nj nk b">npm publish</code>并遵循它给出的步骤一样简单。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nu"><img src="../Images/9241eb66580720e86f60171972431cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQdLpREaLxcNPtsCe8v67g.png"/></div></div></figure><p id="141b" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">如果您之前将插件链接到了Docusaurus项目，那么您首先需要在Docusaurus项目中运行<code class="fe nh ni nj nk b">yarn unlink docusaurus-plugin-goatcounter</code>。然后，您可以从npm添加依赖关系:</p><pre class="lj lk ll lm gt nl nk nm nn aw no bi"><span id="a4e4" class="np lv in nk b gy nq nr l ns nt">yarn add docusaurus-plugin-goatcounter</span></pre><p id="971b" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">重启Docusaurus，现在你可以使用你新做的独立Docusaurus插件🥳了。</p><h1 id="b81a" class="lu lv in bd lw lx ly lz ma mb mc md me kc mf kd mg kf mh kg mi ki mj kj mk ml bi translated">解决纷争</h1><p id="c297" class="pw-post-body-paragraph kl km in kn b ko mm jx kq kr mn ka kt ku mo kw kx ky mp la lb lc mq le lf lg ig bi translated">不清楚的事？使用插件检查<a class="ae lh" href="https://github.com/Addono/docusaurus-plugin-goatcounter" rel="noopener ugc nofollow" target="_blank">插件</a>和<a class="ae lh" href="https://github.com/ClaimR/developer-website" rel="noopener ugc nofollow" target="_blank"> Docusaurus项目</a>的源代码。此外，随时发送<a class="ae lh" href="mailto:hi@aknapen.nl" rel="noopener ugc nofollow" target="_blank">电子邮件给我</a>！</p><p id="2c8f" class="pw-post-body-paragraph kl km in kn b ko kp jx kq kr ks ka kt ku kv kw kx ky kz la lb lc ld le lf lg ig bi translated">喜欢这篇文章吗？如果有，通过<a class="ae lh" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kn ix">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kn ix">！</strong></p></div></div>    
</body>
</html>