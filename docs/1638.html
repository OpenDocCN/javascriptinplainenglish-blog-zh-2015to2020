<html>
<head>
<title>How to create a lightweight web component with LitElement</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用LitElement创建轻量级web组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-lightweight-web-component-with-litelement-7e5ae084c9cf?source=collection_archive---------5-----------------------#2020-04-09">https://javascript.plainenglish.io/how-to-create-a-lightweight-web-component-with-litelement-7e5ae084c9cf?source=collection_archive---------5-----------------------#2020-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="29ff" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">快速构建并试用您的web组件</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9a85596cbcb71e796cb999e3747e84f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XlDCO_6ml5lRCbxJZnkzow.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo of Earth globe with countries by Porapak Apichodilok</figcaption></figure><p id="9339" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在之前的一篇文章中，<a class="ae lr" href="https://medium.com/javascript-in-plain-english/create-your-first-web-component-using-vanilla-javascript-82a50cc742b0" rel="noopener">我写了一篇关于如何只使用普通JavaScript编写web组件的文章</a>。在这篇新帖中，我们将看到如何快速完成，避免样板代码。</p><p id="77a9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以只用普通的JS创建一个web组件，但是我们很快就会意识到我们重复了很多代码来做同样的事情。LitElement有助于定义web组件，而不必学习定制模板语言和遵循web组件标准，因此我们的组件将与每个框架或普通js一起工作。</p><p id="2fa7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">LitElement使用<a class="ae lr" href="https://github.com/Polymer/lit-html" rel="noopener ugc nofollow" target="_blank"> lit-html </a>来定义和呈现html模板。Lit-Html让我们用JavaScript编写Html模板，然后渲染和<em class="ls">重新渲染</em>这些模板和数据，以创建和更新DOM。lit-html只刷新模板中发生变化的部分。它不会重新渲染整个视图。</p><p id="5c94" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">事不宜迟，让我们开始使用LitElement构建一个简单的Web组件。</p><p id="d2e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将逐步构建我们的定制组件<my-component>。</my-component></p><p id="1994" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:<em class="ls">为了简单起见，我将使用一个online和</em> <a class="ae lr" href="https://jsbin.com/?html,output" rel="noopener ugc nofollow" target="_blank"> <em class="ls">实时Html edito </em> </a> <em class="ls"> r来构建我们的Web组件。但是可以随意使用，例如，</em><a class="ae lr" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"><em class="ls">NodeJs</em></a><em class="ls">与</em><a class="ae lr" href="https://docs.npmjs.com/about-npm/" rel="noopener ugc nofollow" target="_blank"><em class="ls">NPM</em></a><em class="ls">包管理器。</em></p><p id="160b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要遵循本指南，建议您具备以下基本知识:</p><ul class=""><li id="83ef" class="lt lu iq kx b ky kz lb lc le lv li lw lm lx lq ly lz ma mb bi translated">HTML、CSS和Javascript。</li><li id="5f8e" class="lt lu iq kx b ky mc lb md le me li mf lm mg lq ly lz ma mb bi translated">Javascript模块</li><li id="81bd" class="lt lu iq kx b ky mc lb md le me li mf lm mg lq ly lz ma mb bi translated">箭头功能</li></ul><p id="a520" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">目前，您的浏览器不理解<my-component>标签。当浏览器发现像<my-component>这样的未知HTML标签时，它会将其呈现为一个内联元素，并继续表示下一个元素。</my-component></my-component></p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="4d91" class="mm mn iq mi b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  <br/>&lt;head&gt;<br/>  &lt;title&gt;lit-element code sample&lt;/title&gt; <br/>&lt;/head&gt;</span><span id="4302" class="mm mn iq mi b gy ms mp l mq mr">&lt;body&gt;<br/><strong class="mi ir">  &lt;my-component&gt;&lt;/my-component&gt; </strong><br/>&lt;/body&gt;</span><span id="b735" class="mm mn iq mi b gy ms mp l mq mr">&lt;/html&gt;</span></pre><p id="eca5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们需要导入LitElement基类和html helper函数。注意，在web上，您可以通过在脚本标签中将type属性设置为“module”来告诉浏览器将<script>部分作为一个模块来处理&lt;/root&gt;</script></p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="e13c" class="mm mn iq mi b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  <br/>&lt;head&gt;<br/>  &lt;title&gt;lit-element code example&lt;/title&gt; <br/>&lt;/head&gt;</span><span id="2636" class="mm mn iq mi b gy ms mp l mq mr">&lt;body&gt;<br/><strong class="mi ir">  &lt;my-component&gt;&lt;/my-component&gt;</strong></span><span id="9d2e" class="mm mn iq mi b gy ms mp l mq mr">&lt;script <strong class="mi ir">type="module"</strong>&gt;<br/>    <strong class="mi ir">import {LitElement, html} <br/>      from 'https://unpkg.com/lit-element?module';</strong>  <br/>  &lt;/script&gt;</span><span id="9b16" class="mm mn iq mi b gy ms mp l mq mr">&lt;/body&gt;</span><span id="db09" class="mm mn iq mi b gy ms mp l mq mr">&lt;/html&gt;</span></pre><p id="70cf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">创建扩展LitElement基类的组件类:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="b111" class="mm mn iq mi b gy mo mp l mq mr">class MyComponent extends  LitElement {  <br/>   constructor() {<br/>        super();<br/>   }<br/>  ...<br/>}</span></pre><p id="b0c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里，我们将实现“render”方法来为我们的元素设置一个模板。render方法必须返回“lit-html TemplateResult”要创建“TemplateResult”，我们必须使用“html”辅助函数标记JavaScript模板文字:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="4b4d" class="mm mn iq mi b gy mo mp l mq mr">class MyComponent extends  LitElement { <br/>   <strong class="mi ir">render() {</strong><br/>    return <strong class="mi ir">html`<br/></strong>      &lt;!-- template content --&gt;<br/>      &lt;p&gt;Hello! I'm a Web component, <br/>        Which simulates a counter...<br/>      &lt;/p&gt;<br/>      &lt;p&gt;Count: 0&lt;/p&gt;`<br/>   }<br/>}</span></pre><p id="d059" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们将在构造函数类中初始化一个计数器属性。</p><p id="8591" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">属性是通过一个静态getter来定义的。LitElement将该组件上设置的任何html属性解码为可以在javascript中使用的属性。对静态属性 <strong class="kx ir"> <em class="ls">中定义的属性的任何更改都会触发组件的</em> </strong> <em class="ls">重新渲染。支持的类型有数字、字符串、布尔和数组对象。</em></p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="1f6e" class="mm mn iq mi b gy mo mp l mq mr">class MyComponent extends  LitElement { <br/>   constructor() {<br/>        super();<br/>        <strong class="mi ir">this.counter = 0;</strong><br/>   }<br/> <br/><strong class="mi ir">   static get properties() {<br/>         return {<br/>          counter: {type: Number}<br/>         }<br/>   }</strong></span><span id="c313" class="mm mn iq mi b gy ms mp l mq mr">   render() {<br/>    return html`<br/>      &lt;p&gt;Hello! I'm a Web component, <br/>        Which simulates a counter...<br/>      &lt;/p&gt;<br/>      &lt;p&gt;Count: &lt;/p&gt;<strong class="mi ir">`<br/>  </strong> }<strong class="mi ir"><br/></strong>}</span></pre><p id="7e28" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下一步中，在类中添加一个方法来增加计数器属性:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="7856" class="mm mn iq mi b gy mo mp l mq mr">count(e) {<br/>       this.counter ++;<br/>       console.log( this.counter);<br/>}</span></pre><p id="a80f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在html模板中放置属性计数器和增加它的按钮。</p><p id="2584" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">模板的动态部分通过模板字符串表达式设置。我们可以使用任何有效的javascript表达式，让lit-html处理dom的更新。</em></p><p id="a924" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在litElement中，我们使用语法:@{onclick，change，…}来注册内联事件处理程序:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="44e6" class="mm mn iq mi b gy mo mp l mq mr">render() {<br/>...<br/>&lt;button<strong class="mi ir"> @click</strong>="${(e) =&gt;  <br/>    this.count(e)}"&gt;<br/>    Press me to count!!&lt;/button&gt;<br/> `<br/> ;<br/>}</span></pre><p id="fc13" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">向我们的组件添加一些样式非常容易:</p><p id="efb6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">样式应该作为静态getter添加。它们被评估一次，然后被添加到元素的影子dom中。</em><a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" rel="noopener ugc nofollow" target="_blank"><em class="ls">Shadow Dom</em></a><em class="ls">负责确定元素的CSS范围，只影响元素的模板，而不影响组件之外的其他方面。</em></p><p id="b96d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">导入“css”帮助器方法:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="65ad" class="mm mn iq mi b gy mo mp l mq mr">import {LitElement, html, <strong class="mi ir">css</strong>}<br/>       from 'https://unpkg.com/lit-element?module';</span></pre><p id="d0e4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并添加静态styles() getter方法:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="cc1b" class="mm mn iq mi b gy mo mp l mq mr">class MyComponent extends  LitElement {<br/> ...<br/> <strong class="mi ir">static get styles()</strong> {<br/>    return css`<br/>      :host {<br/>        display: block;<br/>      }<br/>     .counter{<br/>        color: red;<br/>      } <br/>    `;<br/> ...<br/>}</span></pre><p id="7e29" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将css类添加到html标签中:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="b88b" class="mm mn iq mi b gy mo mp l mq mr">render() {<br/>  ...<br/>  &lt;p <strong class="mi ir">class="counter"</strong>&gt;<br/>    Count:${this.counter}<br/>  &lt;/p&gt;<br/>  ...<br/>}</span></pre><p id="a634" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们需要向浏览器注册我们的组件:</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="64c8" class="mm mn iq mi b gy mo mp l mq mr">customElements.define('my-component', MyComponent);</span></pre><p id="ed3e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在可以在一个在线html编辑器中尝试一下。</p><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="19a9" class="mm mn iq mi b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  <br/>&lt;head&gt;<br/>  &lt;title&gt;lit-element code sample&lt;/title&gt; <br/>&lt;/head&gt;</span><span id="3d51" class="mm mn iq mi b gy ms mp l mq mr">&lt;body&gt;</span><span id="31b7" class="mm mn iq mi b gy ms mp l mq mr"><strong class="mi ir">&lt;my-component&gt;&lt;/my-component&gt;</strong></span><span id="81c6" class="mm mn iq mi b gy ms mp l mq mr">&lt;script type="module"&gt;<br/>     <br/>import {LitElement, html, css}<br/>       from 'https://unpkg.com/lit-element?module';</span><span id="02c7" class="mm mn iq mi b gy ms mp l mq mr">class MyComponent extends LitElement {</span><span id="92eb" class="mm mn iq mi b gy ms mp l mq mr">  static get properties() {<br/>          return {<br/>            counter: {type: Number}<br/>         }<br/>  }</span><span id="725c" class="mm mn iq mi b gy ms mp l mq mr">  constructor() {<br/>         super();<br/>         this.counter = 0;<br/>       }</span><span id="1442" class="mm mn iq mi b gy ms mp l mq mr">  static get styles() {<br/>       return css`<br/>         :host {<br/>            display: block;<br/>          }<br/>         .counter{<br/>            color: red;<br/>         }        <br/>      `;<br/>    }</span><span id="8bb9" class="mm mn iq mi b gy ms mp l mq mr"> render() {<br/>     return html`<br/>         &lt;p&gt;Hello! I'm a Web  <br/>            component, <br/>            Which simulates a                       <br/>            counter...<br/>         &lt;/p&gt;</span><span id="ca6b" class="mm mn iq mi b gy ms mp l mq mr">     &lt;p class='counter'&gt;<br/>          Count:${this.counter}&lt;/p&gt;</span><span id="78f5" class="mm mn iq mi b gy ms mp l mq mr">     &lt;button <a class="ae lr" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="${(e) =&gt;  <br/>          this.count(e)}"&gt;Press me to <br/>         counting!!&lt;/button&gt;<br/>        `<br/>       ;<br/> }//end render method</span><span id="5cd7" class="mm mn iq mi b gy ms mp l mq mr"> count(e) {<br/>       this.counter ++;<br/>       console.log( this.counter);<br/> }</span><span id="36c5" class="mm mn iq mi b gy ms mp l mq mr">}//end of class<br/> <br/>  <br/>//Register componet <br/>customElements.define('my-component',   <br/>   MyComponent);</span><span id="c5d0" class="mm mn iq mi b gy ms mp l mq mr">&lt;/script&gt;<br/> <br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="728e" class="mm mn iq bd mt mu mv dn mw mx my dp mz le na nb nc li nd ne nf lm ng nh ni nj bi translated">结论</h2><p id="4d03" class="pw-post-body-paragraph kv kw iq kx b ky nk jr la lb nl ju ld le nm lg lh li nn lk ll lm no lo lp lq ij bi translated">在本文中，我们看到了一个如何构建Web组件的简单示例。但是使用LitElement/lit-html，可以创建任何组件类型。LitElement非常强大，可以帮助我们更快、更清晰、更少出错地开发代码。</p><p id="fc2e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">非常感谢你阅读这篇小文章，我希望它对你有用！</p><h2 id="3d9a" class="mm mn iq bd mt mu mv dn mw mx my dp mz le na nb nc li nd ne nf lm ng nh ni nj bi translated">参考</h2><p id="4a95" class="pw-post-body-paragraph kv kw iq kx b ky nk jr la lb nl ju ld le nm lg lh li nn lk ll lm no lo lp lq ij bi translated">文学元素</p></div></div>    
</body>
</html>