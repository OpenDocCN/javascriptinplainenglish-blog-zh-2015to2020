<html>
<head>
<title>JS i18n: 5 essential tips for localeCompare() &amp; Intl.Collator()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JS i18n:locale compare()&amp; Intl的5个基本技巧。排序器()</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/js-i18n-5-essential-tips-for-localecompare-intl-collator-27b8570196cd?source=collection_archive---------5-----------------------#2020-10-03">https://javascript.plainenglish.io/js-i18n-5-essential-tips-for-localecompare-intl-collator-27b8570196cd?source=collection_archive---------5-----------------------#2020-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c323" class="pw-subtitle-paragraph jr ip iq bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">localeCompare() &amp; <code class="fe jn jo jp jq b">Intl.Collator() </code>启用区分语言的字符串比较</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/67e3343081dcffffe0d7fdf993187b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kEzpRxKIpWaKqsGB.jpg"/></div></div></figure><h2 id="0aa5" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">TL；速度三角形定位法(dead reckoning)</h2><p id="de22" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi">JavaScript native sort method does not work for most of foreign language, which has non-ASCII characters like <em class="mk">[‘ą’, ‘ㄱ’, ‘</em>世<em class="mk">’, ‘</em>д<em class="mk">’, ‘e’]</em></p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="2ca4" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">快速解决方案</strong></p><p id="3fc8" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated">使用<code class="fe jn jo jp jq b">localeCompare()</code></p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="dbcf" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated">使用<code class="fe jn jo jp jq b">Intl.Collator()</code></p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="ml mm l"/></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="55f5" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak"> 1。性能</strong></h2><p id="f922" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated"><code class="fe jn jo jp jq b"><strong class="lt ir">Intl.Collator</strong></code> <strong class="lt ir">比</strong> <code class="fe jn jo jp jq b"><strong class="lt ir">localeCompare</strong></code>更会表演</p><p id="61b6" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated">在比较大量字符串时，<code class="fe jn jo jp jq b">Intl.Collator</code>对象及其<code class="fe jn jo jp jq b">compare</code>属性的性能优于<code class="fe jn jo jp jq b">localeCompare()</code></p><p id="f5e6" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">本地比较()</strong></p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="f2ca" class="kv kw iq jq b gy nd ne l nf ng">const a = 'réservé'; // with accents, lowercase<br/>const b = 'RESERVE'; // no accents, uppercase</span><span id="686b" class="kv kw iq jq b gy nh ne l nf ng">console.log(a.localeCompare(b));<br/>// expected output: 1</span></pre><p id="e05c" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">国际整理器()</strong></p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="9271" class="kv kw iq jq b gy nd ne l nf ng">const a = 'réservé'; // with accents, lowercase<br/>const b = 'RESERVE'; // no accents, uppercase</span><span id="d403" class="kv kw iq jq b gy nh ne l nf ng">console.log(new Intl.Collator().compare(a, b));</span><span id="c7fc" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1</span></pre></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="2312" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">2.BCP 47语言标签</h2><p id="7bd2" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated"><strong class="lt ir"/><code class="fe jn jo jp jq b"><strong class="lt ir">Intl.Collator</strong></code><strong class="lt ir">和</strong> <code class="fe jn jo jp jq b"><strong class="lt ir">localeCompare</strong></code> <strong class="lt ir">都提供了BCP 47种语言标签</strong>中指定的各种i18n本地化选项</p><p id="9ed6" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated">例如，各种类型的英语语言和非字母语言(即朝鲜语和汉语)是可用的</p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="0849" class="kv kw iq jq b gy nd ne l nf ng">// Various Types of English Languages</span><span id="e754" class="kv kw iq jq b gy nh ne l nf ng">en-CA &gt;&gt; Canadian English<br/>en-GB &gt;&gt; British English<br/>en-IN &gt;&gt; Indian English<br/>en-US &gt;&gt; US English<br/>en-NZ &gt;&gt; New Zealand English</span><span id="7893" class="kv kw iq jq b gy nh ne l nf ng">// Non-Alphabet Languages</span><span id="f4ca" class="kv kw iq jq b gy nh ne l nf ng">ko-KR &gt;&gt; Korean (Republic of Korea)<br/>jp-JP &gt;&gt; Japanese (Japan)<br/>zh-CN &gt;&gt; Mainland China, simplified characters<br/>zh-HK &gt;&gt; Hong Kong, traditional characters</span></pre><p id="66b4" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir"> localeCompare() </strong></p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="557f" class="kv kw iq jq b gy nd ne l nf ng"><strong class="jq ir">// \\ // \\ 'en'</strong></span><span id="2a56" class="kv kw iq jq b gy nh ne l nf ng">const a = 'banana';<br/>const b = 'apple';</span><span id="50a8" class="kv kw iq jq b gy nh ne l nf ng">console.log(a.localeCompare(b, 'en'));</span><span id="0267" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1 // "apple" comes before "banana"</span><span id="3f74" class="kv kw iq jq b gy nh ne l nf ng"><strong class="jq ir">// \\ // \\ 'en-US'</strong></span><span id="6023" class="kv kw iq jq b gy nh ne l nf ng">const a = 'banana';<br/>const b = 'apple';</span><span id="4939" class="kv kw iq jq b gy nh ne l nf ng">console.log(a.localeCompare(b, 'en-US'));</span><span id="b0e0" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1 // "apple" comes before "banana"</span><span id="cca3" class="kv kw iq jq b gy nh ne l nf ng"><strong class="jq ir">// \\ // \\ 'ko-KR'</strong></span><span id="e100" class="kv kw iq jq b gy nh ne l nf ng">const a = '나';<br/>const b = '가';</span><span id="6598" class="kv kw iq jq b gy nh ne l nf ng">console.log(a.localeCompare(b, 'ko-KR'));</span><span id="4b66" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1 // "가" comes before "나"</span></pre><p id="3521" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">国际。整理器()</strong></p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="6904" class="kv kw iq jq b gy nd ne l nf ng"><strong class="jq ir">// \\ // \\ 'en'</strong></span><span id="8aba" class="kv kw iq jq b gy nh ne l nf ng">const a = 'banana';<br/>const b = 'apple';<br/>console.log(new Intl.Collator('en').compare(a, b));</span><span id="1ada" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1 // "apple" comes before "banana"</span><span id="1cbd" class="kv kw iq jq b gy nh ne l nf ng"><strong class="jq ir">// \\ // \\ 'en-US'</strong></span><span id="dbb7" class="kv kw iq jq b gy nh ne l nf ng">const a = 'banana';<br/>const b = 'apple';<br/>console.log(new Intl.Collator('en-US').compare(a, b));</span><span id="f821" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1 // "apple" comes before "banana"</span><span id="aef2" class="kv kw iq jq b gy nh ne l nf ng"><strong class="jq ir">// \\ // \\ 'ko-KR'</strong></span><span id="9364" class="kv kw iq jq b gy nh ne l nf ng">const a = '나';<br/>const b = '가';<br/>console.log(new Intl.Collator('ko-KR').compare(a, b));</span><span id="99d4" class="kv kw iq jq b gy nh ne l nf ng">// expected output: 1 // "가" comes before "나"</span></pre></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="fb6e" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">3.各种选项可用</h2><p id="afbb" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated"><strong class="lt ir">无论是</strong> <code class="fe jn jo jp jq b"><strong class="lt ir">Intl.Collator</strong></code> <strong class="lt ir">还是</strong> <code class="fe jn jo jp jq b"><strong class="lt ir">localeCompare</strong></code> <strong class="lt ir">都有很多选项可用</strong></p><p id="da7d" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">忽略标点:</strong>决定是否忽略标点</p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="9c7b" class="kv kw iq jq b gy nd ne l nf ng">let items = ['réservé', 'Premier', 'Cliché', 'communiqué', 'café'];</span><span id="0851" class="kv kw iq jq b gy nh ne l nf ng">items.sort( (a, b) =&gt; a.localeCompare(b, 'fr', {ignorePunctuation: true})); </span><span id="ed0c" class="kv kw iq jq b gy nh ne l nf ng">// ['café', 'Cliché', 'communiqué', 'Premier', 'réservé']</span></pre><p id="c599" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">数字:</strong>确定是否使用数字排序规则</p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="01c6" class="kv kw iq jq b gy nd ne l nf ng">true - numeric collation will be used when sorting<br/>false (default) - numeric collation will not be used when sorting</span></pre><p id="88b3" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir"> localeCompare() </strong></p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="4b7e" class="kv kw iq jq b gy nd ne l nf ng"><strong class="jq ir">// \\ // \\ ignorePunctuation</strong></span><span id="b0dc" class="kv kw iq jq b gy nh ne l nf ng">function letterSort(lang, letters) {<br/>  letters.sort(new Intl.Collator(lang, <br/>    {ignorePunctuation: true}).compare);<br/>  return letters;<br/>}</span><span id="9035" class="kv kw iq jq b gy nh ne l nf ng">console.log(letterSort('fr', <br/>  ['réservé', 'Premier', 'Cliché', 'communiqué', 'café']<br/>));</span><span id="7b5e" class="kv kw iq jq b gy nh ne l nf ng">// expected output: Array ['café', 'Cliché', 'communiqué', 'Premier', 'réservé']</span><span id="7dd0" class="kv kw iq jq b gy nh ne l nf ng"><strong class="jq ir">// \\ // \\ numeric</strong></span><span id="f70e" class="kv kw iq jq b gy nh ne l nf ng">// by default, "2" &gt; "10" WRONG b/c 2 &lt; 10<br/>console.log("2".localeCompare("10")); // 1<br/><br/>// numeric using options:<br/>console.log("2".localeCompare("10", undefined, <br/>  {numeric: true})); <br/>// -1</span></pre><p id="5b07" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">国际。整理器()</strong></p><pre class="kk kl km kn gt mz jq na nb aw nc bi"><span id="2c94" class="kv kw iq jq b gy nd ne l nf ng"><strong class="jq ir">// \\ // \\ ignorePunctuation</strong></span><span id="c02e" class="kv kw iq jq b gy nh ne l nf ng">function letterSort(lang, letters) {<br/>  letters.sort(new Intl.Collator(lang, <br/>  {ignorePunctuation: true}).compare);<br/>  return letters;<br/>}</span><span id="6e4e" class="kv kw iq jq b gy nh ne l nf ng">console.log(letterSort('fr', <br/> ['réservé', 'Premier', 'Cliché', 'communiqué', 'café']<br/>));</span><span id="2a71" class="kv kw iq jq b gy nh ne l nf ng">// expected output: Array ['café', 'Cliché', 'communiqué', 'Premier', 'réservé']</span><span id="67d5" class="kv kw iq jq b gy nh ne l nf ng"><strong class="jq ir">// \\ // \\ numeric</strong></span><span id="3884" class="kv kw iq jq b gy nh ne l nf ng">console.log(new Intl.Collator().compare('2', '10')); <br/>// 1</span><span id="c156" class="kv kw iq jq b gy nh ne l nf ng">console.log(new Intl.Collator(undefined, {numeric: true}).compare('2', '10')); <br/>// -1</span></pre></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="f487" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">4.不要依赖于精确的返回值-1或1</h2><p id="5035" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">W3C规范只要求负值和正值。因此，有些浏览器可能会返回<strong class="lt ir"> -2 </strong>或<strong class="lt ir"> 2 </strong>，甚至其他一些负值或正值。因此不要依赖于<strong class="lt ir"> -1 </strong>或<strong class="lt ir"> 1 </strong>的确切返回值</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="6d72" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">5.浏览器兼容性</h2><p id="e418" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated"><strong class="lt ir"/><code class="fe jn jo jp jq b"><strong class="lt ir">Intl.Collator</strong></code><strong class="lt ir">和</strong> <code class="fe jn jo jp jq b">localeCompare</code> <strong class="lt ir">都兼容大多数浏览器，但</strong> <code class="fe jn jo jp jq b"><strong class="lt ir">Intl.Collator</strong></code> <strong class="lt ir">的兼容性稍微好一点</strong></p><p id="9389" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir"> localeCompare() </strong></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ni"><img src="../Images/6338215e07ec811df70ba4a8d8501a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMIEUvqH5gDcmWxPg_rJvA.png"/></div></div></figure><p id="ca78" class="pw-post-body-paragraph lr ls iq lt b lu mn jv lw lx mo jy lz le mp mb mc li mq me mf lm mr mh mi mj ij bi translated"><strong class="lt ir">国际。整理器()</strong></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nj"><img src="../Images/10c0a77fbf6a67a670980e73ff63fc39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g31GkaSrAlg0FvRnNS6azA.png"/></div></div></figure><h2 id="bd19" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h2><p id="9f66" class="pw-post-body-paragraph lr ls iq lt b lu lv jv lw lx ly jy lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">用<code class="fe jn jo jp jq b">Intl.Collator</code>代替<code class="fe jn jo jp jq b">localeCompare</code>是因为</p><ul class=""><li id="6975" class="nk nl iq lt b lu mn lx mo le nm li nn lm no mj np nq nr ns bi translated"><code class="fe jn jo jp jq b">Intl.Collator</code>在比较大量字符串时有更好的性能</li><li id="94a7" class="nk nl iq lt b lu nt lx nu le nv li nw lm nx mj np nq nr ns bi translated"><code class="fe jn jo jp jq b">Intl.Collator</code>具有更好的浏览器兼容性</li></ul><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ny"><img src="../Images/8c0c0eb9c0d15d0c2959c7b7f4032308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QFwfrLNuibxx1Spk.png"/></div></div></figure></div></div>    
</body>
</html>