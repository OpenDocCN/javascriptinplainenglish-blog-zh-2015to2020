<html>
<head>
<title>How to Use the useReducer React Hook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用useReducer React挂钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-the-usereducer-react-hook-722c2d511a3b?source=collection_archive---------18-----------------------#2020-12-21">https://javascript.plainenglish.io/how-to-use-the-usereducer-react-hook-722c2d511a3b?source=collection_archive---------18-----------------------#2020-12-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="4f8a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当React挂钩在<a class="ae ki" href="https://reactjs.org/blog/2019/02/06/react-v16.8.0.html" rel="noopener ugc nofollow" target="_blank"> React v16 </a>中引入时，开发人员利用这个机会修改了<a class="ae ki" href="https://reactjs.org/docs/components-and-props.html" rel="noopener ugc nofollow" target="_blank">功能组件</a>中的React状态。一大堆钩子被创造出来，比如<code class="fe kj kk kl km b">useEffect</code>、<code class="fe kj kk kl km b">useState</code>和<a class="ae ki" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">其他</a>。今天，我们将深入了解<code class="fe kj kk kl km b"><a class="ae ki" href="https://reactjs.org/docs/hooks-reference.html#usereducer" rel="noopener ugc nofollow" target="_blank">useReducer</a></code>，看看我们如何使用它来编写更好的React代码。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/d8de207308af5d7eec3f49d20769d821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7kUG1b3344JjSHXc"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Photo by <a class="ae ki" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae ki" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="82a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">为了简单起见，我们将看一个非常简单的React组件，以及我们如何实现<code class="fe kj kk kl km b">useReducer</code>来跟踪状态。</p><p id="2898" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在其核心，<code class="fe kj kk kl km b">useReducer</code>是一个管理组件状态的钩子，类似于<code class="fe kj kk kl km b">useState</code>，但是更强大。</p><p id="6c6d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不同的是，在<code class="fe kj kk kl km b">useState</code>中，你调用一个updater函数来修改状态:</p><pre class="ko kp kq kr gt ld km le lf aw lg bi"><span id="5498" class="lh li in km b gy lj lk l ll lm">const [state, setState] = useState(0)</span><span id="66fe" class="lh li in km b gy ln lk l ll lm">setState(p =&gt; p++)</span></pre><p id="431c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是实现本地状态管理的一个超级简单而强大的方法。然而，一旦我们开始处理更复杂的状态，我们就开始遇到一些问题。这些<code class="fe kj kk kl km b">setState</code>函数调用开始变得非常庞大和笨拙。这就是<code class="fe kj kk kl km b">useReducer</code>的用武之地。</p><p id="0fbd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">不是使用函数来修改状态，而是通过传入消息来改变状态。</p><p id="3543" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果你熟悉<a class="ae ki" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>，<code class="fe kj kk kl km b">useReducer</code>也有非常相似的行为。“缩减器”是一个纯粹的函数，它基于前一个状态和一些分派的动作来计算下一个状态:</p><pre class="ko kp kq kr gt ld km le lf aw lg bi"><span id="e20d" class="lh li in km b gy lj lk l ll lm">(currentState, action) =&gt; newState</span></pre><p id="c05f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">“纯函数”是一种接受输入并返回输出而不修改输入的函数(更多信息请阅读此处的<a class="ae ki" href="https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-pure-function-d1c076bec976" rel="noopener">和</a>)。这意味着缩减器返回一个全新的状态，而不仅仅是先前状态的修改形式。</p><p id="36b5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">减压器有几个关键规则。减速器:</p><ol class=""><li id="6643" class="lo lp in jm b jn jo jr js jv lq jz lr kd ls kh lt lu lv lw bi translated">永远不要改变他们的参数(不修改当前状态)</li><li id="6d03" class="lo lp in jm b jn lx jr ly jv lz jz ma kd mb kh lt lu lv lw bi translated">从不产生副作用(没有外部函数调用或API请求)</li><li id="9dc7" class="lo lp in jm b jn lx jr ly jv lz jz ma kd mb kh lt lu lv lw bi translated">不要调用非纯函数，这些函数根据输入以外的任何东西改变输出(即不要使用<code class="fe kj kk kl km b">Date.now()</code>或任何变化的值)</li></ol><p id="4e1c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">通过遵循这些规则，你将总是能写出易于测试和使用的reducers，这将在调试或重构代码时帮助你。</p><p id="aa05" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Reducers帮助我们集中状态管理，允许组件发送消息来修改状态和改变组件中更复杂的状态。</p><p id="9d6b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们来看一个非常简单的反例，看看我们在现实生活中如何实现reducer:</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="782a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这段代码有几个关键部分。首先是减速器，这是一个接受一个<code class="fe kj kk kl km b">state</code>和一个<code class="fe kj kk kl km b">action</code>的函数。您可以看到，我们使用了一个switch语句，根据正在使用的操作返回不同的状态。</p><p id="25fb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在组件中，我们可以看到如何调用<code class="fe kj kk kl km b">dispatch</code>来调用状态动作，在本例中是递增或递减计数。</p><p id="63dd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">虽然这是一个很好的基本例子来看看它是如何工作的，但是一旦我们有了更复杂的状态，可能是一系列嵌套的对象，并且每个动作每次只修改该状态的一小部分，那么<code class="fe kj kk kl km b">useReducer</code>的真正威力就会显现出来。</p><p id="3fd6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">另一个优势是<code class="fe kj kk kl km b">useReducer</code>允许我们在应用程序中重用reducers，你可以定义一个单一的状态行为，并在应用程序的多个地方复制它，这是一个防止重复代码的好方法。</p><h1 id="dc65" class="me li in bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">结论</h1><p id="ae73" class="pw-post-body-paragraph jk jl in jm b jn nb jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd nf kf kg kh ig bi translated">这是很多信息，所以让我们回顾一下我们所学的内容。</p><ul class=""><li id="df9c" class="lo lp in jm b jn jo jr js jv lq jz lr kd ls kh ng lu lv lw bi translated"><code class="fe kj kk kl km b">useReducer</code>是一个React钩子，通过使用“actions”和“reducers”来修改局部状态</li><li id="1678" class="lo lp in jm b jn lx jr ly jv lz jz ma kd mb kh ng lu lv lw bi translated">我们使用一个纯函数，它接受一个先前的状态和一个动作(或一个键)，我们称之为“缩减器”</li><li id="a93f" class="lo lp in jm b jn lx jr ly jv lz jz ma kd mb kh ng lu lv lw bi translated"><code class="fe kj kk kl km b">useReducer</code>最适合在处理复杂状态时使用</li></ul><p id="7fba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望这篇文章能帮助你更好地理解如何使用<code class="fe kj kk kl km b">useReducer</code>来编写更干净的React代码！</p><h2 id="8224" class="lh li in bd mf nh ni dn mj nj nk dp mn jv nl nm mr jz nn no mv kd np nq mz nr bi translated">保持联络</h2><p id="7229" class="pw-post-body-paragraph jk jl in jm b jn nb jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd nf kf kg kh ig bi translated">有很多内容，我很感谢你读我的。我是加州大学伯克利分校的一名学生，也是一名年轻的企业家，我写关于软件开发以及我经营和发展公司的经历。你可以在这里注册我的简讯<a class="ae ki" href="https://newsletter.cometcode.io/" rel="noopener ugc nofollow" target="_blank"/>或者在我的<a class="ae ki" href="https://www.caelinsutch.com/" rel="noopener ugc nofollow" target="_blank">网站</a>查看我正在做的事情。请随时联系我，在Linkedin或Twitter上联系我，我喜欢听到阅读我作品的人的声音:)</p></div></div>    
</body>
</html>