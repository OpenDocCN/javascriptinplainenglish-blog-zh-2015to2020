<html>
<head>
<title>We need to minimize the use of global variables in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们需要尽量减少JavaScript中全局变量的使用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/we-need-to-minimize-the-use-of-global-variables-in-javascript-cafd5dc69b79?source=collection_archive---------4-----------------------#2020-03-16">https://javascript.plainenglish.io/we-need-to-minimize-the-use-of-global-variables-in-javascript-cafd5dc69b79?source=collection_archive---------4-----------------------#2020-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a78b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何以及为什么在JavaScript中避免全局变量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2a84a9ff8702cd71220f19c22a7d798b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SeezVgDqpFjj7vbLqIYJPQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Minimize the use of global variables in JavaScript</figcaption></figure><h1 id="157a" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">JavaScrip如何管理作用域？</h1><p id="89b3" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在JavaScript语言中，有两种类型的作用域:</p><ul class=""><li id="0c7d" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">全球范围</li><li id="6de1" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">局部范围</li></ul><p id="84e8" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">JavaScript使用函数来管理范围。函数内部定义的变量在局部范围内，在函数外部不可用。而在函数外部定义的变量在全局范围内。每个函数在被调用时都会创建一个新的作用域。</p><blockquote class="nc"><p id="2625" class="nd ne iq bd nf ng nh ni nj nk nl mi dk translated">请记住，每个函数在被调用时都会创建一个新的作用域。</p></blockquote><h1 id="8b6f" class="kv kw iq bd kx ky kz la lb lc ld le lf jw nm jx lh jz nn ka lj kc no kd ll lm bi translated">全局变量的问题是</h1><p id="67fe" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">全局变量很容易被其他脚本覆盖。例如，当应用程序的两个独立部分使用相同的名称但不同的目的定义全局变量时。</p><p id="de2b" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">例如，网页包含非页面开发人员编写的代码也很常见。</p><ul class=""><li id="f03a" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">第三方JavaScript库</li><li id="8bd5" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">来自第三方用户跟踪和分析脚本的代码</li><li id="fcc7" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">不同种类的部件、徽章和按钮</li><li id="2489" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">来自广告合作伙伴的脚本</li></ul><h1 id="dd27" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">JavaScript中如何避免</strong>全局变量？</h1><h2 id="d9b8" class="np kw iq bd kx nq nr dn lb ns nt dp lf lw nu nv lh ma nw nx lj me ny nz ll oa bi translated">示例1</h2><p id="c7d0" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">考虑下面的例子。<code class="fe ob oc od oe b">result</code>未经声明就被使用。这可能是问题的来源。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="5bf6" class="np kw iq oe b gy oj ok l ol om">function multiply(x, y) {<br/>    //anti-pattern: implied a global variable    <br/>    <strong class="oe ir">result = x * y</strong><br/>    return result<br/>}</span></pre><p id="2230" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">经验法则是总是用<code class="fe ob oc od oe b">var</code>声明变量。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="7714" class="np kw iq oe b gy oj ok l ol om">function multiply(x, y) {<br/>    <strong class="oe ir">var result = x * y</strong><br/>    return result<br/>}</span></pre><h2 id="1929" class="np kw iq bd kx nq nr dn lb ns nt dp lf lw nu nv lh ma nw nx lj me ny nz ll oa bi translated">示例2</h2><p id="9913" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">另一个创建隐含全局变量的例子是将赋值作为<code class="fe ob oc od oe b">var</code>声明的一部分进行链接。在下面的例子中，a是本地的，但是b变成了全局的。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="92f6" class="np kw iq oe b gy oj ok l ol om">function makeSomething() {<br/>    //anti-pattern: don't use <br/>    <strong class="oe ir">var a = b = 0</strong><br/>    ...<br/>}</span></pre><p id="7e68" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">重写如下代码。a和b都是本地的。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="7c19" class="np kw iq oe b gy oj ok l ol om">function makeSomething() {<br/>    <strong class="oe ir">var a, b</strong><br/>    a = b = 0<br/>    ...<br/>}</span></pre><h2 id="e19a" class="np kw iq bd kx nq nr dn lb ns nt dp lf lw nu nv lh ma nw nx lj me ny nz ll oa bi translated"><strong class="ak">例3 </strong></h2><p id="65e0" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">属性可以用delete操作符删除，而变量不能。</p><blockquote class="nc"><p id="e146" class="nd ne iq bd nf ng nh ni nj nk nl mi dk translated">请记住，属性可以用delete操作符删除，而变量不能。</p></blockquote><p id="95ae" class="pw-post-body-paragraph ln lo iq lp b lq on jr ls lt oo ju lv lw op ly lz ma oq mc md me or mg mh mi ij bi translated">无法删除使用<code class="fe ob oc od oe b">var</code>创建的全局。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="18fa" class="np kw iq oe b gy oj ok l ol om">var x = 10<br/>delete x<br/><strong class="oe ir">&lt;&lt; false</strong></span></pre><p id="df7b" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">不使用<code class="fe ob oc od oe b">var</code>创建的隐含全局变量可以被删除，不管是否在函数内部创建。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="a3dc" class="np kw iq oe b gy oj ok l ol om">x = 10<br/>delete x<br/><strong class="oe ir">&lt;&lt; true</strong></span><span id="7a6a" class="np kw iq oe b gy os ok l ol om">function makeSomething() {<br/>    y= 20<br/>}<br/>delete y<br/><strong class="oe ir">&lt;&lt; true</strong></span></pre><h2 id="363b" class="np kw iq bd kx nq nr dn lb ns nt dp lf lw nu nv lh ma nw nx lj me ny nz ll oa bi translated"><strong class="ak">例4 </strong></h2><p id="1f0c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">你使用一个变量，然后在函数中进一步声明它。看一下这个例子。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="67a0" class="np kw iq oe b gy oj ok l ol om">x = "global" // global variable<br/>function makeSomething() {</span><span id="b9ee" class="np kw iq oe b gy os ok l ol om">    console.log(x) // undefined<br/>    var x = "local"<br/>    console.log(x) // local<br/>}<br/>makeSomething()<br/><strong class="oe ir">console.log(x)</strong><br/>&lt;&lt; undefined<br/>&lt;&lt; local<br/><strong class="oe ir">&lt;&lt; global</strong></span></pre><blockquote class="nc"><p id="52fb" class="nd ne iq bd nf ng ot ou ov ow ox mi dk translated">在JavaScript中，它使我们能够在函数中的任何地方拥有多个<code class="fe ob oc od oe b">var</code>语句，它们的行为就好像变量是在函数的顶部声明的一样。</p></blockquote><p id="9c56" class="pw-post-body-paragraph ln lo iq lp b lq on jr ls lt oo ju lv lw op ly lz ma oq mc md me or mg mh mi ij bi translated">实际上，上面的代码片段就像下面这样。x变量在函数的顶部声明，但是x的值仍然设置在当前位置。</p><pre class="kg kh ki kj gt of oe og oh aw oi bi"><span id="13ff" class="np kw iq oe b gy oj ok l ol om">x = "global" // global variable<br/>function makeSomething() {<br/>    <strong class="oe ir">var x</strong><br/>    console.log(x) // undefined<br/>    x = "local<br/>    console.log(x) // local<br/>}<br/>makeSomething()<br/>console.log(x)<br/>&lt;&lt; undefined<br/>&lt;&lt; local<br/>&lt;&lt; global</span></pre><p id="9009" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">全局变量并不坏，甚至不是一个安全问题，但它不应该覆盖另一个变量的值。</p></div><div class="ab cl oy oz hu pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="ij ik il im in"><p id="cb46" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">感谢阅读😘，再见👋，别忘了👏最多50次并跟随！</p></div></div>    
</body>
</html>