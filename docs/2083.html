<html>
<head>
<title>Using Vue Keep-Alive Component to Save the State of Dynamic Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Vue保活组件保存动态组件的状态</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-vue-keep-alive-component-to-save-the-state-of-dynamic-components-e52144e2260e?source=collection_archive---------4-----------------------#2020-05-18">https://javascript.plainenglish.io/using-vue-keep-alive-component-to-save-the-state-of-dynamic-components-e52144e2260e?source=collection_archive---------4-----------------------#2020-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b21877dc60066a1b004c638fa3458f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zbmslv31bpoYmt2E"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@picsbyjameslee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">James Lee</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1a5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js是一个易于使用的web应用框架，我们可以用它来开发交互式前端应用。</p><p id="c6bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何在用户在动态组件之间导航时保存状态，以避免用户受挫。</p><h1 id="9db0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">保活组件</h1><p id="5c0e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当用户使用默认配置在动态组件之间导航时，用户在选项卡之间导航时会丢失数据。</p><p id="4133" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为当我们转换动态组件时，当我们呈现组件的实例、移除当前组件并重新呈现该组件的新实例时，会添加和移除组件。</p><p id="6e04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">keep-alive组件是一个包装器组件，即使当用户离开该组件时，它也能保持旧实例的活动状态。</p><p id="4240" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一种叫做抽象元素的成分。它不呈现DOM元素，也不显示为组件。</p><p id="7a22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用keep-alive组件来做任何需要我们在屏幕上保留现有数据的事情。</p><p id="6b82" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以用它来缓存表单中的用户输入或缓存API调用结果。</p><p id="e2e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">keep-alive组件还将组件存储在缓存中，因此渲染速度更快。我们应该只在渲染动态组件时使用它，因为我们不想缓存所有的东西。</p><p id="35ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，用户可能会看到他们不希望看到的旧值。</p><h1 id="d56b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">保持活动组件挂钩</h1><p id="80fb" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">保持活动的组件具有自定义挂钩。他们是<code class="fe me mf mg mh b">activated</code>和<code class="fe me mf mg mh b">deactivated</code>。</p><p id="1e71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当一个保活组件被激活时，调用<code class="fe me mf mg mh b">activated</code>钩子，当保活组件被停用时，调用<code class="fe me mf mg mh b">deactivated</code>钩子。</p><h1 id="cc54" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单的例子</h1><p id="bc04" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们使用Vue内置的<code class="fe me mf mg mh b">keep-alive</code>组件来进行缓存。</p><p id="cd58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以创建一些组件，并使用<code class="fe me mf mg mh b">keep-alive</code>中的<code class="fe me mf mg mh b">component</code>组件动态地切换keep组件，同时保持它们被缓存。</p><p id="c727" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以编写以下代码:</p><p id="ad63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/EmployeeForm.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="59bf" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;input v-model="name" placeholder="employee"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="7569" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "EmployeeForm",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="164f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/StudentForm.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="33d4" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;input v-model="name" placeholder="student"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="358e" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "StudentForm",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="bb03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/UserForm.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d9ca" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;input v-model="name" placeholder="user"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="2fb4" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "UserForm",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="0d1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">App.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4e56" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;button @click="currentTab = 'user-form'"&gt;user form&lt;/button&gt;<br/>    &lt;button @click="currentTab = 'student-form'"&gt;student form&lt;/button&gt;<br/>    &lt;button @click="currentTab = 'employee-form'"&gt;employee form&lt;/button&gt;<br/>    &lt;keep-alive&gt;<br/>      &lt;component :is="currentTab"&gt;&lt;/component&gt;<br/>    &lt;/keep-alive&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="8e14" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>import UserForm from "./components/UserForm";<br/>import StudentForm from "./components/StudentForm";<br/>import EmployeeForm from "./components/EmployeeForm";</span><span id="e74d" class="mq lc iq mh b gy mv ms l mt mu">export default {<br/>  name: "App",<br/>  components: {<br/>    UserForm,<br/>    StudentForm,<br/>    EmployeeForm<br/>  },<br/>  data() {<br/>    return {<br/>      currentTab: "user-form"<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="d0bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们有3个组件和3个表单，每个表单的输入都绑定到它们自己的模型。</p><p id="9016" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">App.vue</code>中，我们有了<code class="fe me mf mg mh b">keep-alive</code>组件，它包裹着<code class="fe me mf mg mh b">component</code>组件。</p><p id="fe72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">keep-alive</code>组件让我们缓存组件的呈现实例，而不是创建一个新的组件实例并呈现它。</p><p id="46b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">component</code>组件使用设置为<code class="fe me mf mg mh b">is</code>属性的值的名称来呈现组件。</p><p id="d400" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它会自动匹配烤肉串案件名称。这意味着我们为组件准备的PascalCase名称— <code class="fe me mf mg mh b">UserForm</code>、<code class="fe me mf mg mh b">StudentForm</code>和<code class="fe me mf mg mh b">EmployeeForm</code>将被自动映射到<code class="fe me mf mg mh b">user-form</code>、<code class="fe me mf mg mh b">student-form</code>和<code class="fe me mf mg mh b">employee-form</code>。</p><p id="47fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们点击按钮时，按钮的点击处理程序将<code class="fe me mf mg mh b">currentTab</code>的值设置为烤肉串盒组件名称。</p><p id="cb4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，当我们在每个选项卡的输入框中输入内容时，我们会看到输入的值由于<code class="fe me mf mg mh b">keep-alive</code>组件的缓存而被保留。</p><p id="b8d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们删除了<code class="fe me mf mg mh b">keep-alive</code>组件，输入的值将不会被缓存，如果我们在不同的组件之间切换，它们将会消失。</p><p id="8e74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们添加如下的<code class="fe me mf mg mh b">activated</code>和<code class="fe me mf mg mh b">deactivated</code>挂钩:</p><p id="a39d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/UserForm.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a055" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;input v-model="name" placeholder="user"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="7fc4" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "UserForm",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  },<br/>  activated() {<br/>    console.log("UserForm has been activated");<br/>  },<br/>  deactivated() {<br/>    console.log("UserForm has been deactivated");<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="4362" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">component/StudentForm.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0890" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;input v-model="name" placeholder="student"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="2b13" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "StudentForm",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  },<br/>  activated() {<br/>    console.log("StudentForm has been activated");<br/>  },<br/>  deactivated() {<br/>    console.log("StudentForm has been deactivated");<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="0b55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">component/EmployeeForm.vue</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="25e7" class="mq lc iq mh b gy mr ms l mt mu">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;input v-model="name" placeholder="employee"&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="a70e" class="mq lc iq mh b gy mv ms l mt mu">&lt;script&gt;<br/>export default {<br/>  name: "EmployeeForm",<br/>  data() {<br/>    return {<br/>      name: ""<br/>    };<br/>  },<br/>  activated() {<br/>    console.log("EmployeeForm has been activated");<br/>  },<br/>  deactivated() {<br/>    console.log("EmployeeForm has been deactivated");<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="22ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们点击<code class="fe me mf mg mh b">App.vue</code>中的按钮在表单之间切换时，我们将看到控制台日志输出记录在控制台中。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/0986f8d3bdf8b0dadeee6204f9566df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LYy6_jJWe17vv3AR"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@sharonmccutcheon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sharon McCutcheon</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7545" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="18dc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们在不同组件之间动态切换时，Vue <code class="fe me mf mg mh b">keep-alive</code>组件允许我们通过缓存来保存当前组件的状态。</p><p id="572e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也使得渲染速度更快，因为它们是缓存的。</p><h2 id="2b07" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="1514" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae kc" href="https://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">plain English . io</strong></a>上找到所有这些——关注我们的出版物并<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>