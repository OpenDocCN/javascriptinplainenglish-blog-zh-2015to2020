<html>
<head>
<title>Can I ever fully understand JavaScript coercion?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我能完全理解JavaScript强制吗？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/can-i-ever-fully-understand-javascript-coercion-a39a341a2b3a?source=collection_archive---------5-----------------------#2020-06-02">https://javascript.plainenglish.io/can-i-ever-fully-understand-javascript-coercion-a39a341a2b3a?source=collection_archive---------5-----------------------#2020-06-02</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="bbf5" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">你声称可以无缘无故避免强制！</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/396affbb456da5ff2fb4e4dec478b03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKfa8oPxdvGCzV8D-BUevA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae ks" href="https://unsplash.com/s/photos/programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kt ku kv"><p id="66af" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">你永远无法理解一切。但是，你应该努力去理解这个系统。</p><p id="8440" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">——Ryan Dahl，<a class="lt lu ep" href="https://medium.com/u/96cd9a1fb56?source=post_page-----a39a341a2b3a--------------------------------" rel="noopener" target="_blank"> <strong class="kz io"> Node.js </strong> </a>和<strong class="kz io"> Deno </strong>的创作者</p></blockquote><h1 id="1ecc" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">旧，但金！</h1><blockquote class="kt ku kv"><p id="5558" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">JavaScript是世界上最容易被误解的编程语言。</p></blockquote><p id="6391" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated"><strong class="kz io">抽象操作是基础</strong>，但这不是JavaScript机制的全部能力。如果你想了解这个系统是如何工作的，你应该看看另一组概念。深呼吸，不要被压力吓到。</p><p id="b811" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我们从简单的开始。我举几个例子，你能猜到(或者猜不到)JS强制。我们要回到2015年(ES6)-<strong class="kz io">JS重生的一年！ES6 </strong>爆出一些与强制有关的突出特点。</p><p id="9784" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">你听说过模板字符串吗？当然，你是。我在任何地方都用它。这是一个非常方便的工具，尤其是当我们把字符串和变量连接起来的时候:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f408" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">你会承认这是一个乏味的过程。如今，我们试着变酷，做下一件事:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="81be" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我一直都这样！当我使用React.js时，这是一种巨大的解脱。你有没有想过在引擎盖下发生了什么？<strong class="kz io">发生胁迫。如果你讨厌隐式强制并使用模板字符串，那就停止吧！我只是开玩笑。看，缺乏对<strong class="kz io">隐式强制</strong>的理解，你不可能成为一个熟练的开发者。</strong></p><p id="34cb" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated"><strong class="kz io">不要仅仅依靠含蓄的强制试着去理解它。</strong>你必须考虑正确的心理模型，以及当我们获取字符串<em class="ky"> str1 </em>并将其添加到数字<em class="ky">时会发生什么。</em></p><p id="e67b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">发生了什么事？它引发了另一个操作，也称为<strong class="kz io">操作符过载</strong>。如果你阅读<a class="ae ks" href="https://www.ecma-international.org/ecma-262/#sec-addition-operator-plus" rel="noopener ugc nofollow" target="_blank">规格</a>，你可以看到如果我们对字符串使用加号运算符，<a class="ae ks" href="https://www.ecma-international.org/ecma-262/#sec-addition-operator-plus-runtime-semantics-evaluation" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> ToString </em>操作将发生</a>。因此，它将对其调用<em class="ky"> ToString </em>操作，并将其转换为字符串。我们可以变得超级酷，战胜胁迫，然后做下一件事:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="0f2f" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">那是意想不到的行为。它最终会变得纤细。如果我们检查一下<a class="ae ks" href="https://www.ecma-international.org/ecma-262/#sec-array.prototype.join" rel="noopener ugc nofollow" target="_blank">规格</a>，我们会看到<em class="ky"> join() </em>首先把它变成一个字符串。这是一个很酷的功能，但我不建议使用它。如果你想更明确的使用<em class="ky"> toString </em>方法:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="2b7e" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">这里可以通过使用<em class="ky"> toString() </em>显式。这个方法将把一个数字转换成一个字符串。记住<em class="ky"> toString() </em>方法不属于原始类型。在幕后有一些强大的操作<strong class="kz io">使我们能够在原始类型</strong>上使用那些方法(后面会有更多)。但是，在这种特殊情况下，有一种方法可以避免强制- <strong class="kz io">使用基本对象</strong>。让我们看一个例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f8d5" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我吓到你了，我知道。我们稍后会解释强制，不要担心。下面这个例子大家都很熟悉:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="af2f" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">所以我们在这里模拟一个输入，它总是以字符串表示。哦不，我们有一根绳子。你预料到了吗？两个字符串连接起来，结果是<em class="ky">“34”</em>。因此，<strong class="kz io">不是一个数字运算，而是字符串连接</strong>。在这些情况下，我们可以进行显式强制，并将其强制为一个数字。</p><p id="a5fb" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我将向您展示一个迫使明确强制的绝佳技巧:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f87d" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">在字符串前使用“+”号，并强制<em class="ky">到数字</em>的抽象操作发生。很简单，不是吗？抽象操作会先把它转换成数字，然后把它作为参数传递。最终，结果将是数字，而不是字符串。如果我们给一个空字符串，它将强制为零。</p><p id="a8cd" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我们可以超显式地使用一个基本对象——<em class="ky">Number()</em>。使用fundamentals对象是大多数JS开发人员的首选方式。你可能已经想象过这种情况了，但我还是要写出来:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="befb" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">这些是我们节目中经常出现的几件事。在下一个例子中，我将展示JavaScript中最常见的实践:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="e599" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我们必须非常小心布尔运算。这里有很多死角案例。如果我们掉进陷阱，就没有回头路了。继续之前，请检查字符串是否非空。最坏的情况出现了:字符串中有大量的空白。</p><p id="a2f7" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">另一种常见的做法是检查数组的长度:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="de4d" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">人们被吸引去把一个数字强制转换成一个布尔值。我们知道这个故事。如果值为零，则返回false，否则返回true。我们在这里依赖一个非零值，它总是返回true。</p><p id="147c" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">这听起来可能很疯狂，但是如果有一个男的呢？迫不及待地想通过一个例子来测试它:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="6a58" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">系统什么也做不了。当然，这只是其中一个小案例。<strong class="kz io">不要以为我在劝你停止使用它。我只是在说优点和缺点。我鼓励你开始使用这些文档。</strong>相信我，<strong class="kz io">你的程序会变得不那么容易出错</strong>。</p><p id="e56b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">此外，腐蚀可能非常明显，但在使用时必须非常小心。你可以做这个把戏，温和的把戏来明确地说话:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="c81f" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">双重谈判会拯救世界！我在这里告诉你首先要变成布尔型，然后是其他所有的东西。</p><p id="aa66" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">您可以更明确地使用数组来:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="0b12" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated"><strong class="kz io">使用数组时，依赖强制有时会致命。</strong>此外，这比检查值是否真实更具语义性。最重要的是<strong class="kz io">角箱保护</strong>。最终，最有影响力的计划是使用基本对象。让我们看一个例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="2447" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">结论:<strong class="kz io">在与布尔人打交道时，要注意处理好拐角处的病例。请记住，空字符串的布尔值始终为假，非空字符串的布尔值始终为真。最后，尽可能明确地说出来。默默无闻不是一个选择！</strong></p><p id="cac7" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">当我们考虑原始类型时，我们可以很容易地避免一些小问题。但是，对象和类似对象的类型呢？让我们通过例子来看看:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="3f2f" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated"><strong class="kz io">我们有一个预期的情况。</strong> <em class="ky">未定义</em>和<em class="ky">空</em>正如预期的一样是错误的，但是一个物体呢？物体会把事情弄得一团糟，所以我们必须非常小心。有一种方法可以避免不便。我将展示一种检查对象的常见方法:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="5451" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">结论:<strong class="kz io">使用布尔型隐性胁迫是一种较好的做法。有些角落的情况你必须牢记在心。有时常识不是最好的思维模式，尝试像JavaScript这样的东西，你就会成为熟练的JS开发人员。</strong></p><h1 id="9f7a" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">额外收获:拳击如何节省我们的日常时间？</h1><p id="97aa" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mn mu li lj mo mv lm ln mp mw lq lr ls ig bi translated">你可能已经忘记了，我承诺解释原始值是如何访问方法的。好吧，现在是时候了。</p><p id="9a4a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">让我们热身，从一个例子开始:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="2ca8" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">它是如何工作的？我们怎么能进入<em class="ky">。长度</em>属性上的一个原始值？正如你所猜测的，复杂的逻辑发生在场景背后。我们对这个过程有一个奇特的名字- <strong class="kz io">拳击</strong>。</p><p id="82e9" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated"><strong class="kz io">一种隐性的强制。</strong>可以说，它与抽象运算相似，但它们的唤起方式不同。JavaScript决定提供帮助，让我们能够使用像对象类型这样的基本类型。JavaScript将为我们制造一个物体，多么友好的手势。</p><p id="5f23" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">这是一个很好的特性，最终，<strong class="kz io"> JS是一种动态语言</strong>，不像Java或C#那样，你必须先将一个原语转换成一个对象类型，然后再进行其他操作。</p><p id="2ae0" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">历史上的一件趣事。这就是JS中的一切都是对象这一概念的来源。一个大多数高级开发者失败的地方。<strong class="kz io">事物可以表现得像一个物体，但这并不使它们成为物体。</strong></p><p id="5081" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">我希望你找到了正确的心智模式。我试图拉近这个故事(以及之前的故事)并解释一些概念。从更大的意义上来说，<strong class="kz io">你不能‘逃离’胁迫</strong>，你也不需要这么做。所有编程语言都有强制，这是很自然的事情。</p><p id="aed1" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mn lh li lj mo ll lm ln mp lp lq lr ls ig bi translated">结论:【JavaScript有两种方式。当试图访问基元值的属性时，要么实现装箱(boxing ),要么抛出错误。</p><h2 id="b5ff" class="mx lw in bd lx my mz dn mb na nb dp mf mn nc nd mh mo ne nf mj mp ng nh ml ni bi translated"><strong class="ak">用简单英语写的便条</strong></h2><p id="3585" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mn mu li lj mo mv lm ln mp mw lq lr ls ig bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz io">plain English . io</strong></a>找到所有这些内容——关注我们的出版物并<a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io">订阅我们的YouTube频道</strong> </a> <strong class="kz io">来表达你的爱吧！</strong></p></div></div>    
</body>
</html>