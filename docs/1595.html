<html>
<head>
<title>How Hoisting Works With ‘let’ and ‘const’ in Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Javascript中提升如何与“let”和“const”一起工作</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-hoisting-works-with-let-and-const-in-javascript-725616df7085?source=collection_archive---------2-----------------------#2020-04-05">https://javascript.plainenglish.io/how-hoisting-works-with-let-and-const-in-javascript-725616df7085?source=collection_archive---------2-----------------------#2020-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e007" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">频繁采访的概念</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cce7f82dd9aac9cf981ab8cda5a6b8d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MzY7bLSiKsux7ha9GJLHiw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@lanceanderson?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Lance Anderson</a> on <a class="ae kv" href="https://unsplash.com/s/photos/crane?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="a058" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">术语“提升”令人困惑</h1><p id="7506" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我相信人们难以理解<em class="mk">提升</em>的首要原因之一是因为这个术语本身有些误导。在韦氏词典，单词“提升”的定义是“提升或举起的动作”。</p><p id="e682" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">这可能会让人认为提升涉及到以某种方式对书面代码进行物理重组。这不是真的。</p><p id="5125" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">相反，术语<em class="mk">提升</em>被用作一种比喻来描述JavaScript引擎解释编写的JavaScript代码时发生的过程。</p><h1 id="0a10" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">JavaScript代码是如何解释的？</h1><p id="0022" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">所有编写的JavaScript都在编写它的<strong class="lq ir">执行上下文</strong>中解释。当您打开文本编辑器并创建一个新的JavaScript文件时，您会创建一个所谓的<strong class="lq ir">全局执行上下文</strong>。</p><p id="16f3" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">JavaScript引擎分两个阶段解释在这个全局执行上下文中编写的JavaScript；<strong class="lq ir">编译</strong>和<strong class="lq ir">执行</strong>。</p><h2 id="ed3c" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">汇编</h2><p id="88a2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在编译阶段，JavaScript解析编写的代码，寻找所有的函数或变量声明。这包括:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="676d" class="mq kx iq nd b gy nh ni l nj nk">-let<br/>-const<br/>-class<br/>-var<br/>-function</span></pre><p id="b057" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">当编译这些关键字时，JavaScript在内存中为它遇到的每个声明的变量创建一个唯一的空间。这个“提升”变量并在内存中给它一个空间的过程叫做提升。</p><p id="45ac" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">通常，提升被描述为将<em class="mk">变量</em>和<em class="mk">函数</em>声明<em class="mk"> </em>移动到它们(全局或函数)作用域的顶部。</p><p id="4f1f" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">然而，变量<strong class="lq ir">根本不移动<strong class="lq ir"/>。</strong></p><p id="9fbf" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">实际发生的情况是，在编译阶段，声明的变量和函数在其他代码被读取之前被存储在内存中，因此产生了“移动”到它们的作用域顶部的错觉。</p><h2 id="2769" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">执行</h2><p id="9e39" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在第一阶段完成并且所有声明的变量都被提升之后，第二阶段开始；执行。解释器返回到代码的第一行，再次向下工作，这一次分配变量值和处理函数。</p><h1 id="f2b3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">变量是用let和const来声明的吗？</h1><p id="8083" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">是的，用let和const声明的变量被提升。它们与提升过程中其他声明的不同之处在于它们的初始化。</p><p id="eec0" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在编译阶段，用<code class="fe nl nm nn nd b">var</code>和<code class="fe nl nm nn nd b">function</code>声明的JavaScript变量被提升并自动初始化为<code class="fe nl nm nn nd b">undefined</code>。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="64a1" class="mq kx iq nd b gy nh ni l nj nk">console.log(name) // undefined<br/>var name = "Andrew";</span></pre><p id="7e57" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在上面的例子中，JavaScript首先运行它的编译阶段并寻找变量声明。它遇到<code class="fe nl nm nn nd b">var name</code>，提升那个变量并自动给它赋值<code class="fe nl nm nn nd b">undefined</code>。</p><p id="6a15" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">相反，用<code class="fe nl nm nn nd b">let</code>、<code class="fe nl nm nn nd b">const</code>和<code class="fe nl nm nn nd b">class</code>声明的变量被提升，但仍未初始化:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="3535" class="mq kx iq nd b gy nh ni l nj nk">console.log(name); // Uncaught ReferenceError: name is not defined<br/>let name = "Andrew";</span></pre><p id="298c" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">这些变量声明只有在运行时被求值时才会被初始化。这些变量被声明和被评估之间的时间被称为<strong class="lq ir">时间死区</strong>。如果您试图在这个死区内访问这些变量，您将得到上面的引用错误。</p><p id="b411" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">浏览第二个例子，JavaScript运行其编译阶段并看到<code class="fe nl nm nn nd b">let name</code>，提升该变量，但不初始化它。接下来，在执行阶段，调用<code class="fe nl nm nn nd b">console.log()</code>并传递参数<code class="fe nl nm nn nd b">name</code>。</p><p id="24ce" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">因为变量还没有初始化，所以还没有赋值，因此返回参考错误，说明<code class="fe nl nm nn nd b">name</code>没有定义。</p><h1 id="02e0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">哪里可以引用<code class="fe nl nm nn nd b">let</code>和<code class="fe nl nm nn nd b">const</code>？</h1><p id="8eab" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">同样，用<code class="fe nl nm nn nd b">let</code>和<code class="fe nl nm nn nd b">const</code>声明的变量只有在JavaScript引擎在运行时评估它们的赋值(也称为词法绑定)时才会被初始化。</p><p id="dcd5" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在代码中引用声明上方的<code class="fe nl nm nn nd b">let</code>和<code class="fe nl nm nn nd b">const</code>变量不是错误，只要代码没有在声明之前执行。</p><p id="ab7a" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">例如，以下代码运行良好:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="86aa" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">但是，这将导致引用错误:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="ccf8" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">正如我希望你在这一点上理解的那样，产生这个错误是因为在变量<code class="fe nl nm nn nd b">name</code>被声明之前<code class="fe nl nm nn nd b">greetings()</code>被执行了。</p><h2 id="0660" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="8ef2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到submissions@javascriptinplainenglish.com<a class="ae kv" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">给我们，我们会把你添加为作者。</a></p></div></div>    
</body>
</html>