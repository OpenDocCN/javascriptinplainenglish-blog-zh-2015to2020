<html>
<head>
<title>Object-Oriented JavaScript — Proxies, Functions, and Built-in Objects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向对象的JavaScript —代理、函数和内置对象</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/object-oriented-javascript-proxies-functions-and-built-in-objects-eece7e0ccaee?source=collection_archive---------17-----------------------#2020-11-20">https://javascript.plainenglish.io/object-oriented-javascript-proxies-functions-and-built-in-objects-eece7e0ccaee?source=collection_archive---------17-----------------------#2020-11-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/54525dcc5caec84936b4a7c3cf22f477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V4v7sjI51saAsXA0"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@wbayreuther?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">William Bayreuther</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3a00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript部分是面向对象的语言。</p><p id="7b04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要学习JavaScript，我们必须学习JavaScript的面向对象部分。</p><p id="6eb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究带有代理和内置浏览器对象的JavaScript元编程。</p><h1 id="0632" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">代理和函数陷阱</h1><p id="679e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">get</code>和<code class="fe me mf mg mh b">apply</code>操作拦截函数调用。</p><p id="ab0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码来创建一个处理程序:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a9a4" class="mq lc iq mh b gy mr ms l mt mu">const person = {<br/>  name: "james",<br/>  foo(text) {<br/>    console.log(text);<br/>  }<br/>}</span><span id="0bbc" class="mq lc iq mh b gy mv ms l mt mu">const proxy = new Proxy(person, {<br/>  get(target, propKey, receiver) {<br/>    const propValue = target[propKey];<br/>    if (typeof propValue !== "function") {<br/>      return propValue;<br/>    } else {<br/>      return function(...args) {        <br/>        return propValue.apply(target, args);<br/>      }<br/>    }<br/>  }<br/>});</span><span id="ad74" class="mq lc iq mh b gy mv ms l mt mu">proxy.foo('james')</span></pre><p id="dd64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有用<code class="fe me mf mg mh b">get</code>方法控制的<code class="fe me mf mg mh b">person</code>对象。</p><p id="c067" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">target</code>是我们控制的对象。</p><p id="61b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本例中，它是<code class="fe me mf mg mh b">person</code>对象。</p><p id="32ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">propKey</code>是属性键。</p><p id="43e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们检查属性是否是一个函数。</p><p id="22dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果不是，我们返回它的任何值。</p><p id="d41c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们调用带有参数的<code class="fe me mf mg mh b">this</code>为<code class="fe me mf mg mh b">target</code>的函数。</p><p id="4a80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们返回结果。</p><h1 id="9620" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">浏览器环境</h1><p id="9129" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">浏览器环境由JavaScript控制。</p><p id="cdb4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它是JavaScript程序的天然宿主。</p><h1 id="45d4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在HTML页面中包含JavaScript</h1><p id="dc62" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用Script标签在HTML页面中包含JavaScript。</p><p id="1d1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e672" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE&gt;<br/>&lt;html&gt;</span><span id="2b39" class="mq lc iq mh b gy mv ms l mt mu">&lt;head&gt;<br/>    &lt;title&gt;app&lt;/title&gt;<br/>    &lt;script src="script.js"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;</span><span id="6fc6" class="mq lc iq mh b gy mv ms l mt mu">  &lt;body&gt;<br/>    &lt;script&gt;<br/>      let a = 1;<br/>      a++;<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;</span><span id="0224" class="mq lc iq mh b gy mv ms l mt mu">&lt;/html&gt;</span></pre><p id="cb48" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个将<code class="fe me mf mg mh b">src</code>设置为<code class="fe me mf mg mh b">script.js</code>的脚本标签。</p><p id="fc38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还有一个内嵌的脚本，里面有JavaScript代码。</p><h1 id="925c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">BOM和DOM</h1><p id="77ec" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">页面上的JavaScript代码可以访问各种对象。</p><p id="7873" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们包括核心ECMAScript对象，如<code class="fe me mf mg mh b">Array</code>、<code class="fe me mf mg mh b">Object</code>等。</p><p id="631a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">DOM是与当前页面相关的对象。</p><p id="5409" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">BOM有处理页面之外的所有东西的对象，比如浏览器窗口和桌面屏幕。</p><p id="9f7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">DOM在各种W3C规范中被标准化。</p><p id="e2d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是BOM没有任何标准。</p><h1 id="5967" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">月初（beginning of month的缩写）</h1><p id="4fa9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">BOM是对象的集合，它让我们可以访问浏览器和计算机屏幕。</p><p id="321a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些对象可通过全局<code class="fe me mf mg mh b">window</code>对象访问。</p><h1 id="23a1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">窗口对象</h1><p id="46d6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">window</code>对象是浏览器环境提供的全局对象。</p><p id="5134" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以通过编写以下代码来添加一个全局变量:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a535" class="mq lc iq mh b gy mr ms l mt mu">window.foo = 1;</span></pre><p id="e99f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">foo</code>就是1。</p><p id="7d74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一些核心JavaScript函数是<code class="fe me mf mg mh b">window</code>对象的一部分。</p><p id="8f22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3e54" class="mq lc iq mh b gy mr ms l mt mu">parseInt('123');</span></pre><p id="2c35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到123。</p><p id="7e66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它与以下内容相同:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="700f" class="mq lc iq mh b gy mr ms l mt mu">window.parseInt('123');</span></pre><p id="9144" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些可能因浏览器而异，但它们在所有主流浏览器上都得到了一致和可靠的实现。</p><h1 id="43f7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">window.navigator属性</h1><p id="4372" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">属性有一些关于浏览器及其功能的信息。</p><p id="d348" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个是<code class="fe me mf mg mh b">navigator.userAgent</code>属性。</p><p id="1650" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="48bb" class="mq lc iq mh b gy mr ms l mt mu">window.navigator.userAgent</span></pre><p id="afb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到用户代理字符串。</p><p id="cd63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可能会得到这样的字符串:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7c2e" class="mq lc iq mh b gy mr ms l mt mu">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Edg/84.0.522.52"</span></pre><p id="5da0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回来了。</p><p id="e861" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用它来检查哪个浏览器。</p><p id="558c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f413" class="mq lc iq mh b gy mr ms l mt mu">if (navigator.userAgent.indexOf('MSIE') !== -1) {<br/>  //...<br/>} else {<br/>  //...<br/>}</span></pre><p id="acc2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查脚本是否在Internet Explorer中运行。</p><p id="e7cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是这是一种检查浏览器功能的糟糕方法，因为用户代理可能被欺骗。</p><p id="9d72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需直接检查所需功能:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="04e0" class="mq lc iq mh b gy mr ms l mt mu">if (typeof window.addEventListener === 'function') {<br/>  // ...<br/>} else {<br/>  // ...<br/>}</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/bcebf3c78a7615101eceafc6e3dc133c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pEQKPUZFDcXvONvi"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@randyfath?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Randy Fath</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5b5f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c7fd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">浏览器有各种我们可以使用的内置对象。</p><p id="4687" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使用代理来控制函数。</p><p id="60f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码得到更多类似内容，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>