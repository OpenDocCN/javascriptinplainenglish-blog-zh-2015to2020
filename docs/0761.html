<html>
<head>
<title>Scoped CSS made easy with Shadow DOM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用影子DOM使作用域CSS变得容易</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/scoping-css-easy-with-shadow-dom-991a1fc568b9?source=collection_archive---------6-----------------------#2019-12-06">https://javascript.plainenglish.io/scoping-css-easy-with-shadow-dom-991a1fc568b9?source=collection_archive---------6-----------------------#2019-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a1d760ef32188cc47246bd023b28766a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ch3ONOcE_qMChYiaZV3ZFw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@grakozy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Greg Rakozy</a> on <a class="ae kc" href="https://unsplash.com/s/photos/css?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bda4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你有没有遇到过将你的CSS隔离到某个区域的问题？你有没有试过把CSS应用到你页面的一部分，但是那个该死的东西就是不在一个盒子里(div)？</p><p id="18ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嗯，我也在这个问题上卡住了，但是阴影DOM帮助了我。</p><p id="897f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">TLDR:如果你不想看完整个故事，可以在下面用shadow DOM找到最终的应用。</p><div class="lb lc gp gr ld le"><a href="https://github.com/marrej/shadowDOMexamples" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">marrej/shadow DOM示例</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div><p id="7cd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给你一点背景知识，我一直在尝试用我的定制web组件更新一个页面。web组件有自己的样式表，如果您将CSS文件放在HTML文件中，它将覆盖文件中已经存在的CSS。</p><div class="lb lc gp gr ld le"><a href="https://www.datadriveninvestor.com/2019/02/21/best-coding-languages-to-learn-in-2019/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">2019年最值得学习的编码语言|数据驱动的投资者</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">在我读大学的那几年，我跳过了很多次夜游去学习Java，希望有一天它能帮助我在…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.datadriveninvestor.com</p></div></div><div class="ln l"><div class="lt l lp lq lr ln ls jw le"/></div></div></a></div><p id="3108" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过一段时间的搜索，我偶然发现了影子DOM。一种将你的DOM分成更有意义的部分的技术，通过在你的DOM(轻DOM)树中创建阴影根并在其中附加阴影树。</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/fcd4d24772d5d1f399141fa1e3bcd4f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vTDsFwQJ-6TqPLRC1bgVw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" rel="noopener ugc nofollow" target="_blank">https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM</a></figcaption></figure><p id="58cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想了解更多关于shadow DOM的知识，我建议你去<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" rel="noopener ugc nofollow" target="_blank"> Mozilla </a>。</p><p id="25e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，让我们开始编码练习。</p><p id="1187" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从填充段落的空白html开始，并将段落背景涂成红色。</p><figure class="lv lw lx ly gt jr"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="f0d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码了一段时间后，我们决定我们的一些段落应该是<strong class="kf ir">绿色</strong>，而不增加一个类。(这是一个愚蠢的练习，但是请原谅我，:D)但是我们该怎么做呢？</p><p id="049a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从添加新段落开始，只是为了看到该段落将有一个红色的背景。</p><figure class="lv lw lx ly gt jr"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="e26a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们定义一个自定义元素名(比如我们的-custom-element)并将其推入我们的Light DOM(这基本上意味着在html中创建<our-custom-element>，因为Light DOM只是描述我们实际DOM的另一种方式)。</our-custom-element></p><p id="9102" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们需要添加JavaScript片段来调用<strong class="kf ir"> customElements.define() </strong>来定义我们的HTML元素，并以编程方式传入属性。</p><p id="11a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们要做的是扩展HTMLElement类，并在构造函数中使用<strong class="kf ir"> super() </strong>初始化它。(因为我们希望在自定义元素中保留基本的<strong class="kf ir"> HTMLElement </strong>属性)</p><figure class="lv lw lx ly gt jr"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="ad05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以使用<strong class="kf ir"> createElement() </strong>来定义新元素，这些新元素将被附加到<strong class="kf ir"> our-custom-element </strong>上，比如一个<strong class="kf ir"> DIV </strong>。此外，我们可以用段落的HTML填充DIV，将其移动到自定义元素的范围内。</p><figure class="lv lw lx ly gt jr"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="9195" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后将<strong class="kf ir">影子根</strong>附加到实际的<strong class="kf ir">html element(our-custom-element)</strong>，并为其追加子元素，比如我们的<strong class="kf ir"> DIV </strong>。</p><figure class="lv lw lx ly gt jr"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="03a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此时，段落应该缺少了<strong class="kf ir">红色背景</strong>。</p><p id="3c3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太好了！:D</p><p id="4306" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们刚刚在shadowDOM中隔离了我们的自定义元素，正如你所看到的，我们的主应用程序的CSS并没有漏入其中。</p><p id="eb3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，如果我们想在自定义元素中包含样式，我们只需要创建元素<strong class="kf ir"> &lt;样式&gt; </strong>(就像我们对div做的那样)，这将是我们的CSS载体。然后我们只需添加style.textContent，这就是实际的CSS。</p><figure class="lv lw lx ly gt jr"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="768e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于样式将连接到shadowRoot，您应该会在customElement段落下面看到一个绿色背景。</p><blockquote class="mb"><p id="a034" class="mc md iq bd me mf mg mh mi mj mk la dk translated">瞧啊。简单有效。</p></blockquote><p id="de84" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">因此</p><p id="31bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们假设您已经准备好了一个webComponent。如何监听它发出的事件？只需在查询后将事件侦听器附加到元素上。您可以在自定义元素定义中直接附加侦听器，或者尝试从外部获取元素，但是首先您需要查询附加了shadowRoot的元素，然后获取shadowRoot并在shadowDOM中导航。</p><p id="dae0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在这里查看整个解决方案</p><div class="lb lc gp gr ld le"><a href="https://github.com/marrej/shadowDOMexamples" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">marrej/shadow DOM示例</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div></div></div>    
</body>
</html>