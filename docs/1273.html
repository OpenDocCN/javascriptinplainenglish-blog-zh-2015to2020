<html>
<head>
<title>How to Read a CSV File in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中读取CSV文件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-read-a-csv-file-in-node-js-305b94e75024?source=collection_archive---------2-----------------------#2020-02-23">https://javascript.plainenglish.io/how-to-read-a-csv-file-in-node-js-305b94e75024?source=collection_archive---------2-----------------------#2020-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="af49" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">文件阅读技巧</h2><div class=""/><div class=""><h2 id="f912" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">并使用带有Object.assign()的类来存储数据</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/32de156755862f5a8ee5a06066ad0009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WeuR9OoKyD5EvtT9KjXOA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@mbaumi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Mika Baumeister</a> on <a class="ae le" href="https://unsplash.com/s/photos/numbers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2404" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated">在一篇<a class="ae le" href="https://medium.com/javascript-in-plain-english/how-to-read-an-excel-file-in-node-js-6e669e9a3ce1" rel="noopener">的前一篇文章</a>中，我展示了阅读Excel工作簿数据是多么容易。在本文中，我们将扩展从文件中读取数据的概念。在这种情况下，是一个结构化的逗号分隔值文件。数据将以json对象数组的形式接收。</p><p id="bbd2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将允许我们探索如何使用JavaScript <strong class="lh ja">类</strong>和<strong class="lh ja"> Object.assign() </strong>来创建Employee对象的数组，这将比json对象本身更容易操作。</p><h1 id="299f" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">读取文件</h1><h2 id="dfa1" class="nc ml iq bd mm nd ne dn mq nf ng dp mu lo nh ni mw ls nj nk my lw nl nm na iw bi translated">设置</h2><p id="8139" class="pw-post-body-paragraph lf lg iq lh b li nn ka lk ll no kd ln lo np lq lr ls nq lu lv lw nr ly lz ma ij bi translated">您将需要安装<a class="ae le" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">node . js</a>。</p><p id="0b28" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">创建下面的csv文件，并将其命名为<strong class="lh ja"> Data.csv. </strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/a5acb1029c7e1f2a40af4a99c5dafb34.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*Y1mG3ATAOB9Q26TlDHjaBA.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Comma Separated Data</figcaption></figure><p id="e1d8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">我将使用</strong> <a class="ae le" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja"> Visual Studio代码</strong> </a> <strong class="lh ja"> (VSCode)。</strong></p><ol class=""><li id="ea51" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma ny nz oa ob bi translated">创建package.json，将<strong class="lh ja"> index.js </strong>作为默认文件，</li></ol><pre class="kp kq kr ks gt oc od oe of aw og bi"><span id="93ad" class="nc ml iq od b gy oh oi l oj ok">npm init -y</span></pre><p id="beb2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">2.要安装我们需要的npm包，请在您的终端窗口中键入，</p><pre class="kp kq kr ks gt oc od oe of aw og bi"><span id="e070" class="nc ml iq od b gy oh oi l oj ok">npm i csvtojson</span></pre><p id="7f7e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">3.创建一个名为<strong class="lh ja"> index.js </strong>的文件，并在编辑器中打开它。</p><h2 id="3643" class="nc ml iq bd mm nd ne dn mq nf ng dp mu lo nh ni mw ls nj nk my lw nl nm na iw bi translated">读取CSV文件并获取Json对象数组</h2><p id="a46d" class="pw-post-body-paragraph lf lg iq lh b li nn ka lk ll no kd ln lo np lq lr ls nq lu lv lw nr ly lz ma ij bi translated">将以下代码添加到您的<strong class="lh ja"> index.js </strong>文件中。</p><p id="7922" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">调用csv()返回一个承诺。</strong></p><pre class="kp kq kr ks gt oc od oe of aw og bi"><span id="e469" class="nc ml iq od b gy oh oi l oj ok">const csv=require('csvtojson')</span><span id="200b" class="nc ml iq od b gy ol oi l oj ok">// Invoking csv returns a promise<br/>const converter=csv()<br/>.fromFile('./Data.csv')<br/>.then((json)=&gt;{<br/>    console.log(json);<br/>})</span></pre><p id="bb7c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">使用<strong class="lh ja"> CTRL+F5 </strong>运行，无需调试。您应该会看到一组结构良好的json对象。你也可以使用console.table() 。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi on"><img src="../Images/d5ddfe18ec6c5facddc975583dfd9cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*bWFaf756LXTfdi4M4VKiUA.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Array of json Objects</figcaption></figure><h1 id="3c16" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">处理数据</h1><p id="238a" class="pw-post-body-paragraph lf lg iq lh b li nn ka lk ll no kd ln lo np lq lr ls nq lu lv lw nr ly lz ma ij bi translated">我希望数据采用我认为更容易使用的数据结构。JavaScript类。由于数据是json对象的数组，我们将创建一个名为<strong class="lh ja"> Employee </strong>的<strong class="lh ja">类</strong>。使用<strong class="lh ja"> Object.assign() </strong>将每个json对象分配给一个Employee对象，并将它们存储在一个名为emp[]的Employee对象数组中。</p><p id="05af" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这样，我们就可以使用Employee类的getter方法来获取我们想要处理的任何数据。</p><h2 id="ad35" class="nc ml iq bd mm nd ne dn mq nf ng dp mu lo nh ni mw ls nj nk my lw nl nm na iw bi translated">创建雇员类</h2><p id="5ac1" class="pw-post-body-paragraph lf lg iq lh b li nn ka lk ll no kd ln lo np lq lr ls nq lu lv lw nr ly lz ma ij bi translated">在<strong class="lh ja"> index.js </strong>的顶部，添加下面的类和数组。</p><pre class="kp kq kr ks gt oc od oe of aw og bi"><span id="72e7" class="nc ml iq od b gy oh oi l oj ok">class Employee{<br/>    set Name(Name){<br/>        this._Name=Name;<br/>    }<br/>    set Title(Title){<br/>        this._Title=Title;<br/>    }<br/>    set Salary(Salary){<br/>        this._Salary=Salary;<br/>    }<br/>    get Name(){<br/>        return this._Name;<br/>    }<br/>    get Title(){<br/>        return this._Title;<br/>    }<br/>    get Salary(){<br/>        return this._Salary;<br/>    }<br/>    constructor(){<br/>    }</span><span id="97a5" class="nc ml iq od b gy ol oi l oj ok">}<br/>let emp=[];// Array to store Employee Objects</span></pre><p id="55de" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将创建新的Employee对象，并将它们推送到第一个<em class="om">中的数组中。承诺的then()处理程序。</em></p><p id="4d9d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将用另一个<em class="om">来链接它。然后()</em>通过调用<strong class="lh ja"> Name getter方法</strong>来显示雇员数组中每个雇员的名字。</p><p id="e299" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然而，此时我们可以访问任何我们想要的数据。</p><p id="f8a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如下修改csv()的<strong class="lh ja"> index.js </strong>调用，并使用<strong class="lh ja"> CTRL+F5运行。</strong></p><pre class="kp kq kr ks gt oc od oe of aw og bi"><span id="ba0c" class="nc ml iq od b gy oh oi l oj ok">// Invoking csv returns a promise<br/>const converter=csv()<br/>.fromFile('./Data.csv')<br/>.then((json)=&gt;{<br/>    let e;// Will be an Employee Object<br/>    json.forEach((row)=&gt;{<br/>        e=new Employee();// New Employee Object<br/>        Object.assign(e,row);// Assign json to the new Employee<br/>        emp.push(e);// Add the Employee to the Array<br/>        <br/>    });</span><span id="4510" class="nc ml iq od b gy ol oi l oj ok">}).then(()=&gt;{<br/>    // Output the names of the Employees<br/>    emp.forEach((em)=&gt;{<br/>        console.log(em.Name);// Invoke the Name getter<br/>    });<br/>});</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/79396787496c39dd3cbdcdefc385f68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*djaGDNF63T2M324EP5spJQ.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Outputting the Names from the Array of Employees</figcaption></figure><p id="66c3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">完整的代码如下。</p><pre class="kp kq kr ks gt oc od oe of aw og bi"><span id="9f46" class="nc ml iq od b gy oh oi l oj ok">class Employee{<br/>    set Name(Name){<br/>        this._Name=Name;<br/>    }<br/>    set Title(Title){<br/>        this._Title=Title;<br/>    }<br/>    set Salary(Salary){<br/>        this._Salary=Salary;<br/>    }<br/>    get Name(){<br/>        return this._Name;<br/>    }<br/>    get Title(){<br/>        return this._Title;<br/>    }<br/>    get Salary(){<br/>        return this._Salary;<br/>    }<br/>    constructor(){<br/>    }</span><span id="f56a" class="nc ml iq od b gy ol oi l oj ok">}<br/>let emp=[];// Array to store Employee Objects</span><span id="9d46" class="nc ml iq od b gy ol oi l oj ok">const csv=require('csvtojson')<br/>// Invoking csv returns a promise<br/>const converter=csv()<br/>.fromFile('./Data.csv')<br/>.then((json)=&gt;{<br/>    let e;<br/>    json.forEach((row)=&gt;{<br/>        e=new Employee();// New Employee Object<br/>        Object.assign(e,row);// Assign json to the new Employee<br/>        emp.push(e);// Add the Employee to the Array<br/>        <br/>    });</span><span id="c950" class="nc ml iq od b gy ol oi l oj ok">}).then(()=&gt;{<br/>    // Output the names of the Employees<br/>    emp.forEach((em)=&gt;{<br/>        console.log(em.Name);// Invoke the Name getter<br/>    });<br/>});</span></pre><h1 id="e437" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">结论</h1><p id="7ae1" class="pw-post-body-paragraph lf lg iq lh b li nn ka lk ll no kd ln lo np lq lr ls nq lu lv lw nr ly lz ma ij bi translated">实际上有相当多的npm包用于处理文件。我选择了这个，因为我想获得json数据。这反过来允许我们探索使用<strong class="lh ja">类</strong>和<strong class="lh ja"> Object.assign() </strong>。</p><p id="8058" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">关于封装<strong class="lh ja"> csvtojson </strong>的更多信息和选项可在下面找到。</p><ul class=""><li id="e920" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma op nz oa ob bi translated"><a class="ae le" href="https://www.npmjs.com/package/csvtojson" rel="noopener ugc nofollow" target="_blank"> csvtojson </a></li></ul><p id="d7b7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">关于类和Object.assign()的更多信息可以在下面以及后面的文章中找到。</p><ul class=""><li id="f193" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma op nz oa ob bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes" rel="noopener ugc nofollow" target="_blank">类</a></li><li id="6c94" class="nt nu iq lh b li oq ll or lo os ls ot lw ou ma op nz oa ob bi translated"><a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" rel="noopener ugc nofollow" target="_blank"> Object.assign() </a></li></ul><p id="1332" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">感谢您的阅读和快乐编码！</strong></p><p id="b1be" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在Medium上阅读所有你想要的文章，并以每月5美元的价格成为Medium会员，帮助我继续写作。</p><div class="ov ow gp gr ox oy"><a href="https://bobtomlin-70659.medium.com/membership" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ja gy z fp pd fr fs pe fu fw iz bi translated">通过我的推荐链接加入灵媒——重力井(罗伯·汤姆林)</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">bobtomlin-70659.medium.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm ky oy"/></div></div></a></div><p id="0ee6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你也可以享受，</p><div class="ov ow gp gr ox oy"><a href="https://medium.com/javascript-in-plain-english/how-to-read-an-excel-file-in-node-js-6e669e9a3ce1" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ja gy z fp pd fr fs pe fu fw iz bi translated">如何在Node.js中读取Excel文件</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">这再简单不过了</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">medium.com</p></div></div><div class="ph l"><div class="pn l pj pk pl ph pm ky oy"/></div></div></a></div><p id="484b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是JavaScript类的第一部分。在后面的部分中使用setters和getters。本文中存在到类的所有四个部分的链接。我鼓励你阅读它们。类是非常有用的数据结构。</p><div class="ov ow gp gr ox oy"><a href="https://link.medium.com/USs9sPFoyZ" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ja gy z fp pd fr fs pe fu fw iz bi translated">JavaScript类。深入的观察。第一部分。</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">我们要做什么？</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">link.medium.com</p></div></div><div class="ph l"><div class="po l pj pk pl ph pm ky oy"/></div></div></a></div><div class="ov ow gp gr ox oy"><a href="https://link.medium.com/X9rvWUZlo1" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd ja gy z fp pd fr fs pe fu fw iz bi translated">JavaScript的Object.assign()的一个实际用例</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">将一个数据库记录集对象赋给一个JavaScript类对象。然而，在其…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">link.medium.com</p></div></div><div class="ph l"><div class="pp l pj pk pl ph pm ky oy"/></div></div></a></div></div></div>    
</body>
</html>