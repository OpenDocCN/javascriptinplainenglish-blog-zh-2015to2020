<html>
<head>
<title>Creating custom JavaScript syntax with Babel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Babelåˆ›å»ºå®šåˆ¶çš„JavaScriptè¯­æ³•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/creating-custom-javascript-syntax-with-babel-ee76e05a6390?source=collection_archive---------5-----------------------#2019-11-29">https://javascript.plainenglish.io/creating-custom-javascript-syntax-with-babel-ee76e05a6390?source=collection_archive---------5-----------------------#2019-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c767" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç»§æˆ‘ä¸Šä¸€ç¯‡å…³äº<a class="ae kl" href="https://lihautan.com/step-by-step-guide-for-writing-a-babel-transformation" rel="noopener ugc nofollow" target="_blank">ç¼–å†™è‡ªå®šä¹‰babelè½¬æ¢</a>çš„æ–‡ç« ä¹‹åï¼Œä»Šå¤©æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨Babelåˆ›å»ºè‡ªå®šä¹‰JavaScriptè¯­æ³•ã€‚</p><h1 id="eeac" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">æ¦‚è¿°</strong></h1><p id="c28c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">è®©æˆ‘åœ¨æœ¬æ–‡ç»“å°¾å‘æ‚¨å±•ç¤ºæˆ‘ä»¬å°†å®ç°çš„ç›®æ ‡:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="3eb1" class="ly kn iq lu b gy lz ma l mb mc">// â€˜@@â€™ makes the function `foo` curried</span><span id="30b3" class="ly kn iq lu b gy md ma l mb mc">function @@ foo(a, b, c) {<br/>  return a + b + c;<br/>}</span><span id="da09" class="ly kn iq lu b gy md ma l mb mc">console.log(foo(1, 2)(3)); // 6</span></pre><p id="3665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<a class="ae kl" href="https://en.wikipedia.org/wiki/Currying" rel="noopener ugc nofollow" target="_blank">åº“é‡Œå‡½æ•°</a>è¯­æ³•<code class="fe me mf mg lu b">@@</code>ã€‚è¯­æ³•ç±»ä¼¼äº<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*" rel="noopener ugc nofollow" target="_blank">ç”Ÿæˆå™¨å‡½æ•°</a>ï¼Œé™¤äº†åœ¨<code class="fe me mf mg lu b">function</code>å…³é”®å­—å’Œå‡½æ•°åä¹‹é—´æ”¾ç½®<code class="fe me mf mg lu b">@@</code>è€Œä¸æ˜¯<code class="fe me mf mg lu b">*</code>ï¼Œä¾‹å¦‚<code class="fe me mf mg lu b">function @@ name(arg1, arge2)</code>ã€‚</p><p id="add8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æœ¬ä¾‹ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åŠŸèƒ½<code class="fe me mf mg lu b">foo</code>å¯¹<a class="ae kl" href="https://scotch.io/tutorials/javascript-functional-programming-explained-partial-application-and-currying" rel="noopener ugc nofollow" target="_blank">è¿›è¡Œå±€éƒ¨åº”ç”¨</a>ã€‚è°ƒç”¨å‚æ•°æ•°é‡å°‘äºæ‰€éœ€å‚æ•°çš„<code class="fe me mf mg lu b">foo</code>å°†è¿”å›ä¸€ä¸ªåŒ…å«å‰©ä½™å‚æ•°çš„æ–°å‡½æ•°:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="8686" class="ly kn iq lu b gy lz ma l mb mc">foo(1, 2, 3); // 6</span><span id="f951" class="ly kn iq lu b gy md ma l mb mc">const bar = foo(1, 2); // (n) =&gt; 1 + 2 + n<br/>bar(3); // 6</span></pre><blockquote class="mh mi mj"><p id="0e70" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><em class="iq">æˆ‘é€‰æ‹©</em> <code class="fe me mf mg lu b"><em class="iq">@@</em></code> <em class="iq">çš„åŸå› æ˜¯å˜é‡åä¸­ä¸èƒ½æœ‰</em> <code class="fe me mf mg lu b"><em class="iq">@</em></code> <em class="iq">ï¼Œæ‰€ä»¥</em> <code class="fe me mf mg lu b"><em class="iq">function @@foo() {}</em></code> <em class="iq">ä»ç„¶æ˜¯æœ‰æ•ˆçš„è¯­æ³•ã€‚è€Œ</em> <code class="fe me mf mg lu b"><em class="iq">@</em></code> <em class="iq">è¿™ä¸ªâ€œæ“ä½œç¬¦â€æ˜¯ç”¨äº</em> <a class="ae kl" href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841" rel="noopener"> <em class="iq">çš„è£…é¥°å‡½æ•°</em> </a> <em class="iq">ä½†æ˜¯æˆ‘æƒ³ç”¨ä¸€äº›å…¨æ–°çš„ä¸œè¥¿ï¼Œå› æ­¤</em> <code class="fe me mf mg lu b"><em class="iq">@@</em></code> <em class="iq">ã€‚</em></p></blockquote><p id="2125" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å°†:</p><ul class=""><li id="9160" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated">åˆ†å‰å·´åˆ«å¡”è§£æå™¨</li><li id="3b7d" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å·´åˆ«å¡”è½¬æ¢æ’ä»¶</li></ul><p id="e2a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¬èµ·æ¥ä¸å¯èƒ½ğŸ˜¨ï¼Ÿ</p><p id="77ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šæŒ‡å¯¼ä½ æ¯ä¸€æ­¥ã€‚å¸Œæœ›åœ¨è¿™ç¯‡æ–‡ç« ç»“æŸæ—¶ï¼Œä½ ä¼šæˆä¸ºåŒé¾„äººä¸­çš„é€šå¤©å¡”å¤§å¸ˆã€‚ğŸ¤ </p><h1 id="c874" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">å‰å·´åˆ«å¡”</strong></h1><p id="b5f8" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">å‰å¾€<a class="ae kl" href="https://github.com/babel/babel" rel="noopener ugc nofollow" target="_blank"> babelçš„Github repo </a>ï¼Œç‚¹å‡»é¡µé¢å·¦ä¸Šè§’çš„â€œåˆ†å‰â€æŒ‰é’®ã€‚</p><figure class="lp lq lr ls gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nc"><img src="../Images/10b4a29e6ee280a94d74d55907646dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGimQHt56_e5VQ5vATkKFA.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk">Forking Babel</figcaption></figure><p id="755f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœè¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡åˆ†å‰ä¸€ä¸ªæµè¡Œçš„å¼€æºé¡¹ç›®ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼ğŸ‰</p><p id="c4da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°†ä½ çš„åˆ†å‰çš„babelå…‹éš†åˆ°ä½ çš„æœ¬åœ°å·¥ä½œåŒºï¼Œç„¶å<a class="ae kl" href="https://github.com/tanhauhau/babel/blob/master/CONTRIBUTING.md#setup" rel="noopener ugc nofollow" target="_blank">è®¾ç½®å®ƒ</a>:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="af3c" class="ly kn iq lu b gy lz ma l mb mc">$ git clone <a class="ae kl" href="https://github.com/tanhauhau/babel.git" rel="noopener ugc nofollow" target="_blank">https://github.com/tanhauhau/babel.git</a></span><span id="f6b3" class="ly kn iq lu b gy md ma l mb mc"><em class="mk"># set up</em><br/>$ cd babel<br/>$ make bootstrap<br/>$ make build</span></pre><p id="f87b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŒæ—¶ï¼Œè®©æˆ‘ç®€å•åœ°å‘æ‚¨ä»‹ç»ä¸€ä¸‹å·´åˆ«å¡”çŸ¥è¯†åº“æ˜¯å¦‚ä½•ç»„ç»‡çš„ã€‚</p><p id="4b56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Babelä½¿ç”¨monorepoç»“æ„ï¼Œæ‰€æœ‰çš„åŒ…ï¼Œä¾‹å¦‚:<code class="fe me mf mg lu b">@babel/core</code>ã€<code class="fe me mf mg lu b">@babel/parser</code>ã€<code class="fe me mf mg lu b">@babel/plugin-transform-react-jsx</code>ç­‰éƒ½åœ¨<code class="fe me mf mg lu b">packages/</code>æ–‡ä»¶å¤¹ä¸­:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="706d" class="ly kn iq lu b gy lz ma l mb mc">- doc<br/>- packages<br/>  - babel-core<br/>  - babel-parser<br/>  - babel-plugin-transform-react-jsx<br/>  - ...<br/>- Gulpfile.js<br/>- Makefile<br/>- ...</span></pre><blockquote class="mh mi mj"><p id="831a" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">çäº‹:</em> </strong> <em class="iq"> Babelä½¿ç”¨</em><a class="ae kl" href="https://opensource.com/article/18/8/what-how-makefile" rel="noopener ugc nofollow" target="_blank"><em class="iq">Makefile</em></a><em class="iq">è¿›è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚å¯¹äºæ„å»ºä»»åŠ¡ï¼Œæ¯”å¦‚</em> <code class="fe me mf mg lu b"><em class="iq">make build</em></code> <em class="iq">ï¼Œå®ƒä¼šä½¿ç”¨</em><a class="ae kl" href="https://gulpjs.com" rel="noopener ugc nofollow" target="_blank"><em class="iq"/></a><em class="iq">ä½œä¸ºä»»åŠ¡è¿è¡Œå™¨ã€‚</em></p></blockquote></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h1 id="ed30" class="km kn iq bd ko kp nv kr ks kt nw kv kw kx nx kz la lb ny ld le lf nz lh li lj bi translated"><strong class="ak">ASTä»£ç è§£æé€Ÿæˆç­</strong></h1><p id="e0fe" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œå¦‚æœä½ å¯¹è§£æå™¨å’ŒæŠ½è±¡è¯­æ³•æ ‘(AST)ä¸ç†Ÿæ‚‰ï¼Œæˆ‘å¼ºçƒˆæ¨èæŸ¥çœ‹<a class="ae kl" href="https://twitter.com/vaidehijoshi" rel="noopener ugc nofollow" target="_blank"> Vaidehi Joshi </a>çš„<a class="ae kl" href="https://medium.com/basecs/leveling-up-ones-parsing-game-with-asts-d7a6fc2400ff" rel="noopener">ç”¨ASTæå‡ä½ çš„è§£ææ¸¸æˆã€‚</a></p><p id="d19f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ€»ç»“ä¸€ä¸‹ï¼Œè¿™æ˜¯babelè§£ææ‚¨çš„ä»£ç æ—¶å‘ç”Ÿçš„æƒ…å†µ:</p><ul class=""><li id="7f70" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated">ä½œä¸ºâ€œå­—ç¬¦ä¸²â€çš„ä»£ç æ˜¯ä¸€é•¿ä¸²å­—ç¬¦:<code class="fe me mf mg lu b">f</code>ã€<code class="fe me mf mg lu b">u</code>ã€<code class="fe me mf mg lu b">n</code>ã€<code class="fe me mf mg lu b">c</code>ã€<code class="fe me mf mg lu b">t</code>ã€<code class="fe me mf mg lu b">i</code>ã€<code class="fe me mf mg lu b">o</code>ã€<code class="fe me mf mg lu b">n</code>ã€<code class="fe me mf mg lu b"> </code>ã€<code class="fe me mf mg lu b">@</code>ã€<code class="fe me mf mg lu b">@</code>ã€<code class="fe me mf mg lu b">f</code>ã€â€¦</li><li id="5a06" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">ç¬¬ä¸€æ­¥å«åš<strong class="jp ir">è®°å·åŒ–</strong>ï¼Œå·´è´å°”æ‰«ææ¯ä¸ªè§’è‰²ï¼Œåˆ›å»º<em class="mk">è®°å·</em>ï¼Œåƒ<code class="fe me mf mg lu b">function</code>ã€<code class="fe me mf mg lu b">@@</code>ã€<code class="fe me mf mg lu b">foo</code>ã€<code class="fe me mf mg lu b">(</code>ã€<code class="fe me mf mg lu b">a</code>ã€â€¦</li><li id="7c66" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">ç„¶åï¼Œä»¤ç‰Œé€šè¿‡ä¸€ä¸ªè§£æå™¨è¿›è¡Œ<strong class="jp ir">è¯­æ³•åˆ†æ</strong>ï¼Œåœ¨è¿™é‡Œï¼ŒbabelåŸºäº<a class="ae kl" href="https://www.ecma-international.org/ecma-262/10.0/index.html#Title" rel="noopener ugc nofollow" target="_blank"> JavaScriptè¯­è¨€è§„èŒƒ</a>åˆ›å»ºä¸€ä¸ªASTã€‚</li></ul><p id="389e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°äº†è§£ä¸€èˆ¬çš„ç¼–è¯‘å™¨ï¼ŒRobert Nystromçš„ã€Šæ‰“é€ è§£é‡Šå™¨ã€‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><blockquote class="mh mi mj"><p id="eb24" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><em class="iq">ä¸è¦è¢«</em> <strong class="jp ir"> <em class="iq">ç¼–è¯‘å™¨</em> </strong> <em class="iq">è¿™ä¸ªè¯å“åˆ°ï¼Œå®ƒæ— éæ˜¯è§£æä½ çš„ä»£ç å¹¶ä»ä¸­ç”ŸæˆXXXã€‚XXXå¯èƒ½æ˜¯æœºå™¨ç ï¼Œè¿™æ˜¯æˆ‘ä»¬å¤§å¤šæ•°äººå¿ƒç›®ä¸­çš„ç¼–è¯‘å™¨ï¼›XXXå¯ä»¥å…¼å®¹æ—§æµè§ˆå™¨çš„JavaScriptï¼ŒBabelå°±æ˜¯è¿™ç§æƒ…å†µã€‚</em></p></blockquote><h1 id="19b9" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">æˆ‘ä»¬å®šåˆ¶çš„å·´åˆ«å¡”è§£æå™¨</strong></h1><p id="6c5e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">æˆ‘ä»¬å°†è¦å¤„ç†çš„æ–‡ä»¶å¤¹æ˜¯<code class="fe me mf mg lu b">packages/babel-parser/</code>:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="4e1b" class="ly kn iq lu b gy lz ma l mb mc">- src/<br/>  - tokenizer/<br/>  - parser/<br/>  - plugins/<br/>    - jsx/<br/>    - typescript/<br/>    - flow/<br/>  - ...<br/>- test/</span></pre><p id="f179" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å·²ç»è®¨è®ºäº†<em class="mk">æ ‡è®°åŒ–</em>å’Œ<em class="mk">è§£æ</em>ï¼Œç°åœ¨å¾ˆæ¸…æ¥šåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æ¯ä¸ªè¿›ç¨‹çš„ä»£ç ã€‚<code class="fe me mf mg lu b">plugins</code>æ–‡ä»¶å¤¹åŒ…å«æ‰©å±•åŸºæœ¬è§£æå™¨å’Œæ·»åŠ è‡ªå®šä¹‰è¯­æ³•çš„æ’ä»¶ï¼Œå¦‚<code class="fe me mf mg lu b">jsx</code>å’Œ<code class="fe me mf mg lu b">flow</code>ã€‚</p><p id="2bd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬æ¥åšä¸€ä¸ª<a class="ae kl" href="https://en.wikipedia.org/wiki/Test-driven_development" rel="noopener ugc nofollow" target="_blank">æµ‹è¯•é©±åŠ¨å¼€å‘(TDD) </a>ã€‚æˆ‘å‘ç°å®šä¹‰æµ‹è¯•ç”¨ä¾‹ç„¶åæ…¢æ…¢åœ°ç”¨æˆ‘ä»¬çš„æ–¹å¼â€œä¿®å¤â€å®ƒæ›´å®¹æ˜“ã€‚åœ¨ä¸ç†Ÿæ‚‰çš„ä»£ç åº“ä¸­å°¤å…¶å¦‚æ­¤ï¼ŒTDDå…è®¸æ‚¨â€œå®¹æ˜“åœ°â€æŒ‡å‡ºéœ€è¦æ›´æ”¹çš„ä»£ç ä½ç½®ã€‚</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="b036" class="ly kn iq lu b gy lz ma l mb mc">// filename: packages/babel-parser/test/curry-function.js</span><span id="1b33" class="ly kn iq lu b gy md ma l mb mc">import { parse } from â€˜../libâ€™;<br/>function getParser(code) {<br/>  return () =&gt; parse(code, { sourceType: â€˜moduleâ€™ });<br/>}</span><span id="96b1" class="ly kn iq lu b gy md ma l mb mc">describe(â€˜curry function syntaxâ€™, function() {<br/>  it(â€˜should parseâ€™, function() {<br/>    expect(getParser(`function @@ foo() {}`)()).toMatchSnapshot();<br/>  });<br/>});</span></pre><p id="9c50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨å¯ä»¥è¿è¡Œ<code class="fe me mf mg lu b">TEST_ONLY=babel-parser TEST_GREP=â€curry functionâ€ make test-only</code>æ¥è¿è¡Œ<code class="fe me mf mg lu b">babel-parser</code>çš„æµ‹è¯•ï¼Œå¹¶æŸ¥çœ‹æ‚¨çš„å¤±è´¥æ¡ˆä¾‹:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="633c" class="ly kn iq lu b gy lz ma l mb mc">SyntaxError: Unexpected token (1:9)</span><span id="7325" class="ly kn iq lu b gy md ma l mb mc">at Parser.raise (packages/babel-parser/src/parser/location.js:39:63)<br/>at Parser.raise [as unexpected] (packages/babel-parser/src/parser/util.js:133:16)<br/>at Parser.unexpected [as parseIdentifierName] (packages/babel-parser/src/parser/expression.js:2090:18)<br/>at Parser.parseIdentifierName [as parseIdentifier] (packages/babel-parser/src/parser/expression.js:2052:23)<br/>at Parser.parseIdentifier (packages/babel-parser/src/parser/statement.js:1096:52)</span></pre><blockquote class="mh mi mj"><p id="2c0b" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><em class="iq">å¦‚æœä½ å‘ç°æ‰«ææ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹éœ€è¦æ—¶é—´ï¼Œä½ å¯ä»¥ç›´æ¥è°ƒç”¨</em> <code class="fe me mf mg lu b"><em class="iq">jest</em></code> <em class="iq">æ¥è¿è¡Œæµ‹è¯•:</em> <code class="fe me mf mg lu b"><em class="iq">BABEL_ENV=test node_modules/.bin/jest -u packages/babel-parser/test/curry-function.js</em></code></p></blockquote><p id="be89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬çš„è§£æå™¨åœ¨ä¸åº”è¯¥å‡ºç°çš„åœ°æ–¹å‘ç°äº†2ä¸ªçœ‹ä¼¼æ— è¾œçš„<code class="fe me mf mg lu b">@</code>æ ‡è®°ã€‚</p><p id="1096" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æ€ä¹ˆçŸ¥é“ï¼Ÿè®©æˆ‘ä»¬å¯åŠ¨æ‰‹è¡¨æ¨¡å¼ï¼Œ<code class="fe me mf mg lu b">make watch</code>ï¼Œæˆ´ä¸Šæˆ‘ä»¬çš„ä¾¦æ¢å¸½ğŸ•µï¸â€ï¼Œå¼€å§‹æŒ–æ˜å§ï¼</p><p id="1a6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿½è¸ªå †æ ˆè·Ÿè¸ªï¼Œå°†æˆ‘ä»¬å¸¦åˆ°<code class="fe me mf mg lu b"><a class="ae kl" href="https://github.com/tanhauhau/babel/blob/feat/curry-function/packages/babel-parser/src/parser/expression.js#L2092" rel="noopener ugc nofollow" target="_blank">packages/babel-parser/src/parser/expression.js</a></code>ï¼Œåœ¨é‚£é‡Œå®ƒæŠ›å‡º<code class="fe me mf mg lu b">this.unexpected()</code>ã€‚</p><p id="67f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬è¡¥å……ä¸€äº›<code class="fe me mf mg lu b">console.log</code>:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="96fa" class="ly kn iq lu b gy lz ma l mb mc">// filename: packages/babel-parser/src/parser/expression.js<br/>parseIdentifierName(pos: number, liberal?: boolean): string {<br/>  if (this.match(tt.name)) {<br/>    // ...<br/>  } else {<br/>    console.log(this.state.type); // current token<br/>    console.log(this.lookahead().type); // next token<br/>    throw this.unexpected();<br/>  }<br/>}</span></pre><p id="388e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æ‚¨æ‰€è§ï¼Œä¸¤ä¸ªä»¤ç‰Œéƒ½æ˜¯<code class="fe me mf mg lu b">@</code>ä»¤ç‰Œ:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="1322" class="ly kn iq lu b gy lz ma l mb mc">TokenType {<br/>  label: '@',<br/>  // ...<br/>}</span></pre><p id="6eca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æ€ä¹ˆçŸ¥é“<code class="fe me mf mg lu b">this.state.type</code>å’Œ<code class="fe me mf mg lu b">this.lookahead().type</code>ä¼šç»™æˆ‘å½“å‰å’Œä¸‹ä¸€ä¸ªä»¤ç‰Œï¼Ÿ</p><p id="6e57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¥½å§ï¼Œæˆ‘ä»¥åä¼šè§£é‡Šçš„ã€‚</p><p id="0d02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ‰€åšçš„å·¥ä½œ:</p><ul class=""><li id="78df" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated">æˆ‘ä»¬å·²ç»ä¸º<code class="fe me mf mg lu b">babel-parser</code>ç¼–å†™äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹</li><li id="ad46" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">æˆ‘ä»¬è¿è¡Œ<code class="fe me mf mg lu b">make test-only</code>æ¥è¿è¡Œæµ‹è¯•ç”¨ä¾‹</li><li id="ccaa" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">æˆ‘ä»¬å·²ç»é€šè¿‡<code class="fe me mf mg lu b">make watch</code>å¯åŠ¨äº†è§‚çœ‹æ¨¡å¼</li><li id="67c7" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">æˆ‘ä»¬å·²ç»äº†è§£äº†è§£æå™¨çš„çŠ¶æ€ï¼Œå¹¶æ§åˆ¶å½“å‰çš„ä»¤ç‰Œç±»å‹<code class="fe me mf mg lu b">this.state.type</code></li></ul><p id="4103" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„æ˜¯:</p><p id="bc91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæœ‰ä¸¤ä¸ªè¿ç»­çš„<code class="fe me mf mg lu b">@</code>ï¼Œå®ƒä¸åº”è¯¥æ˜¯å•ç‹¬çš„ä»¤ç‰Œï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ª<code class="fe me mf mg lu b">@@</code>ä»¤ç‰Œï¼Œæˆ‘ä»¬åˆšåˆšä¸ºcurryå‡½æ•°å®šä¹‰çš„æ–°ä»¤ç‰Œ</p><p id="d1e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ–°ä»¤ç‰Œ:' @@' </strong></p><p id="2dce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»¤ç‰Œç±»å‹æ˜¯åœ¨å“ªé‡Œå®šä¹‰çš„:<a class="ae kl" href="https://github.com/tanhauhau/babel/blob/feat/curry-function/packages/babel-parser/src/tokenizer/types.js#L86" rel="noopener ugc nofollow" target="_blank">packages/babel-parser/src/tokenizer/types . js</a>ã€‚</p><p id="f800" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªä»¤ç‰Œåˆ—è¡¨ï¼Œå› æ­¤è®©æˆ‘ä»¬ä¹Ÿæ·»åŠ æ–°çš„ä»¤ç‰Œå®šä¹‰:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="c4a0" class="ly kn iq lu b gy lz ma l mb mc">// filename: packages/babel-parser/src/tokenizer/types.js<br/>export const types: { [name: string]: TokenType } = {<br/>  // ...<br/>  at: <strong class="lu ir">new</strong> TokenType(â€˜@â€™),<br/>  // add this here<br/>  atat: <strong class="lu ir">new</strong> TokenType(â€˜@@â€™),<br/>};</span></pre><p id="683a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹åœ¨<em class="mk">ä»¤ç‰ŒåŒ–</em>è¿‡ç¨‹ä¸­ä»¤ç‰Œæ˜¯åœ¨å“ªé‡Œåˆ›å»ºçš„ã€‚åœ¨<code class="fe me mf mg lu b">babel-parser/src/tokenizer</code>ä¸­å¿«é€Ÿæœç´¢<code class="fe me mf mg lu b">tt.at</code>ä¼šå°†æˆ‘ä»¬å¸¦åˆ°<a class="ae kl" href="https://github.com/tanhauhau/babel/blob/da0af5fd99a9b747370a2240df3abf2940b9649c/packages/babel-parser/src/tokenizer/index.js#L790" rel="noopener ugc nofollow" target="_blank">packages/babel-parser/src/tokenizer/index . js</a></p><blockquote class="mh mi mj"><p id="fef3" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated">å—¯ï¼Œåœ¨æ•´ä¸ªbabel-parserä¸­ï¼Œæ ‡è®°ç±»å‹æ˜¯ä½œä¸ºâ€œttâ€å¯¼å…¥çš„ã€‚</p></blockquote><p id="6d23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæœ‰å¦ä¸€ä¸ª<code class="fe me mf mg lu b">@</code>ç»§æ‰¿å½“å‰çš„<code class="fe me mf mg lu b">@</code>ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä»¤ç‰Œ<code class="fe me mf mg lu b">tt.atat</code>è€Œä¸æ˜¯<code class="fe me mf mg lu b">tt.at</code>:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="0c1b" class="ly kn iq lu b gy lz ma l mb mc">// filename: packages/babel-parser/src/tokenizer/index.js<br/>getTokenFromCode(code: number): void {<br/>  switch (code) {<br/>    // ...<br/>    case charCodes.atSign:<br/>      // if the next character is a `@`<br/>      if (this.input.charCodeAt(this.state.pos + 1) === charCodes.atSign) {<br/>        // create `tt.atat` instead<br/>        this.finishOp(tt.atat, 2);<br/>      } else {<br/>        this.finishOp(tt.at, 1);<br/>      }<br/>      return;<br/>      //...<br/>  }<br/>}</span></pre><p id="4638" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ‚¨å†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œæ‚¨å°†çœ‹åˆ°å½“å‰ä»¤ç‰Œå’Œä¸‹ä¸€ä¸ªä»¤ç‰Œéƒ½å·²æ›´æ”¹:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="0025" class="ly kn iq lu b gy lz ma l mb mc">// current token<br/>TokenType {<br/>  label: â€˜@@â€™,<br/>  // ...<br/>}</span><span id="8d0f" class="ly kn iq lu b gy md ma l mb mc">// next token<br/>TokenType {<br/>  label: â€˜nameâ€™,<br/>  // ...<br/>}</span></pre><p id="5538" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è€¶ï¼çœ‹èµ·æ¥ä¸é”™ï¼Œè®©æˆ‘ä»¬ç»§ç»­ã€‚</p><p id="03fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ–°è§£æå™¨</strong></p><p id="a014" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹AST ä¸­æ˜¯å¦‚ä½•è¡¨ç¤º<a class="ae kl" href="https://lihautan.com/babel-ast-explorer/#?eyJiYWJlbFNldHRpbmdzIjp7InZlcnNpb24iOiI3LjYuMCJ9LCJ0cmVlU2V0dGluZ3MiOnsiaGlkZUVtcHR5Ijp0cnVlLCJoaWRlTG9jYXRpb24iOnRydWUsImhpZGVUeXBlIjp0cnVlfSwiY29kZSI6ImZ1bmN0aW9uICogZm9vKCkge30ifQ==" rel="noopener ugc nofollow" target="_blank">ç”Ÿæˆå™¨å‡½æ•°çš„:</a></p><figure class="lp lq lr ls gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nc"><img src="../Images/ef46e70e4d3ebfaaf1ab28c461ba8cd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uH4a_tomeFUb2Ekkt-Z8LA.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk">AST for generator function</figcaption></figure><p id="aaa9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æ‚¨æ‰€è§ï¼Œç”Ÿæˆå™¨å‡½æ•°ç”±<code class="fe me mf mg lu b">FunctionDeclaration</code>çš„<code class="fe me mf mg lu b">generator: true </code>å±æ€§è¡¨ç¤ºã€‚</p><p id="c0b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç±»ä¼¼åœ°ï¼Œå¦‚æœå®ƒæ˜¯ä¸€ä¸ªcurryå‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ <code class="fe me mf mg lu b">FunctionDeclaratio</code>çš„ä¸€ä¸ª<code class="fe me mf mg lu b">curry: true</code>å±æ€§:</p><figure class="lp lq lr ls gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nc"><img src="../Images/9e4a9089be2dd18cf2757eb73ca7cbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9rXBne9m3QahJOtfYoX4g.png"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk">AST for curry function</figcaption></figure><p id="3c24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªè®¡åˆ’ï¼Œè®©æˆ‘ä»¬å®æ–½å®ƒã€‚</p><p id="8e46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¿«é€Ÿæœç´¢"<em class="mk"> FunctionDeclaration" </em>ï¼Œæˆ‘ä»¬ä¼šåœ¨<a class="ae kl" href="https://github.com/tanhauhau/babel/blob/da0af5fd99a9b747370a2240df3abf2940b9649c/packages/babel-parser/src/parser/statement.js#L1030" rel="noopener ugc nofollow" target="_blank">packages/babel-parser/src/parser/statement . js</a>ä¸­æ‰¾åˆ°ä¸€ä¸ªåä¸º<code class="fe me mf mg lu b">parseFunction</code>çš„å‡½æ•°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°ä¸€è¡Œè®¾ç½®äº†â€œgeneratorâ€å±æ€§ï¼Œè®©æˆ‘ä»¬å†æ·»åŠ ä¸€è¡Œ:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="5fcb" class="ly kn iq lu b gy lz ma l mb mc">// filename: packages/babel-parser/src/parser/statement.js<br/>export default class StatementParser extends ExpressionParser {<br/>  // ...<br/>  parseFunction&lt;T: N.NormalFunction&gt;(<br/>    node: T,<br/>    statement?: number = FUNC_NO_FLAGS,<br/>    isAsync?: boolean = false<br/>  ): T {<br/>    // ...<br/>    node.generator = this.eat(tt.star);<br/>    // add this line<br/>    node.curry = this.eat(tt.atat);<br/>  }<br/>}</span></pre><p id="5423" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ å†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œä½ ä¼šæƒŠå¥‡åœ°å‘ç°å®ƒç«Ÿç„¶é€šè¿‡äº†ï¼</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="cb46" class="ly kn iq lu b gy lz ma l mb mc">PASS packages/babel-parser/test/curry-function.js</span><span id="554e" class="ly kn iq lu b gy md ma l mb mc">curry function syntax<br/>âœ“ should parse (12ms)</span></pre><p id="6fbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°±è¿™æ ·ï¼Ÿæˆ‘ä»¬æ˜¯å¦‚ä½•å¥‡è¿¹èˆ¬åœ°ä¿®å¤å®ƒçš„ï¼Ÿ</p><p id="b571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å°†ç®€è¦åœ°è§£é‡Šè§£ææ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¸Œæœ›æ‚¨èƒ½ç†è§£è¿™ä¸€è¡Œä»£ç çš„å˜åŒ–ã€‚</p><p id="58d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">è§£æå¦‚ä½•å·¥ä½œ</strong></p><p id="04db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰äº†æ¥è‡ª<em class="mk">è®°å·èµ‹äºˆå™¨</em>çš„è®°å·åˆ—è¡¨ï¼Œè§£æå™¨ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°ä½¿ç”¨è®°å·å¹¶æ„é€ ASTã€‚è§£æå™¨ä½¿ç”¨è¯­è¨€è¯­æ³•è§„èŒƒæ¥å†³å®šå¦‚ä½•ä½¿ç”¨æ ‡è®°ï¼Œæ¥ä¸‹æ¥åº”è¯¥ä½¿ç”¨å“ªä¸ªæ ‡è®°ã€‚</p><p id="bb43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯­æ³•è§„èŒƒå¦‚ä¸‹æ‰€ç¤º:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="00f1" class="ly kn iq lu b gy lz ma l mb mc">...<br/>ExponentiationExpression -&gt; UnaryExpression<br/>UpdateExpression ** ExponentiationExpression<br/>MultiplicativeExpression -&gt; ExponentiationExpression<br/>MultiplicativeExpression (â€œ*â€ or â€œ/â€ or â€œ%â€) ExponentiationExpression<br/>AdditiveExpression -&gt; MultiplicativeExpression<br/>AdditiveExpression + MultiplicativeExpression<br/>AdditiveExpression - MultiplicativeExpression<br/>...</span></pre><p id="e7e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®ƒè§£é‡Šäº†æ¯ä¸ªè¡¨è¾¾å¼/è¯­å¥çš„ä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼Œ<code class="fe me mf mg lu b">AdditiveExpression</code>ç”±ä»¥ä¸‹ä¸¤è€…ä¹‹ä¸€ç»„æˆ:</p><ul class=""><li id="e32b" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated">ä¸€ä¸ª<code class="fe me mf mg lu b">MultiplicativeExpression</code>ï¼Œæˆ–è€…</li><li id="c377" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">ä¸€ä¸ª<code class="fe me mf mg lu b">AdditiveExpression</code>åè·Ÿä¸€ä¸ª<code class="fe me mf mg lu b">+</code>æ“ä½œå‘˜ä»¤ç‰Œï¼Œåè·Ÿä¸€ä¸ª<code class="fe me mf mg lu b">MultiplicativeExpression</code>ï¼Œæˆ–è€…</li><li id="1b42" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">ä¸€ä¸ª<code class="fe me mf mg lu b">AdditiveExpression</code>åè·Ÿ<code class="fe me mf mg lu b">-</code>æ“ä½œç¬¦ä»¤ç‰Œï¼Œå†åè·Ÿ<code class="fe me mf mg lu b">MultiplicativeExpression</code>ã€‚</li></ul><p id="e933" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥å¦‚æœä½ æœ‰ä¸€ä¸ªè¡¨è¾¾å¼<code class="fe me mf mg lu b">1 + 2 * 3</code>ï¼Œå®ƒä¼šåƒ:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="6b04" class="ly kn iq lu b gy lz ma l mb mc">(AdditiveExpression â€œ+â€ 1 (MultiplicativeExpression â€œ*â€ 2 3))</span></pre><p id="d717" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä»£æ›¿</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="28fd" class="ly kn iq lu b gy lz ma l mb mc">(MultiplicativeExpression â€œ*â€ (AdditiveExpression â€œ+â€ 1 2) 3)</span></pre><p id="a89f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ ¹æ®è¿™äº›è§„åˆ™ï¼Œæˆ‘ä»¬å°†å®ƒä»¬ç¿»è¯‘æˆè§£æå™¨ä»£ç :</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="da95" class="ly kn iq lu b gy lz ma l mb mc">class Parser {<br/>  // ...<br/>  parseAdditiveExpression() {<br/>    const left = this.parseMultiplicativeExpression();<br/>    // if the current token is `+` or `-`<br/>    if (this.match(tt.plus) || this.match(tt.minus)) {<br/>      const operator = this.state.type;<br/>      // move on to the next token<br/>      this.nextToken();<br/>      const right = this.parseMultiplicativeExpression();</span><span id="3787" class="ly kn iq lu b gy md ma l mb mc">      // create the node<br/>      this.finishNode(<br/>        {<br/>          operator,<br/>          left,<br/>          right,<br/>        },<br/>        'BinaryExpression'<br/>      );<br/>    } else {<br/>      // return as MultiplicativeExpression<br/>      return left;<br/>    }<br/>  }<br/>}</span></pre><p id="d32e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mk">è¿™æ˜¯ä¸€ä¸ªè™šæ„çš„ä»£ç ï¼Œè¿‡åº¦ç®€åŒ–äº†å·´åˆ«å¡”æœ‰ä»€ä¹ˆï¼Œä½†æˆ‘å¸Œæœ›ä½ èƒ½å¾—åˆ°å®ƒçš„è¦ç‚¹ã€‚</em></p><p id="60e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­£å¦‚æ‚¨åœ¨è¿™é‡Œçœ‹åˆ°çš„ï¼Œè§£æå™¨æœ¬è´¨ä¸Šæ˜¯é€’å½’çš„ï¼Œå®ƒä»æœ€ä½ä¼˜å…ˆçº§åˆ°æœ€é«˜ä¼˜å…ˆçº§çš„è¡¨è¾¾å¼/è¯­å¥ã€‚ä¾‹:<code class="fe me mf mg lu b">parseAdditiveExpression</code>è°ƒç”¨<code class="fe me mf mg lu b">parseMultiplicativeExpression</code>ï¼ŒT11åˆè°ƒç”¨<code class="fe me mf mg lu b">parseExponentiationExpression</code>ï¼ŒT12åˆè°ƒç”¨â€¦è¿™ä¸ªé€’å½’è¿‡ç¨‹è¢«ç§°ä¸º<a class="ae kl" href="https://craftinginterpreters.com/parsing-expressions.html#recursive-descent-parsing" rel="noopener ugc nofollow" target="_blank">é€’å½’ä¸‹é™è§£æ</a>ã€‚</p><p id="1537" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">è¿™.åƒï¼Œè¿™.é…ï¼Œè¿™.ä¸‹</strong></p><p id="ee7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨æˆ‘ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€äº›æ•ˆç”¨å‡½æ•°ï¼Œå¦‚<code class="fe me mf mg lu b">this.eat</code>ã€<code class="fe me mf mg lu b">this.match</code>ã€<code class="fe me mf mg lu b">this.next</code>ç­‰ã€‚è¿™äº›æ˜¯babel parserçš„å†…éƒ¨å‡½æ•°ï¼Œä½†æ˜¯å®ƒä»¬åœ¨è§£æå™¨ä¸­ä¹Ÿéå¸¸æ™®é:</p><ul class=""><li id="35af" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated"><strong class="jp ir"> this.match </strong>è¿”å›ä¸€ä¸ª<code class="fe me mf mg lu b">boolean</code>æŒ‡ç¤ºå½“å‰ä»¤ç‰Œæ˜¯å¦åŒ¹é…æ¡ä»¶</li><li id="e167" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir"> this.next </strong>å°†ä»¤ç‰Œåˆ—è¡¨å‘å‰ç§»åŠ¨ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªä»¤ç‰Œ</li><li id="c909" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir"> this.eat </strong>è¿”å›ä»€ä¹ˆ<code class="fe me mf mg lu b">this.match</code>è¿”å›ä»€ä¹ˆï¼Œå¦‚æœ<code class="fe me mf mg lu b">this.match</code>è¿”å›<code class="fe me mf mg lu b">true</code>ï¼Œå°±åš<code class="fe me mf mg lu b">this.next</code></li><li id="5d1a" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir"> this.eat </strong>é€šå¸¸ç”¨äºå¯é€‰æ“ä½œç¬¦ï¼Œå¦‚ç”Ÿæˆå™¨å‡½æ•°ä¸­çš„<code class="fe me mf mg lu b">*</code>ã€è¯­å¥æœ«å°¾çš„<code class="fe me mf mg lu b">;</code>ä»¥åŠtypescriptç±»å‹ä¸­çš„<code class="fe me mf mg lu b">?</code>ã€‚</li><li id="de59" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir"> this.lookahead </strong>è·å–ä¸‹ä¸€ä¸ªä»¤ç‰Œè€Œä¸å‘å‰ç§»åŠ¨ä»¥å¯¹å½“å‰èŠ‚ç‚¹åšå‡ºå†³å®š</li></ul><p id="129f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ‚¨å†çœ‹ä¸€ä¸‹æˆ‘ä»¬åˆšåˆšæ›´æ”¹çš„è§£æå™¨ä»£ç ï¼Œç°åœ¨æ›´å®¹æ˜“ç†è§£äº†ã€‚</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="5658" class="ly kn iq lu b gy lz ma l mb mc">// filename: packages/babel-parser/src/parser/statement.js</span><span id="e93e" class="ly kn iq lu b gy md ma l mb mc">export default class StatementParser extends ExpressionParser {<br/>  parseStatementContent(/* â€¦*/) {<br/><em class="mk">    // â€¦<br/>    // NOTE: we call match to check the current token</em><br/>    if (this.match(tt._function)) {<br/>      this.next();<br/><em class="mk">      // NOTE: function statement has a higher precendence than a generic statement<br/></em>      this.parseFunction();<br/>    }<br/>  }</span><span id="7fbf" class="ly kn iq lu b gy md ma l mb mc">  // â€¦<br/>  parseFunction(/* â€¦ */) {<br/><em class="mk">    // NOTE: we call eat to check whether the optional token exists</em><br/>  node.generator = this.eat(tt.star);<br/><em class="mk">    </em><strong class="lu ir"><em class="mk">node.curry = this.eat(tt.atat);</em></strong><br/>    node.id = this.parseFunctionId();<br/>  }<br/>}</span></pre><p id="b362" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘çŸ¥é“æˆ‘æ²¡æœ‰å¾ˆå¥½åœ°è§£é‡Šè§£æå™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»ä¸­å­¦åˆ°çš„ä¸€äº›èµ„æºï¼Œæˆ‘å¼ºçƒˆæ¨èå®ƒä»¬:</p><ul class=""><li id="2753" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated">ç½—ä¼¯ç‰¹Â·å°¼æ–¯ç‰¹ç½—å§†<a class="ae kl" href="https://twitter.com/munificentbob?lang=en" rel="noopener ugc nofollow" target="_blank">åˆ¶ä½œå£è¯‘å‘˜</a></li><li id="dc16" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">ä½æ²»äºšç†å·¥å­¦é™¢æä¾›çš„å…è´¹Udacityè¯¾ç¨‹:â€œç¼–è¯‘å™¨:ç†è®ºä¸å®è·µâ€</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="6aca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¯èƒ½ä¼šå¥½å¥‡æˆ‘æ˜¯å¦‚ä½•åœ¨Babel ASTæµè§ˆå™¨ä¸­å¯è§†åŒ–å®šåˆ¶è¯­æ³•çš„ï¼Œåœ¨é‚£é‡Œæˆ‘å‘ä½ å±•ç¤ºäº†ASTä¸­æ–°çš„â€œcurryâ€å±æ€§ã€‚</p><p id="c05c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯å› ä¸ºæˆ‘åœ¨Babel AST Explorerä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥ä¸Šä¼ æ‚¨çš„è‡ªå®šä¹‰è§£æå™¨ï¼</p><p id="92b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ‚¨è½¬åˆ°<code class="fe me mf mg lu b">packages/babel-parser/lib</code>ï¼Œæ‚¨ä¼šå‘ç°æ‚¨çš„è§£æå™¨çš„ç¼–è¯‘ç‰ˆæœ¬å’Œæºæ˜ å°„ã€‚æ‰“å¼€Babel AST Explorerçš„æŠ½å±‰ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªä¸Šä¼ è‡ªå®šä¹‰è§£æå™¨çš„æŒ‰é’®ã€‚æ‹–åŠ¨<code class="fe me mf mg lu b">packages/babel-parser/lib/index.js</code>,æ‚¨å°†çœ‹åˆ°é€šè¿‡è‡ªå®šä¹‰è§£æå™¨ç”Ÿæˆçš„ASTï¼</p><figure class="lp lq lr ls gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi oa"><img src="../Images/fd6c5f4e9e66a01adc4d49488c3c8465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*llW_K3unLgxh4xpjop4_Ig.gif"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk">Uploading custom parser</figcaption></figure></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h1 id="426e" class="km kn iq bd ko kp nv kr ks kt nw kv kw kx nx kz la lb ny ld le lf nz lh li lj bi translated"><strong class="ak">æˆ‘ä»¬çš„å·´åˆ«å¡”æ’ä»¶</strong></h1><p id="018e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">è‡ªå®šä¹‰çš„å·´åˆ«å¡”è§£æå™¨å®Œæˆåï¼Œè®©æˆ‘ä»¬ç»§ç»­ç¼–å†™æˆ‘ä»¬çš„å·´åˆ«å¡”æ’ä»¶ã€‚</p><p id="1d56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯åœ¨æ­¤ä¹‹å‰ï¼Œä½ å¯èƒ½ä¼šå¯¹æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰çš„babelè§£æå™¨æœ‰ä¸€äº›ç–‘é—®ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæˆ‘ä»¬ç°åœ¨æ­£åœ¨ä½¿ç”¨çš„æ„å»ºæ ˆï¼Ÿ</p><p id="dd0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ«æ‹…å¿ƒã€‚ä¸€ä¸ªå·´åˆ«å¡”æ’ä»¶å¯ä»¥æä¾›ä¸€ä¸ªå®šåˆ¶çš„è§£æå™¨ï¼Œè¿™æ˜¯<a class="ae kl" href="https://babeljs.io/docs/en/babel-parser#will-the-babel-parser-support-a-plugin-system" rel="noopener ugc nofollow" target="_blank">åœ¨å·´åˆ«å¡”ç½‘ç«™</a>ä¸Šè®°å½•çš„</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="9f53" class="ly kn iq lu b gy lz ma l mb mc">// filename: babel-plugin-transformation-curry-function.js<br/>import customParser from â€˜./custom-parserâ€™;</span><span id="2a89" class="ly kn iq lu b gy md ma l mb mc">export default function ourBabelPlugin() {<br/>  return {<br/>    parserOverride(code, opts) {<br/>      return customParser.parse(code, opts);<br/>    },<br/>  };<br/>}</span></pre><p id="1446" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è‡ªä»æˆ‘ä»¬æ¨å‡ºäº†å·´åˆ«å¡”è§£æå™¨ï¼Œæ‰€æœ‰ç°æœ‰çš„å·´åˆ«å¡”è§£æå™¨é€‰é¡¹æˆ–å†…ç½®æ’ä»¶ä»ç„¶å¯ä»¥å®Œç¾å·¥ä½œã€‚</p><p id="faf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰äº†è¿™ä¸ªç–‘é—®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿æˆ‘ä»¬çš„curryå‡½æ•°å¯æµé€šï¼Ÿ<em class="mk">(ä¸å®Œå…¨ç¡®å®šæœ‰æ²¡æœ‰è¿™ä¸ªè¯)</em></p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="d94c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œå¦‚æœä½ æ€¥åˆ‡åœ°æƒ³æŠŠæˆ‘ä»¬çš„æ’ä»¶æ·»åŠ åˆ°ä½ çš„æ„å»ºç³»ç»Ÿä¸­ï¼Œä½ ä¼šæ³¨æ„åˆ°curryå‡½æ•°è¢«ç¼–è¯‘æˆäº†ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ã€‚</p><p id="a7e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯å› ä¸ºè§£æ+è½¬æ¢åï¼Œbabelä¼šä½¿ç”¨<a class="ae kl" href="https://babeljs.io/docs/en/babel-generator" rel="noopener ugc nofollow" target="_blank"> @babel/generator </a>ä»è½¬æ¢åçš„ASTç”Ÿæˆä»£ç ã€‚å› ä¸º<code class="fe me mf mg lu b">@babel/generator</code>ä¸çŸ¥é“æˆ‘ä»¬æ·»åŠ çš„æ–°çš„<code class="fe me mf mg lu b">curry</code>å±æ€§ï¼Œæ‰€ä»¥å®ƒå°†è¢«çœç•¥ã€‚</p><blockquote class="mh mi mj"><p id="ca87" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><em class="iq">å¦‚æœæœ‰ä¸€å¤©curryå‡½æ•°æˆä¸ºäº†æ–°çš„JavaScriptè¯­æ³•ï¼Œä½ å¯èƒ½æƒ³åšä¸€ä¸ªpullè¯·æ±‚åœ¨è¿™é‡Œ</em><a class="ae kl" href="https://github.com/tanhauhau/babel/blob/da0af5fd99a9b747370a2240df3abf2940b9649c/packages/babel-generator/src/generators/methods.js#L82" rel="noopener ugc nofollow" target="_blank"><em class="iq"/></a><em class="iq">ï¼</em></p></blockquote></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="c2aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¥½äº†ï¼Œä¸ºäº†ä½¿æˆ‘ä»¬çš„å‡½æ•°å¯å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª<code class="fe me mf mg lu b">currying</code>è¾…åŠ©é«˜é˜¶å‡½æ•°æ¥åŒ…è£…å®ƒ:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="2b8b" class="ly kn iq lu b gy lz ma l mb mc">function currying(fn) {<br/>  const numParamsRequired = fn.length;<br/>  function curryFactory(params) {<br/>    return function (...args) {<br/>      const newParams = params.concat(args);<br/>      if (newParams.length &gt;= numParamsRequired) {<br/>        return fn(...newParams);<br/>      }<br/>      return curryFactory(newParams);<br/>    }<br/>  }<br/>  return curryFactory([]);<br/>}</span></pre><blockquote class="mh mi mj"><p id="985e" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><em class="iq">å¦‚æœä½ æƒ³å­¦ä¹ å¦‚ä½•ç¼–å†™ä¸€ä¸ªcurryå‡½æ•°ï¼Œä½ å¯ä»¥é€šè¿‡</em><a class="ae kl" href="https://twitter.com/zhirzh" rel="noopener ugc nofollow" target="_blank"><em class="iq">Shirsh Zibbu</em></a>é˜…è¯»JS   <em class="iq">ä¸­çš„è¿™ä¸ª</em> <a class="ae kl" href="https://hackernoon.com/currying-in-js-d9ddc64f162e" rel="noopener ugc nofollow" target="_blank"> <em class="iq"/></a></p></blockquote><p id="138c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œå½“æˆ‘ä»¬è½¬æ¢curryå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è½¬æ¢ä¸ºä»¥ä¸‹å½¢å¼:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="68e9" class="ly kn iq lu b gy lz ma l mb mc">// from<br/>function @@ foo(a, b, c) {<br/>  return a + b + c;<br/>}</span><span id="5044" class="ly kn iq lu b gy md ma l mb mc">// to<br/>const foo = currying(function foo(a, b, c) {<br/>  return a + b + c;<br/>})</span></pre><blockquote class="mh mi mj"><p id="ab33" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><em class="iq">æˆ‘ä»¬å…ˆå¿½ç•¥JavaScriptä¸­çš„</em> <a class="ae kl" href="https://scotch.io/tutorials/understanding-hoisting-in-javascript" rel="noopener ugc nofollow" target="_blank"> <em class="iq">å‡½æ•°æå‡</em> </a> <em class="iq">ï¼Œåœ¨è¿™é‡Œå¯ä»¥åœ¨å®šä¹‰ä¹‹å‰è°ƒç”¨' foo 'ã€‚</em></p></blockquote><p id="631f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ å·²ç»é˜…è¯»äº†æˆ‘çš„<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/step-by-step-guide-for-writing-a-babel-transformation">å…³äºå·´åˆ«å¡”è½¬æ¢çš„åˆ†æ­¥æŒ‡å—</a>ï¼Œé‚£ä¹ˆç¼–å†™è¿™ä¸ªè½¬æ¢åº”è¯¥æ˜¯å¯ä»¥ç®¡ç†çš„:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="dc4f" class="ly kn iq lu b gy lz ma l mb mc">// filename: babel-plugin-transformation-curry-function.js</span><span id="a0bd" class="ly kn iq lu b gy md ma l mb mc">export default function ourBabelPlugin() {<br/>  return {<br/>    visitor: {<br/>      FunctionDeclaration(path) {<br/>        if (path.get(â€˜curryâ€™).node) {<br/>          // const foo = curry(function () { â€¦ });<br/>          path.node.curry = false;<br/>          path.replaceWith(<br/>            t.variableDeclaration(â€˜constâ€™, [<br/>              t.variableDeclarator(<br/>                t.identifier(path.get(â€˜id.nameâ€™).node),<br/>                t.callExpression(t.identifier(â€˜curryingâ€™), [<br/>                  t.toExpression(path.node),<br/>                ])<br/>              ),<br/>            ])<br/>          );<br/>        }<br/>      },<br/>    },<br/>  };<br/>}</span></pre><p id="d2d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é—®é¢˜æ˜¯æˆ‘ä»¬å¦‚ä½•æä¾›<code class="fe me mf mg lu b">currying</code>åŠŸèƒ½ï¼Ÿ</p><p id="d843" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰ä¸¤ç§æ–¹æ³•:</p><ol class=""><li id="20de" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk ob mu mv mw bi translated"><strong class="jp ir">å‡è®¾å·²ç»åœ¨å…¨å±€èŒƒå›´å†…å£°æ˜äº†â€œcurryingâ€ã€‚</strong></li></ol><p id="84e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŸºæœ¬ä¸Šï¼Œä½ çš„å·¥ä½œå·²ç»å®Œæˆäº†ã€‚</p><p id="677c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ²¡æœ‰å®šä¹‰' currying 'ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œç¼–è¯‘åçš„ä»£ç æ—¶ï¼Œè¿è¡Œæ—¶ä¼šå–Šå‡ºâ€œ<em class="mk"> curryingæœªå®šä¹‰â€</em>ï¼Œå°±åƒ<a class="ae kl" href="https://www.google.com/search?q=regeneratorRuntime+is+not+defined" rel="noopener ugc nofollow" target="_blank">â€œregenerator runtimeæœªå®šä¹‰â€</a>ä¸€æ ·ã€‚</p><p id="1232" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œä½ å¯èƒ½å¿…é¡»æ•™è‚²ç”¨æˆ·å®‰è£…<code class="fe me mf mg lu b">currying</code> polyfillsï¼Œä»¥ä¾¿ä½¿ç”¨ä½ çš„<code class="fe me mf mg lu b">babel-plugin-transformation-curry-function</code>ã€‚</p><p id="da2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2ã€‚ä½¿ç”¨</strong> <code class="fe me mf mg lu b"><strong class="jp ir">@babel/helpers</strong></code></p><p id="16a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¯ä»¥ç»™<code class="fe me mf mg lu b">@babel/helpers</code>æ·»åŠ ä¸€ä¸ªæ–°çš„åŠ©æ‰‹ï¼Œå½“ç„¶ä½ ä¸å¤ªå¯èƒ½æŠŠå®ƒåˆå¹¶åˆ°æ­£å¼çš„<code class="fe me mf mg lu b">@babel/helpers</code>ä¸­ï¼Œæ‰€ä»¥ä½ å¿…é¡»æƒ³åŠæ³•è®©<code class="fe me mf mg lu b">@babel/core</code>è§£æåˆ°ä½ çš„<code class="fe me mf mg lu b">@babel/helpers</code>:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="fda0" class="ly kn iq lu b gy lz ma l mb mc">// filename: package.json</span><span id="5c2e" class="ly kn iq lu b gy md ma l mb mc">{<br/>  "resolutions": {<br/>    "@babel/helpers": "7.6.0 â€” your-custom-forked-version",<br/>  }<br/>}</span></pre><p id="3749" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">å…è´£å£°æ˜:</strong> <em class="mk">æˆ‘æ²¡æœ‰äº²è‡ªå°è¯•è¿‡è¿™ä¸ªï¼Œä½†æˆ‘ç›¸ä¿¡å®ƒä¼šèµ·ä½œç”¨ã€‚å¦‚æœä½ åœ¨å°è¯•è¿™ä¸ªçš„æ—¶å€™é‡åˆ°äº†é—®é¢˜ï¼Œ</em><a class="ae kl" href="https://twitter.com/lihautan" rel="noopener ugc nofollow" target="_blank"><em class="mk">DM me</em></a><em class="mk">ï¼Œæˆ‘å¾ˆä¹æ„å’Œä½ è®¨è®ºã€‚</em></p><p id="497f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨<code class="fe me mf mg lu b">@babel/helpers</code>ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„åŠ©æ‰‹å‡½æ•°éå¸¸å®¹æ˜“ã€‚</p><p id="2b89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è½¬åˆ°<a class="ae kl" href="https://github.com/tanhauhau/babel/blob/feat/curry-function/packages/babel-helpers/src/helpers.js" rel="noopener ugc nofollow" target="_blank">packages/babel-helpers/src/helpers . js</a>å¹¶æ·»åŠ ä¸€ä¸ªæ–°æ¡ç›®:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="9ae8" class="ly kn iq lu b gy lz ma l mb mc">helpers.currying = helper(â€œ7.6.0â€)`<br/>  export default function currying(fn) {<br/>    const numParamsRequired = fn.length;<br/>    function curryFactory(params) {<br/>      return function (â€¦args) {<br/>        const newParams = params.concat(args);<br/>        if (newParams.length &gt;= numParamsRequired) {<br/>          return fn(â€¦newParams);<br/>        }<br/>        return curryFactory(newParams);<br/>      }<br/>    }<br/>    return curryFactory([]);<br/>  }<br/>`;</span></pre><p id="7746" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŠ©æ‰‹æ ‡ç­¾åŠŸèƒ½æŒ‡å®šæ‰€éœ€çš„<code class="fe me mf mg lu b">@babel/core</code>ç‰ˆæœ¬ã€‚è¿™é‡Œçš„è¯€çªæ˜¯<code class="fe me mf mg lu b">export default</code>çš„<code class="fe me mf mg lu b">currying</code>åŠŸèƒ½ã€‚</p><p id="e0a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦ä½¿ç”¨åŠ©æ‰‹ï¼Œåªéœ€è°ƒç”¨<code class="fe me mf mg lu b">this.addHelper()</code>:</p><pre class="lp lq lr ls gt lt lu lv lw aw lx bi"><span id="ce00" class="ly kn iq lu b gy lz ma l mb mc">path.replaceWith(<br/>  t.variableDeclaration(â€˜constâ€™, [<br/>    t.variableDeclarator(<br/>      t.identifier(path.get(â€˜id.nameâ€™).node),<br/>      t.callExpression(this.addHelper(â€œcurryingâ€), [<br/>        t.toExpression(path.node),<br/>      ])<br/>    ),<br/>  ])<br/>);</span></pre><p id="8f2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœéœ€è¦çš„è¯ï¼Œ<code class="fe me mf mg lu b">this.addHelper</code>ä¼šåœ¨æ–‡ä»¶çš„é¡¶éƒ¨æ³¨å…¥å¸®åŠ©å™¨ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code class="fe me mf mg lu b">Identifier</code>ç»™æ³¨å…¥çš„å‡½æ•°ã€‚</p><h1 id="cfa4" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">ç»“æŸè¯­</strong></h1><p id="713d" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•ä¿®æ”¹å·´åˆ«å¡”è§£æå™¨å‡½æ•°ï¼Œç¼–å†™æˆ‘ä»¬è‡ªå·±çš„å·´åˆ«å¡”è½¬æ¢æ’ä»¶(<em class="mk">è¿™å¾ˆç®€çŸ­ï¼Œä¸»è¦æ˜¯å› ä¸ºæˆ‘åœ¨ä»¥å‰çš„å¸–å­</em>  <em class="mk"> ) </em>ä¸­è¯¦ç»†ä»‹ç»äº† <a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/step-by-step-guide-for-writing-a-babel-transformation"> <em class="mk">)ï¼Œç®€è¦ä»‹ç»äº†<code class="fe me mf mg lu b">@babel/generator</code>ï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•é€šè¿‡<code class="fe me mf mg lu b">@babel/helpers</code>æ·»åŠ åŠ©æ‰‹å‡½æ•°ã€‚</em></a></p><p id="9e55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸Šäº†ä¸€å ‚å…³äºè§£æå™¨å¦‚ä½•å·¥ä½œçš„é€Ÿæˆè¯¾ï¼Œæˆ‘ä¼šåœ¨åº•éƒ¨æä¾›â€œ<strong class="jp ir">è¿›ä¸€æ­¥é˜…è¯»â€</strong>çš„é“¾æ¥ã€‚</p><p id="cbce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬ä¸Šé¢ç»å†çš„æ­¥éª¤ç±»ä¼¼äºå®šä¹‰ä¸€ä¸ªæ–°çš„JavaScriptè§„èŒƒæ—¶<a class="ae kl" href="https://github.com/tc39/proposals" rel="noopener ugc nofollow" target="_blank"> TC39ææ¡ˆ</a>T3ã€‘æµç¨‹çš„ä¸€éƒ¨åˆ†ã€‚å½“æå‡ºä¸€ä¸ªæ–°çš„è§„èŒƒæ—¶ï¼Œææ¡ˆçš„æ”¯æŒè€…é€šå¸¸ä¼šç¼–å†™å¤šä»½æ–‡ä»¶æˆ–æ’°å†™æ¦‚å¿µéªŒè¯æ¼”ç¤ºã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ´¾ç”Ÿä¸€ä¸ªè§£æå™¨æˆ–ç¼–å†™polyfillså¹¶ä¸æ˜¯è¿™ä¸ªè¿‡ç¨‹ä¸­æœ€éš¾çš„éƒ¨åˆ†ï¼Œè€Œæ˜¯å®šä¹‰é—®é¢˜ç©ºé—´ã€è®¡åˆ’å’Œæ€è€ƒç”¨ä¾‹ä»¥åŠæ”¶é›†æ¥è‡ªç¤¾åŒºçš„æ„è§å’Œå»ºè®®ã€‚ä¸ºæ­¤ï¼Œæˆ‘è¦æ„Ÿè°¢ææ¡ˆå€¡å¯¼è€…ï¼Œæ„Ÿè°¢ä»–ä»¬åŠªåŠ›æ¨åŠ¨JavaScriptè¯­è¨€å‘å‰å‘å±•ã€‚</p><p id="4173" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åï¼Œå¦‚æœä½ æƒ³çœ‹åˆ°æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„ä»£ç çš„å…¨è²Œï¼Œä½ å¯ä»¥ä»Github æŸ¥çœ‹ä¸€ä¸‹<a class="ae kl" href="https://github.com/tanhauhau/babel/compare/3a7b6e1c2...b793efad1" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h1 id="0743" class="km kn iq bd ko kp nv kr ks kt nw kv kw kx nx kz la lb ny ld le lf nz lh li lj bi translated"><strong class="ak">ç¼–è€…æŒ‰</strong></h1><p id="41e8" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">æˆ‘å·²ç»åœ¨å·´åˆ«å¡”åº“ä¸Šå·¥ä½œäº†ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯æˆ‘ä»¥å‰ä»æœªç»™å·´åˆ«å¡”è§£æå™¨æ·»åŠ è¿‡æ–°çš„è¯­æ³•ã€‚æˆ‘çš„å¤§éƒ¨åˆ†è´¡çŒ®åªæ˜¯ä¿®å¤bugå’Œè§„èŒƒéµä»ç‰¹æ€§ã€‚</p><p id="9288" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶è€Œï¼Œåˆ›å»ºä¸€ç§æ–°è¯­æ³•çš„æƒ³æ³•å·²ç»åœ¨æˆ‘çš„è„‘æµ·ä¸­å­˜åœ¨äº†ä¸€æ®µæ—¶é—´ã€‚æ‰€ä»¥æˆ‘æŠ“ä½æœºä¼šå†™äº†ä¸€ç¯‡åšå®¢æ¥å°è¯•ä¸€ä¸‹ã€‚çœ‹åˆ°å®ƒåƒé¢„æœŸçš„é‚£æ ·å·¥ä½œæ˜¯ä¸€ç§ä»¤äººå…´å¥‹çš„ä½“éªŒã€‚</p><p id="23fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰èƒ½åŠ›æ“çºµä½ æ­£åœ¨å†™çš„è¯­è¨€çš„è¯­æ³•æ˜¯ä»¤äººæŒ¯å¥‹çš„ã€‚å®ƒä½¿æˆ‘ä»¬æœ‰å¯èƒ½ç¼–å†™æ›´å°‘çš„ä»£ç æˆ–æ›´ç®€å•çš„ä»£ç ï¼Œå¹¶å°†å¤æ‚æ€§è½¬ç§»åˆ°ç¼–è¯‘æ—¶ã€‚æ­£å¦‚<code class="fe me mf mg lu b">async-await</code>å¦‚ä½•è§£å†³å›è°ƒåœ°ç‹±å’Œæ‰¿è¯ºé“¾åœ°ç‹±ã€‚</p><p id="4d76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœè¿™ç¯‡æ–‡ç« å¯å‘äº†ä½ ä¸€äº›ä¼Ÿå¤§çš„æƒ³æ³•ï¼Œå¹¶ä¸”ä½ å¸Œæœ›ä¸æŸäººè®¨è®ºå®ƒï¼Œä½ æ€»æ˜¯éå¸¸æ¬¢è¿é€šè¿‡<a class="ae kl" href="https://twitter.com/lihautan" rel="noopener ugc nofollow" target="_blank"> Twitter </a>ä¸æˆ‘è”ç³»ã€‚</p><h1 id="fa1d" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">å»¶ä¼¸é˜…è¯»</strong></h1><p id="cbba" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">å…³äºç¼–è¯‘å™¨:</p><ul class=""><li id="10b8" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated"><a class="ae kl" href="https://craftinginterpreters.com/introduction.html" rel="noopener ugc nofollow" target="_blank">åˆ¶ä½œå£è¯‘å‘˜</a>ä½œè€…<a class="ae kl" href="https://twitter.com/munificentbob?lang=en" rel="noopener ugc nofollow" target="_blank">ç½—ä¼¯ç‰¹Â·å°¼æ–¯ç‰¹ç½—å§†</a></li><li id="36a4" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><a class="ae kl" href="https://www.udacity.com/course/compilers-theory-and-practice--ud168" rel="noopener ugc nofollow" target="_blank">å…è´¹Udacityè¯¾ç¨‹:â€œç¼–è¯‘å™¨:ç†è®ºä¸å®è·µâ€</a>ï¼Œç”±ä½æ²»äºšç†å·¥å­¦é™¢æä¾›</li><li id="9f8e" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><a class="ae kl" href="https://medium.com/basecs/leveling-up-ones-parsing-game-with-asts-d7a6fc2400ff" rel="noopener">ç”¨ASTsæå‡è‡ªå·±çš„è§£ææ¸¸æˆ</a>ä½œè€…<a class="ae kl" href="https://twitter.com/vaidehijoshi" rel="noopener ugc nofollow" target="_blank"> Vaidehi Joshi </a></li></ul><p id="0cb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚é¡¹:</p><ul class=""><li id="029c" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated"><a class="ae kl" href="https://scotch.io/tutorials/understanding-hoisting-in-javascript" rel="noopener ugc nofollow" target="_blank">ç†è§£JavaScriptä¸­çš„åŠè£…</a>ä½œè€…<a class="ae kl" href="https://twitter.com/emabishi" rel="noopener ugc nofollow" target="_blank">é©¬æ¯”æ–¯Â·ç“¦åŸºå¥¥</a></li><li id="a032" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><a class="ae kl" href="https://hackernoon.com/currying-in-js-d9ddc64f162e" rel="noopener ugc nofollow" target="_blank">åœ¨JS </a>ä¸­è¢«<a class="ae kl" href="https://twitter.com/zhirzh" rel="noopener ugc nofollow" target="_blank"> Shirsh Zibbu </a>å¥‰æ‰¿</li><li id="0db5" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><a class="ae kl" href="https://github.com/tc39/proposals" rel="noopener ugc nofollow" target="_blank"> TC39ææ¡ˆ</a></li><li id="199b" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><a class="ae kl" href="https://tc39.es/process-document/" rel="noopener ugc nofollow" target="_blank"> TC39å·¥è‰ºæ–‡ä»¶</a></li></ul></div></div>    
</body>
</html>