<html>
<head>
<title>How to Use VeeValidate 3 for Form Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用VeeValidate 3进行表单验证</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-veevalidate-3-for-form-validation-bb18e9c3256c?source=collection_archive---------2-----------------------#2019-11-06">https://javascript.plainenglish.io/how-to-use-veevalidate-3-for-form-validation-bb18e9c3256c?source=collection_archive---------2-----------------------#2019-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bcce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与之前的版本相比，VeeValidate 3完全改变了表单验证的方式。以前的版本直接在输入中添加表单验证规则，而VeeValidate 3将它提供的组件包装在输入周围，为组件提供表单验证。我们将<code class="fe kl km kn ko b">ValidationProvider</code>组件包装在输入周围，为输入添加表单验证功能。</p><p id="e0ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">内置规则现在包含在你启动的应用程序中。都是在app的入口点一个一个注册而不是为了使用规则才在库上调用<code class="fe kl km kn ko b">Vue.use</code>。</p><p id="25ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表单验证错误从作用域槽传递到输入中，当您在<code class="fe kl km kn ko b">ValidationProvider</code>中添加输入时，作用域槽是可用的。例如，如果我们有:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="c4bf" class="kx ky iq ko b gy kz la l lb lc">&lt;ValidationProvider name="email" rules="required"&gt;<br/>  &lt;div slot-scope="{ errors }"&gt;<br/>    &lt;input v-model="name"&gt;<br/>    &lt;p&gt;{{ errors[0] }}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/ValidationProvider&gt;</span></pre><p id="6f55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们从上面代码中的<code class="fe kl km kn ko b">ValidationProvider</code>得到<code class="fe kl km kn ko b">errors</code>。</p><p id="b804" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过这种安排，指定自定义规则比在版本2中更容易，正如您将在我们下面构建的应用程序中看到的那样。</p><p id="6d00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将构建一个简单的费用跟踪器，它有一个添加费用描述、金额和日期的表单和一个显示数据的表格。我们还将添加按钮，让用户删除费用。此外，将有一个页面显示按日期排序的费用折线图。</p><p id="a810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">后端将使用Koa构建，以保持简单。我们将使用最新版本的Vue.js和最新版本的BootstrapVue来构建UI。Vee-Validate将用于表单验证，Vue-Chartjs将用于折线图。</p><h1 id="19b2" class="ld ky iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">后端</h1><p id="08ac" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">首先，我们构建一个简单的后端来存储费用。创建一个项目文件夹，然后创建一个<code class="fe kl km kn ko b">backend</code>文件夹来存储后端代码。现在我们可以构建后端，我们运行<code class="fe kl km kn ko b">npm init</code>并通过输入默认值来回答问题。然后我们安装自己的软件包。Koa什么都没有，所以我们需要安装一个请求体解析器，一个路由器，CORS插件来支持前端的跨域请求，并为数据库添加库。</p><p id="9124" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装所有这些包，运行<code class="fe kl km kn ko b">npm i @babel/cli @babel/core @babel/node @babel/preset-env @koa/cors koa-bodyparser koa-router sequelize sqlite3</code>。我们需要Babel包来运行最新的JavaScript特性。Sequelize和SQLite分别是我们将要用到的ORM和数据库。Koa包分别用于启用CORS、解析JSON请求体和启用路由。</p><p id="2cfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下次运行:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="b357" class="kx ky iq ko b gy kz la l lb lc">npx sequelize-cli init</span></pre><p id="9b5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建数据库样板代码。</p><p id="05bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们运行:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="9793" class="kx ky iq ko b gy kz la l lb lc">npx sequelize-cli --name Expense --attributes description:string,amount:float,date:date</span></pre><p id="684f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用<code class="fe kl km kn ko b">attributes</code>选项中列出的字段和数据类型创建一个<code class="fe kl km kn ko b">Expense </code>表。</p><p id="169e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成之后，运行<code class="fe kl km kn ko b">npx sequelize-cli db:migrate</code>来创建数据库。</p><p id="3d90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe kl km kn ko b">backend</code>文件夹的根目录下创建<code class="fe kl km kn ko b">app.js</code>，并添加:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="abc6" class="kx ky iq ko b gy kz la l lb lc">const Koa = require("koa");<br/>const cors = require("<a class="ae mf" href="http://twitter.com/koa/cors" rel="noopener ugc nofollow" target="_blank">@koa/cors</a>");<br/>const Router = require("koa-router");<br/>const models = require("./models");<br/>const bodyParser = require("koa-bodyparser");</span><span id="5aa6" class="kx ky iq ko b gy mg la l lb lc">const app = new Koa();<br/>app.use(bodyParser());<br/>app.use(cors());<br/>const router = new Router();</span><span id="33d5" class="kx ky iq ko b gy mg la l lb lc">router.get("/expenses", async (ctx, next) =&gt; {<br/>  const Expenses = await models.Expense.findAll();<br/>  ctx.body = Expenses;<br/>});</span><span id="633c" class="kx ky iq ko b gy mg la l lb lc">router.post("/expenses", async (ctx, next) =&gt; {<br/>  const Expense = await models.Expense.create(ctx.request.body);<br/>  ctx.body = Expense;<br/>});</span><span id="7038" class="kx ky iq ko b gy mg la l lb lc">router.delete("/expenses/:id", async (ctx, next) =&gt; {<br/>  const id = ctx.params.id;<br/>  await models.Expense.destroy({ where: { id } });<br/>  ctx.body = {};<br/>});</span><span id="0b5a" class="kx ky iq ko b gy mg la l lb lc">app.use(router.routes()).use(router.allowedMethods());</span><span id="6fea" class="kx ky iq ko b gy mg la l lb lc">app.listen(3000);</span></pre><p id="155f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是包含我们应用程序所有逻辑的文件。我们使用通过导入运行<code class="fe kl km kn ko b">sequelize-cli init</code>创建的<code class="fe kl km kn ko b">models</code>模块创建的序列模型。</p><p id="0d58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们通过添加<code class="fe kl km kn ko b">app.use(cors());</code>来启用CORS，通过添加<code class="fe kl km kn ko b">app.use(bodyParser());</code>来启用JSON请求体解析。我们通过添加:<code class="fe kl km kn ko b"> const router = new Router();</code>来添加路由器。</p><p id="8e96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在GET <code class="fe kl km kn ko b">expense </code>路线中，我们得到所有的费用。这个帖子是用来添加联系人的。PUT路线用于通过按ID查找来更新现有费用。而删除路径用于按ID删除费用。</p><p id="2bc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在后端完成了。就这么简单。</p><h1 id="619c" class="ld ky iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">前端</h1><p id="adc8" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">为了开始构建前端，我们在项目的根文件夹中添加一个<code class="fe kl km kn ko b">frontend</code>文件夹，然后进入<code class="fe kl km kn ko b">frontend</code>文件夹并运行:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="c852" class="kx ky iq ko b gy kz la l lb lc">npx @vue/cli create .</span></pre><p id="cef0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们运行向导时，我们将手动选择选项，选择包括Vuex和Vue路由器，并使用SCSS和NPM进行包管理。</p><p id="4fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们安装一些软件包。我们将使用Axios进行请求，使用Moment操作日期，使用BootstrapVue进行样式设计，使用Vee-Validate进行表单验证，使用Vue-Chartjs显示图表。</p><p id="3054" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了安装所有东西，我们运行:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="5d2b" class="kx ky iq ko b gy kz la l lb lc">npm i axios bootstrap-vue chartjs vue-chartjs vee-validate moment</span></pre><p id="535f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装好所有的包后，我们就可以开始写代码了。</p><p id="94cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe kl km kn ko b">src</code>文件夹中，创建一个<code class="fe kl km kn ko b">charts</code>文件夹，并在其中创建一个名为<code class="fe kl km kn ko b">ExpenseChart.vue</code>的文件。在文件中，添加:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="d24b" class="kx ky iq ko b gy kz la l lb lc">&lt;script&gt;<br/>import { Line } from "vue-chartjs";</span><span id="4702" class="kx ky iq ko b gy mg la l lb lc">export default {<br/>  extends: Line,<br/>  props: ["chartdata", "options"],<br/>  mounted() {<br/>    this.renderChart(this.chartdata, this.options);<br/>  },<br/>  watch: {<br/>    chartdata() {<br/>      this.renderChart(this.chartdata, this.options);<br/>    },<br/>    options() {<br/>      this.renderChart(this.chartdata, this.options);<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="2780" class="kx ky iq ko b gy mg la l lb lc">&lt;style&gt;<br/>&lt;/style&gt;</span></pre><p id="8f04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们指定这个组件接受<code class="fe kl km kn ko b">chartdata</code>和<code class="fe kl km kn ko b">options</code>道具。我们在<code class="fe kl km kn ko b">mounted</code>和<code class="fe kl km kn ko b">watch</code>两个块中都调用了<code class="fe kl km kn ko b">this.renderChart</code>,这样每当道具改变或者这个组件第一次加载时，图表就会更新。</p><p id="65d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们创建一个过滤器来格式化日期。在<code class="fe kl km kn ko b">src </code>文件夹中创建一个<code class="fe kl km kn ko b">filters</code>文件夹，并在里面创建<code class="fe kl km kn ko b">date.js</code>。在文件中，我们添加了:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="a39b" class="kx ky iq ko b gy kz la l lb lc">import * as moment from "moment";</span><span id="7853" class="kx ky iq ko b gy mg la l lb lc">export const dateFilter = value =&gt; {<br/>  return moment(value).format("YYYY-MM-DD");<br/>};</span></pre><p id="51c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接收一个日期并以YYYY-MM-DD格式返回。</p><p id="c8c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们为HTTP请求代码创建一个mixin。在<code class="fe kl km kn ko b">src</code>文件夹中创建一个<code class="fe kl km kn ko b">mixins</code>文件夹，在其中创建一个<code class="fe kl km kn ko b">requestsMixin.js</code>并添加:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="f48c" class="kx ky iq ko b gy kz la l lb lc">const APIURL = "<a class="ae mf" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a>";<br/>const axios = require("axios");</span><span id="901d" class="kx ky iq ko b gy mg la l lb lc">export const requestsMixin = {<br/>  methods: {<br/>    getExpenses() {<br/>      return axios.get(`${APIURL}/expenses`);<br/>    },</span><span id="817d" class="kx ky iq ko b gy mg la l lb lc">addExpense(data) {<br/>      return axios.post(`${APIURL}/expenses`, data);<br/>    },</span><span id="b6a6" class="kx ky iq ko b gy mg la l lb lc">deleteExpense(id) {<br/>      return axios.delete(`${APIURL}/expenses/${id}`);<br/>    }<br/>  }<br/>};</span></pre><p id="de02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当mixin包含在组件中时，这允许我们在任何组件中调用这些函数。</p><p id="b385" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，在<code class="fe kl km kn ko b">views</code>文件夹中，我们创建组件。在<code class="fe kl km kn ko b">views</code>文件夹中创建一个<code class="fe kl km kn ko b">Graph.vue</code>文件，并添加:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="ce96" class="kx ky iq ko b gy kz la l lb lc">&lt;template&gt;<br/>  &lt;div class="about"&gt;<br/>    &lt;h1 class="text-center"&gt;Expense Chart&lt;/h1&gt;<br/>    &lt;expense-chart :chartdata="chartData" :options="options"&gt;&lt;/expense-chart&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="6581" class="kx ky iq ko b gy mg la l lb lc">&lt;script&gt;<br/>import { requestsMixin } from "../mixins/requestsMixin";<br/>import * as moment from "moment";</span><span id="1d10" class="kx ky iq ko b gy mg la l lb lc">export default {<br/>  name: "home",<br/>  mixins: [requestsMixin],<br/>  data() {<br/>    return {<br/>      chartData: {},<br/>      options: { responsive: true, maintainAspectRatio: false }<br/>    };<br/>  },<br/>  beforeMount() {<br/>    this.getAllExpenses();<br/>  },</span><span id="eea3" class="kx ky iq ko b gy mg la l lb lc">methods: {<br/>    async getAllExpenses() {<br/>      const response = await this.getExpenses();<br/>      const sortedData = response.data.sort(<br/>        (a, b) =&gt; +moment(a.date).toDate() - +moment(b.date).toDate()<br/>      );<br/>      const dates = Array.from(<br/>        new Set(sortedData.map(d =&gt; moment(d.date).format("YYYY-MM-DD")))<br/>      );<br/>      const expensesByDate = {};<br/>      dates.forEach(d =&gt; {<br/>        expensesByDate[d] = 0;<br/>      });</span><span id="ee57" class="kx ky iq ko b gy mg la l lb lc">dates.forEach(d =&gt; {<br/>        const data = sortedData.filter(<br/>          sd =&gt; moment(sd.date).format("YYYY-MM-DD") == d<br/>        );<br/>        expensesByDate[d] += +data<br/>          .map(a =&gt; +a.amount)<br/>          .reduce((a, b) =&gt; {<br/>            return a + b;<br/>          });<br/>      });</span><span id="603d" class="kx ky iq ko b gy mg la l lb lc">this.chartData = {<br/>        labels: dates,<br/>        datasets: [<br/>          {<br/>            label: "Expenses",<br/>            backgroundColor: "#f87979",<br/>            data: Object.keys(expensesByDate).map(d =&gt; expensesByDate[d])<br/>          }<br/>        ]<br/>      };<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="d260" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在这里显示我们之前创建的<code class="fe kl km kn ko b">ExpenseChart</code>。通过从后端获取数据来填充数据。<code class="fe kl km kn ko b">this.getExpenses</code>函数来自我们包含在这个文件中的<code class="fe kl km kn ko b">requestMixin</code>。为了生成<code class="fe kl km kn ko b">chartData</code>，我们按日期对数据进行排序，然后将日期设置为<code class="fe kl km kn ko b">labels</code>，在<code class="fe kl km kn ko b">datasets</code>中，我们有该行的数据，即费用的金额。我们将每天的所有费用相加，并将其转换为一个数组，其中包含:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="4a2a" class="kx ky iq ko b gy kz la l lb lc">const dates = Array.from(<br/>        new Set(sortedData.map(d =&gt; moment(d.date).format("YYYY-MM-DD")))<br/>      );<br/>const expensesByDate = {};<br/>dates.forEach(d =&gt; {<br/>  expensesByDate[d] = 0;<br/>});</span><span id="0110" class="kx ky iq ko b gy mg la l lb lc">dates.forEach(d =&gt; {<br/>  const data = sortedData.filter(<br/>    sd =&gt; moment(sd.date).format("YYYY-MM-DD") == d<br/>  );<br/>  expensesByDate[d] += +data<br/>    .map(a =&gt; +a.amount)<br/>    .reduce((a, b) =&gt; {<br/>      return a + b;<br/>    });<br/>});</span></pre><p id="e85c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中，我们将费用转换成一个字典，以日期作为键，以总费用作为值。</p><p id="9aac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们通过将<code class="fe kl km kn ko b">{ responsive: true, maintainAspectRatio: false }</code>传递给<code class="fe kl km kn ko b">options</code>属性来使图表具有响应性。</p><p id="c55f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们用以下代码替换<code class="fe kl km kn ko b">HomePage.vue</code>中的现有代码:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="cbf2" class="kx ky iq ko b gy kz la l lb lc">&lt;template&gt;<br/>  &lt;div class="page"&gt;<br/>    &lt;ValidationObserver ref="observer" v-slot="{ invalid }"&gt;<br/>      &lt;b-form <a class="ae mf" href="http://twitter.com/submit" rel="noopener ugc nofollow" target="_blank">@submit</a>.prevent="onSubmit" novalidate&gt;<br/>        &lt;b-form-group label="Description"&gt;<br/>          &lt;ValidationProvider name="description" rules="required" v-slot="{ errors }"&gt;<br/>            &lt;b-form-input<br/>              :state="errors.length == 0"<br/>              v-model="form.description"<br/>              type="text"<br/>              required<br/>              placeholder="Description"<br/>              name="description"<br/>            &gt;&lt;/b-form-input&gt;<br/>            &lt;b-form-invalid-feedback :state="errors.length == 0"&gt;Description is required&lt;/b-form-invalid-feedback&gt;<br/>          &lt;/ValidationProvider&gt;<br/>        &lt;/b-form-group&gt;<br/>        &lt;b-form-group label="Amount"&gt;<br/>          &lt;ValidationProvider name="amount" rules="required|min_value:0" v-slot="{ errors }"&gt;<br/>            &lt;b-form-input<br/>              :state="errors.length == 0"<br/>              v-model="form.amount"<br/>              type="text"<br/>              required<br/>              placeholder="Amount"<br/>            &gt;&lt;/b-form-input&gt;<br/>            &lt;b-form-invalid-feedback :state="errors.length == 0"&gt;{{errors.join('. ')}}&lt;/b-form-invalid-feedback&gt;<br/>          &lt;/ValidationProvider&gt;<br/>        &lt;/b-form-group&gt;<br/>        &lt;b-form-group label="Date"&gt;<br/>          &lt;ValidationProvider name="amount" rules="date" v-slot="{ errors }"&gt;<br/>            &lt;b-form-input<br/>              :state="errors.length == 0"<br/>              v-model="form.date"<br/>              type="text"<br/>              required<br/>              placeholder="Date (YYYY/MM/DD)"<br/>              name="date"<br/>            &gt;&lt;/b-form-input&gt;<br/>            &lt;b-form-invalid-feedback :state="errors.length == 0"&gt;{{errors[0]}}&lt;/b-form-invalid-feedback&gt;<br/>          &lt;/ValidationProvider&gt;<br/>        &lt;/b-form-group&gt;<br/>        &lt;b-button type="submit"&gt;Add&lt;/b-button&gt;<br/>      &lt;/b-form&gt;<br/>    &lt;/ValidationObserver&gt;</span><span id="f598" class="kx ky iq ko b gy mg la l lb lc">    &lt;b-table-simple responsive&gt;<br/>      &lt;b-thead&gt;<br/>        &lt;b-tr&gt;<br/>          &lt;b-th sticky-column&gt;Description&lt;/b-th&gt;<br/>          &lt;b-th&gt;Amount&lt;/b-th&gt;<br/>          &lt;b-th&gt;Date&lt;/b-th&gt;<br/>          &lt;b-th&gt;Delete&lt;/b-th&gt;<br/>        &lt;/b-tr&gt;<br/>      &lt;/b-thead&gt;<br/>      &lt;b-tbody&gt;<br/>        &lt;b-tr v-for="e in expenses" :key="e.id"&gt;<br/>          &lt;b-th sticky-column&gt;{{e.description}}&lt;/b-th&gt;<br/>          &lt;b-td&gt;${{e.amount}}&lt;/b-td&gt;<br/>          &lt;b-td&gt;{{e.date | formatDate}}&lt;/b-td&gt;<br/>          &lt;b-td&gt;<br/>            &lt;b-button <a class="ae mf" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="deleteSingleExpense(e.id)"&gt;Delete&lt;/b-button&gt;<br/>          &lt;/b-td&gt;<br/>        &lt;/b-tr&gt;<br/>      &lt;/b-tbody&gt;<br/>    &lt;/b-table-simple&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="3634" class="kx ky iq ko b gy mg la l lb lc">&lt;script&gt;<br/>import "bootstrap/dist/css/bootstrap.css";<br/>import "bootstrap-vue/dist/bootstrap-vue.css";<br/>import { requestsMixin } from "../mixins/requestsMixin";</span><span id="6919" class="kx ky iq ko b gy mg la l lb lc">export default {<br/>  name: "home",<br/>  mixins: [requestsMixin],<br/>  data() {<br/>    return {<br/>      form: {}<br/>    };<br/>  },<br/>  beforeMount() {<br/>    this.getAllExpenses();<br/>  },<br/>  computed: {<br/>    expenses() {<br/>      return this.$store.state.expenses;<br/>    }<br/>  },<br/>  methods: {<br/>    async onSubmit() {<br/>      const isValid = await this.$refs.observer.validate();<br/>      if (!isValid) {<br/>        return;<br/>      }<br/>      await this.addExpense(this.form);<br/>      await this.getAllExpenses();<br/>    },</span><span id="6fb2" class="kx ky iq ko b gy mg la l lb lc">  async getAllExpenses() {<br/>      const response = await this.getExpenses();<br/>      this.$store.commit("setExpenses", response.data);<br/>    },</span><span id="bd9f" class="kx ky iq ko b gy mg la l lb lc">  async deleteSingleExpense(id) {<br/>      const response = await this.deleteExpense(id);<br/>      await this.getAllExpenses();<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="dd7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用BootstrapVue中的表单和表格来构建表单和表格。对于表单验证，我们用每个<code class="fe kl km kn ko b">b-form-input</code>包装<code class="fe kl km kn ko b">ValidationProvider</code>来获得表单验证。表单验证规则注册在<code class="fe kl km kn ko b">main.js</code>中，因此我们可以在这里使用它们。</p><p id="e422" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在每个<code class="fe kl km kn ko b">b-form-input</code>中添加了<code class="fe kl km kn ko b">:state=”errors.length == 0"</code>,这样我们就可以为每个输入显示正确的验证消息，并对其进行适当的样式设置。<code class="fe kl km kn ko b">errors</code>对象有每个输入的表单验证错误消息。我们还需要在<code class="fe kl km kn ko b">ValidationProvider</code>和<code class="fe kl km kn ko b">b-form-input</code>中指定<code class="fe kl km kn ko b">name</code>属性，以便将表单验证规则应用于<code class="fe kl km kn ko b">ValidationProvider</code>中的输入。我们将表单放在<code class="fe kl km kn ko b">ValidationObserver</code>组件中，让我们验证整个表单。使用Vee-Validate，当我们像在上面的代码中那样使用<code class="fe kl km kn ko b">ValidationObserver</code>时，我们得到了<code class="fe kl km kn ko b">this.$refs.observer.validate()</code>函数。如果表单有效，它返回一个解析为true的承诺，否则解析为false。因此，如果它解析为false，我们不会运行函数的其余代码。</p><p id="9236" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">this.$store</code>由Vuex提供。我们在它上面调用<code class="fe kl km kn ko b">commit</code>将值存储到Vuex存储中。我们从<code class="fe kl km kn ko b">computed</code>街区的商店获得最新的价值。</p><p id="2a21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe kl km kn ko b">App.vue</code>中，用以下代码替换现有代码:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="99aa" class="kx ky iq ko b gy kz la l lb lc">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;b-navbar toggleable="lg" type="dark" variant="info"&gt;<br/>      &lt;b-navbar-brand href="#"&gt;Expense Tracker&lt;/b-navbar-brand&gt;</span><span id="cc6b" class="kx ky iq ko b gy mg la l lb lc">&lt;b-navbar-toggle target="nav-collapse"&gt;&lt;/b-navbar-toggle&gt;</span><span id="b379" class="kx ky iq ko b gy mg la l lb lc">&lt;b-collapse id="nav-collapse" is-nav&gt;<br/>        &lt;b-navbar-nav&gt;<br/>          &lt;b-nav-item to="/" :active="path  == '/'"&gt;Home&lt;/b-nav-item&gt;<br/>          &lt;b-nav-item to="/graph" :active="path  == '/graph'"&gt;Graph&lt;/b-nav-item&gt;<br/>        &lt;/b-navbar-nav&gt;<br/>      &lt;/b-collapse&gt;<br/>    &lt;/b-navbar&gt;<br/>    &lt;router-view /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="7820" class="kx ky iq ko b gy mg la l lb lc">&lt;script&gt;<br/>export default {<br/>  beforeMount() {<br/>    window.Chart.defaults.global.defaultFontFamily = `<br/>  -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen",<br/>  "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue",<br/>  sans-serif`;<br/>  },<br/>  data() {<br/>    return {<br/>      path: this.$route &amp;&amp; this.$route.path<br/>    };<br/>  },<br/>  watch: {<br/>    $route(route) {<br/>      this.path = route.path;<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="c664" class="kx ky iq ko b gy mg la l lb lc">&lt;style lang="scss"&gt;<br/>.page {<br/>  padding: 20px;<br/>}<br/>&lt;/style&gt;</span></pre><p id="77d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件中，我们添加了BootstrapVue <code class="fe kl km kn ko b">b-navbar</code>来显示一个顶栏。我们观察URL的变化，以便我们可以将正确的链接设置为活动的。在<code class="fe kl km kn ko b">data</code>块中，我们设置了初始路线，这样当应用程序首次加载时，我们可以高亮显示正确的链接。</p><p id="46a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe kl km kn ko b">main.js</code>中，我们将现有代码替换为:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="be1d" class="kx ky iq ko b gy kz la l lb lc">import Vue from "vue";<br/>import App from "./App.vue";<br/>import router from "./router";<br/>import store from "./store";<br/>import BootstrapVue from "bootstrap-vue";<br/>import { ValidationProvider, extend, ValidationObserver } from "vee-validate";<br/>import { required, min_value } from "vee-validate/dist/rules";<br/>import { dateFilter } from "./filters/date";<br/>import ExpenseChart from "./charts/ExpenseChart";extend("required", required);<br/>extend("min_value", min_value);<br/>extend("date", {<br/>  validate: value =&gt;<br/>    /^(19|20)\d\d[/]([1-9]|0[1-9]|1[012])[/]([1-9]|0[1-9]|[12][0-9]|3[01])$/.test(<br/>      value<br/>    ),<br/>  message: "Date must be in YYYY/MM/DD format"<br/>});Vue.component("expense-chart", ExpenseChart);<br/>Vue.filter("formatDate", dateFilter);<br/>Vue.use(BootstrapVue);<br/>Vue.component("ValidationProvider", ValidationProvider);<br/>Vue.component("ValidationObserver", ValidationObserver);<br/>Vue.config.productionTip = false;new Vue({<br/>  router,<br/>  store,<br/>  render: h =&gt; h(App)<br/>}).$mount("#app");</span></pre><p id="b94a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里添加了我们在<code class="fe kl km kn ko b">Home.vue</code>中使用的验证规则。请注意，我们可以拥有像<code class="fe kl km kn ko b">date</code>规则这样的定制验证规则。使用VeeValidate 3很容易定义自定义规则。我们还注册了<code class="fe kl km kn ko b">ValidationProvider</code>和<code class="fe kl km kn ko b">ExpenseChart</code>组件，以便在我们的应用程序中使用它们。</p><p id="d076" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在这里注册了<code class="fe kl km kn ko b">ValidationObserver</code>组件，让我们在<code class="fe kl km kn ko b">HomePage.vue</code>中验证整个表单。</p><p id="3cf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我们还从Vee-Validate中添加了我们希望在这里使用的表单验证规则。我们在这里添加了我们在<code class="fe kl km kn ko b">HomePage.vue</code>中使用的内置<code class="fe kl km kn ko b">required</code>和<code class="fe kl km kn ko b">min_value</code>规则，并在前两个<code class="fe kl km kn ko b">extend</code>调用下面定义了<code class="fe kl km kn ko b">date</code>规则。<code class="fe kl km kn ko b">date</code>规则指定我们检查<code class="fe kl km kn ko b">value</code>中的<code class="fe kl km kn ko b">YYYY/MM/DD</code>格式，还指定了如果发现验证错误时的错误消息。</p><p id="ed28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe kl km kn ko b">router.js</code>中，我们将现有代码替换为:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="c293" class="kx ky iq ko b gy kz la l lb lc">import Vue from 'vue'<br/>import Router from 'vue-router'<br/>import Home from './views/Home.vue'<br/>import Graph from './views/Graph.vue'</span><span id="ac04" class="kx ky iq ko b gy mg la l lb lc">Vue.use(Router)</span><span id="7af2" class="kx ky iq ko b gy mg la l lb lc">export default new Router({<br/>  mode: 'history',<br/>  base: process.env.BASE_URL,<br/>  routes: [<br/>    {<br/>      path: '/',<br/>      name: 'home',<br/>      component: Home<br/>    },<br/>    {<br/>      path: '/graph',<br/>      name: 'graph',<br/>      component: Graph<br/>    }<br/>  ]<br/>})</span></pre><p id="fa0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">包含我们创建的<code class="fe kl km kn ko b">Graph</code>页面。</p><p id="679b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe kl km kn ko b">store.js</code>中，我们将代码替换为:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="1bcc" class="kx ky iq ko b gy kz la l lb lc">import Vue from "vue";<br/>import Vuex from "vuex";</span><span id="8edf" class="kx ky iq ko b gy mg la l lb lc">Vue.use(Vuex);</span><span id="f064" class="kx ky iq ko b gy mg la l lb lc">export default new Vuex.Store({<br/>  state: {<br/>    expenses: []<br/>  },<br/>  mutations: {<br/>    setExpenses(state, payload) {<br/>      state.expenses = payload;<br/>    }<br/>  },<br/>  actions: {}<br/>});</span></pre><p id="e4e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以便我们可以随时在商店中保存获得的费用数据。</p><p id="ee19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后在<code class="fe kl km kn ko b">index.html</code>中，我们将现有代码改为:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="a98d" class="kx ky iq ko b gy kz la l lb lc">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width,initial-scale=1.0" /&gt;<br/>    &lt;link rel="icon" href="&lt;%= BASE_URL %&gt;favicon.ico" /&gt;<br/>    &lt;title&gt;Expense Tracker&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;noscript&gt;<br/>      &lt;strong<br/>        &gt;We're sorry but frontend doesn't work properly without JavaScript<br/>        enabled. Please enable it to continue.&lt;/strong<br/>      &gt;<br/>    &lt;/noscript&gt;<br/>    &lt;div id="app"&gt;&lt;/div&gt;<br/>    &lt;!-- built files will be auto injected --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="c913" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">改一下标题。我们已经在<code class="fe kl km kn ko b">App.vue</code>中导入了引导样式，所以我们不必在这里包含它。</p><p id="e1c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">写完所有代码后，我们就可以运行我们的应用程序了。在运行任何东西之前，通过运行<code class="fe kl km kn ko b">npm i -g nodemon</code>来安装<code class="fe kl km kn ko b">nodemon</code>，这样当文件改变时，我们就不必自己重启后端了。</p><p id="6e0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后通过运行<code class="fe kl km kn ko b">backend</code>文件夹中的<code class="fe kl km kn ko b">npm start</code>和<code class="fe kl km kn ko b">frontend</code>文件夹中的<code class="fe kl km kn ko b">npm run serve</code>运行后端。</p><p id="28e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们有以下内容:</p><figure class="kp kq kr ks gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mh"><img src="../Images/c2ea40c44d1ea6456adf048c6331d1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ESMqOz0HLXYJxCFd9UkUlg.png"/></div></div></figure><figure class="kp kq kr ks gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mp"><img src="../Images/5ffeeea02cec0f575ce4081ded0e1439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOGzc16lxu5W6HOWrPyZhw.png"/></div></div></figure><figure class="kp kq kr ks gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mh"><img src="../Images/31a6a1bcb9dc1c5d310ff3853949c60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSL65xIQeJOBYYuqVnZvUw.png"/></div></div></figure></div></div>    
</body>
</html>