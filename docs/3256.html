<html>
<head>
<title>Export Data to Excel in Angular Using ExcelJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ExcelJS在Angular中将数据导出到Excel</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/export-data-to-excel-in-angular-using-exceljs-305ba8c5dece?source=collection_archive---------1-----------------------#2020-09-14">https://javascript.plainenglish.io/export-data-to-excel-in-angular-using-exceljs-305ba8c5dece?source=collection_archive---------1-----------------------#2020-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d43a594ca00e04ba8dc84b727579ee65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkqxL6QR7J-ScQ-M2ngebw.png"/></div></div></figure><p id="01c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们使用任何技术开发一个简单的应用程序或复杂的企业应用程序时，最终用户总是需要一个<strong class="ka ir"> Excel </strong>文件中的报告数据。为什么因为大多数人依赖excel文件。我和各种<strong class="ka ir"> Angular </strong>企业<strong class="ka ir">应用</strong>合作过。在所有应用中，客户要求我们使用各种过滤器给出一个<strong class="ka ir">可下载的excel </strong>文件。</p><p id="e304" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本教程中，您将学习如何使用<strong class="ka ir"> Angular </strong>下载excel文件。我将展示一个使用<strong class="ka ir"> ExcelJS </strong>和文件保护插件下载excel文件的演示。如果你是一个Angular开发者，并且正在寻找将数据导出到excel，那么这篇文章将会给你更多的帮助。我们将一个一个地看到他们。</p><h1 id="f2eb" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">第一步。创建新的角度项目</strong></h1><p id="c8ca" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">使用下面的命令创建一个新的角度项目。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="c4a6" class="mi kx iq me b gy mj mk l ml mm">ng new angular-excel-example</span></pre><p id="c262" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">初始设置完成后，使用VS代码编辑器打开项目文件夹。</p><h1 id="0c91" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">第二步。安装ExcelJS插件</strong></h1><p id="6fc2" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">ExcelJS插件是用来读写excel文件的。它功能丰富。您可以设置行和列的样式。甚至你可以在excel文件中添加图片。这就是为什么许多人使用这个图书馆。</p><p id="bbb1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用下面的命令安装ExcelJS。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="e6b2" class="mi kx iq me b gy mj mk l ml mm">npm install exceljs --save</span></pre><h1 id="dd7e" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">步骤三。安装文件保护程序</strong></h1><p id="306f" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">js是在客户端保存文件的解决方案，非常适合在客户端生成文件的web应用程序。</p><p id="5137" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用下面的命令安装文件保护插件。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="d51a" class="mi kx iq me b gy mj mk l ml mm">npm install file-saver --save</span></pre><h1 id="8c02" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">第四步。创建带有点击事件的按钮</strong></h1><p id="137e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">用click事件在<strong class="ka ir">app.component.html</strong>文件上创建一个按钮。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">app.component.html file</figcaption></figure><h1 id="be0b" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">第五步。导入ExcelJS和文件保存插件</strong></h1><p id="c2e9" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">打开<strong class="ka ir"> app.component.ts </strong>文件，使用下面的代码导入ExcelJS和File Saver插件。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="d083" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">步骤六。创建一个可下载的Excel文件</strong></h1><p id="7318" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在这里，我将一步一步地解释每一段代码。</p><ol class=""><li id="9f0f" class="mt mu iq ka b kb kc kf kg kj mv kn mw kr mx kv my mz na nb bi translated">首先，我们需要JSON格式的数据。你可以像我一样为测试目的创建虚拟数据，也可以从服务器获取数据。</li></ol><p id="4993" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我用一些名字和年龄数据创建了一个变量。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="74f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.接下来，使用创建一个工作簿excel工作簿</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="47bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.从工作簿中，我们可以使用<strong class="ka ir"> addWorksheet() </strong>函数创建一个新的工作表。在此给出一个工作表名称</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="e4f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.使用<strong class="ka ir"> addRow() </strong>函数添加列标题。在JSON数据中，我只有两列。这就是为什么我只创建了两列。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="57f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.现在使用for循环将JSON数据添加到工作表中。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="dc99" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">6.设置文件名并调用write函数来创建一个可下载的excel文件。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="d0aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已。现在，您可以将数据导出到excel文件。</p><h1 id="3561" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">摘要</h1><p id="bca8" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在任何应用程序中，将数据导出到excel文件总是一项必需的功能。尤其是如果你采用任何<strong class="ka ir"> CRM、ERP、</strong>和任何复杂的web应用程序，最终用户需要数据在<strong class="ka ir"> excel文件中。如果你正在使用<strong class="ka ir"> Angular </strong>寻找一个可下载的excel文件，这篇文章会非常有帮助。ExcelJS </strong>插件提供了样式化的行和列，甚至你也可以添加图片。它还有许多其他功能。你可以使用下面的链接来查看。</p><div class="nc nd gp gr ne nf"><a href="https://www.npmjs.com/package/exceljs" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">exceljs</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">读取、操作和写入电子表格数据和样式到XLSX和JSON。从Excel电子表格反向工程…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">www.npmjs.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt jw nf"/></div></div></a></div><p id="65cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">项目回购:</p><div class="nc nd gp gr ne nf"><a href="https://github.com/bharathirajatut/angular-examples/tree/master/angular-excel-example" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">bharathirajatu/angular-示例</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">此项目是使用Angular CLI版本8.3.5生成的。为开发服务器运行ng serve。导航到…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">github.com</p></div></div><div class="no l"><div class="nu l nq nr ns no nt jw nf"/></div></div></a></div><p id="2acc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以简单地下载上面提到的项目，并在您的本地机器上尝试。</p><h2 id="723c" class="mi kx iq bd ky nv nw dn lc nx ny dp lg kj nz oa lk kn ob oc lo kr od oe ls of bi translated">简单英语的JavaScript</h2><p id="2201" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae og" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="ka ir">！</strong></p></div></div>    
</body>
</html>