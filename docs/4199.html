<html>
<head>
<title>How to publish NPM packages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何发布NPM包</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-publish-npm-packages-6f70178fe789?source=collection_archive---------15-----------------------#2020-11-23">https://javascript.plainenglish.io/how-to-publish-npm-packages-6f70178fe789?source=collection_archive---------15-----------------------#2020-11-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1876c9eb05c84d79460d87095f0b5cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bkAEsheCmOt10vXp"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">NPM logo</figcaption></figure><p id="3721" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">假设你用JS开发了一个项目，并希望与世界分享，无论是一个简单的画了一个圈的项目(好吧，这可能不是你想要发布的包)还是一个复杂的项目，你想让成千上万像Jquery这样的开发者使用，你都可以在NPM上发布它们。</p><p id="15f2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们将分为三个部分:</p><ul class=""><li id="6e35" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">通过正常途径向NPM发布</li><li id="e811" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">使用GitHub动作来自动化发布</li><li id="311b" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">并使用GitHub动作来测试您的项目</li></ul></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="93af" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">所以，你有你的项目。当你准备好的时候，你希望它是一个可以打包发布的格式。所有NPM软件包都采用相同的格式:</p><figure class="ls lt lu lv gt jo"><div class="bz fp l di"><div class="lw lx l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Files needed for an NPM package</figcaption></figure><p id="f891" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">因此，<code class="fe ly lz ma mb b">index.js</code>文件是我们拥有基本代码的地方。你应该知道什么是<code class="fe ly lz ma mb b">README.md</code>，为了让你的项目在NPM有吸引力，我建议你放一个。<code class="fe ly lz ma mb b">LICENSE</code>文件很重要，你一定要选一个。你可以在choosealicense.com挑一个。</p><p id="2b56" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在你已经有了那些文件，(并且确保你不会没有它们而继续)我们可以继续到<code class="fe ly lz ma mb b">package.json</code>和<code class="fe ly lz ma mb b">package-lock.json</code>文件。这些告诉NPM关于包裹的事，所以这些是必需的。确保你已经安装了NPM和Node.js，如果没有，你可以在这里学习如何安装NPM <a class="ae mc" href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c839" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">因此，我们有NPM、Node.js和<code class="fe ly lz ma mb b">LICENSE</code>、<code class="fe ly lz ma mb b">README.md</code>和<code class="fe ly lz ma mb b">index.js</code>文件。要创建<code class="fe ly lz ma mb b">package.json</code>文件，只需打开您的终端或命令提示符，并运行以下命令:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="02c2" class="mh mi in mb b gy mj mk l ml mm">npm init</span></pre><p id="dc2a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这将引导您完成设置项目的命令，如果您不知道问题，可以随意跳过，但这应该不难。如果不想包含问题，也可以将问题留空。这也应该创建了<code class="fe ly lz ma mb b">package-lock.json</code>文件。如果您曾经创建过python包，<code class="fe ly lz ma mb b">package.json</code>文件基本上与<code class="fe ly lz ma mb b">setup.py</code>文件相同。</p><p id="dc44" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">虽然<code class="fe ly lz ma mb b">npm init</code>命令会引导您完成<code class="fe ly lz ma mb b">package.json </code>文件的一些基本部分，但是您还可以添加更多的内容，您可以在这里查看完整的列表<a class="ae mc" href="https://docs.npmjs.com/cli/v6/configuring-npm/package-json" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="7aac" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">确保您在<a class="ae mc" href="https://npmjs.org" rel="noopener ugc nofollow" target="_blank">https://npmjs.org</a>注册并拥有一个帐户来发布npm包，然后运行</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="56cb" class="mh mi in mb b gy mj mk l ml mm">npm login</span></pre><p id="1ddd" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在您的终端或命令提示符下。使用您在NPM上注册的帐户的凭据登录。</p><p id="aa8a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">好了，我们已经创建了所有的文件并登录，现在做什么。我们公布包裹！最后看一眼您的包，确保一切都如您所愿，确保有尽可能少的错误(如果有您没有注意到的错误，您可以将版本改为<code class="fe ly lz ma mb b">vX.X.X alpha</code>或<code class="fe ly lz ma mb b">vX.X.X beta</code>)，然后运行最后一个命令:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="10e0" class="mh mi in mb b gy mj mk l ml mm">npm publish</span></pre><p id="f660" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">好哇🎉🎉🎉！我们做到了！或者我们有吗？嗯……算是吧。如果你没有得到一个错误，你很好，但你可能会遇到一个错误，阻止它发布。这可能是因为其他人已经使用了您的软件包中的名称。如果它输出的错误类似于:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="0ffa" class="mh mi in mb b gy mj mk l ml mm">You do not have permission to publish [package-name]. Are you logged in as the correct user?</span></pre><p id="77f8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">那就是你的问题了。如果这是真的，有两个选择。第一种方法很明显，想一个不同的名字。但是如果你真的喜欢你的名字，想保留它，你可以给它定范围。这是许多人做的事情，虽然人们会看到它在NPM范围内，但它看起来并不坏。你只需把你的包名从<code class="fe ly lz ma mb b">name</code>改成<code class="fe ly lz ma mb b">@npmusername/package-name</code>。在NPM上将@npmusername替换为您的用户名，将package-name替换为您的包的原始名称。例如，如果你在NPM上的名字是QLabs，包名是minor，你可以把它改成<code class="fe ly lz ma mb b">@QLabs/minor</code>。假设您不想限定它的范围，那么您可以在它的末尾添加JS，这样<code class="fe ly lz ma mb b">minor</code>就变成了<code class="fe ly lz ma mb b">minorjs</code>或<code class="fe ly lz ma mb b">minorJS</code>。但是由于许多人使用它，它可能仍然会出现错误。</p><p id="e3bb" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，如果你仍然得到一个错误，告诉你升级你的NPM帐户需要花钱。那你的<code class="fe ly lz ma mb b">package.json</code>就没有错误。不运行<code class="fe ly lz ma mb b">npm publish</code>运行:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="a89b" class="mh mi in mb b gy mj mk l ml mm">npm publish --access public</span></pre><p id="8b73" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果不是这样，您可能在<code class="fe ly lz ma mb b">package.json</code>文件中犯了一个错误或者没有包含一个错误。否则，你应该把它放到<a class="ae mc" href="https://stackoverflow.com" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com</a>上来得到你的问题的答案。</p><p id="0c64" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">因此，我们已经修复了所有的错误并发布了这个包，现在我们测试一下我们是否正确地完成了这些步骤。我们使用<code class="fe ly lz ma mb b">npm install</code>命令。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="19b0" class="mh mi in mb b gy mj mk l ml mm">npm install [package-name]</span></pre><p id="9e0a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">如果在尝试修复错误时确定了作用域，请确保在安装时包含该作用域。</p><p id="a4d6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">所以，我们做到了！我们成功创建了一个NPM包！但是先别走。还有更多。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h1 id="2eba" class="mn mi in bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">使用GitHub Actions在NPM上自动发布新闻稿</h1><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/116714592a95f7c7f330048096aeb362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZnYd65n7TN6j_YST"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae mc" href="https://unsplash.com/@lukechesser?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Luke Chesser</a> on <a class="ae mc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1b48" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">由于几乎所有人都用GitHub，所以我真的建议你用GitHub，把你的源代码放到GitHub里。</p><p id="99e8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，大多数软件包都使用GitHub，GitHub提供了一些很酷的GitHub动作优势。如果你以前从未用过，不要担心。这很容易。</p><p id="05e1" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在GitHub上打开您的repo，然后进入“设置”&gt;“密码”并添加一个新的密码。命名为“NPM _令牌”，然后去NPM，登录，然后去“https://www . npmjs . com/settings/$ username/tokens”，为我们的GitHub secret的值创建一个新的访问令牌。</p><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/4e512510cb70e617b5b8898a3f580d6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FYSZfwq-216bWZWP.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">NPM Page when creating a new access token.</figcaption></figure><p id="eff8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">确保访问级别设置为“读取和发布”，然后点击“创建令牌”按钮。复制令牌并将其作为值粘贴到GitHub Secret中。</p><p id="9bf6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，在GitHub上，转到Actions选项卡。</p><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/26795e47dfe58ff19c6e644a758d6f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUBkBjDZi7d6I4tHkJWWHQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Screenshot of the GitHub Actions tab on a repository</figcaption></figure><p id="c209" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在GitHub Actions选项卡上，第一部分的标题应该是“为您的JavaScript库创建的工作流”在“发布Node.js包”工作流中单击“设置此工作流”。编辑器应该会弹出预构建的代码。替换为:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="d9ec" class="mh mi in mb b gy mj mk l ml mm">name: Publish</span><span id="8fd4" class="mh mi in mb b gy nn mk l ml mm">on:<br/>  release:<br/>    types: [published]<br/><br/>jobs:<br/>  build:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>      - uses: actions/checkout@v1<br/>      - uses: actions/setup-node@v1<br/>        with:<br/>          node-version: 12<br/>          registry-url: https://registry.npmjs.org/<br/>      - run: yarn install<br/>      - run: npm publish --access public<br/>        env:<br/>          NODE_AUTH_TOKEN: ${{secrets.NPM_TOKEN}}</span></pre><p id="16ab" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们过一遍这个动作。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="076b" class="mh mi in mb b gy mj mk l ml mm">name: Publish</span></pre><p id="dc63" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这会设置操作的名称，这是在创建操作后，当您转到repo上的“操作”选项卡时所看到的内容。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="1299" class="mh mi in mb b gy mj mk l ml mm">on:<!-- -->  <br/>  release:    <br/>    types: [published]</span></pre><p id="8c98" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这意味着它会在你每次在GitHub上发布一个版本时运行，所以你不必每次都去命令提示符下运行<code class="fe ly lz ma mb b">npm publish</code>来发布一个新版本。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="534d" class="mh mi in mb b gy mj mk l ml mm">jobs:<!-- -->  <br/>  build:    <br/>    runs-on: ubuntu-latest</span></pre><p id="0101" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这将配置作业<code class="fe ly lz ma mb b">build</code>并将其设置为最新版本的Ubuntu。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="05a9" class="mh mi in mb b gy mj mk l ml mm">steps:<br/>  - uses: actions/checkout@v1<br/>  - uses: actions/setup-node@v1<br/>  with:<br/>    node-version: 12<br/>    registry-url: https://registry.npmjs.org/<br/>  - run: yarn install<br/>  - run: npm publish --access public<br/>    env:<br/>      NODE_AUTH_TOKEN: ${{secrets.NPM_TOKEN}}</span></pre><p id="e609" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这是我们放置作业运行步骤的地方。它是这样做的:</p><ul class=""><li id="c5f2" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">获取回购文件</li><li id="2994" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">使用NPM的注册表URL安装Node.js，版本12。</li><li id="3a6b" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">通过<code class="fe ly lz ma mb b">yarn install</code>安装软件包依赖项</li><li id="fefd" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">运行<code class="fe ly lz ma mb b">npm publish</code>命令，<code class="fe ly lz ma mb b">--access public</code>阻止我们之前的错误发生。它使用环境变量<code class="fe ly lz ma mb b">NODE_AUTH_TOKEN</code>运行，该变量被设置为我们之前设置的秘密。</li></ul><p id="6855" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，每次GitHub上发布一个新版本，它都会自动在NPM上发布一个。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h1 id="6b89" class="mn mi in bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">在您的NPM项目中使用GitHub Actions for CI</h1><figure class="ls lt lu lv gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi no"><img src="../Images/10fd633f2f54ecd3caee5d6581d03cdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y2JDBNIX6IQ6Lwmm"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae mc" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Winkler</a> on <a class="ae mc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="69f7" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们已经用GitHub Actions实现了自动化发布，那么我们还能用GitHub做些什么呢？嗯，GitHub提供了一种使用GitHub动作进行CI的简单方法。</p><p id="ff21" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">去吧。github/workflows目录下你的repo，并创建一个新文件。在他们的文档上粘贴GitHub提供的模板:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="24c6" class="mh mi in mb b gy mj mk l ml mm">name: Node.js Package<br/>on:<br/>  release:<br/>    types: [created]<br/>jobs:<br/>  build:<br/>    runs-on: ubuntu-latest<br/>    steps:<br/>    - uses: actions/checkout@v2<br/>    - uses: actions/setup-node@v1<br/>      with:<br/>        node-version: '12.x'<br/>        registry-url: 'https://registry.npmjs.org'<br/>    - run: npm install<br/>    - run: npm publish<br/>      env:<br/>        NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}</span></pre><p id="da7b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">让我们来看一下这个工作流程。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="cff1" class="mh mi in mb b gy mj mk l ml mm">name: Node.js CI</span></pre><p id="1730" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">名称，您可以将其更改为您希望在操作选项卡上显示的名称。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="c01b" class="mh mi in mb b gy mj mk l ml mm">on: [push]</span></pre><p id="0448" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">每次你向回购协议提交一些东西的时候都会运行。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="7f48" class="mh mi in mb b gy mj mk l ml mm">jobs:<!-- -->  <br/>  build:<br/>    runs-on: ubuntu-latest</span></pre><p id="ba31" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这将设置操作系统来测试它。根据您想要测试的内容，您可以将其更改为<code class="fe ly lz ma mb b">windows-latest</code>或<code class="fe ly lz ma mb b">macos-latest</code>。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="65d5" class="mh mi in mb b gy mj mk l ml mm">strategy:<br/>  matrix:<br/>    node-version: [8.x, 10.x, 12.x]</span></pre><p id="7a06" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这决定了要测试的节点版本，您可以添加或删除要测试的版本。</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="ead5" class="mh mi in mb b gy mj mk l ml mm">steps:<br/>    - uses: actions/checkout@v2<br/>    - name: Use Node.js ${{ matrix.node-version }}<br/>      uses: actions/setup-node@v1<br/>      with:<br/>        node-version: ${{ matrix.node-version }}<br/>    - run: npm install<br/>    - run: npm run build --if-present<br/>    - run: npm test<br/>      env:<br/>        CI: true</span></pre><p id="c7b6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们应该关注的是最后一点:</p><pre class="ls lt lu lv gt md mb me mf aw mg bi"><span id="df82" class="mh mi in mb b gy mj mk l ml mm">- run: npm install<br/>- run: npm run build --if-present<br/>- run: npm test<br/>  env:<br/>    CI: true</span></pre><p id="d91d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">这个:</p><ul class=""><li id="4de5" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">使用<code class="fe ly lz ma mb b">npm install</code>安装软件包依赖项</li><li id="0873" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">通过<code class="fe ly lz ma mb b">npm run build</code>运行<code class="fe ly lz ma mb b">package.json</code>中定义的构建步骤</li><li id="887d" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">Run的<code class="fe ly lz ma mb b">npm test</code>运行你的测试脚本，这也是在你<code class="fe ly lz ma mb b">package.json</code>中定义的</li></ul><p id="ca60" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我建议你阅读<a class="ae mc" href="https://docs.github.com/en/free-pro-team@latest/actions/guides/building-and-testing-nodejs" rel="noopener ugc nofollow" target="_blank">build and testing node . js</a>上GitHub Actions 的<a class="ae mc" href="https://docs.github.com/en/free-pro-team@latest/actions" rel="noopener ugc nofollow" target="_blank">文档。</a></p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><p id="8c47" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我们做到了！🎉🎉🎉我们成功发布了NPM套餐！🎉🎉🎉但不是这样的！我们用GitHub Actions自动化发布并测试了我们的项目。</p><p id="6f56" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">现在，<a class="ae mc" href="http://npmjs.org" rel="noopener ugc nofollow" target="_blank"> NPM </a>看起来像是一个好的包管理器，但是另一个JS包管理器已经出现了:<a class="ae mc" href="http://yarnpkg.com" rel="noopener ugc nofollow" target="_blank"> Yarn </a>(也有<a class="ae mc" href="http://pnpm.js.org" rel="noopener ugc nofollow" target="_blank"> pnpm </a>，但是我不怎么用它)。那么用哪个呢？NPM是必须的，因为Yarn不能发布包，但是Yarn的效率非常好。我的选择是两个都用，因为Yarn安装得更快，而NPM需要更长时间(虽然不是很长)，NPM可以发布包和其他事情Yarn不能做。如果你正在决定，你真的应该看看<a class="np nq ep" href="https://medium.com/u/8be6309d249e?source=post_page-----6f70178fe789--------------------------------" rel="noopener" target="_blank"> Harsha Vardhan </a>出版的<a class="ae mc" href="https://medium.com/javascript-in-plain-english?source=false---------1" rel="noopener">JavaScript in Plain English</a>中的<a class="ae mc" href="https://medium.com/javascript-in-plain-english/npm-vs-yarn-choosing-the-right-package-manager-a5f04256a93f?source=false---------1" rel="noopener">这篇</a>文章。</p></div><div class="ab cl ll lm hr ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ig ih ii ij ik"><h1 id="45d8" class="mn mi in bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">进一步阅读、示例和软件包管理器</h1><ul class=""><li id="6ff2" class="kx ky in kb b kc nr kg ns kk nt ko nu ks nv kw lc ld le lf bi translated"><a class="ae mc" href="https://medium.com/javascript-in-plain-english/npm-vs-yarn-choosing-the-right-package-manager-a5f04256a93f?source=false---------1" rel="noopener">Harsha vard Han</a>在<a class="ae mc" href="https://medium.com/javascript-in-plain-english?source=false---------1" rel="noopener">JavaScript in Plain English</a>出版物上发表的这篇文章解释了纱和NPM的区别。</li><li id="1f9f" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae mc" href="http://npmjs.com" rel="noopener ugc nofollow" target="_blank"> NPM </a></li><li id="5e05" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae mc" href="http://pnpm.js.org" rel="noopener ugc nofollow" target="_blank"> pnpm </a></li><li id="8d49" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae mc" href="http://yarnpkg.com" rel="noopener ugc nofollow" target="_blank">纱线</a></li><li id="92df" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae mc" href="https://medium.com/javascript-in-plain-english/an-abbreviated-history-of-javascript-package-managers-f9797be7cf0e" rel="noopener">Matt gold water</a>出版的<a class="ae mc" href="https://medium.com/javascript-in-plain-english?source=false---------1" rel="noopener"> JavaScript in Plain English </a>中的这篇文章解释了所有软件包管理器的历史以及他们解决的问题。</li><li id="5a56" class="kx ky in kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated"><a class="ae mc" href="https://zellwk.com/blog/publish-to-npm/" rel="noopener ugc nofollow" target="_blank">这篇关于<a class="ae mc" href="http://zellwk.com" rel="noopener ugc nofollow" target="_blank">zellwk.com</a>的</a>文章，作者<a class="np nq ep" href="https://medium.com/u/7ec6bd4cf41f?source=post_page-----6f70178fe789--------------------------------" rel="noopener" target="_blank"> Zell Liew </a>，是一篇关于发布NPM软件包和使用NPM测试软件包的非常好的教程。</li></ul></div></div>    
</body>
</html>