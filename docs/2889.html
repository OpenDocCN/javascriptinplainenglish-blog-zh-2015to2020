<html>
<head>
<title>JavaScript Best Practices — Performance and Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—性能和测试</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-performance-and-tests-1efe114c6ab7?source=collection_archive---------7-----------------------#2020-08-01">https://javascript.plainenglish.io/javascript-best-practices-performance-and-tests-1efe114c6ab7?source=collection_archive---------7-----------------------#2020-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c3bf781f137bf061b25e4d93b48e9894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YiDIyJ8O_xy76Pga"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@tiagogerken?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tiago Gerken</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7baf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究在编写JavaScript代码时应该遵循的一些最佳实践。</p><h1 id="cacf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">RAIL模型</h1><p id="959b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">RAIL模型是由谷歌创建的，让我们从用户的角度来考虑性能。</p><p id="9f41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">RAIL表示响应、动画、空闲和负载。</p><p id="490f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">响应是页面第一次响应用户输入的时间。</p><p id="bdeb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">动画是当页面移动时。</p><p id="afbe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">空闲是页面空闲的时间。</p><p id="5c75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">加载是页面加载所需的时间。</p><p id="ff5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该让我们的应用程序尽快响应互动。</p><h1 id="2385" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">查找内存泄漏</h1><p id="81ec" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该用各种工具检查内存泄漏。</p><p id="851f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个很好的工具是Chrome开发工具，它有性能来显示我们应用程序中内存的使用情况。</p><p id="52d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以用Chrome任务管理器检查一个标签的内存使用情况。</p><p id="c724" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">时间线记录，直观显示随时间推移的内存使用情况。</p><p id="59b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">堆快照帮助我们识别分离的DOM树。</p><p id="2f9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分配时间线记录让我们能够发现何时在我们的JS堆中分配了新的内存。</p><p id="bea1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果内存使用量随着时间的推移而增加，直到所有可用内存都被使用时，我们就知道内存泄漏了。</p><h1 id="7098" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用网络工作人员执行密集型任务</h1><p id="a7ce" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们的应用程序有密集型任务，我们可以使用网络工作人员在后台运行它们。</p><p id="52da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它通过向工作人员发送输入来工作，然后当工作人员完成时，结果被发送回主应用程序。</p><p id="f507" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们在不同的线程上工作，所以他们不会阻塞主线程。</p><h1 id="220a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">当心计算复杂性</h1><p id="ba29" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该意识到我们使用的算法的计算复杂性。</p><p id="01be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">应该避免嵌套循环和其他缓慢的代码。</p><h1 id="b169" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简化</h1><p id="8c20" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们能以更简单的方式写一些东西，那么我们就应该这样做。</p><h1 id="3858" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免递归调用</h1><p id="6796" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果有一种迭代的方式来代替递归，那么我们应该使用迭代。</p><p id="5aef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它更容易阅读，性能也很好。</p><h1 id="4f57" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">正则表达式</h1><p id="189c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用正则表达式来搜索字符串中的模式。</p><p id="74e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以用它们来提取信息。</p><p id="4f96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2c9b" class="mn lc iq mj b gy mo mp l mq mr">str.replace(/\s+/g, '');</span></pre><p id="6fcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">修剪空白。</p><p id="4ab2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以通过以下方式检查电子邮件地址格式:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="91ad" class="mn lc iq mj b gy mo mp l mq mr">function validateEmail(email) {<br/>  const re = /\S+@\S+\.\S+/;<br/>  return re.test(email);<br/>}</span></pre><h1 id="f2f3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用搜索数组</h1><p id="05d1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过<code class="fe ms mt mu mj b">find</code>功能搜索数组。</p><p id="06cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6af6" class="mn lc iq mj b gy mo mp l mq mr">let array = [1, 2, 3, 4, 5];<br/>let found = array.find((element) =&gt; {<br/>  return element &gt; 2;<br/>});</span></pre><p id="925c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">查找数组中的元素。</p><p id="3a95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以通过检查数组中的某个东西来避免<code class="fe ms mt mu mj b">switch</code>语句，而不是将每个数组条目用作<code class="fe ms mt mu mj b">case</code>。</p><h1 id="2b80" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用谷歌灯塔</h1><p id="d558" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">灯塔是一个很好的工具来检查我们的浏览器应用程序的性能。</p><p id="15d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它检查性能、可访问性、最佳实践和搜索引擎优化。</p><p id="e88b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">灯塔运行在灯塔选项卡的Chrome开发工具中，它也可以作为节点包提供，因此我们可以自动运行检查。</p><h1 id="144a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">谷歌页面速度</h1><p id="fea1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">谷歌页面速度让我们了解网站的性能优化，并找到我们可以改进的地方。</p><p id="d03c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它用于识别与Google的web性能最佳实践的一致性问题。</p><h1 id="e096" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">JavaScript导航计时API</h1><p id="734a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">JavaScript导航计时API让我们可以测量网站的性能。</p><p id="57f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过书写来使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3cf3" class="mn lc iq mj b gy mo mp l mq mr">const perfData = window.performance.timing; <br/>const pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;</span></pre><p id="6593" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需减去<code class="fe ms mt mu mj b">loadEventEnd</code>和<code class="fe ms mt mu mj b">navigationStarty</code>时间戳就可以得到加载时间。</p><p id="6813" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以用以下公式计算请求响应时间:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="edea" class="mn lc iq mj b gy mo mp l mq mr">const connectTime = perfData.responseEnd - perfData.requestStart;</span></pre><p id="d9c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和页面呈现时间:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a09f" class="mn lc iq mj b gy mo mp l mq mr">const renderTime = perfData.domComplete - perfData.domLoading;</span></pre><p id="1279" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这描述的是1级API，现在已经弃用了，但是2级即将到来。</p><p id="429b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用这个直到2级可用。</p><h1 id="147a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">测试我们的代码</h1><p id="bb5c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该用单元测试、集成测试和用户界面测试来测试我们的代码。</p><p id="dae7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">单元测试测试代码的一小部分，比如函数。</p><p id="54f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">集成测试测试更大的代码部分，比如多个函数或类。</p><p id="3f25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">UI测试从用户的角度进行测试，但是以自动化的方式进行。</p><p id="cf03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击和视觉检查完成。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/9cfd7f0148b68fbf79ab043d959277be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*net_MJZA1HoJcWGS"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@harleydavidson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Harley-Davidson</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="fa5f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="9210" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该确保我们的应用程序性能良好。</p><p id="40eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们应该以各种方式测试我们的代码。</p><h2 id="a846" class="mn lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">简单英语的JavaScript</h2><p id="9ec5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>