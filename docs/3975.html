<html>
<head>
<title>Why Factories are better than Classes in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么JavaScript中工厂比类更好</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/why-factories-are-better-than-classes-in-javascript-1248b600b6d4?source=collection_archive---------0-----------------------#2020-11-07">https://javascript.plainenglish.io/why-factories-are-better-than-classes-in-javascript-1248b600b6d4?source=collection_archive---------0-----------------------#2020-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="48dc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过一个例子了解为什么应该使用JavaScript工厂而不是类</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/34c32b55bb8d663ca9030b840329b4c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s-JjyGD69MsY8ZIrbNVgkQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"><strong class="bd kw">Pixabay</strong></a> from <a class="ae kv" href="https://www.pexels.com/photo/rocket-factory-256297/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"><strong class="bd kw">Pexels</strong></a></figcaption></figure><p id="140e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你知道为什么我们经常用工厂而不是类来创建对象吗？</p><p id="9568" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我没有。作为一名被迫在fullstack自由职业期间编写JS的后端开发人员，我编写工厂是因为“其他代码看起来就是这样”。</p><p id="76a7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是个糟糕的理由。区别很简单，基本的理解会让你省心。</p><p id="0b16" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">简单来说，<strong class="kz ir">一个</strong> <strong class="kz ir">工厂就是一个返回对象</strong>的函数，而<strong class="kz ir">一个类就是一个对象</strong>的模板。</p><p id="07b3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是让我们通过一个<code class="fe lt lu lv lw b">RocketShip</code>类的例子来理解行为是如何不同的。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="adb9" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">建造一艘基于职业的火箭船</h1><p id="3840" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">完成<a class="ae kv" href="https://codepen.io/chris898/pen/WNxgONj" rel="noopener ugc nofollow" target="_blank">码笔</a>。</p><p id="e8e2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们写一个实例化火箭船的类。它将能够“飞行”和“着陆”。很刺激吧。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="54f3" class="nf mf iq lw b gy ng nh l ni nj">class RocketShip {<br/>  constructor(color){<br/>    this.color = color;<br/>  }<br/>  fly(){<br/>    console.log(`The ${this.color} rocketship is flying!`)<br/>  }<br/>  land(){<br/>    console.log(`The ${this.color} rocketship has landed.`)<br/>  }<br/>}</span></pre><p id="0f78" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后实例化该类的一个实例。一艘蓝色的火箭船。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="0028" class="nf mf iq lw b gy ng nh l ni nj">const r1 = new RocketShip('blue');</span></pre><p id="81ab" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">驾驶它，着陆它，获得它的颜色。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="cc94" class="nf mf iq lw b gy ng nh l ni nj">r1.fly()<br/>r1.land()<br/>console.log(r1.color)<br/>#=&gt; <!-- -->The blue rocketship is flying!<br/>#=&gt; The blue rocketship has landed.<br/>#=&gt; blue</span></pre><p id="f507" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">厉害！</p><h2 id="2cd2" class="nf mf iq bd mg nk nl dn mk nm nn dp mo lg no np mq lk nq nr ms lo ns nt mu nu bi translated">问题1:公共属性</h2><p id="d974" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">牛逼，不牛逼。我们可以创建一个火箭船实例，但是它的颜色可以从外面改变。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="8cce" class="nf mf iq lw b gy ng nh l ni nj">r1.color = 'sad'<br/>console.log(r1.color)<br/>r1.fly()<br/>#=&gt; sad<br/>#=&gt;The sad rocketship is flying!</span></pre><p id="d170" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，我们驾驶的不是一艘“蓝色”的火箭飞船，而是一艘“悲伤”的火箭飞船。这可不好。</p><p id="cfa1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用类，可以从对象外部编辑属性。你甚至可以像这样编辑方法。</p><h2 id="1c28" class="nf mf iq bd mg nk nl dn mk nm nn dp mo lg no np mq lk nq nr ms lo ns nt mu nu bi translated">问题2:“this”关键字</h2><p id="ab22" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">添加html和jquery，这样我们只需点击一个按钮就可以发射火箭。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="7a2a" class="nf mf iq lw b gy ng nh l ni nj"><strong class="lw ir">// html</strong><br/>&lt;h1&gt;Launch Rocket Ship from Class&lt;/h1&gt;<br/>&lt;button&gt;Launch&lt;/button&gt;</span><span id="4697" class="nf mf iq lw b gy nv nh l ni nj"><br/><strong class="lw ir">// css</strong><br/>h2 {<br/> font-size: 2rem;<br/> font-weight: bolder;<br/> margin-bottom: 1rem;<br/>}</span><span id="c6ad" class="nf mf iq lw b gy nv nh l ni nj">button {<br/> cursor: pointer;<br/> appearance: none;<br/> border-radius: 4px;<br/> font-size: 1.25rem;<br/> padding: 0.75rem 1rem;<br/> border: 1px solid navy;<br/> background-color: dodgerblue;<br/> color: white;<br/>}</span><span id="0af5" class="nf mf iq lw b gy nv nh l ni nj"><strong class="lw ir">// JS</strong><br/>$('button').click(r1.fly)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/0253357119fb7c41ffe9cf77486c62c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UJgehSJrr_68EARGWWf9IQ.png"/></div></div></figure><p id="8f4c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在点击按钮</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="d2a4" class="nf mf iq lw b gy ng nh l ni nj">#=&gt; The undefined rocketship is flying!</span></pre><p id="7032" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">哦不。这是怎么回事？“颜色”未定义！</p><p id="3b67" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是因为“This”关键字的作用范围不是对象本身，而是指向DOM中的另一个对象。</p><h2 id="212a" class="nf mf iq bd mg nk nl dn mk nm nn dp mo lg no np mq lk nq nr ms lo ns nt mu nu bi translated">这可以通过以下任一方法解决:</h2><ol class=""><li id="4bb5" class="nx ny iq kz b la mw ld mx lg nz lk oa lo ob ls oc od oe of bi translated"><code class="fe lt lu lv lw b">$('button').click(r1.fly.bind(r1))</code></li><li id="e1f4" class="nx ny iq kz b la og ld oh lg oi lk oj lo ok ls oc od oe of bi translated"><code class="fe lt lu lv lw b">$('button').click(_ =&gt; r1.fly())</code></li></ol><p id="350f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是它们给我一种轻微的代码味道…</p><p id="bf98" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">也许我们可以用工厂来解决这个问题。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="7cce" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">建造一艘基于工厂的火箭船</h1><p id="c7c3" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">完成<a class="ae kv" href="https://codepen.io/chris898/pen/KKMxWbw" rel="noopener ugc nofollow" target="_blank">码笔</a>。</p><p id="b9eb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们允许实例化同一个对象，但是使用工厂。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="eaf0" class="nf mf iq lw b gy ng nh l ni nj">const RocketShipFactory = (c) =&gt; {<br/>  const color = c<br/>  <br/>  return {<br/>    fly: () =&gt; console.log(`The ${color} rocketship has launched.`),<br/>    land: () =&gt; console.log(`The ${color} rocketship has landed.`)<br/>  } <br/>}</span></pre><p id="2969" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在从工厂创建一个火箭船的实例。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="2d32" class="nf mf iq lw b gy ng nh l ni nj">const r2 = RocketShipFactory('pink')</span></pre><p id="ef50" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">注意这里我们甚至不需要<code class="fe lt lu lv lw b">new</code>关键字，就像我们从类中实例化一个实例时一样。</p><p id="087d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们调用它的方法。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="7844" class="nf mf iq lw b gy ng nh l ni nj">r2.fly()<br/>r2.land()<br/>#=&gt; "The pink rocketship has launched."<br/>#=&gt; "The pink rocketship has landed."</span></pre><p id="fd28" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们能从外面改变它的颜色吗？</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="bd01" class="nf mf iq lw b gy ng nh l ni nj">r2.color = 'purple'<br/>r2.fly()<br/>#=&gt; "The pink rocketship has launched."</span></pre><p id="b92c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">是的。酪它将不再影响使用该颜色的方法。原始颜色现在被硬编码到这些方法返回的内容中。</p><p id="07be" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="ol">感谢</em><a class="om on ep" href="https://medium.com/u/71af155f6204?source=post_page-----1248b600b6d4--------------------------------" rel="noopener" target="_blank"><em class="ol">Artem Streltsov</em></a><em class="ol">帮忙解释一下。</em></p><p id="a972" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在让我们把它附在我们的按钮上。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="70b8" class="nf mf iq lw b gy ng nh l ni nj">$('button').click(r2.fly)<br/>$('button').click(r2.land)</span></pre><p id="29a8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后点击按钮。</p><pre class="kg kh ki kj gt nb lw nc nd aw ne bi"><span id="b6db" class="nf mf iq lw b gy ng nh l ni nj">#=&gt; "The pink rocketship has launched."<br/>#=&gt; "The pink rocketship has landed."</span></pre><p id="585a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">放松点皮兹。这里一点代码味都没有。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="2ee4" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">结论</h1><p id="7302" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">你可能已经用过工厂了。现在你知道你为什么要写它们了。</p><p id="e54d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">虽然差异可能看起来微不足道，但由于避免了<code class="fe lt lu lv lw b">this</code>关键字，工厂对bug更加健壮。你应该在几乎所有的情况下使用它们。</p><p id="879d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">类的实例化稍微快一些，但是我们说的是几分之一毫秒。通常，在99.99%的情况下，选择可读性胜过速度。</p><p id="2e55" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我错过了什么重要的区别吗？请在评论中告诉我。</p><p id="a96f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="ol">跟进帖:</em> <a class="ae kv" href="https://medium.com/javascript-in-plain-english/factories-are-still-better-than-classes-in-javascript-47f15071904e" rel="noopener"> <em class="ol">工厂还是比JavaScript里的类</em> </a> <em class="ol">。</em></p></div></div>    
</body>
</html>