<html>
<head>
<title>JavaScript Unit Test Best Practices — Basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript单元测试最佳实践—基础</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-unit-test-best-practices-basics-d411dc1968c?source=collection_archive---------4-----------------------#2020-08-21">https://javascript.plainenglish.io/javascript-unit-test-best-practices-basics-d411dc1968c?source=collection_archive---------4-----------------------#2020-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3d348afba10c2ab23f1e4e9b573914ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FQEZMJnosbnCzsgR"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mags666?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">maggie bell</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b7e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">单元测试对于检查我们的应用程序如何工作非常有用。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看在编写JavaScript单元测试时应该遵循的一些最佳实践。</p><h1 id="21d1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">单元测试</h1><p id="4623" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每个单元测试测试一个工作单元。</p><p id="96a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它可能涉及多个返回值或抛出异常的方法或类。</p><p id="acda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们还可以测试系统中的状态变化。</p><p id="966c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以测试第三方API调用。</p><p id="d505" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个测试都应该相互隔离。</p><p id="ec87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">任何行为都应该只有一个测试。</p><p id="c07c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而且他们也影响不了别人。</p><h1 id="4b60" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">单元测试是轻量级测试</h1><p id="8401" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">轻量级测试是可重复的、快速的、一致的，并且易于编写和阅读。</p><p id="8432" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">单元测试也编码。</p><p id="016b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们应该满足与被测试代码相同的质量。</p><p id="d860" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以对它们进行重构，使它们更易于维护和阅读。</p><h1 id="ae95" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">设计原则</h1><p id="2e26" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们的代码应该是可测试的。</p><p id="a8fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该避免好的命名约定，并评论为什么我们有代码。</p><p id="af07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">评论不能代替糟糕的设计。</p><p id="08fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们应该避免任何重复。</p><p id="cdfa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每段代码都应该有一个单独的职责，这样单元测试就可以测试它。</p><p id="457f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的代码也应该在同一个组件中有一个单一的抽象层次。</p><p id="3f26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该在同一方法中将业务逻辑与其他技术细节混在一起。</p><p id="e417" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们的代码应该是可配置的，以便我们可以在测试时在任何环境中运行我们的代码。</p><p id="abe2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们应该采用依赖注入这样的模式，将对象创建与业务逻辑分开。</p><p id="7ac1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">全局可变状态也很难测试和调试，所以我们应该避免它们。</p><h1 id="19b8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用TDD</h1><p id="5648" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">测试驱动开发是交互测试软件组件的好方法。</p><p id="223a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以在每次测试中检查每个部分的行为。</p><p id="c866" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">工作流程是我们从编写一个失败的测试开始。</p><p id="7eda" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们用新的代码变更使测试通过。</p><p id="f8c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们清理代码，确保它仍然适用于我们的测试。</p><p id="c027" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试第一周期使代码设计可测试。</p><p id="c10d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">小的变化是可维护的。</p><p id="07e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而且代码库可以很容易地用重构来增强，因为我们可以用测试来测试它。</p><p id="ccde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">频繁地、小幅度地改变颂歌也更便宜。</p><p id="f361" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试产生了增加功能、修复错误和探索新设计的信心。</p><h1 id="191c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">适当地构造测试</h1><p id="56ec" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该适当地组织我们的测试。</p><p id="81fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以嵌套测试子集。</p><p id="5504" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而不是写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a0b4" class="mn lc iq mj b gy mo mp l mq mr">describe('A set of functionalities', () =&gt; {<br/>  it('should do something nice', () =&gt; {<br/>  });</span><span id="8605" class="mn lc iq mj b gy ms mp l mq mr">  it('some feature should do something great', () =&gt; {<br/>  });</span><span id="c896" class="mn lc iq mj b gy ms mp l mq mr">  it('some feature should do something good', () =&gt; {<br/>  });</span><span id="451c" class="mn lc iq mj b gy ms mp l mq mr">  it('another subset of features should also do something ', () =&gt; {<br/>  });<br/>});</span></pre><p id="8201" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ad7c" class="mn lc iq mj b gy mo mp l mq mr">describe('A set of functionalities', () =&gt; {<br/>  it('should do something nice', () =&gt; {<br/>  });</span><span id="c4f5" class="mn lc iq mj b gy ms mp l mq mr">  describe('some feature', () =&gt; {<br/>    it('should do something great', () =&gt; {<br/>    });</span><span id="1532" class="mn lc iq mj b gy ms mp l mq mr">    it('should do something awesome', () =&gt; {<br/>    });<br/>  });</span><span id="47a8" class="mn lc iq mj b gy ms mp l mq mr">  describe('another subset of features', () =&gt; {<br/>    it('should also do something great', () =&gt; {<br/>    });<br/>  });<br/>});</span></pre><p id="964a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，不要过度嵌套，因为它很难阅读。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/930caba5b21794d9f18502ed752339e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YY55IMvYe-92GleW"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@joyceromero?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joyce Romero</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7d3e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="f24c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">单元测试是测试应用程序一小部分的测试。我们可以把他们组织成小组。</p><h2 id="012e" class="mn lc iq bd ld mu mv dn lh mw mx dp ll ko my mz lp ks na nb lt kw nc nd lx ne bi translated">简单英语的JavaScript</h2><p id="d77d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有三份出版物和一个YouTube频道吗？在<a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">寻找一切的链接plainenglish.io </strong> </a>！</p></div></div>    
</body>
</html>