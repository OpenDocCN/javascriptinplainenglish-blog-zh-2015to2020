<html>
<head>
<title>Simplify your React code using shorter ES6 setState syntax</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用更短的ES6 setState语法简化React代码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simplify-your-react-code-using-shorter-es6-setstate-syntax-8643432244bb?source=collection_archive---------5-----------------------#2019-12-03">https://javascript.plainenglish.io/simplify-your-react-code-using-shorter-es6-setstate-syntax-8643432244bb?source=collection_archive---------5-----------------------#2019-12-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0147" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">编写setState调用的简单而简短的方法</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/7235d84f7b921cf2d22d9b10f983e52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MF4wCa_u4sgqlyAY"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@_ferh97?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Fernando Hernandez</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="475c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本文中，我们将看到如何使用新的ES6更短的语法，这将使<code class="fe lp lq lr ls b">setState</code>调用更加简单。所以我们先从一些背景知识开始。</p><p id="4537" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">看看下面的箭头功能。</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="a1a2" class="lx ly in ls b gy lz ma l mb mc">// Example 1</span><span id="1810" class="lx ly in ls b gy md ma l mb mc">const getName = () =&gt; {<br/> return "David";<br/>}</span></pre><p id="74bd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">上面的arrow函数只有一行代码。如果arrow函数中只有一行代码，我们可以隐式地返回它，而不添加return关键字，这样我们可以使上面的代码更短，如下所示</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="44c1" class="lx ly in ls b gy lz ma l mb mc">// Example 2<br/>const getName = () =&gt; "David";</span></pre><p id="d974" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例1和示例2将产生完全相同的输出。示例2只是示例1的一个较短的语法。</p><p id="5732" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如您所知，如果函数中有多行代码，我们将这些语句写在花括号({})中，并显式指定return语句。</p><p id="375c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们从一个函数返回一个对象，我们把它写成</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="ee66" class="lx ly in ls b gy lz ma l mb mc">const getObject = () =&gt; {<br/> return {<br/>  name: "David",<br/>  age: 30<br/> };<br/>};</span></pre><p id="699b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以将上面的代码简化为</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="01bd" class="lx ly in ls b gy lz ma l mb mc">const getObject = () =&gt; ({<br/> name: "David",<br/> age: 30<br/>});</span></pre><p id="1eb2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这里，我们直接将对象添加到圆括号( )中，这将隐式地返回对象，而不需要return语句。</p><p id="1e4f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在让我们看看如何在<code class="fe lp lq lr ls b">setState</code>呼叫中使用它。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="299f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现场演示:<a class="ae ks" href="https://codesandbox.io/s/twilight-sea-lnk6z" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/twilight-sea-lnk6z</a></p><p id="9190" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果您想知道状态是如何直接写在组件内部而不是构造函数中的，以及为什么没有。为事件监听器添加绑定函数调用，查看我以前的文章<a class="ae ks" href="https://medium.com/javascript-in-plain-english/how-to-write-clean-and-easy-to-understand-react-code-using-class-properties-syntax-5b375b0618d3?source=friends_link&amp;sk=c170992cab9025fddb7b34b8894ea993" rel="noopener">这里</a>详细解释了它。</p><p id="34aa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">看看上面代码中的<code class="fe lp lq lr ls b">handleAddOne</code>方法中的<code class="fe lp lq lr ls b">setState</code>方法</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="cdb0" class="lx ly in ls b gy lz ma l mb mc">this.setState(prevState =&gt; {<br/> return {<br/>  counter: prevState.counter + 1<br/> };<br/>});</span></pre><p id="5b8e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如您所见，这个<code class="fe lp lq lr ls b">setState</code>调用几乎占用了五行代码。也很容易忘记添加return关键字，比如</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="9064" class="lx ly in ls b gy lz ma l mb mc">// without return keyword<br/>this.setState(prevState =&gt; {<br/> {<br/>  counter: prevState.counter + 1<br/> };<br/>});</span></pre><p id="6783" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">即使您错过了return语句，上面的<code class="fe lp lq lr ls b">setState</code>调用without return关键字也不会抛出任何错误，但它不会像预期的那样工作。为了克服这些问题，我们可以将其简化为</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="0a45" class="lx ly in ls b gy lz ma l mb mc">this.setState(prevState =&gt; ({<br/> counter: prevState.counter + 1<br/>}));</span></pre><p id="c691" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在看起来更短了。</p><p id="3673" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以进一步缩短它，因为函数中只有一条语句</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="f56f" class="lx ly in ls b gy lz ma l mb mc">this.setState(prevState =&gt; ({ counter: prevState.counter + 1 }) );</span></pre><p id="c2e6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">哇，我们已经将<code class="fe lp lq lr ls b">setState</code>通话从五行转换成了一行。</p><p id="52ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们需要设置不止一个状态属性，那么把它放在不止一行是完全可以的</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="11c9" class="lx ly in ls b gy lz ma l mb mc">this.setState(prevState =&gt; ({<br/>  counter: prevState.counter + 1,<br/>  name: 'Jane'<br/> })<br/>);</span></pre><p id="5e59" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，假设我们在状态中有一个数字数组，我们想要删除数组中的所有元素，我们使用下面的<code class="fe lp lq lr ls b">setState</code>调用</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="84e5" class="lx ly in ls b gy lz ma l mb mc">this.setState(() =&gt; {<br/> return {<br/>  numbers: []<br/> }<br/>});</span></pre><p id="e9f1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一如既往，我们可以将其简化为</p><pre class="kd ke kf kg gt lt ls lu lv aw lw bi"><span id="6835" class="lx ly in ls b gy lz ma l mb mc">this.setState(() =&gt; ({ numbers: [] }) );</span></pre><p id="765d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用这种更短的返回对象的语法，不需要任何配置更改或任何安装。它是ES6语法，所以默认情况下在create-react-all中可用。T3】</p></div><div class="ab cl mh mi hr mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ig ih ii ij ik"><p id="9411" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">看看我最近出版的<a class="ae ks" href="https://master-redux.yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank">精通Redux </a>课程。</p><p id="8b1e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本课程中，您将构建3个应用程序以及一个点餐应用程序，您将了解:</p><ul class=""><li id="4db4" class="mo mp in kv b kw kx kz la lc mq lg mr lk ms lo mt mu mv mw bi translated">基本和高级冗余</li><li id="7c37" class="mo mp in kv b kw mx kz my lc mz lg na lk nb lo mt mu mv mw bi translated">如何管理数组和对象的复杂状态</li><li id="d4f8" class="mo mp in kv b kw mx kz my lc mz lg na lk nb lo mt mu mv mw bi translated">如何使用多个减速器管理复杂的冗余状态</li><li id="f59a" class="mo mp in kv b kw mx kz my lc mz lg na lk nb lo mt mu mv mw bi translated">如何调试Redux应用程序</li><li id="348d" class="mo mp in kv b kw mx kz my lc mz lg na lk nb lo mt mu mv mw bi translated">如何在React中使用Redux使用react-redux库让你的app反应性。</li><li id="5dce" class="mo mp in kv b kw mx kz my lc mz lg na lk nb lo mt mu mv mw bi translated">如何使用redux-thunk库处理异步API调用等等</li></ul><p id="8392" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后，我们将从头开始构建一个完整的<a class="ae ks" href="https://www.youtube.com/watch?v=2zaPDfCKAvM" rel="noopener ugc nofollow" target="_blank">订餐应用</a>，集成stripe以接受支付，并将其部署到生产中。</p><p id="0bdb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">别忘了直接在你的收件箱</strong> <a class="ae ks" href="https://yogeshchavan.dev" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io">这里</strong> </a> <strong class="kv io">订阅我的每周简讯，里面有惊人的技巧、窍门和文章。</strong></p></div></div>    
</body>
</html>