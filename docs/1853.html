<html>
<head>
<title>JavaScript Best Practices — Error Processing and Exceptions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript最佳实践—错误处理和异常</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-error-processing-and-exceptions-a05846d1132e?source=collection_archive---------11-----------------------#2020-04-28">https://javascript.plainenglish.io/javascript-best-practices-error-processing-and-exceptions-a05846d1132e?source=collection_archive---------11-----------------------#2020-04-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/788cc972685c06d9241c589f30aca439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*87a7pENfhcuRS9HJ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mostafa_meraji?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">mostafa meraji</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ca6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript是一种非常宽容的语言。编写可以运行但存在问题的代码很容易。</p><p id="959d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何处理JavaScript程序中的错误。</p><h1 id="8a90" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">错误处理的设计含义</h1><p id="2d22" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们在系统中处理错误，那么我们必须测试我们的错误处理代码。</p><p id="a8b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是为了确保我们做的一切都是正确的。</p><p id="ac7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有返回值，那么我们测试返回值。</p><p id="5801" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们永远不应该忽略错误信息。</p><p id="cadf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一致的方法来处理错误，那么我们应该遵循它，这样我们就可以解决错误处理代码不一致和重复的问题。</p><h1 id="3adb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">例外</h1><p id="c618" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">异常是代码将导致错误的代码中的错误传递给表面的方法。</p><p id="ef7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们不想让我们的程序崩溃，那么我们应该捕捉它们，这样我们就可以优雅地处理它们。</p><p id="b963" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在JavaScript中，我们可以通过在<code class="fe me mf mg mh b">Error</code>的<code class="fe me mf mg mh b">Error</code>类或子类上使用<code class="fe me mf mg mh b">throw</code>关键字来抛出错误。</p><p id="c7bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了捕捉错误，我们可以使用<code class="fe me mf mg mh b">try...catch</code>来捕捉它们。</p><p id="4845" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想不管是否抛出异常都运行代码，我们可以将它们放在<code class="fe me mf mg mh b">finally</code>子句中。</p><p id="857c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以编写下面的代码来抛出一个错误:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f66e" class="mq lc iq mh b gy mr ms l mt mu">throw new Error('error');</span></pre><p id="20c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了捕捉由可能导致错误的代码引发的异常，我们编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8caa" class="mq lc iq mh b gy mr ms l mt mu">try {<br/>  errorThrowingCode();<br/>  //...<br/>} catch (ex) {<br/>  // handdle errors<br/>}</span></pre><p id="319a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<code class="fe me mf mg mh b">errorThrowingCode</code>可能抛出错误。</p><p id="a4ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">catch</code>块之后可以添加一个<code class="fe me mf mg mh b">finally</code>子句。</p><h1 id="cebc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用异常来通知程序的其他部分不应该被忽略的错误</h1><p id="0433" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">抛出异常的全部意义在于，我们不能忽视它们而不让用户看到它们。</p><p id="d5db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们应该使用异常来通知程序的其他部分不应该被忽略的错误。</p><h1 id="12c5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">只有在真正异常的情况下才会引发异常</h1><p id="a90b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">即使我们应该为不应该被忽略的事情抛出异常，我们也不应该到处使用它们。</p><p id="2c63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有太多的异常，那么我们必须到处都有代码来处理异常。</p><p id="5061" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不希望这样，所以我们应该考虑对那些必须处理的错误使用异常，以保证程序的正常运行。</p><p id="fb72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">异常处理使我们的代码更加复杂，因为我们必须捕捉它们，然后处理它们。</p><p id="a619" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有更好的方法来处理非关键错误，比如检查值和做一些事情，而不是抛出异常。</p><h1 id="78e6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要用异常来推卸责任</h1><p id="5914" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果错误可以在本地处理，那么我们应该这样做。</p><p id="099b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在其他地方处理它们只会让我们的代码更加复杂。</p><h1 id="42ab" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在异常消息中包含导致异常的所有信息</h1><p id="02e5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们应该在异常中包含有用的信息，这样我们就有足够的信息来调试和修复导致异常出现的问题。</p><p id="9f70" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们给每个人更多的信息，以便我们能够处理错误，这只会使处理错误变得更容易。</p><h1 id="f6e8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">避免空的捕捉块</h1><p id="3db2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">空的catch块是没有用的，所以我们不应该包含它们。</p><p id="62e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须处理抛出的异常，而不是在捕捉到异常时什么都不做。</p><p id="eaa1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们不想做任何事情，我们至少应该记录错误。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3b0c3778621f036554285c35a8865887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_bEu5nfvIY9VMIgL"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mostafa_meraji?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">mostafa meraji</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e19c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">了解我们的库代码抛出的异常</h1><p id="163a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">了解我们的库抛出的异常是很重要的，这样我们就可以在它们出现时处理它们。</p><p id="a4cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">未能捕捉到它们将导致我们的程序崩溃，这将不会是良好的用户体验。</p><h1 id="43f3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">考虑构建一个集中式异常报告器</h1><p id="eab4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">创建一个集中的异常报告器使得记录和格式化异常变得轻而易举，因为所有这些都在一个地方完成。</p><p id="7442" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总比在不同的地方分别处理好。</p><h1 id="4583" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">标准化我们项目中异常的使用</h1><p id="607b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了保持一致性，我们应该标准化代码中异常的处理方式，以减少开发人员的认知负担。</p><p id="7f34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以创建特定于项目的异常类，并定义允许抛出异常的代码。</p><p id="e4c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以集中报告和记录。</p><h1 id="c817" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="b3a6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们抛出异常时，需要考虑很多事情。</p><p id="8ed9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须考虑何时以及如何抛出异常。它们在哪里处理以及我们是否可以创建自己的错误类。</p><p id="48b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">标准化会使我们的工作更容易。</p><h2 id="ff2c" class="mq lc iq bd ld mv mw dn lh mx my dp ll ko mz na lp ks nb nc lt kw nd ne lx nf bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="b13a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物:<a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>——谢谢，继续学习！</p><p id="c352" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，并附上您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>