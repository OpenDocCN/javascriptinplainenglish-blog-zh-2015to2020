<html>
<head>
<title>How To Create A Todo App With React Hooks And LocalStorage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用React挂钩和LocalStorage创建Todo应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-todo-app-with-react-hooks-and-localstorage-17e37cfeb46d?source=collection_archive---------3-----------------------#2020-09-28">https://javascript.plainenglish.io/how-to-create-a-todo-app-with-react-hooks-and-localstorage-17e37cfeb46d?source=collection_archive---------3-----------------------#2020-09-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/a8f85ca60d9a08403c44034bd048dd2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2j4p0KVSmgQ_xmfw.png"/></div></div></figure><div class=""/><div class=""><h2 id="80d0" class="pw-subtitle-paragraph jv ix iy bd b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dk translated">使用React挂钩创建Todo应用程序的分步指南</h2></div><p id="3bd3" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">新反应？很想知道如何启动并运行这个库，并希望利用最新的特性。那么这个Todo应用将会是你一个很好的起点！</p><p id="0db1" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">这是我们最终的应用程序:</p><figure class="lk ll lm ln gt ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi lj"><img src="../Images/45b41b89ec872926a8cb3ff2ab265b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BM52ILZLVXwb2PQSaujXA.png"/></div></div></figure><p id="70f0" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在这里，我们不会过多关注应用程序的样式。</p><p id="6890" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们创建React应用程序。为此，让我们启动主项目目录中的终端，并编写以下命令:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="72d9" class="lt lu iy lp b gy lv lw l lx ly">npx create-react-app .</span></pre><p id="730a" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">该命令帮助您安装设置react应用程序所需的一切。</p><p id="8470" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">React应用程序安装完成后，让我们安装一个包。为此，让我们在主项目目录中打开终端，并编写以下命令:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="3051" class="lt lu iy lp b gy lv lw l lx ly">npm i bootstrap</span></pre><p id="bbab" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">使用这个命令，我们已经安装了bootstrap。我们将使用bootstrap为我们的应用程序添加一些样式。</p><p id="475a" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在我们已经安装了包，让我们开始写一些代码。在写代码之前，让我们先删除一些我们不会用到的文件。让我们在<em class="lz"> src </em>目录中保留<strong class="kp iz"> App.js </strong>和<strong class="kp iz"> index.js </strong>文件，并删除该目录中的其他文件。这应该使我们的文件夹结构看起来像这样:</p><figure class="lk ll lm ln gt ip gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/e9783b399b112d464cb61f1d9ab6113b.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*c9KLqPXvJN2xQ91BNEwBwQ.png"/></div></figure><p id="1f43" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">让我们打开文件<strong class="kp iz"> index.js </strong>并做一些修改。我们的<strong class="kp iz"> index.js </strong>文件应该是这样的:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="1f39" class="lt lu iy lp b gy lv lw l lx ly">import React from "react";</span><span id="3d03" class="lt lu iy lp b gy mb lw l lx ly">import ReactDOM from "react-dom";</span><span id="ddf3" class="lt lu iy lp b gy mb lw l lx ly">import App from "./App";</span><span id="bacb" class="lt lu iy lp b gy mb lw l lx ly">ReactDOM.render(</span><span id="eb28" class="lt lu iy lp b gy mb lw l lx ly">  &lt;React.StrictMode&gt;</span><span id="80a2" class="lt lu iy lp b gy mb lw l lx ly">    &lt;App /&gt;</span><span id="5d72" class="lt lu iy lp b gy mb lw l lx ly">  &lt;/React.StrictMode&gt;,</span><span id="122a" class="lt lu iy lp b gy mb lw l lx ly">  document.getElementById("root")</span><span id="22f1" class="lt lu iy lp b gy mb lw l lx ly">  );</span></pre><p id="85e6" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">注意，我们已经删除了服务工作者和<strong class="kp iz"> index.css </strong>文件的导入。其他的也一样。</p><p id="2976" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们打开文件<strong class="kp iz"> App.js </strong>并编写以下代码行:</p><pre class="lk ll lm ln gt lo lp lq lr aw ls bi"><span id="e24b" class="lt lu iy lp b gy lv lw l lx ly">import React from "react";</span><span id="c39e" class="lt lu iy lp b gy mb lw l lx ly">import Todo from "./component/Todo";</span><span id="33b1" class="lt lu iy lp b gy mb lw l lx ly">import "bootstrap/dist/css/bootstrap.css";<br/></span><span id="54aa" class="lt lu iy lp b gy mb lw l lx ly">function App() {</span><span id="2d10" class="lt lu iy lp b gy mb lw l lx ly">   return (</span><span id="c4d9" class="lt lu iy lp b gy mb lw l lx ly">     &lt;&gt;</span><span id="ec04" class="lt lu iy lp b gy mb lw l lx ly">        &lt;Todo /&gt;</span><span id="c598" class="lt lu iy lp b gy mb lw l lx ly">     &lt;/&gt;</span><span id="9769" class="lt lu iy lp b gy mb lw l lx ly">    );</span><span id="696b" class="lt lu iy lp b gy mb lw l lx ly">}</span><span id="8b0c" class="lt lu iy lp b gy mb lw l lx ly">export default App;</span></pre><p id="6f44" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在第一行，我们导入了<code class="fe mc md me lp b">React</code>。然后，我们导入了<code class="fe mc md me lp b">Todo</code>组件——我们很快就会开始工作。之后，我们从Bootstrap导入CSS文件。</p><p id="5008" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">之后，我们创建了一个返回<code class="fe mc md me lp b">Todo</code>组件的<code class="fe mc md me lp b">App</code>函数。之后，我们导出了<code class="fe mc md me lp b">App</code>函数。</p><p id="bfa4" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们开始制作<code class="fe mc md me lp b">Todo</code>组件。为此，让我们在<em class="lz"> src </em>目录中创建一个名为<em class="lz">组件</em>的目录。之后，在<em class="lz">组件</em>目录下创建一个名为<strong class="kp iz"> Todo.js </strong>的文件。这应该使我们的<em class="lz"> src </em>文件夹看起来像这样:</p><figure class="lk ll lm ln gt ip gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/169517fc8e30ae5d0c8f6e777767045c.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*n0mSNvf0sD7yHXnhxTIisA.png"/></div></figure><p id="b48e" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们打开文件<strong class="kp iz"> Todo.js </strong>并编写以下代码行:</p><figure class="lk ll lm ln gt ip"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="be1a" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">我们可以通过创建多个组件来使这个文件更精简。对于这篇文章，让我们保持这种方式。</p><p id="6c8e" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们仔细看看这个文件。</p><p id="124c" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在第1行，我们从<code class="fe mc md me lp b">'React’</code>导入了<code class="fe mc md me lp b">React</code>、<code class="fe mc md me lp b">useState</code>和<code class="fe mc md me lp b">useEffect</code>。</p><p id="e834" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在第3行，我们创建了<code class="fe mc md me lp b">Todo</code>函数，并在第89行将其导出。</p><p id="9b51" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在第4 &amp; 5行，我们使用<code class="fe mc md me lp b">useState</code>创建了一个<code class="fe mc md me lp b">todos</code>和<code class="fe mc md me lp b">newTodo</code>状态。在这里，<code class="fe mc md me lp b">useState</code>创造了我们一个国家。在基于类的组件中，我们会创建一个<code class="fe mc md me lp b">state</code>对象并在其中存储值。但是有了钩子，我们就不需要了。状态是存储和修改数据的一种方式。这里，<code class="fe mc md me lp b">useState</code>接受一个参数。此参数为状态提供默认值。在我们的例子中，我们为<code class="fe mc md me lp b">todos</code>状态提供了一个空数组，为<code class="fe mc md me lp b">newTodo</code>提供了一个空字符串。</p><p id="9fb7" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">这个<code class="fe mc md me lp b">useState()</code>函数返回一个包含状态值的数组作为第一个元素，返回一个改变状态的函数作为第二个元素。记住我们不能直接改变状态值。我们需要一个函数来改变状态的值。我们使用数组析构来获取值和函数——这可以在第4行和第5行看到。在第4行，我们将状态命名为<code class="fe mc md me lp b">todos</code>，将函数命名为<code class="fe mc md me lp b">setTodos</code>。同样，我们将其他状态和功能命名为<code class="fe mc md me lp b">newTodo</code>和<code class="fe mc md me lp b">setNewTodo</code>。</p><p id="ed95" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">从第33行到第86行，我们呈现了组件。</p><p id="f92c" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在第35行，我们添加了标题为“todo”的<code class="fe mc md me lp b">h2</code>。从第37行到第84行，我们呈现了一个用于显示todo的表格。从第38行到第57行，我们创建了一个文本字段和一个add todo按钮。从第41行到第48行，我们有一个输入字段。我们已经在第46行用值<code class="fe mc md me lp b">newTodo</code>设置了输入字段。这里，我们在第47行的输入字段中添加了一个<code class="fe mc md me lp b">onChange</code>事件监听器。当发生一些变化时，我们使用<code class="fe mc md me lp b">setNewTodo</code>函数将<code class="fe mc md me lp b">newTodo</code>设置为<code class="fe mc md me lp b">e.target.value</code>。这里，<code class="fe mc md me lp b">e</code>是一个包含<code class="fe mc md me lp b">target</code>属性的事件。这个目标实际上是<code class="fe mc md me lp b">input</code>字段。<code class="fe mc md me lp b">target</code>包含<code class="fe mc md me lp b">value</code>属性。<code class="fe mc md me lp b">value</code>将值存储在<code class="fe mc md me lp b">input</code>字段中。</p><p id="cab4" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">从第51行到第54行，我们创建了一个“添加”按钮。当按钮被点击时，我们调用一个名为<code class="fe mc md me lp b">onAddTodo</code>的函数，在第51行的<code class="fe mc md me lp b">onClick</code>事件监听器的帮助下。</p><p id="af46" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">从第59行到第66行，我们创建了一个标题为“Task”的<code class="fe mc md me lp b">thead</code>。</p><p id="1e6a" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">从第69行到第82行，我们呈现了处于<code class="fe mc md me lp b">todos</code>状态的todos。我们映射通过<code class="fe mc md me lp b">todos</code>州并创建<code class="fe mc md me lp b">tr</code>。在第71行，我们用<code class="fe mc md me lp b">todo.todo</code>添加了表格数据。我们的<code class="fe mc md me lp b">todo</code>是一个包含<code class="fe mc md me lp b">todo</code>和一个<code class="fe mc md me lp b">id</code>的对象。从第73行到第79行，我们在一个<code class="fe mc md me lp b">td</code>中添加了一个“删除”按钮。当删除按钮被点击时，我们使用第75行的<code class="fe mc md me lp b">onClick</code>事件监听器调用<code class="fe mc md me lp b">deleteTodo(todo.id)</code>函数。</p><p id="0728" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">在第11行，我们使用了<code class="fe mc md me lp b">useEffect</code>，第一个参数作为回调函数，第二个参数作为空数组。我们构建<code class="fe mc md me lp b">useEffect</code>的方式与<code class="fe mc md me lp b">componentDidMount</code>的方式相同。这是因为我们使用了一个空数组作为第二个参数。让我们来看看回调函数内部的代码。在第12行，我们检查了<code class="fe mc md me lp b">localStorage</code>中是否存在<code class="fe mc md me lp b">todos</code>条目。这里，<code class="fe mc md me lp b">localStorage.getItem()</code>帮助我们接收存储在<code class="fe mc md me lp b">localStorage</code>中的数据。如果<code class="fe mc md me lp b">todos</code>条目存在，我们在第13行将<code class="fe mc md me lp b">todos</code>状态设置为与<code class="fe mc md me lp b">localStorage</code>中存在的值相同。</p><p id="8db0" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们看看第17行的<code class="fe mc md me lp b">onAddTodo</code>函数。当用户点击“添加”按钮时，这个函数被调用。在第18行，我们检查了要添加的todo是否为空字符串。如果是空字符串，我们什么都不做。如果不是空字符串，我们在第19行创建一个变量<code class="fe mc md me lp b">newTodos</code>。注意，我们使用了spread操作符将之前的todos添加到<code class="fe mc md me lp b">newTodos</code>数组中。我们还向<code class="fe mc md me lp b">newTodos</code>数组添加了新的todo。我们的todo是一个包含<code class="fe mc md me lp b">todo</code>和<code class="fe mc md me lp b">id</code>属性的对象。<code class="fe mc md me lp b">todo</code>存储文本，而<code class="fe mc md me lp b">id</code>存储特定todo的id。我们使用<code class="fe mc md me lp b">Date.now()</code>作为id，使用<code class="fe mc md me lp b">newTodo</code>状态作为<code class="fe mc md me lp b">todo</code>。之后，我们在第20行使用<code class="fe mc md me lp b">setTodos</code>将todos状态的值设置为<code class="fe mc md me lp b">newTodos</code>。在第21行，我们将<code class="fe mc md me lp b">newTodo</code>设置为一个空字符串。记住<code class="fe mc md me lp b">newTodo</code>存储输入字段中的值。之后，我们在第22行运行带有参数<code class="fe mc md me lp b">newTodos</code>的<code class="fe mc md me lp b">saveData()</code>。此<code class="fe mc md me lp b">saveData</code>功能帮助我们将待办事项保存到<code class="fe mc md me lp b">localStorage</code>中。</p><p id="24e1" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们看看第26行的<code class="fe mc md me lp b">deleteTodo</code>函数。它接受<code class="fe mc md me lp b">id</code>作为参数。然后，我们过滤第27行的todos。这里，过滤器只返回那些id与<code class="fe mc md me lp b">id</code>参数不匹配的todos，并将其存储在<code class="fe mc md me lp b">newTodos</code>变量中。然后，我们使用<code class="fe mc md me lp b">setTodos</code>将第28行的todos设置为<code class="fe mc md me lp b">newTodos</code>。之后，我们运行<code class="fe mc md me lp b">saveData()</code>,将<code class="fe mc md me lp b">newTodos</code>作为第30行的参数。</p><p id="b150" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">现在让我们看看第7行的<code class="fe mc md me lp b">saveData</code>函数。该函数以<code class="fe mc md me lp b">newTodos</code>为自变量。它将数据保存到<code class="fe mc md me lp b">localStorage</code>。在第8行，我们使用<code class="fe mc md me lp b">localStorage.setItem</code>将todos保存到<code class="fe mc md me lp b">localStorage</code>的<code class="fe mc md me lp b">”todos”</code>字段。<code class="fe mc md me lp b">setItem</code>接受两个参数，第一个参数是键名，第二个参数是键值。请注意，我们的第二个参数是使用<code class="fe mc md me lp b">JSON.stringify()</code>字符串化的。因为<code class="fe mc md me lp b">localStorage</code>只存储字符串值。这也是我们在从第13行的<code class="fe mc md me lp b">localStorage</code>检索数据时使用<code class="fe mc md me lp b">JSON.parse</code>的原因。</p><p id="94f9" class="pw-post-body-paragraph kn ko iy kp b kq kr jz ks kt ku kc kv kw kx ky kz la lb lc ld le lf lg lh li ig bi translated">有了这个，我们已经完成了Todo应用程序的创建。您现在可以尝试一下了。</p></div></div>    
</body>
</html>