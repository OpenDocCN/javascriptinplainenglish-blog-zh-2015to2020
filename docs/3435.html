<html>
<head>
<title>Adding dynamic features to a static site</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向静态站点添加动态功能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-dynamic-features-to-a-static-site-cf56ff7b163a?source=collection_archive---------9-----------------------#2020-09-28">https://javascript.plainenglish.io/adding-dynamic-features-to-a-static-site-cf56ff7b163a?source=collection_archive---------9-----------------------#2020-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0288" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用JavaScript来活跃你的内容</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb6b4ab374e88d560de3fbeea1b610ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*le1_MHAy6Z2xzDcG"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@yulokchan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joseph Chan</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2653" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在文章<a class="ae kv" href="https://medium.com/swlh/the-power-of-static-20e4f7768c3d" rel="noopener"> The Power of Static </a>中，我解释了将内容发布为“静态站点”的一些好处:一个简单的HTML文件集合，而不是一个更复杂的站点，位于脚本语言之上。我提到的一个缺点是缺乏灵活性，尽管我简单地提到过:</p><blockquote class="ls lt lu"><p id="609a" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">随着JavaScript的日益流行，一旦静态页面被交付给用户的浏览器，就可以选择在静态页面上“分层”个性化。</p></blockquote><p id="6630" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我想进一步探讨这个概念。</p><p id="9a8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/bobbykjack/adding-dynamic-features-to-a-static-site" rel="noopener ugc nofollow" target="_blank"> <em class="lv">所有的例子内容都可以从这个对应的GitHub库中获得。</em> </a></p><h1 id="6617" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">服务器与客户端</h1><p id="63c1" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">对于一个静态网站，我们可以把我们的服务器——计算机和软件本身——想象成一个愚蠢的仆人，接受最基本的命令，代表我们取东西。然而，<em class="lv">我们仍然</em>聪明，能够做大多数事情，即使是一个聪明的仆人也能做到，而且我们要他们取的<em class="lv">物品</em>不仅仅是一个简单的内容。</p><p id="7676" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是什么提供了这种力量？JavaScript。JavaScript在整个过程的客户端阶段运行，换句话说，就是读者所在的浏览器/计算机。客户是“我们”，在前面的类比中是娇生惯养的雇主。我们最终将不得不为自己做一些工作，但这通常是一种优势，因为:</p><ul class=""><li id="a3b9" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated">这项工作是专为我们进行的。实际上，服务器可能被要求处理许多许多的客户端，每个客户端都需要一些宝贵的时间——在规模上，这可能会大大降低速度。</li><li id="dfe3" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">这项工作定义明确，范围有限:我们只能使用浏览器基础设施，而服务器几乎有无限的机会。这个机会可能很强大，但它往往太强大了。</li></ul><h1 id="6703" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">拥有您的数据</h1><p id="b0a8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">是时候快速转移注意力了。你对自己的数据被发送到服务器，与他人的数据结合在一起，被操纵，可能与第三方共享，并反馈给你供你欣赏有多高兴？毫无疑问，这种数据传输有很大的优势，但有时，也许不是每个博客或新闻网站都应该收集所有这些东西，这难道不是感觉吗？</p><p id="5054" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一个网站所有者，你可能想考虑告诉你的读者“这是我要说的，用它做你想做的事情”的价值——本质上，这是我们在使用静态网站时可以采用的方法，由JavaScript增强。</p><h1 id="69dd" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">已经够理论了</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/db22cbedbcc541b71464687838da3a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dBqGu4lJuP4yJgRc"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Aron Visuals</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3580" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是时候举些例子了。让我们从一件小事开始:将时间插入到文档中。</p><h2 id="a20c" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">服务器端</h2><p id="5ccd" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们可以使用PHP脚本轻松插入服务器请求页面的时间:</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="8908" class="nk ma iq nx b gy ob oc l od oe">&lt;!doctype html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;title&gt;Example one&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;h1&gt;Hello&lt;/h1&gt;<br/>    &lt;p&gt;The time is &lt;b&gt;<strong class="nx ir">&lt;?php echo date('H:i a'); ?&gt;</strong>&lt;/b&gt;.&lt;/p&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="065d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里不用太担心实现，重要的是要记住，PHP代码是在服务器端执行的，时间是在交付给客户端(浏览器)之前动态插入页面的。每次我们刷新页面，服务器将页面发送给我们，我们将得到一个可能不同的文档。</p><h2 id="7c70" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">客户端</h2><p id="a7ad" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在让我们考虑一个JavaScript替代方案:</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="c7dd" class="nk ma iq nx b gy ob oc l od oe">&lt;!doctype html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;title&gt;Example one&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;h1&gt;Hello&lt;/h1&gt;<br/>    &lt;p&gt;The time is &lt;b&gt;<strong class="nx ir">&lt;script&gt;document.write(</strong><strong class="nx ir">new Date().toLocaleTimeString()</strong><strong class="nx ir">);&lt;/script&gt;</strong>&lt;/b&gt;.&lt;/p&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ce6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从某种意义上来说，我们的JavaScript替代品比它的PHP等效物更加动态；就我们客户而言，它是动态的。我们总是会收到相同的页面，但每次看到它时，我们都会做少量的工作，最终得到不同的结果。服务器已经告诉我们要做什么，但是实际上要由我们来做。</p><p id="c8c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，JavaScript方法还有另一个好处:这个内容可以不断地改变，而不仅仅是在URL被请求的时候。如果我们不是告诉读者“这是页面加载的时间”，而是告诉他们“这是时间<em class="lv">现在</em>”，我们的JavaScript版本是唯一明智的方法:</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="c86d" class="nk ma iq nx b gy ob oc l od oe">&lt;!doctype html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;title&gt;Example one&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;h1&gt;Hello&lt;/h1&gt;<br/>    &lt;p&gt;The time is &lt;b id="thetime"&gt;&lt;/b&gt;.&lt;/p&gt;<br/><strong class="nx ir">    &lt;script&gt;<br/>    setInterval(function() {<br/>        document.querySelector("#thetime").textContent = new Date().toLocaleTimeString();<br/>    }, 1000);<br/>    &lt;/script&gt;</strong><br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="770a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每秒(1000毫秒)，匿名函数更新<code class="fe of og oh nx b">b</code>元素的文本(通过它的<code class="fe of og oh nx b">id</code>定位它)并将其设置为当前时间。</p><h1 id="449f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">一个更有用的例子</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/889e5b19f059a63aab314e6f12cf29ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iIFpFzprg1YKnMtn"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@denisseleon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Denisse Leon</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f35a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">告诉时间当然很好，但是一个与现实世界更相关的例子呢？最后，我将展示一个在客户端管理书签的小脚本。这种脚本可以添加到任何静态站点，并且无需服务器端设置、软件安装或数据库配置就能立即提供有用的功能。这是一个简单的例子，但是它应该让你思考这种方法的可能性。</p><p id="64dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">许多网站提供某种“书签”功能。就在媒体上，你可以为文章做书签，以便以后阅读。亚马逊允许你将商品添加到愿望清单中，以备将来参考。这两者目前都是使用服务器端技术实现的，但是在每种情况下，客户端替代方案都是完全可行的。</p><p id="bed9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">剧本<code class="fe of og oh nx b">bookmarks.js</code><a class="ae kv" href="https://github.com/bobbykjack/adding-dynamic-features-to-a-static-site/blob/master/bookmarks.js" rel="noopener ugc nofollow" target="_blank">在GitHub </a>上有。我建议下载它，并将其包含在您可以访问的静态站点的几个页面中(最好是在测试或开发环境中！).在页面的任何地方用一个<code class="fe of og oh nx b">script</code>元素来引用<code class="fe of og oh nx b">bookmarks.js</code>。</p><p id="ad7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您现在无法下载，至少可以在GitHub上查看该脚本，并在接下来的讨论中参考它。</p><h2 id="19ab" class="nk ma iq bd mb nl nm dn mf nn no dp mj lf np nq ml lj nr ns mn ln nt nu mp nv bi translated">方法的描述</h2><p id="5d8d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">该脚本的工作方式如下:</p><ul class=""><li id="9334" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated"><code class="fe of og oh nx b">localStorage</code>用于跟踪一组页面(特别是URL的路径部分)。这是一个半永久性的数据存储——可以把它看作是cookies的一个增强的替代品。</li><li id="7302" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">只有字符串数据可以保存在localStorage中，但是JSON允许我们使用<code class="fe of og oh nx b">stringify</code>和<code class="fe of og oh nx b">parse</code>方法将任意JavaScript数据转换成字符串，反之亦然。</li><li id="30e9" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">DOM用于操作浏览器中的页面。请记住，我们的方法是从服务器获取静态站点内容，并在客户端对其进行增强。</li><li id="9f8e" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">当一个页面被查看时，它的URL被检查。如果是主页*，会在页面顶部插入一个书签列表。否则，根据页面是否已经被书签标记，注入“添加”或“移除”链接。</li></ul><p id="5cd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">* <em class="lv">请注意，您页面的URL必须是/即位于您域名的顶级或“根”位置</em></p><h1 id="becb" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">最后的话</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/675ca18bb4bba1897dc4cf650d30152f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YffZHhOUoNsyFIOU"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Winkler</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1922" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想象一下同样的方法，集成到您自己的静态站点中。你可以在你主页的边栏或者一个专门的“书签”页面上显示书签列表；这取决于你。需要注意的重要一点是，一个站点可以是动态的，即使它的内容是以静态形式从服务器传送过来的。</p><p id="54d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">真的没有必要再将书签数据从客户机发送到服务器，除非有一些实实在在的好处。将所有东西都放在客户端可以让我们的网站保持静态(快速、易于维护等)。)但也尊重用户的隐私；我们不关心他们选择哪些页面或产品作为书签，所以我们从来不询问这些细节。从我们读者的角度来看，这也是一种非常快速的体验，因为一切都是在他们的浏览器中即时发生的。</p><p id="c94f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下次当你考虑一个特性时，考虑一下服务器参与进来的必要性；如果你能把它从等式中去掉，一个完全静态但功能齐全的站点就在你的掌握之中了！</p></div></div>    
</body>
</html>