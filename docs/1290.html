<html>
<head>
<title>Introduction to Vue.js Watchers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue.js观察器简介</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/introduction-to-vue-js-watchers-3d3382842f33?source=collection_archive---------3-----------------------#2020-02-25">https://javascript.plainenglish.io/introduction-to-vue-js-watchers-3d3382842f33?source=collection_archive---------3-----------------------#2020-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6882bcd0c080b3bbbdc98fe9203311c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lQYi7cbSm5ztNwBL"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@cristina_gottardi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Cristina Gottardi</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e8fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js是一个易于使用的web应用框架，我们可以用它来开发交互式前端应用。</p><p id="3f1b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何定义和使用Vue.js观察器。</p><h1 id="f368" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">什么时候应该使用观察器？</h1><p id="0a6d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们希望观察反应性属性中的数据变化时，我们可以使用观察器，并在值变化时进行一些异步或昂贵的选择。</p><p id="2005" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以用它来观察输入的变化，然后当我们输入一些东西时，从<a class="ae kc" href="http://www.icndb.com/api/" rel="noopener ugc nofollow" target="_blank"> Chuck Norris API </a>得到一个笑话。</p><p id="f474" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将以下内容放入<code class="fe me mf mg mh b">src/index.js</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a0e2" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  el: "#app",<br/>  data: {<br/>    message: "",<br/>    joke: ""<br/>  },<br/>  created() {<br/>    this.debounceGetAllCapsMessage = _.debounce(this.getAllCapsMessage, 500);<br/>  },<br/>  methods: {<br/>    async getAllCapsMessage() {<br/>      const res = await fetch("https://api.icndb.com/jokes/random");<br/>      const result = await res.json();<br/>      this.joke = result.value.joke;<br/>    }<br/>  },<br/>  watch: {<br/>    message(newMessage, oldMessage) {<br/>      this.debounceGetAllCapsMessage();<br/>    }<br/>  }<br/>});</span></pre><p id="00f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的代码观察<code class="fe me mf mg mh b">message</code>属性的变化，然后调用<code class="fe me mf mg mh b">debounceGetAllCapsMessage</code>方法，该方法在半秒钟的延迟后得到一个笑话。</p><p id="fbbe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">watch</code>方法将新值作为第一个参数，旧值作为第二个参数。</p><p id="4323" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们把下面的放在<code class="fe me mf mg mh b">index.html</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b757" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Hello&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;</span><span id="0809" class="mq lc iq mh b gy mv ms l mt mu">  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;input type="text" v-model="message" /&gt;<br/>      &lt;p&gt;{{joke}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script src="./src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="0cb5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所看到的，我们可以运行一个异步操作，在执行操作之前添加一个延迟，然后获得最终结果。</p><p id="0d4c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以使用<code class="fe me mf mg mh b">vm.$watch</code>来观察一个值。最多需要3个参数。</p><p id="2faa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个是属性的路径，它是一个字符串。也可以是一个或多个事物组合起来观看的函数。</p><p id="7d06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个参数是值改变时运行的函数。</p><p id="83bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">vm.$watch</code>的第三个参数是一个具有某些属性的对象。它们包括:</p><ul class=""><li id="c427" class="mw mx iq kf b kg kh kk kl ko my ks mz kw na la nb nc nd ne bi translated"><code class="fe me mf mg mh b">immediate</code> —观察初始值的设置</li></ul><p id="d44a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该方法返回一个停止监视值的函数。这是一个可选参数。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/89644db165f0e4b69368a894ee81fcb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xd8xl_KqfVek_OIO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@eryk10?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Eryk</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dcbe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以如下使用它。在<code class="fe me mf mg mh b">src/index.js</code>中，我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f67a" class="mq lc iq mh b gy mr ms l mt mu">const vm = new Vue({<br/>  el: "#app",<br/>  data: {<br/>    message: "",<br/>    joke: ""<br/>  }<br/>});</span><span id="c2d8" class="mq lc iq mh b gy mv ms l mt mu">vm.$watch(<br/>  "message",<br/>  _.debounce(async function() {<br/>    const res = await fetch("<a class="ae kc" href="https://api.icndb.com/jokes/random" rel="noopener ugc nofollow" target="_blank">https://api.icndb.com/jokes/random</a>");<br/>    const result = await res.json();<br/>    this.joke = result.value.joke;<br/>  }, 500)<br/>);</span></pre><p id="3974" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后<code class="fe me mf mg mh b">index.html</code>，我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d969" class="mq lc iq mh b gy mr ms l mt mu">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Hello&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;</span><span id="78dd" class="mq lc iq mh b gy mv ms l mt mu">  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;input type="text" v-model="message" /&gt;<br/>      &lt;p&gt;{{joke}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script src="./src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="6037" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和我们之前吃的一样。</p><p id="2db9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这两个例子中，我们应该在显示半秒钟延迟后得到一个新笑话。</p><h1 id="88f9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="d7ea" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用options和object中的<code class="fe me mf mg mh b">watch</code>方法和<code class="fe me mf mg mh b">vm.$watch</code>来观察值的变化。</p><p id="13b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">vm.$watch</code>方法监视一个给定路径的属性或返回它的函数或多个属性的组合。</p><p id="87be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">vm.$watch</code>采用一个值改变处理程序，我们可以在其中运行代码来处理一个反应属性的值何时改变。</p><p id="a2e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">watch</code>方法在值改变时运行代码。</p><p id="04f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，<code class="fe me mf mg mh b">watch</code>方法将新值作为第一个参数，旧值作为第二个参数。</p></div></div>    
</body>
</html>