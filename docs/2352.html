<html>
<head>
<title>How I use HTML5 video whilst maintaining a high performance website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何使用HTML5视频，同时维护一个高性能的网站</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-i-use-html5-video-but-still-scored-a-good-performance-28b6fcd7a44a?source=collection_archive---------2-----------------------#2020-06-16">https://javascript.plainenglish.io/how-i-use-html5-video-but-still-scored-a-good-performance-28b6fcd7a44a?source=collection_archive---------2-----------------------#2020-06-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="1f2f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">HTML5视频可能会成为拥有A+性能网站的阻碍因素。Web性能是指web应用程序/网站被下载并显示给用户(当前正在浏览您网站的人)的速度。</p><p id="4e7d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在谷歌开发者的<a class="ae ki" href="https://developers.google.com/web/fundamentals/performance/why-performance-matters" rel="noopener ugc nofollow" target="_blank">帖子</a>中，Jeremy Wagner 解释了为什么网站的性能很重要。长话短说，他提到，业绩会影响留在你网站上的人数，最终通过购买或广告收入转化为金钱。</p></div><div class="ab cl kj kk hr kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ig ih ii ij ik"><h1 id="c2c5" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">如何检查你的网站性能？</strong></h1><p id="118f" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">有很多方法可以检查你的网站性能，但我使用的一种方法是使用谷歌的灯塔。这项技术不仅允许你检查已经在互联网上的网站，还允许你检查你的本地网络应用程序。就像你现在正在开发的一样。</p><p id="d3cd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我看来，在开发过程中检查你的web应用程序的性能是至关重要的，因为它会指导你应该或不应该使用什么。这项技术也建议你应该做些什么来获得一个非常好的表现。</p><p id="77ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">下图是我的<a class="ae ki" href="https://liyanalzm.com" rel="noopener ugc nofollow" target="_blank">作品集</a>网站性能的一个例子，有HTML5视频标签。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/2050f33b33855e76a5b57b5584f7758d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOV58hEyCHJ6PIIbji9nFA.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Example of website with HTML5 Video tag</figcaption></figure><p id="299a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">根据上面的图片，我仍然需要在<em class="mj">最大内容油漆</em>指标上进行改进。如果你点击你右手边的两个标签，更多的描述和一个更详细的链接将会出现，最终会把你重定向到一个有很多修复方法的页面。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mk"><img src="../Images/d9accd81ea6ef58267fd10b8b5d428be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1FjusIcssy0X02DoJL2Z8g.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">More elaborations on the metrics</figcaption></figure><p id="f615" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">因此，这就是为什么在开发网站的时候总是检查你的网站性能是很重要的原因。除了得到一个性能良好的网站，你最终会改进你写代码的方式。</p></div><div class="ab cl kj kk hr kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ig ih ii ij ik"><h1 id="2cf5" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">我如何实现？</strong></h1><p id="3f61" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">我在这里要告诉你的是基于我用React JS开发的经验。然而，这种逻辑可以应用于您正在使用的任何技术。</p><h2 id="52c4" class="ml kr in bd ks mm mn dn kw mo mp dp la jv mq mr le jz ms mt li kd mu mv lm mw bi translated"><strong class="ak">仅在页面的所有元素都正确呈现后加载视频</strong></h2><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="a506" class="ml kr in bd ks mm mn dn kw mo mp dp la jv mq mr le jz ms mt li kd mu mv lm mw bi translated">加载视频时显示视频的第一帧图像</h2><p id="fada" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">原因是为了避免下载视频时白屏显示时间过长。如果是这样，用户可能会认为网站坏了。最好放视频的第一帧，以避免视频开始播放时出现任何小故障。平滑过渡确实是最好的用户体验。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="0ea1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">基于上面的片段，我更喜欢将第一帧图像显示为背景图像，因为它不会在第一次加载时下载，也不会阻碍第一页的绘制。</p><h2 id="49f3" class="ml kr in bd ks mm mn dn kw mo mp dp la jv mq mr le jz ms mt li kd mu mv lm mw bi translated">加载视频后，将视频重叠在图像上</h2><p id="a9c3" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">谈论基本的HTML5概念，如果一个标签在另一个标签的下面，在下面的HTML标签将在另一个标签的上面。因此，即使视频已经加载并显示，用户也不会看到视频，因为图像在它上面。因此，我们应该通过添加<em class="mj"> z-index: -1 </em>来隐藏和<em class="mj"> z-index: 1 </em>来显示来调整样式。</p><p id="4855" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们能做的就是使用属性<em class="mj"> onCanPlayThrough来确保视频已经完全下载。</em>该属性将调用<em class="mj"> videoLoaded </em>函数，该函数将把<em class="mj"> isVideoLoaded </em>设置为true。<em class="mj">isvideololoaded</em>作为一个标志来隐藏或显示相应的HTML标签，如下面的代码片段所示。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="mx my l"/></div></figure></div><div class="ab cl kj kk hr kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ig ih ii ij ik"><h2 id="ff1c" class="ml kr in bd ks mm mn dn kw mo mp dp la jv mq mr le jz ms mt li kd mu mv lm mw bi translated">组合代码</h2><p id="8959" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">下面是上面给出的所有片段的乘积。用叉子叉着玩。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="mz my l"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Final Product</figcaption></figure></div><div class="ab cl kj kk hr kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ig ih ii ij ik"><h1 id="4cc1" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">如果我不关心绩效会怎么样？</strong></h1><p id="dace" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">下面是一个例子，我删除了可以提高性能的代码。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="mz my l"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Plain video tag style</figcaption></figure><p id="d0c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当你运行灯塔测试，网站的性能下降。如下图所示，速度指数矩阵得分为7.1秒，慢了7倍。这是因为网络需要大量的时间来下载和显示视频。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi na"><img src="../Images/01168d63cc11faa624c9561e24f98444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7-AlJkwfxa09xRWrL8hEg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">B-scored performance</figcaption></figure></div><div class="ab cl kj kk hr kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ig ih ii ij ik"><h1 id="d03b" class="kq kr in bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">概括一下:</h1><ol class=""><li id="ab48" class="nb nc in jm b jn lo jr lp jv nd jz ne kd nf kh ng nh ni nj bi translated">Google的Lighthouse是在开发和生产过程中检查web应用程序性能的一个很好的工具。</li><li id="902b" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated">仅在页面的所有元素都正确呈现后加载视频。</li><li id="9212" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated">加载视频时显示视频的第一帧图像。</li><li id="bc1a" class="nb nc in jm b jn nk jr nl jv nm jz nn kd no kh ng nh ni nj bi translated">加载视频后，将视频重叠在图像上。</li></ol><h2 id="218a" class="ml kr in bd ks mm mn dn kw mo mp dp la jv mq mr le jz ms mt li kd mu mv lm mw bi translated">简单英语的JavaScript</h2><p id="7550" class="pw-post-body-paragraph jk jl in jm b jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd ls kf kg kh ig bi translated">你知道我们有四种出版物吗？通过<a class="ae ki" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io">plain English . io</strong></a>找到他们——通过关注我们的出版物和<a class="ae ki" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io">订阅我们的YouTube频道</strong> </a> <strong class="jm io">来表达爱意吧！</strong></p></div></div>    
</body>
</html>