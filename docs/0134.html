<html>
<head>
<title>Angular Inline-Edit Table Like Excel Without Third-Party Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度内嵌-像Excel一样编辑表格，无需第三方库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-material-table-with-edit-function-like-excel-7c2c53332553?source=collection_archive---------0-----------------------#2019-04-28">https://javascript.plainenglish.io/angular-material-table-with-edit-function-like-excel-7c2c53332553?source=collection_archive---------0-----------------------#2019-04-28</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><figure class="iq ir gq gs is it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj ip"><img src="../Images/e4ab413614c99e3406a0f779225e3c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sjNI7JVPAaRE3dKLEYAvhQ.gif"/></div></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">Angular Inline-Edit Table like Excel without Third Party Library</figcaption></figure><h2 id="17bd" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph"><a class="ae ep" href="https://rakiabensassi.medium.com/list/software-engineering-7a179a23ebfd" rel="noopener">网络开发</a></h2><div class=""/><div class=""><h2 id="b1ef" class="pw-subtitle-paragraph km jp jg bd b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dk translated">如何使用角度材质同时编辑多个表格的单元格？</h2></div><p id="4a3b" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">在数字化时代，许多用户已经从Excel电子表格迁移到现代网络应用程序，但他们仍然希望找到他们多年来与老朋友Excel使用的相同功能。坏消息是，这种不在讨论范围内的期望对于前端开发人员来说可能是一场噩梦。</p><p id="7d0c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">其中一个非常常见的功能是数据表，它可以在线编辑多个单元格，而不需要点击编辑图标，然后打开一个对话框，用户必须在其中输入单元格的新值。有时，开发人员选择添加一个第三方库，为应用程序提供该功能，因为他们不知道自己实现该功能需要多少时间。</p><p id="6116" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">因此，如果您有这样的要求，并且您认为您需要一个第三方库，您会在阅读本文后改变主意。我们在这里需要的只是角形和角形材料。让我们开始吧。</p></div><div class="ab cl ma mb hv mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ik il im in io"><p id="8a5f" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated"><em class="mh">您可以在Udemy上查看我的</em> <strong class="lg jq"> <em class="mh">视频教程</em></strong><em class="mh">:</em><a class="ae mi" href="https://www.udemy.com/course/identify-and-fix-javascript-memory-leaks/" rel="noopener ugc nofollow" target="_blank"><em class="mh">如何识别、诊断和修复网络应用中的内存泄漏</em> </a> <em class="mh">。</em></p></div><div class="ab cl ma mb hv mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ik il im in io"><h2 id="24c7" class="mj mk jg bd ml mm mn dn mo mp mq dp mr ln ms mt mu lr mv mw mx lv my mz na jm bi translated">项目设置</h2><p id="9b54" class="pw-post-body-paragraph le lf jg lg b lh nb kq lj lk nc kt lm ln nd lp lq lr ne lt lu lv nf lx ly lz ik bi translated">我们将使用Angular CLI构建我们的应用程序。首先，我们需要安装它:</p><pre class="ng nh ni nj gu nk nl nm nn aw no bi"><span id="9c77" class="mj mk jg nl b gz np nq l nr ns">npm install -g <a class="ae mi" href="http://twitter.com/angular/cli" rel="noopener ugc nofollow" target="_blank">@angular/cli</a></span></pre><p id="3f04" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">然后创建我们的应用程序:</p><pre class="ng nh ni nj gu nk nl nm nn aw no bi"><span id="38ba" class="mj mk jg nl b gz np nq l nr ns">ng new mat-edit-table<br/>cd mat-edit-table</span></pre><h2 id="3cc7" class="mj mk jg bd ml mm mn dn mo mp mq dp mr ln ms mt mu lr mv mw mx lv my mz na jm bi translated">密码</h2><p id="ff02" class="pw-post-body-paragraph le lf jg lg b lh nb kq lj lk nc kt lm ln nd lp lq lr ne lt lu lv nf lx ly lz ik bi translated">好了，该做好事了。我们必须遵循以下步骤:</p><ul class=""><li id="33bc" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">安装角材:</li></ul><pre class="ng nh ni nj gu nk nl nm nn aw no bi"><span id="1c57" class="mj mk jg nl b gz np nq l nr ns">npm install @angular/material<br/>npm install @angular/cdk<br/>npm install hammerjs</span></pre><ul class=""><li id="1c7e" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">导入角度主题。将此行添加到<em class="mh">src/style . SCS</em>:</li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div></figure><ul class=""><li id="496d" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">更新<em class="mh">app module app . module . ts:</em></li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">app.module.ts</figcaption></figure><ul class=""><li id="86fa" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">将<em class="mh">app.component.html</em>内容替换为:</li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">Angular Material basic table</figcaption></figure><ul class=""><li id="9af2" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">将<em class="mh"> app.component.ts </em>的内容替换为:</li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">Angular Material basic table</figcaption></figure><p id="e6ee" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">这是运行<em class="mh"> ng serve </em>并用浏览器调用<em class="mh"> localhost:4200 </em>后的结果:</p><figure class="ng nh ni nj gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj oe"><img src="../Images/cb146c0614f390ed1b1a425b0077eaf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HnXMSnJTieRxEUawl9naxQ.png"/></div></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">Angular Material basic table</figcaption></figure><ul class=""><li id="27d0" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">现在，我们需要将<em class="mh"> mousedown </em>和<em class="mh"> mouseup </em>事件侦听器添加到可编辑的单元格中。我们只想编辑<em class="mh">栏中的细胞名称、重量和符号</em>。</li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div></figure><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div></figure><ul class=""><li id="ceda" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">正如你所看到的，我们使用了两个新的CSS类‘<em class="mh">选中的</em>’和‘<em class="mh">未选中的</em>’来显示或隐藏选中单元格周围的蓝色边框，这取决于它们保存在二维数组中的状态<em class="mh">选中的单元格状态</em>。</li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="7bbc" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">添加keyup事件侦听器。通过在&lt;表&gt;标签中添加(key up)=“OnKeyUp($ event)”事件侦听器来更新<em class="mh">app.component.html</em>，并更新<em class="mh"> app.component.ts: </em></p><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div></figure><ul class=""><li id="28a1" class="nt nu jg lg b lh li lk ll ln nv lr nw lv nx lz ny nz oa ob bi translated">默认情况下，浏览器会在选定区域添加蓝色背景。为了获得更好的UX，我们将在选择单元格后删除此默认行为:</li></ul><figure class="ng nh ni nj gu it"><div class="bz fq l di"><div class="oc od l"/></div></figure><figure class="ng nh ni nj gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj of"><img src="../Images/66f2d9a868652e1c31103fe9fd02c75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fUTAzJDzCeIPag052HF4A.png"/></div></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">Remove blue background from table’s cells</figcaption></figure><p id="d18c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">完整的代码可以在<a class="ae mi" href="https://github.com/rakia/mat-edit-table" rel="noopener ugc nofollow" target="_blank"> github这里</a>获得。</p><h2 id="5326" class="mj mk jg bd ml mm mn dn mo mp mq dp mr ln ms mt mu lr mv mw mx lv my mz na jm bi translated">最后一件事</h2><p id="d61f" class="pw-post-body-paragraph le lf jg lg b lh nb kq lj lk nc kt lm ln nd lp lq lr ne lt lu lv nf lx ly lz ik bi translated">我们的1表中有两种不同类型的列:字符串和数字。因此，如果用户从不同的列中选择单元格并为它们输入相同的新值，将会很尴尬。因此，<em class="mh"> onMouseDown </em>和<em class="mh"> onMouseUp </em>方法有第三个参数<em class="mh"> cellsType </em>。如果用户开始为不同类型的单元格输入值，他将在snackBar中收到警告:</p><figure class="ng nh ni nj gu it gi gj paragraph-image"><div role="button" tabindex="0" class="iu iv di iw bf ix"><div class="gi gj og"><img src="../Images/a9796c0e597818683b3e1184c6a9c3d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v9j3uKYRq9wL66rgO80zNw.png"/></div></div><figcaption class="ja jb gk gi gj jc jd bd b be z dk">Show snackbar if selected cells have different types</figcaption></figure><p id="d327" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">今天到此为止。在下一篇文章<a class="ae mi" href="https://medium.com/@rakia/multi-edit-table-export-as-an-angular-library-40b37e773fd3" rel="noopener">中，我将把这个表导出为一个Angular库，通过把它添加到package.json中，就像其他npm依赖项一样，能够在不同的项目中重用它。</a></p><div class="iq ir gq gs is oh"><a href="https://levelup.gitconnected.com/multi-edit-table-export-as-an-angular-library-40b37e773fd3" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fp"><div class="oj ab ok cl cj ol"><h2 class="bd jq gz z fq om fs ft on fv fx jp bi translated">如何用NodeJS创建角度库</h2><div class="oo l"><h3 class="bd b gz z fq om fs ft on fv fx dk translated">使用npm发布导出角度材料表</h3></div><div class="op l"><p class="bd b dl z fq om fs ft on fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov iy oh"/></div></div></a></div></div><div class="ab cl ma mb hv mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ik il im in io"><h1 id="17e2" class="ow mk jg bd ml ox oy oz mo pa pb pc mr kv pd kw mu ky pe kz mx lb pf lc na pg bi translated">想要更多吗？</h1><p id="b745" class="pw-post-body-paragraph le lf jg lg b lh nb kq lj lk nc kt lm ln nd lp lq lr ne lt lu lv nf lx ly lz ik bi translated">我为一群聪明、好奇的🧠人写关于工程、技术和领导力的文章💡。<a class="ae mi" href="https://rakiabensassi.substack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg jq">加入我的免费电子邮件简讯，独家获取</strong> </a> <strong class="lg jq"> </strong>或在此注册Medium <a class="ae mi" href="https://rakiabensassi.medium.com/membership" rel="noopener">。</a></p><p id="d1da" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated"><em class="mh">你可以在Udemy上查看我的</em> <strong class="lg jq"> <em class="mh">视频课程</em></strong><em class="mh">:</em><a class="ae mi" href="https://www.udemy.com/course/identify-and-fix-javascript-memory-leaks/" rel="noopener ugc nofollow" target="_blank"><em class="mh">如何识别、诊断、修复Web Apps中的内存泄漏</em> </a> <em class="mh">。</em></p><div class="iq ir gq gs is oh"><a href="https://medium.com/javascript-in-plain-english/promise-vs-observable-vs-stream-165a310e886f" rel="noopener follow" target="_blank"><div class="oi ab fp"><div class="oj ab ok cl cj ol"><h2 class="bd jq gz z fq om fs ft on fv fx jp bi translated">承诺、可观察和流之间有什么区别？</h2><div class="oo l"><h3 class="bd b gz z fq om fs ft on fv fx dk translated">现代编程中的三种风格</h3></div><div class="op l"><p class="bd b dl z fq om fs ft on fv fx dk translated">medium.com</p></div></div><div class="oq l"><div class="ph l os ot ou oq ov iy oh"/></div></div></a></div><div class="iq ir gq gs is oh"><a href="https://levelup.gitconnected.com/learning-velocity-and-coding-standards-10952f6c9640" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fp"><div class="oj ab ok cl cj ol"><h2 class="bd jq gz z fq om fs ft on fv fx jp bi translated">为什么编码标准很重要，以及如何衡量开发速度</h2><div class="oo l"><h3 class="bd b gz z fq om fs ft on fv fx dk translated">熟悉一个新项目需要多长时间</h3></div><div class="op l"><p class="bd b dl z fq om fs ft on fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="oq l"><div class="pi l os ot ou oq ov iy oh"/></div></div></a></div></div></div>    
</body>
</html>