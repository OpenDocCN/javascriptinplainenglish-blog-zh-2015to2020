<html>
<head>
<title>Semantic versioning in npm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">npm中的语义版本控制</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/semantic-versioning-in-npm-54d5b02c3536?source=collection_archive---------3-----------------------#2020-03-07">https://javascript.plainenglish.io/semantic-versioning-in-npm-54d5b02c3536?source=collection_archive---------3-----------------------#2020-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5a76" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">轻松更新npm软件包，无需担心会破坏应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2370e9facdcbcbce9e7670b27400b9b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EdHnRd8wF_sWU_W3"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5e97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">语义版本控制是一件非常重要的事情，无论你是<code class="fe ls lt lu lv b">Nodejs</code>、<code class="fe ls lt lu lv b">Reactjs</code>还是<code class="fe ls lt lu lv b">Angularjs</code>开发人员，每个开发人员都需要了解它。</p><p id="91e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也是面试中经常被问到的问题之一。</p><p id="20dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它定义了如何管理我们安装的npm软件包的依赖关系。</p><p id="a2c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以让我们从一些基础开始。</p><p id="a9b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们从头开始创建任何新的Nodejs或reactjs项目时，我们执行</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="fa07" class="ma mb iq lv b gy mc md l me mf">npm init -y</span></pre><p id="879b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将创建一个基本的<code class="fe ls lt lu lv b">package.json</code>文件，我们可以在其中管理包的依赖关系。</p><p id="9855" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常情况下，<code class="fe ls lt lu lv b">package.json</code>会是这个样子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/577c21a141e9f447e9aa12b5e0de1bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NdHYgROyc_Hgr_OygO-VfQ.png"/></div></div></figure><p id="fd08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，package.json为新项目指定了以<code class="fe ls lt lu lv b">1.0.0</code>开头的<code class="fe ls lt lu lv b">version</code>属性。</p><p id="efdc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们安装了特定版本的<code class="fe ls lt lu lv b">express</code>包，使用</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="b252" class="ma mb iq lv b gy mc md l me mf">npm install express@4.16.1</span></pre><p id="395d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将被添加到<code class="fe ls lt lu lv b">package.json</code>的依赖关系部分，作为</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="2b93" class="ma mb iq lv b gy mc md l me mf">"dependencies": {<br/>  "express": "^4.16.1"<br/>}</span></pre><p id="19e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您还会看到，还会创建一个新的<code class="fe ls lt lu lv b">package-lock.json</code>文件。这是一个非常重要的文件，它包含了主软件包及其安装的依赖软件包的确切版本和下载url。</p><p id="0068" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你千万不要编辑或删除<em class="mh"> package-lock.json </em>。它会在安装或删除软件包时自动更新。</strong></p><p id="d543" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">语义版本化:</strong></p><p id="f285" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，package.json中的<code class="fe ls lt lu lv b">dependencies </code>是一个具有键值对的对象。</p><p id="a4fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该值是由<code class="fe ls lt lu lv b">dot</code>运算符分隔的3位数字的组合。假设版本是<code class="fe ls lt lu lv b">a.b.c</code></p><p id="e445" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.第一个值(<code class="fe ls lt lu lv b">a.b.c</code>中的<code class="fe ls lt lu lv b">a</code>)指定了包的主要版本——这意味着这个版本有主要的代码变更，它可能包含重大的API变更。</p><p id="f9b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.第二个值(<code class="fe ls lt lu lv b">a.b.c</code>中的<code class="fe ls lt lu lv b">b</code>)指定次要版本，该版本包含次要变更，但不包含重大API变更。</p><p id="ca19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.第三个值(<code class="fe ls lt lu lv b">a.b.c</code>中的<code class="fe ls lt lu lv b">c</code>)指定通常包含错误修复的补丁版本。</p><blockquote class="mi mj mk"><p id="5230" class="kw kx mh ky b kz la jr lb lc ld ju le ml lg lh li mm lk ll lm mn lo lp lq lr ij bi translated">如果您正在创建自己的npm软件包，也应该遵循这些版本规则。</p></blockquote><p id="05bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果包中有重大更改，在将包发布到npm存储库时，将package.json中的版本属性的第一位数字增加<code class="fe ls lt lu lv b">one</code>。对于较小的变化，增加第二个数字，对于错误修复，增加第三个数字值<code class="fe ls lt lu lv b">one</code>。</p><p id="51fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您还会注意到，在版本号前面有一个脱字符号<code class="fe ls lt lu lv b">(^)</code></p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="f617" class="ma mb iq lv b gy mc md l me mf">"express": "^3.16.1"</span></pre><p id="468d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有两个最常用的符号有特定的含义。让我们来理解他们。</p><p id="2c32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.<code class="fe ls lt lu lv b">^</code>:此符号表示当我们想更新<code class="fe ls lt lu lv b">package.json</code>中提到的所有包时，使用<code class="fe ls lt lu lv b">npm update</code>，将只更新到<code class="fe ls lt lu lv b">patch</code>和<code class="fe ls lt lu lv b">minor</code>发布版本。因此，如果你的当前版本是<code class="fe ls lt lu lv b">3.16.1</code>并且有次要版本发布，那么这个包将被更新到<code class="fe ls lt lu lv b">3.17.1</code>。如果只有补丁版本发布，那么它将被更新到最新的可用补丁版本，如<code class="fe ls lt lu lv b">3.16.3</code></p><p id="341c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，如果版本号前有<code class="fe ls lt lu lv b">^</code>符号，那么如果运行<code class="fe ls lt lu lv b">npm update</code>，包将永远不会更新到主版本。</p><p id="b10f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想更新到主要的可用版本，您可以使用</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="62e8" class="ma mb iq lv b gy mc md l me mf">npm install express@4.16.1</span></pre><p id="533c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想安装软件包的最新可用版本，请运行</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="8e48" class="ma mb iq lv b gy mc md l me mf">npm install express@latest</span></pre><p id="eec3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.<code class="fe ls lt lu lv b">~</code>:该符号表示包将只更新到补丁版本，即从<code class="fe ls lt lu lv b">4.16.1</code>到<code class="fe ls lt lu lv b">4.16.2</code>或<code class="fe ls lt lu lv b">4.16.3</code>的最后一位数，而不是<code class="fe ls lt lu lv b">4.17.1</code>或<code class="fe ls lt lu lv b">5.16.1</code></p><p id="37fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以只安装那些由npm包(在我们的例子中是<code class="fe ls lt lu lv b">express</code>包)提供的版本。<br/>如果你在这里转到npm库的express包<a class="ae kv" href="https://www.npmjs.com/package/express" rel="noopener ugc nofollow" target="_blank">，你可以看到这个包的所有版本。在这种情况下，<code class="fe ls lt lu lv b">263 versions</code>截止到今天。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/e1eb213075a3d7dc9341f699c7467719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54aeR8DsHENnQ1xa1cVcxg.png"/></div></div></figure><p id="4b0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你点击那个链接(<code class="fe ls lt lu lv b">263 versions</code>)，你会看到那个包的可用版本的长列表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/f219df14aade385dd1640020cf08f288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFUpXREUdwOa-ktr5yfUqg.png"/></div></div></figure><p id="61f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些有用的命令:</p><p id="667b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.如果您想查看package.json中所有包的当前和最新版本，您可以执行<code class="fe ls lt lu lv b">npm outdated</code>命令</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/606eeb0bf66f6fada0856f298a37d357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6HsKF6eAeVfoJlxfiw6sCw.png"/></div></div></figure><p id="69f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.执行<br/> <code class="fe ls lt lu lv b">npm list -g --depth=0 </code>命令，获得所有全局安装包的列表</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/3d7714f9e5f265e7dc43fa0d6b4926e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EyxrGJg9XMF-zDmcE1PNsg.png"/></div></div></figure><p id="9ff1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.要获得项目中所有易受攻击包的报告以及如何修复它们的说明，请执行<code class="fe ls lt lu lv b">npm audit</code>命令。如果你在Mac上，你可能需要像<code class="fe ls lt lu lv b">sudo npm audit</code>一样在它前面加上sudo</p><blockquote class="mi mj mk"><p id="b034" class="kw kx mh ky b kz la jr lb lc ld ju le ml lg lh li mm lk ll lm mn lo lp lq lr ij bi translated">该命令将列出所有易受攻击的软件包，链接有关漏洞的更多信息、其严重性(低、中或高)以及修复漏洞所需执行的命令。</p></blockquote><p id="4c9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您应该偶尔为您的项目运行一下<code class="fe ls lt lu lv b">npm audit</code>命令，看看最近是否有任何漏洞被报告，并在需要时修复它们，以保持包是最新的，从而保证您的应用程序的安全性。</p><p id="e1b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天到此为止。希望你今天学到了新东西。</p><p id="d8ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">别忘了直接在你的收件箱</strong> <a class="ae kv" href="https://yogeshchavan.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">订阅我的每周简讯，里面有惊人的技巧、诀窍和文章。</strong> </a></p></div></div>    
</body>
</html>