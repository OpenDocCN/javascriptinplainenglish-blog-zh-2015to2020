<html>
<head>
<title>React Refs, both Class and Functional Components.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React引用，包括类组件和功能组件。</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-refs-both-class-and-functional-components-76b7bce487b8?source=collection_archive---------0-----------------------#2019-10-04">https://javascript.plainenglish.io/react-refs-both-class-and-functional-components-76b7bce487b8?source=collection_archive---------0-----------------------#2019-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="44b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不可避免的是，在开发过程中的某个时刻，你会使用别人的组件。然而，您的用例可能是组件内部机制的外部。你得黑进去。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/51b6488ca5116712ffb9767548cbfff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V2-QWsXBSeUWdTn9gNavng.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Obligatory Unsplash Image | <a class="ae lb" href="https://unsplash.com/@tata186" rel="noopener ugc nofollow" target="_blank">Tatiana Rodriguez</a> — Unsplash</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="1e6d" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">问题是</h1><p id="3777" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">引用用例的一个很好的例子是框架输入库。在这种情况下，我们将讨论材质UI的<a class="ae lb" href="https://material-ui.com/api/text-field/" rel="noopener ugc nofollow" target="_blank"> TextField组件</a>。<strong class="jp ir">稍后会有一些澄清和提示，请原谅我和我的例子。</strong></p><p id="8081" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设您有一个表单，在呈现时，您希望它被自动选中。您的基本输入代码如下所示:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="2651" class="mr lk iq mn b gy ms mt l mu mv">import React from 'react';<br/>import { TextField, Typography } from '@material-ui/core';</span><span id="799b" class="mr lk iq mn b gy mw mt l mu mv">export default class CustomInput extends React.Component {<br/>  constructor(props){<br/>    super(props);<br/>  }</span><span id="8fa9" class="mr lk iq mn b gy mw mt l mu mv">  render() {<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;Typography style={{fontSize: 16, fontWeight: 'bold'}}&gt;<br/>          Without Ref<br/>        &lt;/Typography&gt;<br/>        &lt;TextField /&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/792c4d055621b6f242590d24008334e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/1*HKMeGshok0qxG7eTZ-StDQ.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Basic Input Rendering without a ref</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="d1ee" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">解决方案是:</h1><p id="6618" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated"><a class="ae lb" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>框架包含两种类型的组件。功能和类组件。我们的解决方案将关注react的两个关键方法，<a class="ae lb" href="https://reactjs.org/docs/refs-and-the-dom.html#creating-refs" rel="noopener ugc nofollow" target="_blank"> createRef </a>和最近的react hook <a class="ae lb" href="https://reactjs.org/docs/hooks-reference.html#useref" rel="noopener ugc nofollow" target="_blank"> useRef </a>。<strong class="jp ir"> createRef可用于类组件和功能组件</strong>。然而，在这些例子中，我将为每个组件类型使用一个。</p><p id="2075" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">类组件:</strong></p><p id="b4fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">利用React的createRef方法，我们可以在上面的基本代码中添加以下几行。这将首先在我们的类中创建一个名为myInput的ref。因为我们使用的是materialUI中的textField，所以这实际上包装了input的基本组件。<strong class="jp ir">如果您在自定义组件中使用它，应该使用ref prop而不是inputRef </strong>。最后，有时我们可能想要在一个还没有挂载的组件上触发一个方法。因此，如果电流可用，我们称之为电流。如果不是，它将被存储为null。</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="c331" class="mr lk iq mn b gy ms mt l mu mv">// Between class and constructor<br/>myInput = React.createRef();</span><span id="cf3c" class="mr lk iq mn b gy mw mt l mu mv">// Add this prop to the textfield<br/>inputRef={this.myInput} </span><span id="d5aa" class="mr lk iq mn b gy mw mt l mu mv">// Check if our ref has been assigned and if so, focus.<br/>componentDidMount() {<br/>  this.myInput.current &amp;&amp; this.myInput.current.focus();<br/>}</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9ea63818a2c684af848039c446d33b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/1*Lm2Vt1go_uK46FnIpEXiOQ.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Class Component | Input rendering with createRef</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="6002" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">功能组件:</strong></p><p id="6b27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个例子中，我们将使用react的钩子。<strong class="jp ir">类组件示例也可以，只需去掉</strong> <code class="fe my mz na mn b"><strong class="jp ir">this</strong></code> <strong class="jp ir">，使用</strong> <code class="fe my mz na mn b"><strong class="jp ir">myInput</strong></code> <strong class="jp ir">作为自己的变量。我们呈现非焦点输入字段的基本代码如下所示:</strong></p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="fa72" class="mr lk iq mn b gy ms mt l mu mv">import React from 'react';<br/>import { TextField, Typography } from '@material-ui/core';</span><span id="2208" class="mr lk iq mn b gy mw mt l mu mv">export default function CustomInput({ classes }) {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;Typography style={{fontSize: 16, fontWeight: 'bold'}}&gt;<br/>        Without Ref<br/>      &lt;/Typography&gt;<br/>      &lt;TextField /&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="998b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">增加了以下几行:</p><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="9aa0" class="mr lk iq mn b gy ms mt l mu mv">// Import our hooks<br/>import React, { useRef, useEffect } from 'react';</span><span id="c4df" class="mr lk iq mn b gy mw mt l mu mv">// create our ref<br/>const myInput = useRef();</span><span id="32d3" class="mr lk iq mn b gy mw mt l mu mv">// This is equivalent to our componentDidMount, this will focus<br/>useEffect(() =&gt; myInput.current &amp;&amp; myInput.current.focus());</span><span id="c95c" class="mr lk iq mn b gy mw mt l mu mv">// Parse our ref to our textField<br/>&lt;Textfield inputRef={myInput} /&gt;</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/4f992dbd662311e483a3065e2dc83f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/1*v9eY-hyP4w-OsHKKE5Yp-A.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Functional Component | input rendering with useRef</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="8e51" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">最后的想法</h1><ul class=""><li id="b7ae" class="nc nd iq jp b jq mh ju mi jy ne kc nf kg ng kk nh ni nj nk bi translated">如果除了focus之外不需要ref，可以直接使用下面的语句:</li></ul><pre class="km kn ko kp gt mm mn mo mp aw mq bi"><span id="5e32" class="mr lk iq mn b gy ms mt l mu mv">&lt;TextField inputRef={input =&gt; input &amp;&amp; input.focus()} /&gt;</span></pre><ul class=""><li id="20c0" class="nc nd iq jp b jq jr ju jv jy nl kc nm kg nn kk nh ni nj nk bi translated">props中包含了许多专门用于这些用例的框架组件。比如<code class="fe my mz na mn b">autoFocus</code>、<code class="fe my mz na mn b">onClick</code>等等。<strong class="jp ir">首先阅读你的文档，</strong>这篇文章最适用于你自己的定制组件或者输入或表单的独特用例。</li><li id="39d9" class="nc nd iq jp b jq no ju np jy nq kc nr kg ns kk nh ni nj nk bi translated">如果我漏掉了什么，请评论！这是最近实现的一个滚动想法，我不怀疑我遗漏了一些东西。</li></ul></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="4c10" class="mr lk iq bd ll nt nu dn lp nv nw dp lt jy nx ny lx kc nz oa mb kg ob oc mf od bi translated">进一步阅读</h2><div class="oe of gp gr og oh"><a href="https://bit.cloud/blog/introducing-component-compare-easily-review-component-changes-l4qyxtoo" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">比特博客</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">组件驱动软件的官方博客。围绕现代组件驱动的web开发的文章…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">比特云</p></div></div><div class="oq l"><div class="or l os ot ou oq ov kv oh"/></div></div></a></div><p id="7f7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ow">更多内容看</em> <a class="ae lb" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ow">说白了就是</em> </strong> </a> <em class="ow">。报名参加我们的</em> <a class="ae lb" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ow">免费周报</em> </strong> </a> <em class="ow">。关注我们关于</em> <a class="ae lb" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ow">推特</em> </strong> </a>，<a class="ae lb" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ow">领英</em> </strong> </a> <strong class="jp ir"> <em class="ow">，</em></strong><a class="ae lb" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="ow">YouTube</em></strong></a><strong class="jp ir"><em class="ow">，以及</em></strong><em class="ow"/><a class="ae lb" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="ow">不和</em> </strong> </a>  <em class="ow">对成长黑客感兴趣？检查出</em> <a class="ae lb" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ow">电路</em> </strong> </a> <strong class="jp ir"> <em class="ow">。</em>T71】</strong></p></div></div>    
</body>
</html>