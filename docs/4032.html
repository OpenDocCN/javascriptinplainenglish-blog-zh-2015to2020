<html>
<head>
<title>5 lessons I learned while teaching myself Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我自学Node.js时学到的5个教训</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/5-lessons-i-learned-teaching-myself-nodejs-74b5f6967dcf?source=collection_archive---------14-----------------------#2020-11-11">https://javascript.plainenglish.io/5-lessons-i-learned-teaching-myself-nodejs-74b5f6967dcf?source=collection_archive---------14-----------------------#2020-11-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b2c0bde26b61a544dc401d57f2d96e7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I9lARsrOTJYULH7CFBFXyg.png"/></div></div></figure><p id="6646" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用了10年的灯堆，我觉得是时候尝试新的东西了。</p><p id="4c94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我已经看到了NodeJS+MongoDB可以做的一些漂亮的事情，并决定是时候冒险了。</p><p id="4a76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我学到的。</p><h1 id="1df3" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">1.它有自己的服务器</h1><p id="e1cc" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">因为NodeJS运行在JavaScript上，所以它需要自己的运行时环境，类似于PHP和Apache。</p><p id="b55e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本地工作时，您可能会安装类似Mamp或Xampp的东西。这将在您的机器上创建一个本地服务器，您可以在其中编写PHP应用程序。</p><p id="e338" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">NodeJS就像本地服务器一样运行，一旦您安装了它并编写了一个基本的服务器脚本，在本例中是app.js，您就可以在每次想要开发或添加包时启动您的服务器。</p><p id="1e9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过在终端中使用这个命令，您可以非常容易地启动NodeJS应用程序。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="4699" class="mi kx iq me b gy mj mk l ml mm">npx run app.js</span></pre><p id="2260" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后URL <em class="mn"> localhost:3000 </em>变得可用，在这里您可以像处理LAMP堆栈一样处理本地应用程序。</p><p id="6c00" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以选择任何您想要的端口，只要它可用，允许您同时运行多个应用程序。</p><p id="887a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，把它放在现场需要一些虚拟主机魔术与代理，找到如何做到这一点。</p><div class="mo mp gp gr mq mr"><a href="https://medium.com/javascript-in-plain-english/running-a-nodejs-application-on-an-apache-production-server-4d3cca078f94" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">在Apache生产服务器上运行NodeJS应用程序</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">这是我希望在发布我的NodeJS应用程序时找到的文章。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf jw mr"/></div></div></a></div><h1 id="4a62" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">2.异步JavaScript很难让人理解</h1><p id="feac" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">这是学习NodeJS最困难的部分。</p><p id="f5dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我太习惯PHP处理代码执行的方式了，以至于当要写不同的代码时，我不能重新连接我的大脑。</p><p id="7ebe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我使用Mongoose从MongoDB数据库中调用数据，然后将结果添加到一个变量中。</p><p id="4e0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是当我在for循环中使用这个变量时，里面什么也没有。</p><p id="3a54" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是因为当代码执行时，它进行数据库调用，然后在结果返回之前尝试使用变量。</p><p id="8f72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对此有几种解决方案:</p><h2 id="f470" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 2.1回调</strong></h2><p id="1e3a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在函数回调中添加处理。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="2674" class="mi kx iq me b gy mj mk l ml mm">//call document data from database<br/>MyDocuments.findOne({id:DocId}, function(err, document) {</span><span id="ebc4" class="mi kx iq me b gy nr mk l ml mm">  //process document data returned</span><span id="9b01" class="mi kx iq me b gy nr mk l ml mm">})</span></pre><p id="91da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是最简单易懂的方法。然而，我的一个有点NodeJS奇才的好朋友向我保证，这不是最好的做事方式。</p><p id="0685" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">主要是因为复杂的应用程序会让你进入“回调地狱”,在回调中有回调，这可能会导致一些非常混乱的代码。</p><h2 id="2b5e" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 2.2承诺等待/异步</strong></h2><p id="ec55" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">这鼓励JavaScript在尝试做下一件事之前等待一个函数完成。</p><p id="57a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我不得不承认，即使我设法在我的代码中写了一些这样的功能，我仍然不能完全理解它。</p><p id="f951" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看起来，经过10年的工作，某种方式可能已经使我的编程思想变得更加坚定，或者我只是还没有找到一种方式来解释我所理解的方式。</p><p id="bf86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，如果您正在开始NodeJS之旅，我建议您做一些有希望的例子，以获得至少一个基本的理解。当你的变量为空的时候，它将证明对你是非常宝贵的，你知道事实上它们不应该是空的。</p><h1 id="92e8" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">3.一些惊人的扩展</h1><p id="f1ae" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">只有当你开始搜索解决方案时，你才开始发现其他开发人员已经完成的解决你的问题的惊人工作。</p><p id="4b48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">浏览NodeJS包库，我意识到它是多么的庞大！</p><p id="7b35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">专业提示:在每个包的页面上，它会显示你在过去一周内下载了多少次。这尤其有助于衡量它有多受欢迎，这通常会给你一个好的概念。</p><p id="d32f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我已经在我的应用程序中使用了几个软件包，它们让我的生活变得更加轻松，我在这里列出了它们。</p><h2 id="3044" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 3.1锐</strong></h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="40e7" class="mi kx iq me b gy mj mk l ml mm">npm i sharp</span></pre><p id="1e9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我非常喜欢Sharp，我甚至在这里写了一篇关于它的文章'<a class="ae ns" href="https://medium.com/javascript-in-plain-english/using-sharp-in-nodejs-to-output-resize-and-crop-images-on-the-fly-f8b150989760" rel="noopener">在Node.js中使用Sharp来输出、调整和裁剪图像</a>。</p><p id="3bfd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但说真的，很棒。它可以接收任何大小、格式或质量的任何图像，并以不同的大小、格式或质量输出。</p><p id="873d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它的速度也非常快，因此可以用来在页面加载时输出图像。</p><p id="c570" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我目前的应用程序可以在不到一秒钟的时间内加载30张图片，将其中的2/3转换为webp，1/3转换为png，以备不支持webp的浏览器使用。</p><h2 id="ae1f" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 3.2 PM2 </strong></h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9fa2" class="mi kx iq me b gy mj mk l ml mm">npm i pm2</span></pre><p id="25c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您想在生产服务器上运行您的应用程序，那么PM2是必须的。</p><p id="d93a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">PM2是一个守护进程管理器。因此，一旦你告诉它照看你的应用程序，你知道，它会得到很好的照顾。</p><p id="c7ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它优雅地处理错误、重启、日志记录和几乎所有你想从服务器管理程序中得到的东西。</p><p id="d77c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">稳定的生产环境有许多功能；你甚至可以告诉它注意变化，这样它就可以在新代码上传时重新启动。</p><h2 id="ca37" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 3.3节点邮件程序</strong></h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="61c8" class="mi kx iq me b gy mj mk l ml mm">npm i nodemailer</span></pre><p id="235b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Nodemailer是一种简单有效的通过NodeJS发送邮件的方式。</p><p id="bb38" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它可以处理SMTP，这在当今防止垃圾邮件的世界中特别有用。</p><p id="32f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有一小段代码向您展示这有多简单。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9066" class="mi kx iq me b gy mj mk l ml mm">let transport = nodemailer.createTransport({</span><span id="f4c0" class="mi kx iq me b gy nr mk l ml mm"> host: '[smtp host]',</span><span id="2644" class="mi kx iq me b gy nr mk l ml mm"> port: 25,</span><span id="fdc9" class="mi kx iq me b gy nr mk l ml mm"> auth: {</span><span id="b77a" class="mi kx iq me b gy nr mk l ml mm">  user: '[smtp user]',</span><span id="002b" class="mi kx iq me b gy nr mk l ml mm">  pass: '[smtp password]'</span><span id="e480" class="mi kx iq me b gy nr mk l ml mm"> }</span><span id="7a04" class="mi kx iq me b gy nr mk l ml mm">});</span><span id="674c" class="mi kx iq me b gy nr mk l ml mm">const message = {</span><span id="3bc0" class="mi kx iq me b gy nr mk l ml mm">from: '[from@]', // Sender address</span><span id="0ff2" class="mi kx iq me b gy nr mk l ml mm">to: '[to@]',         // List of recipients</span><span id="0c2f" class="mi kx iq me b gy nr mk l ml mm">subject: '[subject line]', // Subject line</span><span id="12f2" class="mi kx iq me b gy nr mk l ml mm">html: "Hello, world!" // Plain text body</span><span id="d635" class="mi kx iq me b gy nr mk l ml mm">};</span><span id="ec79" class="mi kx iq me b gy nr mk l ml mm">transport.sendMail(message, function(err, info) {</span><span id="a8dc" class="mi kx iq me b gy nr mk l ml mm">if (err) {</span><span id="8bcb" class="mi kx iq me b gy nr mk l ml mm"> console.log(err)</span><span id="1a84" class="mi kx iq me b gy nr mk l ml mm"> } else {</span><span id="7e30" class="mi kx iq me b gy nr mk l ml mm"> }</span><span id="45e8" class="mi kx iq me b gy nr mk l ml mm">});</span></pre><h2 id="9277" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 3.4注意事项</strong></h2><p id="a8db" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">尽量不要使用太多的依赖项/包。记住，这段代码是由<em class="mn">其他人</em>编写和维护的。</p><p id="99ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果他们不能保持更新，那么它最终将需要被替换，有时写几行代码也同样有效。</p><h1 id="ce5d" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">4.大量的框架和模板引擎</h1><p id="ebc8" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">我学到的另一件美妙的事情是，有很多框架可以帮助你按照自己的方式构建应用程序。</p><p id="a262" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了容易互换的框架和模板引擎，如果你不喜欢某样东西，就安装别的东西试试。太直白了。</p><h2 id="2951" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 4.1框架</strong></h2><p id="b72b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">托管像Koa、哈比神和Nest这样的框架，你无疑能够找到适合你的框架。</p><p id="f478" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于我没有使用过它们，所以我不能详细描述上面的内容，但是当我打算开始我的NodeJS之旅时，Express一次又一次地出现。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="a098" class="mi kx iq me b gy mj mk l ml mm">npm i express</span></pre><p id="1f6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它帮助我进行路由(我最害怕的事情之一)，处理响应，并且支持超过14个模板引擎。</p><p id="053f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我会鼓励你看看其他人，但Express做了我能要求的一切，所以我觉得没有必要去寻找其他东西。</p><h2 id="45f8" class="mi kx iq bd ky ng nh dn lc ni nj dp lg kj nk nl lk kn nm nn lo kr no np ls nq bi translated"><strong class="ak"> 4.2模板引擎</strong></h2><p id="666b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">有相当多的模板引擎可供选择，如车把，小胡子，哈巴狗和圆点。</p><p id="08de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我确信它们都有各自的好处，但是我想要一些接近使用PHP和HTML的东西，因为那是我所习惯的。</p><p id="6eee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我从Pug开始，但是我不明白制作一个简单的HTML页面的语法。</p><p id="e91b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最终，我选择了EJS。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="2ef4" class="mi kx iq me b gy mj mk l ml mm">npm i ejs</span></pre><p id="b85b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你以前用过模板引擎，那么使用EJS会感觉很熟悉。你像平常一样写HTML，把JavaScript嵌入其中。</p><p id="6740" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">和Express配合的很好，合起来超级快。赢家。</p><h1 id="2277" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">5.MySQL？NoSQL！</h1><p id="e394" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">使用MySQL多年后，尽管我从未构建过超级复杂的查询字符串，但我认为我已经很好地掌握了这个概念，可以在几分钟内完成一个不错的MySQL查询，它可以考虑多个表中的多个字段。</p><p id="f9fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，当我不得不开始使用像MongoDB这样的NoSQL数据库时，它把我所知道的一些东西扔出了窗外，我肯定会说还有更多东西要学。</p><p id="4d56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我安装并开始使用mongose来帮助我利用MongoDB:<em class="mn">“mongose是MongoDB和Node.js的对象数据建模(ODM)库，它管理数据之间的关系，提供模式验证，并用于在代码中的对象和MongoDB中这些对象的表示之间进行转换”。</em></p><p id="db96" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在MySQL中创建左连接或右连接非常简单，您可以通过id引用数据，但是在Mongoose中，我使用了一个名为aggregation和$lookup的函数来创建连接。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="0acd" class="mi kx iq me b gy mj mk l ml mm">Places.aggregate([<br/> { "$match": {<br/>  slug:the_slug,<br/>  status:'publish'}},<br/> {$lookup: {<br/>  from: "places",<br/>  localField: "related_post_event",<br/>  foreignField: "id",<br/>  as: "event_venue"<br/>}}</span></pre><p id="69ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我了解到跨表聚合会占用大量资源，所以可能有更好的方法。如果你知道，请评论这篇文章。</p><p id="9f37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是我喜欢MongoDB的一点是它不繁琐。</p><p id="949c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以将任何内容放入集合(表)中，它会为您计算出字段数据类型。</p><p id="0d3f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不需要定义表的模式和列，MongoDB并不在乎，只要它有一个id，那么在一个集合中就可以有许多不同的对象类型。</p><p id="1f09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">显然，只有当这是数据结构工作的最佳方式时，才这样做。</p><h1 id="9a23" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="24d1" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">从LAMP栈迁移到NodeJS、Express和MongoDB非常简单，因为我以前使用过模板引擎和JavaScript。</p><p id="863b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">路由、JavaScript的异步性和理解NodeJS如何在典型的服务器上运行确实让我头疼。</p><p id="1503" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，有一点我可以说的是，我觉得挺过瘾的。</p><p id="3546" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">速度，你可以安装的无止境的有用包列表和power NodeJS给了你很多选择，如果你想在开发一个应用程序或网站的同时学习一门新的编程语言，我绝对推荐你试试NodeJS。</p><p id="4707" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的阅读，希望您喜欢我的文章。</p><p id="0467" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请查看我下面的其他文章。</p><div class="mo mp gp gr mq mr"><a href="https://medium.com/javascript-in-plain-english/how-to-get-over-90-on-google-pagespeed-insights-a85255ac9a05" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">如何在Google Pagespeed Insights上获得90分</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">除了个人走私之外，为什么还要在Chrome的Lighthouse扩展中尝试100个呢…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="nt l nc nd ne na nf jw mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a href="https://medium.com/javascript-in-plain-english/i-redesigned-and-rebuilt-my-website-in-a-new-technology-and-it-died-in-google-f403bf9e4a85" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">我在Node.js重建了我的网站，它死在了Google。以下是我学到的</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">上线一个新网站总会有一点紧张，而且有一个很好的理由，它通常没有经过…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="nu l nc nd ne na nf jw mr"/></div></div></a></div></div></div>    
</body>
</html>