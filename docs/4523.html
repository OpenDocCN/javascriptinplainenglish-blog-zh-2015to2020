<html>
<head>
<title>Vuex 4 — Modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vuex 4 —模块</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vuex-4-modules-f946fc869155?source=collection_archive---------5-----------------------#2020-12-18">https://javascript.plainenglish.io/vuex-4-modules-f946fc869155?source=collection_archive---------5-----------------------#2020-12-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ee3317ec76b6f4da046046b99a068bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6E4IfwigtT3SMYP3"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@vincentiu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Vincentiu Solomon</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="20df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> Vuex 4处于测试阶段，可能会有变化。</strong></p><p id="15d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex是一个流行的Vue状态管理库。</p><p id="a15e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vuex 4是专为Vue 3设计的版本。</p><p id="5bb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解如何将Vuex 4与Vue 3配合使用。</p><h1 id="2be9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">模块</h1><p id="94fa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将我们的Vuex 4存储划分成模块，这样我们就可以将我们的状态划分成多个更小的部分。</p><p id="463f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个模块都有自己的状态、突变、动作和getters。</p><h1 id="2995" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">模块本地状态</h1><p id="84e4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每个模块都有自己的本地状态。我们可以通过编写以下代码将模块的状态映射到计算的属性中，并将变化映射到方法中:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0e2f" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{doubleCount}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const moduleA = {<br/>        state: () =&gt; ({<br/>          count: 0<br/>        }),<br/>        mutations: {<br/>          increment(state) {<br/>            state.count++;<br/>          }<br/>        },<br/>        getters: {<br/>          doubleCount(state) {<br/>            return state.count * 2;<br/>          }<br/>        }<br/>      };</span><span id="2103" class="mn lc iq mj b gy ms mp l mq mr">      const store = new Vuex.Store({<br/>        modules: {<br/>          moduleA<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          ...Vuex.mapMutations(["increment"])<br/>        },<br/>        computed: {<br/>          ...Vuex.mapGetters(["doubleCount"])<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="d942" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了带有<code class="fe mt mu mv mj b">modules</code>属性的存储，以便在存储中包含我们的模块。</p><p id="f301" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在我们的Vue实例中，我们用<code class="fe mt mu mv mj b">mapMutations</code>和<code class="fe mt mu mv mj b">mapGetters</code>方法将突变映射到方法，用getters映射到计算的属性。</p><p id="f6a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以对动作和状态做同样的事情。</p><p id="0c53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8a2e" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="increment"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{moduleA.count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const moduleA = {<br/>        state: () =&gt; ({<br/>          count: 0<br/>        }),<br/>        mutations: {<br/>          increment(state) {<br/>            state.count++;<br/>          }<br/>        },<br/>        actions: {<br/>          increment({ commit }) {<br/>            commit("increment");<br/>          }<br/>        }<br/>      };</span><span id="b2ea" class="mn lc iq mj b gy ms mp l mq mr">      const store = new Vuex.Store({<br/>        modules: {<br/>          moduleA<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          ...Vuex.mapActions(["increment"])<br/>        },<br/>        computed: {<br/>          ...Vuex.mapState({ moduleA: (state) =&gt; state.moduleA })<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e3cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用一组动作名调用了<code class="fe mt mu mv mj b">mapActions</code>方法。</p><p id="4d12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用一个对象调用<code class="fe mt mu mv mj b">mapState</code>方法，该对象带有返回模块状态的方法。</p><p id="5f50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">状态在对象中，模块名作为属性名。</p><h1 id="f5d3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">命名空间</h1><p id="0b39" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以命名我们的模块。</p><p id="9e1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们就不会把所有东西都放在一个全局名称空间下。</p><p id="b152" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，这让多个模块对相同的突变或动作类型做出反应。</p><p id="3cf0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a147" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="this['moduleA/increment']"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{moduleA.count}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const moduleA = {<br/>        state: () =&gt; ({<br/>          count: 0<br/>        }),<br/>        mutations: {<br/>          increment(state) {<br/>            state.count++;<br/>          }<br/>        },<br/>        actions: {<br/>          increment({ commit }) {<br/>            commit("increment");<br/>          }<br/>        }<br/>      };</span><span id="f823" class="mn lc iq mj b gy ms mp l mq mr">      const store = new Vuex.Store({<br/>        modules: {<br/>          moduleA: {<br/>            namespaced: true,<br/>            ...moduleA<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          ...Vuex.mapActions(["moduleA/increment"])<br/>        },<br/>        computed: {<br/>          ...Vuex.mapState({ moduleA: (state) =&gt; state.moduleA })<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="de75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们将<code class="fe mt mu mv mj b">namespaced</code>属性设置为<code class="fe mt mu mv mj b">true</code>，所以我们用名称空间名称来映射动作。</p><p id="e67a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以对getters和突变做同样的事情。</p><p id="8419" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="167c" class="mn lc iq mj b gy mo mp l mq mr">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="https://unpkg.com/vue@next"&gt;&lt;/script&gt;<br/>    &lt;script src="https://unpkg.com/vuex@4.0.0-beta.4/dist/vuex.global.js"&gt;&lt;/script&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      &lt;button @click="this['moduleA/increment']"&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{{this['moduleA/doubleCount']}}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>    &lt;script&gt;<br/>      const moduleA = {<br/>        state: () =&gt; ({<br/>          count: 0<br/>        }),<br/>        mutations: {<br/>          increment(state) {<br/>            state.count++;<br/>          }<br/>        },<br/>        getters: {<br/>          doubleCount(state) {<br/>            return state.count;<br/>          }<br/>        }<br/>      };</span><span id="1754" class="mn lc iq mj b gy ms mp l mq mr">      const store = new Vuex.Store({<br/>        modules: {<br/>          moduleA: {<br/>            namespaced: true,<br/>            ...moduleA<br/>          }<br/>        }<br/>      });<br/>      const app = Vue.createApp({<br/>        methods: {<br/>          ...Vuex.mapMutations(["moduleA/increment"])<br/>        },<br/>        computed: {<br/>          ...Vuex.mapGetters(["moduleA/doubleCount"])<br/>        }<br/>      });<br/>      app.use(store);<br/>      app.mount("#app");<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="f6a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用名称空间名称调用了<code class="fe mt mu mv mj b">mapMutations</code>和<code class="fe mt mu mv mj b">mapGetters</code>，因为我们在模块中将<code class="fe mt mu mv mj b">namespaced</code>设置为<code class="fe mt mu mv mj b">true</code>。</p><h1 id="89a0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="de8c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建我们的模块并命名它们，这样我们就可以有多个较小的存储部分来管理它们自己的状态。</p><p id="aec6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>