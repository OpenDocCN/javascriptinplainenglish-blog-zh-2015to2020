<html>
<head>
<title>Develop a Twitter Bot Using Node.JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node开发一个Twitter机器人。射流研究…</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/develop-a-twitter-bot-using-node-js-4aae715187a1?source=collection_archive---------8-----------------------#2020-07-27">https://javascript.plainenglish.io/develop-a-twitter-bot-using-node-js-4aae715187a1?source=collection_archive---------8-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cdbe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用Node.js创建Twitter bot，并将其部署到Heroku中</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ac96edf713f66ce6045abca9af530620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZZuHj1yZPUdsddU5"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@lukechesser?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Luke Chesser</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7e3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天在这篇文章中，我们将学习如何使用<strong class="ky ir"> Node.js </strong>创建一个Twitter机器人，并将其部署到Heroku中。这个机器人将增强我们在Twitter的任务，并能够做一些像转发等任务。这个功能可以通过使用Twitter API来实现。</p><p id="b921" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在进入主题之前，让我们看看我们将要遵循的步骤列表。</p><ul class=""><li id="2ce9" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">在Twitter申请开发者账号。</li><li id="cf81" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">创建应用程序。</li><li id="4723" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">设置环境。</li><li id="24c4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">实现代码。</li><li id="3741" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">避免重复转发。</li><li id="b64a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">部署。</li></ul><p id="247b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们深入正题。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="9ce2" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">在Twitter申请开发者账户</h1><p id="b401" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">这是最重要的一个，也是最困难的一个。</p><ul class=""><li id="d29c" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">登录Twitter。</li><li id="f383" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">去开发者控制台申请一个开发者账号。</li><li id="bc18" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">选择您要创建的应用类型。</li><li id="c6fc" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">提及你的应用程序的目的。</li></ul><p id="2cfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在申请之前，请确保您已经阅读了所有的开发商协议和政策。不符合这些条件将导致你的申请被拒绝。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="e3e1" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">创建应用程序</h1><p id="f842" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">一旦你的账户被Twitter批准。转到您的开发人员控制台。</p><ul class=""><li id="3dc7" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">在apps.twitter.com创建应用程序</li><li id="b896" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">填写所有必需的详细信息。</li><li id="c1cd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">生成唯一的API密钥。</li><li id="41f9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">进入应用详情，导航至<strong class="ky ir">密钥和令牌</strong>。</li><li id="4b4e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">对您的API密钥保密。</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="ad0a" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">设置环境</h1><p id="598e" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">首先使用各自的命令在你的电脑上安装N <strong class="ky ir"> ode.js </strong>和<strong class="ky ir"> npm </strong>。</p><p id="044f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个新目录，<strong class="ky ir"> your- </strong> <strong class="ky ir"> bot-name </strong>。</p><p id="ec4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">初始化git环境，并使用<strong class="ky ir"> npm </strong>安装所有依赖项<strong class="ky ir"> twit </strong>。在您的bot目录中输入以下命令。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="f729" class="np mo iq nl b gy nq nr l ns nt">$ git init<br/>$ npm init<br/>$ npm install twit</span></pre><p id="373b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在成功设置我们的开发环境。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="fb91" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">实现代码</h1><p id="b5d3" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">首先，我们必须认证<strong class="ky ir">Twitter</strong>，并使用我们之前生成的API密钥链接Twitter应用程序和代码。</p><p id="956d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个名为<strong class="ky ir"> config.js </strong>的新文件，并将代码粘贴到其中。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="45ab" class="np mo iq nl b gy nq nr l ns nt">module.exports = {<br/>consumer_key: APPLICATION_CONSUMER_KEY_HERE,<br/>consumer_secret: APPLICATION_CONSUMER_SECRET_HERE,<br/>access_token: ACCESS_TOKEN_HERE,<br/>access_token_secret: ACCESS_TOKEN_SECRET_HERE<br/>}</span></pre><p id="ef69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从Twitter仪表板应用您的唯一键。</p><p id="dfd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们用<strong class="ky ir"> bot.js </strong>为我们的机器人写一段代码。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="4eaf" class="np mo iq nl b gy nq nr l ns nt">const config = require('./config')<br/>const twit =  require('twit')<br/><br/>const T = new twit(config)<br/><br/>function retweet(searchText) {<br/>    // Params to be passed to the 'search/tweets' API endpoint<br/>    let params = {<br/>        q : searchText + '',<br/>        result_type : 'mixed',<br/>        count : 25,<br/>    }<br/><br/>    T.get('search/tweets', params, function(err_search, data_search, response_search){<br/><br/>        let tweets = data_search.statuses<br/>        if (!err_search)<br/>        {<br/>            let tweetIDList = []<br/>            for(let tweet of tweets) {<br/>                tweetIDList.push(tweet.id_str);<br/><br/>                //more code here later...<br/>            }<br/><br/>            // Call the 'statuses/retweet/:id' API endpoint for retweeting EACH of the tweetID<br/>            for (let tweetID of tweetIDList) {<br/>                T.post('statuses/retweet/:id', {id : tweetID}, function(err_rt, data_rt, response_rt){<br/>                    if(!err_rt){<br/>                        console.log("\n\nRetweeted! ID - " + tweetID)<br/>                    }<br/>                    else {<br/>                        console.log("\nError... Duplication maybe... " + tweetID)<br/>                        console.log("Error = " + err_rt)<br/>                    }<br/>                })<br/>            }<br/>        }<br/>        else {<br/>            console.log("Error while searching" + err_search)<br/>            process.exit(1)<br/>        }<br/>    })<br/>}<br/><br/>// Run every 60 seconds<br/>setInterval(function() { retweet('#DataScience OR #DataVisualization'); }, 60000)</span></pre><p id="f2f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用我们的配置初始化了twit对象。</p><p id="afa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将参数传递给搜索API</p><ul class=""><li id="74bd" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">问</strong> -搜索查询。</li><li id="e44a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir"> result_type </strong> -热门或老的推文。</li><li id="1e3f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">计数</strong> -检索到的推文数量。</li></ul><p id="2f7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> JSON </strong>对象用于检索所有推文，并将每个推文传递给<strong class="ky ir"> status/retweet/:id </strong></p><p id="771f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在使用以下命令在本地测试bot。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="b21f" class="np mo iq nl b gy nq nr l ns nt">node bot.js</span></pre></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="456d" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">避免重复转发</h1><p id="1906" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在<strong class="ky ir"> bot.js </strong>的for循环中添加以下代码</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="8310" class="np mo iq nl b gy nq nr l ns nt">if(tweet.text.startsWith("RT @")) {<br/> if(tweet.retweeted_status) {<br/>    tweetIDList.push(tweet.retweeted_status.id_str);<br/> }<br/> else {<br/>    tweetIDList.push(tweet.id_str);<br/> }<br/>}<br/>else {<br/>    tweetIDList.push(tweet.id_str);<br/>}</span></pre><p id="15a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在循环之外加上这个。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="a947" class="np mo iq nl b gy nq nr l ns nt">/ Utility function - Gives unique elements from an array<br/>function onlyUnique(value, index, self) { <br/>    return self.indexOf(value) === index;<br/>}<br/><br/>// Get only unique entries<br/>tweetIDList = tweetIDList.filter( onlyUnique )</span></pre><ul class=""><li id="95e1" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">每条推文都有唯一的id，<strong class="ky ir"> id_str。</strong></li><li id="96ee" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">每条转发都有不同的<strong class="ky ir"> id_str </strong>。</li><li id="8556" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">搜索API用于查找它是原创的还是转发的。</li><li id="56bf" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这将避免我们的机器人重复。</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="ffd1" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">部署</h1><p id="8633" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">首先在heroku中创建一个帐户，然后使用“您的僵尸名称”创建一个应用程序名称。</p><p id="8979" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保持本地目录文件名和heroku项目名相同。</p><p id="70b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装heroku-cli并使用以下命令创建一个“Procfile”。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="44e7" class="np mo iq nl b gy nq nr l ns nt">worker: node bot.js</span></pre><p id="8921" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">登录heroku CLI。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="e5e6" class="np mo iq nl b gy nq nr l ns nt">$ heroku login</span></pre><p id="16a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在部署之前，转到heroku dashboard，启动worker dyno并对其进行配置。</p><p id="451e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用以下命令部署到heroku。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="4f98" class="np mo iq nl b gy nq nr l ns nt">$ heroku git:remote -a your-botname<br/>$ git add<br/>$ git commit -am "Add code"<br/>$ git push heroku master</span></pre></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="d2f3" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">结论</h1><p id="4afd" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我希望你喜欢它，并学习了如何使用node.js创建一个twitter机器人，并使用heroku部署它。</p><p id="c2fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p><h2 id="bf24" class="np mo iq bd mp nu nv dn mt nw nx dp mx lf ny nz mz lj oa ob nb ln oc od nd oe bi translated">简单英语的JavaScript</h2><p id="6551" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="ky ir">！</strong></p></div></div>    
</body>
</html>