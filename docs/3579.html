<html>
<head>
<title>Build a Seven Segment Display in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript构建一个七段显示</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-a-seven-segment-display-in-javascript-8822a7332c70?source=collection_archive---------7-----------------------#2020-10-10">https://javascript.plainenglish.io/build-a-seven-segment-display-in-javascript-8822a7332c70?source=collection_archive---------7-----------------------#2020-10-10</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div class="gi gj jo"><img src="../Images/6a852d39570583774826fd7f34e7ba88.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*HEl0-2NgVlsmUXQW2v1xxw.png"/></div></figure><p id="53ca" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">对于这个项目，我将编写一个JavaScript小部件，它使用SVG以七段显示风格在网页上显示数值。</p><p id="58f6" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">这个帖子在YouTube上有一个相关的视频。</p><figure class="kt ku kv kw gu js"><div class="bz fq l di"><div class="kx ky l"/></div></figure><h2 id="6fb1" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">该项目</h2><p id="a67e" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">该项目由以下文件组成，您可以克隆/下载<a class="ae lx" href="https://github.com/CodeDrome/seven-segment-display-javascript" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p><ul class=""><li id="6233" class="ly lz ir jx b jy jz kc kd kg ma kk mb ko mc ks md me mf mg bi translated">seven_segment_display.js</li><li id="5c46" class="ly lz ir jx b jy mh kc mi kg mj kk mk ko ml ks md me mf mg bi translated">seven_segment_display.htm</li><li id="6982" class="ly lz ir jx b jy mh kc mi kg mj kk mk ko ml ks md me mf mg bi translated">seven_segment_display_page.js</li></ul><p id="f87c" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">第一个JavaScript文件包含小部件本身。HTML文件包含一组用于配置、控制和显示小部件实例的控件，第二个JavaScript文件包含页面代码。</p><p id="1979" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">该小部件实现为ES6/ES2015类。让我们先看看它的构造函数。</p><figure class="kt ku kv kw gu js"><div class="bz fq l di"><div class="mm ky l"/></div></figure><p id="f427" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">首先，我们有两个对象，作为小部件的两个属性的枚举。接下来，小部件的内容和格式有许多变量。<code class="fe mn mo mp mq b">_Segments</code>数组用每个数字点亮的段模式初始化。</p><p id="54ae" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">最后，我们调用三个函数来设置小部件的初始状态:</p><p id="f933" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">对于任何给定的位数，宽度:高度的比率必须是一个特定的值，因此<code class="fe mn mo mp mq b">_SetHeight</code>函数将相对于SVG元素宽度的高度设置为正确的值。</p><p id="c757" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">主页面中的SVG元素需要添加许多元素，显示中的每一段都有一个元素，包括小数点。这些都是由<code class="fe mn mo mp mq b">_CreateSegments</code>函数创建的。</p><p id="bc83" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">通过<code class="fe mn mo mp mq b">_SetSegmentColours</code>功能设置适当的分段颜色来显示数字。在此阶段，将显示默认值0。</p><p id="9ac8" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">接下来，我们将查看属性。</p><figure class="kt ku kv kw gu js"><div class="bz fq l di"><div class="mm ky l"/></div></figure><p id="f2ea" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated"><code class="fe mn mo mp mq b">ColorSchemes</code>和<code class="fe mn mo mp mq b">DecimalPointTypes</code>是可供客户端代码使用的只读属性，因此它知道相应的<code class="fe mn mo mp mq b">ColorScheme</code>和<code class="fe mn mo mp mq b">DecimalPointType</code>属性的可用值。</p><p id="2099" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">各种颜色属性<code class="fe mn mo mp mq b">BackgroundColor</code>、<code class="fe mn mo mp mq b">LitSegmentColor</code>、<code class="fe mn mo mp mq b">UnlitSegmentColor</code>和<code class="fe mn mo mp mq b">ColorScheme</code>都很简单(如果是<code class="fe mn mo mp mq b">ColorScheme</code>的话就有点啰嗦了！)在设置了适当的变量后，它们调用<code class="fe mn mo mp mq b">_SetSegmentColours</code>用新的颜色更新小部件。</p><p id="08e0" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated"><code class="fe mn mo mp mq b">NumberOfDigits</code> setter验证新值，设置变量，然后调用各种函数来更新显示。<code class="fe mn mo mp mq b">NumberOfDecimalPlaces</code>设置器以类似的方式工作。</p><p id="91bb" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">在<code class="fe mn mo mp mq b">DecimalPointType</code>设置器中，我们只需要重新计算<code class="fe mn mo mp mq b">_ValueDisplayString</code>并调用<code class="fe mn mo mp mq b">_SetSegmentColours</code>。</p><p id="2037" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">最终属性是<code class="fe mn mo mp mq b">Value</code>。验证之后，我们需要重新计算<code class="fe mn mo mp mq b">_ValueDisplayString</code>并调用<code class="fe mn mo mp mq b">_SetSegmentColours</code>。</p><p id="51b3" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">最后我们有一些方法。</p><figure class="kt ku kv kw gu js"><div class="bz fq l di"><div class="mm ky l"/></div></figure><h2 id="2771" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">_SetHeight</h2><p id="8281" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">正如我上面提到的，对于给定的宽度和位数，小部件需要有特定的高度。这个函数设置这个高度。</p><h2 id="ff04" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">_ calculatevalueddisplaystring</h2><p id="e580" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">SetSegmentColours函数需要一个字符串而不是一个数字来显示线段的正确模式。_ CalculateValueDisplayString函数从数值属性生成此字符串，设置_DecimalPointPosition并用空格填充该字符串。</p><h2 id="2d38" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">_创建分段</h2><p id="92e5" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">此函数创建表示小部件分段的SVG元素，在构造函数中调用，如果分段的数量发生变化，也会调用此函数。</p><h2 id="1fa8" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">_ SetSegmentColours</h2><p id="afe0" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">SetSegmentColours函数根据_Segments数组中的模式设置段颜色以显示_ValueDisplayString。它需要一个重绘参数。如果这是假的，那么它只改变实际上在开和关之间翻转的段的颜色，如果值属性改变，这是所有需要做的。然而，如果任何颜色属性已经改变，所有的段需要改变它们的颜色，即使它们显示相同的数字；在这种情况下，重绘需要为真。</p><p id="ef59" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">这就是完成的七段显示小部件，现在让我们继续创建一个HTML页面和一些代码来创建和使用小部件。</p><h2 id="3873" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">seven_segment_display.htm</h2><p id="7324" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">我没有在这里列出页面的HTML，但它包含在下载中，这是在浏览器中打开的页面。</p><figure class="kt ku kv kw gu js gi gj paragraph-image"><div class="gi gj mr"><img src="../Images/e2e0492adb0cf65e349269a3f5edd51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*2Bg0PuYK3Bo0HVVYtuvsxQ.png"/></div></figure><p id="4aaa" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">如您所见，它包括一组控件来设置小部件的属性。还有一个启动/停止计数器的按钮，如果你点击它,<code class="fe mn mo mp mq b">Value</code>属性每秒增加一次。</p><h2 id="486e" class="kz la ir bd lb lc ld dn le lf lg dp lh kg li lj lk kk ll lm ln ko lo lp lq lr bi translated">seven_segment_display_page.js</h2><p id="acde" class="pw-post-body-paragraph jv jw ir jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ik bi translated">同样，我没有在这里列出代码，但是它创建了我们的Seven Segment Display小部件的一个实例，并且还包含事件处理程序，用于在用户更改任何内容时设置其属性。</p><p id="a8ee" class="pw-post-body-paragraph jv jw ir jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ik bi translated">该代码还使用JavaScript <code class="fe mn mo mp mq b">setInterval</code>和<code class="fe mn mo mp mq b">clearInterval</code>函数来启动或停止一个1秒钟的计时器，该计时器递增<code class="fe mn mo mp mq b">Value</code>属性。</p></div></div>    
</body>
</html>