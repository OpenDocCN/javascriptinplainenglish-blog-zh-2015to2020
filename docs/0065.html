<html>
<head>
<title>How to create a JavaScript Interface For MySQL Document Store via MySQL Shell 8.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过MySQL Shell 8.0为MySQL文档库创建JavaScript接口</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-interface-for-mysql-document-store-via-mysql-shell-8-0-d9a98c91e5fc?source=collection_archive---------7-----------------------#2019-01-12">https://javascript.plainenglish.io/javascript-interface-for-mysql-document-store-via-mysql-shell-8-0-d9a98c91e5fc?source=collection_archive---------7-----------------------#2019-01-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><blockquote class="jk jl jm"><p id="ad2a" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated"><em class="in">循序渐进(附实例)</em></p></blockquote><p id="5d6a" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在这篇文章中，我们将使用<strong class="jq io"> JavaScript </strong>使用<strong class="jq io"> MySQL Shell 8.0 (X Dev API) </strong>。</p></div><div class="ab cl kp kq hr kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ig ih ii ij ik"><p id="58d3" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">X Dev API在MySQL Shell X Dev API中提供了SQL的两种语言:</p><ul class=""><li id="ea32" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated">计算机编程语言</li><li id="f2ec" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">java描述语言</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/01158e9cf2c81e99da1b3787865e9cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*suHEICUmEdHgg5hTZsCv9A.png"/></div></div></figure><p id="9ccd" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">这是我们想要完成的任务的大纲:</p><ol class=""><li id="6fb4" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lw lc ld le bi translated">作为根用户<strong class="jq io">连接MySQL服务器</strong></li><li id="7fab" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">创建一个<strong class="jq io">新的</strong>T21数据库</li><li id="865a" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">创建/授予一个<strong class="jq io">新用户</strong></li><li id="33ae" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">切换到<strong class="jq io"> JS界面</strong></li><li id="edd2" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">使用之前创建的数据库/ <strong class="jq io">模式</strong></li><li id="af82" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">创建<strong class="jq io">新收藏</strong></li><li id="d6c8" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">将<strong class="jq io">文件</strong>插入集合</li><li id="8a0f" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lw lc ld le bi translated">通过导入<strong class="jq io"> JSON </strong>文件将<strong class="jq io">文件</strong>插入到集合中</li></ol><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lx"><img src="../Images/dfcf73714faf4bca881b4606a530f4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QcgMieWUKsh__Rox"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk">Photo by <a class="ae mc" href="https://unsplash.com/@michael_david_beckwith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Michael D Beckwith</a> on <a class="ae mc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2df9" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">— <em class="jp">先决条件</em></p><p id="1183" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在深入之前，最好安装/升级到MySQL 8.0，<br/>因为默认启用X协议。</p><p id="3746" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">对于<strong class="jq io"> Ubuntu </strong>，可以按照这个<a class="ae mc" href="https://stackoverflow.com/questions/49963923/how-do-i-update-mysql-5-7-to-the-new-mysql-8-0" rel="noopener ugc nofollow" target="_blank">链接</a>来安装。</p><p id="a622" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">安装MySQL Server 8.0后，必须安装<strong class="jq io"> MySQL Shell。</strong> <br/>在Ubuntu中，你可以使用下面的命令:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="b6e9" class="mi mj in me b gy mk ml l mm mn">sudo apt install mysql-shell</span></pre><p id="6051" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi">—</p><p id="dc7e" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em> <code class="fe mo mp mq me b"><em class="jp">mysql</em></code> <em class="jp"> </em>命令是经典的命令行界面。<br/><em class="jp">(2000年~现在)提示:</em> <code class="fe mo mp mq me b"><em class="jp">mysqlsh</em></code> <em class="jp"> </em>命令是新的shell界面。(2016 ~现在)</p><p id="7237" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em>经典MySQL协议运行在端口<strong class="jq io"> 3306 <br/> </strong> <em class="jp">提示:</em> MySQL X协议运行在端口<strong class="jq io"> 33060 </strong></p><p id="ef13" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em>到<strong class="jq io">清除</strong><code class="fe mo mp mq me b">mysql</code>中的<strong class="jq io">屏幕</strong>使用此命令:<code class="fe mo mp mq me b">\! clear</code> <em class="jp"> <br/>提示:</em>到<strong class="jq io">清除</strong><code class="fe mo mp mq me b">mysqlsh</code>中的<strong class="jq io">屏幕</strong>点击此快捷键:<code class="fe mo mp mq me b">ctrl</code> + <code class="fe mo mp mq me b">L</code></p></div><div class="ab cl kp kq hr kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ig ih ii ij ik"><h2 id="feb4" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">1.以Root身份连接</h2><p id="2860" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated">打开<strong class="jq io">端子</strong>，使用该命令<strong class="jq io">连接</strong>作为<strong class="jq io">根</strong>:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="bbcb" class="mi mj in me b gy mk ml l mm mn">sudo <strong class="me io">mysql</strong> -u root</span></pre><ul class=""><li id="e335" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated">如果它引发<code class="fe mo mp mq me b">Access Denied</code>错误，最好使用这个命令来代替:<br/> <code class="fe mo mp mq me b">sudo mysql -u root -p</code>，然后它会提示您输入密码。</li><li id="9bfa" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">否则，您现在作为根用户<strong class="jq io">连接到MySQL-server</strong></li></ul><p id="7aac" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">—备选方案</p><p id="ed20" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">你也可以使用<code class="fe mo mp mq me b">mysqlsh</code>命令来连接mysql-server: <br/>但是，你可能会遇到<code class="fe mo mp mq me b">root</code>用户的<code class="fe mo mp mq me b">access denied</code>！</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="9be9" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">mysqlsh</strong> -u root --sql</span></pre><p id="b0a6" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi">🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩</p><h2 id="0595" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">2.创建数据库</h2><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="d051" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">create</strong> database marveldb</span></pre><p id="c3c4" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi">🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩🧩</p><h2 id="0a8f" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">3.创建并授权用户</h2><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="65ef" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">create</strong> user 'tonystark' <strong class="me io">identified</strong> by 'ironman';</span><span id="e7bd" class="mi mj in me b gy nn ml l mm mn"><strong class="me io">grant</strong> <strong class="me io">all</strong> privileges <strong class="me io">on</strong> marveldb.* to 'tonystark';</span><span id="f2cf" class="mi mj in me b gy nn ml l mm mn"><strong class="me io">commit</strong>;</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4dcd334eb2e65eda11e0adb5a1046b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*Xt2lUQT8v0fdKqXg.png"/></div></figure><h2 id="d8fa" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">4.在MySQL Shell中使用JS接口(X协议)</h2><p id="6fdc" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated">退出上一个终端，打开另一个会话并键入:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="90fa" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">mysqlsh </strong>--sql</span></pre><p id="a25c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em>界面语言有三种选择:<code class="fe mo mp mq me b">--sql</code> <code class="fe mo mp mq me b">--js</code> <code class="fe mo mp mq me b">--py</code></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi np"><img src="../Images/cb83c35590c9b24567dcae34da997766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDFR6DH2SRRaL8rUl9ax9w.png"/></div></div></figure><p id="74f0" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在，您处于shell环境中，</p><p id="0f52" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">您可以使用以下命令之一来更改语言:</p><ul class=""><li id="f18f" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated"><code class="fe mo mp mq me b">\sql</code></li><li id="bad2" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><code class="fe mo mp mq me b">\py</code></li><li id="4513" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><code class="fe mo mp mq me b">\js</code></li></ul><p id="c8f9" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">执行下面的命令切换到<strong class="jq io"> Javascript </strong>:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="7c91" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">\js</strong></span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/e7b220f0b4e6e86243c66e0c4eda107e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OFC-jYsGUc3bLI24Q__cJw.png"/></div></div></figure><p id="0f50" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在，<strong class="jq io">将</strong>连接到之前创建的用户，命令如下:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="3376" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">\connect</strong> tonystark@localhost</span></pre><p id="3684" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">系统会提示您输入密码<br/>——在这种情况下，<strong class="jq io">用户名</strong>是<strong class="jq io"> tonystark <br/> - </strong>，而<strong class="jq io">密码</strong>是<strong class="jq io"> ironman </strong></p><p id="c185" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em>以<code class="fe mo mp mq me b"><strong class="jq io">\</strong></code>开头的命令是可以在所有三种语言中执行的全局命令:使用<code class="fe mo mp mq me b">\help</code>可以看到所有命令</p><p id="6ce3" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi">🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶</p><h2 id="2443" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">5.使用模式(数据库)</h2><p id="17a3" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated">要显示分配给模式变量的值，请键入<code class="fe mo mp mq me b">db</code>。</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="1246" class="mi mj in me b gy mk ml l mm mn">db</span></pre><p id="d284" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em> <code class="fe mo mp mq me b">db</code>是保存schema对象的全局变量。</p><p id="b366" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在输入<code class="fe mo mp mq me b">db</code>并按下回车键后，您将看不到任何结果，可能是因为该值尚未赋值！</p><p id="5657" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">键入<code class="fe mo mp mq me b">\use</code>并按下<strong class="jq io">选项卡</strong>按钮以查看您的所有数据库，然后键入您想要的模式:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="7500" class="mi mj in me b gy mk ml l mm mn">\use marveldb</span></pre><p id="ac32" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在这种情况下，我们使用了<strong class="jq io"> marveldb </strong>模式。</p><p id="fa0a" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在再次输入<code class="fe mo mp mq me b">db<br/></code>,这一次你应该会看到如下结果:</p><blockquote class="nr"><p id="63b3" class="ns nt in bd nu nv nw nx ny nz oa kl dk translated"><marveldb/></p></blockquote><p id="e10c" class="pw-post-body-paragraph jn jo in jq b jr ob jt ju jv oc jx jy km od kb kc kn oe kf kg ko of kj kk kl ig bi translated">在这种环境下，您可以使用javascript中的大多数概念，例如，键入以下内容:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="c8aa" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">var</strong> name = 'tony';<br/><strong class="me io">var</strong> fname = 'stark';<br/><strong class="me io">var</strong> movies = ['iron-man 1', 'iron-man 2', 'iron-man 3'];</span><span id="1b5a" class="mi mj in me b gy nn ml l mm mn"><strong class="me io">var</strong> roles = {<br/>  ironman: {<br/>    first_name: name,<br/>    last_name: fname,<br/>    movies: movies<br/>  }<br/>};</span></pre><p id="d190" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">键入<code class="fe mo mp mq me b">roles</code>并检查结果是否与顶部的值一致！</p><p id="6ea9" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi">🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶</p><h2 id="9605" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">6.创建收藏</h2><p id="9225" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated"><code class="fe mo mp mq me b">db</code>对象有几个操作功能:</p><ul class=""><li id="5397" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated"><strong class="jq io"> getCollections() </strong></li><li id="fbb2" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><strong class="jq io"> createCollection() </strong></li><li id="dec9" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">帮助()</li><li id="b41e" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">createCollection()</li><li id="c7a7" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getName()</li><li id="d006" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">dropCollection()</li><li id="13e3" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getSchema()</li><li id="b165" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">existsInDatabase()</li><li id="ae3e" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getSession()</li><li id="790e" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getCollection()</li><li id="829c" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getTable()</li><li id="66ad" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getCollectionAsTable()</li><li id="20f7" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getTables()</li><li id="6083" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">会议</li><li id="cd26" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">(计划或理论的)纲要</li><li id="de71" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">名字</li></ul><p id="d042" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">要创建新集合，请使用下面的函数:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="83de" class="mi mj in me b gy mk ml l mm mn">db.createCollection('role');</span></pre><p id="b9cd" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">在本例中，我们创建了一个集合，名为:"<strong class="jq io"> role </strong> " <br/>要确保集合已创建，请执行以下操作:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="aeea" class="mi mj in me b gy mk ml l mm mn">db.getCollections();</span></pre><p id="2ac2" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">结果将是这样的:</p><blockquote class="nr"><p id="6605" class="ns nt in bd nu nv nw nx ny nz oa kl dk translated">[ <br/> &lt;集合:角色&gt; <br/> ]</p></blockquote><p id="2863" class="pw-post-body-paragraph jn jo in jq b jr ob jt ju jv oc jx jy km od kb kc kn oe kf kg ko of kj kk kl ig bi">🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶</p><h2 id="6fe0" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">7.将文档插入收藏</h2><p id="26bb" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated">每个集合都有几个操作它的函数:</p><ul class=""><li id="e47e" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated"><strong class="jq io">添加()</strong></li><li id="01e1" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><strong class="jq io">查找()</strong></li><li id="5a4a" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">帮助()</li><li id="1641" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">replaceOne()</li><li id="46a2" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">addOrReplaceOne()</li><li id="a741" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getName()</li><li id="8ba1" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><strong class="jq io">修改()</strong></li><li id="1415" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">createIndex()</li><li id="3158" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getOne()</li><li id="4e7c" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">dropIndex()</li><li id="d4dc" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getSchema()</li><li id="131c" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">移除()</li><li id="2cff" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">existsInDatabase()</li><li id="4b89" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">getSession()</li><li id="d477" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">移除一个()</li><li id="b2a3" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">名字</li><li id="5e1f" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">会议</li><li id="4e51" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">(计划或理论的)纲要</li></ul><p id="ebbf" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">首先，让我们创建另一个收藏名称:<strong class="jq io"> person </strong></p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="967a" class="mi mj in me b gy mk ml l mm mn">db.createCollection("person");</span></pre><p id="9ec0" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">这样做可以查看<strong class="jq io">人</strong>的<strong class="jq io">文档</strong>集合:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="ade9" class="mi mj in me b gy mk ml l mm mn">db.person.find();</span></pre><p id="b76f" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">您必须看到一个空的结果，因为其中还没有文档！。</p><p id="3f5e" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">提示:</em> <code class="fe mo mp mq me b">find</code>函数不带args，将显示所有文档。您可以传递一个参数来查找特定的对象模式。</p><p id="9a9c" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">要将文档添加到集合中，可以使用带有JSON/object参数的<code class="fe mo mp mq me b">add</code>函数:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="d703" class="mi mj in me b gy mk ml l mm mn">db.person.add(<br/>  {<br/>    name: "alireza",<br/>    age: 21<br/>  }<br/>);</span></pre><p id="2241" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">将代码粘贴在顶部，然后<strong class="jq io">按Enter </strong>(如果需要，按两次)。</p><p id="272f" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">现在，再次使用<code class="fe mo mp mq me b">find</code>方法查看该集合的文档:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="b4c2" class="mi mj in me b gy mk ml l mm mn">db.person.find();</span></pre><p id="0c7b" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">结果会是这样的:</p><blockquote class="nr"><p id="687a" class="ns nt in bd nu nv nw nx ny nz oa kl dk translated">[<br/>{<br/>" _ id ":" 00005 c38a 59300000000000002 "，<br/>"年龄":21，<br/>"姓名":" alireza" <br/> } <br/> ] <br/>一套1份文件(0.0011秒)</p></blockquote><p id="357d" class="pw-post-body-paragraph jn jo in jq b jr ob jt ju jv oc jx jy km od kb kc kn oe kf kg ko of kj kk kl ig bi translated">现在，让我们通过传递之前声明的对象并使用函数来添加另一个文档:</p><p id="80fa" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">记住我们在“主题5”中声明的变量:</p><blockquote class="jk jl jm"><p id="d589" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated"><strong class="jq io">var</strong>name = ' Tony '；<br/><strong class="jq io">var</strong>fname = ' stark '；<br/> <strong class="jq io"> var </strong>电影= ['钢铁侠1 '，'钢铁侠2 '，'钢铁侠3 ']；</p><p id="9e3a" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated"><strong class="jq io">var</strong>roles = {<br/>iron man:{<br/>first _ name:name，<br/> last_name: fname，<br/>movies:movies<br/>}<br/>}；</p></blockquote><p id="ff81" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">我们来为《钢铁侠》的<strong class="jq io">角色</strong>添加一个文档，不插入完整数据:<br/>(注意我们已经创建了“角色”集合！)</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="ce75" class="mi mj in me b gy mk ml l mm mn">db.role.add({role: "iron man"});</span></pre><p id="a662" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">使用<code class="fe mo mp mq me b">find</code>方法后的结果，会是这样的:</p><blockquote class="nr"><p id="3352" class="ns nt in bd nu nv nw nx ny nz oa kl dk translated">{<br/>" _ id ": " 00005 c38a 59300000000000005 "，<br/>"角色":"钢铁侠"<br/> }</p></blockquote><p id="9504" class="pw-post-body-paragraph jn jo in jq b jr ob jt ju jv oc jx jy km od kb kc kn oe kf kg ko of kj kk kl ig bi translated">现在，让我们使用<strong class="jq io">修改</strong>并完成文档:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="cd8c" class="mi mj in me b gy mk ml l mm mn">db.role.modify("role = 'iron man'").merge(roles.ironman)</span></pre><p id="7b10" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">使用<code class="fe mo mp mq me b">find</code>方法后，结果会是这样的:</p><blockquote class="nr"><p id="6fb5" class="ns nt in bd nu nv nw nx ny nz oa kl dk translated">{<br/>" _ id ": " 00005 c38a 5930000000000005 "，<br/>"名字":"托尼"，<br/>"姓氏":"斯塔克"，<br/>"电影":[ <br/>《钢铁侠1》，<br/>《钢铁侠2》，<br/>《钢铁侠3》<br/>]，<br/></p></blockquote><p id="cf72" class="pw-post-body-paragraph jn jo in jq b jr ob jt ju jv oc jx jy km od kb kc kn oe kf kg ko of kj kk kl ig bi translated"><em class="jp">温馨提示:</em></p><ul class=""><li id="c724" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated"><code class="fe mo mp mq me b">modify</code>函数获取一个字符串模式</li><li id="5c64" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><code class="fe mo mp mq me b">merge</code>功能通过"修改"功能找到一个将要与文档合并的对象</li></ul><p id="d74a" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi">🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶🧶</p><h2 id="70ee" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">8.通过导入JSON文件插入文档</h2><p id="545c" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated">假设我们有一个如下所示的JSON文件:</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="f229" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">使用<code class="fe mo mp mq me b">util</code>模块将JSON导入集合:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="51c7" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">util</strong>.importJson("./roles.json", {collection: "role"});</span></pre><p id="fce4" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">上面的代码将“roles.json”文件导入到“role”集合中。</p><p id="74bd" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><em class="jp">温馨提示:</em></p><ul class=""><li id="b4b2" class="kw kx in jq b jr js jv jw km ky kn kz ko la kl lb lc ld le bi translated">roles.json文件包含<strong class="jq io">两个文档</strong>！(在这种情况下)</li><li id="bf4b" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated">如果该文件不存在，它将引发一个错误！</li><li id="cac5" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><code class="fe mo mp mq me b">importJson</code>函数的<strong class="jq io">第一个</strong>参数是文件的<strong class="jq io">路径</strong>。</li><li id="4e4d" class="kw kx in jq b jr lf jv lg km lh kn li ko lj kl lb lc ld le bi translated"><code class="fe mo mp mq me b">importJson</code>函数的<strong class="jq io">第二个</strong>参数是<strong class="jq io">选项对象</strong></li></ul></div><div class="ab cl kp kq hr kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ig ih ii ij ik"><p id="3750" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">Python Shell API与JS Shell API非常相似，不同之处在于<strong class="jq io"> JS </strong>中的函数是<strong class="jq io"> Camel Case </strong>，而<strong class="jq io"> Python </strong>中的函数由一个<strong class="jq io">下划线</strong> ( <code class="fe mo mp mq me b">_</code>)隔开</p><p id="7223" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">例如:</p><p id="0c94" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><strong class="jq io"> JS: </strong></p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="6506" class="mi mj in me b gy mk ml l mm mn">db.getCollections();</span></pre><p id="e838" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated"><strong class="jq io"> PYTHON: </strong></p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="b348" class="mi mj in me b gy mk ml l mm mn">db.get_collections()</span></pre><h2 id="940a" class="mi mj in bd mr ms mt dn mu mv mw dp mx km my mz na kn nb nc nd ko ne nf ng nh bi translated">最后一句话:</h2><p id="2c29" class="pw-post-body-paragraph jn jo in jq b jr ni jt ju jv nj jx jy km nk kb kc kn nl kf kg ko nm kj kk kl ig bi translated">要获得帮助，有关文档，请参考MySQL <a class="ae mc" href="https://dev.mysql.com/doc/refman/8.0/en/mysql-shell-tutorial-javascript.html" rel="noopener ugc nofollow" target="_blank">网站</a>或使用每个对象的<code class="fe mo mp mq me b">help()</code>函数。</p><p id="05aa" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy km ka kb kc kn ke kf kg ko ki kj kk kl ig bi translated">例如:</p><pre class="ll lm ln lo gt md me mf mg aw mh bi"><span id="a09e" class="mi mj in me b gy mk ml l mm mn"><strong class="me io">db</strong>.help();</span><span id="264b" class="mi mj in me b gy nn ml l mm mn"><strong class="me io">util</strong>.help("importJson");</span><span id="1f5e" class="mi mj in me b gy nn ml l mm mn">// db.&lt;collection_name&gt;.help([&lt;function_name&gt;]);<br/><strong class="me io">db</strong>.role.help("modify");</span></pre></div></div>    
</body>
</html>