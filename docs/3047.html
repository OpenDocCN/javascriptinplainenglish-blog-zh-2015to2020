<html>
<head>
<title>Event Delegation in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的事件委托</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/event-delegation-in-javascript-ef3b87f538e?source=collection_archive---------6-----------------------#2020-08-23">https://javascript.plainenglish.io/event-delegation-in-javascript-ef3b87f538e?source=collection_archive---------6-----------------------#2020-08-23</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div class="gi gj jo"><img src="../Images/d7087d088801b3f5e76697ea2ff0947f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*J8EA2Zmj7p8Yu6ZaOXoPMQ.jpeg"/></div><figcaption class="jv jw gk gi gj jx jy bd b be z dk">Image: <a class="ae jz" href="https://pixabay.com/photos/soap-bubbles-colorful-flying-3517247/" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="4f71" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">利用事件冒泡来提高性能并简化代码。</p><p id="f1c0" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">向页面添加大量事件处理程序会对性能产生不利影响。缓解这一问题的一种常见技术是事件委托，在这种技术中，我们将单个事件处理程序添加到层次结构中某处的父元素中。这是由于通过DOM的事件流，我在我的<a class="ae jz" href="https://medium.com/javascript-in-plain-english/interactive-periodic-table-in-javascript-d7cf7177883a" rel="noopener">交互周期表</a>中很好地使用了这种技术。在这篇文章中，我将使用周期表的简化版本来演示事件委托。</p><p id="92cc" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">下面的屏幕截图显示了简化的元素周期表和当用户点击其中一个元素时显示的警告。</p><figure class="kz la lb lc gu js gi gj paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gi gj ky"><img src="../Images/5bdae3b104ef5676cc84aab869bdc893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wX9Wfhq7pN1Et5i3oAymBg.png"/></div></div></figure><p id="90bc" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">整个onclick/alert看起来是非常简单的JavaScript，但是请注意，这里有118个化学元素，每个都急切地等待有人点击它们。通过遍历数据来填充该表，为每一项添加一个<code class="fe lh li lj lk b">&lt;td&gt;</code>元素。在这个循环中，我们可以为每个<code class="fe lh li lj lk b">&lt;td&gt;</code>添加一个<code class="fe lh li lj lk b">onclick</code>处理程序，但是这既会增加填充表格的时间，也会占用更多的内存。</p><p id="7880" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">代码实际上是如何工作的，只需向<code class="fe lh li lj lk b">&lt;table&gt;</code>元素添加一个点击事件处理程序，并允许它的各种<code class="fe lh li lj lk b">&lt;td&gt;</code>元素的点击事件冒泡DOM，这是一个更有效的解决方案。事件实际上通过<code class="fe lh li lj lk b">&lt;html&gt;</code>元素一路冒泡到文档本身，因此如果需要，您可以在整个页面级别使用事件委托。</p><p id="b0aa" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">您可以从<a class="ae jz" href="https://github.com/CodeDrome/event-delegation-javascript" rel="noopener ugc nofollow" target="_blank"> Github资源库获得该项目的源代码。</a></p><p id="1c4a" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">我不会列出整个代码，只列出<strong class="kc is">periodictabledisplay . js</strong>文件中与事件委托相关的部分。这个文件包含一个名为<code class="fe lh li lj lk b">PeriodicTableDisplay</code>的类，它的构造函数包含这样一行:</p><figure class="kz la lb lc gu js"><div class="bz fq l di"><div class="ll lm l"/></div></figure><p id="6b52" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">请注意，事件处理函数只添加到表中一次，而不是添加到单个的<code class="fe lh li lj lk b">&lt;td&gt;</code>元素中。这是事件委托模式的核心。</p><p id="b06e" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">现在让我们看看<code class="fe lh li lj lk b">_elementClicked</code>事件处理函数。</p><figure class="kz la lb lc gu js"><div class="bz fq l di"><div class="ll lm l"/></div></figure><p id="8574" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">传递给事件处理程序的事件对象有一个名为<code class="fe lh li lj lk b">target</code>的属性，这是实际被点击的元素，所以我们需要弄清楚用户是点击了一个实际的化学元素还是可以忽略的表格的其他部分。我们通过检查名为<code class="fe lh li lj lk b">elementcell</code>的CSS类的目标来做到这一点。我们还有额外的复杂性，每个<code class="fe lh li lj lk b">&lt;td&gt;</code>包含一个<code class="fe lh li lj lk b">&lt;span&gt;</code>来显示化学符号，可以点击其中的任何一个。如果用户点击了一个元素，它的父元素有CSS类<code class="fe lh li lj lk b">elementcell</code>，那么它就是一个<code class="fe lh li lj lk b">span</code>并且<code class="fe lh li lj lk b">target</code>被重新分配给它的父元素。</p><p id="25af" class="pw-post-body-paragraph ka kb ir kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ik bi translated">这是与事件委托相关的代码的结尾，但为了完整起见，如果用户单击一个实际的化学元素，我们会获取它的原子序数，汇集一串细节，并显示为一个警告。为此，我使用了数据属性，这里讨论的是使用HTML5数据属性和JavaScript 。</p><h2 id="63aa" class="ln lo ir bd lp lq lr dn ls lt lu dp lv kl lw lx ly kp lz ma mb kt mc md me mf bi translated">结论</h2><p id="b74a" class="pw-post-body-paragraph ka kb ir kc b kd mg kf kg kh mh kj kk kl mi kn ko kp mj kr ks kt mk kv kw kx ik bi translated">正如您所看到的，事件委托很容易实现。如果您发现自己为某个特定类型的事件添加了大量的处理程序，那么可以这样做:</p><ul class=""><li id="cf69" class="ml mm ir kc b kd ke kh ki kl mn kp mo kt mp kx mq mr ms mt bi translated">向引发事件的元素的父元素添加一个事件处理程序</li><li id="e7e5" class="ml mm ir kc b kd mu kh mv kl mw kp mx kt my kx mq mr ms mt bi translated">在处理函数中，标识通过事件的目标属性引发事件的实际元素。您可能需要查看它的<code class="fe lh li lj lk b">id</code>、<code class="fe lh li lj lk b">class</code>或<code class="fe lh li lj lk b">data- attributes</code>，并且可能使用一个<code class="fe lh li lj lk b">if/else</code>或<code class="fe lh li lj lk b">switch/case</code>构造。</li></ul><h2 id="26eb" class="ln lo ir bd lp lq lr dn ls lt lu dp lv kl lw lx ly kp lz ma mb kt mc md me mf bi translated"><strong class="ak">用简单英语写的JavaScript</strong></h2><p id="3c94" class="pw-post-body-paragraph ka kb ir kc b kd mg kf kg kh mh kj kk kl mi kn ko kp mj kr ks kt mk kv kw kx ik bi translated">你知道我们有三份出版物和一个YouTube频道吗？在<a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc is">plain English . io</strong></a>找到所有内容的链接！</p></div></div>    
</body>
</html>