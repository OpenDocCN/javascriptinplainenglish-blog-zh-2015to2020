<html>
<head>
<title>An Introduction to Geocoding Using Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js进行地理编码简介</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/an-introduction-to-geocoding-using-node-js-fe1a5d3aa05c?source=collection_archive---------0-----------------------#2020-02-28">https://javascript.plainenglish.io/an-introduction-to-geocoding-using-node-js-fe1a5d3aa05c?source=collection_archive---------0-----------------------#2020-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="c9ec" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">地理编码入门</h2><div class=""/><div class=""><h2 id="1ee4" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">地理信息的服务器端访问</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b9eb1b949ed5c4eba6126ba1f6899f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R5iVs1FRt4h-Lpfm"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@amyjoyhumphries?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Amy Humphries</a> on <a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0eeb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated"><span class="l mc md me bm mf mg mh mi mj di">在</span>这篇文章中，我想让我们使用node.js在服务器端探索一下<strong class="lh ja">地理编码</strong></p><p id="f78a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<a class="ae le" href="https://medium.com/javascript-in-plain-english/introduction-to-javascripts-geolocation-api-b01ca61e47f8" rel="noopener">之前的一篇文章</a>中，我们使用<a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API" rel="noopener ugc nofollow" target="_blank"> JavaScript的地理定位API </a>研究了客户端地理编码。</p><blockquote class="mk"><p id="ff81" class="ml mm iq bd mn mo mp mq mr ms mt ma dk translated">有趣的是，在这篇文章中，你可以用你自己的位置做到这一点。</p></blockquote><h1 id="1076" class="mu mv iq bd mw mx my mz na nb nc nd ne kf nf kg ng ki nh kj ni kl nj km nk nl bi translated">什么是地理编码？</h1><blockquote class="nm nn no"><p id="f5e7" class="lf lg np lh b li lj ka lk ll lm kd ln nq lp lq lr nr lt lu lv ns lx ly lz ma ij bi translated"><strong class="lh ja">地理编码</strong>是获取输入文本的过程，例如一个<a class="ae le" href="https://en.wikipedia.org/wiki/Address_(geography)" rel="noopener ugc nofollow" target="_blank">地址</a>或一个<a class="ae le" href="https://en.wikipedia.org/wiki/Location_(geography)" rel="noopener ugc nofollow" target="_blank">地点的名称</a>，并返回该地点在地球表面上的纬度/经度位置。</p></blockquote><p id="2506" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">换句话说，我们输入一个地址，然后得到经度、纬度、国家等信息。我们的<em class="np">地理编码提供商</em>将提供尽可能多的信息。</p><p id="6626" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一些地理编码提供商包括，</p><ul class=""><li id="55ee" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma ny nz oa ob bi translated">谷歌地图</li><li id="a87a" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma ny nz oa ob bi translated">Mapquest</li><li id="d082" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma ny nz oa ob bi translated">这里的地图(可以说是最全面的。)</li><li id="b26e" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma ny nz oa ob bi translated">OpenStreetMap</li></ul><p id="e4d5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将像在客户端文章中一样使用<strong class="lh ja"> OpenStreetMap </strong>，因为它免费且易于配置。</p></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><p id="ea6d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">与客户端不同，在客户端，我们能够检索经度、纬度和可视地图，在服务器端，它将是信息性的。这并不是一件坏事，因为一旦我们有了信息，我们就可以随心所欲地使用它。将其传递给客户端API，将信息存储在数据库中，任何我们想要的东西。</p></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><h1 id="205b" class="mu mv iq bd mw mx oo mz na nb op nd ne kf oq kg ng ki or kj ni kl os km nk nl bi translated">我们开始吧</h1><h2 id="1d79" class="ot mv iq bd mw ou ov dn na ow ox dp ne lo oy oz ng ls pa pb ni lw pc pd nk iw bi translated">设置</h2><p id="c4aa" class="pw-post-body-paragraph lf lg iq lh b li pe ka lk ll pf kd ln lo pg lq lr ls ph lu lv lw pi ly lz ma ij bi translated">你需要安装<a class="ae le" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> node.js </a>。我也将使用<a class="ae le" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a> (VSCode)作为我的IDE。</p><ol class=""><li id="4084" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma pj nz oa ob bi translated">创建一个要在其中工作的文件夹，并在VSCode中打开它。</li><li id="3188" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma pj nz oa ob bi translated">打开一个终端窗口并创建一个package.json，它会将index.js设置为我们的默认JavaScript文件，通过键入，</li></ol><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="5ab4" class="ot mv iq pl b gy pp pq l pr ps">npm init -y</span></pre><p id="2219" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">3.我们将安装npm包，这将使我们的地理编码成为可能。在终端窗口类型中，</p><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="3318" class="ot mv iq pl b gy pp pq l pr ps">npm install node-geocoder</span></pre><h2 id="07f5" class="ot mv iq bd mw ou ov dn na ow ox dp ne lo oy oz ng ls pa pb ni lw pc pd nk iw bi translated">代码</h2><p id="026b" class="pw-post-body-paragraph lf lg iq lh b li pe ka lk ll pf kd ln lo pg lq lr ls ph lu lv lw pi ly lz ma ij bi translated">创建一个名为<strong class="lh ja"> index.js </strong>的文件。首先，我们将通过键入以下命令来导入npm包，</p><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="664e" class="ot mv iq pl b gy pp pq l pr ps">let nodeGeocoder = require('node-geocoder');</span></pre><p id="0f35" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，我们将在选项对象参数中指定地理编码提供程序。我们的提供商是<a class="ae le" href="https://wiki.openstreetmap.org/wiki/About_OpenStreetMap" rel="noopener ugc nofollow" target="_blank"> OpenStreetMap </a>。我们只需要提供名称“openetreetmap”。对于其他提供者，您需要提供API密钥或其他参数。<em class="np">你必须查看该供应商的文件。</em></p><p id="4fd9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，我们将设置我们的选项，并将它们传递给nodeGeocoder的一个实例。</p><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="b1d8" class="ot mv iq pl b gy pp pq l pr ps">let options = {<br/>  provider: 'openstreetmap'<br/>};<br/> <br/>let geoCoder = nodeGeocoder(options);</span></pre><p id="c7ee" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后一步是调用我们的geoCoder对象的<strong class="lh ja"> geocode() </strong>方法，为它提供一个地址。</p><p id="2f70" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">键入您喜欢的任何地址。我将进入<em class="np">卢瑞洞穴</em>。</p><p id="11ec" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">geocode()方法的调用将返回一个<strong class="lh ja">承诺</strong>，因此我们将使用<em class="np">。然后是</em>和<em class="np">。捕捉</em>以处理结果或错误。</p><p id="4ed4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">输入以下内容，</p><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="87a1" class="ot mv iq pl b gy pp pq l pr ps"><strong class="pl ja">geoCoder.geocode('Luray Caverns')</strong><br/>  .then((res)=&gt; {<br/>    console.log(res);<br/>  })<br/>  .catch((err)=&gt; {<br/>    console.log(err);<br/>  });</span></pre><p id="8924" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可能想试验一下你需要提供多少信息。在这里，我没有告诉它美国或弗吉尼亚州！如果我只提供Luray，我会得到“猜测”。</p><blockquote class="mk"><p id="69b7" class="ml mm iq bd mn mo mp mq mr ms mt ma dk translated">试试自己的地址！</p></blockquote><p id="ed98" class="pw-post-body-paragraph lf lg iq lh b li pt ka lk ll pu kd ln lo pv lq lr ls pw lu lv lw px ly lz ma ij bi translated">如果您使用<strong class="lh ja"> F5 </strong>在调试模式下运行，您将看到它返回一个包含对象的数组。如果使用<strong class="lh ja"> CTRL-F5 </strong>，就会看到数据。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi py"><img src="../Images/2e99871c7fe1b86ce656693b7bca8080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tL2PdXKaY91pdsvXkzXuIw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Result using CTRL-F5</figcaption></figure><p id="d927" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">多酷啊！查看信息详细信息。</p><p id="5a64" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是完整的代码。</p><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="2db4" class="ot mv iq pl b gy pp pq l pr ps">let nodeGeocoder = require('node-geocoder');<br/> <br/>let options = {<br/>  provider: 'openstreetmap'<br/>};<br/> <br/>let geoCoder = nodeGeocoder(options);</span><span id="cd31" class="ot mv iq pl b gy pz pq l pr ps"><strong class="pl ja">geoCoder.geocode('Luray Caverns')</strong><br/>  .then((res)=&gt; {<br/>    console.log(res);<br/>  })<br/>  .catch((err)=&gt; {<br/>    console.log(err);<br/>  });</span></pre><h1 id="2ac3" class="mu mv iq bd mw mx my mz na nb nc nd ne kf qa kg ng ki qb kj ni kl qc km nk nl bi translated">反向地理定位</h1><blockquote class="nm nn no"><p id="8a0e" class="lf lg np lh b li lj ka lk ll lm kd ln nq lp lq lr nr lt lu lv ns lx ly lz ma ij bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Reverse_geocoding" rel="noopener ugc nofollow" target="_blank">另一方面，反向地理编码</a>将<a class="ae le" href="https://en.wikipedia.org/wiki/Geographic_coordinates" rel="noopener ugc nofollow" target="_blank">地理坐标</a>转换成一个位置的描述，通常是一个地点或可寻址位置的名称。地理编码依赖于地址点、街道/道路网络以及邮政和行政边界的计算机表示。</p></blockquote><p id="90c4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">节点地理编码器npm包也可以执行<strong class="lh ja">反向地理定位</strong>。我们调用geoCoder对象的<strong class="lh ja"> reverse() </strong>方法。这也返回一个承诺，因此处理方式与前面的示例相同。</p><p id="873f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这里，我将提供Luray洞穴的<strong class="lh ja">纬度</strong>和<strong class="lh ja">经度</strong>，它将返回在地球上该位置找到的内容。</p><p id="4d65" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是一个完整的例子，</p><pre class="kp kq kr ks gt pk pl pm pn aw po bi"><span id="987b" class="ot mv iq pl b gy pp pq l pr ps">let nodeGeocoder = require('node-geocoder');<br/> <br/>let options = {<br/>  provider: 'openstreetmap'<br/>};<br/> <br/>let geoCoder = nodeGeocoder(options);</span><span id="1d4f" class="ot mv iq pl b gy pz pq l pr ps">// Reverse Geocode<br/> <strong class="pl ja"> geoCoder.reverse({lat:38.66, lon:-78.43})</strong><br/>  .then((res)=&gt; {<br/>    console.log(res);<br/>  })<br/>  .catch((err)=&gt; {<br/>    console.log(err);<br/>  });</span></pre><p id="d47c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如你所见，它返回了弗吉尼亚的卢雷洞穴。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/971c1e7d7c369fa79ce7ca0356b11e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*dn77GaH1I-3Cc22b_JHnqQ.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">CTRL+F5</figcaption></figure><h1 id="6f87" class="mu mv iq bd mw mx my mz na nb nc nd ne kf qa kg ng ki qb kj ni kl qc km nk nl bi translated">结论</h1><p id="2d18" class="pw-post-body-paragraph lf lg iq lh b li pe ka lk ll pf kd ln lo pg lq lr ls ph lu lv lw pi ly lz ma ij bi translated">我们现在有了一个用于执行地理编码和反向地理编码的服务器端工具。这一点的应用取决于您的用例。</p><p id="a1b3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">信息的准确性将取决于您使用的提供商。</p><p id="140f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我也鼓励你阅读下面的客户端Gelocation API并编写代码。在这里，我们可以找到我们网站的位置，并获得经度和纬度，但是也可以打开一张地图，显示他们从哪里访问我们的网站。在那篇文章中，我还使用了OpenStreetMap。</p><p id="8e5c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">感谢您的阅读和快乐编码！</strong></p><p id="7c48" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="np">在Medium上阅读所有你想要的文章，并通过成为Medium会员来帮助我继续写作，每月只需5美元。</em></p><div class="qe qf gp gr qg qh"><a href="https://bobtomlin-70659.medium.com/membership" rel="noopener follow" target="_blank"><div class="qi ab fo"><div class="qj ab qk cl cj ql"><h2 class="bd ja gy z fp qm fr fs qn fu fw iz bi translated">通过我的推荐链接加入灵媒——重力井(罗伯·汤姆林)</h2><div class="qo l"><h3 class="bd b gy z fp qm fr fs qn fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="qp l"><p class="bd b dl z fp qm fr fs qn fu fw dk translated">bobtomlin-70659.medium.com</p></div></div><div class="qq l"><div class="qr l qs qt qu qq qv ky qh"/></div></div></a></div><div class="qe qf gp gr qg qh"><a href="https://medium.com/javascript-in-plain-english/introduction-to-javascripts-geolocation-api-b01ca61e47f8" rel="noopener follow" target="_blank"><div class="qi ab fo"><div class="qj ab qk cl cj ql"><h2 class="bd ja gy z fp qm fr fs qn fu fw iz bi translated">JavaScript地理定位API简介</h2><div class="qo l"><h3 class="bd b gy z fp qm fr fs qn fu fw dk translated">JavaScript的地理定位API是什么以及如何使用它</h3></div><div class="qp l"><p class="bd b dl z fp qm fr fs qn fu fw dk translated">medium.com</p></div></div><div class="qq l"><div class="qw l qs qt qu qq qv ky qh"/></div></div></a></div></div></div>    
</body>
</html>