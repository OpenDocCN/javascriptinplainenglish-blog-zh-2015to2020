<html>
<head>
<title>Angular: Build reactive forms using Formbuilder</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度:使用Formbuilder构建反应式表单</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/angular-build-reactive-forms-using-formbuilder-e86a4a2c1381?source=collection_archive---------0-----------------------#2020-05-13">https://javascript.plainenglish.io/angular-build-reactive-forms-using-formbuilder-e86a4a2c1381?source=collection_archive---------0-----------------------#2020-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e0b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表单是web应用程序非常重要的一部分。有时我们会遇到表单元素是静态且定义良好的场景。有时候，web应用程序开发超越了静态表单，进入了动态表单。动态表单没有静态字段。动态窗体和控件可以基于某些事件生成。在这篇文章中，我们将建立一个反应形式使用角度反应的方法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/bb165a956b0100aa6d984b19ef07044e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ej4Mjnq1L_6UGJrg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">chuttersnap</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="df06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Angular支持两种动态控制设计。</p><ul class=""><li id="8207" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir">模板驱动- </strong>在模板驱动的表单中对有角度的模板有更多的控制。双向绑定。容易实现。</li><li id="07e4" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><strong class="jp ir">反应形式- </strong>非常强大，大部分控制都在组件中。需要Formbuilder来构建表单。在这篇文章中，我们将使用反应形式的方法。</li></ul><h1 id="8efa" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">为什么是反应式？</h1><p id="1ea2" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">反应式表单是创建动态表单的一种更灵活的方式。创建模板和反应式表单后，我发现创建反应式表单有以下好处:</p><ul class=""><li id="793d" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">非常灵活，将创建绑定、错误处理等所有控制权交给开发人员。这导致组件中的代码比模板中的代码多。没有绑定，所以数据模型不可变。</li><li id="0488" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">非常容易写单元测试。因为大部分代码都在组件中，所以编写单元测试非常容易。</li><li id="72cc" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">与模板驱动方法相比，反应式表单更加复杂。但是一旦开发者习惯了，玩反应式表单就非常容易了。</li></ul><h1 id="537c" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">建筑电抗组件</h1><p id="8ec1" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">我们正在构建一个产品反应组件。产品有产品名称和产品代码。该产品还有另一个可选参数，即产品特性。产品功能包含功能名称、功能添加日期和功能描述。<strong class="jp ir"> <em class="mt">可以动态添加功能。我们要添加的功能数量没有限制。屏幕看起来会像这样。</em>T9】</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mu"><img src="../Images/ae11db8d349d5bc9211a0015a2aea42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zjW0ier14j20EnFqGNot9Q.png"/></div></div></figure><p id="fd2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们正在创建一个反应式子组件产品功能。我们在父组件和子组件之间使用双向数据绑定。<code class="fe mv mw mx my b">productField</code>是双向绑定。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="907f" class="nd lr iq my b gy ne nf l ng nh">&lt;app-product-feature [(productField)]=”productField”&gt;&lt;/app-product-feature&gt;</span></pre><p id="60fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在添加反应式表单模块的应用内模块文件。反应式模块将能够设计反应式组件。完整的<code class="fe mv mw mx my b">app.module.ts</code>将类似于下面的代码。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="8bc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建产品子组件。产品子组件包含模板、CSS和组件文件。检查最后附件中的GitHub代码。从<code class="fe mv mw mx my b">@angular/forms</code>导入<code class="fe mv mw mx my b">FormBuilder</code>、<code class="fe mv mw mx my b">Validators</code>和<code class="fe mv mw mx my b">FormArray</code>。<code class="fe mv mw mx my b">FormBuilder</code>需要设计产品形态模型。<code class="fe mv mw mx my b">Validators</code>是控件输入验证所必需的。<code class="fe mv mw mx my b">FormArray</code>是构建动态表单功能所必需的。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="1122" class="nd lr iq my b gy ne nf l ng nh">import { FormBuilder,Validators,FormArray } from ‘@angular/forms’;</span></pre><p id="79f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将<code class="fe mv mw mx my b">productField</code>定义为输入属性。因为我们有与子组件的双向绑定，所以将<code class="fe mv mw mx my b">productFieldChange</code>定义为输出装饰器属性。在构造函数中注入<code class="fe mv mw mx my b">FormBuilder</code>作为<code class="fe mv mw mx my b">fb</code>。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="baa6" class="nd lr iq my b gy ne nf l ng nh">@Input() productField: Product&lt;productFeatures&gt;; <br/>@Output() productFieldChange = new EventEmitter&lt;any&gt;();</span><span id="344d" class="nd lr iq my b gy nk nf l ng nh">constructor(private fb: FormBuilder) { }</span></pre><p id="a6f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">定义产品特性产品名称和代码。产品名称为必填字段。作为表单数组的产品特征。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="caa4" class="nd lr iq my b gy ne nf l ng nh">productFeatureForm = this.fb.group({ <br/>productName: [‘’, Validators.required], <br/>productCode: [‘’], <br/>productFeatures: new FormArray([]) });</span></pre><p id="e8b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为简单起见，定义两个get属性。获取<code class="fe mv mw mx my b">f()</code>和获取<code class="fe mv mw mx my b">p()</code>。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="9c04" class="nd lr iq my b gy ne nf l ng nh">get f() { return this.productFeatureForm.controls; }</span><span id="1ac6" class="nd lr iq my b gy nk nf l ng nh">get p() { return this.f.productFeatures as FormArray; }</span></pre><p id="a869" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当组件初始化时，在窗体数组中添加一个默认功能。单击“添加”按钮时，我们将在产品功能中添加相同的对象。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="396e" class="nd lr iq my b gy ne nf l ng nh">ngOnInit() {</span><span id="2c7c" class="nd lr iq my b gy nk nf l ng nh">this.p.push(this.fb.group(</span><span id="5de0" class="nd lr iq my b gy nk nf l ng nh">{ featureName: [‘’],</span><span id="2472" class="nd lr iq my b gy nk nf l ng nh">featureAddedDate: [‘’],</span><span id="8c27" class="nd lr iq my b gy nk nf l ng nh">featureDescription: [‘’]</span><span id="0bc6" class="nd lr iq my b gy nk nf l ng nh">})); }</span></pre><p id="ec5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的组件文件如下所示。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="f4f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在产品组件功能HTML中添加表单组属性。将产品名称定义为必填字段。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="36f8" class="nd lr iq my b gy ne nf l ng nh">&lt;form *ngIf=”productFeatureForm” [formGroup]=”productFeatureForm”&gt;</span><span id="de9f" class="nd lr iq my b gy nk nf l ng nh">&lt;div class="row required-field"&gt;</span><span id="c811" class="nd lr iq my b gy nk nf l ng nh">&lt;div class="col-md-4"&gt;</span><span id="4659" class="nd lr iq my b gy nk nf l ng nh">&lt;label class="cus-form-label"&gt;Product Name&lt;/label&gt;</span><span id="3162" class="nd lr iq my b gy nk nf l ng nh">&lt;input class="form-control minimal" id="productName" formControlName="productName" required&gt;</span><span id="0d7c" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span><span id="6f59" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span><span id="93e8" class="nd lr iq my b gy nk nf l ng nh">&lt;/form&gt;</span></pre><p id="f85a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为产品特性在产品内部是一个表单数组。迭代产品特性以显示多个特性。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="c27a" class="nd lr iq my b gy ne nf l ng nh">&lt;div *ngFor="let prod of p.controls; let i = index" class="list-group list-group-flush"&gt;</span><span id="067b" class="nd lr iq my b gy nk nf l ng nh">&lt;div class="list-group-item"&gt;</span><span id="58e0" class="nd lr iq my b gy nk nf l ng nh">&lt;h5 class="card-title"&gt;Product Feature {{i + 1}}&lt;/h5&gt;</span><span id="14da" class="nd lr iq my b gy nk nf l ng nh">&lt;div [formGroup]="prod" &gt;</span><span id="8561" class="nd lr iq my b gy nk nf l ng nh">&lt;div class="row required-field"&gt;</span><span id="59b5" class="nd lr iq my b gy nk nf l ng nh">&lt;div class="col-md-4"&gt;</span><span id="c71f" class="nd lr iq my b gy nk nf l ng nh">&lt;label class="cus-form-label"&gt;Feature Name&lt;/label&gt;</span><span id="4bbc" class="nd lr iq my b gy nk nf l ng nh">&lt;input class="form-control minimal" id="{{'name' + i}}" formControlName="featureName"&gt;</span><span id="84b8" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span><span id="e241" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span><span id="ab3f" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span><span id="4bed" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span><span id="26a2" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span></pre><p id="d733" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的HTML文件如下所示。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="2af4" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">确认</h1><p id="b52e" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">用于验证必填的必填字段是isError属性。提交表单或添加新功能后，将isError设置为true。有关更多详细信息，请查看以下代码块。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="140f" class="nd lr iq my b gy ne nf l ng nh">&lt;div *ngIf=”isError &amp;&amp; f.productName.errors” class=”invalid-feedback”&gt;</span><span id="fedb" class="nd lr iq my b gy nk nf l ng nh">&lt;div *ngIf=”f.productName.errors.required”&gt;Product name is required field&lt;/div&gt;</span><span id="ad46" class="nd lr iq my b gy nk nf l ng nh">&lt;/div&gt;</span></pre><h1 id="f967" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">添加和删除产品功能</h1><p id="557e" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">添加新功能时，请在产品表单对象中添加功能对象。添加完成后，向父组件发出更改。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="b5f6" class="nd lr iq my b gy ne nf l ng nh">addNewProdField(index: number): void {</span><span id="1803" class="nd lr iq my b gy nk nf l ng nh">this.p.push(this.fb.group({</span><span id="1e0e" class="nd lr iq my b gy nk nf l ng nh">featureName: [‘’],</span><span id="2b66" class="nd lr iq my b gy nk nf l ng nh">featureAddedDate: [‘’],</span><span id="c32d" class="nd lr iq my b gy nk nf l ng nh">featureDescription: [‘’]</span><span id="b0e3" class="nd lr iq my b gy nk nf l ng nh">}));</span><span id="ad51" class="nd lr iq my b gy nk nf l ng nh">this.productFieldChange.emit(this.productFeatureForm.value);</span><span id="ea03" class="nd lr iq my b gy nk nf l ng nh">}</span></pre><p id="63d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据索引移除产品。删除完成后，将更改发送到父组件。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="38ac" class="nd lr iq my b gy ne nf l ng nh">removeNewProdField(index: number): void {</span><span id="5c79" class="nd lr iq my b gy nk nf l ng nh">this.p.removeAt(index);</span><span id="94a1" class="nd lr iq my b gy nk nf l ng nh">this.productFieldChange.emit(this.productFeatureForm.value);</span><span id="96f0" class="nd lr iq my b gy nk nf l ng nh">}</span></pre><p id="5585" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哇，现在我们可以添加和删除产品功能了。添加删除将通知父组件。</p><p id="12e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在父组件中，将代码放在下面以检查子组件的属性更改。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="7210" class="nd lr iq my b gy ne nf l ng nh">&lt;h5&gt;Parent component&lt;/h5&gt;</span><span id="0a70" class="nd lr iq my b gy nk nf l ng nh">&lt;pre&gt;{{productField | json}}&lt;/pre&gt;</span></pre><p id="45a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以从子组件中看到JSON对象。</p><pre class="km kn ko kp gt mz my na nb aw nc bi"><span id="28ae" class="nd lr iq my b gy ne nf l ng nh">{<br/> “productName”: “Netgear”,<br/> “productCode”: “NG001”,<br/> “productFeatures”: [<br/> {<br/> “featureName”: “Wireless”,<br/> “featureAddedDate”: “05/12/2020”,<br/> “featureDescription”: “to connect wireless”<br/> }<br/> ]<br/>}</span></pre><h1 id="8e56" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">摘要</h1><p id="148b" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">在本文中，我们使用form builder创建了一个反应式表单。我们还经历了一个动态产品特性组件。特征组件可以动态添加、删除。添加GitHub链接，提供下载和更大的学习灵活性。</p><div class="nl nm gp gr nn no"><a href="https://github.com/codingindepth/angular-dynamic-reactive-forms" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">深度/角度-动态-反应-形式</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">此项目是使用Angular CLI版本8.3.21生成的。为开发服务器运行ng serve。导航到…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kv no"/></div></div></a></div><h2 id="b5ab" class="nd lr iq bd ls od oe dn lw of og dp ma jy oh oi me kc oj ok mi kg ol om mm on bi translated">进一步阅读</h2><div class="nl nm gp gr nn no"><a rel="noopener  ugc nofollow" target="_blank" href="/create-a-multi-page-job-application-form-using-angular-f0b1640f4195"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">使用Angular创建多页工作申请表</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">一步一步的教程，以建立一个多页的工作申请表使用Angular和SurveyJS，一个免费的，开源的…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nx l"><div class="oo l nz oa ob nx oc kv no"/></div></div></a></div></div></div>    
</body>
</html>