<html>
<head>
<title>Lighting up the Shadow DOM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">点亮阴影世界</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/understanding-the-shadow-dom-8495860b39bf?source=collection_archive---------1-----------------------#2019-09-25">https://javascript.plainenglish.io/understanding-the-shadow-dom-8495860b39bf?source=collection_archive---------1-----------------------#2019-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi ju"><img src="../Images/0d2e3cf48fc103a09e79a2c239c25e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*U4xMIwdCzQYgfdBPxZxyyg.png"/></div><figcaption class="kc kd gj gh gi ke kf bd b be z dk">I’m DOM, Shadow DOM</figcaption></figure><p id="5838" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">这是对<strong class="ki ir">什么是</strong>阴影DOM和<strong class="ki ir">如何</strong>、<strong class="ki ir">何时</strong>以及<strong class="ki ir">为什么</strong>要使用阴影DOM的基本介绍。</p><h1 id="1eb5" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">什么是暗影DOM？</h1><p id="0c7d" class="pw-post-body-paragraph kg kh iq ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld ij bi translated">简单地说，这是一个DOM中的DOM。</p><p id="3e3f" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">使用Shadow Dom，您可以附加一个单独的Dom树，它被隐藏并封装到任何元素中。这对于在web组件中实现封装非常有帮助。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/a36d7004d479aa33119fb06e04fbb6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vb3-5n48rHq55qQzAN67qA.png"/></div></div></figure></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="d0bb" class="le lf iq bd lg lh mm lj lk ll mn ln lo lp mo lr ls lt mp lv lw lx mq lz ma mb bi translated"><strong class="ak">如何使用阴影DOM </strong></h1><p id="7035" class="pw-post-body-paragraph kg kh iq ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld ij bi translated">Shadow root:附加到DOM元素的影像树的根节点。</p><h1 id="da4d" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">创建一个影子根:</h1><blockquote class="mr ms mt"><p id="97e4" class="kg kh mu ki b kj kk kl km kn ko kp kq mv ks kt ku mw kw kx ky mx la lb lc ld ij bi translated"><strong class="ki ir">在自定义组件的构造函数中添加阴影——最常见的用例</strong></p></blockquote><p id="a8c8" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">当一个定制组件被封装和抽象时，它将工作得最好。Shadow DOM有助于实现这一目标。我们一会儿会调查的。</p><pre class="jv jw jx jy gt my mz na nb aw nc bi"><span id="d2d3" class="nd lf iq mz b gy ne nf l ng nh">var shadow = this.attachShadow({mode: 'open'});</span></pre><blockquote class="mr ms mt"><p id="dc8d" class="kg kh mu ki b kj kk kl km kn ko kp kq mv ks kt ku mw kw kx ky mx la lb lc ld ij bi translated"><strong class="ki ir">将阴影dom附加到DOM树中的元素上</strong></p></blockquote><p id="4bbb" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">在这种情况下，直接访问DOM树的元素并附加阴影DOM</p><pre class="jv jw jx jy gt my mz na nb aw nc bi"><span id="edbc" class="nd lf iq mz b gy ne nf l ng nh">var <!-- -->shadow<!-- --> = element.attachShadow(<!-- -->{mode: 'open'}<!-- -->);</span></pre><p id="80fc" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">Shadow dom的模式属性可以是“open”或“closed”。</p><p id="ef25" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">它指定了是否可以从JavaScript访问影子根的内部特性。</p><p id="7e08" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">所以如果mode=closed，element.shadowRoot会返回<em class="mu"> null。</em></p><h1 id="9569" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">创建阴影dom结构:</h1><pre class="jv jw jx jy gt my mz na nb aw nc bi"><span id="0a97" class="nd lf iq mz b gy ne nf l ng nh">var parent = document.createElement('div');<br/>var img = document.createElement('img');<br/>icon.appendChild(img);</span></pre><h1 id="e2be" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">将影像dom附加到影像根:</h1><pre class="jv jw jx jy gt my mz na nb aw nc bi"><span id="1fee" class="nd lf iq mz b gy ne nf l ng nh">shadow.appendChild(parent);</span></pre></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="1393" class="le lf iq bd lg lh mm lj lk ll mn ln lo lp mo lr ls lt mp lv lw lx mq lz ma mb bi translated">为什么是影子王国？</h1><p id="30f8" class="pw-post-body-paragraph kg kh iq ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld ij bi translated">如前所述，它有助于从真实的树中抽象出影子树。</p><p id="8c5b" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">让我们看一个例子:</p><p id="f995" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">我们有一个带有div #divInDom和' p '标签的HTML文件</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ni"><img src="../Images/b67da0fd234ba5bf9af07f37c97fa6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mm9_EiFEZiTSwrx3GInNlw.png"/></div></div></figure><p id="b021" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">现在我们给div #divInDom添加一个阴影房间</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/17868a41985b9d1ecbef07096fd040a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*PT36pecsgKPl3i6JkxS0ww.png"/></div></figure><p id="fa9a" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">我们在阴影DOM中添加了一个p标签，现在看起来像这样:</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/b2b02c5af90771ce0d69bb9ee6a265f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*bvniN98Cdl3wlRIlI42ANA.png"/></div></figure><p id="d94a" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">输出:</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/6912ac3f5b83aca672939e025c67e71f.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*2Uf7IqfWg39azhB_xOZdTA.png"/></div></figure><p id="64d9" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">现在让我们看看✨行动中的影子王国</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/4bf3b8f7b857956967110dbe48f123e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*KqwNaKasvNkf9X2vPy1Yiw.png"/></div></figure><p id="86f3" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">我们为“p”标签添加了一个样式，如果你还记得，我们现在有两个“p”标签——一个作为DOM的一部分，一个作为影子DOM的一部分。</p><p id="7a39" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">让我们看看输出中发生了什么:</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f9b8e41824f61cd88c059a555f2834ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*QTgE1Zdwn44noBzOy91TfQ.png"/></div></figure><p id="7abc" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">如你所见，样式没有影响阴影DOM元素。</p><p id="9f47" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">反之亦然，影子DOM中定义的样式不会影响根DOM。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="b9f7" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">影子DOM并不是最近才出现的——浏览器使用它封装元素的内部结构已经有很长时间了。<video>标记就是很好的例子。</video></p><p id="bc45" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">您在DOM中看到的只是<code class="fe no np nq mz b">&lt;video&gt;</code>元素，但是它包含一系列按钮和它的影子DOM中的其他控件。shadow DOM规范已经做到了这一点，因此您可以实际操作自己定制元素的shadow DOM。</p><p id="9c0a" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">链接到示例:</p><div class="nr ns gp gr nt nu"><a href="https://glitch.com/~shadowdom" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">阴影世界</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">阴影Dom示例🎏Glitch是一个友好的社区，每个人都可以在这里发现和创建最好的应用程序…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">glitch.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ka nu"/></div></div></a></div><p id="64df" class="pw-post-body-paragraph kg kh iq ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld ij bi translated">影子DOM上的MDN文档:</p><div class="nr ns gp gr nt nu"><a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">使用阴影DOM</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">web组件的一个重要方面是封装——能够保持标记结构、样式和行为…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">developer.mozilla.org</p></div></div><div class="od l"><div class="oj l of og oh od oi ka nu"/></div></div></a></div></div></div>    
</body>
</html>