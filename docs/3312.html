<html>
<head>
<title>How to build a backend app with TypeScript, Node.js, and Express</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用TypeScript、Node.js、Express构建后端app</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typescript-node-js-express-js-create-a-backend-application-f5110dbe5c19?source=collection_archive---------0-----------------------#2020-09-18">https://javascript.plainenglish.io/typescript-node-js-express-js-create-a-backend-application-f5110dbe5c19?source=collection_archive---------0-----------------------#2020-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="76a6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从头开始创建您的后端应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bf2b4a80808f1276eeba6a5aba6853c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0dUkitoxrpJ5xM-g6KaHLA.png"/></div></div></figure><h1 id="a076" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="fbb9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">你好。在本文结束时，您将知道如何创建一个简单可靠的后端应用程序，可以作为未来项目的样本。</p><p id="12af" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你可以直接在专用的<a class="ae mk" href="https://github.com/fairyfingers/ts-node-express-sample" rel="noopener ugc nofollow" target="_blank">库</a>中查看代码。<br/>本教程的每一步都匹配一个特定的提交。</p><h2 id="ba9a" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">要求</h2><ul class=""><li id="5995" class="mx my iq ll b lm ln lp lq ls mz lw na ma nb me nc nd ne nf bi translated">你最喜欢的IDE</li><li id="a997" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nc nd ne nf bi translated">安装node . js(<a class="ae mk" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en/download/</a>)</li><li id="595c" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nc nd ne nf bi translated">使用<em class="nl"> npm </em>安装TypeScript:</li></ul><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="5f64" class="ml ks iq nn b gy nr ns l nt nu">npm install -g typescript</span></pre><h2 id="c583" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">摘要</h2><ol class=""><li id="c9ca" class="mx my iq ll b lm ln lp lq ls mz lw na ma nb me nv nd ne nf bi translated"><strong class="ll ir">项目设置</strong> | <em class="nl">快速初始化，npm包&amp;程序入口点</em></li><li id="5ec3" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated"><strong class="ll ir">路由设置</strong> | <em class="nl">控制器，路由&amp;路由器</em></li><li id="39a1" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated"><strong class="ll ir">错误处理</strong> | <em class="nl">自定义错误&amp;错误处理功能</em></li></ol></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h1 id="ff62" class="kr ks iq bd kt ku od kw kx ky oe la lb jw of jx ld jz og ka lf kc oh kd lh li bi translated">项目设置</h1><h2 id="d4da" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">初始化</h2><p id="bca2" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">由于您的后端应用程序将使用TypeScript、Node.js和Express.js，因此您需要安装几个包(也称为<em class="nl">依赖项</em>)。<br/>为此，使用<code class="fe oi oj ok nn b"><a class="ae mk" href="https://docs.npmjs.com/cli/init.html" rel="noopener ugc nofollow" target="_blank">npm init</a></code> <a class="ae mk" href="https://docs.npmjs.com/cli/init.html" rel="noopener ugc nofollow" target="_blank">命令</a>初始化您的项目:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="17a8" class="ml ks iq nn b gy nr ns l nt nu">npm init -y</span></pre><p id="d0e1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬这将创建一个<code class="fe oi oj ok nn b">package.json</code>文件，该文件稍后将包含关于您的项目依赖项的所有信息。</p><p id="24fb" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">一旦完成，您需要指出您的项目是一个TypeScript项目。<br/>为此，使用下面的<code class="fe oi oj ok nn b"><a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" rel="noopener ugc nofollow" target="_blank">tsc</a></code> <a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" rel="noopener ugc nofollow" target="_blank">命令</a>创建一个TS配置文件:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="3751" class="ml ks iq nn b gy nr ns l nt nu">tsc --init</span></pre><p id="be7a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬这将创建一个<code class="fe oi oj ok nn b">tsconfig.json</code>文件，其中包含一些默认选项，我邀请您在它专用的<a class="ae mk" href="http://json.schemastore.org/tsconfig" rel="noopener ugc nofollow" target="_blank">模式存储</a> <em class="nl">中探索这些选项。</em></p><h2 id="b6f5" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">软件包概述</h2><p id="5375" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">几乎每个项目都依赖于一些外部包。这些包被认为是项目的<a class="ae mk" href="https://docs.npmjs.com/files/package.json#dependencies" rel="noopener ugc nofollow" target="_blank"> <em class="nl">依赖项</em> </a>。<br/>有些是你的项目<em class="nl">始终</em>需要的，但有些是只在开发时<em class="nl">需要的:这些被称为<a class="ae mk" href="https://docs.npmjs.com/files/package.json#devdependencies" rel="noopener ugc nofollow" target="_blank"> <em class="nl">开发依赖</em> </a>。</em></p><p id="1f18" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">以下是您将要安装的软件包:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="a6b6" class="ml ks iq nn b gy nr ns l nt nu">📦 <a class="ae mk" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"><strong class="nn ir">dotenv</strong></a> <em class="nl">(dependency)</em><br/>📦 <a class="ae mk" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"><strong class="nn ir">express</strong></a> <em class="nl">(dependency)</em><br/>📦 <strong class="nn ir">@types/express</strong> <em class="nl">(dev dependency)</em><br/>📦 <strong class="nn ir">@types/node</strong> <em class="nl">(dev dependency)</em><br/>📦 <a class="ae mk" href="https://www.npmjs.com/package/ts-node" rel="noopener ugc nofollow" target="_blank"><strong class="nn ir">ts-node</strong></a> <em class="nl">(dev dependency)</em><br/>📦 <a class="ae mk" href="https://www.npmjs.com/package/ts-node-dev" rel="noopener ugc nofollow" target="_blank"><strong class="nn ir">ts-node-dev</strong></a> <em class="nl">(dev dependency)</em><br/>📦 <a class="ae mk" href="https://www.npmjs.com/package/typescript" rel="noopener ugc nofollow" target="_blank"><strong class="nn ir">typescript</strong></a> <em class="nl">(dev dependency)</em></span></pre><p id="a47e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬所有这些包都有特定的用途，我邀请您通过单击其中的每一个包来快速了解一下。</p><h2 id="e2e7" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">软件包安装</h2><p id="cff6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在让我们使用<code class="fe oi oj ok nn b"><a class="ae mk" href="https://docs.npmjs.com/cli/install.html" rel="noopener ugc nofollow" target="_blank">npm install</a></code> <a class="ae mk" href="https://docs.npmjs.com/cli/install.html" rel="noopener ugc nofollow" target="_blank">命令</a>安装您的<em class="nl">依赖项</em>:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="f923" class="ml ks iq nn b gy nr ns l nt nu">npm install dotenv express</span></pre><p id="d1f7" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬这做了两件事。一方面，它在你的项目的<code class="fe oi oj ok nn b">node_modules</code>文件夹中安装<code class="fe oi oj ok nn b">dotenv</code>和<code class="fe oi oj ok nn b">express</code>包，另一方面，在你的<code class="fe oi oj ok nn b">package.json</code> <em class="nl">依赖</em>中注册它们。</p><p id="383a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们继续使用相同的命令安装您的<em class="nl">开发依赖项</em>:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="ef5d" class="ml ks iq nn b gy nr ns l nt nu">npm install -D @types/express @types/node ts-node ts-node-dev typescript</span></pre><p id="0fca" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬除了在<code class="fe oi oj ok nn b">package.json</code> <em class="nl">开发依赖</em>中注册包的<code class="fe oi oj ok nn b">-D</code>选项之外，这与之前做的完全一样。</p><h2 id="3431" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">环境变量</h2><p id="d954" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">应用程序配置可能会因部署而异，尤其是在开发人员工作站之间。例如，您可能不想让您的服务器监听与您的同事相同的端口，因为您的服务器已经在使用中。<br/>因此，我们有了所谓的<em class="nl">环境变量</em>(比如端口)。</p><p id="c87f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">它们通常都位于应用程序根目录下的同一个文件中。<br/>这个文件通常被称为<code class="fe oi oj ok nn b">.env</code>文件，下面是您需要的文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="f34f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬这里是你的项目的每一个全局变量和可配置变量的位置。您可能想在将来添加一些，但现在已经足够了…</p><h2 id="46ac" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">程序入口点</h2><p id="3b43" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">干得好，你已经设置了整个项目。现在你需要一个程序<em class="nl">入口点</em>。一些让你启动你的服务器并向它发送请求的代码。<br/>按顺序，遵循以下步骤:</p><ol class=""><li id="8733" class="mx my iq ll b lm mf lp mg ls on lw oo ma op me nv nd ne nf bi translated">在项目目录的根目录下创建一个<code class="fe oi oj ok nn b">src</code>文件夹</li><li id="6968" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">在你的<code class="fe oi oj ok nn b">src</code>文件夹中创建一个<code class="fe oi oj ok nn b">app.ts</code></li><li id="5b48" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">查看并粘贴下面几行到您的<code class="fe oi oj ok nn b">app.ts</code>文件中:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="ed45" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">开始脚本</h2><p id="7b0d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">要启动您的服务器应用程序，请在您的<code class="fe oi oj ok nn b">package.json</code>文件中添加以下行:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="7bd5" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后打开命令提示符，键入以下内容:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="6dcb" class="ml ks iq nn b gy nr ns l nt nu">npm run dev</span></pre><p id="56b1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">🚀恭喜你。您的服务器正在运行！</p><h1 id="991c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">路由设置</h1><h2 id="e99a" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">控制器</h2><p id="0c9f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">控制器是由主题集合的一组方法，由服务器调用以响应一些特定的客户端请求。<br/> <strong class="ll ir">一个控制器对应一个主题。</strong></p><h2 id="6ce8" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">路由和路由器</h2><p id="1dab" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mk" href="https://expressjs.com/en/starter/basic-routing.html" rel="noopener ugc nofollow" target="_blank">路由</a>基本上告诉你的服务器如何响应<em class="nl">客户端请求</em>。但是可能有许多不同的客户端请求，那么我们必须做些什么来让我们的服务器处理每一个请求呢？我们创建了我们所谓的<em class="nl">路由</em>和<em class="nl">路由器</em>。</p><blockquote class="oq or os"><p id="8745" class="lj lk nl ll b lm mf jr lo lp mg ju lr ot mh lu lv ou mi ly lz ov mj mc md me ij bi translated">路由是客户端请求和需要响应调用的正确控制器方法之间的链接。</p></blockquote><p id="07e2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">一个好的做法是按主题划分路线。如果你的项目是一个关于动物的网站，那么你很有可能不会把狗和老虎搞混。所以会有一些狗的特定路线和一些老虎的路线。这就是路由器发挥作用的地方。</p><blockquote class="oq or os"><p id="891a" class="lj lk nl ll b lm mf jr lo lp mg ju lr ot mh lu lv ou mi ly lz ov mj mc md me ij bi translated">路由器可以通过主题来区分路由，并为每条路由执行适当的代码。</p></blockquote><p id="a7bf" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因此，您将有一个关于狗的路由器，其中包含所有关于狗的路由，还有一个关于老虎的路由器，其中包含所有关于老虎的路由。<strong class="ll ir">一个主题一个路由器</strong>。</p><h2 id="2131" class="ml ks iq bd kt mm mn dn kx mo mp dp lb ls mq mr ld lw ms mt lf ma mu mv lh mw bi translated">履行</h2><p id="e0fe" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在第一步是从创建<em class="nl">控制器</em>开始。记住:一个控制器对应一个主题。请遵循以下步骤:</p><ol class=""><li id="9982" class="mx my iq ll b lm mf lp mg ls on lw oo ma op me nv nd ne nf bi translated">在你的<code class="fe oi oj ok nn b">src</code>文件夹中创建一个名为<code class="fe oi oj ok nn b">controllers</code>的新文件夹</li><li id="9410" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">选择两个独特的主题(保持简单，这只是一个样本)</li><li id="dc28" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">在文件夹内的单独文件中创建两个唯一的控制器:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="8dac" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬每个控制器拥有相同的默认方法，您稍后将调用该方法来响应特定的客户端请求，使用特定路由器中的特定路由。</p><p id="e485" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">现在，您将实现自己的路由器。记住:一个路由器对应一个主题，一个路由器对应一个控制器主题，一个路由器对应一个控制器。</p><ol class=""><li id="b9cf" class="mx my iq ll b lm mf lp mg ls on lw oo ma op me nv nd ne nf bi translated">在你的<code class="fe oi oj ok nn b">src</code>文件夹中创建一个名为<code class="fe oi oj ok nn b">routers</code>的新文件夹</li><li id="d149" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">在<code class="fe oi oj ok nn b">routers</code>中创建与主题一样多的子文件夹</li><li id="97d0" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">按照以下结构，在匹配的文件夹中创建路由器:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="ee6f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬每台路由器一构建好就配置好了。<code class="fe oi oj ok nn b">_configure()</code>方法将所有与路由器主题匹配的<em class="nl">路线</em>集中起来，并给它们一个特定的<em class="nl">控制器方法</em>,当到达路线的<em class="nl">端点</em>时调用该方法。</p><p id="6c50" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">现在，您需要一个主路由器来检测客户端请求所关注的主题，以及它必须将主题传递给哪个路由器。</p><ol class=""><li id="0010" class="mx my iq ll b lm mf lp mg ls on lw oo ma op me nv nd ne nf bi translated">在你的<code class="fe oi oj ok nn b">routers</code>文件夹中创建一个<code class="fe oi oj ok nn b">MasterRouter.ts</code>文件</li><li id="af97" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">将以下代码复制/粘贴到您的文件中:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="b803" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">3.编辑你的程序入口点(<code class="fe oi oj ok nn b">app.ts</code>文件) :</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="6efc" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">现在使用<code class="fe oi oj ok nn b">npm run dev</code>启动您的服务器，并尝试访问以下内容:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="a3ce" class="ml ks iq nn b gy nr ns l nt nu">http://localhost:{port}/api/themeA<br/>http://localhost:{port}/api/themeB</span></pre><p id="9248" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">输出应该是:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="4146" class="ml ks iq nn b gy nr ns l nt nu"><strong class="nn ir">{</strong>"text": "You've reached the ThemeAController default method"<strong class="nn ir">}<br/>---- or<br/>{</strong>"text": "You've reached the ThemeBController default method"<strong class="nn ir">}</strong></span></pre><p id="3df6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">恭喜恭喜！</strong>🤙您已经设置了后端应用程序(以最简单的形式)。</p><h1 id="c40c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">错误处理</h1><p id="e50f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">假设您有一个前端应用程序，它使用您的后端应用程序的API。<br/>你可能想通知你的前端应用程序，以防你的后端应用程序出错，这样它的最终用户也能得到通知…</p><p id="bb18" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为此，您必须创建自定义错误处理系统，以及自定义错误对象。<br/>幸运的是JavaScript有自己的<code class="fe oi oj ok nn b">Error</code>对象，所以你要做的就是<em class="nl">扩展</em>这个对象，并添加你需要的所有道具。</p><ol class=""><li id="627d" class="mx my iq ll b lm mf lp mg ls on lw oo ma op me nv nd ne nf bi translated">在<code class="fe oi oj ok nn b">src</code>文件夹中创建一个名为<code class="fe oi oj ok nn b">models</code>的新文件夹</li><li id="968e" class="mx my iq ll b lm ng lp nh ls ni lw nj ma nk me nv nd ne nf bi translated">创建一个<code class="fe oi oj ok nn b">ErrorHandler.ts</code>文件，并将以下代码复制/粘贴到其中:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="ba8d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">3.还要编辑你的<code class="fe oi oj ok nn b">app.ts</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="271d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">4.现在你可能想看看这是如何工作的。转到您的一个控制器，并用以下代码替换它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="80e3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">5.最后，转到它的匹配路由器，用下面的代码替换它的<code class="fe oi oj ok nn b">_configure()</code>方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="60f6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">💬如果控制器在<code class="fe oi oj ok nn b">try</code>块中抛出任何错误，它会被立即捕获并重定向到下一个应用中间件<em class="nl">，在这个特定的情况下:您刚刚在<code class="fe oi oj ok nn b">app.ts</code>文件中编写的处理应用错误的代码。</em></p><p id="6256" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">启动您的服务器，并尝试到达您放置错误的端点。<br/>输出应该和这个一样:</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="6809" class="ml ks iq nn b gy nr ns l nt nu"><strong class="nn ir">{</strong>"status": "error","statusCode": <strong class="nn ir">501</strong>,"message": "Not implemented method"<strong class="nn ir">}</strong></span></pre></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="e3bb" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">搞定！Node.js/Express.js.，这是你的后台应用程序样本，用打字稿做的。如果你有任何问题，请随时提问。</strong></p><p id="8c0b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><em class="nl">特别感谢Chinedu Orie用他的</em> <a class="ae mk" href="https://dev.to/nedsoft/central-error-handling-in-express-3aej" rel="noopener ugc nofollow" target="_blank"> <em class="nl">条</em> </a> <em class="nl">关于Express中的错误处理。</em></p></div></div>    
</body>
</html>