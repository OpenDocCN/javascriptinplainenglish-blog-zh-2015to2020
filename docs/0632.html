<html>
<head>
<title>Problems I faced whilst using building a mobile app with React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我在使用React Native构建移动应用时遇到的问题</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/problems-i-faced-whilst-using-react-native-a71b6de432fc?source=collection_archive---------1-----------------------#2019-11-19">https://javascript.plainenglish.io/problems-i-faced-whilst-using-react-native-a71b6de432fc?source=collection_archive---------1-----------------------#2019-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4533" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我所做的所有试验和错误的一个大列表，以及所有的修复——这样你就不必遭受我所经历的痛苦了！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1c42a739ccab2b3a86f41f26356310ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQ11_TLArd7xGuWiSomBSg.png"/></div></div></figure><p id="7173" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="ln">注意:</em> </strong> <em class="ln">这篇文章并不打算成为一个完整的问题修复列表。它甚至不是一篇合适的文章。它实际上是一个记事本文档，里面满是我在使用React-Native时遇到的问题，我认为它可能对其他人有用。这些问题中的许多可能已经在RN的较新版本中得到解决。我当时用的是0.56–0.58。</em></p><h2 id="8457" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">如果你打算使用Firebase，一个很好的起点是在<a class="ae mh" href="https://rnfirebase.io/" rel="noopener ugc nofollow" target="_blank">https://rnfirebase.io/</a>上的初学者工具包</h2><p id="b781" class="pw-post-body-paragraph kr ks iq kt b ku mi jr kw kx mj ju kz la mk lc ld le ml lg lh li mm lk ll lm ij bi translated"><a class="ae mh" href="https://github.com/invertase/react-native-firebase-starter" rel="noopener ugc nofollow" target="_blank">https://github.com/invertase/react-native-firebase-starter</a></p><p id="5dbc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这为React Native安装了一个定制版本的Firebase，这是天赐之物。</p><p id="2482" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要完成这一设置，需要完成许多工作，包括:</p><h2 id="60c4" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">1)克隆和安装依赖关系</h2><ul class=""><li id="55ac" class="mn mo iq kt b ku mi kx mj la mp le mq li mr lm ms mt mu mv bi translated">1.1) git克隆<a class="ae mh" href="https://github.com/invertase/react-native-firebase-starter.git" rel="noopener ugc nofollow" target="_blank">https://github . com/invertase/react-native-firebase-starter . git</a></li><li id="874a" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">1.2)将react-native-firebase-starter光盘放入新创建的项目目录中。</li><li id="1ff9" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">1.3)使用您选择的软件包管理器安装npm软件包，即运行yarn或NPM安装</li><li id="cc02" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">1.4) [iOS] cd ios并运行pod install —如果您没有CocoaPods，您可以按照这些说明<a class="ae mh" href="https://guides.cocoapods.org/using/getting-started.html#getting-started" rel="noopener ugc nofollow" target="_blank">安装它。</a></li><li id="9d51" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">1.5) [Android]此处没有针对Android的额外步骤。</li></ul><h2 id="2b17" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">2)重命名项目</h2><p id="9ed2" class="pw-post-body-paragraph kr ks iq kt b ku mi jr kw kx mj ju kz la mk lc ld le ml lg lh li mm lk ll lm ij bi translated">您需要运行节点版本7.6或更高版本，重命名功能才能工作</p><ul class=""><li id="ca14" class="mn mo iq kt b ku kv kx ky la nb le nc li nd lm ms mt mu mv bi translated">2.0) [iOS]光盘..返回到项目的根目录</li><li id="7db4" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">2.1) npm运行重命名—系统会提示您输入项目名称和公司名称</li><li id="09b4" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">2.2)记下包名的值——在设置Firebase项目时会用到它</li></ul><h2 id="8b86" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">3)添加谷歌服务文件(plist &amp; JSON)</h2><ul class=""><li id="a909" class="mn mo iq kt b ku mi kx mj la mp le mq li mr lm ms mt mu mv bi translated">3.1) [iOS]按照将firebase添加到您的应用程序的说明<a class="ae mh" href="https://firebase.google.com/docs/ios/setup#add_firebase_to_your_app" rel="noopener ugc nofollow" target="_blank">这里的</a>来生成您的GoogleService-Info.plist文件(如果您还没有这样做的话)——使用之前生成的包名作为您的iOS捆绑包ID。</li><li id="8ea4" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">3.2) [iOS]将此文件放在项目的ios/目录中。</li><li id="6741" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">3.3) [Android]按照手动将firebase添加到您的应用程序的说明<a class="ae mh" href="https://firebase.google.com/docs/android/setup#manually_add_firebase" rel="noopener ugc nofollow" target="_blank">此处</a>生成您的google-services.jsonfile(如果您还没有这样做的话)——使用之前生成的包名作为您的Android包名。</li><li id="2e60" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">3.4) [Android]把这个文件放在你项目的android/app/目录下。</li></ul><h2 id="b8b7" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">4)启动你的应用程序</h2><ul class=""><li id="b03f" class="mn mo iq kt b ku mi kx mj la mp le mq li mr lm ms mt mu mv bi translated">4.1)从项目的根目录启动react native packager，运行yarn run start或npm start。</li><li id="22de" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">4.2) [ios]构建并运行iOS应用，从你的项目根目录运行npm运行iOS或yarn运行iOS。第一次构建需要一些时间。这将自动启动一个模拟器，如果还没有启动的话，它也会为你成功的构建一个模拟器。</li><li id="9a74" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated">4.3) [Android]如果你还没有安装Android设备/运行模拟器，那么你需要安装一个(确保模拟器安装了Google Play/API)。当准备好运行npm运行android或yarn运行android从你的项目的根。</li></ul><p id="36c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果一切顺利，您将看到如下所示的初始屏幕。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/a141c90e697f7615b392eac899aea9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/0*IMrwgT_Q4O9X4x5n"/></div></figure><p id="003e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，您会发现这并不完全可靠，需要进行一些调整才能正常工作。</p><p id="603d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">也就是说，在<strong class="kt ir"> build.gradle </strong>内部存在需要调整的问题，因为一些构建版本彼此不兼容。还有一些重复的条目必须删除。</p><p id="7981" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有一个问题是，当应用程序最终安装到android设备上时，会出现RNFirebase的重复实例。不得不在<strong class="kt ir">MainApplication.java</strong>中对它们进行注释，如下所示:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="c391" class="lo lp iq ng b gy nk nl l nm nn">package com.javascriptinplainenglish.plaingroup;</span><span id="15aa" class="lo lp iq ng b gy no nl l nm nn">import android.annotation.SuppressLint;</span><span id="cfda" class="lo lp iq ng b gy no nl l nm nn">import android.app.Application;</span><span id="d881" class="lo lp iq ng b gy no nl l nm nn">import com.facebook.react.ReactApplication;</span><span id="b4b1" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.RNFirebasePackage;</span><span id="1dbe" class="lo lp iq ng b gy no nl l nm nn">import com.facebook.react.ReactNativeHost;</span><span id="685e" class="lo lp iq ng b gy no nl l nm nn">import com.facebook.react.ReactPackage;</span><span id="ea6f" class="lo lp iq ng b gy no nl l nm nn">import com.facebook.react.shell.MainReactPackage;</span><span id="4842" class="lo lp iq ng b gy no nl l nm nn">import com.facebook.soloader.SoLoader;</span><span id="03cd" class="lo lp iq ng b gy no nl l nm nn">// import io.invertase.firebase.RNFirebasePackage;</span><span id="f6f1" class="lo lp iq ng b gy no nl l nm nn">// optional packages — add/remove as appropriate</span><span id="f1ca" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.admob.RNFirebaseAdMobPackage;</span><span id="fd32" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.analytics.RNFirebaseAnalyticsPackage;</span><span id="d724" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.auth.RNFirebaseAuthPackage;</span><span id="8f6d" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.config.RNFirebaseRemoteConfigPackage;</span><span id="951f" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.database.RNFirebaseDatabasePackage;</span><span id="496e" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.fabric.crashlytics.RNFirebaseCrashlyticsPackage;</span><span id="9aa8" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.firestore.RNFirebaseFirestorePackage;</span><span id="7092" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.functions.RNFirebaseFunctionsPackage;</span><span id="2d18" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.instanceid.RNFirebaseInstanceIdPackage;</span><span id="ad52" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.invites.RNFirebaseInvitesPackage;</span><span id="04aa" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.links.RNFirebaseLinksPackage;</span><span id="baeb" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.messaging.RNFirebaseMessagingPackage;</span><span id="4be4" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.notifications.RNFirebaseNotificationsPackage;</span><span id="9606" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.perf.RNFirebasePerformancePackage;</span><span id="7aee" class="lo lp iq ng b gy no nl l nm nn">import io.invertase.firebase.storage.RNFirebaseStoragePackage;</span><span id="4348" class="lo lp iq ng b gy no nl l nm nn">import java.util.Arrays;</span><span id="c9cd" class="lo lp iq ng b gy no nl l nm nn">import java.util.List;</span><span id="68fa" class="lo lp iq ng b gy no nl l nm nn">public class MainApplication extends Application implements ReactApplication {</span><span id="1b22" class="lo lp iq ng b gy no nl l nm nn">private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) {</span><span id="4278" class="lo lp iq ng b gy no nl l nm nn">@Override</span><span id="207a" class="lo lp iq ng b gy no nl l nm nn">public boolean getUseDeveloperSupport() {</span><span id="db73" class="lo lp iq ng b gy no nl l nm nn">return BuildConfig.DEBUG;</span><span id="9824" class="lo lp iq ng b gy no nl l nm nn">}</span><span id="9d1f" class="lo lp iq ng b gy no nl l nm nn">@SuppressLint(“MissingPermission”)</span><span id="45f9" class="lo lp iq ng b gy no nl l nm nn">@Override</span><span id="f72e" class="lo lp iq ng b gy no nl l nm nn">protected List&lt;ReactPackage&gt; getPackages() {</span><span id="2e73" class="lo lp iq ng b gy no nl l nm nn">return Arrays.asList(</span><span id="986b" class="lo lp iq ng b gy no nl l nm nn">new MainReactPackage(),</span><span id="bba8" class="lo lp iq ng b gy no nl l nm nn">// new RNFirebasePackage(),</span><span id="73bd" class="lo lp iq ng b gy no nl l nm nn">new RNFirebasePackage(),</span><span id="02b2" class="lo lp iq ng b gy no nl l nm nn">// add/remove these packages as appropriate</span><span id="2e69" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseAdMobPackage(),</span><span id="e83c" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseAnalyticsPackage(),</span><span id="c7c1" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseAuthPackage(),</span><span id="15b9" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseRemoteConfigPackage(),</span><span id="f564" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseCrashlyticsPackage(),</span><span id="6c6f" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseDatabasePackage(),</span><span id="55af" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseFirestorePackage(),</span><span id="6c10" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseFunctionsPackage(),</span><span id="7d0f" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseInstanceIdPackage(),</span><span id="b350" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseInvitesPackage(),</span><span id="3f61" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseLinksPackage(),</span><span id="7174" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseMessagingPackage(),</span><span id="2f33" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseNotificationsPackage(),</span><span id="7d95" class="lo lp iq ng b gy no nl l nm nn">new RNFirebasePerformancePackage(),</span><span id="26f2" class="lo lp iq ng b gy no nl l nm nn">new RNFirebaseStoragePackage()</span><span id="3a86" class="lo lp iq ng b gy no nl l nm nn">);</span><span id="f4cc" class="lo lp iq ng b gy no nl l nm nn">}</span><span id="7588" class="lo lp iq ng b gy no nl l nm nn">@Override</span><span id="ca40" class="lo lp iq ng b gy no nl l nm nn">protected String getJSMainModuleName() {</span><span id="dec9" class="lo lp iq ng b gy no nl l nm nn">return “index”;</span><span id="0b29" class="lo lp iq ng b gy no nl l nm nn">}</span><span id="abe5" class="lo lp iq ng b gy no nl l nm nn">};</span><span id="c0b9" class="lo lp iq ng b gy no nl l nm nn">@Override</span><span id="613e" class="lo lp iq ng b gy no nl l nm nn">public ReactNativeHost getReactNativeHost() {</span><span id="447a" class="lo lp iq ng b gy no nl l nm nn">return mReactNativeHost;</span><span id="c21d" class="lo lp iq ng b gy no nl l nm nn">}</span><span id="4f1c" class="lo lp iq ng b gy no nl l nm nn">@Override</span><span id="f1bf" class="lo lp iq ng b gy no nl l nm nn">public void onCreate() {</span><span id="3f31" class="lo lp iq ng b gy no nl l nm nn">super.onCreate();</span><span id="08e5" class="lo lp iq ng b gy no nl l nm nn">SoLoader.init(this, /* native exopackage */ false);</span><span id="806e" class="lo lp iq ng b gy no nl l nm nn">}</span><span id="d63d" class="lo lp iq ng b gy no nl l nm nn">}</span></pre><p id="8228" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在React Native中编写需要处理一些细微差别:</p><p id="8693" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">想要使用字体等资产？将此添加到您的包中。json:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="dfc5" class="lo lp iq ng b gy nk nl l nm nn">“rnpm”: {<br/>   “assets”: [<br/>   “./assets/fonts/”<br/>   ]<br/> }</span></pre><p id="9d8a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当你打包你的iOS应用时，你最好提交一个捆绑的JS文件，而不是让你的应用实时编译JS。所以你应该运行这个函数:</p><p id="4aad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe np nq nr ng b">react-native bundle --entry-file index.js --platform ios --dev false --bundle-output ios/main.jsbundle --assets-dest ios</code></p><p id="d52c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后引用这个而不是本地构建，方法是将<strong class="kt ir"> AppDelegate.m </strong>中的<code class="fe np nq nr ng b">jsCodeLocation</code>行替换为</p><p id="5ce6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe np nq nr ng b">jsCodeLocation = [[NSBundle mainBundle] URLForResource:@”main” withExtension:@”jsbundle”];</code></p><p id="c511" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">作为参考，这一行最初是:</p><p id="d6c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe np nq nr ng b">jsCodeLocation = [[RCTBundleURLProvider shareSettings] jsBundleURLForBundleRoots:@”index” fallbackResrouce:nil];</code></p><h2 id="f273" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">npm安装后库没有出现在你的代码中？</h2><p id="e034" class="pw-post-body-paragraph kr ks iq kt b ku mi jr kw kx mj ju kz la mk lc ld le ml lg lh li mm lk ll lm ij bi translated">您可能需要手动添加它。要为ios执行此操作，请在xcode中打开您的项目，并检查/添加以下内容:</p><p id="f721" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我检查了Xcode项目，我有:</p><ul class=""><li id="2e09" class="mn mo iq kt b ku kv kx ky la nb le nc li nd lm ms mt mu mv bi translated"><code class="fe np nq nr ng b">RNSVG.xcodeproj</code>在“图书馆”</li><li id="b605" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated"><code class="fe np nq nr ng b">libRNSVG.a</code>在“将二进制文件与库链接”中</li><li id="20c9" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ms mt mu mv bi translated"><code class="fe np nq nr ng b">$(SRCROOT)/../node_modules/react-native-svg/ios</code>在“标题搜索路径”中</li></ul><p id="24c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">尽管实际添加的内容会因您安装的内容而有所不同。在本例中，它是一个名为REACT-NATIVE-SVG的包</p><h2 id="7c20" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">如何构建生产版本</h2><p id="cd84" class="pw-post-body-paragraph kr ks iq kt b ku mi jr kw kx mj ju kz la mk lc ld le ml lg lh li mm lk ll lm ij bi translated"><strong class="kt ir"> ios </strong></p><p id="3dca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为ios创建js包文件—</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="328b" class="lo lp iq ng b gy nk nl l nm nn">react-native bundle --entry-file index.js --platform ios --dev false --bundle-output ios/main.jsbundle --assets-dest ios</span></pre><p id="f26d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后进入AppDelegate.m，查找如下所示的一行代码:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="3e7e" class="lo lp iq ng b gy nk nl l nm nn">jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"index" fallbackResource:nil];</span></pre><p id="73c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，您会希望注释掉该行，并在它下面添加以下行:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="2c50" class="lo lp iq ng b gy nk nl l nm nn">jsCodeLocation = [[NSBundle mainBundle] URLForResource:@"main" withExtension:@"jsbundle"];</span></pre><p id="a021" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这基本上是告诉您的本机应用程序代码查找运行react-native bundle时创建的jsbundle文件。它告诉你的应用程序使用它，而不是试图在运行时运行和编译非捆绑代码。</p><p id="2b64" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦你这样做了，你的代码块应该看起来像这样:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="72cc" class="lo lp iq ng b gy nk nl l nm nn">jsCodeLocation = [[NSBundle mainBundle] URLForResource:@"main" withExtension:@"jsbundle"];<br/>// jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"index" fallbackResource:nil];</span></pre><p id="e095" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">顺便说一下，我们保留原始代码并简单地将其注释掉的原因是，我们可以根据我们是在开发环境中运行还是想要使用我们的生产代码来快速注释和取消注释每一位。这样，如果我们想进一步修改我们的应用程序代码，我们可以切换回来，做更多的修改，重新绑定所有东西，然后再切换。</p><p id="cd0c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦你这样做了，你会想要打开Xcode并打开你的ios项目(这通常应该位于你的ios下的主react-native目录中——例如，它可能是supersonic app/IOs)。打开后，确保将活动方案设置为通用iOS设备，然后在顶部导航菜单中单击产品，并单击存档。</p><p id="48eb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">xcode —包</p><p id="c890" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">安卓</strong></p><p id="8a75" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你需要构建一个新版本的代码库</p><p id="d720" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae mh" href="https://proandroiddev.com/bundling-react-native-during-android-release-builds-ec52c24e200d" rel="noopener ugc nofollow" target="_blank">https://proandroiddev . com/bundling-react-native-during-Android-release-builds-ec52c 24 e 200d</a></p><p id="dbf4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您需要首先更新您的版本的versionCode和versionName。</p><p id="d20d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在app/build.gradle中，您会看到以下几行:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="18df" class="lo lp iq ng b gy nk nl l nm nn">versionCode 1<br/>versionName "1.0"</span></pre><p id="4b0d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">更新这些。versionCode必须是整数，因此即使您的更新很小，您也必须将其从1更新到2。版本名称是人们将看到的名称，因此可以从1.0更新到1.1或1.0.1等。</p><p id="7a8e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后通过运行以下命令构建新的js包:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="6cc0" class="lo lp iq ng b gy nk nl l nm nn">react-native bundle --entry-file index.js --platform android --dev false --bundle-output android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res</span></pre><p id="4556" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后由于某种原因，在android/src/res内部生成了五个不同的文件夹，名字分别是drawable-hdpi，drawable-mdpi等等。删除所有这些，但保留名为drawable的文件夹。</p><p id="b808" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后导航到android文件夹并运行</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="66d1" class="lo lp iq ng b gy nk nl l nm nn">./gradlew assembleRelease</span></pre><p id="f652" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将在Android/app/build/outputs/apk/release中构建一个发布apk。</p><p id="2ca5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以把它上传到google play商店:</p><p id="c654" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">转到<a class="ae mh" href="https://play.google.com/apps/publish/" rel="noopener ugc nofollow" target="_blank">https://play.google.com/apps/publish/</a></p><p id="b861" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后点击发布管理-&gt;应用发布</p><h2 id="dc0b" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">的问题。/grad Lew assembly release，它未能成功编译。</h2><p id="493e" class="pw-post-body-paragraph kr ks iq kt b ku mi jr kw kx mj ju kz la mk lc ld le ml lg lh li mm lk ll lm ij bi translated">会不会是您的依赖项使用了不同的targetSdkVersion？见下文:</p><p id="2813" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">错误原因:</strong></p><p id="06e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您已经安装了<em class="ln">react-native-document-picker</em>作为依赖项，这个错误的原因是您的<code class="fe np nq nr ng b">android/app/build.gradle</code>和<code class="fe np nq nr ng b">node_modules/react-native-document-picker/android/build.gradle</code>的配置不匹配。</p><p id="9cf0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">解决方案</strong></p><ol class=""><li id="9a92" class="mn mo iq kt b ku kv kx ky la nb le nc li nd lm ns mt mu mv bi translated">导航到<code class="fe np nq nr ng b">node_modules/react-native-document-picker/android/build.gradle</code></li><li id="53ad" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ns mt mu mv bi translated">编辑并保持<code class="fe np nq nr ng b">compileSdkVersion</code> <code class="fe np nq nr ng b">buildToolsVersion</code> <code class="fe np nq nr ng b">minSdkVersion targetSdkVersion</code>和<code class="fe np nq nr ng b">android/app/build.gradle</code>中的一样</li><li id="c80c" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ns mt mu mv bi translated">再次同步项目。</li><li id="c288" class="mn mo iq kt b ku mw kx mx la my le mz li na lm ns mt mu mv bi translated">从终端运行<code class="fe np nq nr ng b">./gradlew assembleRelease</code>。</li></ol><h2 id="c0ef" class="lo lp iq bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf mg bi translated">npm运行apk不生成签名版本的问题</h2><p id="9eac" class="pw-post-body-paragraph kr ks iq kt b ku mi jr kw kx mj ju kz la mk lc ld le ml lg lh li mm lk ll lm ij bi translated"><a class="ae mh" href="https://reactnativeforyou.com/always-creating-unsigned-release-apk-react-native-error-fix/" rel="noopener ugc nofollow" target="_blank">https://react nationalforyou . com/always-creating-unsigned-release-apk-react-native-error-fix/</a></p></div></div>    
</body>
</html>