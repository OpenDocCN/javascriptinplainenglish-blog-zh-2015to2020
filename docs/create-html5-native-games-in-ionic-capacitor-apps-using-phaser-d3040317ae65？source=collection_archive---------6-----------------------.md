# ä½¿ç”¨ Phaser åœ¨ Ionic Capacitor åº”ç”¨ç¨‹åºä¸­åˆ›å»º HTML5 åŸç”Ÿæ¸¸æˆ

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/create-html5-native-games-in-ionic-capacitor-apps-using-phaser-d3040317ae65?source=collection_archive---------6----------------------->

![](img/45736cdd6b545e4765828515c4aefe45.png)

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•åœ¨ Capacitor Ionic åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ Phaser åˆ›å»º HTML5 æ¸¸æˆã€‚æˆ‘ä»¬å°†åˆ›å»ºåƒµå°¸æ­¥è¡Œè€…å’Œå¤ªç©ºå…¥ä¾µè€…æ¸¸æˆï¼Œä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå’Œæµè§ˆå™¨ä¸­ç©ã€‚ã€Šå¤ªç©ºå…¥ä¾µè€…ã€‹æ˜¯æˆ‘åœ¨å­¦æ ¡ç”¨ JAVA å¼€å‘çš„ç¬¬ä¸€ä¸ªæ¸¸æˆï¼Œæ‰€ä»¥å®ƒå¯¹æˆ‘æ¥è¯´å°±åƒæ˜¯ä¸€ä¸ªâ€œHello Worldâ€æ¸¸æˆï¼

![](img/f82c796bfe7313aa4e0df7613eb7f5e1.png)

Space Invaders built in Ionic Capacitor with Phaser framework

HTML5 æ¸¸æˆå¯ä»¥ä½¿ç”¨ Phaser æ¡†æ¶åˆ¶ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„ 2D æ¸¸æˆå¼€å‘æ¡†æ¶ã€‚ç”µå®¹å™¨æ˜¯æ··åˆåº”ç”¨ç¨‹åºä¸–ç•Œçš„æœ€æ–°çƒ­ç‚¹ã€‚å®ƒæ˜¯å¯¹ç§‘å°”å¤šç“¦çš„æ›¿ä»£å’Œæ”¹è¿›ã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­äº†è§£æ›´å¤šã€‚

> **æœ¬æ¬¡æ¼”ç¤ºç”± Enappd çš„** [**Ionic 4 å…¨ App Starter**](https://store.enappd.com/product/ionic-4-full-app/) **æä¾›æ”¯æŒã€‚æœ¬æ•™ç¨‹å®Œæ•´æºä»£ç åœ¨ Github repoâ€”**[**Ionic-4-phaser**](https://github.com/enappd/Ionic4-phaser)**(ZMB _ ç”µå®¹åˆ†æ”¯&SI _ ç”µå®¹åˆ†æ”¯)**ä¸­

è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¯¹æ¯ä¸ªåŒ…å«çš„æ¡†æ¶çš„ç®€è¦ä»‹ç»:

1.  ç¦»å­çš„
2.  ç”µå®¹å™¨
3.  ç›¸ä½å™¨

# ç¦»å­æ¡†æ¶

ä½ å¯èƒ½å·²ç»çŸ¥é“ç¦»å­ï¼Œä½†æˆ‘æŠŠå®ƒæ”¾åœ¨è¿™é‡Œåªæ˜¯ä¸ºäº†åˆå­¦è€…ã€‚ **Ionic** æ˜¯ä¸€æ¬¾æ··åˆç§»åŠ¨ app å¼€å‘ SDKã€‚å®ƒæä¾›äº†ä½¿ç”¨ CSSã€HTML5 å’Œ Sass ç­‰ Web æŠ€æœ¯å¼€å‘æ··åˆç§»åŠ¨åº”ç”¨ç¨‹åºçš„å·¥å…·å’ŒæœåŠ¡ã€‚åº”ç”¨ç¨‹åºå¯ä»¥ç”¨è¿™äº›ç½‘ç»œæŠ€æœ¯æ„å»ºï¼Œç„¶åé€šè¿‡æœ¬åœ°åº”ç”¨å•†åº—å‘å¸ƒã€‚è¿™äº›åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡åˆ©ç”¨ [Cordova](https://cordova.apache.org/) æˆ– Capacitor ç¯å¢ƒå®‰è£…åœ¨è®¾å¤‡ä¸Šã€‚

æ‰€ä»¥ï¼Œæ¢å¥è¯è¯´â€”â€”å¦‚æœä½ ç”¨ Android åˆ›å»ºåŸç”Ÿåº”ç”¨ï¼Œä½ å°±ç”¨ Java ç¼–ç ã€‚å¦‚æœä½ åœ¨ iOS ä¸­åˆ›å»ºåŸç”Ÿåº”ç”¨ï¼Œä½ ç”¨ Obj-C æˆ– Swift ç¼–ç ã€‚è¿™ä¸¤ç§è¯­è¨€éƒ½æ˜¯å¼ºå¤§ä½†å¤æ‚çš„è¯­è¨€ã€‚**ä½¿ç”¨ Cordova(å’Œ Ionic ),ä½ å¯ä»¥ä¸ºä½ çš„åº”ç”¨ç¼–å†™ä¸€æ®µä»£ç ï¼Œå®ƒå¯ä»¥åœ¨ iOS å’Œ Android ä¸Šè¿è¡Œ**(å’Œ windowsï¼)ï¼ŒHTMLã€CSS å’Œ JS çš„ç®€å•æ€§ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

å¿…é¡»æ³¨æ„ç§‘å°”å¤šç“¦/ç”µå®¹åœ¨å…¶ä¸­çš„ä½œç”¨ã€‚Ionic åªæ˜¯ä¸€ä¸ªç”± HTMLã€CSSã€JS ç»„æˆçš„ UI åŒ…è£…å™¨ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒIonic ä¸èƒ½åœ¨ iOS æˆ– Android è®¾å¤‡ä¸­ä½œä¸ºåº”ç”¨ç¨‹åºè¿è¡Œã€‚Cordova/Capacitor æ˜¯ä¸€ä¸ªæ„å»ºç¯å¢ƒï¼Œå®ƒå°†è¿™ä¸ª Ionic web åº”ç”¨ç¨‹åºå°è£…èµ·æ¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªå¯å®‰è£…åœ¨è®¾å¤‡ä¸Šçš„åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶ä¸ºè¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›å¯¹ Camera ç­‰æœ¬åœ° API çš„è®¿é—®ã€‚

# Phaser æ¸¸æˆæ¡†æ¶

Phaser äº 2013 å¹´é¦–æ¬¡å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ª 2D HTML5 æ¸¸æˆå¼€å‘æ¡†æ¶ã€‚å®ƒç°åœ¨å·²ç»æˆä¸º 2D HTML5 æ¸¸æˆä¸­çš„ä¸€ä¸ªå·¨å¤§çš„åå­—ã€‚åŸºäº javascriptï¼Œå®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°é›†æˆåˆ°å„ç§ javascript æ¡†æ¶ä¸­ã€‚ğŸ‘¾ ğŸ‘¾ ğŸ‘¾

é‚£ä¹ˆä¸ºä»€ä¹ˆè¦é›†æˆ Phaser å’Œ Ionic å‘¢ï¼ŸğŸš€ ğŸ‘¾

è™½ç„¶ Ionic è®©ä½ èƒ½å¤Ÿä»¥é—ªç”µèˆ¬çš„é€Ÿåº¦åˆ›å»ºåº”ç”¨ç¨‹åºå’Œ PWAï¼Œä½†ä½ æ— æ³•ç”¨å®ƒçœŸæ­£åˆ¶ä½œæ¸¸æˆã€‚Phaser è™½ç„¶åœ¨æ¸¸æˆæ„å»ºæ–¹é¢å¾ˆæ£’ï¼Œä½†å¹¶ä¸æ˜¯çœŸçš„è¦æ„å»ºä¸€ä¸ªç»“æ„åŒ–çš„ç§»åŠ¨æˆ–ç½‘ç»œåº”ç”¨ã€‚å› æ­¤ï¼Œç”¨ Phaser æ„å»ºä¸€ä¸ªå¤–è§‚ç®€æ´çš„æ¸¸æˆåº”ç”¨æˆ– PWA éœ€è¦ä¸€ä¸ª HTML + CSS åŒ…è£…å™¨ï¼ŒIonic å®Œç¾åœ°å¡«è¡¥äº†è¿™ä¸ªç©ºç™½ã€‚

# ä»€ä¹ˆæ˜¯ç”µå®¹ï¼Ÿ

Cordova å¸®åŠ©å°† Ionic web app æ„å»ºæˆä¸€ä¸ªè®¾å¤‡å¯å®‰è£…çš„åº”ç”¨ç¨‹åºã€‚ä½†æ˜¯ Cordova æœ‰ä¸€äº›é™åˆ¶ï¼Œç”µå®¹å™¨è¯•å›¾é€šè¿‡æ–°çš„åº”ç”¨ç¨‹åºå·¥ä½œæµç¨‹æ¥å…‹æœè¿™äº›é™åˆ¶ã€‚

Capacitor æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå¯ä»¥è½»æ¾æ„å»ºåœ¨ iOSã€Androidã€Electronã€*å’Œ*ç½‘ç»œä¸Šè¿è¡Œçš„ web åº”ç”¨ç¨‹åºã€‚Ionic äººå°†è¿™äº›åº”ç”¨ç§°ä¸ºâ€œåŸç”Ÿæ¸è¿›å¼ç½‘ç»œåº”ç”¨â€ï¼Œå®ƒä»¬ä»£è¡¨äº†æ··åˆåº”ç”¨ä¹‹å¤–çš„ä¸‹ä¸€æ¬¡å‘å±•ã€‚å®ƒæ˜¯ä¸º Ionic æ„å»ºçš„ï¼Œä½†ä¹Ÿå¯ä»¥è¿è¡Œå…¶ä»–æ¡†æ¶ã€‚å®ƒåªæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ç³»ç»Ÿï¼Œå°†ä½ çš„ç½‘ç»œåº”ç”¨â€œå®¹å™¨åŒ–â€ï¼Œå…è®¸å®ƒåœ¨å¤šä¸ªåœ°æ–¹è¿è¡Œã€‚æœ‰äº†ç”µå®¹å™¨ï¼Œä½ å°±å¯ä»¥åœ¨

*   å®‰å“åº”ç”¨
*   iOS åº”ç”¨ç¨‹åº
*   åœ¨æµè§ˆå™¨ä¸­ä½œä¸ºæ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œä»¥åŠ
*   åœ¨ä½¿ç”¨ç”µå­æ¡Œé¢åº”ç”¨ä¸­

æœ¬è´¨ä¸Šï¼Œç”µå®¹å™¨å°±åƒä¸€ä¸ªæ–°é²œçš„ï¼Œæ›´çµæ´»çš„ç§‘å°”å¤šç“¦ç‰ˆæœ¬ã€‚å®ƒä½¿å¾—åœ¨å„ç§å¹³å°ä¸Šè¿è¡Œæ··åˆåº”ç”¨å˜å¾—éå¸¸å®¹æ˜“ã€‚

# å‘˜é¢ç»“æ„

æˆ‘ä»¬å°†éµå¾ªä¸€ä¸ªå¾ªåºæ¸è¿›çš„æ–¹æ³•ï¼Œåœ¨æˆ‘ä»¬çš„ Ionic 4 ç”µå®¹åº”ç”¨ç¨‹åºä¸­åˆ›å»ºä¸€ä¸ªåŸºäºç›¸ä½å™¨çš„æ¸¸æˆã€‚ä»¥ä¸‹æ˜¯æ­¥éª¤

*   æ­¥éª¤ 1â€”â€”åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„**ç¦»å­ 4 è§’**åº”ç”¨ç¨‹åº
*   æ­¥éª¤ 2-å°† Phaser åŒ…å«åœ¨é¡¹ç›®ä¸­
*   æ­¥éª¤ 3 â€”åœ¨åº”ç”¨ç¨‹åºä¸­é›†æˆç”µå®¹
*   æ­¥éª¤ 4-å®ç° Phaser æ¸¸æˆ
*   ç¬¬äº”æ­¥â€”â€”å°†æ¸¸æˆå†…ç½®åˆ°æ‰‹æœºåº”ç”¨ç¨‹åºä¸­

è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­è¦æ„å»ºçš„å†…å®¹ã€‚

![](img/6bfa0645cb3d7a5411f0441338ef1b8b.png)

A zombie walking â€” Using Phaser in capacitor app

æ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ï¼

# ç¬¬ä¸€æ­¥:åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ç¦»å­ 4 è§’åº”ç”¨ç¨‹åº

> æˆ‘å·²ç»åœ¨[è¿™ç¯‡åšå®¢](https://enappd.com/blog/how-to-create-an-ionic-4-app-for-beginners/13/)ä¸­è¯¦ç»†æŠ¥é“äº†è¿™ä¸ªè¯é¢˜ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ‚¨éœ€è¦é‡‡å–çš„æ­¥éª¤å¦‚ä¸‹

*   ç¡®ä¿æ‚¨å·²ç»åœ¨ç³»ç»Ÿä¸­å®‰è£…äº† node(åœ¨è¿™ç¯‡åšæ–‡å‘è¡¨æ—¶æ˜¯ V10.0.0)
*   ä½¿ç”¨ npm å®‰è£… **ionic cli** (æˆ‘çš„ ionic ç‰ˆæœ¬æ˜¯^4.7.1)
*   ä½¿ç”¨`ionic start`åˆ›å»º Ionic åº”ç”¨ç¨‹åº

ä¸ºäº†æœ¬æ•™ç¨‹ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ª`sidemenu`å¯åŠ¨å™¨ã€‚è¿è¡Œ`ionic start ioniser sidemenu`æ—¶ï¼Œå°†å®‰è£…èŠ‚ç‚¹æ¨¡å—ã€‚å®‰è£…å®Œæˆåï¼Œä½¿ç”¨åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åº

```
$ ionic serve
```

å¹¶æ£€æŸ¥ä¸€åˆ‡è¿è¡Œæ­£å¸¸ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œå®ƒçœ‹èµ·æ¥åƒè·Ÿéšã€‚ä»é™„å¸¦çš„ Github repo ä¸­å¤åˆ¶ä»£ç ï¼Œå°†å…¶æ›´æ”¹åˆ°æ¸¸æˆä¸­ã€‚

![](img/44cc98d18dc59a039ca20e155a935c23.png)

# æ­¥éª¤ 2:åœ¨é¡¹ç›®ä¸­åŒ…å« Phaser

Phaser éå¸¸å®¹æ˜“åŒ…å«åœ¨é¡¹ç›®ä¸­ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒåªæ˜¯ä¸€ä¸ªéœ€è¦åŒ…å«åœ¨ HTML5 é¡¹ç›®ä¸­çš„ Javascript æ–‡ä»¶ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°

***# 1â€”â€”é…·ç‚«çš„â€œä¸€åŠ³æ°¸é€¸â€æ–¹å¼(æ›´å¿«)***

ä» [Phaser å®˜æ–¹ä¸‹è½½](https://phaser.io/download/stable)ä¸‹è½½`*phaser.min.js*`ï¼Œå¹¶å°†å…¶ä¸æ‚¨çš„é¡¹ç›®é“¾æ¥ã€‚å‡ºäºæ¼”ç¤ºçš„ç›®çš„ï¼Œæˆ‘å°†æŠŠè¿™ä¸ªæ–‡ä»¶ä¿å­˜åœ¨`assets`æ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä» CDN é“¾æ¥å®ƒã€‚

å°† phaser.js æ–‡ä»¶åŒ…å«åœ¨`index.html`æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º

```
<script src="assets/phaser.min.js"></script>
```

ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°† phaser åŒ…å«åœ¨æ‚¨çš„ç»„ä»¶`.ts`æ–‡ä»¶ä¸­

```
declare var Phaser;
```

(è¦æ£€æŸ¥`Phaser`åŒ…å«ä»€ä¹ˆï¼Œè¯•ç€å®‰æ…°å˜é‡æˆ–ä¿å­˜åœ¨`this`ä¸­çš„å˜é‡`defaultState`ï¼Œä½ ä¼šå¯¹ Phaser çš„æ„å»ºæœ‰æ‰€äº†è§£ã€‚)

***# 2â€”â€”å¤æ‚çš„â€œæˆ‘æ˜¯ä¸€ä¸ªç¼–ç ç‹‚â€æ–¹å¼***

ä» phaser ä¸‹è½½ npm åŒ…

```
npm install phaser-ce
```

å‡†å¤‡ **webpack** æ¥ç¼–è¯‘ phaser åŒ…ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥åœ¨ã€‚ts æ–‡ä»¶ã€‚æ‚¨å¯èƒ½éœ€è¦ä¸ºæ­¤å‡†å¤‡è‡ªå·±çš„ webpack-config å¹¶å®‰è£…é¢å¤–çš„æ¨¡å—ã€‚æ­¤åï¼Œæ‚¨å¯ä»¥å°†å˜é‡å¯¼å…¥ä¸º

```
import "pixi";
import "p2";
import * as Phaser from "phaser-ce";
```

è¿™é‡Œç»™å‡ºäº†ç»†èŠ‚(ä¸Šæ¬¡æˆ‘è¯•è¿‡ï¼Œè¿™ç§æ–¹æ³•åœ¨ç¦»å­ä¸Šæœ‰å„ç§å„æ ·çš„é”™è¯¯ï¼Œæ‰€ä»¥æˆ‘å°†åšæŒä½¿ç”¨æ–¹æ³•#1)

# æ­¥éª¤ 3 â€”åœ¨åº”ç”¨ç¨‹åºä¸­é›†æˆç”µå®¹

ç”µå®¹å™¨ä¹Ÿå¯ä»¥è¿æ¥åˆ°ç°æœ‰çš„ç¦»å­ appã€‚è¦å°†ç”µå®¹å™¨è¿æ¥åˆ°æ‚¨ç°æœ‰çš„ Ionic åº”ç”¨ç¨‹åºï¼Œè¿è¡Œ

```
$ ionic integrations enable capacitor
```

è¿™å°†é™„åŠ ç”µå®¹å™¨åˆ°ä½ çš„ç¦»å­åº”ç”¨ç¨‹åºã€‚åœ¨è¿™ä¹‹åï¼Œä½ å¿…é¡»`init`ç”µå®¹å™¨åº”ç”¨ç¨‹åº

```
$ npx cap init YOUR_APP_NAME YOUR_APP_ID
```

# æ­¥éª¤ 4:å®ç° Phaser æ¸¸æˆ

> **ä½ å¯ä»¥åœ¨** [**ä¸­æ‰¾åˆ°å®Œæ•´çš„ä»£ç **](https://store.enappd.com/product/ionic-phaser-game-framework-ionic-4/)**ã€ZMB _ ç”µå®¹æ”¯è·¯ã€‘**

å‡ºäºç¤ºä¾‹ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªç®€å•çš„[ç›¸ä½å™¨ç¤ºä¾‹](https://phaser.io/examples/v2/animation/animation-events)ï¼Œæˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ª**åƒµå°¸**è¡Œèµ°ã€‚

æˆ‘ä»¬å°†å…³æ³¨å¯åŠ¨å™¨é™„å¸¦çš„`home`ç»„ä»¶ã€‚æ‰€ä»¥æ‰€æœ‰ç›¸å…³çš„ javascript ä»£ç éƒ½å°†æ”¾åœ¨`home.page.ts`æ–‡ä»¶ä¸­ã€‚ç”¨ä»¥ä¸‹å†…å®¹æ›¿æ¢`home.page.html`æ–‡ä»¶ä¸­çš„å…¨éƒ¨å†…å®¹

```
<ion-content>
  <div id="phaser-example"></div>
</ion-content>
```

æˆ‘ä»¬å°†è¯†åˆ« javascript é€»è¾‘ä¸­çš„`phaser-example`,å¹¶åœ¨è¿™ä¸ª div ä¸­å®ä¾‹åŒ–æ¸¸æˆã€‚

ä¸€ä¸ªåŸºæœ¬çš„ Phaser æ¸¸æˆæœ‰ä¸‰ä¸ªé»˜è®¤å‡½æ•°â€”â€”preload()ã€create()å’Œ update()

## é¢„è½½()

é¡¾åæ€ä¹‰ï¼Œé¢„è½½èµ„äº§ç­‰ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å°†åŠ è½½åƒµå°¸å’ŒèƒŒæ™¯å›¾åƒã€‚

```
preload() {this.game.load.image('lazur', 'assets/thorn_lazur.png');this.game.load.spritesheet('mummy', 'assets/metalslug_mummy37x45.png', 37, 45, 18);}
```

## åˆ›å»º()

åˆ›å»ºæ¸¸æˆå®ä¾‹å¹¶åŠ è½½æ¸¸æˆçŠ¶æ€ã€‚åœ¨æˆ‘ä»¬çš„æ¸¸æˆä¸­ï¼Œè¿™ä¸ªå‡½æ•°å°†è®¾ç½®åœºæ™¯ä¸­çš„å›¾åƒã€‚æˆ‘ä»¬è¿˜å°†åœ¨è¿™é‡Œåˆ›å»ºå’Œè®¾ç½®åŠ¨ç”»ç›‘å¬å™¨ã€‚

```
create() {// Set backgroundthis.back = this.game.add.image(0, -400, 'lazur');this.back.scale.set(2);this.back.smoothed = false;// Set mummy from a spritethis.mummy = this.game.add.sprite(200, 360, 'mummy', 5);this.mummy.scale.set(4);this.mummy.smoothed = false;// Set mummy animationthis.anim = this.mummy.animations.add('walk');this.anim.onStart.add(that.animationStarted, this);this.anim.onLoop.add(that.animationLooped, this);this.anim.onComplete.add(that.animationStopped, this);this.anim.play(10, true);}
```

## æ›´æ–°()

æ›´æ–°å¾ªç¯ï¼ŒåŠ¨ä½œï¼Œç‰©ç†äº’åŠ¨ç­‰æ¸¸æˆçŠ¶æ€ã€‚å¯¹äºæˆ‘ä»¬çš„æ¸¸æˆï¼Œè¿™å°†é€šè¿‡ç§»åŠ¨èƒŒæ™¯æ¥æ›´æ–°åŠ¨ç”»ï¼Œä»¥åˆ›å»ºâ€œè¡Œèµ°â€çš„æ•ˆæœ

```
update() {if (this.anim.isPlaying) { this.back.x -= 1;}}
```

è¿˜æœ‰ Tadaï¼ï¼ï¼ğŸ‰ ğŸ‰ğŸ‰æˆ‘ä»¬åœ¨*å‘çƒ*çª—å£è¿è¡Œæˆ‘ä»¬çš„æ¸¸æˆ

![](img/9904dcfcee82b7accfdf7e6d161cb5d5.png)

Basic Phaser game in Capacitor browser app

åŒæ ·ï¼Œä½ å¯ä»¥ç”¨ Ionic è¿è¡Œä»»ä½•ç›¸ä½å™¨æ¸¸æˆã€‚ç›¸ä¿¡æˆ‘ï¼ŒPhaser ä¸­æœ‰ä¸€äº›çœ‹èµ·æ¥ä¸å¯æ€è®®çš„[æ¸¸æˆã€‚ä¸ä¹…å‰æˆ‘ä»¬åšäº†ä¸€ä¸ªé©¬é‡Œå¥¥å¤åˆ¶å“ï¼Œè¿˜æœ‰ä¸€ä¸ªå¤ªç©ºå…¥ä¾µè€…ï¼](https://phaser.io/examples)

**â­ï¸ï¸ï¸ï¸â­ï¸ï¸ï¸ï¸â­ï¸ï¸ï¸ï¸importantï¸ï¸â­ï¸ï¸ï¸ï¸â­ï¸ï¸ï¸ï¸â­ï¸ï¸ï¸ï¸**

Phaser çš„å®ç°å¯èƒ½ä¼šè®©æ‚¨ä¸`this`çš„å®ç°æ··æ·†ã€‚ç®€è€Œè¨€ä¹‹ï¼Œä¸€æ—¦ç›¸ä½å™¨åœºæ™¯è¢«åˆå§‹åŒ–ï¼Œ`this`å°±åŒ…å«äº†é»˜è®¤çš„æ¸¸æˆçŠ¶æ€ã€‚ä½œä¸ºä¸€å Ionic å¼€å‘äººå‘˜ï¼Œæˆ–è€…å¦‚æœæ‚¨éµå¾ª Ionic æ–‡æ¡£ï¼Œæ‚¨å°†ä½¿ç”¨`this`æ¥å¼•ç”¨ç»„ä»¶çš„ç±»ã€‚æ‰€ä»¥ä½ æœ€ç»ˆä½¿ç”¨äº†å†²çªçš„`this`ã€‚ä¸ºäº†å¿«é€Ÿè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å°†ç¦»å­`this`åˆ†é…ç»™å¦ä¸€ä¸ªå˜é‡`that`(ğŸ˜…)ç„¶åç”¨å®ƒæŒ‡å‘ç±»å‡½æ•°ã€‚

å¸¸è§çš„é”™è¯¯æ˜¯å£°æ˜`that = this`ã€‚æ˜¯çš„ï¼Œå®ƒç¡®å®é€šè¿‡`that`å¼•ç”¨`this`ï¼Œä½†æ˜¯ä¸€æ—¦`this`æ”¹å˜ï¼Œ`that`ä¹Ÿä¼šæ”¹å˜ï¼Œå› æ­¤è¿™æ ·åšæ²¡æœ‰æ„ä¹‰ã€‚ä½ å¯ä»¥ä½¿ç”¨`that = Object.assign({},this)`ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ ‡å‡†ä»£ç ã€‚ä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œè¿™ä¹Ÿä¸ä¼šå¯¼è‡´æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚å› ä¸ºåœ¨ Ionic `this`ä¸­åŒ…å«äº†`_prototype`å†…éƒ¨çš„ç±»**å‡½æ•°ï¼Œè¦å°†è¿™äº›å‡½æ•°å¤åˆ¶åˆ°`that`ä¸­ï¼Œæ‚¨åº”è¯¥è¿™æ ·å®šä¹‰å®ƒ**

```
that = Object.create(this.constructor.prototype);
```

ç„¶åç”¨`that`ä»£æ›¿`this`è°ƒç”¨å‡½æ•°

ä¾‹å¦‚`that.animationStarted`æŒ‡å‘ä¸€ä¸ªå‡½æ•°`animationStarted`ã€‚åœ¨è¿™é‡Œä½¿ç”¨`this`ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º`create()`å‡½æ•°æ˜¯ä¸€ä¸ªç›¸ä½å™¨é»˜è®¤å€¼ï¼Œå¹¶ä¸”åœ¨`this`ä¸­åŒ…å«åœºæ™¯çš„é»˜è®¤çŠ¶æ€

å¦‚æœä½ å¯¹`this`æ¦‚å¿µä¸å¤ªé€‚åº”ï¼Œä½ å¯ä»¥åœ¨[è¿™é‡Œ](https://code.tutsplus.com/tutorials/fully-understanding-the-codethiscode-keyword--net-21117)äº†è§£æ›´å¤šã€‚

(ä½œä¸ºå¦ä¸€ä¸ªå˜é€šåŠæ³•ï¼Œæ‚¨å¯ä»¥å°†å®Œæ•´çš„ javascript ä»£ç æ”¾åœ¨ Ionic çš„ç±»å®ç°ä¹‹å¤–ï¼Œæˆ–è€…æ›´ç³Ÿï¼Œæ”¾åœ¨`index.html`çš„`<script></script>`æ ‡ç­¾ä¸­ï¼Œä½†è¿™å¤ªéº»çƒ¦äº†ã€‚ä½ å°†æ— æ³•ç”¨è¿™ç§æ–¹å¼ç¼–å†™åºå¤§çš„æ¸¸æˆä»£ç )

# ç¬¬äº”æ­¥:å°†æ¸¸æˆåˆ¶ä½œæˆæ‰‹æœºåº”ç”¨

ä½¿ç”¨ Phaser æ„å»ºç”µå®¹å™¨åº”ç”¨ç¨‹åºä¸æ„å»ºå¸¸è§„ç”µå®¹å™¨åº”ç”¨ç¨‹åºå®Œå…¨ç›¸åŒã€‚å¯¹äºé‚£äº›ä¸ç†Ÿæ‚‰ Ionic 4 æµç¨‹çš„äººï¼Œé¦–å…ˆæ„å»º ionic web èµ„äº§

```
$ ionic build
```

ç„¶åï¼Œä½¿ç”¨ä»¥ä¸‹ä»»æ„å‘½ä»¤å‘åº”ç”¨ç¨‹åºæ·»åŠ å¹³å°

```
$ npx cap add android
$ npx cap add ios
```

æ·»åŠ å¹³å°åï¼Œæ‚¨å¯ä»¥æ‰“å¼€è¯¥å¹³å°çš„æœ¬æœº IDEï¼Œå¹¶åœ¨è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œåº”ç”¨ç¨‹åºã€‚

```
$ npx cap open android // opens Android Studio
$ npx cap open ios // opens Xcode
```

æ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨`window.innerWidth`å’Œ`window.innerHeight`æ ¹æ®è®¾å¤‡å°ºå¯¸è°ƒæ•´`canvas`çš„å°ºå¯¸ã€‚æœ‰äº†è¿™ä¸ªï¼Œä½ å¯ä»¥ä¸ºæ‰€æœ‰çš„ç§»åŠ¨è®¾å¤‡å°ºå¯¸è°ƒæ•´æ¸¸æˆç”»å¸ƒã€‚

![](img/05751dba45604b314317aaa4b5a5feca.png)

Zombie walking â€” Phaser game in Ionic Capacitor, running in Android device

ç»è¿‡è¿™äº›è°ƒæ•´ï¼Œæ¸¸æˆçœ‹èµ·æ¥å¦‚ä¸Šã€‚ä¸é”™å§ã€‚ğŸ‘»

é…·çš„æ˜¯ï¼Œä½ ä»ç„¶å¯ä»¥åƒç§»åŠ¨åº”ç”¨ç¨‹åºä¸€æ ·æ‹¥æœ‰**ä¾§èœå•**æˆ–**æ ‡ç­¾**ï¼Œå¹¶åœ¨æ¸¸æˆä¸­åŠ å…¥åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å¸¸è§„åŠŸèƒ½(åä¹‹äº¦ç„¶)ï¼Œå¦‚ç™»å½•ã€æ³¨å†Œç­‰ã€‚åˆ©ç”¨ç¦»å­æ’ä»¶ã€‚

## å¤ªç©ºå…¥ä¾µè€…ï¼Ÿ

æƒ³åœ¨çˆ±å¥¥å°¼äºšåˆ¶ä½œè‡ªå·±çš„ PUBG æˆ–å¤ªç©ºå…¥ä¾µè€…æ¸¸æˆå—ï¼Ÿæˆ‘ä»¬æœ‰ä¸œè¥¿ç»™ä½ ï¼æˆ‘ä»¬åœ¨ç¦»å­ç”µå®¹ Github repoâ€”[**Ionic-4-phaser**](https://github.com/enappd/Ionic4-phaser)**(SI _ Capacitor branch)**ä¸­åŠ å…¥äº†å¤ªç©ºå…¥ä¾µè€…æ¸¸æˆ

![](img/f523db924d8520bd35f30202e515801f.png)

Space Invaders in Ionic + Phaser â€” Using Capacitor in Browser

ä»å›è´­çš„`SI_capacitor`åˆ†æ”¯è¿è¡Œä»£ç ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªå¾ˆé…·çš„å¤ªç©ºå…¥ä¾µè€…æ¸¸æˆ appï¼åœ¨ Android è®¾å¤‡ä¸Šçœ‹èµ·æ¥åƒè¿™æ ·

![](img/531336f6fa53bb15c4d91b88df5a8c1e.png)

Space Invaders in Ionic + Phaser â€” Using Capacitor in Android

# ç»“è®º

Ionic åœ¨åˆ¶ä½œç§»åŠ¨åº”ç”¨ç¨‹åºæ–¹é¢é€Ÿåº¦è¶…å¿«ï¼Œè€Œ Phaser åˆ™éå¸¸é€‚åˆåˆ¶ä½œ 2D HTML5 æ¸¸æˆã€‚Capacitor æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œå¯ä»¥å°† web åº”ç”¨ç¨‹åºå®¹å™¨åŒ–ï¼Œåœ¨å„ç§å¹³å°ä¸Šè¿è¡Œã€‚ç»“åˆç¦»å­ï¼Œç”µå®¹å’Œç›¸ä½å™¨ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€äº›å¾ˆé…·çš„æ¸¸æˆåº”ç”¨ã€‚ä½ ä¹Ÿå¯ä»¥å°†æ¸¸æˆåŒ…å«åœ¨ä¸€ä¸ªå¸¸è§„çš„ Ionic Capacitor åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä½¿å¾—å®ƒæ›´åŠ é€šç”¨ã€‚

> **æœ¬æ•™ç¨‹å®Œæ•´æºä»£ç åœ¨ Github repoâ€”**[**Ionic-4-phaser**](https://github.com/enappd/Ionic4-phaser)**(ZMB _ ç”µå®¹åˆ†æ”¯&SI _ ç”µå®¹åˆ†æ”¯)**

*æœ¬æ–‡åŸè½½äº*[*ã€enappd.comã€‘*](https://enappd.com)