<html>
<head>
<title>Most Efficient Ways For Building PDFs Files With Backend and Frontend JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用后端和前端JavaScript构建pdf文件的最有效方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/most-efficient-ways-for-building-pdfs-files-with-backend-and-frontend-javascript-environment-68056f73257?source=collection_archive---------0-----------------------#2020-09-21">https://javascript.plainenglish.io/most-efficient-ways-for-building-pdfs-files-with-backend-and-frontend-javascript-environment-68056f73257?source=collection_archive---------0-----------------------#2020-09-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="4896" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">体验反馈</h2><div class=""/><div class=""><h2 id="009b" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">我研究了用JavaScript在前端(React)或后端(云函数、monoliths等)构建pdf，以及如何构建之后的一些观察。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/81ea2b6981e1eb58a5da87af6389440f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIqrFYdCQShrnW3Xwq3Hvw.png"/></div></div></figure><p id="3775" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">每个人在开发生涯的某一天都会面临构建pdf的需求。</p><p id="9952" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">PDF是Adobe制作的一种非常常见的格式，它是最佳的矢量格式。这意味着，无论您在哪里使用它，任何设备上的所有内容都将适当缩放，以显示为高清内容。</p><p id="a6aa" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">老实说，你必须知道，就当今工具的一个特性而言:<strong class="lc ja">在我看来，构建pdf可能是最难做的事情之一……</strong>根据需要，事情可能会变得非常复杂，如果你不能与客户就事情进行权衡，这将非常耗时或昂贵。</p><p id="7dcd" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但首先，让我们有一个大的图片:pdf可以分为两种:</p><ul class=""><li id="6b30" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated"><strong class="lc ja">简单的PDF: </strong>这些是显示文本、链接、重点和图像等基本资产，没有复杂的东西。他们的布局很普通。想象一篇简单的文章PDF，没有复杂的东西:你可以用markdown写然后导出为PDF。</li><li id="cbed" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><strong class="lc ja">复杂的PDF </strong>:需要元数据、防止书写的SSL加密、图表、章节摘要、目录、自动页码、混合横向和纵向页面。您可能还需要表单、表单填写、附件，甚至用编辑、融合、覆盖等功能合成PDF</li></ul><p id="258b" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">要解决这两个需求，主要有两种实现方法:</p><ul class=""><li id="9502" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated"><strong class="lc ja">有些PDF只是基于图像:</strong>整个PDF或某个部分是某个运行时UI的截图。这样，如果你放大它，他们会失去质量。这是一个处理PDF的拙劣技巧，但它适用于A4打印，因为大小是“固定的”。当有人扫描一本书的页面以使其在数字世界中可用时，您经常会看到这些类型的pdf。</li><li id="803c" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><strong class="lc ja">而最佳质量的pdf是基于矢量的</strong>，这意味着你可以放大或打印它，你会得到顶级的质量。这就是PDF通常应该有的样子。</li></ul><p id="442c" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">其中一些技术和库提供了灵活性和如此好的开发人员体验。它们往往受限于高级功能，如目录或SSL签名。</p><p id="adf7" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja"> ⚡️这篇文章是我的研究和观察的浓缩，它将介绍许多处理pdf的方法，并对每种方法进行利弊分析。它也对你们的观察开放，所以如果你们有任何意见，请随时联系我。</strong></p><p id="4e17" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">哦，还有最后一件事！您可以根据需要在前端或后端构建pdf，让我们来详细了解一下。</p><h1 id="9ae1" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">我应该在前端/客户端构建pdf吗？</h1><p id="bf4c" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">在前端构建pdf的过程只是使用网络浏览器来生成文件(或任何类型的前端客户端，如移动应用程序)。</p><p id="0abb" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">然后浏览器将显示它或触发BLOB(二进制大对象)的下载，而不进行任何网络请求。</p><p id="2d52" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja"> ✅使用前端PDF生成有多种好处:</strong></p><ul class=""><li id="69b2" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">它从您的服务器上节省资源，当您为大量用户生成大量pdf时，它尤其有用，而且非常频繁。</li><li id="ba20" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">它允许离线功能，例如渐进式网络应用。因此，您可以从任何地方导出pdf，即使是在飞机上，所有这些都不需要任何互联网连接。</li><li id="8fde" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">它是安全的，符合GDPR标准，因为您可以使用用户数据，而不必让它们在网络中传播，甚至不用让您的服务器知道。</li></ul><p id="3209" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja"> ❌，但它也有这个数量的缺点:</strong></p><ul class=""><li id="c6b4" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">由于代码位于前端，您对访问策略的控制更少，而且可能更难限制对某些功能的访问，比如对付费计划的访问。</li><li id="089d" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">您可能需要根据平台进行代码调整，因为并非每个浏览器的工作方式都相同，也不等同。有时某些功能可能只是在某些浏览器上缺乏支持。</li><li id="b61e" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">您需要一个后端，当然，您将每月为此付费。有些应用程序没有后端，如果仅仅为了这个用例而构建和托管一个应用程序，那将是可悲的。</li></ul><h2 id="46f3" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">用纯JavaScript编写PDF</h2><p id="bb32" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">首先，让我们看看在JavaScript中使用某种命令式编程的“经典方式”。</p><p id="2a79" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">为此，您可以在前端使用类似<a class="ae ns" href="https://pdfkit.org/" rel="noopener ugc nofollow" target="_blank">https://pdfkit.org/</a>的东西(但它也可以在后端工作，因为它是一个多态库，很好！).</p><p id="cb87" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">让我们来看一个你在<a class="ae ns" href="https://pdfkit.org/demo/out.pdf" rel="noopener ugc nofollow" target="_blank">https://pdfkit.org/demo/out.pdf</a>能取得什么成就的简单例子</p><p id="5fc3" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">下面的代码片段展示了编写文本、图像和SVG是多么容易。</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="ec80" class="nh ml iq nu b gy ny nz l oa ob">// create a document and pipe to a blob<br/>var doc = new PDFDocument();<br/>var stream = doc.pipe(blobStream());</span><span id="5a71" class="nh ml iq nu b gy oc nz l oa ob">// draw some text<br/>doc.fontSize(25).text('Here is some vector graphics...', 100, 80);</span><span id="26a6" class="nh ml iq nu b gy oc nz l oa ob">// some vector graphics<br/>doc<br/>  .save()<br/>  .moveTo(100, 150)<br/>  .lineTo(100, 250)<br/>  .lineTo(200, 250)<br/>  .fill('#FF3300');</span><span id="23d7" class="nh ml iq nu b gy oc nz l oa ob">doc.circle(280, 200, 50).fill('#6600FF');</span><span id="b53a" class="nh ml iq nu b gy oc nz l oa ob">// an SVG path<br/>doc<br/>  .scale(0.6)<br/>  .translate(470, 130)<br/>  .path('M 250,75 L 323,301 131,161 369,161 177,301 z')<br/>  .fill('red', 'even-odd')<br/>  .restore();</span><span id="b35e" class="nh ml iq nu b gy oc nz l oa ob">// and some justified text wrapped into columns<br/>doc<br/>  .text('And here is some wrapped text...', 100, 300)<br/>  .font('Times-Roman', 13)<br/>  .moveDown()<br/>  .text(lorem, {<br/>    width: 412,<br/>    align: 'justify',<br/>    indent: 30,<br/>    columns: 2,<br/>    height: 300,<br/>    ellipsis: true<br/>  });</span><span id="5236" class="nh ml iq nu b gy oc nz l oa ob">// end and display the document in the iframe to the right<br/>doc.end();<br/>stream.on('finish', function() {<br/>  iframe.src = stream.toBlobURL('application/pdf');<br/>});</span></pre><p id="11d4" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">好吧。太好了。这只是对命令式指令进行排序的问题，仅此而已，是一种低级API。您需要定制图表吗？您需要使用SVG和类似<a class="ae ns" href="https://d3js.org/" rel="noopener ugc nofollow" target="_blank"> d3-js </a>的东西自己制作。</p><p id="8449" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">由于这是必不可少的，尤其是在API较低的情况下，要达到预期的最终结果可能需要一些时间，并且可能需要大量的代码。您可能需要使用向量进行一些2D建模来绘制您需要的东西，而该工具对此没有任何帮助。</p><p id="7494" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果您正在使用React JS，那么您可以使用声明性包装器来实现类似的功能，该包装器提供了更高层的组件。</p><h2 id="654d" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">使用ReactJS</h2><p id="feb4" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">反应上下文中最好的工具是<a class="ae ns" href="https://react-pdf.org/" rel="noopener ugc nofollow" target="_blank">https://react-pdf.org/</a>它允许您使用反应组件设计PDF，并使用某种CSS语言进行布局，这很棒。</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="5fbb" class="nh ml iq nu b gy ny nz l oa ob">import React from 'react';<br/>import { Page, Text, View, Document, StyleSheet } from '<a class="ae ns" href="http://twitter.com/react" rel="noopener ugc nofollow" target="_blank">@react</a>-pdf/renderer';</span><span id="2411" class="nh ml iq nu b gy oc nz l oa ob">// Create styles<br/>const styles = StyleSheet.create({<br/>  page: {<br/>    flexDirection: 'row',<br/>    backgroundColor: '#E4E4E4'<br/>  },<br/>  section: {<br/>    margin: 10,<br/>    padding: 10,<br/>    flexGrow: 1<br/>  }<br/>});</span><span id="741d" class="nh ml iq nu b gy oc nz l oa ob">// Create Document Component<br/>const MyDocument = () =&gt; (<br/>  &lt;Document&gt;<br/>    &lt;Page size="A4" style={styles.page}&gt;<br/>      &lt;View style={styles.section}&gt;<br/>        &lt;Text&gt;Section #1&lt;/Text&gt;<br/>      &lt;/View&gt;<br/>      &lt;View style={styles.section}&gt;<br/>        &lt;Text&gt;Section #2&lt;/Text&gt;<br/>      &lt;/View&gt;<br/>    &lt;/Page&gt;<br/>  &lt;/Document&gt;<br/>);</span></pre><p id="143c" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">好吧，这个好一点，非常简单，不是吗？它也更容易维护，因为它使用了一种JSX指令和组件，这是一个伟大的方式来分割我们的界面。</p><p id="fe7f" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但它也带来了同样的问题。它仍然是低层次的，也依赖于画布来满足特定的需求，如图表。同样，你需要一些外部库。</p><p id="c9bc" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">在引擎盖下react-pdf使用PDFKit。</p></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><p id="6563" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">对于JavaScript中的前端，我想基于PDFKit的工具是唯一可行的工具，但我可能缺少一些东西，如果你有更高级别的API和更好的支持，请随时联系我:)</p><p id="63f9" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">在那篇文章中，我们将在前端再看到一个，因为它也是一个跨平台工具:)</p><h1 id="055b" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">还是应该用NodeJS或者云功能在后端/服务器上构建pdf？</h1><p id="062c" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">在这种情况下，每一个逻辑都被委托给服务器，服务器将拥有渲染我们的PDF并将其发送到客户端应用程序的一切。</p><p id="cf2a" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja"> ✅使用后端PDF生成有各种好处:</strong></p><ul class=""><li id="e4cc" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">它提供了更多的制作pdf的能力，因为你可以依赖于其他语言的一些现有的二进制文件，专门用于pdf生成。</li><li id="77e4" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">你有更多的控制一切，如访问控制政策，因为它的服务器权限，你可以切断访问，如果用户没有支付，例如。</li><li id="9798" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">您可以使用第三方服务并控制对它的访问和使用。</li><li id="61f7" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">您可以确保结果在所有设备上都是相同的，因为您可以控制执行环境。使用后端时，通常要确保客户端平台之间的一致性。</li></ul><p id="9526" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja"> ❌但它也有这样的缺点:</strong></p><ul class=""><li id="9f70" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">作为主要的缺点，你需要在前端的互联网连接。</li><li id="d1f5" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">你需要一个每月花费一些的后端。您可能需要根据访问频率进行扩展的后端。</li><li id="9782" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">如果后端崩溃，功能也会崩溃，而在前端集成中，一切都还可以工作。</li><li id="be71" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">这也可能不太安全，因为您可能需要将用户信息发送到后端，而他还没有为其他目的收集这些信息。</li></ul><h2 id="0b20" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">为后端pdf生成选择合适的环境</h2><p id="258a" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">在后端构建pdf之前，您必须了解您的环境和附带的库。举个例子，你不能使用云函数环境中的所有东西，因为它可能缺少一些二进制文件。</p><ul class=""><li id="8261" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">我有Ubuntu Linux、CentOS甚至Windows服务器吗？</li><li id="2aef" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">我的代码是运行在一个准系统服务器上还是在一个云函数内部？</li><li id="1b77" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">我的RAM和处理器能力如何？</li></ul><p id="852b" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这里有一些你应该问自己的问题。考虑到这一点，在服务器端构建pdf有多种方法。</p><p id="d462" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">有些是关于HTML的，对于小用例非常有用。其他的是关于最基本的pdf客户端，对于复杂的用例来说更难，但也更有效。</p><p id="c165" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">你甚至可以依靠外部服务，比如SAAS软件。</p><h2 id="6c85" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">使用Puppeteer在后端生成pdf</h2><p id="1d9f" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">木偶戏应该是基于chromium浏览器的无头客户端，它是由谷歌工程师制作的。您正在编写驱动某些页面上的浏览器的代码，或者在浏览器中注入一些HTML，然后您可以与HTML文档进行交互。</p><p id="c01e" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">因此，您将使用浏览器的功能<code class="fe ok ol om nu b">save to PDF</code>,这样您所要做的就是设计一个专门用于打印的CSS页面或添加一个CSS打印纸。</p><p id="e43c" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">我们以这样的代码结束:</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="b359" class="nh ml iq nu b gy ny nz l oa ob">const chromium = require('chrome-aws-lambda');</span><span id="bd05" class="nh ml iq nu b gy oc nz l oa ob">exports.handler = async (req, res) =&gt; {<br/>  let result = null;<br/>  let browser = null;</span><span id="ae89" class="nh ml iq nu b gy oc nz l oa ob">try {<br/>    browser = await chromium.puppeteer.launch({<br/>      args: chromium.args,<br/>      defaultViewport: chromium.defaultViewport,<br/>      executablePath: await chromium.executablePath,<br/>      headless: chromium.headless,<br/>      ignoreHTTPSErrors: true,<br/>    });</span><span id="e986" class="nh ml iq nu b gy oc nz l oa ob">let page = await browser.newPage();</span><span id="43b7" class="nh ml iq nu b gy oc nz l oa ob">await page.goto('<a class="ae ns" href="https://example.com'" rel="noopener ugc nofollow" target="_blank">https://example.com'</a>);</span><span id="61e8" class="nh ml iq nu b gy oc nz l oa ob">const pdfBuffer = await page.pdf({ printBackground: true });</span><span id="e32e" class="nh ml iq nu b gy oc nz l oa ob">res.set("Content-Type", "application/pdf");<br/>  res.set("Content-Disposition", 'attachment; filename="My-report.pdf"');<br/>  res.status(200).send(pdfBuffer);<br/>  } catch (error) {<br/>    return res.status(500).send(error);<br/>  } finally {<br/>    if (browser !== null) {<br/>      await browser.close();<br/>    }<br/>  }<br/>};</span></pre><p id="21dc" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja">这很棒，但老实说，有点不太好。</strong></p><p id="51c2" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">说到困难，当您需要高级功能时，事情可能会变得更困难，例如在PDF中混合横向和纵向页面，使用目录，或将许多PDF合并在一起。</p><p id="a592" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">浏览器不应该是一个以pdf为中心的工具，它只是一个方便的功能，用于在源位置快速导出一些页面。我们将用户方便的特性劫持为服务器使用的大规模生产特性。</p><p id="7bbd" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">通过这样做，我们将自己暴露在一些奇怪的行为中。</p><p id="1f0b" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你选择继续这样做，看看<a class="ae ns" href="https://github.com/alixaxel/chrome-aws-lambda" rel="noopener ugc nofollow" target="_blank">https://github.com/alixaxel/chrome-aws-lambda</a>，这是一个库，它保证在云函数中工作，而纯木偶师可能不会…</p><p id="505f" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja">💡如果您运行时间很短，并且您的用例很简单，我会推荐这种方法，因为它很容易实现。</strong></p><h2 id="c814" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">使用GotenBerg和Docker生成pdf</h2><p id="48b7" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">以同样的方式，你有了tenberg，一个基于Docker的解决方案，作为一个自治的API服务器来处理pdf</p><div class="on oo gp gr op oq"><a href="https://thecodingmachine.github.io/gotenberg/" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ja gy z fp ov fr fs ow fu fw iz bi translated">降价</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">Gotenberg是一个Docker支持的无状态API，用于将HTML、Markdown和Office文档转换为PDF。HTML和…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">thecodingmachine.github.io</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe ky oq"/></div></div></a></div><p id="e073" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这是一个伟大的工具，你一定要看看它！</p><h2 id="a6c6" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">使用“PDF lib”库</h2><p id="910d" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">根据我的研究，这可能是最有希望处理pdf的库，因为它支持各种带有表单、元数据和覆盖的用例面板。</p><p id="2e36" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ja">🎉哦，是的，我在这里谈论它，但它是跨平台的</strong></p><p id="b078" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">用TypeScript编写，编译成纯JavaScript，没有原生依赖。适用于任何JavaScript运行时，包括浏览器、Node、Deno，甚至React Native。</p><div class="on oo gp gr op oq"><a href="https://pdf-lib.js.org/" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ja gy z fp ov fr fs ow fu fw iz bi translated">在任何JavaScript环境中创建和修改PDF文档。</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">在任何JavaScript环境中创建和修改PDF文档。</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">在任何JavaScript environment.pdf-lib.js.org中创建和修改PDF文档</p></div></div></div></a></div><p id="0dae" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">使用合并，我们可以通过合并两个不同的pdf在一个文档上使用不同的方向。您可以把这个库想象成PDFKit，但是有一些额外的实现，以避免在第一个用例中使用Canva。</p><p id="6c7a" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">⚡️:这真的是一个很棒的工具，我想它是目前免费开源解决方案的赢家，值得一提的是它是跨平台的。</p><h2 id="9e36" class="nh ml iq bd mm ni nj dn mq nk nl dp mu lj nm nn mw ln no np my lr nq nr na iw bi translated">使用第三方服务在NodeJS上生成pdf</h2><p id="c667" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">本文的最后一个是SAAS，问题是SAAS在大多数情况下是昂贵的，因为你要为集成花费时间。</p><p id="afda" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">SAAS也有一个问题，即您与外部服务紧密耦合，并且您依赖于他们可能变化的策略和价格变化。</p><p id="b7fa" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是SAAS通常很容易实现，而且安全可靠，因为他们的团队正在开发它，而且可能只使用了很多测试工具。如果发现任何问题，他们也会提供帮助。</p><p id="8615" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">以下是一些看起来很有前景的工具:</p><ul class=""><li id="0bf4" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">【https://pdfgeneratorapi.com/ T2】号</li><li id="2a6c" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">https://docraptor.com/<a class="ae ns" href="https://docraptor.com/" rel="noopener ugc nofollow" target="_blank">(基于HTML，但具有混合布局等强大功能)</a></li><li id="e7ca" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><a class="ae ns" href="https://www.docmosis.com/" rel="noopener ugc nofollow" target="_blank">https://www.docmosis.com/</a></li></ul><p id="66c2" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你能负担得起，这可能是一个很好的解决方案！</p><h1 id="a9a6" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">外卖食品</h1><p id="7bd1" class="pw-post-body-paragraph la lb iq lc b ld nc ka lf lg nd kd li lj ne ll lm ln nf lp lq lr ng lt lu lv ij bi translated">考虑你的需求以及你能在多大程度上做出权衡。思考基本问题:</p><ul class=""><li id="d66b" class="lw lx iq lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">它需要离线工作吗？</li><li id="5c9c" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">我的PDF文件有多复杂？</li><li id="fd33" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">我有后端吗，是服务器还是云功能？</li><li id="d2c4" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">我有多少时间做那个？</li><li id="ddac" class="lw lx iq lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">在项目中引入第三方服务可以付费吗？</li></ul><p id="a7d7" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">考虑到这一点，您可以选择是服务器端还是客户端。然后，您可以使用一些技术，如木偶戏或定制实现。如果你赚了很多钱，你甚至可以把责任转移给一个外部服务来负责。</p></div><div class="ab cl od oe hu of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ij ik il im in"><p id="53a7" class="pw-post-body-paragraph la lb iq lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae ns" href="https://codingspark.io?referral=medium" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ja"> 🇫🇷如果你是法国人🥖？</strong>我也建议⚡️ <strong class="lc ja">编码火花</strong>并以简讯技术的形式接收内容技术的酬金！</a></p></div></div>    
</body>
</html>