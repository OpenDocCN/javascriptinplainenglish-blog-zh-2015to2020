<html>
<head>
<title>How to Deploy Your JavaScript Web Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何部署您的JavaScript Web应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-deploy-your-javascript-application-e907251c6af1?source=collection_archive---------2-----------------------#2020-08-28">https://javascript.plainenglish.io/how-to-deploy-your-javascript-application-e907251c6af1?source=collection_archive---------2-----------------------#2020-08-28</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0665" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在不到30分钟的时间内部署您的JavaScript web应用程序</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/657497b80b4331dfc7243e2584ab7779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKDNvL6XMQkI_55M7WaImA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@clark_fransa" rel="noopener ugc nofollow" target="_blank">clark_fransa</a> on <a class="ae ks" href="https://unsplash.com/photos/f77Bh3inUpE" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4f5c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您是否刚刚完成了您的第一个JavaScript应用程序，现在想知道“如何让我的应用程序上线？”在本教程中，我们将通过使用<a class="ae ks" href="https://git-scm.com/" rel="noopener ugc nofollow" target="_blank"> Git </a>、<a class="ae ks" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>、<a class="ae ks" href="https://npmjs.com/" rel="noopener ugc nofollow" target="_blank">节点包管理器</a> (NPM)和<a class="ae ks" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>，以最快最简单的方式将您的JavaScript应用程序部署到<a class="ae ks" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>上。</p><p id="7e3c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Heroku是一个基于云的平台，为web开发人员管理和部署他们的项目提供了一个免费的计划。为了利用他们的服务，我们必须<a class="ae ks" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">注册</a>。</p><h2 id="1f64" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">0.先决条件</h2><p id="62b3" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">在我们开始之前，请通过在您的终端中运行以下命令来验证是否安装了Git、Node和NPM:</p><p id="5ec5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">* <code class="fe mn mo mp mq b">$</code>表示在您的终端中运行命令。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="91f7" class="lp lq in mq b gy mv mw l mx my">$ <!-- -->node --version</span></pre><p id="1c1d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果Node没有安装，请在此下载它<a class="ae ks" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="bcc1" class="lp lq in mq b gy mv mw l mx my">$ npm --version</span></pre><p id="0e9b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">NPM通常与节点一起安装。但是，如果您的系统上没有安装NPM，请尝试重新安装更新版本的Node。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="7278" class="lp lq in mq b gy mv mw l mx my">$ git --version</span></pre><p id="3cb5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果没有安装Git，请在这里下载它<a class="ae ks" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">。安装Git后，让我们为应用程序初始化一个本地存储库。</a></p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="5182" class="lp lq in mq b gy mv mw l mx my">$ git init</span></pre><h2 id="22c3" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">1.安装Heroku CLI</h2><p id="b59d" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">一旦我们注册了Heroku并安装了所有的先决条件，安装Heroku CLI并通过您的终端登录。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="8fd4" class="lp lq in mq b gy mv mw l mx my">$ heroku login</span></pre><h2 id="da03" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">2.在应用程序目录中初始化package.json</h2><p id="e302" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">如果您的根应用程序目录中已经有一个<em class="mz"> package.json </em>文件，您可以跳到第3步。</p><p id="0e24" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">否则，在您的根应用程序目录中，运行下面的命令来初始化一个<em class="mz"> package.json </em>文件。这个文件作为一个标识符(就像您的应用程序的ID卡)，NPM需要它来知道为您的应用程序安装哪些依赖项。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="7d57" class="lp lq in mq b gy mv mw l mx my">$ npm init</span></pre><p id="b48c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">运行该命令后，将提示您一系列问题，这些问题将使用您的答案中的元数据自动填充您的<em class="mz"> package.json </em>文件。您现在可以按下<code class="fe mn mo mp mq b">enter</code>跳过这些问题，因为您稍后可以编辑该文件。</p><h2 id="709f" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">3.安装Express</h2><p id="65e2" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">接下来，我们将使用名为<a class="ae ks" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>的Node.js web应用程序框架来设置我们的服务器。要安装Express，我们需要运行以下命令:</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="d7af" class="lp lq in mq b gy mv mw l mx my">$ npm install --save express</span></pre><p id="8301" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用NPM，这将有助于我们将快速模块所需的文件下载并安装到应用程序目录中。<code class="fe mn mo mp mq b">--save</code>标志还将在我们的<em class="mz"> package.json </em>文件中将Express列为依赖项。</p><h2 id="6644" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">4.<strong class="ak">设置快速服务器</strong></h2><p id="a99f" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">创建一个<em class="mz"> server.js </em>文件。当我们在Heroku上部署应用程序时，这将作为我们的初始化脚本。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="2fc4" class="lp lq in mq b gy mv mw l mx my">$ touch server.js</span></pre><p id="c529" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">接下来打开<em class="mz"> server.js </em>文件并保存以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><p id="83be" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这到底是什么意思？让我们再深入一点。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="7905" class="lp lq in mq b gy mv mw l mx my">const express = require('express');<br/>const app = express();<br/>const path = require('path');</span></pre><p id="779f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了让我们的<em class="mz"> server.js </em>脚本使用Express，我们需要通过初始化<code class="fe mn mo mp mq b">const express = require('express')</code>来请求Express模块。</p><p id="44fa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面的代码行<code class="fe mn mo mp mq b">const app = express()</code>用一个新的Express对象初始化<em class="mz"> app </em>变量。这将允许我们使用Express模块提供的方法。</p><p id="96a0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将使用的另一个模块是Node提供的<a class="ae ks" href="https://nodejs.org/api/path.html" rel="noopener ugc nofollow" target="_blank"> Path </a>模块，我们可以通过<code class="fe mn mo mp mq b">const path = require('path')</code>访问它。这将为我们提供一组在处理路径目录时可以使用的方法。在我们的例子中，我们将主要使用<code class="fe mn mo mp mq b">path.join(...)</code>。</p></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="8339" class="lp lq in mq b gy mv mw l mx my">app.use(express.static(path.join(__dirname)));</span></pre><p id="e75b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">每当请求(GET、POST、PATCH、DELETE)被发送到触发回调函数的<em class="mz">路径</em>时，就会调用<code class="fe mn mo mp mq b">app.use(path, callback)</code>。简单地说，想象一个事件监听器被放置在带有回调函数的指定路径上。然而；如果一个<em class="mz">路径</em>是<strong class="kv io">而不是</strong>指定的，则<em class="mz">回调</em>将在每个请求上触发，而不考虑路径。由于我们目前没有设置路径，我们的回调函数<code class="fe mn mo mp mq b">express.static(...)</code>将在我们的站点收到每个请求时触发。</p><p id="9d02" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe mn mo mp mq b">express.static(...)</code>是一个中间件功能，它允许我们公开一个目录或文件供公众使用。在我们的例子中，我们已经将<code class="fe mn mo mp mq b">path.join(__dirname)</code>作为中间件函数的参数传入，其中<code class="fe mn mo mp mq b">__dirname</code>表示应用程序的根目录。这意味着当客户端的浏览器执行请求时，我们的根应用程序目录中的每个目录和文件都可以被客户端访问。</p><p id="59dc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不要惊慌！请记住，每次客户访问我们的网站时，他们的浏览器都会执行一个GET请求。反过来，我们的服务器应该发回一个响应以及组成基本web应用程序的<em class="mz"> html </em>、<em class="mz"> css </em>和<em class="mz"> js </em>文件。如果我们想只允许某个目录被公开访问，我们可以传入<code class="fe mn mo mp mq b">path.join(__dirname, '<em class="mz">[name of the directory]</em>')</code>来代替。随着我们的web应用程序在方式上变得越来越复杂，我们可能希望隐藏某些可能包含API密钥、秘密等的文件。通过限制哪些文件可以公开访问。</p></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="83e0" class="lp lq in mq b gy mv mw l mx my">app.get('/', function (req, res) {<br/>  res.sendFile(path.join(__dirname, 'index.html'));<br/>});</span></pre><p id="b218" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这里是我们设定路线的地方。在<code class="fe mn mo mp mq b">app.get(path, callback)</code>函数中，当对指定路径发出GET请求时，回调被触发。在我们的例子中，我们目前有一条到<code class="fe mn mo mp mq b">'/’</code>的路由，在这条路由中，我们将<em class="mz">index.html</em>发送回客户端。只要我们的<code class="fe mn mo mp mq b">app.use(express.static(...))</code>允许我们的<em class="mz"> css </em>和<em class="mz"> js </em>文件被公开使用，客户端浏览器也将能够接收这些文件供使用。目前，这足以让我们的网站开始运行。</p></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="c45e" class="lp lq in mq b gy mv mw l mx my">app.listen(process.env.PORT || 3000);</span></pre><p id="5573" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这一行告诉我们的web应用程序监听哪个端口。当我们部署我们的web应用程序时，Heroku将为服务器设置一个默认的端口值，该值将被标记为<code class="fe mn mo mp mq b">process.env.PORT</code>。如果没有提供端口，我们的web应用程序将默认使用端口3000。</p><p id="31a3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了快速测试这一点，我们可以在浏览器中运行<code class="fe mn mo mp mq b">$ node server.js</code>并转到<code class="fe mn mo mp mq b"><a class="ae ks" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>。一旦一切正常，在你的终端上按<code class="fe mn mo mp mq b">Ctrl + C</code>关闭本地服务器。</p><h2 id="46a3" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak"> 4。配置package.json </strong></h2><p id="27fb" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">一旦我们配置好了我们的<em class="mz"> server.js </em>，我们就必须为Heroku设置指令，以便在部署时运行我们的服务器。在您的<em class="mz"> package.json </em>文件中的<em class="mz">脚本</em>下添加<code class="fe mn mo mp mq b">"start": "node server.js"</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="aebe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Heroku将自动寻找<em class="mz"> start </em>脚本并在部署时执行它。</p><h2 id="4c89" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">5.使用Git提交所有更改</h2><p id="fc34" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">现在我们已经配置了所有需要的文件，运行下面的命令来提交我们的更改。首先，我们需要进行变革。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="5b90" class="lp lq in mq b gy mv mw l mx my">$ git add .</span></pre><p id="83cf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个命令会将我们所有的文件添加到临时区域。接下来，我们需要提交更改。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="ebe1" class="lp lq in mq b gy mv mw l mx my">$ git commit -m '[type some detailed message here]' </span></pre><p id="4861" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">提交您的更改后，我们终于可以部署我们的应用程序了！</p><h2 id="49a2" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">6.将我们的应用程序部署到Heroku</h2><p id="cdc3" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">运行以下命令，并将[]替换为应用程序的名称。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="fb47" class="lp lq in mq b gy mv mw l mx my">$ heroku create [name of your app]</span></pre><p id="3ffb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这将初始化Heroku网站上的一个应用程序，并将Heroku设置为您的<em class="mz">中的一个远程存储库。git </em>文件。完成后，让我们将本地存储库推送到远程Heroku存储库。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="8942" class="lp lq in mq b gy mv mw l mx my">$ git push heroku master</span></pre><p id="5dd0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦我们的web应用程序被成功推送到远程存储库，Heroku将自动运行我们之前在<em class="mz"> package.json </em>文件中定义的<code class="fe mn mo mp mq b">npm start</code>脚本。接下来，这将运行<code class="fe mn mo mp mq b">node server.js</code>并启动我们的服务器！如果一切顺利，我们将返回到我们的web应用程序的URL！</p><p id="0460" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">祝你好运，编码快乐！</p><h2 id="0b4f" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">资源</h2><ul class=""><li id="a9ae" class="nj nk in kv b kw mi kz mj lc nl lg nm lk nn lo no np nq nr bi translated"><a class="ae ks" href="https://devcenter.heroku.com/articles/getting-started-with-nodejs?singlepage=true#provision-a-database" rel="noopener ugc nofollow" target="_blank">使用Node.js开始使用Heroku</a></li><li id="a302" class="nj nk in kv b kw ns kz nt lc nu lg nv lk nw lo no np nq nr bi translated"><a class="ae ks" href="https://nodejs.org/docs/latest-v13.x/api/path.html" rel="noopener ugc nofollow" target="_blank"> Node.js路径文档</a></li><li id="e825" class="nj nk in kv b kw ns kz nt lc nu lg nv lk nw lo no np nq nr bi translated"><a class="ae ks" href="https://docs.npmjs.com/about-npm/" rel="noopener ugc nofollow" target="_blank">关于节点包管理器</a></li><li id="a90b" class="nj nk in kv b kw ns kz nt lc nu lg nv lk nw lo no np nq nr bi translated"><a class="ae ks" href="https://git-scm.com/about" rel="noopener ugc nofollow" target="_blank">关于Git </a></li><li id="045e" class="nj nk in kv b kw ns kz nt lc nu lg nv lk nw lo no np nq nr bi translated"><a class="ae ks" href="https://expressjs.com/en/guide/using-middleware.html" rel="noopener ugc nofollow" target="_blank">使用ExpressJS中间件</a></li><li id="641a" class="nj nk in kv b kw ns kz nt lc nu lg nv lk nw lo no np nq nr bi translated"><a class="ae ks" href="https://www.tutorialspoint.com/expressjs/expressjs_static_files.htm" rel="noopener ugc nofollow" target="_blank"> ExpressJS -服务静态文件</a></li></ul></div></div>    
</body>
</html>