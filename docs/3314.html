<html>
<head>
<title>4 Key Principles to Writing Readable and Efficient JavaScript Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写可读且高效的JavaScript代码的4个关键原则</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/4-key-principles-to-writing-readable-and-efficient-javascript-code-1d022b685b3f?source=collection_archive---------2-----------------------#2020-09-18">https://javascript.plainenglish.io/4-key-principles-to-writing-readable-and-efficient-javascript-code-1d022b685b3f?source=collection_archive---------2-----------------------#2020-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1f26" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">清理你的代码，提高你的薪水</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5fc0d314ed9147159a981353a1974d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rJ4a1wIpzWwZFk2r"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@ikukevk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kevin Ku</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6a63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JavaScript是一种非常灵活的编程语言，您可以用许多不同的方式来实现您的需求。但是遵循一些原则和技巧可以让你的代码更具可读性和效率。</p><h1 id="1530" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.以强类型语言的风格编写代码</h1><p id="b008" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">JavaScript是一种弱类型编程语言，其中一个变量在语法上可以有不同类型的值。但是为了提高编译性能并使您的代码更容易被其他程序员阅读，建议您以强类型的风格编写代码。</p><h2 id="75e3" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">定义变量时，应该指定数据类型</h2><p id="40c3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/2b2a6feb016435777537314312021531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*pCZSdPx0u0H_tSycPPK8TQ.png"/></div></figure><p id="3b79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面代码中的变量缺少类型信息，这使得其他程序员很难理解代码或者JavaScript解释器很难优化。</p><p id="ff29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/a6e5b8abaf3617f6380a4090d572467c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5o2FFGma8k473GPnP4PEg.png"/></div></div></figure><h2 id="c228" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">不要随意改变变量的类型</h2><p id="6215" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/1e3f7ce56cae0d318a82a1d2b2a6eda5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzFVOdv4bpBkCDyw6DaW-Q.png"/></div></div></figure><p id="98ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ne nf ng nh b">earning</code>开头是整数，后来变成了字符串。如果其他人需要阅读或修改这些代码，他或她必然会对代码产生怀疑，甚至会编写出错误的代码。</p><p id="5aaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同时，V8这样的引擎中的JavaScript代码被转换成字节码后执行，字节码中的数据类型被确定。如果我们在JavaScript代码中改变变量的数据类型，编译器必须做一些额外的处理，这会降低程序的性能。</p><p id="0c17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/9d968aa4b09cdbf85a7eb6b75287e590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Icvh3aEEca36w2c6Tnmffw.png"/></div></div></figure><p id="b675" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您需要转换值的类型时，请使用新的变量。</p><h2 id="4562" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">函数的返回类型应该是固定的</h2><p id="245c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/fe28e6a616680aa1e87365e337f28bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvJNkJvLxDvcSyEkYddjpw.png"/></div></div></figure><p id="7cae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个函数可以返回一个整数或者一个字符串。虽然这符合JavaScript语法，但这使得调用函数的人很难直接用<code class="fe ne nf ng nh b">getPrice()</code>的结果做算术。</p><p id="96ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/36d09435eeab05dca2ccbb635174571a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9YDnN3SmYZ_jBrqmTn68A.png"/></div></div></figure><p id="63b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在函数注释中同意，返回<code class="fe ne nf ng nh b">-1</code>意味着参数无效。这允许调用者以统一的方式处理函数的结果。</p><h1 id="4244" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.减少不必要的范围查找</h1><p id="c6a3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">JavaScript支持嵌套作用域和作用域链，这允许我们编写高效的代码。但是使用这些语法会错误地弄乱代码。</p><h2 id="d2b5" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">如果没有必要，不要将代码暴露在全局范围内</h2><p id="89fc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/c5e61673b806d23fd2d15107e242b41e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEuDP-dBBAjZYWOyM04jtg.png"/></div></div></figure><p id="c6d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，script标签中的所有变量都在全局范围内，不同script标签中的代码可能由不同的程序员开发，可能会造成命名冲突。</p><p id="f7d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二，上面第二行代码，在使用<code class="fe ne nf ng nh b">element</code>变量时，在全局范围内寻找<code class="fe ne nf ng nh b">element</code>变量，降低了程序的性能。</p><p id="d0f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/c2fb10d7916a9257622bc9121328ad52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2KsGYSCD1e_coqEb0tQ1rQ.png"/></div></div></figure><p id="db6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，我们使用闭包来隐藏<code class="fe ne nf ng nh b">element</code>变量。这不会污染全局范围，而且在局部范围内查找变量更快。</p><p id="1f60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，如果你确定你会在其他地方使用<code class="fe ne nf ng nh b">element</code>变量，你还是应该在全局范围内公开它。</p><h2 id="1229" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">不要滥用闭包</h2><p id="a0c5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">JavaScript通过作用域链寻找变量。如果在当前作用域中找不到变量，JavaScript引擎会在当前作用域的父作用域中查找，然后逐层向上查找全局作用域。所以闭包嵌套得越深，变量查找花费的时间就越长。</p><p id="680b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/297245b0e6844c72ae4ce1cc87902427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rmkw2ZvN6S57c1kSkq1nVw.png"/></div></div></figure><p id="08d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ne nf ng nh b">process</code>函数中使用了上层作用域变量<code class="fe ne nf ng nh b">count</code>，这使得JavaScript引擎在调用<code class="fe ne nf ng nh b">process</code>函数时查找<code class="fe ne nf ng nh b">count</code>变量更加耗时。</p><p id="e223" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同时，如果作用域是多级嵌套的，在<code class="fe ne nf ng nh b">process</code>和<code class="fe ne nf ng nh b">count</code>之间有几十行代码，那么在读取流程函数时很容易混淆count变量。</p><p id="bf4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更好的方法是将<code class="fe ne nf ng nh b">count</code>作为参数传递给<code class="fe ne nf ng nh b">process</code>。</p><p id="3079" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/7f275142beda6d1479cacc74254bdbcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mXz6mfOoKfd7CLo1L4H1g.png"/></div></div></figure><h1 id="7832" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.使用ES6特性来简化代码</h1><p id="4de5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">ES6已经存在很多年了，现在非常兼容。我们应该积极拥抱ES6，让代码更加简洁优雅。</p><h2 id="dc4c" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">使用箭头函数代替普通函数作为回调函数</h2><p id="e454" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果不需要考虑关于<code class="fe ne nf ng nh b">this</code>绑定的问题，用箭头函数代替普通函数作为回调是个不错的主意。</p><p id="c555" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/ca129fcd2d46b77471ea9f8bc76a53e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzQTxWBlrLKZ-IFaY1ZBKQ.png"/></div></div></figure><p id="3444" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/aa2932cb085c89141e61191643f74e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r0ORhapvLvcfpu8vWgZ9Hg.png"/></div></div></figure><h2 id="43dc" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">使用类别</h2><p id="39a6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用传统的原型语法会将构造函数代码与原型方法代码分开，从而无法有效地组织代码。</p><p id="8b7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/a9ea344bb391ce14ed0f50417c8458f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gh_d4Xv9Af4sQ36YT4nVNQ.png"/></div></div></figure><p id="6c9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用类使代码更简单、更容易理解，同时使用类也使实现继承的静态成员函数变得容易。</p><p id="d50e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/51ff2ae008c4eaaf13ebca64365c2228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dh5HMFnXKUoBir9p8DiaEA.png"/></div></div></figure><h2 id="5ac0" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">使用模板字符串</h2><p id="61c4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">模板字符串用反斜杠(<code class="fe ne nf ng nh b">` `</code>)字符而不是双引号或单引号括起来。</p><p id="2217" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/c1fd893af744c06b2569502652a312a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yf6CtJeDjyUA3xBS_XJUrQ.png"/></div></div></figure><p id="15db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在模板字符串中，我们可以使用任何字符，而不是像<code class="fe ne nf ng nh b">\n</code>这样的转义字符。</p><p id="bde5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同时，我们可以直接使用表达式<code class="fe ne nf ng nh b">${}</code>插入变量，而不是拆分字符串，使用<code class="fe ne nf ng nh b">+</code>串联。</p><p id="a790" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/b26dde68d446cd544af839177a556c14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJSaj9rIRRcuGRran2_bwA.png"/></div></div></figure><p id="1fef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这显然更容易阅读。</p><h2 id="4f56" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">使用默认参数</h2><p id="0c29" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在ES5中，如果我们想给函数的参数一个默认值，我们可以这样写:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/522f90650b3fdf19399c4cdbb2258180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTpjV3gEamI7tmTRVzIRGg.png"/></div></div></figure><p id="6b68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在ES6中，我们可以用一种更简单、更易读的方式编写:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/59f8f91013a8f0735fa8f91db25090a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S0UMxmGfEz3FVU0TTBde1w.png"/></div></div></figure><h2 id="ebb2" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated"><strong class="ak">使用块范围</strong>变量</h2><p id="ddb5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果我们希望控制台以100毫秒的间隔依次输出0，1，2，…10，有些人可能会编写这样的代码:</p><pre class="kg kh ki kj gt nw nh nx ny aw nz bi"><span id="a24e" class="mp lt iq nh b gy oa ob l oc od">for(var index = 0; index &lt;= 10; index++){<br/>  setTimeout(() =&gt; console.log(index), 100)<br/>}</span></pre><p id="6fa3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，上面的代码不能满足需求。因为<code class="fe ne nf ng nh b">var</code>声明的变量在全局范围内，所以当setTimeout回调函数执行时，<code class="fe ne nf ng nh b">index</code>的值已经更改为11。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/87101ca548453819cce559d084a82fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sm_s4HzwIOSczV3S9_WIg.png"/></div></div></figure><p id="04e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ES5中的一个解决方案是使用闭包:</p><pre class="kg kh ki kj gt nw nh nx ny aw nz bi"><span id="8f9f" class="mp lt iq nh b gy oa ob l oc od">for(var index = 0; index &lt;= 10; index++){<br/>  (function(archivedIndex){<br/>    setTimeout(() =&gt; console.log(archivedIndex), 100)<br/>  })(index)<br/>}</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/8d2f4c1730f6b559b130f2220a8097a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FN8gLCAW_mMpFOEm-zXpdQ.png"/></div></div></figure><p id="a136" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们通过闭包保存<code class="fe ne nf ng nh b">index</code>值，这样每次执行setTimeout时，都会找到正确的<code class="fe ne nf ng nh b">index</code>值。</p><p id="a8b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是上面的写法很麻烦，很难理解。更好的方法是使用<code class="fe ne nf ng nh b">let</code>来声明一个块范围的变量。</p><pre class="kg kh ki kj gt nw nh nx ny aw nz bi"><span id="e878" class="mp lt iq nh b gy oa ob l oc od">for(let index = 0; index &lt;= 10; index++){<br/>  setTimeout(() =&gt; console.log(index), 100)<br/>}</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/166f5f4bfcaae8505b88f434ff654c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4X-I7N8GNiZ3bam4YNtEQ.png"/></div></div></figure><p id="af64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你只需要改变三个字符就可以完成要求，非常简单，方便，可读性强。</p><h1 id="3f57" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.语法风格</h1><h2 id="b765" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">用三元运算符替换简单的if-else</h2><p id="4f94" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">通常，三元运算符的语法如下:</p><pre class="kg kh ki kj gt nw nh nx ny aw nz bi"><span id="5474" class="mp lt iq nh b gy oa ob l oc od">condition ? expression_1 : expression_2;</span></pre><p id="de7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ne nf ng nh b">condition</code>是一个计算结果为布尔值<code class="fe ne nf ng nh b">true</code>或<code class="fe ne nf ng nh b">false</code>的表达式。如果条件为<code class="fe ne nf ng nh b">true</code>，三元运算符返回<code class="fe ne nf ng nh b">expression_1</code>，否则返回<code class="fe ne nf ng nh b">expression_2</code>。</p><p id="39e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/4e751a95dae109106a5822abd36b98d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*lwh3tne9f-LZckB7Q5dpmA.png"/></div></figure><p id="765f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/19605d43e89d58207658680df993c0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qpJbNCQmbn0b8h5dPok2Uw.png"/></div></div></figure><h2 id="5ca0" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">避免==</h2><p id="395f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><code class="fe ne nf ng nh b">==</code>有很多特殊的机制，过多使用<code class="fe ne nf ng nh b">==</code>会让我们的代码更加难以理解。我们可以显式转换数据类型，使代码更容易理解。</p><p id="b07f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">错误代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/4e16caba108feb09f449cad3e0e721bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-_wrH3sbjt1PvZbe4vsxA.png"/></div></div></figure><p id="c9e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/35a81f71abc0822315e3bc165bea008a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNaStukXheAWoVinjkwY1Q.png"/></div></div></figure></div></div>    
</body>
</html>