<html>
<head>
<title>React Tips — Infinite Scroll, Submit, Focus, and Drag and Drop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应提示—无限滚动、提交、聚焦和拖放</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-tips-infinite-scroll-submit-focus-and-drag-and-drop-25f9847a6553?source=collection_archive---------6-----------------------#2020-07-30">https://javascript.plainenglish.io/react-tips-infinite-scroll-submit-focus-and-drag-and-drop-25f9847a6553?source=collection_archive---------6-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d194118f34107d111eea3d3d5dc41d98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b74XWcaenFa8snDz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@hg_photo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Herbert Goetsch</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="510d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个用于创建web应用程序和移动应用程序的流行库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的React应用程序的技巧。</p><h1 id="2ee2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在反应中提交</h1><p id="b3b9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要在React应用程序中运行提交处理程序，我们应该调用<code class="fe me mf mg mh b">preventDefault</code>来阻止默认的提交行为，即提交给服务器。</p><p id="7bbc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ec11" class="mq lc iq mh b gy mr ms l mt mu">class App extends React.Component {</span><span id="0b0d" class="mq lc iq mh b gy mv ms l mt mu">  submit(e){<br/>    e.preventDefault();<br/>    alert('submitted');<br/>  }</span><span id="a640" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    return (<br/>      &lt;form onSubmit={this.submit}&gt;<br/>        &lt;button type='submit'&gt;click me&lt;/button&gt;<br/>      &lt;/form&gt;<br/>    );<br/>  }<br/>});</span></pre><p id="0771" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用<code class="fe me mf mg mh b">submit</code>方法调用了<code class="fe me mf mg mh b">e.preventDefault()</code>，并将其作为<code class="fe me mf mg mh b">onSubmit</code>属性的值传递。</p><h1 id="27f9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">对Render上调用的onClick作出反应</h1><p id="0f99" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们必须传入对函数的引用，而不是调用它。</p><p id="1b44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="49f7" class="mq lc iq mh b gy mr ms l mt mu">class Create extends Component {<br/>  constructor(props) {<br/>    super(props);<br/>  }</span><span id="d245" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    const playlist = this.renderPlaylists(this.props.playlists);<br/>    return (<br/>      &lt;div&gt;<br/>        {playlist}<br/>      &lt;/div&gt;<br/>    )<br/>  }</span><span id="96bf" class="mq lc iq mh b gy mv ms l mt mu">  renderPlaylists(playlists) {<br/>    const activatePlaylist = this.activatePlaylist.bind(this, playlist.id);<br/>    return playlists.map(playlist =&gt; {<br/>      return (<br/>        &lt;div key={playlist.id} onClick{activatePlaylist}&gt;<br/>          {playlist.name}<br/>        &lt;/div&gt;<br/>      );<br/>    })<br/>}</span></pre><p id="4a2c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="32d4" class="mq lc iq mh b gy mr ms l mt mu">this.activatePlaylist.bind(this, playlist.id)</span></pre><p id="45e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个函数，将<code class="fe me mf mg mh b">this</code>的值更改为当前组件的值。</p><p id="313a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它将<code class="fe me mf mg mh b">playlist.id</code>作为参数传递给<code class="fe me mf mg mh b">this.activatePlaylist</code>方法。</p><h1 id="caf7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使React组件或元素可拖动</h1><p id="4a85" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要轻松创建一个可拖动的组件，请听一下<code class="fe me mf mg mh b">mousemove</code>、<code class="fe me mf mg mh b">mousedown</code>和<code class="fe me mf mg mh b">mouseup </code>事件</p><p id="0f5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c15c" class="mq lc iq mh b gy mr ms l mt mu">import React, { useRef, useState, useEffect } from 'react'</span><span id="22f9" class="mq lc iq mh b gy mv ms l mt mu">const styles = {<br/>  width: "200px",<br/>  height: "200px",<br/>  background: "green",<br/>  display: "flex",<br/>  justifyContent: "center",<br/>  alignItems: "center"<br/>}</span><span id="78a1" class="mq lc iq mh b gy mv ms l mt mu">const DraggableComponent = () =&gt; {<br/>  const [pressed, setPressed] = useState(false)<br/>  const [position, setPosition] = useState({x: 0, y: 0})<br/>  const ref = useRef()</span><span id="2e9c" class="mq lc iq mh b gy mv ms l mt mu">  useEffect(() =&gt; {<br/>    if (ref.current) {<br/>      ref.current.style.transform = `translate(${position.x}px, ${position.y}px)`<br/>    }<br/>  }, [position])</span><span id="d86a" class="mq lc iq mh b gy mv ms l mt mu">  const onMouseMove = (event) =&gt; {<br/>    if (pressed) {<br/>      setPosition({<br/>        x: position.x + event.movementX,<br/>        y: position.y + event.movementY<br/>      })<br/>    }<br/>  }</span><span id="6f81" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;div<br/>      ref={ref}<br/>      style={styles}<br/>      onMouseMove={ onMouseMove }<br/>      onMouseDown={() =&gt; setPressed(true)}<br/>      onMouseUp={() =&gt; setPressed(false)}&gt;<br/>      &lt;p&gt;drag me&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="e850" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有带一些道具的<code class="fe me mf mg mh b">Draggable</code>组件。</p><p id="3901" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们监听<code class="fe me mf mg mh b">mousedown</code>和<code class="fe me mf mg mh b">mouseup</code>事件，将<code class="fe me mf mg mh b">pressed</code>状态分别设置为<code class="fe me mf mg mh b">false</code>和<code class="fe me mf mg mh b">true</code>。</p><p id="82d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果<code class="fe me mf mg mh b">pressed</code>状态是<code class="fe me mf mg mh b">true</code>，也就是我们正在拖动的时候，这将让我们被拖动。</p><p id="6811" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过将<code class="fe me mf mg mh b">onMouseMove</code>函数传递给<code class="fe me mf mg mh b">onMouseMove</code>属性来为<code class="fe me mf mg mh b">mousemove</code>事件添加一个监听器。</p><p id="9f9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们在<code class="fe me mf mg mh b">onMouseMove</code>功能中设置位置。</p><p id="d432" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果<code class="fe me mf mg mh b">pressed</code>是<code class="fe me mf mg mh b">true</code>，我们通过改变div的<code class="fe me mf mg mh b">x</code>和<code class="fe me mf mg mh b">y</code>坐标来设置位置。</p><h1 id="ad02" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">带React的无限滚动</h1><p id="22d3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要使用React轻松添加无限滚动，我们可以使用react-infinite-scroller包。</p><p id="f697" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装它，我们运行:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="50c8" class="mq lc iq mh b gy mr ms l mt mu">npm install react-infinite-scroller</span></pre><p id="4e07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c3f9" class="mq lc iq mh b gy mr ms l mt mu">import React, { Component } from 'react';<br/>import InfiniteScroll from 'react-infinite-scroller';</span><span id="f9a0" class="mq lc iq mh b gy mv ms l mt mu">class App extends Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.state = {<br/>      listData: [],<br/>      hasMoreItems: true,<br/>      nextHref: null<br/>    };<br/>    this.fetchData = this.fetchData.bind(this);<br/>  }</span><span id="2fcb" class="mq lc iq mh b gy mv ms l mt mu">  async fetchData(){<br/>    const listData  = await getJobsData();<br/>    this.setState({ listData });<br/>  }</span><span id="4dd0" class="mq lc iq mh b gy mv ms l mt mu">  componentDidMount() {<br/>     this.fetchData();<br/>  }</span><span id="2df4" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    const loader = &lt;div className="loader"&gt;Loading ...&lt;/div&gt;;<br/>    const JobItems = this.state.listData.map(job =&gt; {<br/>      return (&lt;div&gt;{job.name}&lt;/div&gt;);<br/>    });    <br/>    return (<br/>      &lt;div className="Jobs"&gt;<br/>         &lt;h2&gt;Jobs List&lt;/h2&gt;<br/>         &lt;InfiniteScroll<br/>           pageStart={0}<br/>           loadMore={this.fetchData.bind(this)}<br/>           hasMore={this.state.hasMoreItems}<br/>           loader={loader}<br/>         &gt;<br/>            {JobItems}<br/>         &lt;/InfiniteScroll&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="b347" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">InfiniteScroll</code>组件为我们的应用程序添加无限滚动。</p><p id="56fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pageStart</code>是起始页码。</p><p id="a354" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">loadMore</code>是加载更多数据的功能。</p><p id="f8d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">hasMore</code>就是看我们有没有更多数据的状态。</p><p id="1307" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">loader</code>为装载机部件。</p><p id="c9a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每次加载并滚动到页面底部时，我们都会得到新的数据。</p><h1 id="6e5f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">选择输入中的所有文本，并在聚焦时做出反应</h1><p id="b5bf" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在输入上调用<code class="fe me mf mg mh b">select</code>方法来聚焦它。</p><p id="a1c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fec2" class="mq lc iq mh b gy mr ms l mt mu">const Input = (props) =&gt; {<br/>  const handleFocus = (event) =&gt; event.target.select();</span><span id="00db" class="mq lc iq mh b gy mv ms l mt mu">  return &lt;input type="text" value="something" onFocus={handleFocus} /&gt;<br/>}</span></pre><p id="fc60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">handleFocus</code>函数，它调用输入元素上的<code class="fe me mf mg mh b">select</code>方法来选择聚焦时的输入值。</p><p id="8056" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了类组件，我们可以编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9e9d" class="mq lc iq mh b gy mr ms l mt mu">class Input extends React.Component {<br/>  constructor(){<br/>    super();<br/>    this.handleFocus = this.handleFocus.bind(this);<br/>  }    </span><span id="401a" class="mq lc iq mh b gy mv ms l mt mu">  handleFocus(event){<br/>    event.target.select();<br/>  }</span><span id="478e" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    return (<br/>      &lt;input type="text" value="something" onFocus={this.handleFocus} /&gt;<br/>        );<br/>    }<br/>}</span></pre><p id="2f60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们聚焦输入时，我们有<code class="fe me mf mg mh b">handleFocus</code>方法调用<code class="fe me mf mg mh b">select</code>来选择输入值。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/75c0482f5ba98d70efbd74cbad79f960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0q-I7w2-o4MMLMor"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@alexsofronie?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexandru Sofronie</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5314" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="7373" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用一个软件包轻松添加无限滚动。</p><p id="9b56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以选择输入的值。</p><p id="1cbc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在没有库的情况下将可拖动的项目添加到我们的组件中。</p><p id="bbe6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须调用<code class="fe me mf mg mh b">preventDefault</code>来停止默认的提交行为。</p><h2 id="2f5b" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated">简单英语中的JavaScript</h2><p id="562b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果是这样的话，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获得更多类似的内容吧！</strong></p></div></div>    
</body>
</html>