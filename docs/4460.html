<html>
<head>
<title>Internationalize your React App In 5 Easy Steps With React Intl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Intl，通过5个简单步骤国际化您的React应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/internationalize-your-react-app-in-5-easy-steps-with-react-intl-f854ad08cab7?source=collection_archive---------6-----------------------#2020-12-13">https://javascript.plainenglish.io/internationalize-your-react-app-in-5-easy-steps-with-react-intl-f854ad08cab7?source=collection_archive---------6-----------------------#2020-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/59da178d8fba17a8698ce3517cf78f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i6N3ZwNN-IMX6J1t"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jj1bdx?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kenji Rikitake</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c258" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">国际化</strong>是一个术语，用于使一个网站适合多个地区(即一个或多个地方和/或语言)。</p><p id="93f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">国际化通常缩写为<strong class="kf ir"> i18n </strong>，因为它以“I”开头，以“n”结尾，中间还有18个其他字符。开发者就是喜欢他们的缩写，不是吗？</p><p id="4ed5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个好的国际化框架应该提供一个体面的DX(开发者体验),而不占用大量的实现时间。</p><p id="5a26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文介绍的库名为React Intl。每月下载量超过800，000次，是React世界中使用最多的国际化工具之一。</p><p id="4f89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React Intl能做的不仅仅是根据地区选择消息/字符串。它还可以基于它格式化数字和日期！然而，在本文中，只讨论了它的消息方面，因为这是大多数人主要寻找的。</p><p id="7c96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React Intl现在将在一个用<code class="fe lb lc ld le b">create-react-app</code>引导的React应用程序的上下文中呈现，使用英语和德语作为演示语言。</p><p id="24ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">带有工作代码的库可以在这里找到:<a class="ae kc" href="https://github.com/adamkss/react-intl-demo" rel="noopener ugc nofollow" target="_blank">https://github.com/adamkss/react-intl-demo</a>。</p><h2 id="e649" class="lf lg iq bd lh li lj dn lk ll lm dp ln ko lo lp lq ks lr ls lt kw lu lv lw lx bi translated">1.添加依赖项</h2><p id="9d15" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">首先，必须通过运行<code class="fe lb lc ld le b">yarn add react-intl</code>将<code class="fe lb lc ld le b">react-intl</code>添加为依赖项。</p><p id="fbcc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还需要添加一个依赖项，那就是<code class="fe lb lc ld le b">extract-react-intl-messages</code>。这种开发依赖性将用于将国际化的消息提取到它们自己的语言文件中。于是，跑:<code class="fe lb lc ld le b">yarn add -D extract-react-intl-messages</code>。</p><p id="26f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让<code class="fe lb lc ld le b">extract-react-intl-messages</code>工作，请确保在您的项目的根目录下创建一个包含以下内容的<code class="fe lb lc ld le b">.babelrc</code>文件:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h2 id="866b" class="lf lg iq bd lh li lj dn lk ll lm dp ln ko lo lp lq ks lr ls lt kw lu lv lw lx bi translated">2.创建特定于语言环境的文件</h2><p id="3310" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">要支持的每个语言环境都需要有自己的文件，以JSON格式存储本地化的消息。</p><p id="59d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建一个名为<code class="fe lb lc ld le b">translations</code>的新文件夹，并创建<code class="fe lb lc ld le b">en.json</code>和<code class="fe lb lc ld le b">de.json</code>。目前，两者都应该是空的:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="224d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们也在<code class="fe lb lc ld le b">translations</code>文件夹中创建一个<code class="fe lb lc ld le b">index.js</code>，它将导出翻译本身:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h2 id="d45b" class="lf lg iq bd lh li lj dn lk ll lm dp ln ko lo lp lq ks lr ls lt kw lu lv lw lx bi translated">3.用React Intl的提供者包装你的React树</h2><p id="7fa4" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">React树必须用react-intl的<code class="fe lb lc ld le b">IntlProvider</code>包装，这样国际化的消息在每个组件中都可以访问。</p><p id="f8f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">期望两个重要的道具:实际的语言环境和由语言环境选择的国际化消息。</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="1f0a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，语言环境是硬编码的。一般来说，您应该检查浏览器的默认语言(通过navigator对象:<code class="fe lb lc ld le b">navigator.language</code>)、地理定位用户或者让他们简单地从语言列表中选择。</p><h2 id="649d" class="lf lg iq bd lh li lj dn lk ll lm dp ln ko lo lp lq ks lr ls lt kw lu lv lw lx bi translated">4.开始定义消息</h2><p id="f80b" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">每个国际化消息至少应该有一个ID和一个默认值。定义一个默认值不是强制性的，但是如果你开始用一种语言来构建你的网页，这是很好的。</p><p id="bb61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">定义国际化消息就像使用<code class="fe lb lc ld le b">react-intl</code>的<code class="fe lb lc ld le b">FormattedMessage</code>组件一样简单:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="2447" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们定义一个简单的React组件来显示这条问候消息，并在应用程序中使用它:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="5421" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将向我们显示默认消息:</p><figure class="md me mf mg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/2fc8891993669510c6d7bef436aca4e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KwufijxH3kYH6s9HpxUuw.png"/></div></div></figure><h2 id="28f0" class="lf lg iq bd lh li lj dn lk ll lm dp ln ko lo lp lq ks lr ls lt kw lu lv lw lx bi translated">5.用另一种语言添加邮件</h2><p id="53e9" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">正如本文开头所指出的，所有消息都存储在语言特定的文件中(在本演示中是<code class="fe lb lc ld le b">en.json</code>和<code class="fe lb lc ld le b">de.json</code>)。</p><p id="8550" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须使用我们添加的开发依赖项(<code class="fe lb lc ld le b">extract-react-intl-messages</code>)来用我们的消息的键(id)填充它们。比如我们上面用的<code class="fe lb lc ld le b">greetingsMessage</code>。</p><p id="2244" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们需要在<code class="fe lb lc ld le b">react-scripts</code>下面的<code class="fe lb lc ld le b">package.json</code>的<code class="fe lb lc ld le b">scripts</code>键中添加一个名为<code class="fe lb lc ld le b">extract-intl</code>的新脚本:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="9536" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个脚本<code class="fe lb lc ld le b">extract-intl</code>使用几个参数运行<code class="fe lb lc ld le b">extract-messages</code>:</p><ol class=""><li id="3f67" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la mp mq mr ms bi translated"><code class="fe lb lc ld le b">-l</code>:定义可用的语言环境，在本演示中为<code class="fe lb lc ld le b">en</code>(通用英语)和<code class="fe lb lc ld le b">de</code>(通用德语)</li><li id="b060" class="mk ml iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated"><code class="fe lb lc ld le b">-o</code>:定义国际化JSONs的位置(<code class="fe lb lc ld le b">de.json</code>和<code class="fe lb lc ld le b">en.json</code>)</li><li id="1342" class="mk ml iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">定义默认的语言环境，在我们的演示中它被设置为英语。基于这个参数，<code class="fe lb lc ld le b">extract-messages</code>将我们在代码中定义的默认消息复制到默认语言环境的JSON中，在我们的例子中是<code class="fe lb lc ld le b">en.json</code></li></ol><p id="598f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过<code class="fe lb lc ld le b">yarn extract-intl</code>运行这个命令后，看一下两个JSON文件:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="6158" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以看到，默认语言的本地化文件已经用代码中的默认消息填充，而另一种语言的文件只有密钥。现在也可以在那里定义值了！</p><p id="d9d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">德国版的<code class="fe lb lc ld le b">greetingsMessage</code>可以通过修改<code class="fe lb lc ld le b">de.json</code>手动设置:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="eb91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，为了进行试验，需要将德语地区(<code class="fe lb lc ld le b">de</code>)传递给IntlProvider，它将依次使用在<code class="fe lb lc ld le b">de.json</code>中定义的所有德语消息:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="2b29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过这样的修改(交换传递给<code class="fe lb lc ld le b">react-intl</code>的区域设置)，我们现在得到了德语消息，而不需要实际接触组件的代码:</p><figure class="md me mf mg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/be2182459fba719b7dbc82c1528e0898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JHV0tWigDMPRLD3malbwg.png"/></div></div></figure><p id="8e2c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太好了！这里总结了国际化需要做的事情:</p><ol class=""><li id="2052" class="mk ml iq kf b kg kh kk kl ko mm ks mn kw mo la mp mq mr ms bi translated">定义语言和语言文件</li><li id="d47c" class="mk ml iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">使用带有国际化消息ID的<code class="fe lb lc ld le b">&lt;FormattedMessage&gt;</code>组件来获取基于当前所选语言环境的消息</li><li id="8833" class="mk ml iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">运行<code class="fe lb lc ld le b">yarn extract-intl</code>用现有的消息id填充您的本地化JSONs。这也自动将默认消息(在代码中定义)插入默认语言的JSON(在<code class="fe lb lc ld le b">extract-intl</code>命令中设置)</li><li id="8bb1" class="mk ml iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">用正确的值填写其余的JSONs(语言)</li><li id="b4b5" class="mk ml iq kf b kg mt kk mu ko mv ks mw kw mx la mp mq mr ms bi translated">根据您的需要更改传递给<code class="fe lb lc ld le b">IntlProvider</code>的<code class="fe lb lc ld le b">locale</code>(根据用户的区域、手动、浏览器的语言等。)会自动在你的应用程序中插入来自所选语言环境的正确消息！</li></ol><h2 id="1793" class="lf lg iq bd lh li lj dn lk ll lm dp ln ko lo lp lq ks lr ls lt kw lu lv lw lx bi translated">访问消息的其他方式</h2><p id="6574" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">有时你不能使用<code class="fe lb lc ld le b">&lt;FormattedMessage&gt;</code>标签来获取/定义消息。考虑一下必须在HTML元素上设置title属性的情况。</p><p id="3ec7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">别担心！React Intl为我们提供了一个钩子和一个HOC(你用它包装你的组件的高阶组件)，我们可以用它来访问<code class="fe lb lc ld le b">intl</code>对象(钩子用于功能组件，而一个HOC，<code class="fe lb lc ld le b">injectIntl</code>用于基于类的组件):</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h1 id="c78b" class="my lg iq bd lh mz na nb lk nc nd ne ln nf ng nh lq ni nj nk lt nl nm nn lw no bi translated">最后</h1><p id="ee16" class="pw-post-body-paragraph kd ke iq kf b kg ly ki kj kk lz km kn ko ma kq kr ks mb ku kv kw mc ky kz la ij bi translated">React Intl提供了一种清晰简单的方法来国际化您的应用程序🌍。随时可以试一试！</p><p id="d845" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">谢谢你一路看完这篇文章，你真棒！</p></div></div>    
</body>
</html>