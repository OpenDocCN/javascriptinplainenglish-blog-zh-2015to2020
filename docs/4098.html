<html>
<head>
<title>Implementing Simple Auth To Your Next.js Website using Next.js Auth</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Next.js Auth实现对您的Next.js网站的简单授权</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/implementing-simple-auth-to-your-next-js-website-using-next-js-auth-e136d77bb333?source=collection_archive---------3-----------------------#2020-11-16">https://javascript.plainenglish.io/implementing-simple-auth-to-your-next-js-website-using-next-js-auth-e136d77bb333?source=collection_archive---------3-----------------------#2020-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="io ip gp gr iq ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/f8c50be262575db2eef7823b4c535219.png" data-original-src="https://miro.medium.com/v2/0*_zoxtKxpaZmeDDWN"/></div></figure><div class=""/><div class=""><h2 id="cfca" class="pw-subtitle-paragraph ju iw ix bd b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dk translated">使用Next.js Auth向网站添加您自己的简单身份验证</h2></div><p id="3427" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">托管网站时，部署的密码保护可能是一笔昂贵的费用，尤其是当您想要保护分支部署时。</p><p id="65db" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在今天的教程中，我将向您展示如何使用Next.js 10和Next.js Auth在这些分支上设置自己的简单身份验证保护。</p><h2 id="51ee" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">入门指南</h2><figure class="mb mc md me gt ir"><div class="bz fp l di"><div class="mf mg l"/></div></figure><h2 id="df25" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">设置应用编程接口</h2><p id="6d22" class="pw-post-body-paragraph km kn ix ko b kp mh jy kr ks mi kb ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">在<code class="fe mm mn mo mp b">pages/api/auth/[...nextauth].js</code>中，增加以下内容:</p><figure class="mb mc md me gt ir"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="2b1c" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我们将使用<code class="fe mm mn mo mp b">NEXTAUTH_USERNAME</code>和<code class="fe mm mn mo mp b">NEXTAUTH_PASSWORD</code>来设置我们的基本环境变量。</p><p id="f79f" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">以上将进行比较，如果比较正确，我们将返回<code class="fe mm mn mo mp b">user</code>对象，该对象只是<code class="fe mm mn mo mp b">admin</code>的名字和<code class="fe mm mn mo mp b">1</code>的ID。</p><h2 id="78e3" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">设置私人页面</h2><p id="4685" class="pw-post-body-paragraph km kn ix ko b kp mh jy kr ks mi kb ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">在<code class="fe mm mn mo mp b">pages/private.js</code>中增加:</p><figure class="mb mc md me gt ir"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="a73b" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在这里，我们将使用<code class="fe mm mn mo mp b">useSession</code>钩子来确定我们是否登录，同时使用<code class="fe mm mn mo mp b">next-auth/client</code>库中的<code class="fe mm mn mo mp b">signIn</code>给用户一个登录的选项。</p><h2 id="88b8" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">更新page/index . js和page/_ app . js</h2><p id="5aee" class="pw-post-body-paragraph km kn ix ko b kp mh jy kr ks mi kb ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">最后，让我们更新我们的基础页面:</p><figure class="mb mc md me gt ir"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="44b6" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这将类似于我们基于会话的私人页面。</p><p id="8fdd" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">至于<code class="fe mm mn mo mp b">pages/_app.js</code>我们将确保我们的授权提供商在那里:</p><figure class="mb mc md me gt ir"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="acf3" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这就是我们代码设置所需的全部！</p><h2 id="29b1" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">设置环境变量</h2><p id="c24e" class="pw-post-body-paragraph km kn ix ko b kp mh jy kr ks mi kb ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">对于本地开发，我们可以将env vars添加到<code class="fe mm mn mo mp b">.env.local</code>文件中。现在添加以下内容:</p><figure class="mb mc md me gt ir"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="a059" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在这里，我们设置了身份验证和应用程序URL所需的用户名和密码(这里只是localhost)。</p><p id="2d9c" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">太好了，现在我们可以看到行动了！</p><h2 id="889c" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">探索网站</h2><p id="49eb" class="pw-post-body-paragraph km kn ix ko b kp mh jy kr ks mi kb ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">如果我们运行<code class="fe mm mn mo mp b">npm run dev</code>，它将通过<code class="fe mm mn mo mp b">package.json</code>脚本运行<code class="fe mm mn mo mp b">next dev</code>，并在<code class="fe mm mn mo mp b">localhost:3000</code>上启动网站。</p><figure class="mb mc md me gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/ade297ba3a15b065cad4481ebb7f24f3.png" data-original-src="https://miro.medium.com/v2/0*yMIR67WOGqJcJ4F6"/></div></figure><p id="0693" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">当前所在的页面没有访问权限，因此它会显示我们的登录消息。</p><p id="e205" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">无论访问权限如何，都将有一个链接可以点击进入我们的<code class="fe mm mn mo mp b">/private</code>页面，在那里所有的内容都是私有的。</p><p id="1dc8" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">如果我们选择了这个选项，我们会发现我们没有权限。</p><figure class="mb mc md me gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/26a74d49dda009657b199fdf811a9ab4.png" data-original-src="https://miro.medium.com/v2/0*KzQT8lGpkuQAHANU"/></div></figure><p id="4f34" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">如果我们现在决定点击登录，我们会看到<strong class="ko iy">提供的<code class="fe mm mn mo mp b">sign in</code>页面。</strong></p><figure class="mb mc md me gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/d7d2d38976695aa843bbae7d0ea77412.png" data-original-src="https://miro.medium.com/v2/0*jL8VWRPuhT07YjH1"/></div></figure><p id="6c7b" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在环境变量中写入我们设置的<strong class="ko iy">用户名</strong>和<strong class="ko iy">密码</strong>将导致我们被重定向到具有访问权限的上一页。</p><figure class="mb mc md me gt ir gh gi paragraph-image"><div class="ab gu cl is"><img src="../Images/db64a5a17c047a562b55a7a227898281.png" data-original-src="https://miro.medium.com/v2/0*BXGyealvGBByLdJg"/></div></figure><p id="0976" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">成功！我们已经设法向Next.js应用程序添加了简单、基本的身份验证。</p><p id="0503" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">您可以<a class="ae mq" href="https://nextjs-simple-auth.vercel.app/" rel="noopener ugc nofollow" target="_blank">尝试Vercel上托管的项目</a>。</p><h2 id="8a52" class="li lj ix bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz ma bi translated">资源和进一步阅读</h2><ol class=""><li id="130e" class="mr ms ix ko b kp mh ks mi kv mt kz mu ld mv lh mw mx my mz bi translated"><a class="ae mq" href="https://nextjs-simple-auth.vercel.app/" rel="noopener ugc nofollow" target="_blank">直播项目</a></li><li id="ffd2" class="mr ms ix ko b kp na ks nb kv nc kz nd ld ne lh mw mx my mz bi translated"><a class="ae mq" href="https://github.com/okeeffed/nextjs-simple-auth" rel="noopener ugc nofollow" target="_blank">代码回购</a></li><li id="d4f5" class="mr ms ix ko b kp na ks nb kv nc kz nd ld ne lh mw mx my mz bi translated"><a class="ae mq" href="https://next-auth.js.org/" rel="noopener ugc nofollow" target="_blank"> Next.js Auth </a></li><li id="beb5" class="mr ms ix ko b kp na ks nb kv nc kz nd ld ne lh mw mx my mz bi translated"><a class="ae mq" href="https://next-auth.js.org/providers/credentials" rel="noopener ugc nofollow" target="_blank"> Next.js Auth —凭证</a></li></ol><p id="86ed" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><em class="nf">图片来源:</em> <a class="ae mq" href="https://unsplash.com/@chrisyangchrisfilm" rel="noopener ugc nofollow" target="_blank"> <em class="nf">杨致远</em> </a></p><p id="c9e5" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><em class="nf">原贴于我的</em> <a class="ae mq" href="https://blog.dennisokeeffe.com/blog/2020-11-16-nextjs-simple-auth/" rel="noopener ugc nofollow" target="_blank"> <em class="nf">博客</em> </a> <em class="nf">。</em></p></div></div>    
</body>
</html>