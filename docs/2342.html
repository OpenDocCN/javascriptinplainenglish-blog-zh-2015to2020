<html>
<head>
<title>Localize your React Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">本地化您的React应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/localize-your-react-application-5ab3219ee5d5?source=collection_archive---------1-----------------------#2020-06-15">https://javascript.plainenglish.io/localize-your-react-application-5ab3219ee5d5?source=collection_archive---------1-----------------------#2020-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="09f7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">国际化(i18n)与i18next和react-i18next</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8149b7902c0ec0d13a73116eb72b4359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6SX6NOtfK-adipmxA2SQ1g.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image source: <a class="ae kv" href="https://unsplash.com/@pisitheng" rel="noopener ugc nofollow" target="_blank">Pisit Heng</a></figcaption></figure><p id="1448" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">国际化(i18n)可能是你现在需要的特性之一。多亏了<code class="fe ls lt lu lv b">i18next</code>，本地化应用程序的任务可以很容易地完成。在本文中，我将向您展示如何使用<code class="fe ls lt lu lv b">i18next</code>和<code class="fe ls lt lu lv b">react-i18next</code>来本地化您的React应用程序。</p><h2 id="d128" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">这篇文章将涵盖哪些内容？</h2><ol class=""><li id="73a6" class="mp mq iq ky b kz mr lc ms lf mt lj mu ln mv lr mw mx my mz bi translated">初始化并使用翻译函数。</li><li id="fa79" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">处理用户的语言选择。</li><li id="8b6c" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">管理翻译文件。</li><li id="072d" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">将语言密钥存储在Cookie中。</li></ol><p id="53dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将重点介绍如何在React应用程序中实现国际化。对于本教程，我使用一个新的React应用程序，它是使用组件的<a class="ae kv" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank"> Create React App </a>和<a class="ae kv" href="https://ant.design/" rel="noopener ugc nofollow" target="_blank"> Ant Design </a>创建的。您可以按照自己喜欢的方式创建React应用程序。</p><p id="4ae5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们想要实现什么？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/7ff9bf26cb9c2124b75399298c4debab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fVSPy9u1vdrxyNt7nnSwCw.gif"/></div></div></figure></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="51f9" class="nn lx iq bd ly no np nq mb nr ns nt me jw nu jx mh jz nv ka mk kc nw kd mn nx bi translated">1.初始化并使用翻译功能</h1><p id="5f72" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf ny lh li lj nz ll lm ln oa lp lq lr ij bi translated">安装<code class="fe ls lt lu lv b">i18next</code>和<code class="fe ls lt lu lv b">react-i18next</code>。</p><pre class="kg kh ki kj gt ob lv oc od aw oe bi"><span id="058b" class="lw lx iq lv b gy of og l oh oi">npm install i18next react-i18next --save</span><span id="7a44" class="lw lx iq lv b gy oj og l oh oi">// or</span><span id="fee5" class="lw lx iq lv b gy oj og l oh oi">yarn add i18next react-i18next</span></pre><p id="7ca1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个<code class="fe ls lt lu lv b">i18n.js</code>文件来存放您的配置。下面是一个<code class="fe ls lt lu lv b">i18n.js</code>文件内容的例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><ul class=""><li id="5627" class="mp mq iq ky b kz la lc ld lf om lj on ln oo lr op mx my mz bi translated"><code class="fe ls lt lu lv b">resources</code>:地区(翻译)数据。</li><li id="e871" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr op mx my mz bi translated"><code class="fe ls lt lu lv b">lng</code>:使用的初始语言。</li><li id="c81c" class="mp mq iq ky b kz na lc nb lf nc lj nd ln ne lr op mx my mz bi translated"><code class="fe ls lt lu lv b">fallbackLng</code>:某些翻译未定义时使用的语言。</li></ul><p id="f584" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将其导入到您的<code class="fe ls lt lu lv b">index.js</code>文件中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="7692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您可以在您的组件中使用它。我们将使用<code class="fe ls lt lu lv b">react-i18next</code>提供的<code class="fe ls lt lu lv b">useTranslation</code>挂钩。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="6ed2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">翻译函数(<code class="fe ls lt lu lv b">t</code>)接受<code class="fe ls lt lu lv b">resources</code>中定义的翻译键，例如:<code class="fe ls lt lu lv b">t("title")</code>(或者如果有嵌套的翻译对象:<code class="fe ls lt lu lv b">t("content.description")</code>)。</p><p id="35b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给你。现在如果你刷新你的浏览器，标题文本应该是“地球”。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="3656" class="nn lx iq bd ly no np nq mb nr ns nt me jw nu jx mh jz nv ka mk kc nw kd mn nx bi translated">2.处理用户的语言选择</h1><p id="f5da" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf ny lh li lj nz ll lm ln oa lp lq lr ij bi translated">现在让我们让我们的应用程序能够接受用户的选择。我们将使用由<code class="fe ls lt lu lv b">useTranslation</code>钩子提供的<code class="fe ls lt lu lv b">i18n</code>实例。然后，创建一个函数来更新语言。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="32fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用接受语言键的<code class="fe ls lt lu lv b">i18n.changeLanguage</code>方法。可用的语言键是在浏览器的<code class="fe ls lt lu lv b">resources</code> ( <code class="fe ls lt lu lv b">en</code>、<code class="fe ls lt lu lv b">de</code>、<code class="fe ls lt lu lv b">fr</code>或<code class="fe ls lt lu lv b">id</code>中定义的，现在您可以更改语言并立即看到结果。</p><p id="b3e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:我对<code class="fe ls lt lu lv b">Radio</code>组件使用<a class="ae kv" href="https://ant.design/" rel="noopener ugc nofollow" target="_blank">蚂蚁设计</a>。您可以为您的应用程序使用HTML select标记、radio input标记或您的自定义组件。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="9973" class="nn lx iq bd ly no np nq mb nr ns nt me jw nu jx mh jz nv ka mk kc nw kd mn nx bi translated">3.管理翻译文件</h1><p id="e46c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf ny lh li lj nz ll lm ln oa lp lq lr ij bi translated">所有的翻译都放在<code class="fe ls lt lu lv b">i18n.js</code>文件中。如果您的应用程序正在增长，那么该文件将更难维护。为了解决这个问题，我们可以将每个翻译转移到单独的JSON文件中。然后，我们的应用程序将根据需要加载这些JSON文件。</p><p id="3d8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用<code class="fe ls lt lu lv b">i18next-http-backend</code>从后端服务器加载资源。它使用XMLHttpRequest或fetch API来获取资源文件。</p><p id="d212" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装<code class="fe ls lt lu lv b">i18next-http-backend</code>:</p><pre class="kg kh ki kj gt ob lv oc od aw oe bi"><span id="18fb" class="lw lx iq lv b gy of og l oh oi">npm install <!-- -->i18next-http-backend<!-- --> --save</span><span id="14e4" class="lw lx iq lv b gy oj og l oh oi">// or</span><span id="3487" class="lw lx iq lv b gy oj og l oh oi">yarn add <!-- -->i18next-http-backend<!-- --> </span></pre><p id="6437" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">public</code>文件夹中创建一个<code class="fe ls lt lu lv b">locales</code>文件夹。然后为每个语言键创建文件夹。在每个文件夹中添加<code class="fe ls lt lu lv b">translation.json</code>文件。文件夹结构应该如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/f616f2ed5005b839ff0bf80c20fce791.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*HIkwfZaAXJfergMicoTLNA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Locale folders and files</figcaption></figure><p id="8776" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将翻译数据从<code class="fe ls lt lu lv b">resources</code>复制到适当的文件——例如:</p><pre class="kg kh ki kj gt ob lv oc od aw oe bi"><span id="7d38" class="lw lx iq lv b gy of og l oh oi">/* en/translation.json */</span><span id="401e" class="lw lx iq lv b gy oj og l oh oi">{<br/>  "title": "Earth",<br/>  "content": {<br/>    "description": "Earth is the third planet...",<br/>    "source": "Source: "<br/>  }<br/>}</span></pre><p id="085b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更新您的<code class="fe ls lt lu lv b">i18n.js</code>文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="bdd2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我之前所说的，<code class="fe ls lt lu lv b">i18next-http-backend</code>用XMLHttpRequest加载资源文件，这意味着这个过程是异步的。有时资源文件可能还没有准备好。为了处理它，我们可以使用<code class="fe ls lt lu lv b">React</code>中的<code class="fe ls lt lu lv b">Suspense</code>来包装我们的组件。您可以将它放在<code class="fe ls lt lu lv b">index.js</code>中来包裹所有组件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="5537" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你回到你的浏览器，看看它是否像预期的那样运行。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="44e4" class="nn lx iq bd ly no np nq mb nr ns nt me jw nu jx mh jz nv ka mk kc nw kd mn nx bi translated">4.将语言密钥存储在Cookie中</h1><p id="41c9" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf ny lh li lj nz ll lm ln oa lp lq lr ij bi translated">您会注意到，如果您刷新浏览器或关闭然后重新打开它，语言将恢复为英语(<code class="fe ls lt lu lv b">en</code>)。那是因为我们在<code class="fe ls lt lu lv b">i18n.js</code>中还是硬编码的。我们还没有把它存放在任何更持久的地方。</p><p id="f99a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将使用Cookie(带<code class="fe ls lt lu lv b">js-cookie</code>)来存储语言代码。你可以选择其他方式，如本地存储，甚至在你的后端服务器。</p><p id="2715" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更新<code class="fe ls lt lu lv b">i18n.js</code>，现在<code class="fe ls lt lu lv b">lng</code>使用Cookie中的语言键。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="786b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还添加了一个回退语言代码，如果Cookie值中的<code class="fe ls lt lu lv b">locale</code>是<code class="fe ls lt lu lv b">undefined</code>，就使用短路。</p><p id="79ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要忘记更新我们的<code class="fe ls lt lu lv b">changeLanguage</code>功能，以便能够将选择的密钥存储到Cookie中。只需在<code class="fe ls lt lu lv b">i18n.changeLanguage(code);</code>行后添加下面的代码。但是不要忘记先进口<code class="fe ls lt lu lv b">Cookies</code>。</p><pre class="kg kh ki kj gt ob lv oc od aw oe bi"><span id="b018" class="lw lx iq lv b gy of og l oh oi">Cookies.set("locale", code);</span></pre><p id="1592" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。您已经在React应用程序中实现了国际化。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="885f" class="nn lx iq bd ly no np nq mb nr ns nt me jw nu jx mh jz nv ka mk kc nw kd mn nx bi translated">结论</h1><p id="4574" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf ny lh li lj nz ll lm ln oa lp lq lr ij bi translated"><code class="fe ls lt lu lv b">i18next</code>和<code class="fe ls lt lu lv b">react-i18next</code>是帮助我们在React应用程序中实现国际化的强大工具。它们简单易用。完整的指南可在<a class="ae kv" href="https://www.i18next.com/" rel="noopener ugc nofollow" target="_blank">文档页面</a>上找到。</p><p id="bda4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例代码可以在<a class="ae kv" href="https://github.com/rezamauliadi/react-18next-learning" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="or">GitHub</em></strong></a><strong class="ky ir"><em class="or">上找到。</em> </strong></p><p id="46d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢了。</p></div></div>    
</body>
</html>