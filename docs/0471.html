<html>
<head>
<title>How to Include Environment Variables in Your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React应用程序中包含环境变量</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-include-environment-variables-in-your-react-app-e4657c178b5c?source=collection_archive---------2-----------------------#2019-10-22">https://javascript.plainenglish.io/how-to-include-environment-variables-in-your-react-app-e4657c178b5c?source=collection_archive---------2-----------------------#2019-10-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="554e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您使用Create React App来开发应用程序，那么在应用程序中使用环境变量是很容易的。您只需在项目文件夹的根目录下创建一个<code class="fe kl km kn ko b">.env</code>文件，并且您的环境变量的键应该以<code class="fe kl km kn ko b">REACT_APP_</code>开始。例如，如果你需要在你的应用中包含一个API密匙，那么你的<code class="fe kl km kn ko b">.env</code>文件应该是这样的:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="54b7" class="kx ky iq ko b gy kz la l lb lc">REACT_APP_API_KEY='your api key'</span></pre><p id="055f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在您的代码中，您可以使用<code class="fe kl km kn ko b">process.env.REACT_APP_API_KEY</code>来访问它。</p><p id="84d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将制作一个应用程序，在背景中显示图像列表，在前景中显示标签文本。图像将由Pixabay API提供。你可以在<a class="ae ld" href="https://pixabay.com/api/docs/" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/api/docs/</a>注册一个API密钥</p><p id="dfad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了React，用<code class="fe kl km kn ko b">react-parallax</code>库创建视差滚动效果是不是又快又简单。</p><p id="5a09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">视差滚动的效果是背景图像比前景中的元素滚动得慢，从而产生页面深度的错觉。网站经常在信息页面中使用这种方式，在这种页面中，一些文本在前景中，图像在背景中，滚动速度较慢，为用户创造更有趣的体验。</p><p id="a8dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ld" href="https://www.mockplus.com/blog/post/parallax-scrolling-websites" rel="noopener ugc nofollow" target="_blank">本页</a>有一些视差滚动的网页示例。</p><p id="6cc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了开始构建应用程序，我们通过运行Create React App来创建应用程序。运行<code class="fe kl km kn ko b">npx create-react-app scrolling-app</code>构建app的骨架。一旦运行完成，我们安装一些软件包。我们需要安装Axios来从Pixabay API获取图像，安装Bootstrap来进行样式设计，安装React Router来将URL路由到我们创建的页面，安装<code class="fe kl km kn ko b">react-parallax</code>来创建视差滚动效果。</p><p id="6944" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们编写视差滚动应用程序的代码。在<code class="fe kl km kn ko b">App.js</code>中，我们用以下代码替换现有代码:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="d8e2" class="kx ky iq ko b gy kz la l lb lc">import React from "react";<br/>import TopBar from "./TopBar";<br/>import { Router, Route, Link } from "react-router-dom";<br/>import { createBrowserHistory as createHistory } from "history";<br/>import HomePage from "./HomePage";<br/>import "./App.css";<br/>const history = createHistory();</span><span id="24b6" class="kx ky iq ko b gy le la l lb lc">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Router history={history}&gt;<br/>        &lt;TopBar /&gt;<br/>        &lt;Route path="/" exact component={HomePage} /&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="d1a3" class="kx ky iq ko b gy le la l lb lc">export default App;</span></pre><p id="c720" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们添加了一个将要创建的顶栏，以及一个到React路由器主页的路由。</p><p id="a3df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们创建视差滚动应用程序的主页。在<code class="fe kl km kn ko b">src</code>文件夹中创建一个名为<code class="fe kl km kn ko b">HomePage.js</code>的文件，并添加以下内容:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="50be" class="kx ky iq ko b gy kz la l lb lc">import React, { useState, useEffect } from "react";<br/>import { Parallax, Background } from "react-parallax";<br/>import "./HomePage.css";<br/>import { getPhotos } from "./requests";</span><span id="b5f3" class="kx ky iq ko b gy le la l lb lc">const insideStyles = {<br/>  background: "transparent",<br/>  padding: 20,<br/>  position: "absolute",<br/>  top: "50%",<br/>  left: "50%",<br/>  transform: "translate(-50%,-50%)",<br/>};</span><span id="477b" class="kx ky iq ko b gy le la l lb lc">function HomePage() {<br/>  const [initialized, setInitialized] = useState(false);<br/>  const [images, setImages] = useState([]);<br/>  const [layers, setLayers] = useState([]);</span><span id="4ec5" class="kx ky iq ko b gy le la l lb lc">const loadImages = async () =&gt; {<br/>    const response = await getPhotos();<br/>    setImages(response.data.hits);<br/>  };</span><span id="7a54" class="kx ky iq ko b gy le la l lb lc">useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      loadImages();<br/>      setInitialized(true);<br/>    }<br/>  });<br/>  return (<br/>    &lt;div className="home-page"&gt;<br/>      {images.map((img, i) =&gt; {<br/>        return (<br/>          &lt;&gt;<br/>            &lt;Parallax<br/>              blur={10}<br/>              bgImage={img.userImageURL}<br/>              bgImageAlt={img.tags}<br/>              strength={600}<br/>              renderLayer={percentage =&gt; (<br/>                &lt;div&gt;<br/>                  &lt;div<br/>                    style={{<br/>                      position: "absolute",<br/>                      background: `white`,<br/>                      left: "50%",<br/>                      top: "50%",<br/>                      borderRadius: "50%",<br/>                      transform: "translate(-50%,-50%)",<br/>                      width: percentage * 500,<br/>                      height: percentage * 500,<br/>                    }}<br/>                  /&gt;<br/>                &lt;/div&gt;<br/>              )}<br/>            &gt;<br/>              &lt;div style={{ height: 500 }}&gt;<br/>                &lt;div style={insideStyles}&gt;{img.tags}&lt;/div&gt;<br/>              &lt;/div&gt;<br/>            &lt;/Parallax&gt;<br/>          &lt;/&gt;<br/>        );<br/>      })}<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="98e7" class="kx ky iq ko b gy le la l lb lc">export default HomePage;</span></pre><p id="2bbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个页面中，当页面第一次加载时，我们首先用函数<code class="fe kl km kn ko b">loadImages</code>中的Pixabay API加载图像。我们检查页面是否是<code class="fe kl km kn ko b">initialized</code>。如果不是，那么我们加载图像。一旦图像被加载，我们通过将图像数据映射到由<code class="fe kl km kn ko b">react-parallax</code>提供的<code class="fe kl km kn ko b">Parallax</code>组件来显示它们。<code class="fe kl km kn ko b">strength</code>属性指定了为创建视差滚动而转换的像素数量。这个数字的绝对数越高，前景和背景的滚动速度差异就会越明显。</p><p id="d57e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe kl km kn ko b">Parallax</code>组件中，我们指定想要显示的内容。我们指定显示来自Pixabay API的图像附带的标记文本。</p><p id="631d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">renderLayer</code>道具让我们显示前景和背景之间的元素，我们可以通过使用函数adjust dimensions中的<code class="fe kl km kn ko b">percentage</code>参数来激活这里定义的元素。例如，在本页中，我们用<code class="fe kl km kn ko b">percentage</code>调整<code class="fe kl km kn ko b">width</code>和<code class="fe kl km kn ko b">height</code>。</p><p id="77cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">bgImage</code>是我们图像的URL，<code class="fe kl km kn ko b">bgImageAlt</code>是背景图像的<code class="fe kl km kn ko b">alt</code>属性。<code class="fe kl km kn ko b">blur</code> prop指定背景图像的模糊程度。</p><p id="45dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们创建从Pixabay API获取图像的文件。在<code class="fe kl km kn ko b">src</code>文件夹中创建一个名为<code class="fe kl km kn ko b">requests.js</code>的文件，并添加以下代码:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="f7f8" class="kx ky iq ko b gy kz la l lb lc">const axios = require("axios");<br/>const apiUrl = "<a class="ae ld" href="https://pixabay.com/api" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/api</a>";</span><span id="49c8" class="kx ky iq ko b gy le la l lb lc">export const getPhotos = () =&gt;<br/>  axios.get(`${apiUrl}/?key=${[process.env.REACT_APP_APIKEY]}`);</span></pre><p id="3359" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">API键在项目根文件夹的<code class="fe kl km kn ko b">.env</code>文件中定义。环境变量的关键字是<code class="fe kl km kn ko b">REACT_APP_APIKEY</code>。</p><p id="9285" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe kl km kn ko b">.env</code>文件中，我们有:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="f0b3" class="kx ky iq ko b gy kz la l lb lc">REACT_APP_APIKEY='your api key'</span></pre><p id="7963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们为图像创建一个顶栏。在<code class="fe kl km kn ko b">src</code>文件夹中创建一个名为<code class="fe kl km kn ko b">TopBar.js</code>的文件，并添加:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="f928" class="kx ky iq ko b gy kz la l lb lc">import React from "react";<br/>import Navbar from "react-bootstrap/Navbar";<br/>import Nav from "react-bootstrap/Nav";<br/>import "./TopBar.css";<br/>import { withRouter } from "react-router-dom";</span><span id="3ee5" class="kx ky iq ko b gy le la l lb lc">function TopBar({ location }) {<br/>  const { pathname } = location;</span><span id="7a8c" class="kx ky iq ko b gy le la l lb lc">return (<br/>    &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>      &lt;Navbar.Brand href="#home"&gt;Scrolling App&lt;/Navbar.Brand&gt;<br/>      &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>      &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>        &lt;Nav className="mr-auto"&gt;<br/>          &lt;Nav.Link href="/" active={pathname == "/"}&gt;<br/>            Home<br/>          &lt;/Nav.Link&gt;<br/>        &lt;/Nav&gt;<br/>      &lt;/Navbar.Collapse&gt;<br/>    &lt;/Navbar&gt;<br/>  );<br/>}</span><span id="d1a7" class="kx ky iq ko b gy le la l lb lc">export default withRouter(TopBar);</span></pre><p id="d6ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用React Bootstrap中的<code class="fe kl km kn ko b">Navbar</code>创建顶栏，并用<code class="fe kl km kn ko b">withRouter</code>函数包装组件，这样我们就可以将<code class="fe kl km kn ko b">location</code>属性传递给组件。这让我们通过检查<code class="fe kl km kn ko b">location</code>属性的<code class="fe kl km kn ko b">pathname</code>属性来检查用户所在页面的URL，让我们动态设置<code class="fe kl km kn ko b">Nav.Link</code>的<code class="fe kl km kn ko b">active</code>属性。</p><p id="42ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，在<code class="fe kl km kn ko b">index.html</code>中，我们用以下代码替换现有代码:</p><pre class="kp kq kr ks gt kt ko ku kv aw kw bi"><span id="9de6" class="kx ky iq ko b gy kz la l lb lc">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;meta name="theme-color" content="#000000" /&gt;<br/>    &lt;meta<br/>      name="description"<br/>      content="Web site created using create-react-app"<br/>    /&gt;<br/>    &lt;link rel="apple-touch-icon" href="logo192.png" /&gt;<br/>    &lt;!--<br/>      manifest.json provides metadata used when your web app is installed on a<br/>      user's mobile device or desktop. See <a class="ae ld" href="https://developers.google.com/web/fundamentals/web-app-manifest/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/fundamentals/web-app-manifest/</a><br/>    --&gt;<br/>    &lt;link rel="manifest" href="%PUBLIC_URL%/manifest.json" /&gt;<br/>    &lt;!--<br/>      Notice the use of %PUBLIC_URL% in the tags above.<br/>      It will be replaced with the URL of the `public` folder during the build.<br/>      Only files inside the `public` folder can be referenced from the HTML.</span><span id="9647" class="kx ky iq ko b gy le la l lb lc">Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will<br/>      work correctly both with client-side routing and a non-root public URL.<br/>      Learn how to configure a non-root public URL by running `npm run build`.<br/>    --&gt;<br/>    &lt;title&gt;Parallax App&lt;/title&gt;<br/>    &lt;link<br/>      rel="stylesheet"<br/>      href="<a class="ae ld" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"<br/>      crossorigin="anonymous"<br/>    /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;<br/>    &lt;div id="root"&gt;&lt;/div&gt;<br/>    &lt;!--<br/>      This HTML file is a template.<br/>      If you open it directly in the browser, you will see an empty page.</span><span id="f953" class="kx ky iq ko b gy le la l lb lc">You can add webfonts, meta tags, or analytics to this file.<br/>      The build step will place the bundled scripts into the &lt;body&gt; tag.</span><span id="b4a1" class="kx ky iq ko b gy le la l lb lc">To begin the development, run `npm start` or `yarn start`.<br/>      To create a production bundle, use `npm run build` or `yarn build`.<br/>    --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="fb71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们添加了引导CSS并改变了这个文件的标题。</p><p id="dcee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后我们得到:</p><figure class="kp kq kr ks gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/dc929d4e6b145dd76ce49f9553129de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-ngHTRIocgmjYslPEQbew.png"/></div></div></figure></div></div>    
</body>
</html>