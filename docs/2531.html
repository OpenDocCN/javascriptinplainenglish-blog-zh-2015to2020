<html>
<head>
<title>JavaScript Problems — Update the Address Bar, Running Command Line Programs, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript问题—更新地址栏、运行命令行程序等等</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-problems-update-the-address-bar-running-command-line-programs-6a5a86a9f6e1?source=collection_archive---------12-----------------------#2020-07-02">https://javascript.plainenglish.io/javascript-problems-update-the-address-bar-running-command-line-programs-6a5a86a9f6e1?source=collection_archive---------12-----------------------#2020-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4ab99062149676babd10c2a2ff0e042b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f7BdnpCcEVy3Yjh8"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@noaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">NOAA</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2457" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="f02f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用不带哈希的新URL更新地址栏，或者重新加载页面</h1><p id="c98b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用<code class="fe me mf mg mh b">window.history.pushState</code>方法将地址栏中的URL改为一个新的URL，而无需重新加载页面。</p><p id="9f25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="babc" class="mq lc iq mh b gy mr ms l mt mu">window.history.pushState("data", "title", "/new-url");</span></pre><p id="bd89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是我们要传递给URL的数据。</p><p id="fbc1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个参数是标题，这是大多数浏览器所忽略的。</p><p id="655b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三是新的网址本身。</p><p id="4046" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者，我们可以使用<code class="fe me mf mg mh b">document.location.href</code>来改变没有<code class="fe me mf mg mh b">pushState</code>的浏览器上的URL。</p><p id="9c7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="899b" class="mq lc iq mh b gy mr ms l mt mu">document.location.href = "/new-url";</span></pre><h1 id="5b9e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用Node.js运行命令行二进制文件</h1><p id="c153" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要用Node.js运行命令行程序，我们可以使用<code class="fe me mf mg mh b">child_process</code>模块的<code class="fe me mf mg mh b">exec</code>方法。</p><p id="cdab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比如m w可以写；e:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6777" class="mq lc iq mh b gy mr ms l mt mu">const { exec } = require('child_process');<br/>exec('cat *.js &gt; jsFile', (err, stdout, stderr) =&gt; {<br/>  if (err) {<br/>    return;<br/>  }<br/>  console.log(`stdout: ${stdout}`);<br/>  console.log(`stderr: ${stderr}`);<br/>});</span></pre><p id="ae40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们运行<code class="fe me mf mg mh b">cat</code>命令并在回调中记录输出。</p><p id="3f6a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">exec</code>的promise版本做同样的事情。</p><p id="e036" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="157b" class="mq lc iq mh b gy mr ms l mt mu">const util = require('util');<br/>const exec = util.promisify(require('child_process').exec);</span><span id="3286" class="mq lc iq mh b gy mv ms l mt mu">const ls = async () =&gt; {<br/>  const { stdout, stderr } = await exec('ls');<br/>  console.log('stdout:', stdout);<br/>  console.log('stderr:', stderr);<br/>}<br/>ls();</span></pre><p id="54f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">child_process</code>的<code class="fe me mf mg mh b">exec</code>方法转化为承诺。</p><p id="f705" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用它来获取内容<code class="fe me mf mg mh b">ls</code>并将它们记录到控制台。</p><p id="5cfc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有一个名为<code class="fe me mf mg mh b">execSync</code>的同步版本的<code class="fe me mf mg mh b">exec</code>函数。</p><p id="065d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="962c" class="mq lc iq mh b gy mr ms l mt mu">const { execSync } = require('child_process');<br/>const stdout = execSync('ls');</span></pre><p id="333f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只是像其他代码一样一行一行地运行它。</p><h1 id="ae17" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用jQuery获取选定的元素标记名</h1><p id="40d6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">prop</code>属性获得元素的标签名。</p><p id="9d45" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3f22" class="mq lc iq mh b gy mr ms l mt mu">$("a").prop("tagName");</span></pre><p id="83fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">获取一个<code class="fe me mf mg mh b">a</code>元素的标签名。</p><p id="4185" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以将它与其他选择器一起使用。</p><h1 id="a03e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">JavaScript绑定方法的目的</h1><p id="5408" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">bind</code>方法用于根据我们的需要改变函数中<code class="fe me mf mg mh b">this</code>的值。</p><p id="006c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回一个带有新值<code class="fe me mf mg mh b">thi</code>的函数。</p><p id="f433" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9844" class="mq lc iq mh b gy mr ms l mt mu">const myButton = {<br/>  content: 'OK',<br/>  click() {<br/>    console.log(this.content);<br/>  }<br/>};</span></pre><p id="7e93" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">this.content</code>应该是<code class="fe me mf mg mh b">'OK'</code>，因为它是<code class="fe me mf mg mh b">this</code>对<code class="fe me mf mg mh b">myButton</code>的引用。</p><p id="c711" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要改变<code class="fe me mf mg mh b">this.content</code>的值，我们可以通过编写调用<code class="fe me mf mg mh b">bind</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2538" class="mq lc iq mh b gy mr ms l mt mu">const boundClick = myButton.click.bind({ content: 'Cancel' });</span></pre><p id="b448" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">bind</code>将<code class="fe me mf mg mh b">this</code>的值设置为:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="86fc" class="mq lc iq mh b gy mr ms l mt mu">{ content: 'Cancel' }</span></pre><p id="9887" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当我们通过写<code class="fe me mf mg mh b">boundClick()</code>来调用<code class="fe me mf mg mh b">boundClick</code>时，我们看到<code class="fe me mf mg mh b">'Cancel'</code>被记录了。</p><h1 id="3c91" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">通过对象的属性来定义数组</h1><p id="f72e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过将回调传入<code class="fe me mf mg mh b">sort</code>方法，根据条目的属性对数组中的条目进行排序。</p><p id="46b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="521b" class="mq lc iq mh b gy mr ms l mt mu">people.sort((a, b) =&gt; {<br/>  if(a.firstname &lt; b.firstname) { return -1; }<br/>  if(a.firstname &gt; b.firstname) { return 1; }<br/>  return 0;<br/>})</span></pre><p id="ae03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用比较运算符比较字符串。</p><p id="ca53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">字符串按其字符串字符的代码点逐一比较排序。</p><p id="697b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果返回的数字小于0，则<code class="fe me mf mg mh b">a</code>的指数低于<code class="fe me mf mg mh b">b</code>。</p><p id="429f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果返回的数字大于0，则<code class="fe me mf mg mh b">b</code>的索引低于<code class="fe me mf mg mh b">a</code>。</p><p id="027f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，它保持不变。</p><p id="5874" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了进行区分区域的比较，我们使用<code class="fe me mf mg mh b">localeCompare</code>进行比较。</p><p id="c4f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1c5c" class="mq lc iq mh b gy mr ms l mt mu">people.sort((a, b) =&gt; a.firstname.localeCompare(b.firstname))</span></pre><h1 id="a43c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">延迟按键处理程序</h1><p id="dbe2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过使用<code class="fe me mf mg mh b">setTimeout</code>功能来延迟<code class="fe me mf mg mh b">keyup </code>处理程序的运行时间。</p><p id="09d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在每次<code class="fe me mf mg mh b">keyup </code>事件触发时重置超时，这样每次按键时都会发生延迟。</p><p id="7e77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0e13" class="mq lc iq mh b gy mr ms l mt mu">const delay = (fn, ms) =&gt; {<br/>  let timer = 0;<br/>  return (...args) =&gt; {<br/>    clearTimeout(timer)<br/>    timer = setTimeout(fn.bind(this, ...args), ms || 0)<br/>  }<br/>}</span></pre><p id="d881" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过书写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="58a0" class="mq lc iq mh b gy mr ms l mt mu">$('#input').keyup(delay(function (e) {<br/>  console.log(this.value);<br/>}, 500));</span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/a1a327a632b3d22ba5db16ca99767eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-xDtJ4nbWq1JpQAR"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@ffrige?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Fabrizio Frigeni</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="b6e9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="bb77" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">pushState</code>方法更改网址，而无需刷新页面。</p><p id="1bbe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">bind</code>方法用于通过返回一个新的函数来改变<code class="fe me mf mg mh b">this</code>的值。</p><p id="6148" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过<code class="fe me mf mg mh b">exec</code>方法从节点程序运行命令行程序。</p><h1 id="2a4d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简单英语中的JavaScript</h1><p id="2c35" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四个出版物和一个YouTube频道吗？在<a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">找到他们所有人。点击</strong> </a>和<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>