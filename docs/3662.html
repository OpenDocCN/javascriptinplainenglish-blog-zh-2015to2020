<html>
<head>
<title>Better JavaScript — Function Calls</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更好的JavaScript —函数调用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/better-javascript-function-calls-3c94143ba624?source=collection_archive---------14-----------------------#2020-10-15">https://javascript.plainenglish.io/better-javascript-function-calls-3c94143ba624?source=collection_archive---------14-----------------------#2020-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6ef0acd055c269895f1d528e2f552885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gCfu10mxrwttJ63J"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@timmossholder?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tim Mossholder</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8322" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究改进JavaScript代码的方法。</p><h1 id="daf6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用apply调用具有不同数量参数的函数</h1><p id="0eb9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">apply</code>方法让我们调用一个值为<code class="fe me mf mg mh b">this</code>的函数和一个带参数的数组。</p><p id="1619" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2272" class="mq lc iq mh b gy mr ms l mt mu">const min = Math.min.apply(null, [1, 2, 3]);</span></pre><p id="aaf6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是<code class="fe me mf mg mh b">this</code>的值，它可以是任何值，因为<code class="fe me mf mg mh b">Math.min</code>是一个静态方法。</p><p id="c169" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">剩下的就是论据了。</p><p id="3a11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们可以调用一个参数数量可变的函数。</p><p id="54ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以通过从函数中获取值来使用它。</p><p id="e7a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b47c" class="mq lc iq mh b gy mr ms l mt mu">const buffer = {<br/>  state: [],<br/>  append(...args) {<br/>    for (const a of args) {<br/>      this.state.push(a);<br/>    }<br/>  }<br/>};</span></pre><p id="ae6d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了<code class="fe me mf mg mh b">args</code>,其中有参数。</p><p id="999e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们将项目推入<code class="fe me mf mg mh b">this.state</code>数组。</p><p id="1ad8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c524" class="mq lc iq mh b gy mr ms l mt mu">buffer.append.apply(buffer, [1, 2, 3]);</span></pre><h1 id="db39" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Rest运算符创建变量函数</h1><p id="955c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用rest操作符来获取函数的所有参数。</p><p id="7f5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="95d7" class="mq lc iq mh b gy mr ms l mt mu">function average(...args) {<br/>  let sum = 0;<br/>  for (const a of args) {<br/>    sum += a;<br/>  }<br/>  return sum / args.length;<br/>}</span></pre><p id="783d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从rest操作符生成的<code class="fe me mf mg mh b">args</code>数组中获取参数数组。</p><p id="d68c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以循环遍历这些项目并得到总和。</p><p id="3278" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用它除以<code class="fe me mf mg mh b">args</code>数组的长度。</p><p id="32f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这比使用<code class="fe me mf mg mh b">arguments</code>对象来获取参数要好。</p><h1 id="abb6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要使用参数来创建变量函数</h1><p id="d7e9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">rest操作符替换<code class="fe me mf mg mh b">arguments</code>对象以获得可变数量的参数。</p><p id="b745" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们不应该写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6b63" class="mq lc iq mh b gy mr ms l mt mu">function average() {<br/>  let sum = 0;<br/>  for (const a of arguments) {<br/>    sum += a;<br/>  }<br/>  return sum / args.length;<br/>}</span></pre><p id="f0fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相反，我们应该使用rest操作符。</p><p id="c3cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它也只能与传统的功能，而不是箭头功能，所以它的使用是有限的。</p><h1 id="b57d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要修改arguments对象</h1><p id="8260" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">arguments</code>对象看起来像数组，但它不是数组。</p><p id="975d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它没有任何数组方法。</p><p id="50ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，使用<code class="fe me mf mg mh b">call</code>方法，我们可以像这样调用数组方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6b1a" class="mq lc iq mh b gy mr ms l mt mu">const shift = [].shift;<br/>shift.call(arguments);</span></pre><p id="e882" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3108" class="mq lc iq mh b gy mr ms l mt mu">const obj = {<br/>  add(x, y) {<br/>    return x + y;<br/>  }<br/>};</span><span id="5a36" class="mq lc iq mh b gy mv ms l mt mu">function call(obj, method) {<br/>  const shift = [].shift;<br/>  shift.call(arguments);<br/>  shift.call(arguments);<br/>  return obj[method].apply(obj, arguments);<br/>}</span><span id="327d" class="mq lc iq mh b gy mv ms l mt mu">call(obj, 'add', 1, 2, 3)</span></pre><p id="ccd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将导致错误“未捕获的类型错误:无法读取undefined的属性“apply”。</p><p id="3f28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们不能改变<code class="fe me mf mg mh b">arguements</code>对象来调用带有参数的对象。</p><h1 id="4bef" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用绑定到库里函数</h1><p id="e4e7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">bind</code>方法让我们返回一个内部带有值<code class="fe me mf mg mh b">this</code>的函数。</p><p id="52db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它还可以用于返回一个新函数，并应用现有函数的一些参数。</p><p id="f823" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有以下函数:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dec7" class="mq lc iq mh b gy mr ms l mt mu">function add(x, y) {<br/>  return x + y;<br/>}</span></pre><p id="853f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以使用<code class="fe me mf mg mh b">bind</code>创建一个函数，通过编写第一个参数:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="870b" class="mq lc iq mh b gy mr ms l mt mu">const add2 = add.bind(null, 2);</span></pre><p id="b543" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是<code class="fe me mf mg mh b">this</code>的值。</p><p id="975f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">后面的参数是函数的参数。</p><p id="3b11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f301" class="mq lc iq mh b gy mr ms l mt mu">const sum  = add2(3);</span></pre><p id="cb15" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而<code class="fe me mf mg mh b">sum</code>将是5。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/9952b2a8959c48e1648c5860482dc8a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pM6mxO5n_m8_2FDW"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@enginakyurt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">engin akyurt</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="73a1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="6ae5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">apply</code>和<code class="fe me mf mg mh b">bind</code>对于改变函数的<code class="fe me mf mg mh b">this</code>值和应用参数很有用。</p><p id="b0b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">apply</code>调用该函数，<code class="fe me mf mg mh b">bind</code>返回一个新函数，并应用这些值。</p><p id="3c38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅获取更多类似内容解码，我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>