<html>
<head>
<title>Render dynamically a .docx file with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨JavaScriptåŠ¨æ€å‘ˆç°. docxæ–‡ä»¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/render-dynamically-a-docx-file-with-javascript-daaed816fcb8?source=collection_archive---------1-----------------------#2019-12-20">https://javascript.plainenglish.io/render-dynamically-a-docx-file-with-javascript-daaed816fcb8?source=collection_archive---------1-----------------------#2019-12-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/2340406a5795a6e231ada048711d1e28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gbvASll85Qf3PnzY"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@mr_vero?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Irvan Smith</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="042d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ–¯ç‰¹å‡¡è¯ºï¼Œè¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼è¯·éšæ„ç»™æˆ‘ä¸€äº›å…³äºå†™ä½œæˆ–ä¸è¿™ç¯‡æ–‡ç« ç›¸å…³çš„å»ºè®®ğŸ™ŒğŸ»<br/>åŸæ–‡<a class="ae jz" href="https://dev.to/sintj_/render-dynamically-a-docx-file-with-javascript-3mef" rel="noopener ugc nofollow" target="_blank">æ­¤å¤„</a> (dev.to)ã€‚</p></div><div class="ab cl ky kz hr la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ig ih ii ij ik"><h1 id="f15e" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">éœ€æ±‚</h1><p id="840a" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">æˆ‘æ­£åœ¨ç”¨Vueæ„å»ºä¸€ä¸ªwebappã€‚JS + Nuxtã€‚æˆ‘çš„ä¸€ä¸ªå®¢æˆ·çš„JS:è¿™ä¸ªåº”ç”¨ç¨‹åºçš„ç›®çš„æ˜¯åŸºäºä»–ä»¬åˆ¶é€ çš„äº§å“åˆ›å»ºææ¡ˆï¼Œè®¡ç®—ä»·æ ¼å’Œä¸€å †å…¶ä»–äº‹æƒ…ã€‚<br/>æœ€ç»ˆï¼Œå®Œæˆçš„ææ¡ˆéœ€è¦è½¬æ¢æˆå¯æ‰“å°çš„æ ¼å¼ã€‚</p><h1 id="1a4c" class="lf lg in bd lh li mi lk ll lm mj lo lp lq mk ls lt lu ml lw lx ly mm ma mb mc bi translated">é—®é¢˜æ˜¯</h1><p id="13c4" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">æ¯ä¸ªææ¡ˆéƒ½æœ‰ä¸åŒçš„åŸºæœ¬ä¿¡æ¯(æ ‡é¢˜ã€åˆ›å»ºæ—¥æœŸç­‰..)å’Œé‡Œé¢ä¸åŒçš„äº§å“ã€‚æ¯ä¸ªäº§å“ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œå®ƒå¯èƒ½æœ‰ä¸€äº›å…¶ä»–äº§å“æ²¡æœ‰çš„é”®/å€¼å¯¹ã€‚<br/>äº‹å®æ˜¯<strong class="kc io">æˆ‘æƒ³å¯¼å‡ºä¸€ä¸ªçœ‹èµ·æ¥æ€»æ˜¯ä¸€æ ·çš„æ–‡ä»¶(ä¸€ä¸ªæ¨¡æ¿)ï¼Œä½†ç”¨æˆ‘çš„ææ¡ˆä¸­çš„æ•°æ®æ¸²æŸ“</strong>ã€‚</p><h1 id="4955" class="lf lg in bd lh li mi lk ll lm mj lo lp lq mk ls lt lu ml lw lx ly mm ma mb mc bi translated">å·¥å…·</h1><p id="3264" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">åœ¨ç½‘ä¸Šæœç´¢æ—¶ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªåä¸º<strong class="kc io"> docxtemplater </strong>çš„éå¸¸æ£’çš„å·¥å…·ï¼Œå®ƒå®Œå…¨å¯ä»¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚<em class="mn">è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„ä½œç”¨:</em></p><p id="a01e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æƒ³è±¡ä¸€ä¸ª. docx (Wordï¼ŒGoogle Docç­‰..)åƒè¿™æ ·:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4bf9" class="mx lg in mt b gy my mz l na nb">Hello {name}!<br/>You have all these games: {#gameList}{.} {/gameList}<br/>{#hasXbox}And you have also an XBOX!{/}</span></pre><p id="29a0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç”¨<strong class="kc io"> docxtemplater </strong>ä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œä¾‹å¦‚ï¼Œåƒè¿™æ ·:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="9064" class="mx lg in mt b gy my mz l na nb">let obj = {<br/> name: `Sam`,<br/> gameList: [`Metal Gear Solid`, `Crash Bandicoot`, `Final Fantasy 7`],<br/> hasXbox: false<br/>}</span></pre><p id="9266" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æ¸²æŸ“åï¼Œæ‚¨å°†èƒ½å¤Ÿä¸‹è½½æ–‡æ¡£ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="b72d" class="mx lg in mt b gy my mz l na nb">Hello Sam!<br/>You have all these games: Metal Gear Solid Crash Bandicoot Final Fantasy 7</span></pre><p id="70a6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä½ æ³¨æ„åˆ°äº†å—ï¼Ÿ<br/> <strong class="kc io">æ•°ç»„ä¸Šçš„æ¡ä»¶å’Œå¾ªç¯æ˜¯å¯èƒ½çš„</strong>ç»™ä½ è‡ªç”±æ„å»ºä¸€ä¸ªç¬¦åˆä½ éœ€æ±‚çš„æ¨¡æ¿ã€‚<br/>ç”±äºå¸ƒå°”å€¼<em class="mn"> hasxbox </em>ï¼Œæ•´ä¸ªXboxå¥å­è¢«çœç•¥ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸€ç»„å¯¹è±¡ä¸Šå¾ªç¯ï¼Œè¿™ç»™äº†ä½ æ›´å¤šçš„èƒ½åŠ›ã€‚å…³äºæ•´ä¸ªæ–‡æ¡£ï¼Œæˆ‘å»ºè®®çœ‹ä¸€çœ‹<a class="ae jz" href="https://docxtemplater.readthedocs.io/en/latest/tag_types.html" rel="noopener ugc nofollow" target="_blank">çš„å®˜æ–¹ç½‘ç«™</a>ã€‚</p><h1 id="809a" class="lf lg in bd lh li mi lk ll lm mj lo lp lq mk ls lt lu ml lw lx ly mm ma mb mc bi translated">è®¾ç½®</h1><p id="b116" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Vueï¼Œä½†æ˜¯ä¸‹é¢çš„æ–¹æ³•å¾ˆå®¹æ˜“é€‚åº”å…¶ä»–ç¯å¢ƒã€‚</p><p id="9e6b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æ‚¨éœ€è¦<em class="mn"> npmå®‰è£…</em>ä¸€äº›ä¾èµ–é¡¹:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="b499" class="mx lg in mt b gy my mz l na nb">npm install --save docxtemplater jszip@2 jszip-utils file-saver</span></pre><p id="3ed5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mn"> docxtemplater </em>æ¥å—zipï¼Œå› æ­¤<em class="mn"> jszip </em>å’Œ<em class="mn"> jszip-utils </em>å¯¹æ­¤å¾ˆæœ‰ç”¨ï¼Œ<em class="mn"> file-saver </em>å¯¹äºä¿å­˜æ¸²æŸ“çš„æ–‡ä»¶å¾ˆæœ‰ç”¨ã€‚è®¾å¤‡ä¸Šçš„docxã€‚<br/> <em class="mn">æ³¨æ„:jszip@2ä¸ºäº†é˜²æ­¢å®‰è£…åœ¨æˆ‘çš„ç¯å¢ƒä¸­ä¼¼ä¹ä¸å·¥ä½œçš„ç‰ˆæœ¬3+:è¯·éšæ„å°è¯•ä¸¤è€…ã€‚</em></p><p id="521d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä¹Ÿå°±æ˜¯è¯´æˆ‘åƒè¿™æ ·æŠŠå®ƒä»¬å¯¼å…¥åˆ°ç»„ä»¶ä¸­:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="439a" class="mx lg in mt b gy my mz l na nb">import docxtemplater from â€˜docxtemplaterâ€™<br/>import JSzip from â€˜jszipâ€™<br/>import JSzipUtils from â€˜jszip-utilsâ€™<br/>import { saveAs } from â€˜file-saverâ€™</span></pre><p id="2238" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">åœ¨htmlæ¨¡æ¿ä¸­ï¼Œæˆ‘æœ‰è¿™ä¸ªæŒ‰é’®:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4e34" class="mx lg in mt b gy my mz l na nb">&lt;button @click=â€createDOC()â€&gt;Export DOCX&lt;/button&gt;</span></pre><p id="5331" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç„¶åæ˜¯æ–¹æ³•:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="5167" class="mx lg in mt b gy my mz l na nb">methods:{<br/>    loadFile(url,callback){<br/>        JSzipUtils.getBinaryContent(url,callback);<br/>    },<br/><br/>    createDOC(){<br/>        let prev = this.getLoadedPrev<br/>        this.loadFile('/template.docx',function(error,content){<br/>            if (error) { throw error };<br/>            let zip = new JSzip(content);<br/>            let doc = new docxtemplater().loadZip(zip)<br/>            doc.setData(prev)<br/><br/>            try {<br/>                doc.render()<br/>            }<br/><br/>            catch (error) {<br/>                let e = {<br/>                    message: error.message,<br/>                    name: error.name,<br/>                    stack: error.stack,<br/>                    properties: error.properties,<br/>                }<br/>                console.log(JSON.stringify({error: e}));<br/>                // The error thrown here contains additional information when logged with JSON.stringify (it contains a property object).<br/>                throw error;<br/>            }<br/><br/>            let out = doc.getZip().generate({<br/>                type:"blob",<br/>                mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",<br/>                })<br/>            saveAs(out,`${prev.titolo}.docx`)<br/>        })<br/>    }<br/>}</span></pre><p id="05c8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œæ–¹æ³•<em class="mn"> loadFile </em>å°†æ£€ç´¢ã€‚åº”ç”¨ç¨‹åºçš„é™æ€æ–‡ä»¶å¤¹ä¸­çš„docxæ¨¡æ¿(æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œæœ‰å¯èƒ½è®¾ç½®æ‰€æœ‰è¿™ä¸€åˆ‡ä¸èŠ‚ç‚¹æœåŠ¡å™¨ç«¯)ã€‚<br/>jszipå®ç”¨ç¨‹åºå°†å‹ç¼©ã€‚ä¸ºäº†å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„<em class="mn"> docxtemplate </em>æ–‡æ¡£è€Œä¼ é€’çš„docxã€‚</p><p id="4f92" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">åœ¨<em class="mn"> doc.setData(prev) </em>ä¸­ï¼Œæˆ‘ç”¨<strong class="kc io">ä¼ é€’ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«å…³äºå»ºè®®ä¹¦çš„æ‰€æœ‰ä¿¡æ¯(æ ‡é¢˜ã€åˆ›å»ºæ—¥æœŸã€äº§å“åˆ—è¡¨ã€ä½œè€…ç­‰..)</strong>ç„¶åå®ƒä¼šå°è¯•æ¸²æŸ“docã€‚</p><p id="0fcd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">é”™è¯¯å¤„ç†åçš„ä»£ç å—:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="a3f2" class="mx lg in mt b gy my mz l na nb">let out = doc.getZip().generate({<br/>                type:"blob",<br/>                mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",<br/>                })<br/>            saveAs(out,`${prev.titolo}.docx`)<br/>        })</span></pre><p id="2024" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è´Ÿè´£å‘ˆç°æ–‡æ¡£çš„è¾“å‡ºã€‚</p><h1 id="c003" class="lf lg in bd lh li mi lk ll lm mj lo lp lq mk ls lt lu ml lw lx ly mm ma mb mc bi translated">ç»“è®º</h1><p id="de56" class="pw-post-body-paragraph ka kb in kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨éœ€è¦ç”Ÿæˆä¸€ä¸ªPDFæ–‡ä»¶ï¼Œ<strong class="kc io">å¯ä»¥é€šè¿‡</strong>åˆ°<a class="ae jz" href="https://www.npmjs.com/package/@nativedocuments/docx-wasm" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªåŒ…</a>ã€‚å¯¹äºå¯¹Lambdaå‡½æ•°æœ‰ä¿¡å¿ƒçš„äººæ¥è¯´ï¼Œè¿™å°†æ˜¯è½»è€Œæ˜“ä¸¾çš„äº‹æƒ…ã€‚ç°åœ¨æˆ‘æ²¡æœ‰è¿™æ ·åšçš„éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘ä¸èƒ½ç”¨çœŸå®çš„ä¾‹å­æ¥å¸®åŠ©ä½ ã€‚</p><p id="c7cc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å°±è¿™äº›ï¼Œ<br/>å¹²æ¯ï¼ğŸ‘‹ğŸ»</p></div></div>    
</body>
</html>