<html>
<head>
<title>Many Ways to Rerender a Vue Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重新渲染Vue组件的许多方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/many-ways-to-rerender-a-vue-component-660376d94cc1?source=collection_archive---------0-----------------------#2020-05-14">https://javascript.plainenglish.io/many-ways-to-rerender-a-vue-component-660376d94cc1?source=collection_archive---------0-----------------------#2020-05-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0bb098ffb2fa14175306b28640e865b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tsWQMwgorS_33-nP"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@tadekl?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tadeusz Lakota</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c020" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js是一个易于使用的web应用框架，我们可以用它来开发交互式前端应用。</p><p id="4077" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将探讨重新呈现Vue组件的方法，以及哪种方法是正确的。</p><h1 id="da52" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">坏方法——重新加载整个页面</h1><p id="5caa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">拥有单页面应用程序的全部意义在于，不必重新加载整个页面来更新数据。因此，重新加载整个页面来呈现组件是不好的。</p><p id="faf8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们不应该编写类似下面这样的代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="aa48" class="mn lc iq mj b gy mo mp l mq mr">Vue.component("foo", {<br/>  data() {<br/>    return {<br/>      names: ["foo", "bar", "baz"]<br/>    };<br/>  },<br/>  methods: {<br/>    reload() {<br/>      location.reload();<br/>    }<br/>  },<br/>  template: `<br/>  &lt;div&gt;<br/>    &lt;button @click='reload'&gt;Reload&lt;/button&gt;<br/>    &lt;p v-for='n in names'&gt;{{n}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  `<br/>});</span></pre><p id="1b63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe ms mt mu mj b">location.reload()</code>，我们不应该在单页应用程序中调用它。</p><h1 id="4c87" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">另一个糟糕的方法——v-if黑客</h1><p id="378a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">仅当条件为<code class="fe ms mt mu mj b">true</code>时，<code class="fe ms mt mu mj b">v-if</code>指令才呈现页面。如果是<code class="fe ms mt mu mj b">false</code>，就不会在DOM里。</p><p id="962a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">v-if</code>黑客的工作方式是将<code class="fe ms mt mu mj b">v-if</code>条件设置为<code class="fe ms mt mu mj b">false</code>，然后通过调用<code class="fe ms mt mu mj b">$nextTick</code>在下一个DOM更新周期将其设置回<code class="fe ms mt mu mj b">true</code>。</p><p id="1383" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以编写如下代码，将渲染条件切换到<code class="fe ms mt mu mj b">false</code>，然后在下一个更新周期将其切换回<code class="fe ms mt mu mj b">true</code>:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a6fb" class="mn lc iq mj b gy mo mp l mq mr">Vue.component("foo", {<br/>  data() {<br/>    return {<br/>      names: ["foo", "bar", "baz"],<br/>      render: true<br/>    };<br/>  },<br/>  methods: {<br/>    reload() {<br/>      this.render = false;<br/>      this.$nextTick(() =&gt; {<br/>        this.render = true;<br/>      });<br/>    }<br/>  },<br/>  template: `<br/>  &lt;div v-if='render'&gt;<br/>    &lt;button @click='reload'&gt;Reload&lt;/button&gt;<br/>    &lt;p v-for='n in names'&gt;{{n}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  `<br/>});</span></pre><p id="e209" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们是这样写的:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8282" class="mn lc iq mj b gy mo mp l mq mr">this.render = false;<br/>this.$nextTick(() =&gt; {<br/>  this.render = true;<br/>});</span></pre><p id="1db3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe ms mt mu mj b">this.render</code>设置为<code class="fe ms mt mu mj b">false</code>，然后在<code class="fe ms mt mu mj b">$nextTick</code>回调中将<code class="fe ms mt mu mj b">this.render</code>设置回<code class="fe ms mt mu mj b">true</code>。这将把div从DOM中移除，然后再把它放回去。</p><p id="e350" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将在调用<code class="fe ms mt mu mj b">$nextTick</code>回调后删除旧的div组件并创建一个新的div组件。</p><p id="c0e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">$nexTick</code>也返回一个承诺，所以我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="45f1" class="mn lc iq mj b gy mo mp l mq mr">Vue.component("foo", {<br/>  data() {<br/>    return {<br/>      names: ["foo", "bar", "baz"],<br/>      render: true<br/>    };<br/>  },<br/>  methods: {<br/>    async reload() {<br/>      this.render = false;<br/>      await this.$nextTick();<br/>      this.render = true;<br/>    }<br/>  },<br/>  template: `<br/>  &lt;div v-if='render'&gt;<br/>    &lt;button @click='reload'&gt;Reload&lt;/button&gt;<br/>    &lt;p v-for='n in names'&gt;{{n}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  `<br/>});</span></pre><h1 id="1929" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更好的方法—调用$forceUpdate</h1><p id="88d1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以调用<code class="fe ms mt mu mj b">$forceUpdate</code>来强制更新一个Vue组件。<code class="fe ms mt mu mj b">$forceUpdate</code>不会刷新计算属性的值，所以对刷新计算属性不起作用。</p><p id="f48e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使用它，我们可以编写以下代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9e16" class="mn lc iq mj b gy mo mp l mq mr">Vue.component("foo", {<br/>  data() {<br/>    return {<br/>      names: ["foo", "bar", "baz"],<br/>    };<br/>  },<br/>  methods: {<br/>    reload() {<br/>      this.$forceUpdate();<br/>    }<br/>  },<br/>  template: `<br/>  &lt;div&gt;<br/>    &lt;button @click='reload'&gt;Reload&lt;/button&gt;<br/>    &lt;p v-for='n in names'&gt;{{n}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  `<br/>});</span></pre><p id="6161" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需要添加<code class="fe ms mt mu mj b">this.$forceUpdate();</code>就可以让组件重新加载。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/9b1446c04641070f43db38877a9fdcea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*94o6P2srhJaq6PsD"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@shimikumi32?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kumiko SHIMIZU</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="3850" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最好的方法——添加关键道具</h1><p id="9d39" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">确保我们的项目正确刷新的最好方法是给我们渲染的项目添加一个具有唯一值的<code class="fe ms mt mu mj b">key</code>道具。只有当<code class="fe ms mt mu mj b">key</code>值与我们正在更新的相匹配时，它才会重新创建组件。</p><p id="803b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ms mt mu mj b">key</code>必须绑定到列表上的特定项目，这样Vue就知道要更新什么。如果是这种情况，它将只重新呈现列表中已更改的项目，因为它知道哪个对象是由我们将<code class="fe ms mt mu mj b">key</code>值设置为的唯一ID更新的。</p><p id="7173" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以给我们的<code class="fe ms mt mu mj b">v-for</code>物品添加一个<code class="fe ms mt mu mj b">key</code>道具，如下所示:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="548c" class="mn lc iq mj b gy mo mp l mq mr">Vue.component("foo", {<br/>  data() {<br/>    return {<br/>      names: [<br/>        { id: 1, name: "foo" },<br/>        { id: 2, name: "bar" },<br/>        { id: 3, name: "baz" }<br/>      ]<br/>    };<br/>  },<br/>  template: `<br/>  &lt;div&gt;    <br/>    &lt;p v-for='n in names' :key='n.id'&gt;{{n.name}}&lt;/p&gt;<br/>  &lt;/div&gt;<br/>  `<br/>});</span></pre><p id="d52f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需用我们想要的值绑定到<code class="fe ms mt mu mj b">key</code>属性，它会根据需要更新。</p><h1 id="b0ee" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1f7a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">确保<code class="fe ms mt mu mj b">v-for</code>项目正确重新呈现的最佳方式是使用<code class="fe ms mt mu mj b">key</code>道具。我们只需要传入一个唯一的ID。<code class="fe ms mt mu mj b">$forceUpdate</code>如果需要，也可以用来重新加载页面。</p><p id="75ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们永远不应该使用黑客或重新加载整个页面。</p><h2 id="e34c" class="mn lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="d01b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="kf ir">JavaScript in Plain English</strong></a><a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！我们还推出了一个YouTube，希望你能通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的简明英语频道</strong> </a>来支持我们</p><p id="7a56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一如既往,“简明英语”希望帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>