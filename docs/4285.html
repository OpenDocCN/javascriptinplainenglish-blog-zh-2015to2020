<html>
<head>
<title>Decouple SDK Code From Core React Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将SDK代码从核心React代码中分离出来</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/decouple-external-services-from-your-core-ui-code-dd490f91ae49?source=collection_archive---------10-----------------------#2020-11-30">https://javascript.plainenglish.io/decouple-external-services-from-your-core-ui-code-dd490f91ae49?source=collection_archive---------10-----------------------#2020-11-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c474" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">并根据开放/封闭原则减少未来PRs的大小</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e142f792d3e1cae8fc2aebb874e25eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p37cH3mNXH_Z2wtXprcT2Q.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">KNOW YOUR ENEMY (image by <a class="ae ks" href="https://unsplash.com/photos/CatcixzdUcg" rel="noopener ugc nofollow" target="_blank">Klara Kulikova</a>, meme from <a class="ae ks" href="https://programming-memes.com/spaghetti-code-know-your-enemy/" rel="noopener ugc nofollow" target="_blank">Programming Memes</a>)</figcaption></figure></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="a5ee" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">假设我使用外部服务提供商来处理我的电子商务应用程序的支付，我需要嵌入一些外部SDK代码来将支付服务集成到我的应用程序中。</p><p id="825a" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在这个过于简单的例子中，假设支付服务负责根据客户的设备、地区等检查给定的支付方式(例如Apple Pay和Google Pay)是否可用。而我的“核心”UI组件<code class="fe lw lx ly lz b">PaymentOptions</code>负责将可用的支付方式呈现为选项。最后，我希望在未来增加新的支付方式的灵活性(对于📈💰原因)。</p><p id="5850" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我可以这样写。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="4302" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">然而，UI代码与来自支付服务的外部代码紧密耦合，即<strong class="lc io">我必须修改</strong> <code class="fe lw lx ly lz b"><strong class="lc io">PaymentOptions</strong></code> <strong class="lc io">组件，以便添加新的支付方式或进行SDK更新。</strong></p><p id="af8d" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我也许可以将SDK代码分解到一个单独的钩子中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="1690" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><strong class="lc io">我还必须修改</strong> <code class="fe lw lx ly lz b"><strong class="lc io">PaymentOptions</strong></code> <strong class="lc io">和任何其他共享</strong> <code class="fe lw lx ly lz b"><strong class="lc io">usePaymentMethods</strong></code> <strong class="lc io">钩子的组件，如果我想添加的话，例如</strong> <code class="fe lw lx ly lz b"><strong class="lc io">isPaypalAvailable</strong></code> <strong class="lc io">。</strong></p><p id="9b42" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">为了最小化未来PRs的大小，我一直在思考开放/封闭原则，即SOLID中的“O”(查看这个优秀的<a class="ae ks" href="https://medium.com/better-programming/revisiting-solid-927e6a5202d3" rel="noopener">解释者</a>):<em class="mc">一个软件工件应该对扩展开放，但对修改关闭。</em></p><p id="3d1d" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">用我自己的话来说:<em class="mc">我应该以这样一种方式设计这个功能，如果我将来要添加新的支付方式(开放扩展)，我不必接触我编写的任何原始代码(关闭修改)。</em></p><p id="dc5b" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">以下是我对这一原则的看法。让我们将支付服务分离到它自己的模块中:一个简单的对象，其中每个键代表一种支付方法。每个支付方法键都指向一个具有<code class="fe lw lx ly lz b">isAvailable</code>属性(使用SDK代码的函数)和<code class="fe lw lx ly lz b">component</code>属性(支付选项的UI组件)的对象。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="c0ae" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">将<code class="fe lw lx ly lz b">paymentServiceModule</code>导入到<code class="fe lw lx ly lz b">PaymentOptions</code>组件中。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="3d74" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated"><code class="fe lw lx ly lz b">PaymentOptions</code>现在与SDK实现细节脱钩，不知道具体的支付方式。</p><p id="6859" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">当我想用一种新的支付方式(如PayPal)来扩展这一功能时，<strong class="lc io">只需将新的键/值对插入到</strong> <code class="fe lw lx ly lz b"><strong class="lc io">paymentServiceModule</strong></code> <strong class="lc io">中，而无需修改</strong> <code class="fe lw lx ly lz b"><strong class="lc io">PaymentOptions</strong></code> <strong class="lc io">组件或原始的支付方式。</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="a8a8" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">如果我要改变支付服务提供商(例如💸原因)只要支付方式的鸭子类型保持不变。</p><p id="0101" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">我是否正确地应用了开放/封闭原则？我很想了解其他遵循这一原则的React或JavaScript模式。</p></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><h1 id="7650" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated">奖金</h1><p id="e668" class="pw-post-body-paragraph la lb in lc b ld mv jo lf lg mw jr li lj mx ll lm ln my lp lq lr mz lt lu lv ig bi translated">在<code class="fe lw lx ly lz b">paymentServiceModule</code>，使用<code class="fe lw lx ly lz b"><a class="ae ks" href="https://reactjs.org/docs/code-splitting.html#reactlazy" rel="noopener ugc nofollow" target="_blank">React.lazy</a></code> API延迟加载每个支付选项。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="78c5" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">在<code class="fe lw lx ly lz b">PaymentOptions</code>中，将每个支付选项包装在<code class="fe lw lx ly lz b">Suspense</code>中，根据可用性延迟加载组件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ma mb l"/></div></figure></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><h1 id="9f29" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated"><strong class="ak">资源</strong></h1><ul class=""><li id="3a80" class="na nb in lc b ld mv lg mw lj nc ln nd lr ne lv nf ng nh ni bi translated"><a class="ae ks" href="https://medium.com/javascript-in-plain-english/a-first-step-to-improve-your-code-before-diving-into-domain-driven-design-or-the-clean-architecture-90da4a80d863" rel="noopener">在深入领域驱动设计或干净架构之前，改进代码的第一步</a></li><li id="4943" class="na nb in lc b ld nl lg nm lj nn ln no lr np lv nf ng nh ni bi translated"><a class="ae ks" href="https://medium.com/better-programming/revisiting-solid-927e6a5202d3" rel="noopener">重访固体</a>作者<a class="nj nk ep" href="https://medium.com/u/12cc371abade?source=post_page-----dd490f91ae49--------------------------------" rel="noopener" target="_blank">马修·卢卡斯</a></li></ul></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><h1 id="8ba2" class="md me in bd mf mg mh mi mj mk ml mm mn jt mo ju mp jw mq jx mr jz ms ka mt mu bi translated">阅读更多</h1><div class="nq nr gp gr ns nt"><a href="https://medium.com/javascript-in-plain-english/how-to-decouple-data-from-ui-in-react-d6b1516f4f0b" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd io gy z fp ny fr fs nz fu fw im bi translated">如何在React中将数据与UI解耦</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">第2部分:对钩子、渲染道具和特设模式的进一步探索</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh km nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://medium.com/javascript-in-plain-english/decouple-data-from-ui-with-react-hooks-6f7fe968c3e3" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd io gy z fp ny fr fs nz fu fw im bi translated">用React钩子将数据从UI解耦</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">以及我如何用JavaScript函数“编程到一个接口”</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">medium.com</p></div></div><div class="oc l"><div class="oi l oe of og oc oh km nt"/></div></div></a></div></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="5c95" class="pw-post-body-paragraph la lb in lc b ld le jo lf lg lh jr li lj lk ll lm ln lo lp lq lr ls lt lu lv ig bi translated">📫<em class="mc">我们连线上</em><a class="ae ks" href="https://www.linkedin.com/in/suhanwijaya/" rel="noopener ugc nofollow" target="_blank"><em class="mc">LinkedIn</em></a><em class="mc">或者</em> <a class="ae ks" href="mailto:suhanw@gmail.com" rel="noopener ugc nofollow" target="_blank"> <em class="mc">邮箱</em> </a> <em class="mc">！</em></p></div></div>    
</body>
</html>