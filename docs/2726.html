<html>
<head>
<title>React Tips — Getting Window Dimensions and Creating Dropdowns</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应提示-获取窗口尺寸并创建下拉列表</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-tips-getting-window-dimensions-and-creating-dropdowns-55231ad49952?source=collection_archive---------8-----------------------#2020-07-18">https://javascript.plainenglish.io/react-tips-getting-window-dimensions-and-creating-dropdowns-55231ad49952?source=collection_archive---------8-----------------------#2020-07-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a876fa1698832710478bdc8d5c47cd12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jGFxenfT74-ng1y6"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@lucija_ros?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lucija Ros</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c89c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">React是一个流行的创建网络应用和移动应用的库。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的反应应用程序的技巧。</p><h1 id="6cfb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用反应下拉更改事件</h1><p id="4da6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将事件处理程序传递给<code class="fe me mf mg mh b">onChange</code>道具，将状态设置为所选下拉列表的值。</p><p id="f5f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="da9f" class="mq lc iq mh b gy mr ms l mt mu">import React, { Component, Fragment } from 'react';</span><span id="5bf5" class="mq lc iq mh b gy mv ms l mt mu">class Select extends Component{<br/>  constructor(){<br/>    this.state = {<br/>      options: [<br/>        {<br/>          name: 'Select…',<br/>          value: null,<br/>        },<br/>        {<br/>          name: 'Foo',<br/>          value: 'foo',<br/>        },<br/>        {<br/>          name: 'Bar',<br/>          value: 'bar',<br/>        },<br/>        {<br/>          name: 'Baz',<br/>          value: 'baz',<br/>        },<br/>      ],<br/>      value: '',<br/>    }<br/>  };</span><span id="10f4" class="mq lc iq mh b gy mv ms l mt mu">  handleChange = (event) =&gt; {<br/>    this.setState({ value: event.target.value });<br/>  };</span><span id="0706" class="mq lc iq mh b gy mv ms l mt mu">  render() {<br/>    const { options, value } = this.state;</span><span id="ab27" class="mq lc iq mh b gy mv ms l mt mu">    return (<br/>      &lt;&gt;<br/>        &lt;select onChange={this.handleChange} value={value}&gt;<br/>          {options.map(item =&gt; (<br/>            &lt;option key={item.value} value={item.value}&gt;<br/>              {item.name}<br/>            &lt;/option&gt;<br/>          ))}<br/>        &lt;/select&gt;<br/>      &lt;/&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="bc09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从<code class="fe me mf mg mh b">this.state</code>得到<code class="fe me mf mg mh b">options</code>和<code class="fe me mf mg mh b">values</code>。</p><p id="e3fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<code class="fe me mf mg mh b">render</code>方法中渲染一个下拉列表。</p><p id="a741" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们映射<code class="fe me mf mg mh b">options</code>并将它们呈现为选项元素，其中<code class="fe me mf mg mh b">value</code>属性是值，而<code class="fe me mf mg mh b">item.name</code>被显示。</p><p id="0d8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">handleChange</code>方法调用带有<code class="fe me mf mg mh b">event.target.value</code>的<code class="fe me mf mg mh b">setState</code>，该值被选中。</p><p id="8100" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在功能组件中，我们可以使用<code class="fe me mf mg mh b">useState</code>钩子来获取和设置值。</p><p id="d81e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="72cd" class="mq lc iq mh b gy mr ms l mt mu">const Select = ({<br/>  options<br/>}) =&gt; {<br/>  const [selectedOption, setSelectedOption] = useState(options[0].value);</span><span id="7bd7" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;select<br/>      value={selectedOption}<br/>      onChange={e =&gt; setSelectedOption(e.target.value)}&gt;<br/>        {options.map(o =&gt; (<br/>          &lt;option value={o.value}&gt;{o.name}&lt;/option&gt;<br/>      ))}<br/>    &lt;/select&gt;<br/>  );<br/>};</span></pre><p id="7521" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用<code class="fe me mf mg mh b">useState</code>钩子返回分配给<code class="fe me mf mg mh b">selectedOption</code>变量的最新状态。</p><p id="d255" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">setSelectedOption</code>是设置状态的功能。</p><p id="428a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">options</code>从道具传入，我们将它的第一个值设置为初始值。</p><p id="1919" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们用从<code class="fe me mf mg mh b">options</code>数组道具创建的选项返回一个select元素。</p><p id="bc71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们传入一个回调到<code class="fe me mf mg mh b">onChange</code>以将选项设置为我们选择的选项。</p><h1 id="5ea8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在“反应”中获取视口或窗口高度</h1><p id="2fb8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们有一个类组件，我们可以在我们的组件生命周期方法中倾听<code class="fe me mf mg mh b">resize</code>事件。</p><p id="086a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="dae6" class="mq lc iq mh b gy mr ms l mt mu">class App extends React.Component {<br/>  <!-- -->constructor(props) {<br/>    super(props);<br/>    this.state = { width: 0, height: 0 };<br/>    <!-- -->this.updateWindowDimensions = this.updateWindowDimensions.bind(this);<br/>  }<br/><br/>  componentDidMount() {<br/>    this.updateWindowDimensions();<br/>    window.addEventListener('resize', this.updateWindowDimensions);<br/>  }<br/><br/>  componentWillUnmount() {<br/>    window.removeEventListener('resize', this.updateWindowDimensions);<br/>  }<br/><br/>  updateWindowDimensions() {<br/>    this.setState({ width: window.innerWidth, height: window.innerHeight });<br/>  }<br/>  <br/>  render(){<br/>    //...<br/>  }<br/>}</span></pre><p id="20de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在构造器中设置了初始的<code class="fe me mf mg mh b">width</code>和<code class="fe me mf mg mh b">height</code>。</p><p id="2575" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">componentDidMount</code>中，我们添加了带有<code class="fe me mf mg mh b">addEventListener</code>的事件侦听器，并传入我们的<code class="fe me mf mg mh b">updateWindowDimensions</code>作为事件处理方法。</p><p id="2e3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该方法只是通过从<code class="fe me mf mg mh b">window</code>中获取<code class="fe me mf mg mh b">innerWidth</code>和<code class="fe me mf mg mh b">innerHeight</code>属性来设置窗口的宽度和高度，并用<code class="fe me mf mg mh b">setState</code>进行设置。</p><p id="c501" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当组件卸载时，我们调用<code class="fe me mf mg mh b">removeEventListener</code>来移除<code class="fe me mf mg mh b">resize</code>监听器。</p><p id="6493" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们创建一个函数组件，我们可以创建自己的钩子来获取窗口尺寸。</p><p id="82d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a29c" class="mq lc iq mh b gy mr ms l mt mu">import { useState, useEffect } from 'react';</span><span id="f65c" class="mq lc iq mh b gy mv ms l mt mu">function getWindowDimensions() {<br/>  const { innerWidth: width, innerHeight: height } = window;<br/>  return {<br/>    width,<br/>    height<br/>  };<br/>}</span><span id="ace1" class="mq lc iq mh b gy mv ms l mt mu">function useWindowDimensions() {<br/>  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());</span><span id="b84e" class="mq lc iq mh b gy mv ms l mt mu">  useEffect(() =&gt; {<br/>    function handleResize() {<br/>      setWindowDimensions(getWindowDimensions());<br/>    }</span><span id="77d0" class="mq lc iq mh b gy mv ms l mt mu">    window.addEventListener('resize', handleResize);<br/>    return () =&gt; window.removeEventListener('resize', handleResize);<br/>  }, []);</span><span id="d509" class="mq lc iq mh b gy mv ms l mt mu">  return windowDimensions;<br/>}</span><span id="7cf3" class="mq lc iq mh b gy mv ms l mt mu">const Component = () =&gt; {<br/>  const { height, width } = useWindowDimensions();</span><span id="aa99" class="mq lc iq mh b gy mv ms l mt mu">  return (<br/>    &lt;div&gt;<br/>      width: {width} ~ height: {height}<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="936c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">useWindowDimensions</code>钩子和<code class="fe me mf mg mh b">getWindowDimensions</code>辅助函数来获取窗口或视口的宽度和高度。</p><p id="e126" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在钩子中，我们使用<code class="fe me mf mg mh b">useState</code>钩子返回最新状态，使用<code class="fe me mf mg mh b">setWindowDimensions</code>方法设置维度。</p><p id="dc9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">useEffect</code>钩子中，我们调用了<code class="fe me mf mg mh b">setWindowDimensions</code>函数来设置窗口调整大小时的宽度和高度。</p><p id="570b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过添加一个带有<code class="fe me mf mg mh b">addEventListener</code>的事件监听器来监听<code class="fe me mf mg mh b">resize</code>事件，就像我们在前面的例子中所做的那样。</p><p id="2ab0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的清理代码在我们在<code class="fe me mf mg mh b">useEffect</code>回调中返回的函数中。</p><p id="1b2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们像在前面的例子中那样调用了<code class="fe me mf mg mh b">removeEventListener</code>。</p><p id="e608" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">useEffect</code>的第二个参数是一个空数组，所以<code class="fe me mf mg mh b">useEffect</code>回调只在钩子加载时运行。</p><p id="0505" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尺寸的最新值在钩子中返回。</p><p id="4f25" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将大部分逻辑放在钩子中，这样我们就可以使用自定义钩子来获得窗口的宽度和高度。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/74ffcdd5cf8ed4dcbed0839442bc6083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kQEMF5uCSVoNyfNb"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@yiwen0316?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chen Yi Wen</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="1096" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="ec33" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在下拉列表中添加一个更改监听器，以获取最新选择的值，并将其设置为状态。</p><p id="4059" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有多种方法可以观察组件的宽度和高度变化。</p><h2 id="d5bb" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated">简单英语的JavaScript</h2><p id="6ff0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>