<html>
<head>
<title>Adding Instance Properties to a Vue App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向Vue应用程序添加实例属性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-instance-properties-to-a-vue-app-f96223558653?source=collection_archive---------1-----------------------#2020-07-03">https://javascript.plainenglish.io/adding-instance-properties-to-a-vue-app-f96223558653?source=collection_archive---------1-----------------------#2020-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bafb49c1e564c90de60e7b6732591dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2TT7CUkQ_CQyqOk7"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@punttim?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tim Gouw</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c677" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js使开发前端应用程序变得容易。然而，我们仍然有可能遇到问题。</p><p id="7c2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可能遇到的一个问题是添加全局可用的实例变量。</p><p id="6d67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何创建全局可用的实例变量。</p><h1 id="4911" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">添加实例属性</h1><p id="323f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过向<code class="fe me mf mg mh b">Vue.prototype</code>属性添加属性来为<code class="fe me mf mg mh b">Vue</code>实例添加属性。</p><p id="9d79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="3af6" class="mq lc iq mh b gy mr ms l mt mu">Vue.prototype.$appName = 'example app'</span></pre><p id="3d26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以实例化<code class="fe me mf mg mh b">Vue</code>实例，我们可以通过<code class="fe me mf mg mh b">this.$appName</code>得到属性。</p><p id="683e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5542" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  beforeCreate() {<br/>    console.log(this.$appName)<br/>  }<br/>})</span></pre><p id="6d21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们会在控制台上看到<code class="fe me mf mg mh b">'example app'</code>。</p><h1 id="9c34" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">冲突</h1><p id="38aa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们设置一个实例属性的值，那么我们可能在不同的生命周期钩子中得到不同的值。</p><p id="4f13" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们添加了如下实例属性:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7750" class="mq lc iq mh b gy mr ms l mt mu">Vue.prototype.appName = 'example app';</span></pre><p id="bdb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1f93" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  data: {<br/>    appName: 'other app'<br/>  },<br/>  beforeCreate() {<br/>    console.log(this.appName)<br/>  },<br/>  created() {<br/>    console.log(this.appName)<br/>  }<br/>})</span></pre><p id="fbaf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">beforeCreate</code>勾上，我们看到原来的名字，就是<code class="fe me mf mg mh b">'example app'</code>。</p><p id="dcc7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">created</code>钩上，我们看到<code class="fe me mf mg mh b">'other app'</code>。</p><p id="d01e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为我们只有在创建<code class="fe me mf mg mh b">Vue</code>实例时才会覆盖<code class="fe me mf mg mh b">Vue.prototype.appBame</code>的值。</p><p id="cf88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了避免这个问题，我们添加了<code class="fe me mf mg mh b">$</code>作为实例变量的前缀。</p><h1 id="3b5a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在全球范围内将Axios添加到我们的Vue应用程序中</h1><p id="bf42" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这对于添加我们希望在应用程序中全局使用的库非常有用。</p><p id="01d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7853" class="mq lc iq mh b gy mr ms l mt mu">import axios from 'axios';</span><span id="121d" class="mq lc iq mh b gy mv ms l mt mu">Vue.prototype.$http = axios;</span></pre><p id="7ae3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，当我们实例化我们的<code class="fe me mf mg mh b">Vue</code>实例时，我们可以使用<code class="fe me mf mg mh b">this.$http</code>而不是重复地将<code class="fe me mf mg mh b">axios</code>导入到我们所有的组件中。</p><p id="63be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="119a" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  el: '#app',<br/>  data: {<br/>    data:  {}<br/>  },<br/>  created() {<br/>    var vm = this<br/>    this.$http<br/>      .get('https://api.agify.io/?name=michael')<br/>      .then((response) =&gt; {<br/>        vm.data= response.data<br/>      })<br/>  }<br/>})</span></pre><h1 id="8914" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">原型方法的语境</h1><p id="de9b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们访问原型方法时，我们必须使用常规函数而不是箭头函数。</p><p id="3ce1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为箭头函数没有绑定到<code class="fe me mf mg mh b">this</code>。</p><p id="7661" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，如果我们将它们用于顶级函数，如果我们引用其中的<code class="fe me mf mg mh b">this</code>的话，我们将无法访问<code class="fe me mf mg mh b">Vue</code>实例。</p><p id="1178" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1324" class="mq lc iq mh b gy mr ms l mt mu">Vue.prototype.$upperCase = function(propertyName) {<br/>  this[propertyName] = this[propertyName]<br/>    .toUpperCase();<br/>}</span></pre><p id="b3db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们必须用一个如下的正则函数来调用我们的<code class="fe me mf mg mh b">$upperCase</code>方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4f63" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  data: {<br/>    message: 'foo'<br/>  },<br/>  created() {<br/>    this.$upperCase('message')<br/>    console.log(this.message);<br/>  }<br/>})</span></pre><p id="cd34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们会得到<code class="fe me mf mg mh b">'FOO'</code>因为我们在常规函数中调用了<code class="fe me mf mg mh b">this.$upperCase</code>。</p><p id="82a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们在箭头函数中调用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="feb9" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  data: {<br/>    message: 'foo'<br/>  },<br/>  created: () =&gt; {<br/>    this.$upperCase('message')<br/>    console.log(this.message);<br/>  }<br/>})</span></pre><p id="3617" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将得到“未捕获类型错误:无法读取未定义的属性”。</p><p id="64fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为<code class="fe me mf mg mh b">this</code>的值是错误的，因为我们设置了一个箭头函数作为<code class="fe me mf mg mh b">created</code>的值。</p><h1 id="257e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">交替模式</h1><p id="6509" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用mixins或help对象向组件添加方法或属性。</p><p id="9974" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="a98e" class="mq lc iq mh b gy mr ms l mt mu">const App = Object.freeze({<br/>  name: 'example app',<br/>})</span></pre><p id="8e17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以通过编写以下内容来访问它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7651" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  data: {<br/>    name: App.name<br/>  },<br/>})</span></pre><p id="df00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下代码来创建mixin:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="fec8" class="mq lc iq mh b gy mr ms l mt mu">const aMixin = {<br/>  methods: {<br/>    hello() {<br/>      console.log('hello')<br/>    }<br/>  }<br/>}</span></pre><p id="2bde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以通过书写来使用它:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8ccd" class="mq lc iq mh b gy mr ms l mt mu">const Component = Vue.extend({<br/>  mixins: [aMixin]<br/>})</span></pre><p id="53eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="8621" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  mixins: [mixin]<br/>})</span></pre><p id="9feb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将<code class="fe me mf mg mh b">hello</code>方法合并到<code class="fe me mf mg mh b">Component</code>中。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/4d7e5725a1751cd8c842379b094dc39c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RBi6zoIQrE4-ZKbW"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@younth?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">salih su</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8c8f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="567a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以扩展<code class="fe me mf mg mh b">Vue</code>的原型，添加我们可以在整个应用程序中使用的全局属性和方法。</p><p id="16b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须用常规函数引用它们，这样<code class="fe me mf mg mh b">this</code>的值就是我们的方法被调用的组件。</p><h2 id="e6dd" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated">坦白地说</h2><p id="0c5c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>