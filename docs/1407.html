<html>
<head>
<title>Mistakes I made while using React for the first few years</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我在最初几年使用React时犯的错误</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/mistakes-i-made-while-using-react-for-the-first-few-years-1b834ea4e5ad?source=collection_archive---------2-----------------------#2020-03-12">https://javascript.plainenglish.io/mistakes-i-made-while-using-react-for-the-first-few-years-1b834ea4e5ad?source=collection_archive---------2-----------------------#2020-03-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3697" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">这是我个人的错误报告</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/fe08af790df4346981bd83ced75dbadc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a4PrsfmaMcNSbZF4"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@charlesdeluvio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Charles Deluvio</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8c8b" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><code class="fe mb mc md me b">1. "history of undefined”</code>错误</h1><ul class=""><li id="b1d4" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated">当我在我的应用程序中使用<code class="fe mb mc md me b">react-router-dom</code>作为React路由器时，我经常遇到<code class="fe mb mc md me b">history of undefined</code>错误👊</li><li id="4111" class="mf mg iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">此<strong class="jp ir">错误的解决方案👊</strong>是使用<code class="fe mb mc md me b">withRouter</code>作为组件的包装器(HOC方法)</li></ul><h2 id="79f0" class="mv le iq bd lf mw mx dn lj my mz dp ln jy na nb lr kc nc nd lv kg ne nf lz ng bi translated"><strong class="ak">解决方案</strong></h2><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="7eb2" class="mv le iq me b gy nl nm l nn no">import { withRouter } from 'react-router-dom';<br/>import { connect } from 'react-redux';</span><span id="cdf9" class="mv le iq me b gy np nm l nn no">class App extends Component {<br/>  ...<br/>  render() {<br/>  }</span><span id="4e5e" class="mv le iq me b gy np nm l nn no">  export default connect(<br/>    (state) =&gt; ({ ... }),<br/>    (dispatch) =&gt; ({ ... })</span><span id="37b9" class="mv le iq me b gy np nm l nn no">  )withRouter(App));<br/>}</span></pre></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="4202" class="ld le iq bd lf lg nx li lj lk ny lm ln lo nz lq lr ls oa lu lv lw ob ly lz ma bi translated"><code class="fe mb mc md me b">2. "Expected an assignment or function call and instead saw an expression”</code>错误</h1><ul class=""><li id="f51f" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated">此<strong class="jp ir">错误</strong>错误<strong class="jp ir">👊当您用花括号({})将arrow函数的主体括起来，但不返回任何值时，会发生</strong></li></ul><p id="d1eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">例如</strong></p><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="e6db" class="mv le iq me b gy nl nm l nn no">const def = (props) =&gt; { &lt;div&gt;&lt;/div&gt; };</span></pre><ul class=""><li id="7e8f" class="mf mg iq jp b jq jr ju jv jy oc kc od kg oe kk mm mn mo mp bi translated">这不会返回任何值</li></ul><h2 id="df25" class="mv le iq bd lf mw mx dn lj my mz dp ln jy na nb lr kc nc nd lv kg ne nf lz ng bi translated">解决办法</h2><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="0770" class="mv le iq me b gy nl nm l nn no"><strong class="me ir">// solution</strong></span><span id="002a" class="mv le iq me b gy np nm l nn no">// Instead of const def = (props) =&gt; { &lt;div&gt;&lt;/div&gt; };</span><span id="cbc4" class="mv le iq me b gy np nm l nn no"><strong class="me ir">// Change to</strong></span><span id="d599" class="mv le iq me b gy np nm l nn no">const def = (props) =&gt; { return (&lt;div&gt;&lt;/div&gt;); };</span><span id="e6b0" class="mv le iq me b gy np nm l nn no"><strong class="me ir">// OR</strong></span><span id="8ac5" class="mv le iq me b gy np nm l nn no">const def = (props) =&gt; &lt;div&gt;&lt;/div&gt;;</span></pre></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="ed2d" class="ld le iq bd lf lg nx li lj lk ny lm ln lo nz lq lr ls oa lu lv lw ob ly lz ma bi translated"><code class="fe mb mc md me b">3. "Error: Invariant failed: You should not use &lt;Switch&gt; outside a &lt;Router&gt;”</code>错误</h1><ul class=""><li id="3c5a" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated">我打赌你曾经面对过这个<strong class="jp ir">错误👊</strong>在使用React时至少要使用一次(尤其是，<code class="fe mb mc md me b">react-router-dom</code>)</li><li id="80f9" class="mf mg iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated"><code class="fe mb mc md me b">Switch</code>类似于JavaScript中的<code class="fe mb mc md me b">switch</code>语句，用于根据不同的条件执行不同的动作</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="0415" class="mv le iq me b gy nl nm l nn no">switch (5) {<br/>  case 0 :<br/>    // do something<br/>  case 1 :<br/>    // do something<br/>  ...</span><span id="b9f7" class="mv le iq me b gy np nm l nn no">}</span></pre><h2 id="74b0" class="mv le iq bd lf mw mx dn lj my mz dp ln jy na nb lr kc nc nd lv kg ne nf lz ng bi translated"><strong class="ak">解决方案</strong></h2><ul class=""><li id="d827" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated"><code class="fe mb mc md me b">react-router-dom</code>中的<code class="fe mb mc md me b">Switch</code>需要在每个<code class="fe mb mc md me b">Route</code>的顶部</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="d562" class="mv le iq me b gy nl nm l nn no">import { Switch, Route } from 'react-router-dom';</span><span id="a76e" class="mv le iq me b gy np nm l nn no">&lt;Switch&gt;<br/>  &lt;Route path = '/path1' component={ component1 } /&gt;<br/>  &lt;Route path = '/path2' component={ component2 } /&gt;<br/>  &lt;Route path = '/path3' component={ component3 } /&gt;<br/>  ...</span><span id="d8a5" class="mv le iq me b gy np nm l nn no">&lt;/Switch&gt;</span></pre></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="0746" class="ld le iq bd lf lg nx li lj lk ny lm ln lo nz lq lr ls oa lu lv lw ob ly lz ma bi translated"><code class="fe mb mc md me b">4. "Parsing error: Lexical declaration cannot appear in a single-statement context"</code></h1><ul class=""><li id="6615" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated">此<strong class="jp ir">错误</strong>错误<strong class="jp ir">👊</strong>发生在你使用<code class="fe mb mc md me b">let</code>的时候(在Chrome中)</li><li id="0cd1" class="mf mg iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">举个例子，</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="f6dd" class="mv le iq me b gy nl nm l nn no">function TestError() {<br/>    if (true) {<br/>        let k2 = new Object("ss");<br/>    }<br/>}</span><span id="b3bb" class="mv le iq me b gy np nm l nn no"><strong class="me ir">// is being minified as</strong></span><span id="c46f" class="mv le iq me b gy np nm l nn no">function TestError()<br/>{<br/>  if (1)<br/>    let k2 = new Object("ss")<br/>}</span></pre><ul class=""><li id="e99a" class="mf mg iq jp b jq jr ju jv jy oc kc od kg oe kk mm mn mo mp bi translated">而Chrome上面的代码会得到<strong class="jp ir">错误</strong> <strong class="jp ir">👊</strong></li></ul><h2 id="bc70" class="mv le iq bd lf mw mx dn lj my mz dp ln jy na nb lr kc nc nd lv kg ne nf lz ng bi translated">解决办法</h2><ul class=""><li id="03f9" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated">不要使用更不用说</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="43d8" class="mv le iq me b gy nl nm l nn no">function TestError()<br/>{<br/>  if (1) {<br/>    let k2 = new Object("ss")</span><span id="7c1e" class="mv le iq me b gy np nm l nn no">   }</span><span id="8e51" class="mv le iq me b gy np nm l nn no">}</span><span id="6494" class="mv le iq me b gy np nm l nn no"><strong class="me ir">// OR</strong></span><span id="20f8" class="mv le iq me b gy np nm l nn no">function TestError()<br/>{<br/>  if (1)<br/>    Object("ss")<br/>}</span></pre></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="c0e2" class="ld le iq bd lf lg nx li lj lk ny lm ln lo nz lq lr ls oa lu lv lw ob ly lz ma bi translated"><code class="fe mb mc md me b">5. Higher-order component (HOC) ERROR</code></h1><ul class=""><li id="60c6" class="mf mg iq jp b jq mh ju mi jy mj kc mk kg ml kk mm mn mo mp bi translated">当你试图将一组<strong class="jp ir">道具</strong>从父组件传递到子组件时，你经常使用<code class="fe mb mc md me b">map</code>来迭代地发送一组道具(因为React不允许<strong class="jp ir">道具</strong>在一个数组中)</li><li id="21d1" class="mf mg iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">许多React开发人员在将一组道具传递给子组件时会犯一个常见错误。但是，如果您发现了两个代码之间的差异，就没有问题了👌</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="3ab3" class="mv le iq me b gy nl nm l nn no">render() {<br/>  {</span><span id="d09e" class="mv le iq me b gy np nm l nn no">    organizationData.map(schoolData =&gt; {</span><span id="07f9" class="mv le iq me b gy np nm l nn no">      &lt;MSCList</span><span id="5139" class="mv le iq me b gy np nm l nn no">        schoolID = {schoolData.schoolID}</span><span id="42da" class="mv le iq me b gy np nm l nn no">        schoolName = {schoolData.schoolName}</span><span id="c0a6" class="mv le iq me b gy np nm l nn no">        alignment = {schoolData.alignment}</span><span id="11d9" class="mv le iq me b gy np nm l nn no">        classList = {schoolData.class}</span><span id="bcb3" class="mv le iq me b gy np nm l nn no">        /&gt;</span><span id="1c50" class="mv le iq me b gy np nm l nn no">      })</span><span id="3e63" class="mv le iq me b gy np nm l nn no">   }</span><span id="3ecc" class="mv le iq me b gy np nm l nn no">}</span><span id="c7bd" class="mv le iq me b gy np nm l nn no"><strong class="me ir">vs.</strong></span><span id="6c3f" class="mv le iq me b gy np nm l nn no">render() {</span><span id="e833" class="mv le iq me b gy np nm l nn no">  {</span><span id="4f11" class="mv le iq me b gy np nm l nn no">    organizationData.map(schoolData =&gt; (</span><span id="719a" class="mv le iq me b gy np nm l nn no">      &lt;MSCList</span><span id="7bb3" class="mv le iq me b gy np nm l nn no">        schoolID = {schoolData.schoolID}</span><span id="7e1d" class="mv le iq me b gy np nm l nn no">        schoolName = {schoolData.schoolName}</span><span id="886b" class="mv le iq me b gy np nm l nn no">        alignment = {schoolData.alignment}</span><span id="abd9" class="mv le iq me b gy np nm l nn no">        classList = {schoolData.class}</span><span id="9784" class="mv le iq me b gy np nm l nn no">        /&gt;</span><span id="d1b9" class="mv le iq me b gy np nm l nn no">      ))</span><span id="df4d" class="mv le iq me b gy np nm l nn no">    }</span><span id="782b" class="mv le iq me b gy np nm l nn no">}</span></pre><ul class=""><li id="d970" class="mf mg iq jp b jq jr ju jv jy oc kc od kg oe kk mm mn mo mp bi translated">你注意到了吗👀区别？</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="a632" class="mv le iq me b gy nl nm l nn no">.map(schoolData =&gt; { </span></pre><ul class=""><li id="7926" class="mf mg iq jp b jq jr ju jv jy oc kc od kg oe kk mm mn mo mp bi translated">大括号被替换为</li></ul><pre class="kn ko kp kq gt nh me ni nj aw nk bi"><span id="69b5" class="mv le iq me b gy nl nm l nn no">.map(schoolData =&gt; (</span></pre><ul class=""><li id="15c1" class="mf mg iq jp b jq jr ju jv jy oc kc od kg oe kk mm mn mo mp bi translated">圆括号</li><li id="fa2a" class="mf mg iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">使用花括号({)会导致<strong class="jp ir">错误</strong> <strong class="jp ir">👊</strong></li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi of"><img src="../Images/de7fbdf61a9d3826b7ce5f8f8b606e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J1jP4JPHxczq7EPO"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@howier?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Howard Riminton</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div>    
</body>
</html>