<html>
<head>
<title>Maintainable JavaScript — Objects We Don’t Own</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可维护的JavaScript——我们不拥有的对象</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/maintainable-javascript-objects-we-dont-own-65b2231e76ae?source=collection_archive---------9-----------------------#2020-10-02">https://javascript.plainenglish.io/maintainable-javascript-objects-we-dont-own-65b2231e76ae?source=collection_archive---------9-----------------------#2020-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7990e30e562b5aa72d8bcebfcd59ee29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UlM-6x9ZIODu2zTp"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@4themorningshoot?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Oliver Hale</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="14c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想继续使用代码，创建可维护的JavaScript代码是很重要的。</p><p id="9221" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将通过研究如何处理我们不拥有的对象来了解创建可维护的JavaScript代码的基础。</p><h1 id="b4e3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">我们拥有的物品</h1><p id="a3a8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们拥有的东西就是我们创造的东西。</p><p id="8094" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建对象的代码可能不是我们写的，但是对象是我们创建的。</p><p id="862a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们不拥有自己的对象，比如本地对象<code class="fe me mf mg mh b">Object</code>、<code class="fe me mf mg mh b">Date</code>等。</p><p id="3f81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也没有DOM对象、内置的全局对象或库对象。</p><p id="27ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些都是项目环境的一部分。</p><p id="f834" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些应被视为只读。</p><p id="793b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该覆盖这些对象的方法。</p><p id="977d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不应该在这些对象中添加或删除现有的方法。</p><p id="251a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为我们很容易做别人没想到的事情。</p><p id="069e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将导致混乱，并浪费时间跟踪意外的代码。</p><h1 id="b8e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要覆盖方法</h1><p id="705c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">重写我们不拥有的对象的方法是JavaScript中最糟糕的做法之一。</p><p id="ba4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在脚本中，很容易覆盖现有的方法。</p><p id="1184" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="914f" class="mq lc iq mh b gy mr ms l mt mu">document.getElementById = () =&gt; {<br/>  return null;<br/>}</span></pre><p id="19df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么每个人都会困惑为什么<code class="fe me mf mg mh b">document.getElementById</code>总是回来<code class="fe me mf mg mh b">null</code>。</p><p id="2df1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在脚本中，没有什么可以阻止我们覆盖DOM方法。</p><p id="cde7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以覆盖任何库代码中的任何其他属性。</p><p id="ad9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，有人可能会编写这样的代码:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="609d" class="mq lc iq mh b gy mr ms l mt mu">document._originalGetElementById = document.getElementById;<br/>document.getElementById = (id) =&gt; {<br/>  if (id === "window") {<br/>    return window;<br/>  } else {<br/>    return document._originalGetElementById(id);<br/>  }<br/>};</span></pre><p id="3509" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也是不好的，因为它改变了标准库方法的工作方式。</p><p id="2ffd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也和其他事情一样会带来混乱。</p><p id="7e8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新的代码被称为“T4”是“T5”，但是原来的代码被用于其他任何东西。</p><p id="2f65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这同样糟糕，因为<code class="fe me mf mg mh b">getElementById</code>有时和我们预期的一样有效，有时也是如此。</p><p id="e928" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们永远不应该重写任何方法，这样我们就可以让它们像预期的那样工作。</p><h1 id="2037" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不添加新方法</h1><p id="c43b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在JavaScript中向现有对象添加新方法也很容易。</p><p id="92c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需要给现有的对象分配一个函数，使其成为一个方法。</p><p id="323b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它允许我们修改各种对象。</p><p id="da27" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:可以在<code class="fe me mf mg mh b">document</code>中增加方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2c6e" class="mq lc iq mh b gy mr ms l mt mu">document.foo = () =&gt; {<br/>  console.log('hello');<br/>};</span></pre><p id="389a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以为<code class="fe me mf mg mh b">Array</code><code class="fe me mf mg mh b">prototytpe</code>添加方法:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b6ac" class="mq lc iq mh b gy mr ms l mt mu">Array.prototype.foo = () =&gt; {<br/>  console.log('hello');<br/>};</span></pre><p id="2058" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们都很坏。</p><p id="c3b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有什么能阻止我们向它们添加方法。</p><p id="6e36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就像覆盖方法一样，我们使库对象的行为不同于我们所期望的。</p><p id="18df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们添加的方法也可能被添加到标准库中。</p><p id="df4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们有两种方法做不同的事情，我们用我们的版本覆盖它。</p><p id="b3f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即使是细微的差异也可能导致许多混乱。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/f24826ea26217e98847d16dd8284e4a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ct9xlTEv3FwXjoRc"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@michaeldbeckwith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Michael D Beckwith</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="ca9b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1abc" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该添加或覆盖任何内置或库对象的方法。</p><p id="f6b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为我们会对为什么代码的工作方式与我们预期的不同感到困惑。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/787be6c671be8d345dc786dad8729ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s-sOyyG8NoRbKpCG_y4Cmw@2x.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank">Subscribe to Decoded, our official YouTube channel!</a></figcaption></figure></div></div>    
</body>
</html>