<html>
<head>
<title>How to Add Browser Notifications to Your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向React应用程序添加浏览器通知</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-add-browser-notifications-to-your-react-app-79d901458f56?source=collection_archive---------0-----------------------#2019-12-07">https://javascript.plainenglish.io/how-to-add-browser-notifications-to-your-react-app-79d901458f56?source=collection_archive---------0-----------------------#2019-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5df20d4186e601e9d6884948c57c2be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jaT1eT7kI3SGyTdy"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jamie Street</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4cde" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过HTML5通知API，浏览器可以向用户显示本地弹出通知。使用通知，您可以显示文本和图标，还可以播放声音。选项的完整列表位于<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/notification" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/notification</a>。当用户访问web应用程序以查看浏览器通知时，他们必须授予显示通知的权限。</p><p id="0dfb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们使用React，开发人员已经为我们做了艰苦的工作，因为React组件是为了显示浏览器通知而创建的。位于<a class="ae kc" href="https://www.npmjs.com/package/react-web-notification" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/react-web-notification</a>的React-Web-Notification包可以让我们显示弹出窗口，并处理与显示通知相关的事件，如用户点击通知或处理显示通知的许可或授予或拒绝的情况。</p><p id="9ce3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将建立一个密码管理器，让您输入，编辑和删除网站的密码，并在采取这些行动时显示通知。我们将使用React来构建应用程序。</p><p id="48f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将运行Create React App来创建应用程序。运行:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="5a0e" class="lk ll iq lg b gy lm ln l lo lp">npx create-react-app password-manager</span></pre><p id="e64e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来创建应用程序。接下来，我们添加自己的库，我们将使用Axios向后端发出HTTP请求，Formik和Yup分别用于表单值处理和表单验证，MobX用于状态管理，React Bootstrap用于样式化，React-Copy-To-Clipboard用于将数据复制到剪贴板，React Router用于路由。</p><p id="0712" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过运行以下命令来安装它们:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="f395" class="lk ll iq lg b gy lm ln l lo lp">npm i axios formik mobx mobx-react react-bootstrap react-copy-to-clipboard react-router-fom yup react-web-notifications</span></pre><p id="49fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安装好所有的库之后，我们就可以开始构建我们的应用程序了。除非另有说明，否则我们在<code class="fe lq lr ls lg b">src</code>文件夹中创建所有文件。</p><p id="e9f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们用以下代码替换<code class="fe lq lr ls lg b">App.css</code>中的现有代码:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="3c8b" class="lk ll iq lg b gy lm ln l lo lp">.bg-primary {<br/>  background-color: #09d3ac !important;<br/>}</span></pre><p id="537f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更改顶栏的背景色。接下来在<code class="fe lq lr ls lg b">App.js</code>中，将当前代码替换为:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="c657" class="lk ll iq lg b gy lm ln l lo lp">import React from "react";<br/>import { Router, Route } from "react-router-dom";<br/>import HomePage from "./HomePage";<br/>import { createBrowserHistory as createHistory } from "history";<br/>import Navbar from "react-bootstrap/Navbar";<br/>import Nav from "react-bootstrap/Nav";<br/>import "./App.css";<br/>const history = createHistory();</span><span id="3573" class="lk ll iq lg b gy lt ln l lo lp">function App({ passwordsStore }) {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Router history={history}&gt;<br/>        &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>          &lt;Navbar.Brand href="#home"&gt;Password Manager&lt;/Navbar.Brand&gt;<br/>          &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>          &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>            &lt;Nav className="mr-auto"&gt;<br/>              &lt;Nav.Link href="/" active&gt;Home&lt;/Nav.Link&gt;<br/>            &lt;/Nav&gt;<br/>          &lt;/Navbar.Collapse&gt;<br/>        &lt;/Navbar&gt;<br/>        &lt;Route<br/>          path="/"<br/>          exact<br/>          component={props =&gt; (<br/>            &lt;HomePage {...props} passwordsStore={passwordsStore} /&gt;<br/>          )}<br/>        /&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="68f0" class="lk ll iq lg b gy lt ln l lo lp">export default App;</span></pre><p id="5020" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将我们的React引导顶部栏和我们的路线添加到主页。<code class="fe lq lr ls lg b">passwordStore</code>是我们的MobX存储，用于在前端存储我们的密码列表。</p><p id="f78c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来创建<code class="fe lq lr ls lg b">HomePage.css</code>并添加:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="1714" class="lk ll iq lg b gy lm ln l lo lp">.home-page {<br/>  padding: 20px;<br/>}</span></pre><p id="32e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给我们的页面添加一些填充。</p><p id="dd9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后创建<code class="fe lq lr ls lg b">HomePage.js</code>并添加:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="ed36" class="lk ll iq lg b gy lm ln l lo lp">import React from "react";<br/>import { useState, useEffect } from "react";<br/>import Table from "react-bootstrap/Table";<br/>import ButtonToolbar from "react-bootstrap/ButtonToolbar";<br/>import Button from "react-bootstrap/Button";<br/>import Modal from "react-bootstrap/Modal";<br/>import PasswordForm from "./PasswordForm";<br/>import "./HomePage.css";<br/>import { deletePassword, getPasswords } from "./requests";<br/>import { observer } from "mobx-react";<br/>import { CopyToClipboard } from "react-copy-to-clipboard";<br/>import Notification from "react-web-notification";</span><span id="fe78" class="lk ll iq lg b gy lt ln l lo lp">function HomePage({ passwordsStore }) {<br/>  const [openAddModal, setOpenAddModal] = useState(false);<br/>  const [openEditModal, setOpenEditModal] = useState(false);<br/>  const [initialized, setInitialized] = useState(false);<br/>  const [selectedPassword, setSelectedPassword] = useState({});<br/>  const [notificationTitle, setNotificationTitle] = React.useState("");</span><span id="d76b" class="lk ll iq lg b gy lt ln l lo lp">  const openModal = () =&gt; {<br/>    setOpenAddModal(true);<br/>  };</span><span id="00fd" class="lk ll iq lg b gy lt ln l lo lp">  const closeModal = () =&gt; {<br/>    setOpenAddModal(false);<br/>    setOpenEditModal(false);<br/>    getData();<br/>  };</span><span id="9696" class="lk ll iq lg b gy lt ln l lo lp">  const cancelAddModal = () =&gt; {<br/>    setOpenAddModal(false);<br/>  };</span><span id="e438" class="lk ll iq lg b gy lt ln l lo lp">  const editPassword = contact =&gt; {<br/>    setSelectedPassword(contact);<br/>    setOpenEditModal(true);<br/>  };</span><span id="daf5" class="lk ll iq lg b gy lt ln l lo lp">  const cancelEditModal = () =&gt; {<br/>    setOpenEditModal(false);<br/>  };</span><span id="1bca" class="lk ll iq lg b gy lt ln l lo lp">  const getData = async () =&gt; {<br/>    const response = await getPasswords();<br/>    passwordsStore.setPasswords(response.data);<br/>    setInitialized(true);<br/>  };</span><span id="2949" class="lk ll iq lg b gy lt ln l lo lp">  const deleteSelectedPassword = async id =&gt; {<br/>    await deletePassword(id);<br/>    setNotificationTitle("Password deleted");<br/>    getData();<br/>  };</span><span id="5c58" class="lk ll iq lg b gy lt ln l lo lp">  useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      getData();<br/>    }<br/>  });</span><span id="9e6a" class="lk ll iq lg b gy lt ln l lo lp">  return (<br/>    &lt;div className="home-page"&gt;<br/>      &lt;h1&gt;Password Manager&lt;/h1&gt;<br/>      &lt;Modal show={openAddModal} onHide={closeModal}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Add Password&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;<br/>        &lt;Modal.Body&gt;<br/>          &lt;PasswordForm<br/>            edit={false}<br/>            onSave={closeModal.bind(this)}<br/>            onCancelAdd={cancelAddModal}<br/>            passwordsStore={passwordsStore}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;</span><span id="b400" class="lk ll iq lg b gy lt ln l lo lp">      &lt;Modal show={openEditModal} onHide={closeModal}&gt;<br/>        &lt;Modal.Header closeButton&gt;<br/>          &lt;Modal.Title&gt;Edit Password&lt;/Modal.Title&gt;<br/>        &lt;/Modal.Header&gt;<br/>        &lt;Modal.Body&gt;<br/>          &lt;PasswordForm<br/>            edit={true}<br/>            onSave={closeModal.bind(this)}<br/>            contact={selectedPassword}<br/>            onCancelEdit={cancelEditModal}<br/>            passwordsStore={passwordsStore}<br/>          /&gt;<br/>        &lt;/Modal.Body&gt;<br/>      &lt;/Modal&gt;<br/>      &lt;ButtonToolbar onClick={openModal}&gt;<br/>        &lt;Button variant="outline-primary"&gt;Add Password&lt;/Button&gt;<br/>      &lt;/ButtonToolbar&gt;<br/>      &lt;br /&gt;<br/>      &lt;div className="table-responsive"&gt;<br/>        &lt;Table striped bordered hover&gt;<br/>          &lt;thead&gt;<br/>            &lt;tr&gt;<br/>              &lt;th&gt;Name&lt;/th&gt;<br/>              &lt;th&gt;URL&lt;/th&gt;<br/>              &lt;th&gt;Username&lt;/th&gt;<br/>              &lt;th&gt;Password&lt;/th&gt;<br/>              &lt;th&gt;&lt;/th&gt;<br/>              &lt;th&gt;&lt;/th&gt;<br/>              &lt;th&gt;&lt;/th&gt;<br/>              &lt;th&gt;&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>          &lt;/thead&gt;<br/>          &lt;tbody&gt;<br/>            {passwordsStore.passwords.map(c =&gt; (<br/>              &lt;tr key={c.id}&gt;<br/>                &lt;td&gt;{c.name}&lt;/td&gt;<br/>                &lt;td&gt;{c.url}&lt;/td&gt;<br/>                &lt;td&gt;{c.username}&lt;/td&gt;<br/>                &lt;td&gt;******&lt;/td&gt;<br/>                &lt;td&gt;<br/>                  &lt;CopyToClipboard text={c.username}&gt;<br/>                    &lt;Button<br/>                      variant="outline-primary"<br/>                      onClick={() =&gt; setNotificationTitle("Username copied")}<br/>                    &gt;<br/>                      Copy Username to Clipboard<br/>                    &lt;/Button&gt;<br/>                  &lt;/CopyToClipboard&gt;<br/>                &lt;/td&gt;<br/>                &lt;td&gt;<br/>                  &lt;CopyToClipboard text={c.password}&gt;<br/>                    &lt;Button<br/>                      variant="outline-primary"<br/>                      onClick={() =&gt; setNotificationTitle("Password copied")}<br/>                    &gt;<br/>                      Copy Password to Clipboard<br/>                    &lt;/Button&gt;<br/>                  &lt;/CopyToClipboard&gt;<br/>                &lt;/td&gt;<br/>                &lt;td&gt;<br/>                  &lt;Button<br/>                    variant="outline-primary"<br/>                    onClick={editPassword.bind(this, c)}<br/>                  &gt;<br/>                    Edit<br/>                  &lt;/Button&gt;<br/>                &lt;/td&gt;<br/>                &lt;td&gt;<br/>                  &lt;Button<br/>                    variant="outline-primary"<br/>                    onClick={deleteSelectedPassword.bind(this, c.id)}<br/>                  &gt;<br/>                    Delete<br/>                  &lt;/Button&gt;<br/>                &lt;/td&gt;<br/>              &lt;/tr&gt;<br/>            ))}<br/>          &lt;/tbody&gt;<br/>        &lt;/Table&gt;<br/>      &lt;/div&gt;</span><span id="348d" class="lk ll iq lg b gy lt ln l lo lp">      {notificationTitle ? (<br/>        &lt;Notification<br/>          title={notificationTitle}<br/>          options={{<br/>            icon:<br/>              "<a class="ae kc" href="http://mobilusoss.github.io/react-web-notification/example/Notifications_button_24.png" rel="noopener ugc nofollow" target="_blank">http://mobilusoss.github.io/react-web-notification/example/Notifications_button_24.png</a>"<br/>          }}<br/>          onClose={() =&gt; setNotificationTitle(undefined)}<br/>        /&gt;<br/>      ) : null}<br/>    &lt;/div&gt;<br/>  );<br/>}<br/>export default observer(HomePage);</span></pre><p id="8411" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个组件是我们应用程序的主页。我们有一个显示密码列表的表格，一个添加登录和密码条目的按钮，以及表格每一行中复制用户名和密码、编辑和删除每个条目的按钮。我们有名称、URL、用户名和密码列。<code class="fe lq lr ls lg b">CopyToClipboard</code>组件允许我们将复制的数据复制到组件的<code class="fe lq lr ls lg b">text</code>属性中。任何组件都可以在这个组件中。我们有一个React引导模式用于添加密码，另一个用于编辑。<code class="fe lq lr ls lg b">PasswordForm</code>是我们添加密码条目的表单，我们将稍后创建。</p><p id="289f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当复制用户名或密码时，以及删除条目时，我们都会显示通知。我们通过用<code class="fe lq lr ls lg b">setNotificationTitle</code>函数设置通知标题来做到这一点。我们在<code class="fe lq lr ls lg b">Notification</code>组件中添加了一个<code class="fe lq lr ls lg b">onClose</code>处理程序，这样通知一旦关闭就会再次显示。</p><p id="1fba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe lq lr ls lg b">openModal</code>、<code class="fe lq lr ls lg b">closeModal</code>、<code class="fe lq lr ls lg b">cancelAddModal</code>和<code class="fe lq lr ls lg b">cancelEditModal</code>函数来打开和关闭模态。在<code class="fe lq lr ls lg b">editPassword</code>函数中，我们调用<code class="fe lq lr ls lg b">setSelectedPassword</code>函数来设置要编辑的密码条目。</p><p id="a385" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们包装在<code class="fe lq lr ls lg b">HomePage</code>组件周围的<code class="fe lq lr ls lg b">observer</code>是为了让我们观察来自<code class="fe lq lr ls lg b">passwordsStore</code>的最新值。</p><p id="5bdc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将<code class="fe lq lr ls lg b">index.js</code>修改为:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="febf" class="lk ll iq lg b gy lm ln l lo lp">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import "./index.css";<br/>import App from "./App";<br/>import * as serviceWorker from "./serviceWorker";<br/>import { PasswordsStore } from "./store";<br/>const passwordsStore = new PasswordsStore();</span><span id="3eb3" class="lk ll iq lg b gy lt ln l lo lp">ReactDOM.render(<br/>  &lt;App passwordsStore={passwordsStore} /&gt;,<br/>  document.getElementById("root")<br/>);</span><span id="94bf" class="lk ll iq lg b gy lt ln l lo lp">// If you want your app to work offline and load faster, you can change<br/>// unregister() to register() below. Note this comes with some pitfalls.<br/>// Learn more about service workers: <a class="ae kc" href="https://bit.ly/CRA-PWA" rel="noopener ugc nofollow" target="_blank">https://bit.ly/CRA-PWA</a><br/>serviceWorker.unregister();</span></pre><p id="5ee8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在这里传入我们的<code class="fe lq lr ls lg b">PasswordStore</code> MobX存储，它将把它传递给所有其他组件。</p><p id="2bf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们创建<code class="fe lq lr ls lg b">PasswordForm.js</code>并添加:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="3767" class="lk ll iq lg b gy lm ln l lo lp">import React from "react";<br/>import { Formik } from "formik";<br/>import Form from "react-bootstrap/Form";<br/>import Col from "react-bootstrap/Col";<br/>import Button from "react-bootstrap/Button";<br/>import * as yup from "yup";<br/>import PropTypes from "prop-types";<br/>import { addPassword, getPasswords, editPassword } from "./requests";<br/>import Notification from "react-web-notification";</span><span id="1878" class="lk ll iq lg b gy lt ln l lo lp">const schema = yup.object({<br/>  name: yup.string().required("Name is required"),<br/>  url: yup<br/>    .string()<br/>    .url()<br/>    .required("URL is required"),<br/>  username: yup.string().required("Username is required"),<br/>  password: yup.string().required("Password is required")<br/>});</span><span id="fada" class="lk ll iq lg b gy lt ln l lo lp">function PasswordForm({<br/>  edit,<br/>  onSave,<br/>  contact,<br/>  onCancelAdd,<br/>  onCancelEdit,<br/>  passwordsStore<br/>}) {<br/>  const [notificationTitle, setNotificationTitle] = React.useState("");</span><span id="328f" class="lk ll iq lg b gy lt ln l lo lp">  const handleSubmit = async evt =&gt; {<br/>    const isValid = await schema.validate(evt);<br/>    if (!isValid) {<br/>      return;<br/>    }<br/>    if (!edit) {<br/>      await addPassword(evt);<br/>      setNotificationTitle("Password added");<br/>    } else {<br/>      await editPassword(evt);<br/>      setNotificationTitle("Password edited");<br/>    }<br/>    const response = await getPasswords();<br/>    passwordsStore.setPasswords(response.data);<br/>    onSave();<br/>  };</span><span id="26aa" class="lk ll iq lg b gy lt ln l lo lp">  return (<br/>    &lt;&gt;<br/>      &lt;Formik<br/>        validationSchema={schema}<br/>        onSubmit={handleSubmit}<br/>        initialValues={contact || {}}<br/>      &gt;<br/>        {({<br/>          handleSubmit,<br/>          handleChange,<br/>          handleBlur,<br/>          values,<br/>          touched,<br/>          isInvalid,<br/>          errors<br/>        }) =&gt; (<br/>          &lt;Form noValidate onSubmit={handleSubmit}&gt;<br/>            &lt;Form.Row&gt;<br/>              &lt;Form.Group as={Col} md="12" controlId="name"&gt;<br/>                &lt;Form.Label&gt;Name&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  name="name"<br/>                  placeholder="Name"<br/>                  value={values.name || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.name &amp;&amp; errors.name}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.name}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="e292" class="lk ll iq lg b gy lt ln l lo lp">              &lt;Form.Group as={Col} md="12" controlId="url"&gt;<br/>                &lt;Form.Label&gt;URL&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  name="url"<br/>                  placeholder="URL"<br/>                  value={values.url || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.url &amp;&amp; errors.url}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.url}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="c1e6" class="lk ll iq lg b gy lt ln l lo lp">             &lt;Form.Group as={Col} md="12" controlId="username"&gt;<br/>                &lt;Form.Label&gt;Username&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="text"<br/>                  name="username"<br/>                  placeholder="Username"<br/>                  value={values.username || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.username &amp;&amp; errors.username}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.username}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;</span><span id="95f6" class="lk ll iq lg b gy lt ln l lo lp">              &lt;Form.Group as={Col} md="12" controlId="password"&gt;<br/>                &lt;Form.Label&gt;Password&lt;/Form.Label&gt;<br/>                &lt;Form.Control<br/>                  type="password"<br/>                  name="password"<br/>                  placeholder="Password"<br/>                  value={values.password || ""}<br/>                  onChange={handleChange}<br/>                  isInvalid={touched.password &amp;&amp; errors.password}<br/>                /&gt;<br/>                &lt;Form.Control.Feedback type="invalid"&gt;<br/>                  {errors.password}<br/>                &lt;/Form.Control.Feedback&gt;<br/>              &lt;/Form.Group&gt;<br/>            &lt;/Form.Row&gt;<br/>            &lt;Button type="submit" style={{ marginRight: "10px" }}&gt;<br/>              Save<br/>            &lt;/Button&gt;<br/>            &lt;Button type="button" onClick={edit ? onCancelEdit : onCancelAdd}&gt;<br/>              Cancel<br/>            &lt;/Button&gt;<br/>          &lt;/Form&gt;<br/>        )}<br/>      &lt;/Formik&gt;<br/>      {notificationTitle ? (<br/>        &lt;Notification<br/>          title={notificationTitle}<br/>          options={{<br/>            icon:<br/>              "<a class="ae kc" href="http://mobilusoss.github.io/react-web-notification/example/Notifications_button_24.png" rel="noopener ugc nofollow" target="_blank">http://mobilusoss.github.io/react-web-notification/example/Notifications_button_24.png</a>"<br/>          }}<br/>          onClose={() =&gt; setNotificationTitle(undefined)}<br/>        /&gt;<br/>      ) : null}<br/>    &lt;/&gt;<br/>  );<br/>}</span><span id="14f9" class="lk ll iq lg b gy lt ln l lo lp">PasswordForm.propTypes = {<br/>  edit: PropTypes.bool,<br/>  onSave: PropTypes.func,<br/>  onCancelAdd: PropTypes.func,<br/>  onCancelEdit: PropTypes.func,<br/>  contact: PropTypes.object,<br/>  contactsStore: PropTypes.object<br/>};</span><span id="b792" class="lk ll iq lg b gy lt ln l lo lp">export default PasswordForm;</span></pre><p id="78d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们添加表单，让用户输入他们网站的用户名和密码。我们使用在代码顶部创建的Yup <code class="fe lq lr ls lg b">schema</code>对象来确保所有字段都已输入，并检查输入的URL是否确实是一个URL。我们使用<code class="fe lq lr ls lg b">Formik</code>组件来处理输入变化的形式，并获得最新的值。</p><p id="358f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦表单被<code class="fe lq lr ls lg b">schema.validate</code> promise检查为有效，解析为<code class="fe lq lr ls lg b">true</code>，那么来自<code class="fe lq lr ls lg b">requests.js</code>的<code class="fe lq lr ls lg b">addPassword</code>或<code class="fe lq lr ls lg b">editPassword</code>函数(我们稍后将创建)将被调用，这取决于用户是添加还是编辑条目。一旦成功，就调用同一个文件中的<code class="fe lq lr ls lg b">getPasswords</code>,然后调用<code class="fe lq lr ls lg b">passwordsStore</code>中的<code class="fe lq lr ls lg b">setPasswords</code>,将密码存储在存储器中。最后，从<code class="fe lq lr ls lg b">HomePage</code>组件中的道具传入的<code class="fe lq lr ls lg b">onSave</code>被调用来关闭模态。</p><p id="f06f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每当添加或编辑条目时，以及删除条目时，我们都会显示通知。我们通过用<code class="fe lq lr ls lg b">setNotificationTitle</code>函数设置通知标题来做到这一点。我们在<code class="fe lq lr ls lg b">Notification</code>组件中添加了一个<code class="fe lq lr ls lg b">onClose</code>处理程序，这样通知一旦关闭就会再次显示。</p><p id="42a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，创建<code class="fe lq lr ls lg b">requests.js</code>并添加:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="4e10" class="lk ll iq lg b gy lm ln l lo lp">const APIURL = '<a class="ae kc" href="http://localhost:3000'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a>;<br/>const axios = require('axios');</span><span id="2eaa" class="lk ll iq lg b gy lt ln l lo lp">export const getPasswords = () =&gt; axios.get(`${APIURL}/passwords`);</span><span id="ed26" class="lk ll iq lg b gy lt ln l lo lp">export const addPassword = (data) =&gt; axios.post(`${APIURL}/passwords`, data);</span><span id="9ece" class="lk ll iq lg b gy lt ln l lo lp">export const editPassword = (data) =&gt; axios.put(`${APIURL}/passwords/${data.id}`, data);</span><span id="fdcf" class="lk ll iq lg b gy lt ln l lo lp">export const deletePassword = (id) =&gt; axios.delete(`${APIURL}/passwords/${id}`);</span></pre><p id="bb9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们向后端发出保存密码条目的请求。</p><p id="8709" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们通过创建<code class="fe lq lr ls lg b">store.js</code>来创建我们的MobX商店，并添加:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="d356" class="lk ll iq lg b gy lm ln l lo lp">import { observable, action, decorate } from "mobx";</span><span id="a57a" class="lk ll iq lg b gy lt ln l lo lp">class PasswordsStore {<br/>  passwords = [];</span><span id="8967" class="lk ll iq lg b gy lt ln l lo lp">setPasswords(passwords) {<br/>    this.passwords = passwords;<br/>  }<br/>}</span><span id="9b43" class="lk ll iq lg b gy lt ln l lo lp">PasswordsStore = decorate(PasswordsStore, {<br/>  passwords: observable,<br/>  setPasswords: action<br/>});</span><span id="0e51" class="lk ll iq lg b gy lt ln l lo lp">export { PasswordsStore };</span></pre><p id="ddfa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们将MobX提供的<code class="fe lq lr ls lg b">observer</code>函数包装在一个组件之外，我们可以观察到最新值的<code class="fe lq lr ls lg b">passwords</code>字段。<code class="fe lq lr ls lg b">setPasswords</code>用于设置存储中的最新密码条目，以便它们可以传播到组件。</p><p id="e930" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，在<code class="fe lq lr ls lg b">index.html</code>中，我们将现有代码替换为:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="e821" class="lk ll iq lg b gy lm ln l lo lp">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;meta name="theme-color" content="#000000" /&gt;<br/>    &lt;meta<br/>      name="description"<br/>      content="Web site created using create-react-app"<br/>    /&gt;<br/>    &lt;link rel="apple-touch-icon" href="logo192.png" /&gt;<br/>    &lt;!--<br/>      manifest.json provides metadata used when your web app is installed on a<br/>      user's mobile device or desktop. See <a class="ae kc" href="https://developers.google.com/web/fundamentals/web-app-manifest/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/fundamentals/web-app-manifest/</a><br/>    --&gt;<br/>    &lt;link rel="manifest" href="%PUBLIC_URL%/manifest.json" /&gt;<br/>    &lt;!--<br/>      Notice the use of %PUBLIC_URL% in the tags above.<br/>      It will be replaced with the URL of the `public` folder during the build.<br/>      Only files inside the `public` folder can be referenced from the HTML.</span><span id="0067" class="lk ll iq lg b gy lt ln l lo lp">Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will<br/>      work correctly both with client-side routing and a non-root public URL.<br/>      Learn how to configure a non-root public URL by running `npm run build`.<br/>    --&gt;<br/>    &lt;title&gt;Password Manager&lt;/title&gt;<br/>    &lt;link<br/>      rel="stylesheet"<br/>      href="<a class="ae kc" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"<br/>      crossorigin="anonymous"<br/>    /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;<br/>    &lt;div id="root"&gt;&lt;/div&gt;<br/>    &lt;!--<br/>      This HTML file is a template.<br/>      If you open it directly in the browser, you will see an empty page.</span><span id="7b6f" class="lk ll iq lg b gy lt ln l lo lp">You can add webfonts, meta tags, or analytics to this file.<br/>      The build step will place the bundled scripts into the &lt;body&gt; tag.</span><span id="c779" class="lk ll iq lg b gy lt ln l lo lp">To begin the development, run `npm start` or `yarn start`.<br/>      To create a production bundle, use `npm run build` or `yarn build`.<br/>    --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="868b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更改标题并添加引导CSS。</p><p id="7b4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以通过在Windows上运行<code class="fe lq lr ls lg b">set PORT=3001 &amp;&amp; react-scripts start</code>或在Linux上运行<code class="fe lq lr ls lg b">PORT=3006 react-scripts start</code>来运行应用程序。</p><p id="d142" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了启动后端，我们首先通过运行<code class="fe lq lr ls lg b">npm i json-server</code>来安装<code class="fe lq lr ls lg b">json-server</code>包。然后，转到我们的项目文件夹并运行:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="9c31" class="lk ll iq lg b gy lm ln l lo lp">json-server --watch db.json</span></pre><p id="e100" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lq lr ls lg b">db.json</code>中，将文本改为:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="d789" class="lk ll iq lg b gy lm ln l lo lp">{<br/>  "passwords": [<br/>  ]<br/>}</span></pre><p id="45ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们有了在<code class="fe lq lr ls lg b">requests.js</code>中定义的<code class="fe lq lr ls lg b">passwords </code>端点。</p><p id="5e9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过所有的努力，我们得到了:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/2a0272d913a298594a92bf2d04c0090b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uKyQndsgwwoKcQn7zLYeg.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/0ba3b52cb56856ea524710752088d158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BaVRKUf-gCBc4LKhhb5oyg.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/c6b4caebc90eb847981073bc100bb2d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4d_u7TQVsOx86523R-oTaw.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/ded5a40c576932082b63529f93182ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*J4ARc8HewF_zHduSWS_ddw.png"/></div></figure></div></div>    
</body>
</html>