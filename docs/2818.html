<html>
<head>
<title>The 3 Phases of Event Propagation in JavaScript Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释了JavaScript中事件传播的3个阶段</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-3-phases-of-event-propagation-explained-f76348b5343f?source=collection_archive---------1-----------------------#2020-07-27">https://javascript.plainenglish.io/the-3-phases-of-event-propagation-explained-f76348b5343f?source=collection_archive---------1-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="51fc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">什么是事件冒泡？什么是事件捕获？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8aee8e6b36b622e7420d56c8a068f15d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdHO5244EJbdyG0AIfBy_A.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@simebasioli?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Sime Basioli</a> on <a class="ae kv" href="https://unsplash.com/s/photos/bubbles?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f9b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JavaScript中事件传播的三个阶段对于理解如何使用事件至关重要，此外，这也是JavaScript技术面试中另一个极其常见的问题。</p><p id="6f6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">这三个阶段依次是1)事件捕获阶段，2)目标阶段，以及3)事件冒泡阶段。</strong></p><p id="18b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">本质上，事件首先通过父元素向下传递，直到到达目标元素(捕获阶段)。当事件到达目标时，它在那里触发(目标阶段)，然后沿着链向上返回(冒泡阶段)，沿途调用处理程序。(via</em><a class="ae kv" href="https://javascript.info/bubbling-and-capturing" rel="noopener ugc nofollow" target="_blank"><em class="ls">JavaScript . info</em></a><em class="ls">)</em></p><p id="aa82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目标元素指的是触发事件的确切点。例如，如果你点击了一个<code class="fe lt lu lv lw b">&lt;div&gt;</code>中的按钮，那么相应的<code class="fe lt lu lv lw b">&lt;button&gt;</code>标签就是目标。这个元素可以作为<code class="fe lt lu lv lw b">event.target</code>访问，并且在事件传播的各个阶段不会改变。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/67fe3dcac0b3ab63e559e52c5c4359c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*GLU36VFddFRhA8n_4FGjzw.png"/></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="8a22" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">什么是事件捕获？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/b9a5212d8bb65de59c2b77af1d733958.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*r-a2nqO18ONYR7TEUhkK7w.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Going down - just like event capturing!</figcaption></figure><p id="8830" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事件捕获是第一个阶段，当事件从顶部(<code class="fe lt lu lv lw b">window</code>)一直向下移动到事件目标时，就像瀑布一样。这在处理事件时很少使用，大多数情况下这发生在幕后。如果放置一个处理程序，通常是在事件冒泡阶段，因为一个元素离目标越近，元素的上下文就越多。</p><p id="7e02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当事件处理程序设置了<code class="fe lt lu lv lw b">onClick</code>(或不同的<code class="fe lt lu lv lw b">on&lt;event&gt;</code>)或<code class="fe lt lu lv lw b">addEventListener(event, handler)</code>时，只有目标阶段和事件冒泡阶段会捕捉到它。如果我们想在捕获阶段捕获一个事件，我们需要显式地将<code class="fe lt lu lv lw b">{capture: true}</code>或者仅仅是隐含的<code class="fe lt lu lv lw b">true</code>添加到事件监听器的末尾。</p><pre class="kg kh ki kj gt my lw mz na aw nb bi"><span id="4e5b" class="nc mg iq lw b gy nd ne l nf ng">element.addEventListener(<!-- -->"click", e =&gt; alert('Capturing')<!-- -->, {capture: true})<br/>// or this way also works<br/>element.addEventListener(<!-- -->"click", e =&gt; alert('Capturing')<!-- -->, true)</span></pre><h1 id="db08" class="mf mg iq bd mh mi nh mk ml mm ni mo mp jw nj jx mr jz nk ka mt kc nl kd mv mw bi translated">目标阶段是什么？</h1><p id="3fca" class="pw-post-body-paragraph kw kx iq ky b kz nm jr lb lc nn ju le lf no lh li lj np ll lm ln nq lp lq lr ij bi translated">虽然官方有三个阶段，但是当到达<code class="fe lt lu lv lw b">event.target</code>元素时发生的第二个“目标”阶段并不像其他阶段那样单独处理。当事件捕获和事件冒泡处理程序从目标元素开始和结束时，它们都会自动触发这个阶段。</p><h1 id="fa3f" class="mf mg iq bd mh mi nh mk ml mm ni mo mp jw nj jx mr jz nk ka mt kc nl kd mv mw bi translated">什么是事件冒泡？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d886ef5079946702fe372713502d21cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/1*1KpkkhAFah-NWfOea9-_6Q.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Bubbles going up — just like event bubbling</figcaption></figure><p id="4add" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事件冒泡包括运行目标元素的处理程序，然后向上“冒泡”到下一个父元素的处理程序，然后是上一个父元素的处理程序，依此类推。你可以认为这类似于气泡在水中上升的概念。这意味着如果我们有一个嵌套在<code class="fe lt lu lv lw b">&lt;div&gt;</code>中的<code class="fe lt lu lv lw b">&lt;p&gt;</code>，嵌套在<code class="fe lt lu lv lw b">&lt;form&gt;</code>中的<code class="fe lt lu lv lw b">&lt;p&gt;</code>，处理程序将按顺序运行它们:<code class="fe lt lu lv lw b">&lt;p&gt; -&gt; &lt;div&gt; -&gt; &lt;form&gt;</code>。这种冒泡将一直持续到元件的顶部，通过<code class="fe lt lu lv lw b">html</code>、<code class="fe lt lu lv lw b">document object</code>直到<code class="fe lt lu lv lw b">window</code>。几乎所有事件都会冒泡，只有少数例外，比如<code class="fe lt lu lv lw b">focus</code>。</p><pre class="kg kh ki kj gt my lw mz na aw nb bi"><span id="f2ae" class="nc mg iq lw b gy nd ne l nf ng">&lt;form onClick="alert('You clicked the form!')"&gt;<br/>  &lt;div onClick="alert('You clicked the div!')"&gt;<br/>    &lt;p&gt;If you click me, the other handlers will still run!&lt;/p&gt;<br/>  &lt;/div&gt;<br/>&lt;/form&gt;</span></pre><p id="a078" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果出于某种原因，我们需要在事件目标的处理程序完成运行后停止向上传播，我们可以使用<code class="fe lt lu lv lw b">event.stopPropagation()</code>。如果我们想阻止传播和当前目标的处理程序运行，我们也可以使用<code class="fe lt lu lv lw b">event.stopImmediatePropagation()</code>。不建议这样做，因为这些情况可以用其他方式处理，它们可能会导致无法预料的副作用，但是知道它们的存在还是很好的。</p><p id="7b76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是一个代码示例，它有助于说明活动中的事件传播阶段:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Courtesy of <a class="ae kv" href="https://javascript.info/bubbling-and-capturing" rel="noopener ugc nofollow" target="_blank">javascript.info</a></figcaption></figure><h1 id="5110" class="mf mg iq bd mh mi nh mk ml mm ni mo mp jw nj jx mr jz nk ka mt kc nl kd mv mw bi translated">简单英语的JavaScript</h1><p id="5b8a" class="pw-post-body-paragraph kw kx iq ky b kz nm jr lb lc nn ju le lf no lh li lj np ll lm ln nq lp lq lr ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="ky ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>