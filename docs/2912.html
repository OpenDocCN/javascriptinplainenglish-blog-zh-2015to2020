<html>
<head>
<title>RxJS 7 in-depth</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RxJS 7深入</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/rxjs-7-in-depth-32cc7bf3e5c?source=collection_archive---------1-----------------------#2020-08-05">https://javascript.plainenglish.io/rxjs-7-in-depth-32cc7bf3e5c?source=collection_archive---------1-----------------------#2020-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6e50" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">RxJS 7正处于后期测试阶段，发布时间即将到来。让我们发现什么是新的和闪亮的！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3c704128bb94766b6e52c25cddbb5107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYo0V_e7AXPSCK-tAVoTBA.png"/></div></div></figure><p id="a189" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">RxJS 是JavaScript/TypeScript生态系统中最酷的库之一。它彻底改变了我们在应用程序中处理数据流的方式。</p><p id="390c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我们将发现RxJS 7将带来的变化。我们将关注即将到来的特性、错误修复和突破性的变化。</p><p id="dc73" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们开始吧！</p><h1 id="220c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">新的<code class="fe mg mh mi mj b">lastValueFrom </code>和<code class="fe mg mh mi mj b">firstValueFrom</code>方法</h1><p id="de2d" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">当我在2016年第一次了解RxJS时，我立即知道它提供的承诺完全是虚假的。不幸的是，到目前为止，Observables仍然没有被纳入EcmaScript规范，而且有数以千计的基于promise的库。此外，许多人仍然不知道什么是可观的，只知道承诺。这是一种可悲的状态！因此，就目前而言，我们仍然必须处理这个问题，从可观察到的到承诺，反之亦然。</p><p id="d7d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在RxJS 7中，有两个新的方法可用:<code class="fe mg mh mi mj b">lastValueFrom</code>和<code class="fe mg mh mi mj b">firstValueFrom</code>。增加它们是因为，就目前情况来看，我们都熟悉的<code class="fe mg mh mi mj b">toPromise</code>方法是有缺陷的。</p><p id="46cf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">承诺提供了一个严格的保证，即一个操作要么产生一个值，要么出错。对于<code class="fe mg mh mi mj b">toPromise</code>，我们无法确定发生了什么。这里有两个例子，摘自本期杂志:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="123a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在第一种情况下，我们无法区分在完成之前没有发出值的情况和最后发出未定义值的情况。</p><p id="fde2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了RxJS 7，我们将能够更清楚地陈述我们想要从源可观测值中提取出哪个值。</p><p id="f2b1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mg mh mi mj b">firstValueFrom</code>方法通过订阅可观察对象并返回一个承诺，将可观察对象转换为承诺，该承诺将在可观察对象的第一个值到达时立即解决。然后，订阅被关闭。如果可观察的流在发出任何值之前完成，那么返回的承诺将被拒绝，并带有一个<code class="fe mg mh mi mj b">EmptyError</code>。如果可观察的流发出一个错误，那么返回的承诺将拒绝这个错误。</p><p id="04c1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里有一个例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="08a7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mg mh mi mj b">lastValueFrom</code>的工作方式非常相似，除了它等待可观察对象完成，并用来自被观察流的最后一个值解析返回的承诺。同样，如果可观察流在发出任何值之前完成，那么返回的承诺将通过<code class="fe mg mh mi mj b">EmptyError</code>拒绝，如果可观察流发出错误，那么返回的承诺将通过该错误拒绝。</p><p id="bbf2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">查看<a class="ae ln" href="https://github.com/ReactiveX/rxjs/pull/5295" rel="noopener ugc nofollow" target="_blank">合并公关</a>获取更多示例。</p><p id="621e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将有望使我们的生活更轻松。注意<code class="fe mg mh mi mj b">toPromise</code>可能会被弃用。</p><h1 id="e2d9" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">重命名的运算符</h1><p id="2d46" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">这个“新的”<code class="fe mg mh mi mj b">combineLatestWith</code>操作符实际上是现已废弃的<code class="fe mg mh mi mj b">combineLatest</code>操作符的<a class="ae ln" href="https://github.com/ReactiveX/rxjs/pull/5251" rel="noopener ugc nofollow" target="_blank">重命名版本</a>。</p><p id="0dae" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个新名字确实使它更清晰:它创建了一个可观察对象，将所有传递的可观察对象和源的最新值组合成数组并发出它们。当您订阅该操作符返回的可观察对象时，订阅了源可观察对象以及作为参数提供的所有源。一旦所有源发出至少一个值，那么所有最新的值将作为一个数组发出。</p><p id="f5ff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae ln" href="https://github.com/ReactiveX/rxjs/pull/5249" rel="noopener ugc nofollow" target="_blank">改名为</a>的另一个算子是<code class="fe mg mh mi mj b">zip</code>算子，现在叫做<code class="fe mg mh mi mj b">zipWith</code>。<code class="fe mg mh mi mj b">race</code>也是一样，现在叫<code class="fe mg mh mi mj b">raceWith</code>。</p><p id="6a4f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">重构我们的代码来使用新的操作符应该很容易；-)</p><h1 id="f320" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">重试操作员配置</h1><p id="0566" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">我们现在可以将一个配置选项传递给retry操作员，以便在成功时重置计数器:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="40c9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">整洁！</p><h1 id="a710" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">fromFetch的选择器支持</h1><p id="b0e6" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated"><code class="fe mg mh mi mj b">fromFetch</code>操作符现在让我们<a class="ae ln" href="https://github.com/ReactiveX/rxjs/pull/5306" rel="noopener ugc nofollow" target="_blank">定义一个选择器函数</a>来从响应中提取我们想要的信息(或者任意数据，如果我们想要的话)。</p><p id="bec9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果没有定义选择器，那么<code class="fe mg mh mi mj b">fromFetch</code>简单地按原样返回响应(就像之前一样):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="824e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我们也可以提取我们想要的东西:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="51e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我们还可以返回任意数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="e030" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">groupBy的类型保护支持</h1><p id="bd29" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">我们现在可以使用<a class="ae ln" href="https://basarat.gitbook.io/typescript/type-system/typeguard" rel="noopener ugc nofollow" target="_blank">打字稿类型的警卫</a>和<code class="fe mg mh mi mj b">groupBy</code>操作符:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="5ed0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这对于类型推断来说非常强大，因为它允许使用像上面的<code class="fe mg mh mi mj b">isNumber</code>保护一样的自定义类型保护。注意，当然也可以定义内嵌类型的保护。</p><h1 id="9d6b" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">支持带有组合测试的可观察字典</h1><p id="cd7f" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">从RxJS 7开始，我们将能够向<code class="fe mg mh mi mj b">combineLatest</code>操作符传递一个字典。当我们这样做时，我们将收到相同的字典结构:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="2679" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是一个非常有用的附加功能，可以匹配使用<code class="fe mg mh mi mj b">forkJoin</code>操作符的可能性。由于这一点，我们将能够编写更多可读的代码，而且能够将<code class="fe mg mh mi mj b">combineLatest</code>与<code class="fe mg mh mi mj b">pluck</code> <a class="ae ln" href="https://www.learnrxjs.io/learn-rxjs/operators/transformation/pluck" rel="noopener ugc nofollow" target="_blank">操作符</a>结合起来。</p><h1 id="c6c1" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">一次暂停来统治所有人</h1><p id="585b" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">在RxJS 7中，我们将获得对超时的改进支持。</p><p id="e0eb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，我们将能够通过它获得更强大的<code class="fe mg mh mi mj b">TimeoutConfig</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="8b33" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如您所见，该配置支持不同的选项来精确控制超时:</p><ul class=""><li id="f9ad" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">each</code>:触发超时之前，源排放之间允许的时间</li><li id="5429" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">first</code>:源头首次排放的最后期限</li><li id="13e3" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">with</code>:一个工厂，当超时发生时，我们可以传入它来创建可观察对象。这使得<code class="fe mg mh mi mj b">timeout</code>操作符可以像另一个操作符<code class="fe mg mh mi mj b">timeoutWith</code>一样使用</li><li id="36f0" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi">…</li></ul><p id="b453" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于这种新的配置类型，可以非常精确地配置<code class="fe mg mh mi mj b">timeout</code>操作器。以前，不可能配置超时来进行不同的“第一次”超时检查和随后的“每次”超时检查，或者在第一个值没有及时到达时超时，等等。</p><p id="363b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">查看<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/def1d346b43008bc413a3ac985e1611bbbf62003" rel="noopener ugc nofollow" target="_blank">该提交</a>以了解更多详细信息。</p><h1 id="3b00" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">测试调度程序改进</h1><p id="e4af" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated"><code class="fe mg mh mi mj b">TestScheduler</code>现在有一个动画“运行模式”辅助对象，可用于指定何时“绘制”所请求的动画帧。</p><p id="47b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mg mh mi mj b">animate</code>助手接受一个大理石图，图中的每个值发射指示“绘制”发生的时间。</p><p id="2b34" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在这里了解更多信息。</p><h1 id="f773" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">更好的内存使用</h1><p id="c59f" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">RxJS 7中的内存使用应该得到改善，因为<a class="ae ln" href="https://github.com/ReactiveX/rxjs/commit/bff18272dca23938a5f5b57cec6eb8d8be5bfddf" rel="noopener ugc nofollow" target="_blank">大多数操作符不再保留外部值</a>。</p><p id="4784" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如，<code class="fe mg mh mi mj b">mergeMap</code>中的每个内部订阅以前都保留外部值，如果外部值是一个大数组，那么很快就会出现内存使用问题。</p><h1 id="4307" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">大量错误修复</h1><p id="e1ff" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">RxJS 7带来了大量的错误修复。我不会详细介绍每一个，因为这需要花很长时间，但以下是迄今为止的列表:</p><ul class=""><li id="5e23" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated">ajax:传递给progressSubscriber的部分观察器将不再出错(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/25d279f0b45d07f39bfb87b19bc7e2279df8b542" rel="noopener ugc nofollow" target="_blank"> 25d279f </a></li><li id="515f" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">ajax:不可解析的响应将不再阻止抛出完整的Ajax error(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/605ee550e5efc266b5dc5d3a9756c7c3b3968a61" rel="noopener ugc nofollow" target="_blank">605 ee55</a>)</li><li id="22eb" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">animationFrames:从rAF的回调中发出时间戳(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5438" rel="noopener ugc nofollow" target="_blank"> #5438 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/c980ae65ee1b585e8ed66a366eb534ac3e50c205" rel="noopener ugc nofollow" target="_blank"> c980ae6 </a>)</li><li id="d9a2" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">确保内部订户的退订/拆除是等幂的(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5465" rel="noopener ugc nofollow" target="_blank"># 5465</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/3e39749a58ca663c17f5f0354b0f27532fb6d319" rel="noopener ugc nofollow" target="_blank">3e 39749</a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5464" rel="noopener ugc nofollow" target="_blank"> #5464 </a></li><li id="bfd9" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">超时:延迟错误创建直到超时发生(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5497" rel="noopener ugc nofollow" target="_blank"># 5497</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/3be98404fafd5a8de758deb4e0d103a7b60aa31e" rel="noopener ugc nofollow" target="_blank">3be 9840</a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5491" rel="noopener ugc nofollow" target="_blank"> #5491 </a></li><li id="dd30" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">perf:确保内部订户的退订/拆除是幂等的(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5465" rel="noopener ugc nofollow" target="_blank"># 5465</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/3e39749a58ca663c17f5f0354b0f27532fb6d319" rel="noopener ugc nofollow" target="_blank">3e 39749</a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5464" rel="noopener ugc nofollow" target="_blank"> #5464 </a></li><li id="7bb7" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">超时:延迟错误创建直到超时(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5497" rel="noopener ugc nofollow" target="_blank"> #5497 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/3be98404fafd5a8de758deb4e0d103a7b60aa31e" rel="noopener ugc nofollow" target="_blank"> 3be9840 </a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5491" rel="noopener ugc nofollow" target="_blank"> #5491 </a></li><li id="e12b" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">依赖项:将typedoc上的意外依赖项移动到dev-dependencies。(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5566" rel="noopener ugc nofollow" target="_blank"> #5566 </a> ) ( <a class="ae ln" href="https://github.com/ReactiveX/rxjs/commit/45702bf6cd1b4a150f47b2a1d273f1ee31ca2482" rel="noopener ugc nofollow" target="_blank"> 45702bf </a>)</li><li id="f0da" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">null:运算符因空/未定义的输入而中断。(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5524" rel="noopener ugc nofollow" target="_blank"># 5524</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/c5f65508505cf1f90560e6be76425e09c455bec3" rel="noopener ugc nofollow" target="_blank">c5f 6550</a>)</li><li id="0aff" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">shareReplay:不再错过来自源的同步值(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/92452cc20021141aa0f047c7e5af569a413143e5" rel="noopener ugc nofollow" target="_blank"> 92452cc </a>)</li><li id="6490" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">互操作:正确连锁互操作/安全订户取消订阅(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5472" rel="noopener ugc nofollow" target="_blank"># 5472</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/98ad0eba6bc079851b44951f3963e8aae0abf861" rel="noopener ugc nofollow" target="_blank">98 ad0eb</a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5469" rel="noopener ugc nofollow" target="_blank"> #5469 </a>、T22】 #5311 、T24】 #2675 </li><li id="2768" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">finalize:用finalize(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5239" rel="noopener ugc nofollow" target="_blank"># 5239</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/04ba6621fe9e09238e1796217d04107e52dd36d5" rel="noopener ugc nofollow" target="_blank">04ba 662</a>)对互操作进行链订阅，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5237" rel="noopener ugc nofollow" target="_blank"> #5237 </a> <a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5237" rel="noopener ugc nofollow" target="_blank"> #5237 </a></li><li id="4541" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">animationFrameScheduler:不同时执行重新安排的动画帧和asap动作(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5399" rel="noopener ugc nofollow" target="_blank"> #5399 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/33c9c8cf7e247d4ad4d7318bfd02e8e5bedb0f40" rel="noopener ugc nofollow" target="_blank"> 33c9c8c </a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/4972" rel="noopener ugc nofollow" target="_blank"> #4972 </a> <a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5397" rel="noopener ugc nofollow" target="_blank"> #5397 </a></li><li id="7e24" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">iterables:从iterables抛出的错误现在可以正确传播了(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5444" rel="noopener ugc nofollow" target="_blank"> #5444 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/75d4c2f33d2e2121b2a316849044ad17ab28dbaf" rel="noopener ugc nofollow" target="_blank"> 75d4c2f </a>)</li><li id="79cd" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">finalize:在源可观察对象被拆除后将调用回调。(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/0d7b7c14e34eed43fb2ad1386281800fa3ae8aec" rel="noopener ugc nofollow" target="_blank"> 0d7b7c1 </a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5357" rel="noopener ugc nofollow" target="_blank"> #5357 </a></li><li id="21df" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">通知:打字改进(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5478" rel="noopener ugc nofollow" target="_blank"># 5478</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/96868ac754c0147a9aa61182185f27224eb7f11a" rel="noopener ugc nofollow" target="_blank">96868 AC</a>)</li><li id="543c" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">TestScheduler:支持空订阅弹珠(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5502" rel="noopener ugc nofollow" target="_blank"># 5502</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/e65696e2f7f7338659a873f6653026b33b9011a9" rel="noopener ugc nofollow" target="_blank">e 65696 e</a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5499" rel="noopener ugc nofollow" target="_blank"> #5499 </a></li><li id="430e" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">扩展:现在可以与异步调度程序(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/294b27eb6a96e8edee3af35e6aaaef50628376e4" rel="noopener ugc nofollow" target="_blank"> 294b27e </a>)一起正常工作</li><li id="857c" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">订阅:允许无穷大作为有效延迟(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5500" rel="noopener ugc nofollow" target="_blank"># 5500</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/cd7d64901e82fd7fb5e8407f1f30828906fac420" rel="noopener ugc nofollow" target="_blank">cd7d 649</a>)</li><li id="c214" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">主题:解决主题构造函数错误地允许参数(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5476" rel="noopener ugc nofollow" target="_blank"> #5476 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/e1d35dc258edea0237ef49a31f7b34c058755969" rel="noopener ugc nofollow" target="_blank"> e1d35dc </a>)的问题</li><li id="aa28" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">主题:无默认通用(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/e678e81ba80f5bcc27b0e956295ce2fc8dfe4576" rel="noopener ugc nofollow" target="_blank"> e678e81 </a>)</li><li id="9e14" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">defer:不再允许()= &gt; undefined to observable factory(# 5449)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/1ae937a8e594aef96b93313bb3c68ea910e6f528" rel="noopener ugc nofollow" target="_blank">1ae 937 a</a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5449" rel="noopener ugc nofollow" target="_blank"> #5449 </a></li><li id="0b72" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">single:修正了空观察点上single(() =&gt; false)的行为。(#5325) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/27931bcfd2aa864e277d3e72128c57e807b28bb0" rel="noopener ugc nofollow" target="_blank"> 27931bc </a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5325" rel="noopener ugc nofollow" target="_blank"> #5325 </a></li><li id="efb1" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">take/takeLast:在运行时正确断言数字类型(#5326) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/5efc474161c9196dbdf4803a9cc444a547067549" rel="noopener ugc nofollow" target="_blank"> 5efc474 </a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5326" rel="noopener ugc nofollow" target="_blank"> #5326 </a></li><li id="5533" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">mergeMapTo:删除冗余/未使用的通用(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5299" rel="noopener ugc nofollow" target="_blank"># 5299</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/d67b7dafbacb3aac8f4dd7f215fe2d2c602f0d36" rel="noopener ugc nofollow" target="_blank">d67b 7 da</a>)</li><li id="f2a5" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">ajax: AjaxTimeoutErrorImpl扩展了Ajax error(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5226" rel="noopener ugc nofollow" target="_blank"># 5226</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/a8da8dcc899342d3bb6d2d913247d9e734095287" rel="noopener ugc nofollow" target="_blank">A8 da 8 DC</a>)</li><li id="61d6" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">延迟:尽快发出完整通知(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/63b8797fbeed09eb675ea64b0b83607cef1367a9" rel="noopener ugc nofollow" target="_blank"> 63b8797 </a>)，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/4249" rel="noopener ugc nofollow" target="_blank"> #4249 </a></li><li id="4d55" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">endWith:将正确键入N个参数(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5246" rel="noopener ugc nofollow" target="_blank"> #5246 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/81ee1f72408854f4017615fe7949edf5dd50533b" rel="noopener ugc nofollow" target="_blank"> 81ee1f7 </a>)</li><li id="d070" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">fetch:不要泄漏添加到传入信号中的事件监听器(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5305" rel="noopener ugc nofollow" target="_blank"> #5305 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/d4d6c47d8abccc8cbe17e46192fc1eaa42d2d023" rel="noopener ugc nofollow" target="_blank"> d4d6c47 </a>)</li><li id="2895" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">TestScheduler:子类化TestScheduler需要run helpers(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5138" rel="noopener ugc nofollow" target="_blank"># 5138</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/927d5d90ab5f12a79cd50f7290b4f8df1e83ecfc" rel="noopener ugc nofollow" target="_blank">927 d5d 9</a>)</li><li id="2671" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">管道:对0-arg情况的特殊处理。(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/4936" rel="noopener ugc nofollow" target="_blank"># 4936</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/290fa51c44881f25f2fe4cf9885028396c7fd74c" rel="noopener ugc nofollow" target="_blank">290 fa 51</a>)</li><li id="a66c" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">pull:修复pull的无所不包签名以获得更好的类型安全性(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5192" rel="noopener ugc nofollow" target="_blank"># 5192</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/e0c5b7c790bb9d99fa8bee26c805b5e70c1e456b" rel="noopener ugc nofollow" target="_blank">E0 C5 b7c</a>)</li><li id="d50d" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">拨动:参数类型现在接受数字和符号(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/9697b695c23c3dcb614e6a70be63a94ffcd86ed9" rel="noopener ugc nofollow" target="_blank"> 9697b69 </a></li><li id="b4d3" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">startWith:接受N个参数并返回正确的类型(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5247" rel="noopener ugc nofollow" target="_blank"># 5247</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/150ed8b75909b0e0bb9dc8928287ebdc47e19c51" rel="noopener ugc nofollow" target="_blank">150 ed8b</a>)</li><li id="ebbc" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">combineLatestWith:和zipWith从n参数中推断类型(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5257" rel="noopener ugc nofollow" target="_blank"># 5257</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/3e282a58b1baf7aa03b17142f858bca09a542adf" rel="noopener ugc nofollow" target="_blank">3e 282 a5</a>)</li><li id="0229" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">race:支持静态race中的N个参数，并确保返回可观察值(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5286" rel="noopener ugc nofollow" target="_blank"># 5286</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/6d901cbb0c0f2aa3fc5a02ef895cc9e9a7a09243" rel="noopener ugc nofollow" target="_blank">6d 901 CB</a>)</li><li id="0909" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">toPromise:更正toPromise返回类型(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5072" rel="noopener ugc nofollow" target="_blank"> #5072 </a> ) ( <a class="ae ln" href="https://github.com/reactivex/rxjs/commit/b1c35738204b5b1a5d325a16e70cdbf25b523976" rel="noopener ugc nofollow" target="_blank"> b1c3573 </a>)</li><li id="eccf" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">fromFetch:不要在from fetch(<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5234" rel="noopener ugc nofollow" target="_blank"># 5234</a>)(<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/37d2d99762264ef5faabc0ce4f56d7aab51806dc" rel="noopener ugc nofollow" target="_blank">37d2d 99</a>)中重新分配关闭的参数，关闭<a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5233" rel="noopener ugc nofollow" target="_blank"> #5233 </a> <a class="ae ln" href="https://github.com/reactivex/rxjs/issues/5233" rel="noopener ugc nofollow" target="_blank"> #5233 </a></li></ul><p id="d119" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我还没有被这些攻击过(或者没有意识到)，但是如果你被攻击过，你会很高兴看到这些现在已经被修复了。为团队出色的工作向他们致敬！</p><p id="0ed6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">顺便说一句，有一个“修复”我没有看到提到，也找不到回来，但我相信过滤操作符的类型推断将在RxJS 7中更好地工作:</p><pre class="kg kh ki kj gt nf mj ng nh aw ni bi"><span id="a93a" class="nj lp iq mj b gy nk nl l nm nn">source$.pipe(<br/>  filter((user) =&gt; isNotNullOrUndefined(user)),<br/>)<br/>...</span></pre><p id="873b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于RxJS 6，在过滤之后，即使我们过滤掉了那些值，推断的类型仍然包括<code class="fe mg mh mi mj b">null | undefined</code>。用RxJS 7，应该没问题。</p><h1 id="100d" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">重大变化</h1><p id="fd83" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">接下来是不太好的消息。</p><p id="565a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如你所猜测的，由于这是一个主要版本，有…突破性的变化！以下是这些问题的概要:</p><ul class=""><li id="ad6d" class="mr ms iq kt b ku kv kx ky la mt le mu li mv lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">toPromise</code>操作符现在返回<code class="fe mg mh mi mj b">T | undefined</code>。这更符合现实，但可能会破坏一些应用程序(温和地)</li><li id="ed8a" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">lift</code>方法不再暴露。这是RxJS的内部实现细节，因此可以从用户代码中访问。它有多个问题，无论如何都不应该被使用。变通方法包括<a class="ae ln" href="https://rxjs.dev/guide/operators" rel="noopener ugc nofollow" target="_blank">重写你的操作符</a>，使它们返回<code class="fe mg mh mi mj b">new Observable</code>或者将你的可观察值转换为<code class="fe mg mh mi mj b">any</code>并访问<code class="fe mg mh mi mj b">lift</code>，但是当然选择#1是更好的。选项2可能有助于快速修复，但在版本8中可能会崩溃</li><li id="0ce3" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">当使用超过7个参数和一个调度程序调用时,<code class="fe mg mh mi mj b">startWith</code>操作符返回不正确的类型。此外，不推荐将调度程序传递给该操作符</li><li id="efc6" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">timestamp</code>操作符现在接受一个<code class="fe mg mh mi mj b">TimestampProvider</code>，它是带有返回数字的<code class="fe mg mh mi mj b">now()</code>方法的任何对象。此<a class="ae ln" href="https://github.com/ReactiveX/rxjs/issues/5553" rel="noopener ugc nofollow" target="_blank">可能会导致<code class="fe mg mh mi mj b">TestScheduler</code>运行模式出现问题</a></li><li id="d41c" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">当提供了一个调度器后,<code class="fe mg mh mi mj b">ReplaySubject</code>不再调度排放。如果您目前依赖于该行为，那么您需要将它与<code class="fe mg mh mi mj b">observeOn</code>操作符:<code class="fe mg mh mi mj b">new ReplaySubject(2, 3000).pipe(observeOn(asap))</code>结合起来</li><li id="08ce" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">对于无效的参数,<code class="fe mg mh mi mj b">takeLast</code>操作符现在抛出<code class="fe mg mh mi mj b">TypeError</code>。例如，不带参数或用<code class="fe mg mh mi mj b">NaN</code>调用它将抛出一个<code class="fe mg mh mi mj b">TypeError</code></li><li id="b51f" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">take</code>操作符现在为负参数或<code class="fe mg mh mi mj b">NaN</code>参数抛出运行时错误</li><li id="92a6" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated">对于传入的值不存在或者与提供的谓词不匹配的情况，<code class="fe mg mh mi mj b">single</code>操作符现在将抛出</li><li id="2a6e" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">defer</code>不再允许工厂退回<code class="fe mg mh mi mj b">void</code>或<code class="fe mg mh mi mj b">undefined</code>。所有传递给defer的工厂现在必须返回一个正确的<code class="fe mg mh mi mj b">ObservableInput</code>(例如<code class="fe mg mh mi mj b">Observable</code>或<code class="fe mg mh mi mj b">Promise</code>)。要获得与之前相同的行为，您可以使用工厂提供的<code class="fe mg mh mi mj b">return EMPTY</code>或<code class="fe mg mh mi mj b">return of()</code></li><li id="7cdd" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">Notification</code>和<code class="fe mg mh mi mj b">dematerialize</code>有更好的类型签名，这可能会破坏现有的代码</li><li id="ca73" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">Notification.createNext(undefined)</code>不再每次都返回完全相同的引用</li><li id="4ee0" class="mr ms iq kt b ku na kx nb la nc le nd li ne lm mw mx my mz bi translated"><code class="fe mg mh mi mj b">ajax</code>已放弃对IE10及更低版本的支持。是时候放下过去了！</li></ul><h1 id="78c3" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">毕竟没有与异步变量的互操作性</h1><p id="697f" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">RxJS 7的第一个测试版引入了<a class="ae ln" href="https://github.com/reactivex/rxjs/commit/4fa9d016a83049d014d77b89c56301e42db16b4d" rel="noopener ugc nofollow" target="_blank">一流的不可控互操作性</a>。不幸的是，这种支持在最近的测试版本中被删除了，因为有太多的边缘情况。不过，如果你对这个特性感兴趣，你应该看看<a class="ae ln" href="https://twitter.com/BenLesh" rel="noopener ugc nofollow" target="_blank"> Ben Lesh </a>的<a class="ae ln" href="https://github.com/benlesh/rxjs-for-await" rel="noopener ugc nofollow" target="_blank"> rxjs-for-await </a>库。</p><p id="fc2e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了记录在案，这里有一点关于该功能可能允许的背景。</p><p id="7db6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">顾名思义，异步可迭代对象是我们可以迭代的对象..异步。听起来不错？应该的！从<a class="ae ln" href="https://medium.com/@bramus/javascript-whats-new-in-ecmascript-2018-es2018-17ede97f36d5" rel="noopener"> ES2018 </a>开始，我们可以这样写循环:</p><pre class="kg kh ki kj gt nf mj ng nh aw ni bi"><span id="3bd7" class="nj lp iq mj b gy nk nl l nm nn">for <strong class="mj ir">await</strong> (variable of iterable) {<br/>  statement<br/>}</span></pre><p id="43d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">多亏了异步迭代器和异步可迭代对象，这才成为可能。异步迭代器<a class="ae ln" href="https://exploringjs.com/es2018-es2019/ch_asynchronous-iteration.html" rel="noopener ugc nofollow" target="_blank">的<code class="fe mg mh mi mj b">next()</code>方法返回一个承诺</a>，我们可以使用<code class="fe mg mh mi mj b">await</code>关键字消费它。干净利落。</p><p id="9846" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是可观测量呢？有了rxjs-for-await，我们可以使用不同的策略做同样的事情；各有利弊。这些优点和缺点肯定是这个特性暂时不会进入RxJS的原因…</p><h1 id="bc71" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">结论</h1><p id="f7be" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">在这篇文章中，我列出了我可以通过查看不同RxJS 7测试版的<a class="ae ln" href="https://github.com/ReactiveX/rxjs/blob/master/CHANGELOG.md" rel="noopener ugc nofollow" target="_blank">变更日志</a>了解到的不同东西。</p><p id="ed1e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">希望最终版本会很快发布。有一些很酷的新功能，我迫不及待地想尝试一下。不幸的是，对带有异步iterables的互操作的支持被放弃了，这有点令人难过，但我确实理解为什么；安全总比后悔好！</p><p id="137b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">再次向Ben和令人敬畏的RxJS团队致敬，他们让我们的代码感觉更好。</p><p id="9cd6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">今天到此为止！</p><p id="26b0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，积极地分享这篇文章；-)</p><p id="ccd7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="no"> PS:如果你想了解大量关于软件/Web开发、TypeScript、Angular、React、Vue、Docker/Kubernetes和其他酷主题的其他酷东西，那么不要犹豫，去</em> <a class="ae ln" href="https://www.amazon.com/Learn-TypeScript-Building-Applications-understanding-ebook/dp/B081FB89BL" rel="noopener ugc nofollow" target="_blank"> <em class="no">拿一本我的书</em> </a> <em class="no">并订阅</em> <a class="ae ln" href="https://mailchi.mp/fb661753d54a/developassion-newsletter" rel="noopener ugc nofollow" target="_blank"> <em class="no">我的简讯</em> </a> <em class="no">！</em></p></div></div>    
</body>
</html>