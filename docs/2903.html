<html>
<head>
<title>Node.js Best Practices — Project and Async</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js最佳实践—项目和异步</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-js-best-practices-project-and-async-3db755a12402?source=collection_archive---------7-----------------------#2020-08-03">https://javascript.plainenglish.io/node-js-best-practices-project-and-async-3db755a12402?source=collection_archive---------7-----------------------#2020-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0bbb7037dee0e01f9fe7f073ae0ead4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dL1vZ51lzjM0NGwd"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@misslove?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Abbie Love</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4ec0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看在编写节点应用程序时应该遵循的一些最佳实践。</p><h1 id="0607" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">以<code class="fe lz ma mb mc b">npm init</code>开始所有项目</h1><p id="10f7" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们应该以<code class="fe lz ma mb mc b">npm init</code>开始will项目，以便在我们的应用程序项目中获得<code class="fe lz ma mb mc b">package.json</code>文件。</p><p id="d6e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将让我们添加项目的元数据，如项目名称、版本和所需的包。</p><h1 id="c723" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">设置<code class="fe lz ma mb mc b">.npmrc</code></h1><p id="4a60" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们应该添加<code class="fe lz ma mb mc b">.npmrc</code>来添加节点包存储库的URL，我们必须在常规的NPM存储库之外使用它。</p><p id="8b74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以使每个人的软件包版本相同。</p><p id="8d29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让大家用同一个版本，我们可以写。</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="6eb8" class="mq lc iq mc b gy mr ms l mt mu">npm config set save=true<br/>npm config set save-exact=true</span></pre><p id="750a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们制作的<code class="fe lz ma mb mc b">npm install</code>也安装了相同的版本。</p><p id="eacd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lz ma mb mc b">package-lock.json</code>也将存储库锁定到相同的版本。</p><h1 id="eb3b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将脚本添加到我们的<code class="fe lz ma mb mc b">package.json</code></h1><p id="fc84" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lz ma mb mc b">package.json</code>可以持有项目相关的脚本。</p><p id="40ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">都在<code class="fe lz ma mb mc b">scripts</code>文件夹里。</p><p id="e38e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以只使用一个命令来完成启动项目的所有工作。</p><p id="fbaf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lz ma mb mc b">npm start</code>给我们的项目添加一个<code class="fe lz ma mb mc b">start</code>脚本。</p><p id="8a23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="94ed" class="mq lc iq mc b gy mr ms l mt mu">"scripts": {<br/>  "start": "node app.js"<br/>}</span></pre><p id="0ee6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后只需运行<code class="fe lz ma mb mc b">npm start</code>来运行我们的app，而不是<code class="fe lz ma mb mc b">node app.js</code>。</p><p id="7853" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以添加更多命令:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="03ee" class="mq lc iq mc b gy mr ms l mt mu">"scripts": {<br/>  "postinstall": "bower install &amp;&amp; grunt build",<br/>  "start": "node app.js",<br/>  "test": "node ./node_modules/jasmine/bin/jasmine.js"<br/>}</span></pre><p id="3d03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lz ma mb mc b">postinstall</code>在<code class="fe lz ma mb mc b">package.json</code>中的包安装后运行。</p><p id="a9f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lz ma mb mc b">npm test</code>运行运行测试的<code class="fe lz ma mb mc b">test</code>脚本。</p><p id="fefd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们不用自己输入多个命令就可以运行测试。</p><p id="1561" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以在<code class="fe lz ma mb mc b">package.json</code>中添加自定义脚本。</p><p id="7e19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lz ma mb mc b">npm run script {name}</code>运行它们，其中<code class="fe lz ma mb mc b">name</code>是脚本的关键。</p><h1 id="34a6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用环境变量</h1><p id="d84b" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们应该为运行在不同环境中的东西设置环境变量。</p><p id="1d86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以使用dotenv库从<code class="fe lz ma mb mc b">.env</code>文件或环境变量中读取它们，这样我们就可以在我们的应用程序中使用它们。</p><p id="4b14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以在我们的节点应用程序中使用<code class="fe lz ma mb mc b">process.env</code>访问它们。</p><h1 id="5700" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用样式指南</h1><p id="c8a8" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">如果我们在风格指南中采用风格，那么我们就以一致的风格编写代码。</p><p id="3d35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拥有一致的代码更容易理解。</p><p id="d48e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用像ESLint这样的棉绒自动检查。</p><p id="f3a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它包含内置节点应用程序的规则。</p><p id="d85d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其他风格指南包括:</p><ul class=""><li id="2a93" class="mv mw iq kf b kg kh kk kl ko mx ks my kw mz la na nb nc nd bi translated">Airbnb—【https://github.com/airbnb/javascript T4】</li><li id="11b0" class="mv mw iq kf b kg ne kk nf ko ng ks nh kw ni la na nb nc nd bi translated">谷歌—<a class="ae kc" href="https://google.github.io/styleguide/javascriptguide.xml" rel="noopener ugc nofollow" target="_blank">https://google.github.io/styleguide/javascriptguide.xml</a></li><li id="0d79" class="mv mw iq kf b kg ne kk nf ko ng ks nh kw ni la na nb nc nd bi translated">jQuery—<a class="ae kc" href="https://contribute.jquery.org/style-guide/js/" rel="noopener ugc nofollow" target="_blank">https://contribute.jquery.org/style-guide/js/</a></li><li id="f304" class="mv mw iq kf b kg ne kk nf ko ng ks nh kw ni la na nb nc nd bi translated">标准JS—<a class="ae kc" href="http://standardjs.com/" rel="noopener ugc nofollow" target="_blank">http://standardjs.com/</a></li></ul><h1 id="afa3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">拥抱异步</h1><p id="c5f7" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们必须对节点应用程序使用异步代码。</p><p id="4213" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，他们就不会在等待某件事情完成的时候耽误整个应用程序。</p><p id="5f9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让我们的生活更容易，我们可以使用承诺来编写我们的异步代码。</p><p id="8033" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使它们更短，我们可以使用async和await。</p><p id="c8f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用<code class="fe lz ma mb mc b">util</code>模块将一些节点异步回调转换成承诺。</p><p id="182e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像<code class="fe lz ma mb mc b">fs</code>这样的模块也有返回承诺的方法版本。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/398586d7381e05cee46ed5909872cecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o_YL5DxcmNPaG4Gn"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@pupscruffs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Katie Bernotsky</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="32a4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="dd36" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">我们应该充分利用<code class="fe lz ma mb mc b">package.json</code>和<code class="fe lz ma mb mc b">npm</code>项目提供的功能。</p><p id="20e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们应该尽可能使用异步。</p><p id="6b06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一致的编码风格也很好。</p><h2 id="8300" class="mq lc iq bd ld nk nl dn lh nm nn dp ll ko no np lp ks nq nr lt kw ns nt lx nu bi translated"><strong class="ak">简单英语的JavaScript</strong></h2><p id="92a1" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>