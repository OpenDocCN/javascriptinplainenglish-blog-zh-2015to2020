<html>
<head>
<title>How to Fix ‘VirtualizedLists should never be nested inside plain ScrollViews’ Warning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何修复“虚拟化列表不应嵌套在普通ScrollViews中”警告</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-fix-virtualizedlists-should-never-be-nested-inside-plain-scrollviews-warning-3a2a887b4ea0?source=collection_archive---------0-----------------------#2020-02-20">https://javascript.plainenglish.io/how-to-fix-virtualizedlists-should-never-be-nested-inside-plain-scrollviews-warning-3a2a887b4ea0?source=collection_archive---------0-----------------------#2020-02-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3310" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以正确的方式修复常见的反应本机警告</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ddd9e50e686fcfcdfe8c6269118666b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p2rBEfMgJW5Bflub"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo from <a class="ae kv" href="https://unsplash.com/photos/YSZS_nDU8js" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d124" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您使用React Native开发应用程序，并且在普通的ScrollView中嵌套了FlatList或SectionList组件，您可能会在调试器中遇到以下警告:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="ba78" class="lx ly iq lt b gy lz ma l mb mc">VirtualizedLists should never be nested inside plain ScrollViews with the same orientation - use another VirtualizedList-backed container instead.</span></pre><p id="1ade" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然此警告表明当前配置不理想，但它没有解释为什么会有问题或如何解决问题。在本文中，我们将探讨这个警告背后的原因，并提供修复它的解决方案。</p><p id="b42d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虚拟化列表，如<code class="fe md me mf lt b">SectionList</code>和<code class="fe md me mf lt b">FlatList</code>，旨在优化性能和减少呈现大型内容列表时的内存消耗。这些列表仅呈现当前在屏幕上可见的内容，并用空白替换列表项的其余部分。当用户滚动时，列表根据滚动位置更新并呈现新项目。这种方法允许更平滑、更快速地呈现大型列表，而不会消耗过多的资源。</p><p id="154c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您将这两个列表中的任何一个放在ScrollView中，它们将无法计算当前窗口的大小，这会导致性能问题。此外，您将收到前面提到的警告。因此，在使用ScrollView时，确保列表能够正确计算当前窗口的大小是很重要的。</p><h1 id="2a67" class="mg ly iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">如何以正确的方式修复这个警告</h1><p id="cdc7" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">要修复前面讨论的警告，只需删除ScrollView，并将FlatList周围的所有组件放在ListFooterComponent和ListHeaderComponent中。</p><p id="5791" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的例子演示了这种方法，用户可以滚动浏览不同的配方。主视图由一组组件组成，如页眉、页脚、一些文本和封面照片，所有这些组件都包含在ListFooterComponent和ListHeaderComponent中。这允许FlatList正确计算当前窗口的大小，并消除了对ScrollView的需要。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="eccd" class="lx ly iq lt b gy lz ma l mb mc">const Main = () =&gt; {<br/>  return (<br/>    &lt;ScrollView&gt;<br/>      &lt;CoverPhoto <em class="nc">src</em>={images[0]} /&gt;<br/>      &lt;Title&gt;Welcome&lt;/Title&gt;<br/>      &lt;Text&gt;Take a look at the list of recipes below:&lt;/Text&gt;<br/>      &lt;Footer /&gt;<br/>    &lt;/ScrollView&gt;<br/>  );<br/>};</span></pre><p id="0e87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，假设我们想使用<code class="fe md me mf lt b">FlatList</code>在最后一个<code class="fe md me mf lt b">Text</code>元素下面列出所有的食谱，在这之后看起来会像这样:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="7b6a" class="lx ly iq lt b gy lz ma l mb mc">const Main = () =&gt; {<br/>  const renderItem= (item, index) =&gt; {<br/>    return (<br/>      &lt;Recipe<br/>      <em class="nc">key</em>={index}<br/>      <em class="nc">recipe</em>={item}&gt;<br/>    )<br/>  }</span><span id="4759" class="lx ly iq lt b gy nd ma l mb mc">  return (<br/>    &lt;ScrollView&gt;<br/>      &lt;CoverPhoto <em class="nc">src</em>={images[0]} /&gt;<br/>      &lt;Title&gt;Welcome&lt;/Title&gt;<br/>      &lt;Text&gt;Take a look at the list of recipes below:&lt;/Text&gt;<br/>      &lt;FlatList<br/>        <em class="nc">data</em>={recipes}<br/>        <em class="nc">renderItem</em>={renderItem}<br/>      /&gt;<br/>      &lt;Footer/&gt;<br/>    &lt;/ScrollView&gt;<br/>  );<br/>};</span></pre><p id="46cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，这会给你之前提到的警告，你也不能使用FlatList的性能特性。这就是为什么我们要完全去掉ScrollView，而使用ListFooterComponent和ListHeaderComponent属性，如下所示:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="29f8" class="lx ly iq lt b gy lz ma l mb mc">const Main = () =&gt; {<br/>  const renderItem= (item, index) =&gt; {<br/>    return (<br/>      &lt;Recipe<br/>      <em class="nc">key</em>={index}<br/>      <em class="nc">recipe</em>={item}&gt;<br/>    )<br/>  }</span><span id="de7f" class="lx ly iq lt b gy nd ma l mb mc">  return (<br/>    &lt;FlatList<br/>      <em class="nc">ListHeaderComponent</em>={<br/>      &lt;&gt;<br/>        &lt;CoverPhoto <em class="nc">src</em>={images[0]} /&gt;<br/>        &lt;Title&gt;Welcome&lt;/Title&gt;<br/>        &lt;Text&gt;Take a look at the list of recipes below:&lt;/Text&gt;<br/>      &lt;/&gt;}<br/>      <em class="nc">data</em>={recipes}<br/>      <em class="nc">renderItem</em>={renderItem}<br/>      <em class="nc">ListFooterComponent</em>={<br/>        &lt;Footer/&gt;<br/>      }/&gt;<br/>  );<br/>};</span></pre><p id="4149" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">两个props都只接受一个组件，所以我们用片段将组件包装在ListHeaderComponent中。</p><h2 id="8bd2" class="lx ly iq bd mh ne nf dn ml ng nh dp mp lf ni nj mr lj nk nl mt ln nm nn mv no bi translated">我们做到了！不再有警告，一切看起来还是一样！</h2></div></div>    
</body>
</html>