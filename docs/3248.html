<html>
<head>
<title>Custom Scrolling Direction React Hook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自定义滚动方向反应挂钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/custom-scrolling-direction-react-hook-f55558206ab6?source=collection_archive---------8-----------------------#2020-09-13">https://javascript.plainenglish.io/custom-scrolling-direction-react-hook-f55558206ab6?source=collection_archive---------8-----------------------#2020-09-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="ec17" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何让你网站上的导航条消失在滚动条上</h2></div><p id="c300" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望我的投资组合网站的导航栏在向下滚动时消失，在向上滚动时重新出现。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/e55a1ac0d44ab60f9d118fd476991a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6tb_PnqnsiCKYFC3GL4TxA.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Before Scrolling, navigation bar displayed</figcaption></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi lo"><img src="../Images/2798bda1d284d44513aa1c8f14a8441b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5w7plaGd2y4LHSDnakwzxw.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Once Scrolled down, navigation bar disappears</figcaption></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi lp"><img src="../Images/211c5943ad77d5b96c5773ce487f3df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVe2PJ9zIZf7OCtpo4RLrQ.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Upon scrolling up, navigation reappears</figcaption></figure><p id="0b6d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了实现上面的功能，我使用了<a class="ae lq" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"> React Hooks </a>来编写一个定制的钩子来决定用户的滚动方向。</p><p id="393a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">导航栏组件使用从挂钩返回的方向值将适当的Css样式应用于自身。</p><p id="ff21" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果用户在页面的顶部，导航条显示在顶部，没有应用特殊的Css样式。</p></div><div class="ab cl lr ls hr lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ig ih ii ij ik"><h1 id="6c9d" class="ly lz in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">我的useScrollDirection挂钩背后的逻辑</h1><p id="c811" class="pw-post-body-paragraph kc kd in ke b kf mq jo kh ki mr jr kk kl ms kn ko kp mt kr ks kt mu kv kw kx ig bi translated">为了确定用户的滚动量，我使用了<code class="fe mv mw mx my b">window.scrollY</code>。browser window对象的scrollY属性返回文档垂直滚动的像素数。</p><p id="2c63" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最初<code class="fe mv mw mx my b">window.scrollY</code>是0，用户向下滚动越多，它就变得越大。</p><p id="490f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在自定义挂钩中，我有两种状态:</p><ol class=""><li id="1c7b" class="mz na in ke b kf kg ki kj kl nb kp nc kt nd kx ne nf ng nh bi translated">滚动方向，最初为空</li><li id="69bf" class="mz na in ke b kf ni ki nj kl nk kp nl kt nm kx ne nf ng nh bi translated">从页面顶部开始的前一次滚动量，最初为0</li></ol><pre class="kz la lb lc gt nn my no np aw nq bi"><span id="9646" class="nr lz in my b gy ns nt l nu nv">const [scrollDirection, setScrollDirection] = useState(null)<br/>const [prevOffset, setPrevOffset] = useState(0)</span></pre><p id="b2d0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我还为窗口滚动事件订阅了一个事件监听器。我在效果挂钩的帮助下设置了订阅。</p><pre class="kz la lb lc gt nn my no np aw nq bi"><span id="c352" class="nr lz in my b gy ns nt l nu nv">useEffect(() =&gt; {<br/>    window.addEventListener("scroll", toggleScrollDirection)</span><span id="0306" class="nr lz in my b gy nw nt l nu nv">    <em class="nx">return</em> () =&gt; {<br/>        window.removeEventListener("scroll", toggleScrollDirection)<br/>    }<br/>})</span></pre><p id="abcd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">用户每滚动一次，<code class="fe mv mw mx my b">toggleScrollDirection</code>就会被调用。</p><p id="840b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在函数内部，用户滚动的量由一个变量捕获</p><pre class="kz la lb lc gt nn my no np aw nq bi"><span id="9c84" class="nr lz in my b gy ns nt l nu nv">let scrollY = window.scrollY;</span></pre><p id="c85b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后每次滚动发生时，检查以下条件，以便设置适当的滚动方向状态值。</p><pre class="kz la lb lc gt nn my no np aw nq bi"><span id="804c" class="nr lz in my b gy ns nt l nu nv"><em class="nx">if</em> (scrollY === 0) {<br/>    setScrollDirection(null)<br/>}</span><span id="c336" class="nr lz in my b gy nw nt l nu nv"><em class="nx">if</em> (scrollY &gt; prevOffset){<br/>    setScrollDirection("down")<br/>} <em class="nx">else</em> <em class="nx">if</em> (scrollY &lt; prevOffset) {<br/>    setScrollDirection("up")<br/>}</span><span id="3959" class="nr lz in my b gy nw nt l nu nv">setPrevOffset(scrollY);</span></pre><p id="d9fa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果用户在页面的顶部，scrollY将为零，因此我们将滚动方向设置为null。</p><p id="19df" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果用户向下滚动，那么scrollY值将大于存储在<code class="fe mv mw mx my b">prevOffset</code>状态中的最后一个scrollY值。</p><p id="6d46" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当用户向上滚动时，情况正好相反。在这两种情况下，<code class="fe mv mw mx my b">scrollDirection</code>状态将被适当地设置。</p><p id="b7a6" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后，<code class="fe mv mw mx my b">prevOffset</code>将被设置为这个最后的scrollY值，下次用户滚动时将被引用。</p><p id="452f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">整个钩子代码是</p><pre class="kz la lb lc gt nn my no np aw nq bi"><span id="16e5" class="nr lz in my b gy ns nt l nu nv">const useScrollDirection = () =&gt; {<br/>    const [scrollDirection, setScrollDirection] = useState(null)<br/>    const [prevOffset, setPrevOffset] = useState(0)</span><span id="6940" class="nr lz in my b gy nw nt l nu nv">    const toggleScrollDirection = () =&gt; {<br/>       let scrollY = window.scrollY<br/>       <em class="nx">if</em> (scrollY === 0) {<br/>           setScrollDirection(null)<br/>       }<br/>       <em class="nx">if</em> (scrollY &gt; prevOffset) {<br/>           setScrollDirection("down")<br/>       } <em class="nx">else</em> <em class="nx">if</em> (scrollY &lt; prevOffset) {<br/>           setScrollDirection("up")<br/>       }<br/>       setPrevOffset(scrollY)<br/>    }<br/>    useEffect(() =&gt; {<br/>        window.addEventListener("scroll", toggleScrollDirection)<br/>        <em class="nx">return</em> () =&gt; {<br/>            window.removeEventListener("scroll", toggleScrollDirection)<br/>        }<br/>    })</span><span id="82a2" class="nr lz in my b gy nw nt l nu nv">    <em class="nx">return</em> scrollDirection<br/>}</span></pre></div><div class="ab cl lr ls hr lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ig ih ii ij ik"><h1 id="ca07" class="ly lz in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">导航栏组件如何使用这个钩子来切换导航栏的外观</h1><p id="ee63" class="pw-post-body-paragraph kc kd in ke b kf mq jo kh ki mr jr kk kl ms kn ko kp mt kr ks kt mu kv kw kx ig bi translated">在Navbar组件中，我们捕获了从useScrollDirection钩子返回的滚动方向值。</p><pre class="kz la lb lc gt nn my no np aw nq bi"><span id="c200" class="nr lz in my b gy ns nt l nu nv">const scrollDirection = useScrollDirection()</span></pre><p id="fd2d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后根据<code class="fe mv mw mx my b">scrollDirection</code>，我们将应用适当的css样式到导航栏。</p><p id="eb63" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">导航条的样式可以用许多不同的方法来实现，所以我在本文中不再讨论。</p></div><div class="ab cl lr ls hr lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ig ih ii ij ik"><p id="8c92" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我在Medium上发表的第一篇文章。原谅我写得不好。我希望随着我写得越来越多而提高！希望你喜欢，觉得有用！</p><h2 id="1654" class="nr lz in bd ma ny nz dn me oa ob dp mi kl oc od mk kp oe of mm kt og oh mo oi bi translated">简单英语的JavaScript</h2><p id="9a7d" class="pw-post-body-paragraph kc kd in ke b kf mq jo kh ki mr jr kk kl ms kn ko kp mt kr ks kt mu kv kw kx ig bi translated">喜欢这篇文章吗？如果是这样，通过<a class="ae lq" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io">订阅解码获得更多类似内容，我们的YouTube频道</strong> </a> <strong class="ke io">！</strong></p></div></div>    
</body>
</html>