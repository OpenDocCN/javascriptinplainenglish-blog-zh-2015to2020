<html>
<head>
<title>How to get the current screen metadata in React within react-navigation?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在react-navigation内获取React中的当前屏幕元数据？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-get-the-current-screen-metadata-in-react-within-react-navigation-b9c18206e9c4?source=collection_archive---------2-----------------------#2019-11-02">https://javascript.plainenglish.io/how-to-get-the-current-screen-metadata-in-react-within-react-navigation-b9c18206e9c4?source=collection_archive---------2-----------------------#2019-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dec2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用导航状态排除公共陷阱的小指南！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f9984b2d3e03cb0f3447459afb5ab0a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4RRkSZ_hSmFxHw_n7R5wQ.png"/></div></div></figure><p id="9dd8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当将<a class="ae ln" href="https://reactnavigation.org/" rel="noopener ugc nofollow" target="_blank"> react-navigation </a>与<a class="ae ln" href="https://facebook.github.io/react-native/" rel="noopener ugc nofollow" target="_blank"> react-native </a>或<a class="ae ln" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">经典的基于网络的react应用</a>一起使用时，你可能有一天会问自己:</p><blockquote class="lo"><p id="818b" class="lp lq iq bd lr ls lt lu lv lw lx lm dk translated">如何获取<strong class="ak">当前路线</strong>元数据，如路线名称？</p></blockquote><p id="da31" class="pw-post-body-paragraph kr ks iq kt b ku ly jr kw kx lz ju kz la ma lc ld le mb lg lh li mc lk ll lm ij bi translated">这是一个非常常见的用例，但有时可能会有点棘手，很难找到如何处理它。</p><p id="5696" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是为什么我与你分享这个小指南来克服你可能经历的大多数失败案例，在几个小时的挣扎后，我希望这个模式能帮助你不要重蹈我的覆辙。</p><h1 id="5a34" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">👨🏻‍🔬让我们从一点理论开始</h1><p id="b3b8" class="pw-post-body-paragraph kr ks iq kt b ku mv jr kw kx mw ju kz la mx lc ld le my lg lh li mz lk ll lm ij bi translated">在我们的应用环境中，在<code class="fe na nb nc nd b">react-navigation</code>逻辑中，我们会遇到两种组件:</p><ol class=""><li id="7609" class="ne nf iq kt b ku kv kx ky la ng le nh li ni lm nj nk nl nm bi translated">导航组件的直接子组件，称为<strong class="kt ir">屏幕组件</strong></li><li id="631a" class="ne nf iq kt b ku nn kx no la np le nq li nr lm nj nk nl nm bi translated">导航树的任何其他嵌套子节点，不是屏幕组件，我将调用<strong class="kt ir">屏幕组件的嵌套子节点</strong>。</li></ol><p id="ce6f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">还有一个主要的缺陷，根据组件的上下文，你从道具中得到的导航状态是不一样的</strong></p><p id="ae07" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们一起来看看我们能做些什么来正确地获得当前的屏幕元数据。</p><h2 id="8992" class="ns me iq bd mf nt nu dn mj nv nw dp mn la nx ny mp le nz oa mr li ob oc mt od bi translated">➡️从屏幕组件获取当前屏幕元数据</h2><blockquote class="oe of og"><p id="319b" class="kr ks oh kt b ku kv jr kw kx ky ju kz oi lb lc ld oj lf lg lh ok lj lk ll lm ij bi translated">屏幕组件是导航器的直接子组件。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/65b1931b5271e7bdcba66da00c69083f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2nfS2C4f-JLW9c_Y4ipJug.png"/></div></div><figcaption class="om on gj gh gi oo op bd b be z dk"><strong class="bd oq">MainScreen</strong> and <strong class="bd oq">SelectPlayersScreen</strong> are direct children of your SwitchNavigator.</figcaption></figure><p id="bcbd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里很简单:只要你的屏幕是你的导航器的直接孩子，你只需要依赖来自<code class="fe na nb nc nd b">react-navigation-hooks</code>的<code class="fe na nb nc nd b">props.navigate.state</code>或<code class="fe na nb nc nd b">const navState = useNavigationState()</code>。</p><p id="2c6f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将为你的屏幕提供你需要的元数据，比如T4。</p><h2 id="b00c" class="ns me iq bd mf nt nu dn mj nv nw dp mn la nx ny mp le nz oa mr li ob oc mt od bi translated">➡️从屏幕组件的嵌套子组件获取当前屏幕元数据</h2><p id="165a" class="pw-post-body-paragraph kr ks iq kt b ku mv jr kw kx mw ju kz la mx lc ld le my lg lh li mz lk ll lm ij bi translated">如果您需要值的组件不是直接导航子组件，无论是使用<code class="fe na nb nc nd b">withNavigation</code> HOC、<code class="fe na nb nc nd b">useNavigation</code>还是<code class="fe na nb nc nd b">useNavigationState</code>钩子，您都可能得到整个状态树，因为react-navigation将无法解析当前上下文。</p><p id="29fd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> ✋🏻⚠️警告:</strong>你可以使用道具将屏幕组件的值传递给孩子，这是你应该考虑使用的首选方法。但是如果你不能，并且你在组件树中嵌套很深，你可以使用下面的代码片段加上一些传统的代码，这将帮助你处理这个问题。</p><blockquote class="oe of og"><p id="3f2a" class="kr ks oh kt b ku kv jr kw kx ky ju kz oi lb lc ld oj lf lg lh ok lj lk ll lm ij bi translated">getActiveRouteMetadata 是一个小的实用函数，它将帮助您从完整的导航状态树对象中检索当前的屏幕元数据。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="or os l"/></div><figcaption class="om on gj gh gi oo op bd b be z dk">A small utility function to dig into the navigation state tree</figcaption></figure><p id="fe4b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就这样过了导航状态就好了！</p><pre class="kg kh ki kj gt ot nd ou ov aw ow bi"><span id="d393" class="ns me iq nd b gy ox oy l oz pa">import { useNavigationState } from "react-navigation-hooks";</span><span id="85fa" class="ns me iq nd b gy pb oy l oz pa">function MyNestedComponent(){<br/>  const navState = useNavigationState();<br/>  const myScreenMetadata = getActiveRouteMetadata(navState);</span><span id="31f6" class="ns me iq nd b gy pb oy l oz pa">  return (<br/>    // … your component JSX …<br/>  )<br/>}</span></pre><h1 id="0c9d" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">🚛外卖/TLDR；📦</h1><p id="91c1" class="pw-post-body-paragraph kr ks iq kt b ku mv jr kw kx mw ju kz la mx lc ld le my lg lh li mz lk ll lm ij bi translated">在react-navigation中:获取当前活动路线的元数据有两种方式，这将取决于您实际所处的环境:</p><ul class=""><li id="14e6" class="ne nf iq kt b ku kv kx ky la ng le nh li ni lm pc nk nl nm bi translated"><strong class="kt ir">屏幕组件:</strong>仅使用<code class="fe na nb nc nd b">props.navigation.state</code>或挂钩<code class="fe na nb nc nd b">useNavigationState</code>。</li><li id="ab62" class="ne nf iq kt b ku nn kx no la np le nq li nr lm pc nk nl nm bi translated"><strong class="kt ir"> Screen组件的嵌套子组件:</strong>使用<code class="fe na nb nc nd b">props.navigation.state</code>或钩子<code class="fe na nb nc nd b">useNavigationState</code>并将状态传递给上面定义的爬行函数。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pd os l"/></div></figure></div></div>    
</body>
</html>