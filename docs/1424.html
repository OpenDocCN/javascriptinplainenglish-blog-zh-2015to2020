<html>
<head>
<title>Simple Pagination with Node.js, Express, and Mongoose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js、Express和Mongoose进行简单分页</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simple-pagination-with-node-js-mongoose-and-express-4942af479ab2?source=collection_archive---------0-----------------------#2020-03-14">https://javascript.plainenglish.io/simple-pagination-with-node-js-mongoose-and-express-4942af479ab2?source=collection_archive---------0-----------------------#2020-03-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bd25ea2b9fe1eefa98eebfa8f9dc1fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XLmOrb-sdWRTDIv1"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@swimstaralex?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexander Sinn</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="f713" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">用分页保持简单</h1><p id="73cc" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">您是否希望限制每次请求从MongoDB返回的文档数量？我们以前都看过，分页拯救！实现分页有很多方法，但我将向您展示最简单的方法(在我看来)来完成它。</p><p id="8196" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这种方法允许客户端在请求中提供两个查询参数:<strong class="ld ir">页面</strong>和<strong class="ld ir">限制</strong>。页面是指您正在请求的当前页面。限制是您希望检索的文档数量。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="6b9c" class="kd ke iq bd kf kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la bi translated">我们开始吧</h1><p id="9d14" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，我假设您已经掌握了使用Node.js、Express和Mongoose的基本知识。下面，我们有一个简单的express服务器运行在端口3000上，使用mongoose连接。我们还导入了一个猫鼬模型<strong class="ld ir">帖子</strong>，这样我们就可以在路由处理器中使用它。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="4828" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在上面的代码中，当我们向“/posts”发出GET请求时，我们将检索集合中的所有文档。让我们修改路由以合并分页。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="0989" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们来分解一下。当对“/post”路由发出请求时，我们将从请求查询中析构<strong class="ld ir">页面</strong>和<strong class="ld ir">限制</strong>。如果没有提供默认值，我们也会为它们提供默认值。如果提供了它们，它们将覆盖默认值。</p><p id="0503" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">现在，让我们看看mongoose查询。Limit是我们要检索的文档数。Skip是我们在检索文档之前希望跳过的文档数量。对于skip，我们取<strong class="ld ir">页</strong>减去1，<strong class="ld ir"> </strong>然后乘以<strong class="ld ir">极限</strong>。在第10行，我们获取全部文档并将其存储在变量<strong class="ld ir"> count </strong>中，这样我们就可以通过将计数除以限制来计算总页数。最后，我们返回文章、总页数和当前页面。我们将所有东西包装在一个try/catch中，以捕捉任何异常。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="a6e8" class="kd ke iq bd kf kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la bi translated">测试我们的简单分页解决方案</h1><p id="21c3" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">为了测试我们的简单分页解决方案，让我们使用Postman向“/posts”发出GET请求，将查询参数<strong class="ld ir"> page </strong>设置为1，将<strong class="ld ir"> limit </strong>设置为2。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/d4238685739ca0f17b3c39700048870c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U6aO5hZD8aaOox8XZqmTEQ.png"/></div></div></figure><p id="863d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">维奥拉。你有它！我们现在不是检索所有文档，而是检索第1页，共50页，限制为2页。</p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="81dc" class="kd ke iq bd kf kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la bi translated">结论</h1><p id="c812" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我想再次强调，实现分页的方法不止一种。如果您是使用分页的新手，我发现这是最简单的解决方案。在不久的将来，我将介绍游标分页，它为特定的记录提供了惟一的标识，并且在处理非常大的数据集时性能更好。我希望这篇文章对您有所帮助，并且您能够将它应用到您正在从事的任何项目中。</p><p id="567d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我在业余时间写这些文章是为了娱乐。如果你喜欢这篇文章，请在下面留下你的喜欢和评论！可以关注我上 <a class="ae kc" href="https://medium.com/@this.kevinluu" rel="noopener"> <em class="mx">中</em> </a> <em class="mx">和</em> <a class="ae kc" href="https://twitter.com/kluu_10" rel="noopener ugc nofollow" target="_blank"> <em class="mx">推特</em> </a> <em class="mx">。感谢支持！</em></p></div></div>    
</body>
</html>