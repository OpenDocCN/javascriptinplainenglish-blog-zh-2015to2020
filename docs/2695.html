<html>
<head>
<title>V8 for Node.js developers at a glance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向Node.js开发人员的V8概览</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/v8-for-node-js-developers-at-a-glance-129d7777456?source=collection_archive---------4-----------------------#2020-07-15">https://javascript.plainenglish.io/v8-for-node-js-developers-at-a-glance-129d7777456?source=collection_archive---------4-----------------------#2020-07-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><h1 id="51d2" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是JavaScript引擎？</h1><p id="9629" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">简而言之，JavaScript引擎是执行JavaScript源代码的运行时。JavaScript引擎应该具有以下组件:</p><p id="c59a" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><strong class="kk io">解析器</strong></p><p id="97c9" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">解析器将JavaScript源代码编译成抽象语法树，在一些引擎中，解析器还将抽象语法树转换成一段中间字节码。</p><p id="8d57" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><strong class="kk io">翻译</strong></p><p id="b0d6" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">解释器接受、解释并执行由解析器生成的中间字节码。</p><p id="5ebb" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><strong class="kk io"> JIT编译器</strong></p><p id="2ef6" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">JIT编译器尽可能快地将中间字节码转换成机器码。</p><p id="a663" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><strong class="kk io">垃圾收集器</strong></p><p id="e720" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">垃圾收集器负责垃圾收集。</p><p id="4641" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated"><strong class="kk io">剖析器</strong></p><p id="b87f" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">分析器收集引擎中的信息，以帮助提高引擎的性能和效率。</p><p id="2480" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">以下是一些流行的JavaScript引擎:</p><ul class=""><li id="b5f6" class="ll lm in kk b kl lg kp lh kt ln kx lo lb lp lf lq lr ls lt bi translated"><a class="ae lu" href="https://v8.dev/" rel="noopener ugc nofollow" target="_blank"> V8 </a>，谷歌的杰作，它支持基于Chromium的浏览器和Node.js。</li><li id="305b" class="ll lm in kk b kl lv kp lw kt lx kx ly lb lz lf lq lr ls lt bi translated"><a class="ae lu" href="https://github.com/WebKit/webkit/tree/master/Source/JavaScriptCore" rel="noopener ugc nofollow" target="_blank">苹果公司的JavaScriptCore </a>，用于基于Webkit的浏览器，如Safari。</li><li id="75b0" class="ll lm in kk b kl lv kp lw kt lx kx ly lb lz lf lq lr ls lt bi translated"><a class="ae lu" href="https://github.com/microsoft/ChakraCore" rel="noopener ugc nofollow" target="_blank"> Chakra </a>，来自微软，由较新版本的Internet Explorer使用。</li><li id="4e15" class="ll lm in kk b kl lv kp lw kt lx kx ly lb lz lf lq lr ls lt bi translated"><a class="ae lu" href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey" rel="noopener ugc nofollow" target="_blank">蜘蛛猴</a>，由Mozilla开发，火狐使用。</li></ul><h1 id="9387" class="jk jl in bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">V8简介</h1><p id="baf6" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">V8是用C++编写的JavaScript引擎，由Google开源。它运行在Linux、macOS和Windows上，是Chrome和Node.js的引擎。</p><p id="5398" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">V8有4个关键部件:</p><h2 id="d9dc" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">句法分析程序</h2><p id="c05b" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">它将JavaScript源代码解析成抽象的语法树。</p><h2 id="c850" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">点火，翻译</h2><p id="32e8" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">它有两个关键组件:<strong class="kk io">字节码生成器</strong>将抽象语法树转换成字节码，而<strong class="kk io">字节码解释器</strong>解释(执行)字节码。</p><p id="6587" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">当Ignition执行字节码时，通过内联缓存收集一些反馈，比如字节码执行的次数。如果同一个字节码被多次执行，就会被标记为<strong class="kk io"> HotSpot </strong>并发送给涡扇做进一步优化。</p><h2 id="b057" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">涡扇发动机，JIT优化编译器</h2><p id="bf9d" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">涡扇将HotSpot字节码编译成机器码并存储。下次执行字节码时，会用机器码替换原来的字节码，大大提高了字节码执行的有效性。</p><p id="3b18" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">此外，当涡扇确定一段字节码不再是热点时，它会执行一个去优化过程，丢弃优化后的机器码，然后返回点火。</p><p id="e2c4" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">整个工作流程如下所示:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/a618497a9f13d4ae2488cbb0cebcc73d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXkeO4hMf8Ib3h-E1GiUxQ.png"/></div></div></figure><h2 id="1a9a" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">奥里诺科河，垃圾收集器(GC)</h2><p id="ec00" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">V8中以前的GC机制采用了简单的顺序停止世界(STW)方法，这对于一些关键任务应用程序来说是一场灾难。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi my"><img src="../Images/71aa6917a4c78b797ce6945919de4795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d-H_KKalto6l26JfLWPARA.png"/></div></div></figure><p id="f1ea" class="pw-post-body-paragraph ki kj in kk b kl lg kn ko kp lh kr ks kt li kv kw kx lj kz la lb lk ld le lf ig bi translated">Orinoco没有放弃STW机制，而是采用了更聪明的方法来提高GC性能。它使用并行、并发和增量技术来显著减少主线程中垃圾收集的负担。</p><h2 id="6c21" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">平行的</h2><p id="4483" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">主线程和多个助手线程同时处理GC任务，因此总的停止时间缩短了。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mz"><img src="../Images/c3a03dc03c95494ecc994dd5bb527296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAd-9OGyokJOtzu1ZBIGvA.png"/></div></div></figure><h2 id="70c8" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">同时发生的</h2><p id="1f06" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">主线程只执行JavaScript，辅助线程在后台处理所有垃圾收集工作。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mz"><img src="../Images/a1308d7b12de726e61777d5ccc5d8c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9_Sg2lzY9H54UJ6Tjp8xbQ.png"/></div></div></figure><h2 id="4f42" class="ma jl in bd jm mb mc dn jq md me dp ju kt mf mg jy kx mh mi kc lb mj mk kg ml bi translated">增加的</h2><p id="f38d" class="pw-post-body-paragraph ki kj in kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">JavaScript在主线程中间歇执行，垃圾收集工作被分成更小的片段。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi my"><img src="../Images/a764161f53b9b793b4e778a2577739d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kOBrTaxIPgbl6WGrw2h3Nw.png"/></div></div></figure></div></div>    
</body>
</html>