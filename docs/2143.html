<html>
<head>
<title>Promises in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的承诺</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/promises-in-javascript-93390014bf79?source=collection_archive---------9-----------------------#2020-05-23">https://javascript.plainenglish.io/promises-in-javascript-93390014bf79?source=collection_archive---------9-----------------------#2020-05-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1db2042a57622e8fba922b76a399c6e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4JFvqKowznld6ONbIPj3A.jpeg"/></div></div></figure><h1 id="05f9" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">什么是承诺？</h1><p id="2b81" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在JavaScript中，就像在生活中一样，承诺是你希望在未来得到的东西，但不是现在。在JavaScript中，这个“某物”是带有附加值的本地对象类型。承诺处理异步时间内发生的事情。</p><h1 id="2587" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">真实世界的例子</h1><p id="4f16" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">为了理解承诺，我们先用一个真实世界的例子。假设你的伴侣去了商店，由于你辛苦工作了一整天，他或她答应给你买一瓶好酒。当你的伴侣在商店时，承诺是未解决的/待定的:直到他回来你才知道承诺的状态。从那里，总共有三种可能的结果专门关于这个承诺:1)你的伴侣成功地带着酒回来，并且解决/履行了承诺，2)你的伴侣忘记了酒，导致承诺被拒绝，以及3)你的伴侣通过虫洞开车到另一个维度，并且酒的承诺永远是未解决的/未决的。与真实世界的承诺类似，JavaScript承诺有3种状态:待定、已解决和已拒绝。</p><ul class=""><li id="a875" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated"><strong class="ky ir">未解决或待定</strong> —承诺在尚未准备好时处于待定状态，可能是在等待结果值可用。</li><li id="c9bc" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated"><strong class="ky ir">已解决或已履行</strong> —如果结果值可用，则承诺已解决。</li><li id="b3be" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated"><strong class="ky ir">拒绝</strong> —如果出现错误，承诺将被拒绝。</li></ul><p id="9ee7" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">为了达到“已解决”或“已拒绝”状态，承诺必须经过“待定”状态。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/0b7065b6295d9d9e222465547582fd31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*wUdXPLy0Rh4zj6KMUW9mbw.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">States of a Promise in JavaScript</figcaption></figure><h1 id="06be" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">承诺创造</h1><p id="d0db" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">JavaScript中的承诺是使用构造函数创建的。构造函数接受回调函数作为参数，回调函数又接受两个参数:resolve和reject，这两个参数又接受一个参数，这个参数可以是字符串、数字、布尔值、数组或对象。Resolve()和reject()是promise固有的静态方法，因此也可以在创建promise时立即调用。承诺还有其他静态方法:</p><ul class=""><li id="889b" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">all()-根据NearForm(2019)，all“接受一组承诺并返回一个承诺，该承诺要么在iterable参数中的所有承诺都实现时实现，要么在其中一个承诺拒绝时拒绝。如果返回的承诺实现了，那么它将按照array参数中定义的顺序，用一个由已实现承诺的值组成的数组来实现。如果返回的承诺被拒绝，它将被拒绝，原因来自被拒绝的数组中的第一个承诺。这种方法可用于汇总多个承诺的结果。”</li><li id="4c5e" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">全部结算()</li><li id="0bb0" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">race()-根据NearForm(2019)，race()，“接受一组承诺，并以与Promise.all相同的方式执行它们，不同之处在于，它返回一个承诺，只要<em class="mw">iterable中的一个</em>承诺满足或拒绝，该承诺就会满足或拒绝，并带有该承诺的值或原因。”—对超时功能有用</li></ul><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/d3f958de674de418f661d5dd16360a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ts2YVYndrkc6zJTCcICpA.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Promise Constructor Function</figcaption></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/093d377ec2672ec4b3dffc9012b52305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*ABqEcNq4wk7XqT8EQ5M9XA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Promise States</figcaption></figure><h1 id="f8b0" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">承诺消费</h1><p id="9bfd" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">既然我们已经完成了承诺创造，我们需要谈谈承诺消费。通过对承诺调用以下方法之一来冲减承诺:</p><ul class=""><li id="ec51" class="lu lv iq ky b kz lw ld lx lh ly ll lz lp ma lt mb mc md me bi translated">然后()</li><li id="8cf5" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">catch()</li><li id="e15d" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">最后()</li></ul><p id="a8a3" class="pw-post-body-paragraph kw kx iq ky b kz lw lb lc ld lx lf lg lh mk lj lk ll ml ln lo lp mm lr ls lt ij bi translated">然后，该方法()接受两个参数:第一个参数是解析承诺时调用的函数，第二个参数是拒绝承诺时调用的函数。如果您想区分成功和失败，可以使用catch()方法将拒绝处理程序附加到承诺中。finally()方法可以随意使用，它通常执行一般的清理操作，比如使加载指示器停止运行。</p><h1 id="a1eb" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">承诺链</h1><p id="414f" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">为了使用上述方法，他们必须遵守诺言。附加承诺也可以链接到原始承诺，如下例所示，其中承诺shareWine链接到原始willIGetWine承诺。随后，另一个then方法和catch方法被链接起来，以处理第二个承诺的实现和拒绝。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/e71dbf7bc44e1c73a5a07d136cb7a468.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*_yPzs7XtPblGMd7ubo67RQ.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Chaining Promises &amp; Promise Methods</figcaption></figure><h1 id="50c4" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">承诺用途</h1><p id="00d9" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">链接承诺允许您避免众所周知的“回调地狱”,这是处理多个异步操作的更神秘的方法。可以使用promises，而不是下面看到的嵌套回调函数的噩梦，每个回调函数都可以用. then()语句替换。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/b22c36bd7f877bc87d39aeb851527174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_BMGHc5EfRYZ8YHL4b4ngw.jpeg"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Callback Hell</figcaption></figure><h1 id="d09d" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">常见错误</h1><ul class=""><li id="8b43" class="lu lv iq ky b kz la ld le lh nb ll nc lp nd lt mb mc md me bi translated">嵌套承诺—使用all()</li><li id="eeca" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">破碎的承诺链</li><li id="1bbc" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">在承诺链中混合同步和异步代码</li><li id="5d8b" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">漏接</li><li id="a35e" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">忘记兑现承诺</li><li id="f4bb" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">允诺的同步代码</li><li id="ae42" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">混合承诺和异步/等待</li><li id="f511" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">返回承诺的异步函数</li><li id="ca55" class="lu lv iq ky b kz mf ld mg lh mh ll mi lp mj lt mb mc md me bi translated">将回调定义为异步函数</li></ul><h1 id="9b52" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="fdb5" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">承诺是有用的结构，它不仅允许您避免代码中不必要的异步过程的复杂性，而且使您的代码更加易读。</p><h1 id="3eb2" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">简明英语团队的一份说明</strong></h1><p id="3ff4" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？你可以在我们的主页<a class="ae ne" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> plainenglish.io </strong> </a>上找到所有这些——关注我们的出版物并<a class="ae ne" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">订阅我们的YouTube频道</strong> </a> <strong class="ky ir">来表达你的爱吧！</strong></p><h1 id="0938" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">参考</h1><div class="nf ng gp gr nh ni"><a href="https://www.nearform.com/blog/javascript-promises-the-definitive-guide/" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">Javascript承诺——权威指南</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">JavaScript的单线程、基于事件循环的并发模型使用所谓的…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">www.nearform.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://blog.logrocket.com/improve-async-programming-with-javascript-promises-1652ac8d036d/" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">用JavaScript promises改进异步编程</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">如果您以前编写过一些异步JavaScript代码，那么您已经对使用回调和…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.logrocket.com</p></div></div><div class="nr l"><div class="nx l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">利用承诺</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">是表示异步操作最终完成或失败的对象。既然大多数人都是…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">developer.mozilla.org</p></div></div><div class="nr l"><div class="ny l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">承诺</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">Promise对象表示异步操作的最终完成(或失败),及其结果…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">developer.mozilla.org</p></div></div><div class="nr l"><div class="nz l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://blog.bitsrc.io/6-ways-to-implement-a-promise-in-javascript-9238aec9c17b" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">在Javascript代码中使用承诺的6种方式</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">在创建这个之前，我没有想到会有这么多不同的方法来创建一个承诺。我想这是…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.bitsrc.io</p></div></div><div class="nr l"><div class="oa l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://javascript.info/promise-basics" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">承诺</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">想象一下，你是一名顶级歌手，粉丝们日夜询问你即将推出的单曲。为了得到一些解脱，你答应…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">javascript.info</p></div></div><div class="nr l"><div class="ob l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://www.javascripttutorial.net/es6/javascript-promises/" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">JavaScript承诺的权威指南</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">总结:在本教程中，您将了解JavaScript承诺，它们是什么，以及如何有效地使用它们。在…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">www.javascripttutorial.net</p></div></div><div class="nr l"><div class="oc l nt nu nv nr nw jw ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://blog.vanila.io/lets-talk-about-javascript-promises-be6cbd44a2da" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">让我们谈谈JavaScript的承诺</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">什么是承诺，为什么我们要使用它们？</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">blog.vanila.io</p></div></div><div class="nr l"><div class="od l nt nu nv nr nw jw ni"/></div></div></a></div></div></div>    
</body>
</html>