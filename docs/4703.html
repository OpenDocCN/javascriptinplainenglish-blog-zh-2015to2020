<html>
<head>
<title>Next.js — Dynamic Imports and Static Pages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Next.js —动态导入和静态页面</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/next-js-dynamic-imports-and-static-pages-bf7513c2f9dd?source=collection_archive---------9-----------------------#2020-12-31">https://javascript.plainenglish.io/next-js-dynamic-imports-and-static-pages-bf7513c2f9dd?source=collection_archive---------9-----------------------#2020-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0f6bc58464a3e294be3de428d534c92f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_vIWb2ca4Pcz-O2g"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@yogendras31?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Yogendra Singh</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4e1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以轻松地创建服务器端呈现的React应用程序和静态站点。</p><p id="b37f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解动态导入，并使用Next.js呈现静态页面。</p><h1 id="d67b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">动态导入</h1><p id="1e37" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">ES2020本身支持动态导入。</p><p id="3f1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在Next.js中使用它来动态导入组件。</p><p id="1d1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它也适用于服务器端渲染。</p><p id="8487" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我们可以将代码分割成易于管理的块。</p><p id="07e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="facf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/name.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5d5d" class="mq lc iq mh b gy mr ms l mt mu">function Name() {<br/>  return (<br/>    &lt;span&gt;world&lt;/span&gt;<br/>  )<br/>}</span><span id="4165" class="mq lc iq mh b gy mv ms l mt mu">export default Name</span></pre><p id="6880" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pages/hello.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="161e" class="mq lc iq mh b gy mr ms l mt mu">import dynamic from 'next/dynamic'</span><span id="ec3b" class="mq lc iq mh b gy mv ms l mt mu">const NameComponent = dynamic(() =&gt; import('../components/name'))</span><span id="119d" class="mq lc iq mh b gy mv ms l mt mu">function Hello() {<br/>  return (<br/>    &lt;div&gt;hello &lt;NameComponent /&gt;&lt;/div&gt;<br/>  )<br/>}</span><span id="e26d" class="mq lc iq mh b gy mv ms l mt mu">export default Hello</span></pre><p id="4d5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们导入了<code class="fe me mf mg mh b">dynamic</code>函数，并传入了一个调用<code class="fe me mf mg mh b">import</code>来导入组件的回调函数。</p><p id="2529" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在代码中使用<code class="fe me mf mg mh b">NameComponent</code>。</p><p id="036e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们应该看到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5270" class="mq lc iq mh b gy mr ms l mt mu">hello world</span></pre><p id="f4c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">已显示。</p><h1 id="14b5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">具有命名导出的动态组件</h1><p id="c1a7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以创建带有命名导出的动态组件。</p><p id="7f2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以写:</p><p id="7389" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/name.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="19b9" class="mq lc iq mh b gy mr ms l mt mu">export function Name({ }) {<br/>  return (<br/>    &lt;span&gt;world&lt;/span&gt;<br/>  )<br/>}</span></pre><p id="79c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pages/hello.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b44c" class="mq lc iq mh b gy mr ms l mt mu">import dynamic from 'next/dynamic'</span><span id="6b1b" class="mq lc iq mh b gy mv ms l mt mu">const NameComponent = dynamic(() =&gt; import('../components/Name').then((mod) =&gt; mod.Name)<br/>)</span><span id="3612" class="mq lc iq mh b gy mv ms l mt mu">function Hello() {<br/>  return (<br/>    &lt;div&gt;hello &lt;NameComponent /&gt;&lt;/div&gt;<br/>  )<br/>}</span><span id="3341" class="mq lc iq mh b gy mv ms l mt mu">export default Hello</span></pre><p id="92a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在回调中，我们用<code class="fe me mf mg mh b">then</code>回调来调用<code class="fe me mf mg mh b">import</code>以从模块中返回<code class="fe me mf mg mh b">Name</code>组件。</p><h1 id="21ac" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">带有自定义加载组件</h1><p id="7b0d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以添加一个组件，在组件加载时显示该组件。</p><p id="eb5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="410d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/name.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6df0" class="mq lc iq mh b gy mr ms l mt mu">function Name() {<br/>  return (<br/>    &lt;span&gt;world&lt;/span&gt;<br/>  )<br/>}<br/>export default Name</span></pre><p id="c9c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pages/hello.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="468b" class="mq lc iq mh b gy mr ms l mt mu">import dynamic from 'next/dynamic'</span><span id="08dc" class="mq lc iq mh b gy mv ms l mt mu">const NameComponent = dynamic(() =&gt; import('../components/Name'), { loading: () =&gt; &lt;p&gt;loading&lt;/p&gt; })</span><span id="0dc8" class="mq lc iq mh b gy mv ms l mt mu">function Hello() {<br/>  return (<br/>    &lt;div&gt;hello &lt;NameComponent /&gt;&lt;/div&gt;<br/>  )<br/>}</span><span id="f616" class="mq lc iq mh b gy mv ms l mt mu">export default Hello</span></pre><p id="d4f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在代码中有一个带有<code class="fe me mf mg mh b">loading</code>属性的对象，它的值是一个组件。</p><h1 id="8f44" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">禁用服务器端呈现</h1><p id="1122" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">通过将一个对象传递到属性设置为<code class="fe me mf mg mh b">false</code>的<code class="fe me mf mg mh b">dynamic</code>函数中，可以禁用服务器端呈现。</p><p id="2b4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><p id="c2e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">components/name.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="55c2" class="mq lc iq mh b gy mr ms l mt mu">function Name() {<br/>  return (<br/>    &lt;span&gt;world&lt;/span&gt;<br/>  )<br/>}<br/>export default Name</span></pre><p id="5a22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pages/hello.js</code></p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="91fb" class="mq lc iq mh b gy mr ms l mt mu">import dynamic from 'next/dynamic'</span><span id="c649" class="mq lc iq mh b gy mv ms l mt mu">const NameComponent = dynamic(() =&gt; import('../components/Name'), { ssr: false }<br/>)</span><span id="8505" class="mq lc iq mh b gy mv ms l mt mu">function Hello() {<br/>  return (<br/>    &lt;div&gt;hello &lt;NameComponent /&gt;&lt;/div&gt;<br/>  )<br/>}</span><span id="ec38" class="mq lc iq mh b gy mv ms l mt mu">export default Hello</span></pre><h1 id="ad97" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">静态HTML导出</h1><p id="179d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">next export</code>命令将我们的应用程序导出到静态HTML。</p><p id="07b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它的工作原理是将所有页面预先呈现为HTML。</p><p id="ef68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">页面可以导出一个<code class="fe me mf mg mh b">getStaticPaths</code>属性，返回我们想要预呈现的所有路径。</p><p id="f324" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">next export</code>应在我们的app中没有动态数据变化时使用。</p><p id="318a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使用它，我们运行:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="2ce8" class="mq lc iq mh b gy mr ms l mt mu">next build &amp;&amp; next export</span></pre><p id="8c54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">next build</code>开发应用程序，<code class="fe me mf mg mh b">next export</code>为我们提供HTML页面。</p><p id="949e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以将这两个命令添加到我们的<code class="fe me mf mg mh b">package.json</code>文件中:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7640" class="mq lc iq mh b gy mr ms l mt mu">"scripts": {<br/>  "build": "next build &amp;&amp; next export"<br/>}</span></pre><p id="3c71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并运行<code class="fe me mf mg mh b">npm run build</code>来运行它。</p><p id="89a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">getInitialProps</code>不能在任何页面上与<code class="fe me mf mg mh b">getStaticProps</code>或<code class="fe me mf mg mh b">getStaticPaths</code>一起使用。</p><h1 id="5d8d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="c600" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用Next.js动态导入组件。</p><p id="5325" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以将Next.js应用程序构建为静态HTML文件。</p><p id="60d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw?sub_confirmation=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>