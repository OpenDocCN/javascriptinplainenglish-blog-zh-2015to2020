<html>
<head>
<title>Create your own Ad Blocker Chrome Extension using React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React创建自己的广告拦截器Chrome扩展</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-your-own-ad-blocker-chrome-extension-using-react-part-i-ea04613b1583?source=collection_archive---------3-----------------------#2019-12-08">https://javascript.plainenglish.io/create-your-own-ad-blocker-chrome-extension-using-react-part-i-ea04613b1583?source=collection_archive---------3-----------------------#2019-12-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="6dd5" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">第一部分</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/1b959ee3c1b6e3d5e84102a2fa94faff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4Pu7BWDP4WpWOIYA"/></div></div></figure><p id="38d0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在这篇文章中，我将讲述使用React创建一个简单的广告拦截器chrome扩展的过程。</p><p id="6117" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">首先，我们将从使用create-react-app创建一个react项目开始。我们将其命名为广告拦截器。</p><pre class="kd ke kf kg gt lk ll lm ln aw lo bi"><span id="994c" class="lp lq in ll b gy lr ls l lt lu">npx create-react-app adblocker</span></pre><p id="d157" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一旦创建了项目，我们就可以开始配置它了。每个chrome扩展都需要一个<strong class="kq io"> <em class="lv">的manifest.json文件</em> </strong>放在根文件夹中。我们的项目在public文件夹下有一个<strong class="kq io"> <em class="lv"> manifest.json </em> </strong>文件。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/ed44485f98defd80f1150e703763b814.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*FEt8NQpjKGin-pLYbYY5kw.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">adblocker project</figcaption></figure><p id="8405" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将用下面的代码编辑它。</p><pre class="kd ke kf kg gt lk ll lm ln aw lo bi"><span id="32b1" class="lp lq in ll b gy lr ls l lt lu">{</span><span id="ca84" class="lp lq in ll b gy mb ls l lt lu">"name": "AD Blocker for Chrome",</span><span id="68e4" class="lp lq in ll b gy mb ls l lt lu">"version": "1.0",</span><span id="cddf" class="lp lq in ll b gy mb ls l lt lu">"manifest_version": 2,</span><span id="322a" class="lp lq in ll b gy mb ls l lt lu">"description": "Extension to block Ads in websites",</span><span id="2095" class="lp lq in ll b gy mb ls l lt lu">"icons":{</span><span id="4eba" class="lp lq in ll b gy mb ls l lt lu">"16":"logo.png",</span><span id="ec4e" class="lp lq in ll b gy mb ls l lt lu">"48":"logo.png",</span><span id="f332" class="lp lq in ll b gy mb ls l lt lu">"128":"logo.png"},</span><span id="f81f" class="lp lq in ll b gy mb ls l lt lu">"browser_action": {</span><span id="707c" class="lp lq in ll b gy mb ls l lt lu">"default_popup": "index.html",</span><span id="ab41" class="lp lq in ll b gy mb ls l lt lu">"default_title": "Block Popups"</span><span id="b895" class="lp lq in ll b gy mb ls l lt lu">},</span><span id="5068" class="lp lq in ll b gy mb ls l lt lu">"permissions": [</span><span id="27a7" class="lp lq in ll b gy mb ls l lt lu">]</span><span id="df75" class="lp lq in ll b gy mb ls l lt lu">}</span></pre><p id="d130" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">名称、版本和描述不言自明。因为我们的扩展是用一个<strong class="kq io"> <em class="lv"> manifest.json </em> </strong>文件包装的，所以我们需要指定它的版本。清单版本2当前正在生产中，版本1已被弃用。</p><p id="57a7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后我们将为我们的扩展添加图标。我添加了下图作为图标。它应该是在png格式和方形。默认情况下，我们应该给128x128图标。48x48和16x16尺寸可选。我们将提供单个png文件，chrome将根据要求自动调整大小。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/2beb152526d35157b58bf52683307e5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*qnTB-0NUMNqIVl-tTkDHdg.png"/></div></figure><p id="4ccc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">浏览器动作是您的扩展添加到浏览器工具栏的按钮。我们可以为该按钮定义许多动作，所有这些动作在<a class="ae md" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action" rel="noopener ugc nofollow" target="_blank">这里</a>都是可用的。我们将只添加<strong class="kq io">弹出框</strong>和<strong class="kq io">标题</strong>，前者在点击扩展时打开，后者在鼠标移动到扩展上时作为工具提示出现。</p><p id="77aa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将在文章的后面看到更多关于权限的内容。</p><p id="0616" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我们将通过运行以下命令来创建构建。它将创建一个包含所有必要文件的构建文件夹。</p><pre class="kd ke kf kg gt lk ll lm ln aw lo bi"><span id="c0dc" class="lp lq in ll b gy lr ls l lt lu">npm run build</span></pre><p id="2945" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这样，我们的chrome扩展就可以导入了。但是我们仍然缺少实际的代码。我们将在chrome中导入它，并在添加代码之前查看它的外观。</p><p id="ab4e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我将在Chrome中进入<strong class="kq io"> <em class="lv">扩展</em> </strong>并启用<strong class="kq io"> <em class="lv">开发者模式</em> </strong>。之后，我将点击<strong class="kq io"> <em class="lv"> Load Unpacked </em> </strong>并选择文件夹“<strong class="kq io"><em class="lv">ad blocker/build</em></strong>”，其中包含了<strong class="kq io"><em class="lv">【index.html】</em></strong>和<strong class="kq io"> <em class="lv"> manifest.json文件。</em>T41】</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi me"><img src="../Images/f56a25c1836b8a14dcf8d1a4ff8ffe1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOxagNTraCuZavzWRBUqEQ.png"/></div></div></figure><p id="929c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在chrome扩展被导入。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/99d2c10c4d0982e2d2958ebce8aad670.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*mwMIFB_lOw4goGNjMRfomw.png"/></div></figure><p id="dcac" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，如果我们试图点击扩展，它会抛出一个错误。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/f39b13fba3aaa1a6e2130eb2d23922a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*JJhvprnFAP8OaNSqn-8kMQ.png"/></div></figure><p id="92e9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">默认情况下，Chrome会阻止扩展中的内联脚本。由于我们的代码是一个内联脚本，我们得到了与控制台中的内容安全策略(CSP)相关的错误消息。在错误消息中，我们将获得阿沙值，该值可以添加到<strong class="kq io"> manifest.json </strong>文件中以解决问题。<strong class="kq io"> <em class="lv"> manifest.json </em> </strong>添加“内容_安全_策略”后会是这个样子。</p><pre class="kd ke kf kg gt lk ll lm ln aw lo bi"><span id="854f" class="lp lq in ll b gy lr ls l lt lu">{</span><span id="c009" class="lp lq in ll b gy mb ls l lt lu">"name": "AD Blocker for Chrome",</span><span id="106e" class="lp lq in ll b gy mb ls l lt lu">"version": "1.0",</span><span id="5583" class="lp lq in ll b gy mb ls l lt lu">"manifest_version": 2,</span><span id="4e03" class="lp lq in ll b gy mb ls l lt lu">"description": "Extension to block Ads in websites",</span><span id="9412" class="lp lq in ll b gy mb ls l lt lu">"icons":{</span><span id="768e" class="lp lq in ll b gy mb ls l lt lu">"16":"logo.png",</span><span id="f350" class="lp lq in ll b gy mb ls l lt lu">"48":"logo.png",</span><span id="466d" class="lp lq in ll b gy mb ls l lt lu">"128":"logo.png"},</span><span id="186d" class="lp lq in ll b gy mb ls l lt lu">"browser_action": {</span><span id="cb5d" class="lp lq in ll b gy mb ls l lt lu">"default_popup": "index.html",</span><span id="4787" class="lp lq in ll b gy mb ls l lt lu">"default_title": "Open the popup",</span><span id="97d4" class="lp lq in ll b gy mb ls l lt lu">"default_icon": "logo.png" },</span><span id="3fdb" class="lp lq in ll b gy mb ls l lt lu">"content_security_policy": "script-src 'self' 'sha256-rTpuMVDTLP90//GVrwK+H6xwjTfatAeBhhFKY7X0EwE='; object-src 'self'",</span><span id="24a5" class="lp lq in ll b gy mb ls l lt lu">"permissions": []</span><span id="80a0" class="lp lq in ll b gy mb ls l lt lu">}</span></pre><p id="7e59" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一旦我们在chrome中重新构建并再次导入扩展，一切都会好的。当我们点击扩展，我们应该看到一个弹出如下。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/6074f762c850e5015fe4cb4aec4a3d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*Stvk_fV5UTTbbXhIv8NlPQ.png"/></div></figure><p id="4356" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们现在有一个模板chrome扩展。在下一部分，我们将利用Chrome的<a class="ae md" href="https://developer.chrome.com/extensions/webRequest" rel="noopener ugc nofollow" target="_blank"> webRequest </a> API来拦截http请求，并构建将执行实际操作的扩展。</p></div></div>    
</body>
</html>