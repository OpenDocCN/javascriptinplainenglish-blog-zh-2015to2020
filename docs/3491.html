<html>
<head>
<title>Better JavaScript — Primitives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更好的JavaScript——原语</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/better-javascript-primitives-d05e41a5dec4?source=collection_archive---------8-----------------------#2020-10-03">https://javascript.plainenglish.io/better-javascript-primitives-d05e41a5dec4?source=collection_archive---------8-----------------------#2020-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f29c281ffed1052cd8f48bcfb369e0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vp8JB-6AW_4lExjh"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@veechoy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Virginia Choy</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1dab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，JavaScript应用程序也必须写得很好。</p><p id="9a1d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们以后会遇到各种各样的问题。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究改进JavaScript代码的方法。</p><h1 id="00a1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将对象转换为图元</h1><p id="1707" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">可以用<code class="fe me mf mg mh b">valueOf</code>方法将对象转换成数字。</p><p id="db1b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="21e2" class="mq lc iq mh b gy mr ms l mt mu">const obj = {<br/>  valueOf() {<br/>    return 3;<br/>  }<br/>};</span><span id="16ae" class="mq lc iq mh b gy mv ms l mt mu">console.log(2 + obj);</span></pre><p id="65ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们看到5个日志。</p><p id="f192" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以这样把一个对象转换成一个字符串:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9372" class="mq lc iq mh b gy mr ms l mt mu">const obj = {<br/>  toString() {<br/>    return 'bar';<br/>  }<br/>};</span><span id="e904" class="mq lc iq mh b gy mv ms l mt mu">console.log('foo' + obj);</span></pre><p id="7c31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="977a" class="mq lc iq mh b gy mr ms l mt mu">'foobar'</span></pre><p id="63f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">记录在案。</p><p id="f49b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一个对象同时有<code class="fe me mf mg mh b">valueOf</code>和<code class="fe me mf mg mh b">toString</code>方法，那么不清楚哪个会被运行。</p><p id="109a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d572" class="mq lc iq mh b gy mr ms l mt mu">const obj = {<br/>  toString() {<br/>    return "[object obj]";<br/>  },<br/>  valueOf() {<br/>    return 'bar';<br/>  }<br/>};</span><span id="b320" class="mq lc iq mh b gy mv ms l mt mu">console.log('foo' + obj);</span></pre><p id="a752" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们看到<code class="fe me mf mg mh b">'foobar'</code>被记录。</p><p id="f89c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们知道，如果<code class="fe me mf mg mh b">valueOf</code>和<code class="fe me mf mg mh b">toString</code>都存在，那么<code class="fe me mf mg mh b">valueOf</code>将被运行。</p><p id="62ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">valueOf</code>设计用于表示数值的对象，如<code class="fe me mf mg mh b">Number</code>对象。</p><p id="fbb2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这些对象，<code class="fe me mf mg mh b">toString</code>和<code class="fe me mf mg mh b">valueOf</code>是一致的。</p><p id="c367" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们都返回数字的字符串表示形式。</p><p id="1b73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对字符串的强制远比对数字的强制更常见。</p><p id="8d62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最好避免<code class="fe me mf mg mh b">valueOf</code>，除非对象是数字的抽象。</p><p id="0a31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一种胁迫被称为真实。</p><p id="9a69" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">||</code>和<code class="fe me mf mg mh b">&amp;&amp;</code>使用布尔值，但是它们可以接受任何东西。</p><p id="147f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一个值是真的，那么它们会被强制执行<code class="fe me mf mg mh b">true</code>。</p><p id="1d87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，他们就是假的，他们被迫<code class="fe me mf mg mh b">false</code>。</p><p id="6bc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">false</code>，0，-0，“”，<code class="fe me mf mg mh b">NaN</code>，<code class="fe me mf mg mh b">null</code>，<code class="fe me mf mg mh b">undefined</code>为假。</p><p id="428a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其他价值观都是真理。</p><p id="b91c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果第一个操作数是falsy，那么<code class="fe me mf mg mh b">||</code>操作符让我们返回一个默认值。</p><p id="1592" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，不写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e5f5" class="mq lc iq mh b gy mr ms l mt mu">function point(x, y) {<br/>  if (!x) {<br/>    x = 10;<br/>  }<br/>  if (!y) {<br/>    y = 20;<br/>  }<br/>  return {<br/>    x,<br/>    y<br/>  };<br/>}</span></pre><p id="fed8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1c11" class="mq lc iq mh b gy mr ms l mt mu">function point(x, y) {<br/>  if (typeof x === "undefined") {<br/>    x = 10;<br/>  }<br/>  if (typeof y === "undefined") {<br/>    y = 20;<br/>  }</span><span id="6eef" class="mq lc iq mh b gy mv ms l mt mu">  return {<br/>    x,<br/>    y<br/>  };<br/>}</span></pre><p id="e51e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f0e6" class="mq lc iq mh b gy mr ms l mt mu">function point(x, y) {<br/>  x = x || 10;<br/>  y = y || 20;<br/>  return {<br/>    x,<br/>    y<br/>  };<br/>}</span></pre><p id="9f5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">||</code>操作符接受所有的falsy值，如果第一个操作数是falsy，则返回第二个操作数。</p><h1 id="6eb8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">原语比对象包装要好</h1><p id="9d3e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">原语比对象包装要好。</p><p id="5911" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript有各种原始值。</p><p id="35c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们包括布尔值、数字、字符串、<code class="fe me mf mg mh b">null</code>和<code class="fe me mf mg mh b">undefined</code>。</p><p id="9477" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">null</code>用<code class="fe me mf mg mh b">typeof</code>运算符报告为<code class="fe me mf mg mh b">'object'</code>，但在ES标准中被定义为一个单独的类型。</p><p id="7f0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript标准库也为这些对象提供了构造函数。</p><p id="b74a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="66a7" class="mq lc iq mh b gy mr ms l mt mu">const s = new String("hello");</span></pre><p id="111d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="42b1" class="mq lc iq mh b gy mr ms l mt mu">const str = "hello";</span></pre><p id="61ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用方括号提取一个字符。</p><p id="35d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5b11" class="mq lc iq mh b gy mr ms l mt mu">s[4]</span></pre><p id="cc16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了<code class="fe me mf mg mh b">'o'</code>。</p><p id="927f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是如果有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="59fa" class="mq lc iq mh b gy mr ms l mt mu">typeof s</span></pre><p id="ec5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它返回<code class="fe me mf mg mh b">'object'</code>。</p><p id="b6db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d0cd" class="mq lc iq mh b gy mr ms l mt mu">typeof str</span></pre><p id="f0ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们得到<code class="fe me mf mg mh b">'string'</code>。</p><p id="761a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ff8d" class="mq lc iq mh b gy mr ms l mt mu">const s1 = new String("foo");<br/>const s2 = new String("foo");</span></pre><p id="4d89" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们写下:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9335" class="mq lc iq mh b gy mr ms l mt mu">s1 === s2</span></pre><p id="c0d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于引用不同，它返回<code class="fe me mf mg mh b">false</code>。</p><p id="a14e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它只能等于它自己。</p><p id="30a7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所看到的，这是字符串包装器对象和其他原始包装器的问题。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/dfaa484e7d1e614af59059763d99b11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xh3d5T1A56Lj_f3F"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@thegreatnima?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">nima hatami</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5dc0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="64d1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该使用原始的包装对象。</p><p id="0a46" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们在我们的代码中没有用。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/787be6c671be8d345dc786dad8729ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s-sOyyG8NoRbKpCG_y4Cmw@2x.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank">Subscribe to Decoded, our official YouTube channel!</a></figcaption></figure></div></div>    
</body>
</html>