<html>
<head>
<title>JavaScript Tips — Disabling Divs, Dynamic Script Elements, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript技巧—禁用div、动态脚本元素等等</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-tips-disabling-divs-dynamic-script-elements-and-more-af9dcbf18ffb?source=collection_archive---------3-----------------------#2020-08-15">https://javascript.plainenglish.io/javascript-tips-disabling-divs-dynamic-script-elements-and-more-af9dcbf18ffb?source=collection_archive---------3-----------------------#2020-08-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/af3f6ee5edbbdd7d38855edc70ac9f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_vEwerrboCyjl9Nl"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mbenna?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mike Benna</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fcf4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像任何类型的应用程序一样，当我们编写JavaScript应用程序时，有一些困难的问题需要解决。</p><p id="96a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究一些常见JavaScript问题的解决方案。</p><h1 id="47cb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何禁用所有div内容</h1><p id="abd5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">pointer-events: none</code>样式来禁用div元素上的鼠标交互。</p><p id="5567" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以编写以下代码，用JavaScript禁用div上的交互:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f813" class="mq lc iq mh b gy mr ms l mt mu">$("div").addClass("disabled");</span></pre><p id="7071" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么<code class="fe me mf mg mh b">disabled</code>类将具有以下样式:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="05dc" class="mq lc iq mh b gy mr ms l mt mu">.disabled {<br/>  pointer-events: none;<br/>  opacity: 0.5;<br/>}</span></pre><p id="f5bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们禁用鼠标交互，并使div内容半透明。</p><h1 id="6d39" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用async-await语法拒绝承诺</h1><p id="fa21" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们想拒绝一个异步函数返回的承诺，我们可以抛出一个错误或者使用<code class="fe me mf mg mh b">Promise.reject</code>。</p><p id="345a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4950" class="mq lc iq mh b gy mr ms l mt mu">const asyncFn = async () =&gt; {<br/>  try {<br/>    const val = await foo();<br/>    //...<br/>  }<br/>  catch(error) {<br/>    throw new Error('error');<br/>  }<br/>}</span></pre><p id="4039" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后返回的承诺被拒绝，原因是<code class="fe me mf mg mh b">'error'</code>。</p><p id="bde4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以用<code class="fe me mf mg mh b">Promise.reject</code>来写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="c354" class="mq lc iq mh b gy mr ms l mt mu">const asyncFn = async () =&gt; {<br/>  try {<br/>    const val = await foo();<br/>    //...<br/>  }<br/>  catch(error) {<br/>    return Promise.reject(new Error('error'));<br/>  }<br/>}</span></pre><p id="534e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">catch</code>块中，我们返回一个被<code class="fe me mf mg mh b">Promise.reject</code>方法拒绝的承诺。</p><p id="d1ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们仍然以原因<code class="fe me mf mg mh b">'error'</code>传入<code class="fe me mf mg mh b">Error</code>实例。</p><h1 id="e2fa" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用JavaScript计算昨天的日期</h1><p id="d239" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">getDate</code>方法计算昨天的日期来返回当月的日期</p><p id="70e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们从中减去1，并将其传递给<code class="fe me mf mg mh b">setDate</code>方法。</p><p id="c549" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1d67" class="mq lc iq mh b gy mr ms l mt mu">const date = new Date();<br/>date.setDate(date.getDate() - 1);</span></pre><h1 id="57cb" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">追加<script>元素&lt;/root&gt;</script></h1><p id="a91c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了动态地向DOM添加一个脚本元素，我们可以调用<code class="fe me mf mg mh b">createElement</code>来创建一个元素。</p><p id="a29e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以调用<code class="fe me mf mg mh b">appendChild</code>来追加新创建的脚本元素。</p><p id="4199" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="21bb" class="mq lc iq mh b gy mr ms l mt mu">const script = document.createElement("script");<br/>script.type = "text/javascript"; <br/>script.text = "console.log('hello');"<br/>document.body.appendChild(script);</span></pre><p id="4949" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们用内嵌代码创建了一个脚本。</p><p id="4909" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">appendChild</code>来追加脚本。</p><p id="ccfb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以编写以下内容来追加链接的脚本:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5ef9" class="mq lc iq mh b gy mr ms l mt mu">const script = document.createElement("script");<br/>script.type = "text/javascript"; <br/>script.src   = "/script.js";<br/>document.body.appendChild(script);</span></pre><p id="081c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们追加<code class="fe me mf mg mh b">script.js</code>来设置脚本的路径。</p><p id="947b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其他都一样。</p><h1 id="16d9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">获取鼠标点击画布元素的坐标</h1><p id="5d4c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要获得鼠标点击画布元素的坐标，我们可以使用<code class="fe me mf mg mh b">clientX</code>和<code class="fe me mf mg mh b">clientY</code>属性。</p><p id="a569" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="bd4d" class="mq lc iq mh b gy mr ms l mt mu">const getCursorPosition = (canvas, event) =&gt; {<br/>  const rect = canvas.getBoundingClientRect();<br/>  const x = event.clientX - rect.left;<br/>  const y = event.clientY - rect.top;<br/>  console.log(x, y);<br/>}</span></pre><p id="c9df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">getBoundingClientRect</code>方法来获得画布的<code class="fe me mf mg mh b">left</code>和<code class="fe me mf mg mh b">top</code>偏移量。</p><p id="df2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们分别从<code class="fe me mf mg mh b">clientX</code>和<code class="fe me mf mg mh b">clientY</code>中减去它们，得到鼠标在画布中的坐标。</p><p id="0690" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们可以通过编写来使用这个函数:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ed6c" class="mq lc iq mh b gy mr ms l mt mu">const canvas = document.querySelector('canvas')<br/>canvas.addEventListener('mousedown', (e) =&gt; {<br/>  getCursorPosition(canvas, e)<br/>})</span></pre><h1 id="c0d6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">检查JavaScript字符串是否是URL</h1><p id="1fda" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以使用<code class="fe me mf mg mh b">URL</code>构造函数来检查JavaScript字符串是否是有效的URL。</p><p id="a408" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6f22" class="mq lc iq mh b gy mr ms l mt mu">const isValidUrl = (string) =&gt; {<br/>  try {<br/>    new URL(string);<br/>  } catch(e) {<br/>    return false;  <br/>  }<br/>  return true;<br/>}</span></pre><p id="377c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们尝试创建一个<code class="fe me mf mg mh b">URL</code>实例，看看它是否是一个URL。</p><p id="28a9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果是，那么不会抛出异常，我们返回<code class="fe me mf mg mh b">true</code>。</p><p id="6480" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，我们在<code class="fe me mf mg mh b">catch</code>块中返回<code class="fe me mf mg mh b">false</code>，因为当<code class="fe me mf mg mh b">URL</code>构造函数试图解析一个无效的URL字符串时会抛出一个异常。</p><h1 id="28c5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用encodeURI或encodeURIComponent对URL进行编码</h1><p id="4c95" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><code class="fe me mf mg mh b">encodeURI</code>假设输入是我们作为参数传入的完整URI。</p><p id="2b31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用特殊的含义编码一切。</p><p id="fe64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="7a0c" class="mq lc iq mh b gy mr ms l mt mu">encodeURIComponent('&amp;');</span></pre><p id="4e54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并返回<code class="fe me mf mg mh b">“%26”</code>。</p><p id="8c8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="e881" class="mq lc iq mh b gy mr ms l mt mu">encodeURI('http://example.com/?foo= bar')</span></pre><p id="28c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并得到<code class="fe me mf mg mh b">“http://example.com/?foo=%20bar"</code>。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/d8e6d73ddd7b92cbdec8e470daaf2495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1mLNzn8_Ns6RteLR"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@suicide_chewbacca?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ashwini Chaudhary</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e73b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="8ad8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用一些CSS禁用div交互性。</p><p id="5800" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在异步函数中有两种方法返回被拒绝的承诺。</p><p id="8490" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">URL</code>构造函数消除了解析URL字符串的困难。</p><p id="0cac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">脚本标签可以动态插入。</p><p id="1132" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以用一些属性来检查鼠标在画布上的位置。</p><p id="c719" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以用<code class="fe me mf mg mh b">Date</code>实例方法计算昨天的日期。</p><h2 id="9e15" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated"><strong class="ak">简单英语的JavaScript</strong></h2><p id="fa4e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>