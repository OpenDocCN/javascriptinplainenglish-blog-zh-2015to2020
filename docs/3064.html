<html>
<head>
<title>How to Build a Radio Button Tree using Angular FormArray</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用角度数组构建单选按钮树</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-a-radio-button-tree-using-angular-formarray-b30c4c49e65c?source=collection_archive---------5-----------------------#2020-08-25">https://javascript.plainenglish.io/building-a-radio-button-tree-using-angular-formarray-b30c4c49e65c?source=collection_archive---------5-----------------------#2020-08-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5aa9c92fd7681c8f0efac96ad8c3eb57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Cr2vh5aQ1iAuFSEK"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@glenncarstenspeters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Glenn Carstens-Peters</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="faca" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我在许多web应用程序中发现了单选按钮树结构。这个故事展示了实现它的许多方法之一。</p><p id="c022" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我们要用的数据下面。这是一个从<strong class="kc io"> books.ts </strong>导出的对象数组</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="0665" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">每个对象都描述了书的类型、写过这种类型的书的作者以及他们写过的书。我们已经将上述数据填入如下表格。我们还打印了表单的值。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/29386e0c772ed0447e1f6cd7ded1b8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIDbKdscY7AjF3iLW_6-lg.png"/></div></div></figure><p id="0573" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> AppComponent模板:</strong></p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><ol class=""><li id="f832" class="lf lg in kc b kd ke kh ki kl lh kp li kt lj kx lk ll lm ln bi translated">从books.ts导出的<strong class="kc io">book list</strong>数组对应下面的形式数组<strong class="kc io"> booksArray </strong>。</li></ol><pre class="ky kz la lb gt lo lp lq lr aw ls bi"><span id="296b" class="lt lu in lp b gy lv lw l lx ly">&lt;ng-container <strong class="lp io">formArrayName=”booksArray”</strong>&gt;</span></pre><p id="e819" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">2.books数组中的每个对象包含两个属性:类型和作者。type是字符串，authors是对象数组。</p><p id="3320" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以每个对象都是一个<strong class="kc io">表单组</strong>，<strong class="kc io">类型字符串</strong>对应于<strong class="kc io">类型表单控件</strong>，而<strong class="kc io">作者数组</strong>对应于<strong class="kc io">作者数组</strong>。</p><pre class="ky kz la lb gt lo lp lz bn ma mb bi"><span id="d1d3" class="mc lu in lp b be md me l mf ly">&lt;li *ngFor=”let x of booksFormArray.controls; let i = index”<br/>[formGroupName]=”i”&gt;<br/>&lt;i #bookType appToggleChevron class=”fa fa-angle-double-right”&gt;<br/>&lt;input type=”text” formControlName=”type” /&gt;<br/>&lt;/i&gt;<br/>&lt;ng-container formArrayName=”authors”&gt;</span></pre><p id="bef3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">3.在authors数组中，我们再次拥有具有两个属性的对象:name和books。name是字符串，books是字符串数组。</p><p id="77b5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以每个对象都是一个<strong class="kc io">表单组。name属性</strong>对应于<strong class="kc io"> name FormControl </strong>，而<strong class="kc io"> books数组属性</strong>对应于<strong class="kc io"> select FormArray </strong>。</p><pre class="ky kz la lb gt lo lp lz bn ma mb bi"><span id="0d41" class="mc lu in lp b be md me l mf ly">&lt;li *ngFor=”let y of x.get(‘authors’).controls; let j = index”<br/>[formGroupName]=”j”<br/>&lt;i #authorName appToggleChevron class=”fa fa-angle-double-right”&gt;<br/>&lt;input type=”text” formControlName=”name” /&gt;<br/>&lt;/i&gt;<br/>&lt;ul [ngClass]=”[authorName.classList.contains(‘fa-angle-double-right’)? ‘close’: ‘open’]”&gt;<br/>&lt;li *ngFor=”let z of y.get(‘books’).value”&gt;<br/>&lt;input type=”radio” formControlName=”select” [value]=”z” /&gt;{{z}}<br/>&lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="ee9c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> AppComponent类:</strong></p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="b380" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们从<strong class="kc io"> books.ts </strong>中导出的数据是一个包含对象数组的对象。我们已经将这个对象数组存储在属性<strong class="kc io">数据</strong>中。</p><p id="0f80" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，我们将首先使用名为<strong class="kc io"> booksArray </strong>的<strong class="kc io">for array</strong>构建数组，如下所示。数组被初始化为[]。</p><pre class="ky kz la lb gt lo lp lz bn ma mb bi"><span id="576b" class="mc lu in lp b be md me l mf ly">ngOnInit() {<br/>this.radioForm=this.fb.group({<br/>booksArray: this.fb.array([]),<br/>});<br/>this.displayBooks();<br/>}</span></pre><p id="50e4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">属性数据</strong>中的每个book对象对应一个FormGroup，对象中的每个属性基于属性值对应一个form control/FormArray/form group。</p><p id="3fc0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面的<strong class="kc io"> displayBooks() </strong>将把属性数据中的每个book对象映射到一个FormGroup。这个映射是通过<strong class="kc io"> createBookFormGroup()完成的。</strong>此方法以book对象作为参数。</p><p id="995d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">映射的结果是存储在变量<strong class="kc io"> transformedBooks </strong>中的FormGroups数组。然后使用<strong class="kc io"> setControl()将<strong class="kc io">转换后的Books </strong>设置为格式数组<strong class="kc io"> booksArray </strong>的值。</strong></p><pre class="ky kz la lb gt lo lp lz bn ma mb bi"><span id="0962" class="mc lu in lp b be md me l mf ly">displayBooks() {<br/>let transformedBooks = this.data.map((book: any) =&gt;<br/>this.createBookFormGroup(book)<br/>);<br/>this.radioForm.setControl(‘booksArray’, this.fb.array(transformedBooks));<br/>}</span></pre><pre class="mg lo lp lz bn ma mb bi"><span id="490c" class="mc lu in lp b be md me l mf ly">createBookFormGroup(book: any) {<br/>return this.fb.group({<br/>type: [book.type],<br/>authors: this.fb.array(this.loadAuthors(book.authors)),<br/>});<br/>}</span></pre><p id="3605" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">createBookFormGroup() 返回一个包含2个FormControls的新FormGroup。每个FormGroup包含一个名为<strong class="kc io"> type </strong>的FormControl和一个名为<strong class="kc io"> authors </strong>的FormArray。</p><p id="67e4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">FormControl类型包含书的类型，而FormArray authors又是一个对象数组，其中每个对象包含作者的姓名和作者写的书。</p><p id="f393" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">格式数组<strong class="kc io"> authors </strong>由<strong class="kc io"> loadAuthors() </strong>填充，它将book对象的<strong class="kc io"> authors属性</strong>作为参数。</p><pre class="ky kz la lb gt lo lp lz bn ma mb bi"><span id="dca5" class="mc lu in lp b be md me l mf ly">loadAuthors(authorsList: any) {<br/>return authorsList.map((author: any) =&gt; this.createAuthorFormGroup(author));<br/>}</span></pre><p id="a5b5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们正在做和以前非常相似的事情。我们将每个author对象映射到一个新的FormGroup。映射是通过<strong class="kc io"> createAuthorFormGroup() </strong>完成的，它将author对象作为参数。映射的结果是一个FormGroups数组，它被返回给调用者以填充<strong class="kc io"> authors </strong> FormArray。</p><pre class="ky kz la lb gt lo lp lz bn ma mb bi"><span id="a60a" class="mc lu in lp b be md me l mf ly">createAuthorFormGroup(author: any) {<br/>return this.fb.group({<br/>name: [author.name],<br/>books: [author.books],<br/>select: [‘’],<br/>});<br/>}</span></pre><p id="6ff6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">上述方法返回的每个FormGroup包含3个form control:<strong class="kc io">name</strong>告诉我们作者的名字，而<strong class="kc io"> books </strong>是作者写的书的数组。</p><p id="f75f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">选择</strong>是单选按钮的表单控件。</p><p id="0dbc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我选中几个单选按钮并提交表单时，表单的值将更新如下。为作者选择的图书将在“选择属性”下可见。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/73cfea4f8adb4dac4e78c685d9b3d423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iYrPSTSte37zUBLyHwzoxg.png"/></div></div></figure><p id="3348" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">检查下面的整个工作:</p><div class="mh mi gp gr mj mk"><a href="https://stackblitz.com/edit/angular-mdqymw?file=src/app/app.component.html" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab fo"><div class="mm ab mn cl cj mo"><h2 class="bd io gy z fp mp fr fs mq fu fw im bi translated">角形(叉形)堆叠</h2><div class="mr l"><h3 class="bd b gy z fp mp fr fs mq fu fw dk translated">一个基于rxjs，tslib，core-js，zone.js，font-awesome，@angular/core，@angular/forms的angular-cli项目…</h3></div><div class="ms l"><p class="bd b dl z fp mp fr fs mq fu fw dk translated">stackblitz.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my jt mk"/></div></div></a></div><p id="2ce6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mz">更多内容请看</em><a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mz">plain English . io</em></strong></a></p></div></div>    
</body>
</html>