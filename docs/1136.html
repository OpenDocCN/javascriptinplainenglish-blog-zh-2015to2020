<html>
<head>
<title>How to Intercept the HTTP Requests in Angular (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中拦截HTTP请求(第2部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-intercept-the-http-requests-in-angular-part-2-a5aface03744?source=collection_archive---------7-----------------------#2020-02-02">https://javascript.plainenglish.io/how-to-intercept-the-http-requests-in-angular-part-2-a5aface03744?source=collection_archive---------7-----------------------#2020-02-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8a658e7726f7541f3644983ced47d4a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mi2TsC7qnEgOK4KJW51qEQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@seefromthesky?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ishan </a>on <a class="ae kc" href="https://unsplash.com/s/photos/roads?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="9b0f" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">内容</strong></h1><p id="aa77" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">本文由第一部分和第二部分两部分组成。</p><p id="11bb" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">第一部分— <a class="ae kc" href="https://medium.com/javascript-in-plain-english/how-to-intercept-the-http-requests-in-angular-2a67df423020" rel="noopener">简介，角拦截器的一些优点。</a></p><p id="cc54" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">第2部分——实现拦截器的实用说明。(这个)</p><h1 id="f496" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">简介</strong></h1><p id="d2ec" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">正如我在上一篇文章中解释的，在Angular中使用拦截器有很多好处。我们可以在一个应用程序中为不同的目的创建许多拦截器。在这里，我将解释如何为</p><p id="b049" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">改变发出的请求并附加报头</p><p id="ab4e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir">二。用虚假的后端数据回复请求</strong></p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><h1 id="e0d9" class="kd ke iq bd kf kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la bi translated">让我们开始吧</h1><p id="388c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="ld ir">第一步</strong></p><p id="131b" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">首先，我在src文件夹的app文件夹的Interceptors文件夹中创建一个名为“Interceptor-list.ts”的文件。</p><p id="ced1" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">(src &gt;&gt;&gt; app &gt;&gt;&gt;拦截器-列表&gt; &gt; &gt;拦截器-列表. ts)</p><p id="9eab" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这个文件将我们为不同目的创建的拦截器类的列表保存为一个数组。您可以随时轻松地将任何新创建的拦截器服务类添加到这个列表中。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="5078" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir">第二步</strong></p><p id="3223" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">转到app.module.ts文件，在providers数组中提供拦截器服务类的常量数组。</p><p id="5044" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">*我也导入了HttpClientModule来处理http请求。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="c5f4" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir">第三步</strong></p><p id="b4c6" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir"> 1 </strong>。创建用于更改请求的拦截器服务</p><p id="880b" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">让我们创建一个拦截器服务类来改变请求并向请求添加头。然后，我在浏览器中记录新旧请求，以便您可以区分两者。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="a173" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在这里的代码中，<em class="mw">返回next . handle(req)；</em>将请求传递给下一个拦截器进行处理，如果所有下一个拦截器都结束了，那么请求就被发送出去。</p><p id="aa48" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir"> 2。</strong>为模拟后端创建拦截器服务</p><p id="5bc1" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我创建了另一个拦截器服务类来响应url为200的请求:<a class="ae kc" href="https://udith.just.demo/get" rel="noopener ugc nofollow" target="_blank">https://udith.just.demo/get</a>。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="6786" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在此代码中，<em class="mw">返回(………..);可以根据需要用响应来回复请求。我已经匹配了网址，只回复了想要的网址。因此，您可以为不同的URL指定不同的响应。</em></p><p id="d421" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">**然后将这两个服务类添加到Interceptor-list.ts中的InterceptorProviders数组，如下所示。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="c1b6" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir">第四步</strong></p><p id="b495" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我在app.component.html创建了两个按钮来调用http请求。(您可以使用自己的组件)</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/ade836a41857eef4683b0154204fda12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*nHpBiKlTMuODAwwbMoWO8w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">browser view</figcaption></figure><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="743f" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir">这是我的App.component.ts </strong></p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="59c5" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">我们来看看结果</strong></h1><p id="5a2a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">当我点击按钮1时，</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/e2b4a0495add101a3caccb2d3c0c9f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OogyKIQSNIp1ReSwSH-dXA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">console of the browser</figcaption></figure><p id="90c1" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">当我点击按钮2时，</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/434b655a310bb5097f4825472e026a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UC3SrRzut-Y9M85D1PJgPA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">console of the browser</figcaption></figure><p id="a44e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated"><strong class="ld ir">就这样。</strong></p></div><div class="ab cl me mf hu mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ij ik il im in"><blockquote class="na nb nc"><p id="ee6f" class="lb lc mw ld b le lz lg lh li ma lk ll nd mb lo lp ne mc ls lt nf md lw lx ly ij bi translated">正如我在上一篇文章中提到的，充分利用拦截器取决于您的创造力和需求。</p></blockquote><p id="99dd" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">你可以从<a class="ae kc" href="https://github.com/Udith-Gayan/Angular-Interceptor-Demo-Project" rel="noopener ugc nofollow" target="_blank"> github这里</a>克隆这个项目。</p><p id="d004" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">谢谢你。</p></div></div>    
</body>
</html>