<html>
<head>
<title>Common Vue Problems — Imports, Array Updates, and Sharing Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">常见的Vue问题—导入、阵列更新和共享代码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/common-vue-problems-imports-array-updates-and-sharing-code-9f9bbcb9d1f8?source=collection_archive---------8-----------------------#2020-06-28">https://javascript.plainenglish.io/common-vue-problems-imports-array-updates-and-sharing-code-9f9bbcb9d1f8?source=collection_archive---------8-----------------------#2020-06-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/564a5e9e56fdf4c8d4216cb259439c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vt2e5kca6YZz6tSY"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mruqi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Muhammad Ruqiyaddin</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2683" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="7923" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">在模块外部导入模块</h1><p id="82df" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以将值为<code class="fe me mf mg mh b">module</code>的类型属性添加到脚本标签中，以表明该脚本是一个模块。</p><p id="164a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在里面导入其他模块。</p><p id="11a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，最好的方法是用Vue CLI创建一个项目。</p><p id="06d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以在任何地方导入模块。</p><p id="1b87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它将被编译成可以在现代浏览器上运行的代码。</p><h1 id="1fc7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更新页面上的数据而不刷新</h1><p id="83e9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了更新页面而不刷新，我们更新页面上的状态变量。</p><p id="8ffd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0a1a" class="mq lc iq mh b gy mr ms l mt mu">Vue.component('favorite', {<br/>  template: '&lt;button type="button" @click.prevent="updateFaviteOption" :class="{ 'is-favorited': isFavorited }"&gt;favorite&lt;/button&gt;',<br/>  props: [<br/>    'storeId',<br/>    'isFavorited'<br/>  ],<br/>  data() {<br/>    return {<br/>      isFavorited: false,<br/>      data: {}<br/>    }<br/>  },<br/>  methods: {<br/>    updateFavoriteOption() {<br/>      this.isFavorited = !this.isFavorited;<br/>      const res = await fetch('/some/url');<br/>      const data = await res.json();   <br/>      this.data = data;<br/>    }<br/>  }<br/>});</span></pre><p id="c558" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们只需添加状态变量作为在<code class="fe me mf mg mh b">data</code>中返回的对象的属性。</p><p id="2805" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以根据自己的意愿通过给它赋值来更新它。</p><h1 id="82c1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Vue和CORS请求</h1><p id="437e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了让CORS请求工作，我们必须将正确的标题添加到我们的后端应用程序。</p><p id="1b44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须添加<code class="fe me mf mg mh b">Access-Control-Allow-Origin</code>头，它可以设置为<code class="fe me mf mg mh b">*</code>或我们的网站。</p><p id="79b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们必须设置<code class="fe me mf mg mh b">Access-Control-Allow-Headers</code>标题。</p><p id="be85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将其设置为<code class="fe me mf mg mh b">X-Requested-With, Content-Type, Accept, Origin, Authorization</code>。</p><p id="20f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还必须设置<code class="fe me mf mg mh b">Access-Control-Allow-Methods</code>头，它被设置为我们允许CORS请求的方法。</p><p id="b686" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们必须添加<code class="fe me mf mg mh b">GET, POST, PUT, DELETE, OPTIONS</code>来让所有请求在不同于服务器应用程序的域中完成。</p><p id="0370" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">OPTIONS</code>需要预检请求，这让我们知道是否可以提出请求。</p><p id="97ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其余的动词发出实际的请求。</p><h1 id="63b7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更新数组不会更新页面</h1><p id="8348" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当我们更新一个数组时，页面可能不会被更新。</p><p id="d499" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们试图用新值更新现有的数组项，就会发生这种情况。</p><p id="02d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要更新现有的数组条目并更新页面，我们必须使用<code class="fe me mf mg mh b">this.$set</code>。</p><p id="5e0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="4103" class="mq lc iq mh b gy mr ms l mt mu">this.$set(this.arr, 0, 9);</span></pre><p id="1c60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在方法上。</p><p id="038b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个参数是数组。</p><p id="82c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个是要更新的项目的索引。</p><p id="00f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三个参数是用来更新它的参数。</p><h1 id="d83a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">_这个。$store未定义</h1><p id="f629" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们对一个方法使用箭头函数而不是常规函数，我们会得到<code class="fe me mf mg mh b">this.$store</code>未定义。</p><p id="bdc3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">箭头函数不会绑定到组件中<code class="fe me mf mg mh b">this</code>的组件。</p><p id="6092" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们应该对任何生命周期挂钩或方法使用常规函数。</p><h1 id="6457" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将Props组件传递给根实例</h1><p id="12c6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以调用<code class="fe me mf mg mh b">this.$emit</code>来发出一个事件并将数据传递给父组件。</p><p id="fb9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="011b" class="mq lc iq mh b gy mr ms l mt mu">this.$emit('update', this.name);</span></pre><p id="61f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在子组件的方法中。</p><p id="3c5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5cae" class="mq lc iq mh b gy mr ms l mt mu">&lt;child @update="changeName"&gt;&lt;/child&gt;</span></pre><p id="144c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在父组件的方法中。</p><p id="afe4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们调用将事件对象作为参数的<code class="fe me mf mg mh b">changeName</code>方法。</p><p id="54c2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在组件代码中，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0c76" class="mq lc iq mh b gy mr ms l mt mu">{<br/>  ...<br/>  <!-- -->methods: {<br/>    changeName(name) {<br/>      this.getname = name;<br/>    }<br/>  }<br/>  ...<br/>}</span></pre><p id="ac03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">name</code>具有传递给<code class="fe me mf mg mh b">$emit</code>的第二个参数的值。</p><h1 id="d003" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Vue中的角度服务当量</h1><p id="7e39" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在Vue中没有与Angular服务完全相同的实体。</p><p id="1571" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想添加一个无状态服务，那么我们可以添加一个mixin。</p><p id="09a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想添加一个有状态的服务，那么我们可以使用Vuex来共享数据。</p><p id="26d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以从模块中导出值并使用它们。</p><p id="9c93" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以使用JavaScript全局对象，这些对象由所有组件共享。</p><p id="2715" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以扩展<code class="fe me mf mg mh b">Vue.prototype</code>属性，将我们想要的添加到<code class="fe me mf mg mh b">Vue</code>实例中。</p><p id="68a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么这将在整个应用程序中可用。</p><p id="eb37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以添加一个mixin:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6bd6" class="mq lc iq mh b gy mr ms l mt mu">const myMixin = {<br/>  methods: {<br/>    hello() {<br/>      console.log('hello')<br/>    }<br/>  }<br/>}</span><span id="69ca" class="mq lc iq mh b gy mv ms l mt mu">const Component = Vue.extend({<br/>  mixins: [myMixin]<br/>})</span></pre><p id="6200" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过编写以下代码来添加全局mixin:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="58a6" class="mq lc iq mh b gy mr ms l mt mu">Vue.mixin({<br/>  methods: {<br/>    hello() {<br/>      console.log('hello')<br/>    }<br/>  }<br/>})</span></pre><p id="a69e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们就不必在组件中添加一个<code class="fe me mf mg mh b">mixins</code>属性。</p><p id="1e9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了给<code class="fe me mf mg mh b">Vue.prototype</code>添加一个属性，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="cdcc" class="mq lc iq mh b gy mr ms l mt mu">import axios from 'axios';<br/>Vue.prototype.$http = axios;</span></pre><p id="0476" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当我们创建组件或者一个<code class="fe me mf mg mh b">Vue</code>实例时，我们可以使用<code class="fe me mf mg mh b">this.$http</code>来引用它。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/df764dbd21b0b0bced8c241408b5046e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a-tB_8hQ0SFIzKfM"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@lordmaui?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chris Benson</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="bf12" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="d14e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果我们想使用模块，我们应该使用Vue CLI创建一个项目。</p><p id="04bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有很多方法可以用Vue重用代码。</p><p id="a1c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了让Vue在更新现有数组项目时更新页面，我们使用了<code class="fe me mf mg mh b">this.$set</code>。</p><h2 id="49c5" class="mq lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript</strong></h2><p id="0a9e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">你知道我们有四份出版物和一个YouTube频道吗？在<a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">plain English . io</strong></a>和<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">找到它们订阅我们的YouTube频道</strong> </a> <strong class="kf ir">！</strong></p></div></div>    
</body>
</html>