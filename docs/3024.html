<html>
<head>
<title>Generating Sitemap Entries For Nuxt Content</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Nuxt内容生成站点地图条目</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/generating-sitemap-entries-for-nuxt-content-f7eb7b5fdb3b?source=collection_archive---------1-----------------------#2020-08-20">https://javascript.plainenglish.io/generating-sitemap-entries-for-nuxt-content-f7eb7b5fdb3b?source=collection_archive---------1-----------------------#2020-08-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a259" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">为Nuxt站点生成站点地图时，不会自动包含内容模块中的文件。让我们看看如何解决这个问题！</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/d98b95f903f7c793366e1912685a4540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*gsb3-3aj8uFEYKAJ"/></div></figure><p id="0c97" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在启动我的新网站(<a class="ae lg" href="https://jackwhiting.co.uk" rel="noopener ugc nofollow" target="_blank">https://jackwhiting.co.uk</a>)时，我选择使用<a class="ae lg" href="https://content.nuxtjs.org/" rel="noopener ugc nofollow" target="_blank"> Nuxt Content </a>来管理我的博客帖子、作品和任何其他内容。在生成站点地图的时候，我注意到从<code class="fe lh li lj lk b">@nuxt/content</code>创建的任何内容都没有被添加到我的站点地图中，我需要修复这个问题。在这篇文章中，我们将看看如何解决这个问题，并让您的所有条目列出来。</p><h1 id="f577" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">设置</h1><p id="c426" class="pw-post-body-paragraph kk kl in km b kn md jo kp kq me jr ks kt mf kv kw kx mg kz la lb mh ld le lf ig bi translated">在我们做任何事情之前，我们需要确保我们已经安装了<code class="fe lh li lj lk b"><a class="ae lg" href="https://www.npmjs.com/package/@nuxtjs/sitemap" rel="noopener ugc nofollow" target="_blank">@nuxtjs/sitemap</a></code>模块。在终端中打开您的项目并运行以下代码。</p><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="0933" class="mm lm in lk b gy mn mo l mp mq">yarn add @nuxtjs/sitemap</span></pre><p id="0179" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">在你的<code class="fe lh li lj lk b">nuxt.config.js</code>中将网站地图添加到你的模块中。</p><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="b6b1" class="mm lm in lk b gy mn mo l mp mq">export default {<br/>  modules: ['@nuxt/content', '@nuxtjs/sitemap']<br/>}</span></pre><p id="58a5" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">这应该总是在你已经包括的任何其他模块之后，以确保所有的路由都被捕获。</p><p id="f999" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">接下来，为站点地图配置添加一些默认值——添加一个<code class="fe lh li lj lk b">hostname</code>并设置一个空函数，我们稍后将使用该函数来获取和返回我们内容的路径。</p><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="c890" class="mm lm in lk b gy mn mo l mp mq">export default {<br/>  sitemap: {<br/>    hostname: process.env.BASE_URL || 'YOURSITEURL',<br/>    routes: async () =&gt; {}<br/>  }<br/>}</span></pre><p id="6621" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">关于站点地图选项的完整列表，你可以查看<a class="ae lg" href="https://www.npmjs.com/package/@nuxtjs/sitemap" rel="noopener ugc nofollow" target="_blank">自述文件</a>。</p><h1 id="d3a3" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">添加您的路线</h1><p id="247d" class="pw-post-body-paragraph kk kl in km b kn md jo kp kq me jr ks kt mf kv kw kx mg kz la lb mh ld le lf ig bi translated">您设置内容结构的方式可能是独特的，您可能使用独特的URL，您可能有多个文件夹或只想包含一个文件夹。这些都可能改变你定义路线的方式，所以我在下面提供了几个例子，让你可以开始设置和运行。</p><h1 id="1ba0" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">从一个目录添加路由</h1><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="29c7" class="mm lm in lk b gy mn mo l mp mq">routes: async () =&gt; {<br/>  const { $content } = require('@nuxt/content')<br/><br/>  const posts = await $content('posts')<br/>    .only(['path'])<br/>    .fetch()<br/><br/>  return posts.map((p) =&gt; p.path)<br/>}</span></pre><h1 id="1294" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">从多个目录添加路由</h1><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="06fa" class="mm lm in lk b gy mn mo l mp mq">routes: async () =&gt; {<br/>  const { $content } = require('@nuxt/content')<br/><br/>  const posts = await $content('posts')<br/>    .only(['path'])<br/>    .fetch()<br/>  const works = await $content('works')<br/>    .only(['path'])<br/>    .fetch()<br/><br/>  <em class="mr">// Map and concatenate the routes and return the array.</em><br/>  return []<br/>    .concat(...works.map((w) =&gt; w.path))<br/>    .concat(...posts.map((p) =&gt; p.path))<br/>}</span></pre><h1 id="cf91" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">用更多信息扩展路线</h1><p id="5ab1" class="pw-post-body-paragraph kk kl in km b kn md jo kp kq me jr ks kt mf kv kw kx mg kz la lb mh ld le lf ig bi translated">有时你可能想在你的站点地图上添加<code class="fe lh li lj lk b">lastmod</code>、<code class="fe lh li lj lk b">priority</code>或其他细节——我们可以通过环绕它们并添加额外的属性来扩展我们包含的路线。</p><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="65b6" class="mm lm in lk b gy mn mo l mp mq">routes: async () =&gt; {<br/>  const { $content } = require('@nuxt/content')<br/><br/>  const posts = await $content('posts').fetch()<br/>  const works = await $content('works').fetch()<br/><br/>  <em class="mr">// Setup an empty array we will push to.</em><br/>  const routes = []<br/><br/>  <em class="mr">// Add an entry for the item including lastmod and priorty</em><br/>  works.forEach((w) =&gt;<br/>    routes.push({<br/>      url: w.path,<br/>      priority: 0.8,<br/>      lastmod: w.updatedAt<br/>    })<br/>  )<br/><br/>  posts.forEach((p) =&gt;<br/>    routes.push({<br/>      url: p.path,<br/>      priority: 0.8,<br/>      lastmod: p.updatedAt<br/>    })<br/>  )<br/><br/>  <em class="mr">// return all routes</em><br/>  return routes<br/>}</span></pre><h1 id="0992" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">测试一切</h1><p id="9a07" class="pw-post-body-paragraph kk kl in km b kn md jo kp kq me jr ks kt mf kv kw kx mg kz la lb mh ld le lf ig bi translated">将您的路线添加到<code class="fe lh li lj lk b">nuxt.config.js</code>文件后，您可以在终端中运行<code class="fe lh li lj lk b">yarn dev</code>。一旦开始编译，在浏览器中访问http://localhost:3000/sitemap . XML，您应该会看到列出的所有内容条目。</p><p id="638d" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">如果你不想每次运行<code class="fe lh li lj lk b">yarn dev</code>时都编译<code class="fe lh li lj lk b">sitemap.xml</code>，你可以将函数包装在一个条件中。</p><pre class="kd ke kf kg gt mi lk mj mk aw ml bi"><span id="66c9" class="mm lm in lk b gy mn mo l mp mq">routes: async () =&gt; {<br/>  if (process.env.NODE_ENV !== 'production') return<br/><br/>  <em class="mr">// rest of the function here</em><br/>}</span></pre><p id="0af2" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">希望这篇文章对你有帮助。如果您发现内容有任何问题，请随时在Twitter ( <a class="ae lg" href="https://twitter.com/jackabox" rel="noopener ugc nofollow" target="_blank"> @jackabox </a>)上联系我。</p></div><div class="ab cl ms mt hr mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ig ih ii ij ik"><p id="2ab2" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><em class="mr">原载于2020年8月20日</em><a class="ae lg" href="https://jackwhiting.co.uk/posts/generating-sitemap-entries-for-nuxt-content/" rel="noopener ugc nofollow" target="_blank"><em class="mr">【https://jackwhiting.co.uk】</em></a><em class="mr">。</em></p></div></div>    
</body>
</html>