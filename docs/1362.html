<html>
<head>
<title>Simple Pagination in Next.js using react-paginate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用react-paginate在Next.js中进行简单分页</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/simple-pagination-in-next-js-using-react-paginate-562830c00279?source=collection_archive---------0-----------------------#2020-03-07">https://javascript.plainenglish.io/simple-pagination-in-next-js-using-react-paginate-562830c00279?source=collection_archive---------0-----------------------#2020-03-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d9e0f6a280a1f4459e4aae3da87a0417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-VC8YS5g1c82cjBwxbw1Q.png"/></div></div></figure><p id="2189" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Next.js项目中分页的开发可能比较复杂。像CRA那样构建分页的常见方式在Next.js中不会是最好的选择，它不会是SEO友好的。</p><p id="57e7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我将向您展示如何在Next.js项目中构建一个SEO友好分页的帖子列表。对于分页UI，我将使用包react-paginate。我将从<a class="ae kt" href="https://gorest.co.in/" rel="noopener ugc nofollow" target="_blank">服务</a>的API中获取测试数据</p><p id="0fa6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">生成的项目如下所示:</p><figure class="kv kw kx ky gt jo gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/6b9e3dd56549f20b58187e83f09bfa20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*hQO3gminDgxaPgUN865Y5Q.gif"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Pagination Demo in Next.js Project</figcaption></figure><h1 id="b73c" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">后端API的先决条件</h1><p id="09af" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">要在Next.js中开发分页，您需要准备好后端API。您的后端API响应应该提供项目、当前页面和页面项目的总数。理想情况下，你还需要有一个总页数。</p><p id="1520" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">带有分页的后端API的响应示例。</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="0cdf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此外，您的后端需要支持获取某个页面的项目。例如<code class="fe mi mj mk ml b"><a class="ae kt" href="https://api.yourapp.com/posts?page=3" rel="noopener ugc nofollow" target="_blank">https://api.yourapp.com/posts?page=3</a></code></p><h1 id="d3dc" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">项目设置</h1><p id="e87d" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">在下面的例子中，我使用了一个使用create-next-app创建的next.js项目。我安装了获取API的包<code class="fe mi mj mk ml b">axios</code>和分页UI的包<code class="fe mi mj mk ml b">react-paginate</code>。</p><p id="cdc1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以使用以下命令安装这些软件包</p><pre class="kv kw kx ky gt mm ml mn mo aw mp bi"><span id="9f8f" class="mq le in ml b gy mr ms l mt mu">npm i axios react-paginate</span></pre><p id="e323" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">项目的所有代码都包含在<code class="fe mi mj mk ml b">pages/index.js</code>中</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="9875" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们仔细检查每一段代码。</p><h1 id="68a5" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">抓取帖子</h1><p id="16a3" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">我们从通过API获取帖子开始。我们在一个<code class="fe mi mj mk ml b">getIntialProps</code>钩子中获取它们，这个钩子在第一次运行和以后的导航中在服务器端触发。它在预呈现期间填充页面。在这个钩子中获取数据将使我们的页面SEO友好。</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h1 id="7fe2" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">呈现帖子和分页</h1><p id="dde6" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">根据加载状态，我们呈现文本<code class="fe mi mj mk ml b">Loading…</code>或帖子列表。</p><p id="9c2f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">下面我使用包<code class="fe mi mj mk ml b">react-paginate</code>中的组件ReactPaginate。我们可以通过props配置为分页元素设置什么类名。项目的样式在styles.scss中全局定义。</p><p id="0efe" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">页数和初始页面索引也是通过props设置的。<code class="fe mi mj mk ml b">onPageChange </code>接收一个分页处理函数，该函数在用户每次选择新页面时触发。</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h1 id="935d" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">页面选择处理程序</h1><p id="74eb" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">当用户选择一个页面时，<code class="fe mi mj mk ml b">pagginationHandler </code>函数以所选的页面索引作为参数触发。</p><p id="14f7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在<code class="fe mi mj mk ml b">getIntialProps</code>中获取数据。而<code class="fe mi mj mk ml b">getIntialProps </code> hook在页面更改期间触发，并读取查询参数<code class="fe mi mj mk ml b">page </code>以从后端API获取特定数据。</p><p id="7e5e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，我们需要用一个新的查询参数<code class="fe mi mj mk ml b">page </code>来改变路由，该参数将包含一个页面索引来触发posts获取和组件重新呈现。</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h1 id="086e" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">装载指示器</h1><p id="5cda" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">为了改善用户体验，我添加了一个加载指示器。</p><p id="bc90" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们的帖子获取发生在页面更改期间，我们需要依靠路由器事件来切换加载状态。我创建了状态和两个函数来切换它。</p><p id="1eb1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">然后在组件安装完成后，我设置了事件<code class="fe mi mj mk ml b">routeChangeStart </code>和<code class="fe mi mj mk ml b">routeChangeComplete</code>的处理程序。</p><p id="5e75" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当组件被卸载时，我从这些事件中移除处理程序以避免内存泄漏。</p><figure class="kv kw kx ky gt jo"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="994f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">就是这样。我希望这个例子能帮助您理解如何在Next.js项目中构建分页。</p><h1 id="d08c" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">项目代码</h1><p id="2d82" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated"><a class="ae kt" href="https://github.com/VladymyrPylypchatin/nextjs-pagination" rel="noopener ugc nofollow" target="_blank">https://github.com/VladymyrPylypchatin/nextjs-pagination</a></p></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><p id="fe88" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">感谢阅读！:)</strong></p><p id="e1b1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我是自由软件工程师和网页开发者Vova Pilipchatin。</p><p id="d8f9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你喜欢这篇文章，请关注我的 <a class="ae kt" href="https://twitter.com/VPilipchatin" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">推特</strong> </a> <strong class="jx io">。</strong></p><p id="c2ae" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">你还可以在我的博客上找到更多帖子，分享我对</strong> <a class="ae kt" href="https://vpilip.com/blog/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">网络应用开发和启动SaaS项目</strong> </a>的了解</p><h2 id="6c2a" class="mq le in bd lf nc nd dn lj ne nf dp ln kg ng nh lr kk ni nj lv ko nk nl lz nm bi translated">用简单英语写的JavaScript的注释</h2><p id="e808" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的中级用户名发邮件到<a class="ae kt" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank"><strong class="jx io">submissions@javascriptinplainenglish.com</strong></a>给我们，我们会把你添加为作者。</p><p id="9cbf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还推出了三种新的出版物！请关注我们的新出版物，表达对它们的爱:<a class="ae kt" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="jx io">AI in Plain English</strong></a>，<a class="ae kt" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="jx io">UX in Plain English</strong></a>，<a class="ae kt" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="jx io">Python in Plain English</strong></a><strong class="jx io"/>—谢谢，继续学习！</p></div></div>    
</body>
</html>