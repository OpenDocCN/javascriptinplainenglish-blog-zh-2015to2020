<html>
<head>
<title>JavaScript Mistakes — Useless Code and Invalid Regex</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript错误—无用的代码和无效的正则表达式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-mistakes-useless-code-and-invalid-regex-8f3e48718105?source=collection_archive---------7-----------------------#2020-04-23">https://javascript.plainenglish.io/javascript-mistakes-useless-code-and-invalid-regex-8f3e48718105?source=collection_archive---------7-----------------------#2020-04-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7c4fdc502199b8093b3aa7c9efd83a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zJx6Ifj8PjTQSyGn"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@chuanxu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chuan Xu</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5dfa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript是一种非常宽容的语言。编写可以运行但有错误的代码很容易。</p><p id="cab4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将看看一些无用的代码，我们不需要把它们放到我们的JavaScript代码中。</p><h1 id="b23a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">没有多余的括号</h1><p id="f29b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">除非我们想把优先级较低的东西组合在一起，否则我们不需要像算术表达式那样用括号括起来。</p><p id="8a95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们在表达式中不需要括号，比如:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7c76" class="mn lc iq mj b gy mo mp l mq mr">(a * b);</span></pre><p id="5a92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1ae4" class="mn lc iq mj b gy mo mp l mq mr">(a * b) + c;</span></pre><p id="136a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不需要在循环变量周围加上括号:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="74e4" class="mn lc iq mj b gy mo mp l mq mr">for (let a of (b)){<br/> //,,,<br/>}</span></pre><p id="d758" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以去掉循环中<code class="fe ms mt mu mj b">b</code>两边的括号。</p><p id="4001" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一些运算符表达式也不需要括号，如:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="65c0" class="mn lc iq mj b gy mo mp l mq mr">typeof (foo);</span></pre><p id="b85b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不需要用圆括号将<code class="fe ms mt mu mj b">foo</code>括起来。</p><p id="3f53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是另一个有额外括号的例子:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="cd49" class="mn lc iq mj b gy mo mp l mq mr">(function(){} ? foo() : bar());</span></pre><p id="2c0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以删除行首和行尾的括号。</p><p id="bda1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们选择在一个条件中进行赋值，那么我们应该用括号把它们括起来，这样可以清楚地表明我们在给哪个变量赋值:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="14f4" class="mn lc iq mj b gy mo mp l mq mr">while ((foo = bar())) {}</span></pre><p id="622b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例外是一个普通的<code class="fe ms mt mu mj b">for</code>循环，我们写它时没有括号:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4014" class="mn lc iq mj b gy mo mp l mq mr">for (let i = 0; i &lt; 10; i++) {<br/>  //...<br/>}</span></pre><p id="043f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像循环中的赋值一样，为了清楚起见，我们也应该在<code class="fe ms mt mu mj b">return</code>语句中的赋值表达式两边加上括号:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fe11" class="mn lc iq mj b gy mo mp l mq mr">const foo =(b) =&gt; {<br/>  return (b = 1);<br/>}</span></pre><h1 id="86c6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">删除多余的分号</h1><p id="1e0e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">JavaScript允许我们在一行的末尾放置尽可能多的分号。它的作用和单个分号一样，所以多余的分号没有用。</p><p id="0081" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也不需要在函数声明后使用分号。</p><p id="0c98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，在下面一行中我们不应该有多个分号:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f7ef" class="mn lc iq mj b gy mo mp l mq mr">let x = 1;;;</span></pre><p id="4cb7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相反，我们应该写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5a27" class="mn lc iq mj b gy mo mp l mq mr">let x = 1;</span></pre><p id="226a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的代码是函数声明的一个示例:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5f6e" class="mn lc iq mj b gy mo mp l mq mr">function foo() {</span><span id="4f76" class="mn lc iq mj b gy mv mp l mq mr">};</span></pre><p id="d509" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们不需要额外的分号。相反，我们应该写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ce4b" class="mn lc iq mj b gy mo mp l mq mr">function foo() {</span><span id="8fa4" class="mn lc iq mj b gy mv mp l mq mr">}</span></pre><h1 id="8f02" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将函数声明重新分配给不同的值</h1><p id="7d89" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">因为JavaScript函数只是常规变量，所以它们也可以被重新分配给任何东西。</p><p id="9df1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这通常是一个错误的迹象，因为我们可能想调用这个函数，而不是把它赋给别的函数。</p><p id="20ac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们不想写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="035d" class="mn lc iq mj b gy mo mp l mq mr">function fn() {}<br/>fn = foo;</span></pre><p id="306b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相反，我们应该显式地创建一个变量，并为该变量分配一个函数，以表明它实际上是一个我们希望重新赋值的变量:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="810c" class="mn lc iq mj b gy mo mp l mq mr">const fn = <!-- -->function() {}<br/>fn = foo;</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/ebb485502284276c296a0ed2e25fc60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M6n67KzjDck2BoUi"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@bhris1017?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christopher Carson</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8de7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">将从模块导入的成员赋给另一个值</h1><p id="5ac8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">因为JavaScript模块的导入成员是只读的，所以我们不能给它们赋值。因此，我们应该有这样的代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1e4b" class="mn lc iq mj b gy mo mp l mq mr">import { x, y } from "./foo";<br/>x = 1;</span></pre><p id="5176" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们会得到一个错误，即<code class="fe ms mt mu mj b">x</code>是只读的。</p><p id="e10d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也适用于默认导出的导入。</p><p id="d084" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8cf5" class="mn lc iq mj b gy mo mp l mq mr">import x from "./foo";<br/>x = 1;</span></pre><p id="6c50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也给出同样的错误。</p><p id="f701" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面没有给出一些构建工具的错误:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7960" class="mn lc iq mj b gy mo mp l mq mr">import * as foo from "./foo";<br/>foo.x = 1;</span></pre><h1 id="055a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">嵌套块中的函数声明</h1><p id="bac5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在ES6之前，嵌套块中的函数声明应该在程序的顶层或另一个函数的主体中。</p><p id="f825" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，一些JavaScript解释器允许将函数声明添加到嵌套块中。</p><p id="c964" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3134" class="mn lc iq mj b gy mo mp l mq mr">function foo() {<br/>  if (true) {<br/>    function bar() {}<br/>  }<br/>};</span></pre><p id="6fe1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不应该是有效的JavaScript，因为我们在<code class="fe ms mt mu mj b">foo</code>函数的<code class="fe ms mt mu mj b">if</code>块中声明了<code class="fe ms mt mu mj b">bar</code>函数。</p><p id="7cca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使我们的代码语法正确，我们应该从<code class="fe ms mt mu mj b">if</code>块中删除<code class="fe ms mt mu mj b">bar</code>函数声明。如果我们想在代码块中定义一个函数，我们也可以在代码块中使用函数表达式。</p><h1 id="af44" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">RegExp构造函数中的正则表达式无效</h1><p id="57a9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不希望在<code class="fe ms mt mu mj b">RegExp</code>构造函数中出现无效的正则表达式。构造函数接受任何字符串，并尝试从中返回正则表达式对象。</p><p id="b7b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无效的正则表达式定义包括如下内容:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e36a" class="mn lc iq mj b gy mo mp l mq mr">RegExp(']')<br/>RegExp('-', 'z')</span></pre><p id="cf6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该确保传入一个有效的正则表达式字符串或者使用正则表达式文字。</p><h1 id="6fdd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="fd7b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">JavaScript解释器允许很多事情，但是它们要么没用，要么会导致错误。例如，应该删除无用的括号和分号。函数声明也不应该被重新赋值给新值。</p><p id="32f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">块中也不允许函数声明，即使JavaScript解释器仍然可以运行它。</p><p id="fe5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，无效的regex字符串不应该传递给<code class="fe ms mt mu mj b">RegExp</code>构造函数。</p><h2 id="4e7d" class="mn lc iq bd ld mx my dn lh mz na dp ll ko nb nc lp ks nd ne lt kw nf ng lx nh bi translated"><strong class="ak">用简单英语写的JavaScript笔记</strong></h2><p id="b880" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们已经推出了三种新的出版物！请关注我们的新出版物:<a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a>，<a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a>，<a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>——谢谢，继续学习！</p><p id="2672" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，并附上您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>