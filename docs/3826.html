<html>
<head>
<title>Create Nested Navigators in React Navigation 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Navigation 5中创建嵌套导航器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-nested-navigators-in-react-navigation-5-3b294a71fe29?source=collection_archive---------4-----------------------#2020-10-27">https://javascript.plainenglish.io/create-nested-navigators-in-react-navigation-5-3b294a71fe29?source=collection_archive---------4-----------------------#2020-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b6c3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">集成标签栏和可扩展的堆栈导航</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4e0abe462ead8510ec9d6fb92bce3c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJERCBVVRbF66w0wrgSc1g.jpeg"/></div></div></figure><h2 id="7721" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">入门指南</h2><p id="0969" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">我参与过两个有导航问题的项目。这些问题使得设计规格难以匹配。设计要求某些视图覆盖整个屏幕，包括底部标签栏。堆栈导航器嵌套在选项卡导航器中。以这种方式嵌套堆栈导航器并不能让您隐藏选项卡栏，因为每个导航器都有自己的导航历史。</p><p id="a8ee" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">让我们看看如何在不牺牲功能的情况下实现嵌套导航器。</p><h2 id="c888" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">安装React本机和依赖项</h2><p id="50ea" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">创建一个新的React本地项目。我在下面的官方<a class="ae ml" href="https://reactnavigation.org/docs/getting-started" rel="noopener ugc nofollow" target="_blank">入门</a>文档中列出了这些步骤:</p><p id="c096" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><code class="fe mm mn mo mp b">npx react-native init nested-stack-navigation</code></p><p id="a53f" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">项目创建后，我安装了所有与React Navigation 5相关的依赖项。</p><p id="84c4" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><code class="fe mm mn mo mp b">npm install @react-navigation/native</code></p><p id="7fa3" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><code class="fe mm mn mo mp b">npm install @react-navigation/bottom-tabs</code></p><p id="a395" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><code class="fe mm mn mo mp b">npm install @react-navigation/stack</code></p><p id="dc24" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">在我们开始之前，确保项目可以运行:</p><p id="8953" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><code class="fe mm mn mo mp b">react-native run-ios</code></p><p id="903d" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">您可能会得到以下错误消息:<em class="mq"> null不是一个对象(计算' RNGestureHandlerModule。方向’)</em></p><p id="d7fb" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">如果是这样，下面的解决方案解决了它:</p><ol class=""><li id="4130" class="mr ms iq lp b lq mg lt mh la mt le mu li mv mf mw mx my mz bi translated">将目录切换到<code class="fe mm mn mo mp b">ios</code>文件夹；</li><li id="3da2" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf mw mx my mz bi translated">运行<code class="fe mm mn mo mp b">pod install</code>，这将安装必要的软件包来消除错误。</li></ol><p id="0de7" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><em class="mq">包react-native-gesture-handler</em>没有正确安装，因此需要手动安装。我在GitHub上找到了同样问题的另一个解决方案，以防<code class="fe mm mn mo mp b">pod install</code>不够用。</p><h2 id="cf22" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">嵌套导航器的目的</h2><p id="4b26" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">嵌套导航器在React本机应用程序中结合了多种导航类型。您可以将堆栈导航器嵌套在一个抽屉中，并允许在该抽屉中显示其他屏幕。另一个例子是使用选项卡导航器显示应用程序主屏幕，然后使用堆栈导航器显示与每个选项卡相关的更多屏幕。</p><h2 id="1a1c" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">嵌套多个堆栈导航器</h2><p id="b972" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">“嵌套导航器意味着在另一个导航器的屏幕内呈现一个导航器”(<a class="ae ml" href="https://reactnavigation.org/docs/nesting-navigators/" rel="noopener ugc nofollow" target="_blank"> React导航文档</a>)</p><p id="ddca" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">我工作过的一个项目将选项卡导航器作为最上面的导航器，如下所示:</p><ul class=""><li id="ad90" class="mr ms iq lp b lq mg lt mh la mt le mu li mv mf nf mx my mz bi translated">标签。航海家</li><li id="bad7" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">首页(堆栈。导航员)</li><li id="2a62" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">设置(屏幕)</li><li id="b418" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">配置文件(堆栈。导航员)</li></ul><p id="de6f" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">主页、配置文件和设置屏幕是选项卡栏的一部分；每个都有自己的堆栈导航器。这使得每个标签都有自己的导航堆栈，可以在其中推送更多屏幕。这最终有一个缺陷，就是没有办法隐藏底部的标签栏。</p><p id="5db8" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">当您希望屏幕覆盖所有元素(包括标签栏)时，上面的导航结构不起作用。反应导航文档说明每个导航器都有自己的私有选项参数。</p><p id="3026" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">当在子导航器中设置时，选项卡导航器不会接收到<code class="fe mm mn mo mp b">tabBarVisible</code>参数。</p><p id="bd9f" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">为了解决这个问题，嵌套导航必须改变。</p><ul class=""><li id="94d2" class="mr ms iq lp b lq mg lt mh la mt le mu li mv mf nf mx my mz bi translated">堆栈。航海家</li><li id="c5bf" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">主页(选项卡。导航器)</li><li id="0c31" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">配置文件(屏幕)</li><li id="f034" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">设置(屏幕)</li></ul><p id="fc55" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">它可能看起来不太有条理，但是堆栈导航器需要是根导航器，以实现期望的全屏效果。</p><p id="4e03" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">"把嵌套导航器看作是实现你想要的用户界面的一种方式，而不是组织你的代码的一种方式。"(<a class="ae ml" href="https://reactnavigation.org/docs/nesting-navigators" rel="noopener ugc nofollow" target="_blank">反应导航文档</a>)</p><h2 id="622a" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">嵌套导航器会影响行为</h2><p id="f751" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">在嵌套导航器时，有一些事情需要记住。嵌套的导航器不会接收父事件，每个导航器都有自己的选项集，每个导航器都有自己的历史。</p><p id="4f44" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">导航器有它们自己的私有选项参数，这就是为什么在子级中设置<code class="fe mm mn mo mp b">tabBarVisible</code>时，堆栈导航器将不起作用。</p><h2 id="9f22" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">创建基本屏幕组件</h2><p id="5b33" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">开始时，为每个屏幕创建基本组件。</p><pre class="kg kh ki kj gt ng mp nh ni aw nj bi"><span id="1170" class="kr ks iq mp b gy nk nl l nm nn">import * as React from 'react';<br/>import {Text, View} from 'react-native';<br/><br/>function HomeScreen({navigation}) {<br/>  return (<br/>    &lt;View style={{flex: 1, justifyContent: 'center', alignItems: 'center'}}&gt;<br/>      &lt;Text onPress={() =&gt; navigation.push('Profile')}&gt;Go to Profile&lt;/Text&gt;<br/>    &lt;/View&gt;<br/>  );<br/>}<br/><br/>function ProfileScreen({navigation}) {<br/>  return (<br/>    &lt;View style={{flex: 1, justifyContent: 'center', alignItems: 'center'}}&gt;<br/>      &lt;Text<br/>        onPress={() =&gt; {<br/>          navigation.goBack();<br/>        }}&gt;<br/>        Go Back<br/>      &lt;/Text&gt;<br/>    &lt;/View&gt;<br/>  );<br/>}<br/><br/>function SettingsScreen({navigation}) {<br/>  return (<br/>    &lt;View style={{flex: 1, justifyContent: 'center', alignItems: 'center'}}&gt;<br/>      &lt;Text onPress={() =&gt; navigation.navigate('Profile')}&gt;Settings&lt;/Text&gt;<br/>    &lt;/View&gt;<br/>  );<br/>}</span></pre><h2 id="fe59" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">主堆栈屏幕</h2><p id="e10d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">下一步是创建主堆栈。主堆栈应具有以下内容:</p><ul class=""><li id="b0e2" class="mr ms iq lp b lq mg lt mh la mt le mu li mv mf nf mx my mz bi translated">选项卡导航器</li><li id="1148" class="mr ms iq lp b lq na lt nb la nc le nd li ne mf nf mx my mz bi translated">将成为选项卡栏一部分的所有屏幕</li></ul><pre class="kg kh ki kj gt ng mp nh ni aw nj bi"><span id="94e7" class="kr ks iq mp b gy nk nl l nm nn">import {createBottomTabNavigator} from '@react-navigation/bottom-tabs';<br/><br/>const HomeTab = createBottomTabNavigator();<br/>function HomeTabs({navigation, route}) {<br/>  return (<br/>    &lt;HomeTab.Navigator&gt;<br/>      &lt;HomeTab.Screen name="Home" component={HomeStackScreen} /&gt;<br/>      &lt;HomeTab.Screen name="Settings" component={SettingsScreen} /&gt;<br/>    &lt;/HomeTab.Navigator&gt;<br/>  );<br/>}</span></pre><h2 id="2722" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">创建堆栈导航器</h2><p id="795f" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">堆栈是导航容器中的根导航器。主堆栈组件位于选项卡栏组件所在的位置。配置文件屏幕位于选项卡导航器之外，因此它可以完全覆盖整个屏幕。</p><pre class="kg kh ki kj gt ng mp nh ni aw nj bi"><span id="9e9b" class="kr ks iq mp b gy nk nl l nm nn">import {<br/>  NavigationContainer,<br/>  getFocusedRouteNameFromRoute,<br/>} from '@react-navigation/native';<br/><br/>const RootStack = createStackNavigator();<br/>export default function App() {<br/>  return (<br/>    &lt;NavigationContainer&gt;<br/>      &lt;RootStack.Navigator&gt;<br/>        &lt;RootStack.Screen<br/>          name="Home"<br/>          component={HomeTabs}<br/>          options={({route}) =&gt; ({<br/>            headerTitle: getHeaderTitle(route),<br/>          })}<br/>        /&gt;<br/>        &lt;HomeStack.Screen<br/>          name="Profile"<br/>          component={ProfileScreen}<br/>          options={() =&gt; ({headerTitle: 'My settings'})}<br/>        /&gt;<br/>      &lt;/RootStack.Navigator&gt;<br/>    &lt;/NavigationContainer&gt;<br/>  );<br/>}</span></pre><h2 id="afeb" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论</h2><p id="8278" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">这是创建嵌套导航器的基础。嵌套导航器时，建议最多只嵌套2个堆栈导航器。只有在绝对必要的情况下，才能超出这个范围。请记住，嵌套导航器是实现您想要的用户界面的一种方式。</p></div></div>    
</body>
</html>