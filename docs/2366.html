<html>
<head>
<title>Add TypeScript support to an existing codebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向现有代码库添加TypeScript支持</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/add-typescript-support-to-an-existing-codebase-9e9402e53f75?source=collection_archive---------4-----------------------#2020-06-17">https://javascript.plainenglish.io/add-typescript-support-to-an-existing-codebase-9e9402e53f75?source=collection_archive---------4-----------------------#2020-06-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/966e5dc9df7325f084fb16e112d05889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QXD26zQaQKvGXyvN.jpg"/></div></div></figure><p id="7136" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最近，我不得不将一个客户的代码库从普通的JavaScript转移到TypeScript。创建类型之前的第一步是添加对TypeScript的支持。我想写下一些如何做到这一点的笔记，以防在不久的将来我不得不再次这样做。这是:</p><p id="1de7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">步骤</strong>:</p><ol class=""><li id="d64a" class="kt ku in jx b jy jz kc kd kg kv kk kw ko kx ks ky kz la lb bi translated">安装typescript npm包和节点类型定义。只需运行<code class="fe lc ld le lf b">npm i --save-dev typescript @types/node</code></li><li id="5a3f" class="kt ku in jx b jy lg kc lh kg li kk lj ko lk ks ky kz la lb bi translated">在您的目录路径下创建一个名为tsconfig.json的文件，在其中粘贴以下内容:</li></ol><pre class="ll lm ln lo gt lp lf lq lr aw ls bi"><span id="2a0e" class="lt lu in lf b gy lv lw l lx ly">{<br/>    "compilerOptions": {<br/>        "module": "commonjs",<br/>        "esModuleInterop": true,<br/>        "target": "es6",<br/>        "noImplicitAny": true,<br/>        "moduleResolution": "node",<br/>        "sourceMap": true,<br/>        "outDir": "dist",<br/>        "baseUrl": ".",<br/>        "paths": {<br/>            "*": ["node_modules/*", "@types/*", "src/types/*"]<br/>        }<br/>    },<br/>    "include": ["src/**/*"],<br/>    "lib": ["es2016", "dom"]<br/>}</span></pre><p id="1f71" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">tsconfig.json文件的完整文档可在<a class="ae lz" href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="cf9d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">3.在package.json中将tsc添加到npm脚本中，如下所示:</p><pre class="ll lm ln lo gt lp lf lq lr aw ls bi"><span id="4642" class="lt lu in lf b gy lv lw l lx ly"> …<br/><em class="ma">scripts: {<br/> … <br/> “tsc”: “tsc”;<br/>},<br/>…</em></span></pre><p id="15a9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">4.将“dist”文件夹添加到。既然你不想你所有的文件都被复制，你就不应该把编译好的。在dist目录中生成的js文件</p><p id="6233" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">5.可选:将文件转换为。ts扩展和添加类型<br/>您可以通过逐个文件地转换来实现，并且每次都检查错误。或者，您可以全部转换。js文件到。在linux上使用此命令的ts文件:</p><pre class="ll lm ln lo gt lp lf lq lr aw ls bi"><span id="d55f" class="lt lu in lf b gy lv lw l lx ly"> find . -name ‘*.js’ -exec sh -c ‘mv “$0” “${0%.js}.ts”’ {} \;</span></pre><p id="75b2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">6.您可能需要将json文件复制到新的dist目录中。我所做的是向我的package.json添加一个构建脚本，它做两件事:编译。ts文件，然后复制。json文件复制到dist目录。然后我从dist文件夹启动节点应用程序。它看起来或多或少像这样:</p><pre class="ll lm ln lo gt lp lf lq lr aw ls bi"><span id="451d" class="lt lu in lf b gy lv lw l lx ly">…<br/><em class="ma">scripts: {<br/> …<br/> “build”: “npm run tsc &amp;&amp; npm run cp-json”;<br/> “cp-json”: “cp src/*.json* dist/”;<br/> “start”: “nodemon dist/index.js”;<br/></em> <em class="ma">“tsc”: “tsc”;<br/>},<br/>…</em></span></pre><p id="476a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">恭喜，你现在可以写打字稿了，用<code class="fe lc ld le lf b">npm run build</code>构建项目，然后用<code class="fe lc ld le lf b">npm start</code>启动它。你未来的自己可能会感谢你。</p><p id="2baf" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">结论:<br/> </strong>这只是一个将现有代码库转换为typescript的非常简单的指南，它在任何情况下都不是一个全面的指南，所以不要这样对待它。完全转换为TypeScript取决于现有代码库的复杂程度。祝你好运，编码快乐！</p></div></div>    
</body>
</html>