<html>
<head>
<title>Using HTML5 Data Attributes with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过JavaScript使用HTML5数据属性</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-html5-data-attributes-with-javascript-f353696b9d0e?source=collection_archive---------5-----------------------#2020-08-19">https://javascript.plainenglish.io/using-html5-data-attributes-with-javascript-f353696b9d0e?source=collection_archive---------5-----------------------#2020-08-19</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/c16ad6f6778be95a4c5e37b436e6a46a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z2XxWfCG-Ky-AyzjlsKg3g.jpeg"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk">Image: <a class="ae kd" href="https://pixabay.com/photos/earth-internet-globalisation-2254769/" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="1f29" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">HTML5让我们能够向元素添加任意的信息片段(称为数据属性),以便在后台用于任何目的，这里我将演示如何在JavaScript中使用它们。</p><p id="dc75" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">我在我的<a class="ae kd" href="https://medium.com/javascript-in-plain-english/interactive-periodic-table-in-javascript-d7cf7177883a" rel="noopener">交互周期表</a>中很好地利用了数据属性。关于这个主题有大量的信息，但通常是简单的或人为的例子，所以在这里我将介绍一个周期表的简化版本的实际应用。</p><p id="9d65" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">您可以将自定义数据属性添加到元素中，方法是将它硬编码到HTML中，在名称前加上前缀<code class="fe lc ld le lf b">data-</code>，例如:</p><p id="058f" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated"><code class="fe lc ld le lf b">&lt;div id=”div1" data-manufacturer=”nikon” data-model=”d6"&gt;Nikon D6&lt;/div&gt;</code></p><p id="2428" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">在JavaScript中，您可以使用元素的<code class="fe lc ld le lf b">dataset</code>属性来读写元素的数据属性，该属性属于<code class="fe lc ld le lf b">DOMStringMap</code>类型，基本上是键/值对的集合。关键字是用于属性的名称，但是没有<code class="fe lc ld le lf b">data-</code>前缀，所以对于上面的例子，我们将使用<code class="fe lc ld le lf b">manufacturer</code>和<code class="fe lc ld le lf b">model</code>，如下所示。</p><pre class="lg lh li lj gu lk lf ll lm aw ln bi"><span id="f7aa" class="lo lp ir lf b gz lq lr l ls lt">const element = document.getElementById(“div1”);</span><span id="cb92" class="lo lp ir lf b gz lu lr l ls lt">console.log(element.dataset.manufacturer); // nikon<br/>console.log(element.dataset.model); // d6</span><span id="0301" class="lo lp ir lf b gz lu lr l ls lt">element.dataset.manufacturer = “canon”;<br/>element.dataset.model = “EOS 90D”;</span></pre><p id="e6d2" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">使用<code class="fe lc ld le lf b">querySelector</code>也很容易找到具有特定数据属性值的元素，例如:</p><p id="4eb8" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated"><code class="fe lc ld le lf b">const element = document.querySelector(“[data-manufacturer=’nikon’][data-model=’d6']”);</code></p><p id="9cc0" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">下面是这个例子中使用的简化周期表的截图。</p><figure class="lg lh li lj gu js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj lv"><img src="../Images/5bdae3b104ef5676cc84aab869bdc893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wX9Wfhq7pN1Et5i3oAymBg.png"/></div></div></figure><p id="3321" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">如果你点击一个元素，一个警告会显示该元素的名称、原子序数和化学符号。您可能已经猜到了我们如何知道显示哪个元素的细节:使用它的数据属性。</p><ul class=""><li id="2e84" class="lw lx ir kg b kh ki kl km kp ly kt lz kx ma lb mb mc md me bi translated">在这篇文章中，我将不得不经常使用“元素”这个词。这很烦人，但是我会试着指出我指的是HTML元素还是一种原子，除非很明显。</li></ul><h2 id="9f6b" class="lo lp ir bd mg mh mi dn mj mk ml dp mm kp mn mo mp kt mq mr ms kx mt mu mv mw bi translated">该项目</h2><p id="2de8" class="pw-post-body-paragraph ke kf ir kg b kh mx kj kk kl my kn ko kp mz kr ks kt na kv kw kx nb kz la lb ik bi translated">这个项目由一个HTML文件、一个JavaScript文件和几个子文件组成，所有这些文件都在<a class="ae kd" href="https://github.com/CodeDrome/using-html5-data-attributes-with-javascript" rel="noopener ugc nofollow" target="_blank"> Github库</a>中。</p><p id="b26a" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">我不会展示所有的源代码，只展示与数据属性相关的部分。我在这个项目中使用过几次，但为了避免重复，我将只展示我们执行以下任务的地方:</p><ul class=""><li id="0fe7" class="lw lx ir kg b kh ki kl km kp ly kt lz kx ma lb mb mc md me bi translated">在相应的(HTML)元素上设置(化学)元素的<code class="fe lc ld le lf b">data-atomicnumber</code></li><li id="87b8" class="lw lx ir kg b kh nc kl nd kp ne kt nf kx ng lb mb mc md me bi translated">通过(化学)元素的原子序数查找(HTML)元素来设置背景色</li><li id="8fa3" class="lw lx ir kg b kh nc kl nd kp ne kt nf kx ng lb mb mc md me bi translated">从点击的(HTML)元素中检索<code class="fe lc ld le lf b">data-atomicnumber</code>以显示(化学)元素的细节</li></ul><p id="eb49" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">为了填充该表，我们迭代一个元素列表，将每个元素添加到具有相应的<code class="fe lc ld le lf b">data-atomicnumber </code>属性的表中。</p><p id="f59a" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated"><code class="fe lc ld le lf b">currentcell.setAttribute(‘data-atomicnumber’, element.atomicnumber);</code></p><p id="3eb4" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">这里我用了<code class="fe lc ld le lf b">setAttribute</code>而不是<code class="fe lc ld le lf b">dataset.atomicnumber</code>,只是为了说明另一种选择。</p><p id="03e7" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">填充完表格后，我们需要设置颜色来表示元素的类别。我们再次迭代数据，找到对应于每个元素的单元格，如下所示:</p><p id="d996" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated"><code class="fe lc ld le lf b">const currentcell = document.querySelector(`[data-atomicnumber=’${element.atomicnumber}’]`);</code></p><p id="2fde" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">如上面尼康D6的例子所示，如果有必要，你可以使用多个选择器。在这个项目中，我们知道数据是静态的，所以我们总是会找到一个单元格，但如果不是这样，请记住检查null的返回值<code class="fe lc ld le lf b">querySelector</code>。此外，如果有多个匹配元素，您可能需要使用<code class="fe lc ld le lf b">querySelectorAll</code>。</p><p id="6611" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">最后，当一个元素被点击时，我们需要选择<code class="fe lc ld le lf b">data-atomicnumber</code>属性值。</p><p id="b9f2" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated"><code class="fe lc ld le lf b">const element = this._periodictable.GetElement(target.dataset.atomicnumber);</code></p><p id="03a5" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">这里实际发生的是，我们调用代表所有化学元素的类的实例的<code class="fe lc ld le lf b">GetElement</code>方法，选择目标的<code class="fe lc ld le lf b">dataset.atomicnumber</code>(即被点击的HTML元素)作为方法参数。</p><p id="61f6" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">因此，正如你所看到的，使用数据属性极大地简化了当我们需要对HTML元素做一些事情(比如设置它的颜色)时查找它的过程，也简化了当用户与它交互(比如点击它)时识别它的过程。</p><p id="fabd" class="pw-post-body-paragraph ke kf ir kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ik bi translated">当我开始研究元素周期表的时候，很快我就明白了数据属性才是我要走的路。毫无疑问，还有其他方法来完成同样的事情，但我不知道是什么，因为我从来没有想过这件事！</p></div></div>    
</body>
</html>