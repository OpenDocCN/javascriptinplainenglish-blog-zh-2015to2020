<html>
<head>
<title>How I built a browser extension with Vue (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用Vue构建浏览器扩展(第1部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/i-built-a-browser-extension-with-vue-76779d0a6238?source=collection_archive---------1-----------------------#2018-08-05">https://javascript.plainenglish.io/i-built-a-browser-extension-with-vue-76779d0a6238?source=collection_archive---------1-----------------------#2018-08-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="7f84" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在本文中，我将向您展示如何使用流行的JavaScript框架Vue创建非常简单的Firefox扩展。</p><p id="16a7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">本文分为两部分。第一部分涵盖了创建Firefox扩展的所有必要基础知识，第二部分重点介绍了将其转换为Vue的过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7e1887c10889ffef3408ecff1dcae561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MkUu-iYTIezrNTRgjAu9pA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">If you look at this long enough, you’ll see an owl.</figcaption></figure><h1 id="3fc7" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">先决条件</h1><p id="cd5f" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">尽管整篇文章中没有使用高级的Vue技术，并且JavaScript知识应该足够了，但建议读者至少对Vue有基本的了解。您还将看到我通过终端/命令行创建文件。虽然这是一种创建新文件和文件夹的好的、干净的方法，但这不是必需的——因为这些东西可以按照您喜欢的方式创建:)</p><h1 id="7995" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">目录</h1><ul class=""><li id="f867" class="mb mc in jm b jn lw jr lx jv md jz me kd mf kh mg mh mi mj bi translated">创建Firefox扩展</li><li id="35a8" class="mb mc in jm b jn mk jr ml jv mm jz mn kd mo kh mg mh mi mj bi translated">安装</li><li id="c7cf" class="mb mc in jm b jn mk jr ml jv mm jz mn kd mo kh mg mh mi mj bi translated">做某事</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/c78b1b6355fb529ea7fd2742b8dd18d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/0*KNvH_U1zFfLOnOPY.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Firefox + Vue + a random jigsaw piece = The meaning of life!</figcaption></figure><h1 id="742e" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">创建Firefox扩展</h1><p id="7c95" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">简而言之，Firefox扩展是包含一些文件的目录。仅此而已。这听起来可能一点也不专业，但是对我来说，我稍后会谈到这一点。</p><p id="391b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">记住这一点，让我们创建一个名为<code class="fe mq mr ms mt b">MyExtension</code>的新目录并输入它。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="359d" class="my kz in mt b gy mz na l nb nc">mkdir MyExtension<br/>cd MyExtension</span></pre><p id="93ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">一个Firefox扩展可能包含许多其他可选的目录和文件，所以让我们只讨论那些强制的。其实应该说是强制的那种。Firefox扩展唯一需要的文件是<code class="fe mq mr ms mt b">manifest.json</code>，它应该位于我们的扩展的根目录中。所以让我们创建一个</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="8061" class="my kz in mt b gy mz na l nb nc">touch manifest.json</span></pre><p id="3ec7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并用以下json对象填充它:</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="1cf3" class="my kz in mt b gy mz na l nb nc">{<br/>    "manifest_version": 2,<br/>    "name": "MyExtension",<br/>    "version": "1.0.0"<br/>}</span></pre><p id="16ea" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这是Firefox扩展能够工作的最小工作配置。正如你所猜测的，目前它并没有太大的用处，但是它是一个好的开始。</p><p id="4235" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我希望<code class="fe mq mr ms mt b">manifest.json</code>文件中的每个属性都是不言自明的，但是为了保险起见，这里有一个快速概述:</p><ul class=""><li id="5029" class="mb mc in jm b jn jo jr js jv nd jz ne kd nf kh mg mh mi mj bi translated"><strong class="jm io"> manifest_version </strong> —表示清单文件本身的版本。更多细节请访问Mozilla的文档。</li><li id="bec0" class="mb mc in jm b jn mk jr ml jv mm jz mn kd mo kh mg mh mi mj bi translated">名字<strong class="jm io"/>—这是我们给我们的扩展命名的名字</li><li id="1280" class="mb mc in jm b jn mk jr ml jv mm jz mn kd mo kh mg mh mi mj bi translated"><strong class="jm io">版本</strong> —这是一个字符串，表示我们的扩展的当前版本。你可以给它起任何你想要的名字，但是有一些惯例你可以遵循。更多信息参见<a class="ae ng" href="https://semver.org" rel="noopener ugc nofollow" target="_blank"> Semver </a>。</li></ul><p id="cdfd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们的整个项目看起来像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/e000e5c56dd558f5c95778d6fe94f132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*My3tn8InathP6yzO.png"/></div></div></figure><p id="142e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在我们用更多的功能扩展它之前，让我们看看如何安装和调试这样一个扩展。</p><h1 id="58cd" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">安装</h1><p id="d2e2" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">首先，我们需要打开一个调试页面。在Firefox地址栏中输入<code class="fe mq mr ms mt b">about:debugging</code>并回车。您应该会得到与此类似的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/b995aba4fef740e6ad3fe87ebac1bff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7RpDPAPCXEyx_6y8.png"/></div></div></figure><p id="b021" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击<em class="nj">加载临时插件</em>按钮，打开<code class="fe mq mr ms mt b">manifest.json</code>文件。现在你应该看到你的扩展被加载到<em class="nj">临时扩展</em>部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/0f766f494bd9d9283cac8e2a7411f828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GOZOPrC8lkyS44_f.png"/></div></div></figure><h1 id="13a7" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">做某事</h1><p id="bd7c" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">现在您已经成功地创建并加载了一个临时的Firefox扩展！尽管这是一项伟大的成就，是值得骄傲的事情，但我们还是要面对现实。没用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8404a4905b9981498fc51b0ce9d70b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:224/format:webp/0*n-m2vaJqP8DPVp2g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">A sad jigsaw = a sad life</figcaption></figure><p id="8681" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">它看起来什么都不像，也还没做什么；它只是坐在那里占用资源(几乎什么都没有，但这不是重点)。</p><p id="c3c6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">所以让我们解决“看起来什么都不像”的部分。我的意思是，让我们给我们的扩展一个向世界展示自己的方式——一个图标。</p><h1 id="5623" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">为扩展提供图标</h1><p id="dd82" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">目前我没有合适的图标候选人，但是我找到了一个我经常使用的图像，所以我会选择这个。我希望有一天你会原谅我；).当然你可以随意使用任何你喜欢的图片。</p><p id="08df" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">让我们创建一个文件夹，我们的图像和随后的大部分应用程序源代码将存放在这个文件夹中。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="6ac4" class="my kz in mt b gy mz na l nb nc">mkdir -p assets/img</span></pre><p id="154d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><code class="fe mq mr ms mt b">-p</code>选项表示该命令应该在该路径上创建所有目录，以防它们不存在。所以在这种情况下，它将创建一个<code class="fe mq mr ms mt b">asset</code>目录和其中的<code class="fe mq mr ms mt b">img</code>目录。将你选择的图标图片放在<code class="fe mq mr ms mt b">img</code>文件夹中——以<code class="fe mq mr ms mt b">logo.png</code>命名——你就可以开始了。</p><p id="06ff" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的项目现在看起来像这样</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="d73d" class="my kz in mt b gy mz na l nb nc">MyExtension<br/>    assets/<br/>        img/<br/>            logo.png<br/>    manifest.json</span></pre><p id="f2d3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">如果您点击<code class="fe mq mr ms mt b">about:debugging</code>页面中的<em class="nj">重新加载</em>按钮，您会注意到什么也没有发生。要实际告诉扩展使用我们的图像作为图标，我们需要明确地告诉它。为此，让我们更新我们的<code class="fe mq mr ms mt b">manifest.json</code>文件。</p><p id="31e7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">指定图标的关键属性是(你永远猜不到)一个叫做<code class="fe mq mr ms mt b">icons</code>的属性。它是一个对象，其中键是图标的尺寸，值是它的路径。你可以在这里了解更多信息<a class="ae ng" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="470e" class="my kz in mt b gy mz na l nb nc">{<br/>    "manifest_version": 2,<br/>    "name": "MyExtension",<br/>    "version": "1.0.0",<br/>    "icons": {<br/>        "48": "assets/img/logo.png"<br/>    }<br/>}</span></pre><p id="d17d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，如果你点击重新加载按钮，而不是默认的扩展图标(拼图)，你提供的一个应该会出现。</p><p id="6b4d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在它有了些样子，我们终于可以把它展示给朋友们了！但还是没多大作用。你知道吗？最好不要给任何人看…</p><p id="9bb6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">相反，让我们看看如何让我们的扩展变得有用。</p><h1 id="14bb" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">浏览器动作</h1><p id="840b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">我们希望允许用户以某种方式与我们的扩展交互。浏览器操作是浏览器右上角的小按钮，通常会打开一个小弹出窗口，让你做一些事情。让我们来看看如何创建一个。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ee06c823ce921aa9539ff8062cb467c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/0*Q2cxbOTZaHN20w5T.png"/></div></figure><p id="39ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">当你点击按钮时弹出的是一个简单的html页面，所以在我们创建按钮之前，让我们准备一个简单的HTML页面<code class="fe mq mr ms mt b">app.html</code>。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="3bdb" class="my kz in mt b gy mz na l nb nc">touch app.html</span></pre><p id="4fcd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在你的文件结构应该是这样的</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="f842" class="my kz in mt b gy mz na l nb nc">MyExtension<br/>    app.html<br/>    assets/<br/>        img/<br/>            logo.png<br/>    manifest.json</span></pre><p id="06e0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">并将以下内容填入<code class="fe mq mr ms mt b">app.html</code></p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="f771" class="my kz in mt b gy mz na l nb nc">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    Hello Firefox extension!<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="f361" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们需要将这个html注册为<code class="fe mq mr ms mt b">manifest.json</code>中的默认弹出窗口。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="02ae" class="my kz in mt b gy mz na l nb nc">{<br/>    "manifest_version": 2,<br/>    "name": "MyExtension",<br/>    "version": "1.0.0",<br/>    "icons": {<br/>        "48": "assets/img/logo.png"<br/>    },<br/>    "browser_action": {<br/>        "default_icon": "assets/img/logo.png",<br/>        "default_title": "Opens MyExtension",<br/>        "default_popup": "app.html"<br/>    }<br/>}</span></pre><p id="0957" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意描述默认弹出窗口的<em class="nj"> browser_action </em>属性。请注意，我使用了相同的图像作为扩展标志和弹出图标。这两个可以不同，但我决定不这样做，以限制演示应用程序中使用的图像数量。</p><p id="1c01" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="nj"> default_title </em>是用户悬停在按钮上时显示的文本。<br/> <em class="nj"> default_popup </em>是我们的html，用作弹出窗口。你可以在<a class="ae ng" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action" rel="noopener ugc nofollow" target="_blank">官方文档</a>中阅读更多关于<em class="nj"> browser_action </em>的内容。</p><p id="2890" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">继续，在<code class="fe mq mr ms mt b">about:debugging</code>中重新加载你的扩展，你现在应该看到这个按钮了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/18691df1523e39c0d04739e91070ea08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*ihuKwyNkoTDjdJ_4.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">This is what success looks like ;)</figcaption></figure><p id="7bd9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">恭喜你，你已经成功地创建了第一个功能性的Firefox扩展，这一次，它真的有所作为了！:)</p><h1 id="f88b" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">请求许可</h1><p id="9a6b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">在我们深入研究将我们的扩展转换成Vue之前，我们需要稍微改进一下。本文主要关注的不是您可以用您的扩展做什么，但是我认为至少演示一些它可以做的事情是有用的。让我们利用扩展的能力来访问一些常规浏览器应用程序中不可用的浏览器信息，例如访问打开的窗口和检索所有打开的标签的能力。</p><p id="5c0b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">要做到这一点，我们需要明确要求访问浏览器选项卡，并且需要由用户授权给我们。这通常是在安装过程中完成的，安装过程中会询问用户是否同意授予扩展某些权限。</p><p id="8804" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如你可能猜到的，这又发生在<code class="fe mq mr ms mt b">manifest.json</code>。这一次它是名为<em class="nj"> permissions </em>的属性，它保存了扩展请求的所有权限的数组。因此，继续将<code class="fe mq mr ms mt b">tabs</code>放入该数组。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="e1a3" class="my kz in mt b gy mz na l nb nc">{<br/>    "manifest_version": 2,<br/>    "name": "MyExtension",<br/>    "version": "1.0.0",<br/>    "icons": {<br/>        "48": "assets/img/logo.png"<br/>    },<br/>    "browser_action": {<br/>        "default_icon": "assets/img/logo.png",<br/>        "default_title": "Opens MyExtension",<br/>        "default_popup": "app.html"<br/>    },<br/>    "permissions": ["tabs"]<br/>}</span></pre><p id="0771" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，当您尝试安装扩展时，系统会提示您授予扩展请求的权限。嗯，实际上你不会得到任何提示，因为我们在调试模式，但相信我，它会在那里。</p><h1 id="0f19" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">增加一些互动性</h1><p id="3c2b" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">现在是接收和处理一些数据的时候了。我们将利用授予我们的<em class="nj">选项卡</em>权限，并通过<code class="fe mq mr ms mt b">browser</code>对象访问它。</p><p id="e51d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">但在此之前，让我们在<code class="fe mq mr ms mt b">app.html</code>中创建一个触发事件的按钮和一个显示结果的<code class="fe mq mr ms mt b">ul</code>元素。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="1820" class="my kz in mt b gy mz na l nb nc">...<br/>&lt;body&gt;<br/>    Hello Firefox extension!<br/>    &lt;button id="button"&gt;Show me tabs&lt;/button&gt;<br/>    &lt;ul id="results"&gt;&lt;/ul&gt;<br/>&lt;/body&gt;<br/>...</span></pre><p id="a7e4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们需要创建一个<code class="fe mq mr ms mt b">loadTabs()</code>函数，并将其注册为onlick监听器。所以让我们创建一个名为<code class="fe mq mr ms mt b">app.js</code>的文件，并将它放在我们的扩展的根文件夹中。在<code class="fe mq mr ms mt b">app.html</code>中注册该功能并链接。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="cd6d" class="my kz in mt b gy mz na l nb nc">...<br/>&lt;body&gt;<br/>    Hello Firefox extension!<br/>    &lt;button id="button"&gt;Show me tabs&lt;/button&gt;<br/>    &lt;ul id="results"&gt;&lt;/ul&gt;</span><span id="eb61" class="my kz in mt b gy nn na l nb nc">    &lt;script src="app.js"&gt;&lt;/script&gt;<br/>&lt;/body&gt;<br/>...</span></pre><p id="b098" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后是<code class="fe mq mr ms mt b">app.js</code></p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="ad80" class="my kz in mt b gy mz na l nb nc">const btn = document.querySelector('#button');<br/>if (btn)<br/>    btn.addEventListener('click', loadTabs);</span><span id="aa17" class="my kz in mt b gy nn na l nb nc">function loadTabs() {<br/>    alert('Hello there!');<br/>}</span></pre><p id="739b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">重新加载扩展并单击按钮。如果它正确地显示了一个警告窗口，您应该会得到类似如下的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/61fe2c0abb7680ee229eff2b736c56f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WE3MP6A1DnkFeqQb.png"/></div></div></figure><p id="711c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">最后要做的是移除对<code class="fe mq mr ms mt b">alert</code>函数的调用，并替换为对浏览器的实际请求，以获取所有打开的选项卡:</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="1c69" class="my kz in mt b gy mz na l nb nc">const btn = document.querySelector('#button');<br/>if (btn)<br/>    btn.addEventListener('click', loadTabs);</span><span id="b069" class="my kz in mt b gy nn na l nb nc">function loadTabs() {<br/>    // This is the request to obtain an array of active tabs. It returns a promise.<br/>    // It accepts a config object (see docs)<br/>    browser.tabs.query({ currentWindow:true })<br/>        .then(tabs =&gt; {<br/>            const results = document.querySelector('#results'),<br/>                  parts = [];</span><span id="57bf" class="my kz in mt b gy nn na l nb nc">            for (let tab of tabs) {<br/>                parts.push(`&lt;li&gt;${tab.title}: ${tab.url}&lt;/li&gt;`);<br/>            }</span><span id="0b48" class="my kz in mt b gy nn na l nb nc">            results.innerHTML = parts.join('');<br/>        });<br/>}</span></pre><p id="96c5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，单击按钮后，您应该看到无序列表中列出的所有选项卡。恭喜你。</p><p id="25ba" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">在结束本文的第一部分之前，让我向您展示最后一样东西。</p><h1 id="d20e" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">弹出调试</h1><p id="66ad" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">肯定会有这样的时候，你需要检查你的弹出窗口(一个html文档)的元素，作为一个普通的html页面。为此，在<em class="nj">临时扩展</em>部分的<code class="fe mq mr ms mt b">Reload</code>按钮旁边有一个<em class="nj">调试</em>按钮。这不是秘密，因为按钮非常明显。但是一旦你开始调试，你会注意到一旦你点击检查器窗口来摆弄这些元素，你的弹出窗口就会关闭。这非常不方便，但幸运的是有一个修复方法。</p><p id="aaed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">点击检测窗口右上角的三点按钮，点击<em class="nj">禁用弹出自动隐藏</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/961b8d504918c81ec9109b5e8bf7b175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lfz5IkOu1FVYVB9e.png"/></div></div></figure><p id="cffd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这就结束了本文的第1部分。在<a class="ae ng" href="https://medium.com/javascript-in-plain-english/how-i-built-a-browser-extension-with-vue-part-2-2c4ab2dd752d" rel="noopener">第2部分</a>中，我们将通过利用Vue来构建我们的浏览器扩展接口，从而将Vue添加到组合中。</p><p id="598d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">第2部分现在已经准备好了——你可以在这里阅读它！</p><p id="2b3f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这篇文章是作为一个开源项目发表在Github上的，所以如果你有任何建议，或者发现了任何打字错误，请不要犹豫投稿！</p><h1 id="028c" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">信用</h1><p id="e376" class="pw-post-body-paragraph jk jl in jm b jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh ig bi translated">特别感谢Sunil 和Wyatt 对本文的贡献。</p></div></div>    
</body>
</html>