<html>
<head>
<title>Making Code Reusable with Vue.js Mixins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Vue.js Mixins使代码可重用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/making-code-reusable-with-vue-js-mixins-126fc8aca2b4?source=collection_archive---------6-----------------------#2020-04-05">https://javascript.plainenglish.io/making-code-reusable-with-vue-js-mixins-126fc8aca2b4?source=collection_archive---------6-----------------------#2020-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8d66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Vue.js是一个易于使用的web应用框架，我们可以用它来开发交互式前端应用。</p><p id="52f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将看看如何定义和使用mixins来使代码可重用。</p><h1 id="fad7" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">基础</h1><p id="7735" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们可以通过编写一些简单的代码来定义一个mixin，这些代码由一个具有组件的一些属性的对象组成，如下所示:</p><p id="bb7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">src/index.js</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="0676" class="ma km iq lr b gy mb mc l md me">const appMixin = {<br/>  created() {<br/>    this.hello();<br/>  },<br/>  methods: {<br/>    hello() {<br/>      this.message = "hi";<br/>    }<br/>  }<br/>};</span><span id="8dda" class="ma km iq lr b gy mf mc l md me">new Vue({<br/>  el: "#app",<br/>  mixins: [appMixin],<br/>  data: {<br/>    message: ""<br/>  }<br/>});</span></pre><p id="d4aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">index.html</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="cd67" class="ma km iq lr b gy mb mc l md me">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae mg" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      {{message}}<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3764" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中，我们通过将mixin <code class="fe lo lp lq lr b">appMixin</code>分配给一个结构与Vue实例相同的对象来定义它。</p><p id="9ec9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，当创建Vue实例时，<code class="fe lo lp lq lr b">hello</code>被调用，因为我们在<code class="fe lo lp lq lr b">appMixin</code>中有了<code class="fe lo lp lq lr b">created</code>钩子。</p><p id="7472" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在模板中，我们显示<code class="fe lo lp lq lr b">message</code>，所以我们在屏幕上得到<code class="fe lo lp lq lr b">hi</code>。</p><p id="b3eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以放置的其他属性包括<code class="fe lo lp lq lr b">methods</code>、<code class="fe lo lp lq lr b">components</code>和<code class="fe lo lp lq lr b">directives</code>。它们都将被合并到我们传递给<code class="fe lo lp lq lr b">new Vue</code>的对象或组件选项对象中。</p><p id="8865" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果有任何相同之处，组件的选项将优先于mixin中的项目。</p><p id="23e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，如果我们有以下内容:</p><p id="043f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">src/index.js</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="3636" class="ma km iq lr b gy mb mc l md me">const appMixin = {<br/>  created() {<br/>    this.hello();<br/>  },<br/>  methods: {<br/>    hello() {<br/>      this.message = "hi";<br/>    }<br/>  }<br/>};</span><span id="5cd0" class="ma km iq lr b gy mf mc l md me">new Vue({<br/>  el: "#app",<br/>  mixins: [appMixin],<br/>  data: {<br/>    message: ""<br/>  },<br/>  created() {<br/>    this.hello();<br/>  },<br/>  methods: {<br/>    hello() {<br/>      this.message = "foo";<br/>    }<br/>  }<br/>});</span></pre><p id="9a87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">index.html</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="db29" class="ma km iq lr b gy mb mc l md me">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae mg" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      {{message}}<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="1132" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后显示<code class="fe lo lp lq lr b">foo</code>,因为Vue实例中的方法优先于mixin中的方法。</p><p id="a9be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们也可以使用<code class="fe lo lp lq lr b">Vue.extend</code>方法创建一个新组件，如下所示:</p><p id="28b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">src/index.js</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="6ece" class="ma km iq lr b gy mb mc l md me">const appMixin = {<br/>  created() {<br/>    this.hello();<br/>  },<br/>  methods: {<br/>    hello() {<br/>      this.message = "hi";<br/>    }<br/>  }<br/>};</span><span id="f034" class="ma km iq lr b gy mf mc l md me">const Component = Vue.extend({<br/>  mixins: [appMixin],<br/>  el: "#app"<br/>});</span><span id="26e3" class="ma km iq lr b gy mf mc l md me">new Component();</span></pre><p id="8135" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">index.html</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="3c70" class="ma km iq lr b gy mb mc l md me">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae mg" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      {{message}}<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ba95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">Vue.extend</code>的工作方式与上面的<code class="fe lo lp lq lr b">new Vue</code>相同。</p><p id="341f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与<code class="fe lo lp lq lr b">Vue.extend()</code>使用相同的合并机制。</p><figure class="ls lt lu lv gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mh"><img src="../Images/f20d0ac9664171a13d63c2d46ab5024f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fxtCrcVR3tNGzuCF"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Photo by <a class="ae mg" href="https://unsplash.com/@paulgilmore_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Paul Gilmore</a> on <a class="ae mg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="ecdf" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">选项合并</h1><p id="0541" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们可以通过选择合适的合并策略来调整项目的合并方式。</p><p id="d98a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，数据对象被递归合并，在冲突的情况下，组件的数据优先。</p><p id="5667" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">src/index.js</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="5882" class="ma km iq lr b gy mb mc l md me">const mixin = {<br/>  data() {<br/>    return {<br/>      message: "hi",<br/>      foo: "abc"<br/>    };<br/>  }<br/>};</span><span id="9340" class="ma km iq lr b gy mf mc l md me">new Vue({<br/>  el: "#app",<br/>  mixins: [mixin],<br/>  data() {<br/>    return {<br/>      message: "bye",<br/>      bar: "def"<br/>    };<br/>  }<br/>});</span></pre><p id="c99b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">index.html</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="fc02" class="ma km iq lr b gy mb mc l md me">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;App&lt;/title&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;script src="<a class="ae mg" href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/vue/dist/vue.js</a>"&gt;&lt;/script&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="app"&gt;<br/>      {{message}} {{foo}} {{bar}}<br/>    &lt;/div&gt;<br/>    &lt;script src="src/index.js"&gt;&lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5470" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到显示了<code class="fe lo lp lq lr b">bye abc def</code>,因为<code class="fe lo lp lq lr b">message</code>同时存在于组件和mixin中，并且组件优先。</p><p id="7239" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">foo</code>和<code class="fe lo lp lq lr b">bar</code>分别只存在于mixin和component中，所以它们都合并到同一个<code class="fe lo lp lq lr b">data</code>对象中。</p><p id="2e6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同名的钩子被合并到一个数组中，这样它们都将被调用。Mixin钩子将被称为组件自己的钩子。</p><p id="91f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以如果我们有:</p><p id="93c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">src/index.js</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="cd6e" class="ma km iq lr b gy mb mc l md me">const mixin = {<br/>  mounted() {<br/>    console.log("mixin hook called");<br/>  }<br/>};</span><span id="db5d" class="ma km iq lr b gy mf mc l md me">new Vue({<br/>  el: "#app",<br/>  mixins: [mixin],<br/>  mounted() {<br/>    console.log("component hook called");<br/>  }<br/>});</span></pre><p id="e70b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="fbe3" class="ma km iq lr b gy mb mc l md me">mixin hook called<br/>component hook called</span></pre><p id="f29d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe lo lp lq lr b">console.log</code>输出中。</p><p id="58cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">期望像<code class="fe lo lp lq lr b">methods</code>、<code class="fe lo lp lq lr b">components</code>和<code class="fe lo lp lq lr b">directives</code>这样的对象值的选项被合并到同一个对象中。当对象中存在冲突时，组件的选项将优先考虑。</p><p id="c376" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，如果我们有:</p><p id="6e4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">src/index.js</code>:</p><pre class="ls lt lu lv gt lw lr lx ly aw lz bi"><span id="4b70" class="ma km iq lr b gy mb mc l md me">const mixin = {<br/>  methods: {<br/>    foo() {<br/>      console.log("foo");<br/>    }<br/>  }<br/>};</span><span id="dda0" class="ma km iq lr b gy mf mc l md me">const vm = new Vue({<br/>  el: "#app",<br/>  mixins: [mixin],<br/>  methods: {<br/>    foo() {<br/>      console.log("bar");<br/>    }<br/>  }<br/>});<br/>vm.foo();</span></pre><p id="ec6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将看到<code class="fe lo lp lq lr b">bar</code>被记录，因为组件的<code class="fe lo lp lq lr b">foo</code>方法优先于<code class="fe lo lp lq lr b">mixin</code>的<code class="fe lo lp lq lr b">foo</code>方法。</p><p id="072a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe lo lp lq lr b">Vue.extend()</code>中使用了相同的合并策略。</p><h1 id="6b70" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">结论</h1><p id="a037" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">Mixins允许我们创建可以包含在多个组件中的代码。</p><p id="b453" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这些属性中，通过使组件的<code class="fe lo lp lq lr b">methods</code>、<code class="fe lo lp lq lr b">components</code>和<code class="fe lo lp lq lr b">directives</code>优先于mixin的项目来合并它们。</p><p id="70f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据也合并在一起，如果两个地方存在相同的键，则组件的数据优先。</p><p id="8266" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">钩子被合并到一个数组中，如果它们有相同的名字，mixin的钩子在组件的钩子之前被调用。</p><h2 id="8790" class="ma km iq bd kn mt mu dn kr mv mw dp kv jy mx my kz kc mz na ld kg nb nc lh nd bi translated"><strong class="ak">用简单英语写的JavaScript的注释:</strong></h2><p id="9929" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们总是有兴趣帮助推广高质量的内容。如果你有一篇文章想用简单的英语提交给JavaScript，用你的Medium用户名给我们发邮件到<a class="ae mg" href="mailto:submissions@javascriptinplainenglish.com" rel="noopener ugc nofollow" target="_blank">submissions@javascriptinplainenglish.com</a>，我们会把你添加为作者。</p></div></div>    
</body>
</html>