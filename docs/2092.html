<html>
<head>
<title>Getting started with Ethereum Smart Contracts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊智能合约入门</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-started-with-ethereum-smart-contracts-7aa01e496d23?source=collection_archive---------13-----------------------#2020-05-18">https://javascript.plainenglish.io/getting-started-with-ethereum-smart-contracts-7aa01e496d23?source=collection_archive---------13-----------------------#2020-05-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1615" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何使用Solidity构建和部署您的第一个智能合同</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/aada0e5f6087b848148c7ac3bd0a88c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YS-9Z3DLI0QRlhlkYxoDQg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Illustration by unDraw</figcaption></figure><p id="caa8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">首先，我想说，如果你正在寻找关于智能合约或可靠性的高级解释，这不是你能找到的地方。我将展示的唯一内容是这些协议可以实现的基本功能，以及如何在区块链上部署它们。如果其中一些概念对您来说是陌生的，我在本文末尾附加了一些参考资料，这样您就可以理解我们将要讨论的一些概念需要遵循的基础知识。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h1 id="7b85" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">什么是智能合同？</h1><p id="110a" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">智能合约是在<a class="ae ms" href="https://www.bitrates.com/guides/ethereum/what-is-the-unstoppable-world-computer" rel="noopener ugc nofollow" target="_blank">以太坊虚拟机</a> (EVM)上运行的任何程序，通常被称为“智能合约”。它是一种计算机协议，旨在以数字方式促进、验证或加强合同的协商或履行。智能合约允许在没有第三方的情况下进行可信的交易。这些交易是可追踪和不可逆转的。如果你想了解更多关于区块链是如何工作的，你可以<a class="ae ms" href="https://www.youtube.com/watch?v=_160oMzblY8" rel="noopener ugc nofollow" target="_blank">看看这个由<a class="ae ms" href="https://anders.com/" rel="noopener ugc nofollow" target="_blank">安德斯·布朗沃斯</a>制作的惊人视频</a>。</p><p id="dacb" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">让我们来看一个现实生活中的例子:</strong></p><p id="f719" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们想象一下，亚当想买苏珊的房子，他们已经决定使用智能合同这样做。这个智能合同包含双方之间以代码形式达成的协议。把它翻译成人类语言，计算机协议将表示如下:“当亚当付给苏珊300以太时，亚当将获得房子的所有权。”一旦这份智能合同协议生效，它就不能被修改——这意味着亚当可以放心地为房子支付300英镑。如果在这种情况下不使用智能合同，Adam和Susan将不得不向第三方公司(如银行和律师)支付大量费用，以构建必要的工具来创建信任关系。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h1 id="8696" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">基本设置</h1><p id="db05" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">我们将使用<a class="ae ms" href="https://solidity.readthedocs.io/en/v0.6.6/" rel="noopener ugc nofollow" target="_blank"> Solidity </a>构建我们的智能合约，这样我们就可以在以太坊网络上部署它。请注意，以太坊有几个网络可以用于测试，因此我们将在Rinkeby网络而不是主网络中部署我们的智能合约，这样我们的虚拟操作就不会真正收费。</p><p id="f551" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">从一开始就要意识到的一点是，大多数智能合同操作需要执行一定量的乙醚。唯一不需要ether的操作是只读操作，但是我们会在后面看到它们的样子。为了部署和使用我们的智能合同，我们将需要创建一个<a class="ae ms" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank">元掩码</a>帐户，并将其切换到选项中的林克比网络。要在钱包里装上乙醚来部署我们的合同并运行运营，我们可以去<a class="ae ms" href="https://faucet.rinkeby.io/" rel="noopener ugc nofollow" target="_blank">林克比水龙头</a>请求一些来测试我们的第一份智能合同。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h1 id="a0bb" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">项目概述和工具</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mt"><img src="../Images/3ccfb4efd52c94daebf26a1309d319d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2DHPPZ8WWuKjGtPiNR6UA@2x.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Project Flow Overview</figcaption></figure><p id="ab06" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">上面的流程显示了我们项目的所有部分将如何结合在一起。我们的智能合同代表了我们的智能合同规则的适用范围。一旦我们定义了这些规则，我们就需要编译我们的智能合同，并使用<a class="ae ms" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">摩卡</a> &amp; <a class="ae ms" href="https://www.trufflesuite.com/ganache" rel="noopener ugc nofollow" target="_blank"> Ganache </a>设置一些测试。如果您不熟悉摩卡，请确保查看本文末尾的附加资源。Ganache是<a class="ae ms" href="https://www.trufflesuite.com/" rel="noopener ugc nofollow" target="_blank">块菌套件</a>的一部分，可作为个人区块链用于以太网开发和测试。</p><p id="966f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">一旦我们的智能合同生效，我们将使用<a class="ae ms" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>将其部署到林克比网络，以连接到网络节点&amp; <a class="ae ms" href="https://github.com/trufflesuite/truffle-hdwallet-provider" rel="noopener ugc nofollow" target="_blank">块菌高清钱包提供商</a>以连接到我们的元掩码帐户。</p><p id="e564" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在此之后，我们将能够通过使用<a class="ae ms" href="https://rinkeby.etherscan.io/" rel="noopener ugc nofollow" target="_blank">林克比以太网</a>在林克比以太网网络上验证我们的合同的存在。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h1 id="fd58" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">我们的智能合同</h1><p id="548b" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">我们将构建一个非常基本的协议，它可以在变量中存储和返回消息。这里的要点是理解我们的合同可以执行的两种类型的操作。这也将使我们能够理解与使用区块链技术相关的限制。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Smart Contract using Solidity</figcaption></figure><p id="ded4" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">查看我们的代码，我们可以看到，我们有一个消息变量，它将用一个默认消息和一个函数初始化，该函数可以为同一个变量设置一个新消息。作为Solidity语言的一部分，一旦创建了这个契约，就有一个与Inbox构造函数相关联的隐含只读函数，其唯一目的是返回消息变量。如果你想更深入地理解上面的代码，看看Solidity文档<a class="ae ms" href="https://solidity.readthedocs.io/en/v0.6.6/index.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="5609" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们快速看一下编译文件:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Our compile.js file</figcaption></figure><p id="8148" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">为了编译我们的契约并在网络中部署它，我们将需要使用<a class="ae ms" href="https://www.npmjs.com/package/solc" rel="noopener ugc nofollow" target="_blank"> solc </a>。Solc是一个可靠的JavaScript编译器，它将转换我们的代码，并以字节码和ABI的格式返回给我们。字节码以一种为软件解释器设计的格式表示我们的合同。ABI是一个描述部署代码及其功能的<code class="fe mw mx my mz b">.json</code>文件。它允许我们将契约放在上下文中，并在部署后调用它的函数。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h1 id="a49b" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">测试我们的合同</h1><p id="ac57" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">我们将使用Mocha构建我们的测试电池，我们将设置两个简单的电池。首先验证初始化和设置默认消息的能力，其次验证更新相同消息的能力。但是，我们需要首先使用Web3 &amp; Ganache在本地网络中部署我们的合同。我们将创建一个beforeEach函数，该函数使用Web3模块连接到Ganache来检索本地测试帐户以执行我们的操作。如果你记得我以前提到过，智能合约中的大多数操作都需要一些以太网。合约的部署就是这些操作之一。在我们的本地测试中，Ganache将为我们提供执行此操作和其他操作所需的帐户和资金。</p><p id="d2fe" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们看一下我们的代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Our local testing script</figcaption></figure><p id="0a20" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你可以看到，当我们使用之前定义的收件箱函数时，我们可以执行<code class="fe mw mx my mz b">call( )</code>或<code class="fe mw mx my mz b">send( )</code>操作。<code class="fe mw mx my mz b">Call( )</code>操作只返回信息，并且是即时的。此外，<code class="fe mw mx my mz b">send( )</code>业务打算发送信息到网络，这样做将需要一些以太网和时间来运行。时间表示开采每个操作将被注册的区块所需的时间。这就是为什么当我们执行一个<code class="fe mw mx my mz b">send( )</code>操作时，我们需要将一个帐户作为一个参数来传递，并且它们比我们习惯的要花费更多的时间来执行。</p><p id="e64a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">一旦我们运行我们的测试，我们应该在我们的终端中得到这样的东西:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/2a6316af31c7bbd851ffc8dcb6449fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HUh86O0hqT1Ol5o5QMrBIg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Test results in the Terminal</figcaption></figure><h1 id="efa6" class="lv lw in bd lx ly nb ma mb mc nc me mf jt nd ju mh jw ne jx mj jz nf ka ml mm bi translated">部署我们的合同</h1><p id="53e0" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">将我们的契约部署到Rinkeby网络在许多方面类似于我们在前面的测试示例中所做的。两个主要区别是，我们将不使用Ganache连接到本地网络，我们将需要访问我们的Metamask wallet来使用ether执行操作。让我们从访问Metamask帐户开始。这可以使用您在创建帐户时收到的助记符，该助记符将使用HD Wallet Provider检索我们的元掩码公钥。如果你想更好地理解这个过程是如何工作的，你可以在这里阅读更多信息。</p><p id="a2d5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">HD Wallet Provider constructor将收到的第二个参数是通过Infura获得的端点，它将允许我们连接到网络。</p><p id="7919" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们看一下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Our deployment script</figcaption></figure><p id="c572" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">一旦我们运行部署脚本，我们应该在终端中得到类似这样的内容:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/e9eed26b72dfccf2f00bb6dca15f9fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*urnbCr_4V9rbjBCFk-25HQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Our Terminal response once the code is deployed</figcaption></figure><p id="fc39" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们可以使用以太扫描来验证我们的合同在区块链中的存在，或者，在这种情况下，<a class="ae ms" href="https://rinkeby.etherscan.io/" rel="noopener ugc nofollow" target="_blank"> Rinkeby以太扫描</a>。</p></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h1 id="8c8f" class="lv lw in bd lx ly lz ma mb mc md me mf jt mg ju mh jw mi jx mj jz mk ka ml mm bi translated">结论</h1><p id="122e" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">我希望你喜欢这个关于Solidity智能合约的基本介绍，以及我们如何在以太坊网络上部署它们。如果您想继续学习和发展您的技能，我在参考资料部分添加了一个完整的课程，我发现它非常有帮助，还有GitHub链接到我们刚刚做的内容。</p><p id="9e55" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">感谢阅读！</p><h1 id="1c80" class="lv lw in bd lx ly nb ma mb mc nc me mf jt nd ju mh jw ne jx mj jz nf ka ml mm bi translated">资源</h1><ul class=""><li id="f85e" class="nh ni in ku b kv mn ky mo lb nj lf nk lj nl ln nm nn no np bi translated"><a class="ae ms" href="https://blog.logrocket.com/a-quick-and-complete-guide-to-mocha-testing-d0e0ea09f09d/" rel="noopener ugc nofollow" target="_blank">摩卡测试快速完整指南</a></li><li id="1e87" class="nh ni in ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><a class="ae ms" href="https://www.youtube.com/watch?v=SSo_EIwHSd4" rel="noopener ugc nofollow" target="_blank">区块链简单讲解</a></li><li id="f8dd" class="nh ni in ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><a class="ae ms" href="https://www.coindesk.com/learn/ethereum-101/ethereum-smart-contracts-work" rel="noopener ugc nofollow" target="_blank">以太坊101 </a></li><li id="9a88" class="nh ni in ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><a class="ae ms" href="https://www.udemy.com/course/ethereum-and-solidity-the-complete-developers-guide/" rel="noopener ugc nofollow" target="_blank">以太坊和坚固性:完整的开发者指南</a></li><li id="bb0e" class="nh ni in ku b kv nq ky nr lb ns lf nt lj nu ln nm nn no np bi translated"><a class="ae ms" href="https://github.com/gfregalado/InboxSmartContract" rel="noopener ugc nofollow" target="_blank">Github上的完整代码</a></li></ul></div><div class="ab cl lo lp hr lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ig ih ii ij ik"><h2 id="3cdb" class="nv lw in bd lx nw nx dn mb ny nz dp mf lb oa ob mh lf oc od mj lj oe of ml og bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="3668" class="pw-post-body-paragraph ks kt in ku b kv mn jo kx ky mo jr la lb mp ld le lf mq lh li lj mr ll lm ln ig bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae ms" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="ku io">JavaScript in Plain English</strong></a><a class="ae ms" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="ku io">AI in Plain English</strong></a><a class="ae ms" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="ku io">UX in Plain English</strong></a><a class="ae ms" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="ku io">Python in Plain English</strong></a><strong class="ku io"/>—谢谢，继续学习！</p><p id="1d23" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们还推出了一个YouTube，希望你能通过<a class="ae ms" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io">订阅我们的简明英语频道</strong> </a>来支持我们</p><p id="136e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">一如既往,“简明英语”希望帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae ms" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="ku io">submissions @ plain English . io</strong></a><strong class="ku io"/>，并附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>