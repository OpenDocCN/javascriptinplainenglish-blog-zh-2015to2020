<html>
<head>
<title>Create a Travel List App in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中创建一个旅行列表应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-a-travel-list-app-in-react-ab1564885bbe?source=collection_archive---------3-----------------------#2020-09-01">https://javascript.plainenglish.io/create-a-travel-list-app-in-react-ab1564885bbe?source=collection_archive---------3-----------------------#2020-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6600" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用React、Gatsby、list、GraphCMS创建旅行列表应用程序。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1d5bd33654f4c226634ac65575efca4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eF52J5s0bf_wdu2v"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@philippcamera?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Philipp Kämmerer</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c948" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">读者你好！</p><p id="4600" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天在这篇文章中，我们将看到如何使用React、Gatsby、fleet和GraphCMS创建一个旅行列表应用程序。</p><p id="7822" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实际上旅行总是很有趣，我们想去很多不同的地方旅行，但是我们没有足够的时间去做。所以我们决定创建一个包含自定义地图应用程序的列表，在列表中显示我们所有的目的地。</p><p id="d8dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在进入主题之前，让我们看看构建这个应用程序需要遵循哪些步骤:</p><ul class=""><li id="2b31" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">用传单创建一个新应用程序。</li><li id="bfe8" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在GraphCMS中管理旅行地点列表。</li><li id="c1ac" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">用GraphQL查询我们的数据位置。</li><li id="2854" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">为目的地创建一个清单，并添加到我们的地图。</li></ul><p id="5e60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们进入主题，我们将使用Gatsby和CMS构建一个地图应用程序，它将在地图上显示标记，并在一个简单的列表位置中显示我们的位置。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="6dae" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">使用传单创建新应用程序</h1><p id="cb78" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我们将创建一个带有绘图工具的基本React应用程序。首先，转到您想要创建新应用程序并运行的本地目录。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="7e07" class="np mo iq nl b gy nq nr l ns nt">gatsby new my-travel-bucket-list https://github.com/colbyfayock/gatsby-starter-leaflet</span></pre><p id="886a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在把你的<strong class="ky ir">我的旅行清单</strong>换成你想要的方便的名字。这用于为应用程序创建新文件夹。</p><p id="818f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行该命令后，Gatsby将启动并安装我们需要的所有依赖项。然后转到该目录并运行开发命令:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="e734" class="np mo iq nl b gy nq nr l ns nt">cd my-travel-bucket-list<br/>yarn develop<br/># or<br/>npm run develop</span></pre><p id="027f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你的应用程序应该准备好了。</p><p id="de9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在转到<strong class="ky ir"> src/pages/index.js </strong>文件。然后移除<strong class="ky ir"> mapEffect </strong>内的第一行，让leafletElement映射:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="86b9" class="np mo iq nl b gy nq nr l ns nt">async function mapEffect({ leafletElement: map } = {}) {<br/>  if ( !map ) return;<br/>}</span></pre><p id="8305" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后移除IndexPage组件顶部的markerRef。然后从我们的<strong class="ky ir"> &lt; Marker &gt; </strong>组件中移除ref={markerRef} prop，下一步是<strong class="ky ir">useRef</strong>import React。</p><p id="856c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们必须删除所有以popup和time开头的变量，包括:</p><ul class=""><li id="6b12" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">时间工作室</li><li id="b12f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">timeToOpenPopupAfterZoom</li><li id="0d68" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">timeToUpdatePopupAfterZoom</li><li id="0520" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">popupContentHello</li><li id="68b1" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">popupContentGatsby</li></ul><p id="a851" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，您必须删除以下所有行:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="f393" class="np mo iq nl b gy nq nr l ns nt">import L from 'leaflet';<br/>...<br/>import { promiseToFlyTo, getCurrentLocation } from 'lib/map';<br/>...<br/>import gatsby_astronaut from 'assets/images/gatsby-astronaut.jpg';<br/>...<br/>const ZOOM = 10;</span></pre><p id="1d76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你将得到基本的地图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/3538b6d107d840d81491c871d96c6cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XNATVFvnaECTYMkDQ4q2xw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Initial map</figcaption></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="b823" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">在GraphCMS中管理旅行地点列表</h1><p id="e52f" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">要开始使用GraphCMS，首先你需要一个帐户，有一个免费层，可以很容易地注册我们的演示。如果您已经有一个帐户，那么您可以使用它登录。</p><h2 id="c26c" class="np mo iq bd mp nv nw dn mt nx ny dp mx lf nz oa mz lj ob oc nb ln od oe nd of bi translated">在GraphCMS中创建新项目</h2><p id="6564" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">登录后，您必须创建一个新项目。我们将手动创建，因此转到GraphCMS <a class="ae kv" href="https://app.graphcms.com/" rel="noopener ugc nofollow" target="_blank"> </a>仪表板并选择Create new project。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/f429b66481eb140742ee1e4f92c855a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHPAxSw80F2j683ZSsLRig.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Creating a new project</figcaption></figure><p id="a33d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您必须输入名称和描述:</p><p id="f945" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">姓名</strong>:我的旅行遗愿清单</p><p id="bf3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">描述</strong>:我想去旅游的地点。</p><p id="8b2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择下图所示的区域，用于存储该区域的数据。为了方便起见，请选择您附近的地区。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/c7866d3d985c8227e79199be9b46565c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ng1Wq_K8EkSK49A4Dam4Rw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Configure a new project</figcaption></figure><p id="641e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择您所在的地区后，单击创建项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/ec57f71d35fe574c69f5d200b6b818b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCcomlvwWauC5dreYQKj3Q.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Personal plans</figcaption></figure><p id="9ef9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在GraphCMS中创建新的内容模型</p><p id="6c3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在GraphCMS中，内容模型是一种特定类型的数据，包含与之相关联的特定属性。在我们的例子中，我们的模型是一个目的地，我们可以通过名称和位置来定义。</p><p id="cfa3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后转到左边栏中GraphCMS的Schema部分并选择Create Model。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/2c9ea3a884bebe8f633b33634c3a3dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MuDJ3f_5yRNYZYXaDIQqsg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Creating a new schema</figcaption></figure><p id="56e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选中后，您将看到一个弹出窗口，要求提供更多信息。您可以在那里输入“目的地”作为<strong class="ky ir">显示名称</strong>，但这是可选的，不是必需的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/6eb8a2ad3f97ea0d7f4be02db23432a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bz0JqEZZ7Tqv3CXillpkkw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Creating a new model</figcaption></figure><p id="9c1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后想加描述就加描述，不重要。然后选择创建模型。</p><p id="5de7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了带有属性的模型，然后在右边的字段列表中选择单个文本，并添加一个显示名称“Name”。这将生成一个应用程序Id。然后单击创建。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/a3c20ac69d8cfcdbc9dd779463d5cece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arJo9d0y4j8pTfYgoiZ8cg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Adding and configuring a new text field</figcaption></figure><p id="abe6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，向下滚动位置并选择地图。添加“位置”作为显示名称，并将应用程序Id设置为“位置”，然后单击创建。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/19aeae9326c721827f099faf2ffb6931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5jH2HB3FU85fpI6RkLc7yQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Adding and configuring new map field</figcaption></figure><p id="da2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们有一个内容模型，用于创建我们位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/a214fba57fc5723993748c3e01b69275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hhrfCr3okhs3WMne-SB39g.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Destination content model</figcaption></figure><p id="00b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建我们的位置</p><p id="85df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们创建我们的位置。转到GraphCMS仪表板中的内容和系统下的选定目标，然后新建。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/edfe37038ddc4d2720e2552a61847335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_h7wxa2s_L_LUL1gNbrgQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Creating a new destination content</figcaption></figure><p id="8e4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们必须开始添加所有的位置。首先在名称字段中添加您所在位置的名称，然后在位置下添加搜索框以在地图上查找该位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/f6adac931c18a871ad53ffe9ed39399c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHREGPx1ISUaSX-ZUGjo6A.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Adding a new destination content</figcaption></figure><p id="a790" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后保存并发布。现在，您已经成功创建了您的第一个位置。</p><p id="ab71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">按照同样的步骤，根据需要创建多个位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/8c05a3256552fe54675cb612b6c313a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LcOT7yRtZPOh-Vv2UgDRHQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">List of destination content items</figcaption></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="de35" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">用GraphQL查询我们的数据位置</h1><p id="5196" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在我们有了我们的位置，让我们现在使用数据。</p><h2 id="1927" class="np mo iq bd mp nv nw dn mt nx ny dp mx lf nz oa mz lj ob oc nb ln od oe nd of bi translated">给Gatsby添加一个插件来查询我们的GraphQL数据</h2><p id="673f" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">第一步，我们必须向Gatsby项目添加一个新插件来查询GraphQL数据。在您的终端中运行以下代码:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="b01c" class="np mo iq nl b gy nq nr l ns nt">yarn add gatsby-source-graphql<br/># or<br/>npm install gatsby-source-graphql</span></pre><p id="0fb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来打开项目中的<strong class="ky ir"> gatsby-config.js </strong>文件，并将以下内容添加到插件中:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="c831" class="np mo iq nl b gy nq nr l ns nt">{<br/>  resolve: 'gatsby-source-graphql',<br/>  options: {<br/>    typeName: 'GCMS',<br/>    fieldName: 'gcms',<br/>    url: '[API ENDPOINT]',<br/>  }<br/>}</span></pre><h2 id="857a" class="np mo iq bd mp nv nw dn mt nx ny dp mx lf nz oa mz lj ob oc nb ln od oe nd of bi translated">为GraphCMS寻找我们的API端点</h2><p id="808a" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">打开浏览器，导航到GraphCMS项目，在左侧导航栏中选择Settings，然后选择API Access。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/db00450f84f92d64ac05a6c8fc4bc34a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxjkXry4IdmcfYhxg2C_Yg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">API Access</figcaption></figure><p id="6806" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们必须在复制以前的代码之前更新我们的权限，所以我们必须查询我们的API。在<strong class="ky ir">公共API权限</strong>下，勾选<strong class="ky ir">内容</strong>旁边的复选框，点击<strong class="ky ir">保存</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/2a97b8176aa308921408e410123763ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnFjmm_a11AmHI5QzYbuZA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Configure API Access</figcaption></figure><p id="a16c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在复制端点下的URL:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/481c23e39aa0870574aff4a20c2ef456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTJrXycRU7IiBEyYHWMSgg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Copying API Endpoints</figcaption></figure><p id="45bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并将其粘贴到您的<strong class="ky ir"> gatsby-config.js </strong>文件中:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="97f2" class="np mo iq nl b gy nq nr l ns nt">{<br/>  resolve: 'gatsby-source-graphql',<br/>  options: {<br/>    typeName: 'GCMS',<br/>    fieldName: 'gcms',<br/>    url: 'https://[region-id].graphcms.com/v2/[project-id]/master',<br/>  },<br/>},</span></pre><p id="5c45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在保存<strong class="ky ir"> gatsby-config.js </strong>文件并启动开发服务器。</p><h2 id="26a4" class="np mo iq bd mp nv nw dn mt nx ny dp mx lf nz oa mz lj ob oc nb ln od oe nd of bi translated">通过GraphQL查询我们的位置</h2><p id="0362" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在，我们将查询我们的数据，并能够在我们的应用程序中使用它。</p><p id="d486" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们必须创建一个新的<a class="ae kv" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank"> React Hook </a>来抓取我们在应用程序中的任何位置。</p><p id="ff8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<strong class="ky ir"> src/hooks/index.js </strong>中，将以下代码添加到现有列表中:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="c82a" class="np mo iq nl b gy nq nr l ns nt">export { default as useDestinations }</span></pre><p id="c95d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在<strong class="ky ir"> src/hooks </strong>中，创建一个新文件<strong class="ky ir"> useDestinations.js </strong>并粘贴以下代码:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="36db" class="np mo iq nl b gy nq nr l ns nt">import { graphql, useStaticQuery } from 'gatsby';<br/><br/>export default function useDestinations() {<br/>  const { gcms = {} } = useStaticQuery( graphql`<br/>    query {<br/>      gcms {<br/>        destinations {<br/>          id<br/>          name<br/>          location {<br/>            latitude<br/>            longitude<br/>          }<br/>        }<br/>      }<br/>    }<br/>  ` );<br/><br/>  let { destinations } = gcms;<br/><br/>  return {<br/>    destinations,<br/>  };<br/>}</span></pre><p id="0d91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在转到您的<strong class="ky ir"> src/pages/index.js </strong>文件并导入我们的新钩子:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="0709" class="np mo iq nl b gy nq nr l ns nt">import { useDestinations } from 'hooks';</span></pre><p id="4068" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在转到<strong class="ky ir"> IndexPage </strong>组件并查询我们的数据:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="e901" class="np mo iq nl b gy nq nr l ns nt">const { destinations } = useDestinations();</span></pre><p id="2729" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将在destinations变量中生成所有位置。我们可以通过登录控制台对此进行测试:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="c67d" class="np mo iq nl b gy nq nr l ns nt">console.log('destinations', destinations);</span></pre><p id="5c6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在打开你的浏览器，看看开发者控制台，你可以看到我们的位置数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/2f73e4ff4dc8caba58bc24804ab10b00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPxjsQ91bZo2x-lD2ZFx4Q.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Gatsby Initial map</figcaption></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="6382" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">为目的地创建一个清单，并添加到我们的地图</h1><p id="3087" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在，我们将开始创建一个简单的目的地列表。</p><h2 id="cfef" class="np mo iq bd mp nv nw dn mt nx ny dp mx lf nz oa mz lj ob oc nb ln od oe nd of bi translated">创建我们目的地的文本列表</h2><p id="a2be" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">导航到我们的<strong class="ky ir">索引页面</strong>并添加以下代码:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="9f00" class="np mo iq nl b gy nq nr l ns nt">&lt;h2&gt;My Destinations&lt;/h2&gt;<br/>&lt;ul&gt;<br/>  { destinations.map(destination =&gt; {<br/>    const { id, name } = destination;<br/>    return &lt;li key={id}&gt;{ name }&lt;/li&gt;<br/>  })}<br/>&lt;/ul&gt;</span></pre><p id="7fd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后保存并重新加载，我们将在地图中看到我们的列表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/a7e4575423a1a43e81e043718c24895a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1SgeJdm8WNMRuq5_jtoLg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Marker for each destination</figcaption></figure><p id="d06b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在打开<strong class="ky ir">src/assets/style sheets/pages/_ home . scss</strong>并在。<strong class="ky ir"> home-start </strong> class:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="9451" class="np mo iq nl b gy nq nr l ns nt">.home-start {<br/><br/>  ...<br/><br/>  ul {<br/>    list-style: none;<br/>    padding: 0;<br/>    margin: 1.2em 0;<br/>  }</span></pre><p id="ac5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后修改<strong class="ky ir"> h2 </strong>使之稍微好一点:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="2f18" class="np mo iq nl b gy nq nr l ns nt">.home-start {<br/><br/>  ...<br/><br/>  h2 {<br/><br/>    margin-top: 2em;<br/><br/>    &amp;:first-child {<br/>      margin-top: 0;<br/>    }<br/><br/>  }</span></pre><p id="3942" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后保存并重新加载，现在看起来是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/fe01beb42ab27365fbb4c91e0039e127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcaRFDEtegrQE4ENvIp4Rg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Popup for each destination</figcaption></figure><h2 id="759f" class="np mo iq bd mp nv nw dn mt nx ny dp mx lf nz oa mz lj ob oc nb ln od oe nd of bi translated">将我们的目的地添加到地图</h2><p id="71de" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在我们必须将我们的目的地添加到地图上。</p><p id="3570" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导航到你的<strong class="ky ir"> &lt;地图&gt; </strong>组件，我们已经有了一个<strong class="ky ir"> &lt;标记&gt; </strong>。这用于在地图的给定位置添加标记。</p><p id="fcaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将以下代码添加到<strong class="ky ir"> &lt;地图&gt; </strong>部分:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="d571" class="np mo iq nl b gy nq nr l ns nt">&lt;Map {...mapSettings}&gt;<br/>  { destinations.map(destination =&gt; {<br/>    const { id, name, location } = destination;<br/>    const position = [location.latitude, location.longitude];<br/>    return &lt;Marker key={id} position={position} /&gt;<br/>  })}<br/>&lt;/Map&gt;</span></pre><p id="d02c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们必须为每个标记添加一个弹出窗口来显示名称。</p><p id="2d9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们必须从<strong class="ky ir">反应-传单</strong>中导入<strong class="ky ir">弹出菜单</strong>:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="79a5" class="np mo iq nl b gy nq nr l ns nt">import { Marker, Popup } from 'react-leaflet';</span></pre><p id="802f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在我们的<strong class="ky ir"> &lt;标记&gt; </strong>组件中添加以下代码进行返回:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="c8fe" class="np mo iq nl b gy nq nr l ns nt">return (<br/>  &lt;Marker key={id} position={position}&gt;<br/>    &lt;Popup&gt;{ name }&lt;/Popup&gt;<br/>  &lt;/Marker&gt;<br/>);</span></pre><p id="3f6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后保存并打开我们的地图，点击每个标记来查看我们的目的地名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/b8fa57280d35ec4d9bb9a51157644889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHNmdGmgKf3-qm9Sw9DgAA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Final demo</figcaption></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="4327" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">结论</h1><p id="6a0b" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我希望你玩得开心。这个应用程序给你所有你环游世界的目的地。您还可以在此应用程序中添加更多样式和功能。</p><p id="f88a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>