<html>
<head>
<title>How to build a reusable layout component in Svelte</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Svelte中构建一个可重用的布局组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-reusable-svelte-components-for-your-page-layouts-9593b1a60b08?source=collection_archive---------4-----------------------#2020-09-18">https://javascript.plainenglish.io/create-reusable-svelte-components-for-your-page-layouts-9593b1a60b08?source=collection_archive---------4-----------------------#2020-09-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/29acff6ca8ebbd5af067eb40cf881cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dep8tN9fhp33qquHoIJ0gQ.gif"/></div></div></figure><h2 id="bc18" class="iw ix iy bd b dl iz ja jb jc jd je dk jf translated" aria-label="kicker paragraph">苗条的</h2><div class=""/><div class=""><h2 id="96f0" class="pw-subtitle-paragraph ke jh iy bd b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dk translated">在几行代码中，您可以拥有一个将在页面中实际使用的组件</h2></div><p id="bcd0" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">在本教程中，我们将实现一个苗条的组件，作为我们项目的页面结构。</p><p id="9ef3" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">当我们的页面有相似的布局，并且我们想对内容滚动做出反应时，它就派上用场了。</p><p id="989d" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">我们将在此构建的结构由以下部分组成:</p><ul class=""><li id="ef4f" class="ls lt iy ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ji">主要内容</strong>:可滚动</li><li id="c64b" class="ls lt iy ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ji">页眉</strong>:固定在页面顶部</li><li id="d6c0" class="ls lt iy ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ji">页脚</strong> : <strong class="ky ji"> </strong>固定在页面底部</li></ul><p id="0fa6" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">显然，我们可以根据自己的需要调整组件。如果您只想要完整的组件代码，可以跳到最后。</p><h1 id="256b" class="mg mh iy bd mi mj mk ml mm mn mo mp mq kn mr ko ms kq mt kr mu kt mv ku mw mx bi translated">添加页眉和页脚</h1><p id="12a7" class="pw-post-body-paragraph kw kx iy ky b kz my ki lb lc mz kl le lf na lh li lj nb ll lm ln nc lp lq lr ig bi translated">我们开始添加主要内容布局。这是由一个“主”元素和一个插槽组成的。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="0b00" class="nm mh iy ni b gy nn no l np nq">&lt;main bind:this={main} class:header class:footer&gt;<br/>  &lt;<strong class="ni ji">slot</strong>/&gt;<br/>&lt;/main&gt;</span></pre><p id="7917" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">接下来，我们将添加容纳页眉和页脚的容器:我们保留了内容的主槽，所以我们现在需要添加两个命名槽(“页眉”和“页脚”)。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a4b6" class="nm mh iy ni b gy nn no l np nq">&lt;div class="slotHeader"&gt;<br/>  &lt;<strong class="ni ji">slot </strong>name="header"/&gt;<br/>&lt;/div&gt;</span><span id="8cae" class="nm mh iy ni b gy nr no l np nq">&lt;div class="slotFooter"&gt;<br/>  &lt;<strong class="ni ji">slot </strong>name="footer"/&gt;<br/>&lt;/div&gt;</span></pre><p id="fea5" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">在“script”标签中，我们现在声明:</p><ul class=""><li id="0b85" class="ls lt iy ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">“主”变量，它将被绑定到“主”元素</li><li id="b1d9" class="ls lt iy ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">必要的属性“页眉”和“页脚”，指示它们是否存在</li><li id="d15b" class="ls lt iy ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">和他们的身高，默认为64</li></ul><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="a547" class="nm mh iy ni b gy nn no l np nq">&lt;script&gt;<br/>  <strong class="ni ji">let </strong>main;</span><span id="7a94" class="nm mh iy ni b gy nr no l np nq">  <strong class="ni ji">export let</strong> header = false;<br/>  <strong class="ni ji">export let</strong> headerHeight = 64;</span><span id="5454" class="nm mh iy ni b gy nr no l np nq">  <strong class="ni ji">export let</strong> footer = false;<br/>  <strong class="ni ji">export let </strong>footerHeight = 64;<br/>&lt;/script&gt;</span></pre><p id="6b7c" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">我们还对属性变化做出反应，为高度设置正确的CSS变量。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="d45f" class="nm mh iy ni b gy nn no l np nq"><strong class="ni ji">$:</strong> if(main) {<br/>  main.style.setProperty('--header-height', headerHeight + 'px');<br/>  main.style.setProperty('--footer-height', footerHeight + 'px');<br/>}</span></pre><p id="94f2" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">现在，在“样式”标签中，我们根据属性填充内容，并固定页面中的页眉和页脚。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="fa51" class="nm mh iy ni b gy nn no l np nq">&lt;style&gt;<br/>  main {<br/>    height: 100%;<br/>    overflow-y: auto;<br/>  }</span><span id="8c54" class="nm mh iy ni b gy nr no l np nq">  main.header {<br/>    padding-top: var(--header-height, 0px);<br/>  }</span><span id="d15e" class="nm mh iy ni b gy nr no l np nq">  main.footer {<br/>    padding-bottom: var(--footer-height, 0px);<br/>  }</span><span id="710f" class="nm mh iy ni b gy nr no l np nq">  .slotHeader {<br/>    position: fixed;<br/>    top: 0px;<br/>    left: 0px;<br/>    width: 100%;<br/>  }</span><span id="0c5a" class="nm mh iy ni b gy nr no l np nq">  .slotFooter {<br/>    position: fixed;<br/>    bottom: 0px;<br/>    left: 0px;<br/>    width: 100%;<br/>  }<br/>&lt;/style&gt;</span></pre><p id="6607" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated"><strong class="ky ji">完整代码</strong></p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="84a3" class="nm mh iy ni b gy nn no l np nq">&lt;main bind:this={main} class:header class:footer&gt;<br/>  &lt;<strong class="ni ji">slot</strong>/&gt;<br/>&lt;/main&gt;</span><span id="d071" class="nm mh iy ni b gy nr no l np nq">&lt;div class="slotHeader"&gt;<br/>  &lt;<strong class="ni ji">slot </strong>name="header"/&gt;<br/>&lt;/div&gt;</span><span id="3b14" class="nm mh iy ni b gy nr no l np nq">&lt;div class="slotFooter"&gt;<br/>  &lt;<strong class="ni ji">slot </strong>name="footer"/&gt;<br/>&lt;/div&gt;</span><span id="da15" class="nm mh iy ni b gy nr no l np nq">&lt;script&gt;<br/>  <strong class="ni ji">let </strong>main;</span><span id="2506" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">  export let</strong> header = false;<br/>  <strong class="ni ji">export let</strong> headerHeight = 64;</span><span id="63a7" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">  export let</strong> footer = false;<br/>  <strong class="ni ji">export let </strong>footerHeight = 64;</span><span id="0a31" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">  $:</strong> if(main) {<br/>    main.style.setProperty('--header-height', headerHeight + 'px');<br/>    main.style.setProperty('--footer-height', footerHeight + 'px');<br/>  }<br/>&lt;/script&gt;</span><span id="b2ec" class="nm mh iy ni b gy nr no l np nq">&lt;style&gt;<br/>  main {<br/>    height: 100%;<br/>    overflow-y: auto;<br/>  }</span><span id="b537" class="nm mh iy ni b gy nr no l np nq">  main.header {<br/>    padding-top: var(--header-height, 0px);<br/>  }</span><span id="b3cd" class="nm mh iy ni b gy nr no l np nq">  main.footer {<br/>    padding-bottom: var(--footer-height, 0px);<br/>  }</span><span id="0aa2" class="nm mh iy ni b gy nr no l np nq">  .slotHeader {<br/>    position: fixed;<br/>    top: 0px;<br/>    left: 0px;<br/>    width: 100%;<br/>  }</span><span id="890c" class="nm mh iy ni b gy nr no l np nq">  .slotFooter {<br/>    position: fixed;<br/>    bottom: 0px;<br/>    left: 0px;<br/>    width: 100%;<br/>  }<br/>&lt;/style&gt;</span></pre></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><h1 id="170c" class="mg mh iy bd mi mj nz ml mm mn oa mp mq kn ob ko ms kq oc kr mu kt od ku mw mx bi translated">听卷轴</h1><p id="9352" class="pw-post-body-paragraph kw kx iy ky b kz my ki lb lc mz kl le lf na lh li lj nb ll lm ln nc lp lq lr ig bi translated">假设我们希望当用户滚动内容时隐藏和显示标题，就像在<a class="ae oe" href="https://kstatic.googleusercontent.com/files/60e734664455ce42d79267bdc7f7dd20239ea2086102e302e0d8c3e255b639faddbbbeaf75ceb9ac3fb2f1f14451f937427eabaf6aa028bcd4a3bd80504e68b2" rel="noopener ugc nofollow" target="_blank"> Material Design的应用程序栏</a>中一样。</p><p id="92ea" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">为了实现这一点，我们必须监听主内容滚动事件，并计算标题是否以及何时隐藏。这同样适用于页脚。</p><p id="886a" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">在布局中，编辑“主”元素。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="8a48" class="nm mh iy ni b gy nn no l np nq">&lt;main bind:this={main} class:header class:footer <strong class="ni ji">on:scroll={Scroll}</strong>&gt;</span></pre><p id="ddf2" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">以及页眉和页脚容器。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="2ff7" class="nm mh iy ni b gy nn no l np nq">&lt;div class="slotHeader" <strong class="ni ji">class:hide={hideHeader &amp;&amp; scroller.hide}</strong>&gt;<br/>  &lt;slot name="header"/&gt;<br/>&lt;/div&gt;</span><span id="3f1d" class="nm mh iy ni b gy nr no l np nq">&lt;div class="slotFooter" <strong class="ni ji">class:hide={hideFooter &amp;&amp; scroller.hide}</strong>&gt;<br/>  &lt;slot name="footer"/&gt;<br/>&lt;/div&gt;</span></pre><p id="47f7" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">在“script”标签中，我们必须声明几个新变量:</p><ul class=""><li id="081c" class="ls lt iy ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">滚动数据</li><li id="d2cb" class="ls lt iy ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">阈值，在此之后隐藏页眉和页脚</li><li id="8a9a" class="ls lt iy ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">以及页眉和页脚是否可以在滚动时隐藏</li></ul><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="74e4" class="nm mh iy ni b gy nn no l np nq"><strong class="ni ji">let </strong>scroller = {<br/>  scroll: 0,<br/>  direction: true, // true: scroll down; false: scroll up<br/>  delta: 0,<br/>  hide: false,<br/>  initialScroll: 0<br/>};</span><span id="a2cf" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">export let</strong> threshold = 64;<br/><strong class="ni ji">export let</strong> hideHeader = false;<br/><strong class="ni ji">export let</strong> hideFooter = false;</span></pre><p id="5642" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">然后，我们添加用于计算当前值的“Scroll”函数。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="0b6a" class="nm mh iy ni b gy nn no l np nq"><strong class="ni ji">const </strong>Scroll = <em class="of">e</em> =&gt; {<br/>  <strong class="ni ji">const</strong> scroll = e.target.scrollTop;<br/>  <br/>  scroller = {<br/>    scroll,<br/>    direction: scroll &gt; scroller.scroll,<br/>    delta: scroll - scroller.initialScroll,<br/>    hide: scroll &gt; threshold &amp;&amp; scroller.hide<br/>      ? scroll - scroller.initialScroll &gt; -threshold<br/>      : scroll - scroller.initialScroll &gt; threshold,<br/>    initialScroll: (scroll &gt; scroller.scroll) != scroller.direction<br/>      ? scroll<br/>      : scroller.initialScroll<br/>  };<br/>};</span></pre><p id="1676" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">最后，我们编辑“style”标签来激活隐藏的页眉和页脚。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="3701" class="nm mh iy ni b gy nn no l np nq">.slotHeader {<br/>  // previous code<br/>  <strong class="ni ji">transition: all .2s ease-in-out;</strong><br/>}</span><span id="69a5" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">.slotHeader.hide {<br/>  transform: translateY(-100%);<br/>}</strong></span><span id="4628" class="nm mh iy ni b gy nr no l np nq">.slotFooter {<br/>  // previous code<br/>  <strong class="ni ji">transition: all .2s ease-in-out;<br/></strong>}</span><span id="d62d" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">.slotFooter.hide {<br/>  transform: translateY(100%);<br/>}</strong></span></pre><h1 id="d8aa" class="mg mh iy bd mi mj mk ml mm mn mo mp mq kn mr ko ms kq mt kr mu kt mv ku mw mx bi translated">使用父级中的滚动条</h1><p id="346e" class="pw-post-body-paragraph kw kx iy ky b kz my ki lb lc mz kl le lf na lh li lj nb ll lm ln nc lp lq lr ig bi translated">将scroller对象暴露给父对象，我们可以使用它在滚动时给header元素添加阴影，或者使其他页面元素显示或隐藏。</p><p id="8998" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">我们可以通过三种方式做到这一点，我建议你全部实施。</p><h2 id="2d6f" class="nm mh iy bd mi og oh dn mm oi oj dp mq lf ok ol ms lj om on mu ln oo op mw je bi translated">导出滚动条属性</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="daff" class="nm mh iy ni b gy nn no l np nq"><strong class="ni ji">export let </strong>scroller = {...};</span></pre><p id="1966" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">这样你可以绑定:scroller在你的父节点上。</p><h2 id="ea42" class="nm mh iy bd mi og oh dn mm oi oj dp mq lf ok ol ms lj om on mu ln oo op mw je bi translated">老虎机道具</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="0ee4" class="nm mh iy ni b gy nn no l np nq">&lt;main bind:this={main} class:header class:footer on:scroll={Scroll}&gt;<br/>  &lt;slot <strong class="ni ji">{scroller}</strong>/&gt;<br/>&lt;/main&gt;</span></pre><p id="3e0c" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">这样，您可以让:scroller进入您的父组件，并在布局组件中使用它。</p><h2 id="76e0" class="nm mh iy bd mi og oh dn mm oi oj dp mq lf ok ol ms lj om on mu ln oo op mw je bi translated">事件调度</h2><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="5c7a" class="nm mh iy ni b gy nn no l np nq"><strong class="ni ji">import </strong>{createEventDispatcher} <strong class="ni ji">from </strong>"svelte";</span><span id="c685" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">const </strong>dispatch = createEventDispatcher();</span><span id="377d" class="nm mh iy ni b gy nr no l np nq"><strong class="ni ji">const </strong>Scroll = <em class="of">e</em> =&gt; {<br/>  // previous code<br/>  <strong class="ni ji">dispatch('scroller', scroller);</strong><br/>};</span></pre><p id="e5ab" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">通过这种方式，您可以将on:scroller事件添加到parent中，并可能设置为一个变量。</p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><h1 id="a871" class="mg mh iy bd mi mj nz ml mm mn oa mp mq kn ob ko ms kq oc kr mu kt od ku mw mx bi translated">完整的代码和用法示例</h1><div class="im in gp gr io oq"><a href="https://svelte.dev/repl/887cda7ab914489e87c45b997b1345cd" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ji gy z fp ov fr fs ow fu fw jh bi translated">布局组件REPL</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">控制论增强的网络应用</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">苗条的人</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe iu oq"/></div></div></a></div></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><h1 id="51bc" class="mg mh iy bd mi mj nz ml mm mn oa mp mq kn ob ko ms kq oc kr mu kt od ku mw mx bi translated">结论</h1><p id="1ae8" class="pw-post-body-paragraph kw kx iy ky b kz my ki lb lc mz kl le lf na lh li lj nb ll lm ln nc lp lq lr ig bi translated">如果你有任何问题或建议，请随意写评论。</p><p id="8fd1" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">谢谢大家，关注我更多文章！</p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="91a4" class="pw-post-body-paragraph kw kx iy ky b kz la ki lb lc ld kl le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">以下是我的一些其他文章:</p><div class="im in gp gr io oq"><a href="https://medium.com/javascript-in-plain-english/how-to-create-a-router-in-svelte-ce66c10275fe" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ji gy z fp ov fr fs ow fu fw jh bi translated">如何创建一个苗条的路由器</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">我们可以避免不必要的包装</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">medium.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe iu oq"/></div></div></a></div><div class="im in gp gr io oq"><a href="https://medium.com/javascript-in-plain-english/diy-multilanguage-in-javascript-project-65f8aa91a506" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ji gy z fp ov fr fs ow fu fw jh bi translated">JavaScript项目中的DIY多语言</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">让我们用这个简单的方法来国际化我们的webapp</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">medium.com</p></div></div><div class="oz l"><div class="pg l pb pc pd oz pe iu oq"/></div></div></a></div></div></div>    
</body>
</html>