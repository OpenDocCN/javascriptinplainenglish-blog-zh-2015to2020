<html>
<head>
<title>Cypress and Mobile Apps?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Cypress和移动应用？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/easy-mobile-app-automated-tests-509e9cde311f?source=collection_archive---------3-----------------------#2020-03-16">https://javascript.plainenglish.io/easy-mobile-app-automated-tests-509e9cde311f?source=collection_archive---------3-----------------------#2020-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5a4e9d68e0cd746328512f6eb5b41736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ro2gZ3FzG6UT_O6lXp-ygw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">What mobile app testing feels like. Ow. (Pen and paper? Seriously? :) ) Photo by <a class="ae kc" href="https://unsplash.com/@freestocks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">freestocks</a> on <a class="ae kc" href="https://unsplash.com/s/photos/testing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="72fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设置移动应用的自动化测试是很棘手的。也许你在做一个小项目，而你的Jest + Enzyme单元测试没有给你想要的ROI。也许你想测试网络错误场景或时间敏感的逻辑，但是在你当前的应用框架中没有这样做的方法。你在web开发领域的朋友告诉你关于Cypress的事情，但是他们没有一个React-Native移动应用程序可以测试。</p><p id="6c3d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一种方法可以弥补这个差距，并且不需要重新构建你的应用。在这篇文章中，我展示了如何将最好的web应用程序测试应用到React-Native移动应用程序中，并提供了一些技巧和窍门。</p><h1 id="2d36" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">柏树</h1><p id="add2" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">(Cypress是一个面向开发的<strong class="kf ir"> web-app </strong>端到端集成测试工具。在<a class="ae kc" href="https://docs.cypress.io/guides/overview/why-cypress.html" rel="noopener ugc nofollow" target="_blank">的Cypress.io文档</a>中阅读更多信息</p><p id="2b26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在为web应用程序选择e2e测试解决方案时，我们会面临这样的问题“我应该选择基于Selenium的工具，还是应该选择Cypress？”这是一个错误的二分法——尽管他们都测试web应用程序，但他们解决不同的问题。<strong class="kf ir">听听Cypress.io docs在FAQ板块给出的答案:</strong></p><blockquote class="mf mg mh"><p id="0945" class="kd ke lb kf b kg kh ki kj kk kl km kn mi kp kq kr mj kt ku kv mk kx ky kz la ij bi translated">… Cypress可能无法在您不做任何改变的情况下为您提供100%的覆盖，但这没关系。使用不同的工具测试应用程序中不太容易访问的部分，让Cypress测试其余的99%。(<a class="ae kc" href="https://docs.cypress.io/faq/questions/general-questions-faq.html#We-have-the-most-complex-most-outrageous-authentication-system-ever-will-Cypress-work-with-that" rel="noopener ugc nofollow" target="_blank">来自Cypress.io常见问题</a>)</p></blockquote><p id="8d09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你是帕累托法则(或多或少“20%的努力，80%的结果”)的粉丝，你会开始看到柏树的吸引力。如果您的需求要求最后20%的结果(跨平台/跨浏览器、跨来源、多标签等)。)，没有人阻止你拿起硒来覆盖赛普拉斯无法解决的案件。(我发现软件测试与经济和投资回报率的关系比软件更大，但是<a class="ae kc" href="https://medium.com/javascript-in-plain-english/testing-react-hooks-be74ec3fc0c4" rel="noopener">那是另外一篇文章</a></p><p id="a50d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">简而言之:Cypress是关于从你的测试中获得更多的ROI。</strong></p><p id="054b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(更不用说Cypress解锁的强大嘲讽能力——<a class="ae kc" href="https://medium.com/javascript-in-plain-english/mocking-request-body-in-cypress-4592c971231f" rel="noopener">个人非常喜欢网络请求-响应嘲讽功能</a>)</p><p id="7baa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果在测试您的移动应用程序时，您也能获得同样的理念和能力，那不是很好吗？</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="d0df" class="lc ld iq bd le lf ms lh li lj mt ll lm ln mu lp lq lr mv lt lu lv mw lx ly lz bi translated">反应本地Web</h1><p id="1be2" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">还记得帕累托原理吗？它是React本地项目的核心。编写一次应用程序，获得2个平台的大部分结果:iOS和Android。React Native Web又增加了一个平台:浏览器。React本机Web“技巧”使用react-dom将本机应用程序反应为在浏览器中呈现。当然，并不是所有的移动API都可以在Web中实现，但是看看<a class="ae kc" href="https://github.com/necolas/react-native-web#compatibility-with-react-native" rel="noopener ugc nofollow" target="_blank">这个令人敬畏的兼容性表</a>——你可能会惊讶于它的翻译量。还是那句话，20%的努力，80%的结果:帕累托法则。</p><p id="1e53" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有React原生app吗？现在你可以在浏览器<strong class="kf ir">中运行它，并用Cypress </strong>测试用户流量。手机app，满足稳定、经济、强大的高水平自动化测试。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="953e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“这是否意味着我也必须维护一个完整的web版本”，你问？"我的意思是，维护所有这些屏幕尺寸和操作系统已经够困难的了！"我完全同意。但是，请记住帕累托原则:<em class="lb">你不必为了获得大部分结果而全力以赴</em>。考虑一下关于你的新网页版本的想法:</p><ul class=""><li id="9d2c" class="mx my iq kf b kg kh kk kl ko mz ks na kw nb la nc nd ne nf bi translated"><strong class="kf ir">它不必见天日</strong>。顾客永远不需要知道它的存在。把它当成你、你的应用和Cypress之间的秘密。</li><li id="061c" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated"><strong class="kf ir">不一定要漂亮</strong>。它只需要基本上工作。</li><li id="5027" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated"><strong class="kf ir">不一定要全功能奇偶性</strong>。但是，您可以在网页版中保留的功能可以进行测试。</li></ul><p id="3f07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，就像在“Selenium vs. Cypress”问题中一样，<strong class="kf ir">它不必完全取代您现有的工具</strong>。使用Cypress来测试和模拟您的功能边缘案例和流程，如果需要的话，使用其他工具来覆盖您的特定于平台的功能。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="eb6b" class="lc ld iq bd le lf ms lh li lj mt ll lm ln mu lp lq lr mv lt lu lv mw lx ly lz bi translated">我的证明</h1><p id="468c" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">一年前，我将我的副项目应用重构为3个项目:1个共享redux项目、一个Expo.io应用和一个knee cap web应用。我厌倦了通过React Native Web发布带有beta web支持的Expo版本33(是的，我记得发布号),我很激动。不久之后，我有了一个web和移动代码库。(这是一个附带项目，所以我还是部署了网络版。)</p><p id="5c5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我不得不放入一些特定于平台的逻辑来禁用一些功能，但我能够解锁Cypress测试。对于一个副业项目，传统的应用程序测试框架非常复杂/昂贵，Jest单元测试只能做到这一步，所以这是自动化测试的游戏规则改变者。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="e8d3" class="lc ld iq bd le lf ms lh li lj mt ll lm ln mu lp lq lr mv lt lu lv mw lx ly lz bi translated">片段</h1><p id="8249" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">您会发现这些package.json“脚本”很有帮助:</p><pre class="np nq nr ns gt nt no nu nv aw nw bi"><span id="94a4" class="nx ld iq no b gy ny nz l oa ob">{<br/>  // ...<br/>  "web:start": "expo start --web-only",<br/>  "web:e2e:ci": "cypress run",<br/>  "web:e2e": "start-server-and-test web:start 19006 web:e2e:ci",<br/>  // ...<br/>}</span></pre><p id="1b21" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(您可以在持续集成或每夜构建中使用<code class="fe nl nm nn no b">yarn web:e2e</code>)</p><p id="c8f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Expo web应用程序是渐进式的web应用程序，一些浏览器端的资产缓存使用服务工作者。虽然这是一个很酷的特性，但是这种缓存有时会干扰您的自动化测试。请尝试使用此代码片段。</p><figure class="np nq nr ns gt jr"><div class="bz fp l di"><div class="oc od l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">clear-service-workers.js, be sure to import this in your cypress/support/index.js file!</figcaption></figure><p id="aae6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你的应用也依赖位置API吗？试着模仿地理定位API。</p><figure class="np nq nr ns gt jr"><div class="bz fp l di"><div class="oc od l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Add this to your cypress/support/commands.js file, use like `cy.mockGeolocation(0, 0)`.</figcaption></figure><h1 id="b80f" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">是时候来点柏树超能力了</h1><p id="f67b" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">时间旅行？(其实只是在浏览器里戳时间功能)查看<a class="ae kc" href="https://docs.cypress.io/api/commands/clock.html" rel="noopener ugc nofollow" target="_blank"> cy.clock() </a>。</p><p id="6b1f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">控制互联网？(实际上，只是在浏览器中掐灭XHR的请求)Cypress有<a class="ae kc" href="https://docs.cypress.io/guides/guides/network-requests.html#Stub-Responses" rel="noopener ugc nofollow" target="_blank">一个伟大的指南</a>，我有<a class="ae kc" href="https://medium.com/javascript-in-plain-english/mocking-request-body-in-cypress-4592c971231f" rel="noopener">一篇有用的文章，以防你在形成回应</a>时需要更多的力量。给自己留一天时间自己想办法解决吧！</p><h1 id="978e" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">那太好了，但是我希望我知道更多关于测试的知识</h1><p id="652b" class="pw-post-body-paragraph kd ke iq kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">我有一个坏习惯，就是在看似具体的文章里教的太多。我关于测试React Hooks的文章讲述了自动化测试的哲学和斗争，以及你在单元测试框架中获得的一些能力。</p><p id="ff28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嘿，你已经读到这里了。不妨。</p><div class="oe of gp gr og oh"><a href="https://medium.com/javascript-in-plain-english/testing-react-hooks-be74ec3fc0c4" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">测试反应挂钩</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">嗯……一般的测试。相信我，图像是有道理的！</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov jw oh"/></div></div></a></div></div></div>    
</body>
</html>