<html>
<head>
<title>Not so obvious removal of diacritics in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中音调符号的去除并不明显</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/not-so-obvious-removal-of-diacritics-in-javascript-explained-and-done-right-52f4aeb3c85?source=collection_archive---------3-----------------------#2020-01-10">https://javascript.plainenglish.io/not-so-obvious-removal-of-diacritics-in-javascript-explained-and-done-right-52f4aeb3c85?source=collection_archive---------3-----------------------#2020-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5af8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">解释清楚，做得对！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bbbab6fc99628470add15052bb51d73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-25KB7EbSHjv70HXrdl6w.png"/></div></div></figure><h1 id="0d51" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">快速介绍</h1><p id="0a02" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">拉丁字母在全世界被广泛使用。它是包括英语在内的许多欧洲语言的基础。事实上，英语字母表基本上与ISO基本拉丁字母相同，由26个字母组成:T0。</p><p id="edea" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">然而，所有其他非英语、拉丁字母都有一些特殊字母<em class="mf"/>。比如德语:<code class="fe mg mh mi mj b">ä, ö, ü, ß</code>波兰语:<code class="fe mg mh mi mj b">ą, ć, ę, ł, ń, ó, ś, ź, ż</code>或者葡萄牙语:<code class="fe mg mh mi mj b">ã, õ, á, é, í, ó, ú, â, ê, ô, à, ç</code>。</p><p id="8dc3" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">基本上，这些是重音字母，音调符号。事实上，如果我们深入研究语言理论，我们会发现有趣的事实，比如:德语中的夏普s字符<code class="fe mg mh mi mj b">ß</code>有时被认为是一个字母或连字。哇哦！？因此，德语单词street: <code class="fe mg mh mi mj b">Straße</code>也可以写成<code class="fe mg mh mi mj b">Strasse</code>——两种拼法都是正确的。</p><p id="a6e2" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">另一个小事实:波兰语<code class="fe mg mh mi mj b">ł</code>(带笔画的l)是一个字母，而不是音调符号！如果你只是说:WAAAT——你感到困惑和惊讶——我也是！今天，当我试图用<code class="fe mg mh mi mj b">l</code>代替<code class="fe mg mh mi mj b">ł</code>时，我发现了这一点——事实上，这也是我决定一劳永逸地定义并解决这个问题的原因之一！</p><p id="3f65" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">好了，以上是对重音字母和连字的简单介绍。我甚至不想经历所有的特例，语言和字母的古怪。基本上，我们想要实现的是一种将特殊字母映射到其最接近的ISO basic拉丁语对等词的方法。就这么简单。我们开始吧。</p><h1 id="b5f0" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">不那么干净的代码</h1><p id="e313" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">干净的代码，谁不喜欢干净的代码？与其使用一些模块或长映射函数，不如让我们看看<a class="ae mp" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize" rel="noopener ugc nofollow" target="_blank"> ECMA脚本2015 </a>规范，并使用一些超级智能的两行程序。现在已经是2020年了，还会有什么问题呢？这个问题并不新鲜。对吗？不对！</p><p id="4613" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">在ES6中我们可以使用<code class="fe mg mh mi mj b">String.prototype.normalize()</code>功能:</p><pre class="kg kh ki kj gt mq mj mr ms aw mt bi"><span id="b4e7" class="mu ks iq mj b gy mv mw l mx my">const str = "Crème Brulée";<br/>const normalized = str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");<br/>console.log(normalized); // Outputs: Creme Brulee</span></pre><p id="0b4e" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">到目前为止，一切顺利。两个字符:<code class="fe mg mh mi mj b">è</code>和<code class="fe mg mh mi mj b">é</code>都被替换为<code class="fe mg mh mi mj b">e</code>。</p><p id="c901" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">让我们检查一下<code class="fe mg mh mi mj b">straße</code> (ger)。街道)或<code class="fe mg mh mi mj b">łokieć</code> (pol。肘部)。以上代码将分别产生:<code class="fe mg mh mi mj b">straße</code>和<code class="fe mg mh mi mj b">łokiec</code>—<code class="fe mg mh mi mj b">ß</code>未被<code class="fe mg mh mi mj b">ss</code>代替，<code class="fe mg mh mi mj b">ł</code>未被<code class="fe mg mh mi mj b">l</code>代替，只是<code class="fe mg mh mi mj b">ć</code>如预期的那样被<code class="fe mg mh mi mj b">c</code>代替。</p><p id="3b3a" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">不幸的是，ES6不是这里的解决方案。</p><h1 id="905a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">不要重新发明轮子</h1><p id="0f8d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们的下一个解决方案是简单地映射特殊字母。这听起来是一个合理的解决方案。然而，在2020年，你会想象这个问题很久以前就已经解决了，不是吗？</p><p id="c32e" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">事实上是。因此，不用担心德语、波兰语、葡萄牙语、法语和许多其他字母，不用重新发明轮子和编写替换发音符号函数，我们只需要寻找一个为我们这样做的npm模块。</p><h1 id="e41f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">NPM</h1><p id="ee47" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">实际上，在我们开始之前，让我们定义一个通用的测试字符串:</p><pre class="kg kh ki kj gt mq mj mr ms aw mt bi"><span id="c0d3" class="mu ks iq mj b gy mv mw l mx my">const str = "Iлｔèｒｎåｔïｏｎɑｌíƶａｔï߀ԉ ą ć ę ł ń ó ś ź ż ä ö ü ß"</span></pre><p id="c772" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">我在谷歌上发现的第一个模块是<a class="ae mp" href="https://www.npmjs.com/package/diacritics" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">发音符号</strong> </a>。它的用法很简单:</p><pre class="kg kh ki kj gt mq mj mr ms aw mt bi"><span id="809d" class="mu ks iq mj b gy mv mw l mx my">const removeDiacritics = require('diacritics').remove;<br/>console.log(removeDiacritics(str));</span><span id="9dae" class="mu ks iq mj b gy mz mw l mx my">// OUTPUTS:<br/>// Internationalizati0n a c e l n o s z z a o u ss</span></pre><p id="4c9c" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">让我们注意两件事:波兰语和德语字母被正确替换了！国际化这个词末尾的第二个字符实际上是<code class="fe mg mh mi mj b">0</code>而不是<code class="fe mg mh mi mj b">o</code>。不伟大，不可怕。</p><p id="f280" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">接下来，搜索列表上是<a class="ae mp" href="https://www.npmjs.com/package/diacritic" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">发音符号</strong> </a>:</p><pre class="kg kh ki kj gt mq mj mr ms aw mt bi"><span id="f08b" class="mu ks iq mj b gy mv mw l mx my">const Diacritics = require('diacritic');<br/>console.log(Diacritics.clean(str));</span><span id="02c1" class="mu ks iq mj b gy mz mw l mx my">// OUTPUTS:<br/>// Internationalization a c e l n o s z z a o u ss</span></pre><p id="8b54" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated"><strong class="ll ir">我们有赢家吗？</strong>看起来是这样，不过我们再检查几个包裹吧。</p><p id="a0db" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">第三位是<a class="ae mp" href="https://www.npmjs.com/package/remove-accents\" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">去除重音</strong> </a>:</p><pre class="kg kh ki kj gt mq mj mr ms aw mt bi"><span id="ad3e" class="mu ks iq mj b gy mv mw l mx my">const removeAccents = require('remove-accents');<br/>console.log(removeAccents(str));</span><span id="85b8" class="mu ks iq mj b gy mz mw l mx my">// OUTPUTS:<br/>// Iлｔeｒｎaｔiｏｎɑｌiƶａｔi߀ԉ a c e l n o s z z a o u ß</span></pre><p id="8588" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">这个看起来只转换音调符号，而不改变字母。</p><p id="977c" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">最后，我们来试试<a class="ae mp" href="https://www.npmjs.com/package/normalize-diacritics" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">归一化-发音符号</strong> </a>:</p><pre class="kg kh ki kj gt mq mj mr ms aw mt bi"><span id="8d03" class="mu ks iq mj b gy mv mw l mx my">const { normalize } = require('normalize-diacritics');<br/>console.log(await normalize(str));</span><span id="e33a" class="mu ks iq mj b gy mz mw l mx my">// OUTPUTS:<br/>// Iлternationɑlizati0ԉ a c e l n o s z z a o u s</span></pre><p id="caca" class="pw-post-body-paragraph lj lk iq ll b lm mk jr lo lp ml ju lr ls mm lu lv lw mn ly lz ma mo mc md me ij bi translated">与其他包相比，这个包做得最差——尤其是，我预计<code class="fe mg mh mi mj b">ß</code>将被<code class="fe mg mh mi mj b">ss</code>取代。</p><h1 id="055b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="1754" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在经历了几种用拉丁字母替换特殊字母的方法后，我建议使用<a class="ae mp" href="https://www.npmjs.com/package/diacritic" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">发音符号</strong> </a> <strong class="ll ir"> </strong>包装。这一个按照我期望的方式正确地替换了字母。</p></div></div>    
</body>
</html>