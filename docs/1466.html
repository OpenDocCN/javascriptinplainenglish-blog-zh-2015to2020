<html>
<head>
<title>Create A Hash Anchor Link Effect With React-Router</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用反应路由器创建哈希锚链接效果</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-a-hash-anchor-link-effect-with-react-router-a63dcb1a9b0e?source=collection_archive---------1-----------------------#2020-03-19">https://javascript.plainenglish.io/creating-a-hash-anchor-link-effect-with-react-router-a63dcb1a9b0e?source=collection_archive---------1-----------------------#2020-03-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/626d945c958fb9a7cb3c5d594d72dca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CPGVDRng2xLTJSzC5J7cpQ.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@flowforfrank?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae jz" href="https://unsplash.com/s/photos/react?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4417" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最近，当我为一个客户开发一个小型的React应用程序时，我被要求创建一个“粘性横幅”，出现在网站的每一页上。该横幅将包含一个链接，将用户从网站的任何地方带到特定页面的特定部分。在非反应应用程序中，像这样的链接可以很容易地使用和锚元素以及href属性来创建。然而，在React中，内部导航不能用锚标签来处理，这让我不得不寻找另一种方式。</p><p id="6ffb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在谷歌上快速搜索是否有一个普遍接受的解决方案后，我发现大多数人似乎都满足于使用额外的库，比如reactor-roll，但我想找到一种方法来使用reactor-router的内置功能来为我工作。这是我发现的！</p><p id="5eb7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为此，我使用了反应路由器的链接组件。我使用导航栏的导航链接来利用它的样式选项，但是链接组件有额外的选项，非常适合这种情况。具体来说，“to: object”选项，如<a class="ae jz" href="https://reacttraining.com/react-router/web/api/Link/to-function" rel="noopener ugc nofollow" target="_blank">反应训练</a>中所述。</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ky"><img src="../Images/9cede0ef39aa806964329c3d683a6542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9U29ZfwttPz72TSu8lj_sw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk"><a class="ae jz" href="https://reacttraining.com/react-router/web/api/Link/to-function" rel="noopener ugc nofollow" target="_blank">https://reacttraining.com/react-router/web/api/Link/to-function</a></figcaption></figure><p id="8e61" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，看看这些选项，您可能会认为我会只使用hash选项，但据我所知，hash选项仅在链接到已经加载的页面部分时有效，而不适用于链接到完全不同的组件。相反，使这个工作的关键是使用状态！一旦我知道有一种方法可以通过我的Link组件传递状态，我就知道在新组件中必须有一种方法可以访问该状态。网站上给出的例子也是如何最好地利用这一发现的完美线索。以下是我对链接组件的实现:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="be13" class="li lj in le b gy lk ll l lm ln">&lt;div className='banner' onClick={this.handleScroll} &gt;                  <br/>  &lt;Link className='banner-link' to={{                             <br/>    pathname: '/designs',                    <br/>      state: {                        <br/>        fromBanner: true                    <br/>      }                <br/>    }}                <br/>  &gt;                    <br/>    ULTIMATE &amp;nbsp; WEDDING &amp;nbsp; PACKAGE                 <br/>  &lt;/Link&gt;            <br/>&lt;/div&gt;</span></pre><p id="272f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过状态<code class="fe lo lp lq le b">fromBanner: true</code>后，我需要做的就是检查我链接的组件中的状态，然后从那里采取适当的动作。然而，即使我发送“状态”，这个状态也不会是我链接的组件的状态的一部分。相反，该状态将位于组件的道具中。在组件中添加一个<code class="fe lo lp lq le b">console.log(this.props)</code>mount揭示了这个有趣的信息:</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/82949601554783d9d9cf0aa7ad5f2f74.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*IdzX-4ndjsnh5wxvslvc6Q.png"/></div></figure><p id="c283" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我在没有点击链接的情况下加载这个组件，该状态将被列为“空”，但是有了链接，该状态将显示我使用上面的to:对象传递的内容。就这样，几乎一切都准备好了。从这里开始，我只需要做两件事:</p><ol class=""><li id="91a1" class="ls lt in kc b kd ke kh ki kl lu kp lv kt lw kx lx ly lz ma bi translated">在组件中运行一个检查安装以检查<code class="fe lo lp lq le b">this.props.location.state</code>，然后滚动到适当的位置，如果它回来了</li><li id="af8d" class="ls lt in kc b kd mb kh mc kl md kp me kt mf kx lx ly lz ma bi translated">在链接中写入额外的逻辑，这样，如果从目标组件中单击链接，它仍会滚动到该位置</li></ol><p id="ea76" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第一部分需要添加一个对我想要滚动到的元素的引用。我通过编写<code class="fe lo lp lq le b">targetRef=React.CreateRef()</code>在组件顶部创建了ref，然后将该ref附加到我想要滚动到的元素:<code class="fe lo lp lq le b">&lt;div ref={ref =&gt; {this.targetRef = ref}} &gt;</code> *</p><p id="7955" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后，我通过在我的目标组件的ComponentDidMount中调用这个函数将ref付诸实施:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="9032" class="li lj in le b gy lk ll l lm ln">scrollToTarget = () =&gt; {<br/>  setTimeout(() =&gt; {<br/>    this.targetRef.scrollIntoView({ behavior: 'smooth' })             <br/>  }, 500);    <br/>}<br/>// setTimeout is optional, but instantly scrolling can be jarring</span></pre><p id="0fa9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于第二部分，我做了两件事。首先，当从目标组件调用它时，我将setTimeout函数传递给Banner组件。其次，我向链接的父元素添加了一个onClick函数，它检查我在上一步中传递的属性。如果道具存在，它运行函数滚动到目标ref。</p><p id="6bf6" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就是这样！下面是我用于横幅组件的代码，后面是目标组件的代码。感谢您的阅读，祝您编码愉快！</p></div><div class="ab cl mg mh hr mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ig ih ii ij ik"><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="mn mo l"/></div></figure><figure class="kz la lb lc gt jo"><div class="bz fp l di"><div class="mn mo l"/></div></figure></div><div class="ab cl mg mh hr mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ig ih ii ij ik"><p id="f18c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://reacttraining.com/react-router/web/api/Link/to-function" rel="noopener ugc nofollow" target="_blank">反应训练</a></p><p id="118f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://github.com/filippoitaliano/react-snorty-tips/blob/master/react/anchor-link.md" rel="noopener ugc nofollow" target="_blank">反应过来参提示</a></p><p id="83d5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">参考文献和DOM </a></p></div></div>    
</body>
</html>