<html>
<head>
<title>The journey to building a full microservice app (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建完整微服务应用的旅程(第1部分)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-journey-to-building-a-full-microservice-app-9267a910a04f?source=collection_archive---------0-----------------------#2019-05-26">https://javascript.plainenglish.io/the-journey-to-building-a-full-microservice-app-9267a910a04f?source=collection_archive---------0-----------------------#2019-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d2ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将分享我创建POC以构建完整微服务应用程序的过程。完全微服务意味着我计划分别在前端和后端构建组件，<strong class="jp ir">帮助敏捷团队内部的CI/CD流程</strong>。</p><p id="7931" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将尝试这样做，以确认是否单独构建所有内容是一个好方法。如您所见，我在这个过程中开始写这篇文章；我不确定我的旅程是否会成功。</p><p id="51a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，我想与你分享；也许这对你来说是值得的。</p><blockquote class="kl km kn"><p id="153c" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">“成功是一个旅程，而不是目的地。过程往往比结果更重要。阿瑟·阿什”</p></blockquote><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/9080f1b215773a208a7d344f9a037b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIejDczPOAJTcwd7lcLCGg.jpeg"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">pixabay.com</figcaption></figure><p id="c74c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我首先要告诉你的是堆栈。后端方面，我选择用<strong class="jp ir"> Node.js </strong>搭配<strong class="jp ir"> Express框架</strong>，我是一个Java程序员，我可以选择Java，但是我喜欢把自己推向未知。</p><p id="2c01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了服务之间的集成/通信，我选择了使用<strong class="jp ir"> RPC </strong>策略的<strong class="jp ir"> RabbitMQ </strong>。记录数据，我选择了<strong class="jp ir"> MongoDB </strong>和<strong class="jp ir">Redis</strong>；所有GET操作都将从Redis中检索数据，所有PUT、DELETE和POST操作都将更新Redis数据和MongoDB数据。</p><p id="3b44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在前端方面，我选择使用<strong class="jp ir"> Angular </strong>最新版本的<strong class="jp ir">材料设计</strong>。我打算为<strong class="jp ir"> AWS </strong>推送一切，我想使用<strong class="jp ir"> ECS </strong>服务，因此我将创建<strong class="jp ir"> Docker </strong>文件，并且在我的本地环境中，我将运行所有使用<strong class="jp ir">Docker</strong>Compose来编排它的容器。</p><p id="6770" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我定义了堆栈，现在我必须定义服务，我的想法是保持简单，所以，服务是:<strong class="jp ir">消费者</strong> (id，名字，姓氏和电子邮件)，<strong class="jp ir">产品</strong> (id，名字，价值和数量)和<strong class="jp ir">订单</strong> (id，product_id，productName，consumer_id，consumerName，数量和日期)。</p><h1 id="1b0b" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">我将开始创建后端服务</strong></h1><p id="993e" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">为此，我将使用Express CLI来为我生成包。在开始之前，请记住，您必须先安装几个开发工具。</p><p id="d829" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装node . js "<a class="ae ml" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en/</a></p><p id="f933" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装快速框架<code class="fe mm mn mo mp b">npm install express -g</code></p><p id="a16b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦您安装了节点和Express，现在您可以创建一个文件夹，主文件夹，所有项目都将在那里。在这个主文件夹中，运行命令:</p><p id="a602" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mm mn mo mp b">express –no-view microservice-back-end-product — git</code></p><p id="7069" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mm mn mo mp b">express –no-view microservice-back-end-consumer — git</code></p><p id="bc63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mm mn mo mp b">express –no-view microservice-back-end-order — git</code></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mq"><img src="../Images/9c0b52655e9ea7fce53254fe765db2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xX_PJREBkMe-2RxiXvGuCg.png"/></div></div></figure><p id="0a50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所附的截图显示了对Node.js和Express安装的检查，然后运行命令创建第一个微服务。</p><p id="7c2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意命令输出；在那之后你有一些步骤要做。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mq"><img src="../Images/3274a2cd1c76e66139ef9273d0044419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXsfg8DOOGMuxmOdZZ0zSA.png"/></div></div></figure><p id="9f3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我创建了所有的项目，我应该安装节点依赖关系，附上的截图显示了这个过程，你应该为所有的项目这样做。</p><p id="5f5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成上一步后，现在我将项目更改为JavaScript <strong class="jp ir"> ES2015 — </strong>，这样您就可以使用新的JavaScript语言特性。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mr"><img src="../Images/a568e0f5930e094c16d5d0d0c9f65d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LU50TCZ8aVE3ewG272yQ9g.png"/></div></div></figure><p id="fe9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我添加了文件<strong class="jp ir">。根文件夹中的babelrc </strong>并包含了高亮显示的内容。其次，我添加了ECSMA 2015项目工作所需的依赖项。</p><p id="ed96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，在根文件夹中运行命令<code class="fe mm mn mo mp b">npm install</code>来安装新的依赖项。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ms"><img src="../Images/f82690aba0115ce7599025d1f610bb6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RGmsc2ywEUlGfh73-a5GA.png"/></div></div></figure><p id="ed0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你应该做一些改变。</p><p id="fe2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为此，首先:添加<strong class="jp ir">。js扩展名为www </strong>的文件放在bin文件夹内，查看高亮显示的项目。</p><p id="e594" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二:在package.json中更改脚本操作，正如您在突出显示的内容中所看到的。</p><p id="8d1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三:替换ECSMA 2015新标准的“旧”代码JavaScript正如您在所附的截图中看到的，文件<a class="ae ml" href="http://www.js" rel="noopener ugc nofollow" target="_blank"> www.js </a>和app.js应该被更改。</p><p id="969f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更改后，在根文件夹中运行“npm run start”，如果一切正常，您将从控制台获得输出“<strong class="jp ir">Listen on provided port:3000</strong>”。</p><p id="ae8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开浏览器并键入<a class="ae ml" href="http://localhost:3000/users" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/users</a>您可能会看到消息“用资源响应”，要停止节点服务器，请在控制台内单击ctrl+c，并按“Y”确认。</p><p id="cfa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对所有创建的项目重复这些步骤。</p><p id="4414" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将完成文章的第一部分。下次再见，我们将为自己创建合适的开发环境并安装更多的依赖项。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="588c" class="li lj iq bd lk ll na ln lo lp nb lr ls lt nc lv lw lx nd lz ma mb ne md me mf bi translated">克莱森·费雷拉·德·梅洛</h1><p id="277a" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated"><em class="ko">讲师Estía培训</em></p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><div class="kt ku kv kw gt nf"><a href="https://medium.com/@cleisonferreiramelo/the-journey-to-building-a-full-microservice-app-the-dev-env-60c492f40937" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">打造全微服务app之旅。开发环境。</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">嗨，伙计们，继续我们的文章，现在我将改变我们的项目，自动重启Node.js服务器…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt lc nf"/></div></div></a></div></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="a875" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">帮助您的最终代码:</p><pre class="kt ku kv kw gt nu mp nv nw aw nx bi"><span id="0fb4" class="ny lj iq mp b gy nz oa l ob oc"><em class="ko">//package.json</em><br/><br/>{<br/>    "name": "microservice-back-end-product",<br/>    "version": "0.0.0",<br/>    "private": true,<br/>    "scripts": {<br/>        "start": "babel-node ./bin/www.js"<br/>    },<br/>    "dependencies": {<br/>        "cookie-parser": "~1.4.3",<br/>        "debug": "~2.6.9",<br/>        "express": "~4.16.0",<br/>        "morgan": "~1.9.0"<br/>    },<br/>    "devDependencies": {<br/>        "babel-cli": "^6.26.0",<br/>        "babel-preset-es2015": "^6.24.1"<br/>    }<br/>}</span><span id="91da" class="ny lj iq mp b gy od oa l ob oc"><em class="ko">//.babelrc</em><br/><br/>{<br/>    "presets": ["es2015"]<br/>}</span><span id="023c" class="ny lj iq mp b gy od oa l ob oc"><em class="ko">//www.js</em><br/><br/>#!/usr/bin/env node<br/><em class="ko">/**<br/> * Module dependencies.<br/> */</em><br/>import app from '../app';<br/>const debug = require('debug')('microservice-back-end-product:server');<br/>import http from 'http';<br/><em class="ko">/**<br/> * Get port from environment and store in Express.<br/> */</em><br/>const port = normalizePort(process.env.PORT || '3000');<br/>app.set('port', port);<br/><em class="ko">/**<br/> * Create HTTP server.<br/> */</em><br/>const server = http.createServer(app);<br/><em class="ko">/**<br/> * Listen on provided port, on all network interfaces.<br/> */</em><br/>server.listen(port, () =&gt; {<br/>  console.log(`Listen on provided port:${port} \n`);<br/>});<br/>server.on('error', onError);<br/>server.on('listening', onListening);<br/><em class="ko">/**<br/> * Normalize a port into a number, string, or false.<br/> */</em><br/>function normalizePort(val) {<br/>  let port = parseInt(val, 10);<br/><br/><br/>  if (isNaN(port)) {<br/>    <em class="ko">// named pipe</em><br/>    return val;<br/>  }<br/><br/><br/>  if (port &gt;= 0) {<br/>    <em class="ko">// port number</em><br/>    return port;<br/>  }<br/><br/><br/>  return false;<br/>}<br/><br/><br/><em class="ko">/**<br/> * Event listener for HTTP server "error" event.<br/> */</em><br/><br/><br/>function onError(error) {<br/>  if (error.syscall !== 'listen') {<br/>    throw error;<br/>  }<br/><br/><br/>  let bind = typeof port === 'string' ? 'Pipe ' + port : 'Port ' + port;<br/><br/><br/>  <em class="ko">// handle specific listen errors with friendly messages</em><br/>  switch (error.code) {<br/>    case 'EACCES':<br/>      console.error(bind + ' requires elevated privileges');<br/>      process.exit(1);<br/>      break;<br/>    case 'EADDRINUSE':<br/>      console.error(bind + ' is already in use');<br/>      process.exit(1);<br/>      break;<br/>    default:<br/>      throw error;<br/>  }<br/>}<br/><br/><br/><em class="ko">/**<br/> * Event listener for HTTP server "listening" event.<br/> */</em><br/><br/><br/>function onListening() {<br/>  let addr = server.address();<br/>  let bind = typeof addr === 'string' ? 'pipe ' + addr : 'port ' + addr.port;<br/>  debug('Listening on ' + bind);<br/>}</span><span id="8bdb" class="ny lj iq mp b gy od oa l ob oc"><em class="ko">//app.js</em><br/><br/>import express from 'express';<br/>import path from 'path';<br/>import cookieParser from 'cookie-parser';<br/>import logger from 'morgan';<br/>import indexRouter from './routes/index';<br/>import usersRouter from './routes/users';<br/><br/><br/>const app = express();<br/><br/><br/>app.use(logger('dev'));<br/>app.use(express.json());<br/>app.use(express.urlencoded({ extended: false }));<br/>app.use(cookieParser());<br/>app.use(express.static(path.join(__dirname, 'public')));<br/><br/><br/>app.use('/', indexRouter);<br/>app.use('/users', usersRouter);<br/><br/><br/>export default app;</span><span id="d1a8" class="ny lj iq mp b gy od oa l ob oc">//console output<br/><br/>PS C:\Users\cleis\Downloads\all-projects\microservice-back-end-product&gt; npm run start<br/><br/><br/>&gt; microservice-back-end-product@0.0.0 start C:\Users\cleis\Downloads\all-projects\microservice-back-end-product<br/>&gt; babel-node ./bin/www.js<br/><br/>Listen on provided port:3000<br/><br/>//CTRL + C<br/><br/>Terminate batch job (Y/N)? y<br/>PS C:\Users\cleis\Downloads\all-projects\microservice-back-end-product&gt;</span></pre></div></div>    
</body>
</html>