<html>
<head>
<title>Serverless NestJS with AWS DynamoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带AWS DynamoDB的无服务器NestJS</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/serverless-nestjs-with-aws-dynamodb-e7530ab33c78?source=collection_archive---------1-----------------------#2020-07-24">https://javascript.plainenglish.io/serverless-nestjs-with-aws-dynamodb-e7530ab33c78?source=collection_archive---------1-----------------------#2020-07-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1371d7e204d1d9ae4e5719ac41ee8c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBh4mshA0I8THRfaJY7VYg.png"/></div></div></figure><p id="7b9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们用NestJS谈论数据库，你可能已经与MongoDB和mongoose或MySQL和typeorm建立了某种联系。</p><p id="62cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是如果我们谈论AWS的无服务器，我强烈推荐测试DynamoDB。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="688a" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">为什么是DynamoDB？</h1><p id="178b" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">首先因为也是无服务器的！这里有更多关于它的信息:</p><div class="mg mh gp gr mi mj"><a href="https://aws.amazon.com/dynamodb/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">亚马逊DynamoDB | NoSQL键值数据库|亚马逊网络服务</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">适用于任何规模的快速灵活的NoSQL数据库服务Amazon DynamoDB是一个键值和文档数据库，它…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">aws.amazon.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx jw mj"/></div></div></a></div><p id="4793" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">“Amazon DynamoDB是一个键值和文档数据库，在任何规模下都能提供一位数的毫秒级性能。这是一个全面管理的、多区域、多主控、耐用的数据库，具有内置的安全性、备份和恢复以及适用于互联网规模应用程序的内存缓存。DynamoDB每天可以处理超过10万亿个请求，每秒可以支持超过2000万个请求的峰值。”</p><p id="9825" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以很快！真的很快，你可以在我贴在这里的页面上找到更多信息。</p><p id="0c2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将把我们的无服务器NestJS应用程序与我们的Dynamo DB连接起来。</p><p id="1b7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文的目的是让您可以将您的NestJS无服务器应用程序与DynamoDB连接起来，我将为您留下到资源库的链接，在那里您可以看到所有代码，以便您可以下载和使用它，请记住，您必须使用以下命令配置AWS帐户:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="e3b0" class="nh le iq nd b gy ni nj l nk nl">aws configure</span></pre><p id="6b9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将创建一个具有两个端点的简单应用程序，第一个端点创建一个带有标题和类别的订单，第二个端点通过id获取已创建的订单。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="d6a9" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">第一步:NestJS</h1><p id="2289" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">我们需要用可爱的命令和serverless.yml文件创建堆栈。</p><div class="mg mh gp gr mi mj"><a href="https://nestjs.com" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">NestJS——一个渐进的Node.js框架</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">NestJS是一个用于构建高效、可伸缩的Node.js web应用程序的框架。它使用现代JavaScript，是建立…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">nestjs.com</p></div></div><div class="ms l"><div class="nm l mu mv mw ms mx jw mj"/></div></div></a></div><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/16fea7f77511affda6f413b75403d9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*UYGgO6Hbow8fx7o-ca2mQA.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 1: NestJS Structure</figcaption></figure><p id="81cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，首先让我们谈谈我是如何组织一个NestJS应用程序的:</p><p id="3020" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">NestJS应用程序基本上与模块、服务和控制器逻辑一起工作。</p><p id="d600" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我还使用了一个存储库文件，这个存储库文件用于MySQL的typeorm和entities，我也用于MongoDB和我的所有项目，在我看来它更有序。</p><p id="e30e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将. service.ts用于业务逻辑，将存储库用于与数据库或外部API的各种类型的连接，这种方式是分离的，例如，如果我更改数据库，我不必更改很多逻辑。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/9459f4a15e78c7905ff701405dc1c785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*raQUmCYgqWQfZ1uTMSyfrg.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 2: NestJS Logic</figcaption></figure><p id="0752" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，现在我们已经有了基本文件和NestJS应用程序，我们需要使用无服务器来部署我们的堆栈。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="b5b6" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">去无服务器！</h1><p id="7181" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">为了部署我们的堆栈，我们将使用无服务器！</p><div class="mg mh gp gr mi mj"><a href="https://www.serverless.com" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">无服务器应用程序框架Serverless</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">软件正在吞噬世界。不幸的是，大多数企业仍然不能成功地交付软件，更不用说这样做了…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.serverless.com</p></div></div><div class="ms l"><div class="nt l mu mv mw ms mx jw mj"/></div></div></a></div><p id="99a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要创建我们的serverless.yml文件，并配置它来部署我们的应用程序:</p><p id="f420" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我们需要给我们的应用程序起一个名字，最重要的是我们需要创建我们的DynamoDB表。</p><p id="433f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您已经在NestJS文件图像上看到的，我们需要创建两个文件夹，一个文件夹用于AWS IAM角色，另一个文件夹用于AWS资源。</p><p id="4c1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看一下yml的provider部分，我们有我们的环境变量，其中是ORDERS_TABLE_NAME和iamRoleStatements，它们指向带有OrdersTable的IAMRole的文件。</p><p id="5686" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，我们还有一个自定义部分，在这个自定义部分，您可以添加您需要的任何内容，例如OrdersTable名称和arn，我们将在部署应用程序后使用它们。</p><p id="9ad2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在这里看到CloudFormation文档:</p><div class="mg mh gp gr mi mj"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">裁判员</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">内部函数Ref返回指定参数或资源的值。当您指定参数的…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">docs.aws.amazon.com</p></div></div></div></a></div><p id="8714" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用CloudFormation，您可以检索DynamoDB表的名称和arn。所以你会有一个这样的无服务器. yml:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/d144ead7340a5273e42fd71a9afb6f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*RJUm-tuito8BVbluoSaPjA.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 3: Serverless.yml file</figcaption></figure><p id="6d26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还需要创建OrdersTable.yml文件，这里我们引用DynamoDB表并定义AttributeDefinitions，在这种情况下，我使用“S”类型的“id”作为属性名，这意味着“string ”,我还在KeySchema中将此id定义为类似主键的哈希。我也强烈推荐阅读DynamoDB文档。</p><div class="mg mh gp gr mi mj"><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Introduction.html" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">什么是亚马逊DynamoDB？</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">欢迎阅读亚马逊DynamoDB开发者指南。Amazon DynamoDB是一个完全托管的NoSQL数据库服务，它提供…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">docs.aws.amazon.com</p></div></div><div class="ms l"><div class="nv l mu mv mw ms mx jw mj"/></div></div></a></div><p id="8938" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，您将有一个类似这样的文件:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/27490800e974bcbbde1ed5e15cd34dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAg7RiUDc00Bcp79WIWZvw.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 4: OrdersTable.yml file</figcaption></figure><p id="6430" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们需要创建OrdersTableIAM.yml，该文件将允许我们从DynamoDB表中放置Items、Scan、GetItem、UpdateItems并查询它们，该表是在指向serverless.yml的自定义部分的资源上定义的。</p><p id="9d13" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，我们将只使用PutItem和GetItem。该文件应该如下所示:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/04df526cbacf7040bf64d9762b2c8fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ichyPHVMAprTGCBEoc_vVg.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 5: OrdersTableIAM.yml file</figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="78eb" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">编码时间到了</h1><p id="b624" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">我们终于完成了配置。现在，我们需要对我们的存储库和服务进行编码，以使用控制器和公开端点来创建订单，并通过Id获取订单。</p><p id="48fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将与您分享我的Github存储库和示例代码，所以我不打算写代码的所有细节，只写控制器和存储库，还记得我们在文章的NestJS部分描述的应用程序的逻辑吗。</p><h2 id="b0fd" class="nh le iq bd lf nx ny dn lj nz oa dp ln kj ob oc lr kn od oe lv kr of og lz oh bi translated">秩序。模块. ts</h2><p id="067b" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">这是order.module.ts，我们基本上提供了order.repository.ts和order.service.ts。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/cdd13dbd8cea571e2a430529e8627798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*TXW3Uy9oZJdBcxgEAVHi2g.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 6: order.module.ts file</figcaption></figure><h2 id="97da" class="nh le iq bd lf nx ny dn lj nz oa dp ln kj ob oc lr kn od oe lv kr of og lz oh bi translated">秩序。控制器. ts</h2><p id="6e38" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">这是订单控制器，它通过由app.module.ts导入的order.module.ts公开。</p><p id="2e0d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们有两个端点:</p><p id="dacb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">/createOrder:这是一个POST方法，主要创建订单并根据结果响应true或false。</p><p id="13cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">/getOrderById/:id:这是一个GET方法，用于检索由其Id创建的订单。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/00aefbf182f3d3bffc2aa94993bdb7de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQjw-DF6MU7r4PZToZ6QYg.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 7: order.controller. ts file</figcaption></figure><h2 id="98ce" class="nh le iq bd lf nx ny dn lj nz oa dp ln kj ob oc lr kn od oe lv kr of og lz oh bi translated">秩序。Repository.ts</h2><p id="350c" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">最后我们有order.repository.ts，这里我们导入aws-sdk以使用DynamoDB客户端，我们还导入uuid以在DynamoDB上创建我们唯一的id，我还使用nestjs/common进行错误处理。</p><p id="0549" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从createOrder方法开始，它接收一个由标题和类别组成的createOrderDto，您可以直接调用它们或者使用对象析构。</p><p id="0c29" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们定义了一个名为newOrder的常量变量，然后创建了DynamoDB的一个实例。DocumentClient()，我们使用一个put调用在serverless.yml中定义的环境中的TableName和我们之前定义的newOrder变量。这是一个承诺，如果一切按预期进行，我们将在DynamoDB表中创建新订单。</p><p id="ee09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于接收订单Id的第二个方法getOrderById，我们定义了一个let订单变量，并调用DynamoDB。DocumentClient()使用get方法再次使用TableName并将id作为对象传递给Key param，这将返回我们分配给order变量的顺序。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/aff8429178bb19a12fe2ec6c0e830563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6eUttbTpkD2FRAjVI-S4-g.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 8: order.repository.ts file</figcaption></figure><p id="1ca6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所有这些都完成后，我们就可以用sls deploy命令部署我们的应用程序了。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="5bee" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">部署应用程序</h1><p id="7018" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">我们已经完成了所有的代码和配置，现在可以部署我们的无服务器NestJS应用程序了。</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="1c0b" class="nh le iq nd b gy ni nj l nk nl">sls deploy</span></pre><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/d55683fea404a350c418cd181f1f41e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*yGT-RHJEnsIkjiCzXh5JLg.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 9: sls deploy execution</figcaption></figure><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/eeee4d68798c837823bd490014679b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*sCZ3vyeImmBs6dKis2yKiA.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 10: sls deploy result</figcaption></figure><p id="78ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">记住，这个命令将使用您用aws configure命令定义的用户在您的AWS环境中创建CloudFormation、Lambda函数、API网关和DynamoDB表。一旦这个过程完成，你会收到API的网址进行测试。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="1e1f" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">测试应用程序</h1><p id="6154" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">是时候测试我们的应用程序了，首先我们需要Postman，以下是链接，以防您还没有:</p><div class="mg mh gp gr mi mj"><a href="https://www.postman.com" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">postman | API开发的协作平台</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">进行任何种类的API调用——REST、SOAP或普通HTTP——并轻松检查最大的响应。邮递员也有…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.postman.com</p></div></div><div class="ms l"><div class="on l mu mv mw ms mx jw mj"/></div></div></a></div><p id="70e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，在Postman中，我们将创建一个POST方法，使用url将<strong class="ka ir">“{ proxy+}”</strong>替换为<strong class="ka ir">“order/create order”，</strong>我们将标题和类别传递给订单，并点击发送按钮。如果一切按预期进行，我们将看到以下响应:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/e3187938468c441987db47202756a496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vA-P3mP54ecHkonCewYrtg.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 11: Testing first endpoint with Postman</figcaption></figure><p id="edd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">找到了。有用！让我们检查一下我们的AWS控制台。</p><div class="mg mh gp gr mi mj"><a href="https://aws.amazon.com/console/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">AWS管理控制台</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">访问和管理AWS云所需的一切都在一个web界面中。帮助我们使这个页面更好地告诉我们…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">aws.amazon.com</p></div></div><div class="ms l"><div class="op l mu mv mw ms mx jw mj"/></div></div></a></div><p id="7909" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在AWS控制台中，转到services，然后转到DynamoDB，您将看到我们创建的表，如果您单击“Elements ”,您将看到我们刚刚创建的订单。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oq"><img src="../Images/d63e8dd3adf7e55f28672caaf18dfcc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3XIzjvKlP_qOgRZkV8BY2Q.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 12: AWS Console with DynamoDB</figcaption></figure><p id="d605" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们可以使用订单测试我们的第二个端点，单击订单id，您将看到对象，复制id，让我们试试！</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/753777e5ebb33bb5d874a4d57b0b8cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHNPxotOuGD3UzgdN8NZlg.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 13: AWS DynamoDB Object</figcaption></figure><p id="05ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回到Postman中，我们创建一个新的GET请求，其端点与之前相同，将<strong class="ka ir"> "/order/createOrder" </strong>更改为<strong class="ka ir"> "order/getOrderById/orderId "，</strong>用您之前复制的Id替换" orderId "。点击发送和<strong class="ka ir">瞧！</strong></p><p id="7470" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们收到之前创建的订单。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi os"><img src="../Images/27373c16564bf303d38b8dafeb238f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfxLuUKS2_yfEU-pUkoktA.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Image 14: Testing second endpoint with Postman</figcaption></figure><p id="8b07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的无服务器NestJS应用程序可以与DynamoDB一起工作！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="7e95" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">结论</h1><p id="40c8" class="pw-post-body-paragraph jy jz iq ka b kb mb kd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv ij bi translated">DynamoDB是一个真正强大的AWS工具，速度非常快，适用于任何类型的应用程序，缺点之一是你必须学会如何使用它，因为它与MySQL、Postgres、MongoDB和其他工具有点不同。我强烈建议你试一试。</p><p id="480c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您想了解更多关于Serverless和NestJS的信息，请参阅我关于NestJS和Serverless的其他文章。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="1482" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">Github回购</h1><div class="mg mh gp gr mi mj"><a href="https://github.com/Cfvillarroel/nestjs-serverless-dynamodb" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">cfvillarroel/nestjs-无服务器-dynamodb</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">这个例子演示了如何设置一个嵌套应用程序。这将导致:$ sls脱机启动无服务器…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">github.com</p></div></div><div class="ms l"><div class="ot l mu mv mw ms mx jw mj"/></div></div></a></div><p id="8d50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您有任何问题或疑问，请随时联系我，这是我的linkedin。</p><div class="mg mh gp gr mi mj"><a href="https://www.linkedin.com/in/carlos-villarroel-navarro/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">Carlos feli PE Villarroel Navarro-IT经理- Rindegastos | LinkedIn</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">查看Carlos Felipe Villarroel Navarro在世界上最大的职业社区LinkedIn上的个人资料。卡洛斯·费利佩…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.linkedin.com</p></div></div><div class="ms l"><div class="ou l mu mv mw ms mx jw mj"/></div></div></a></div></div></div>    
</body>
</html>