<html>
<head>
<title>React Native: Getting user device timezone and converting UTC time-stamps with offset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native:è·å–ç”¨æˆ·è®¾å¤‡æ—¶åŒºå¹¶ä½¿ç”¨åç§»é‡è½¬æ¢UTCæ—¶é—´æˆ³</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/react-native-getting-user-device-timezone-and-converting-utc-time-stamps-with-offset-697902d7803?source=collection_archive---------2-----------------------#2020-07-13">https://javascript.plainenglish.io/react-native-getting-user-device-timezone-and-converting-utc-time-stamps-with-offset-697902d7803?source=collection_archive---------2-----------------------#2020-07-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/3264408af6cb8bee409c4ea3c6b769ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G6dOguCgKkj8AODB"/></div></div><figcaption class="iw ix gj gh gi iy iz bd b be z dk">Photo by <a class="ae ja" href="https://unsplash.com/@elisamichelet?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Elisa Michelet</a> on <a class="ae ja" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="d840" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä¸webç›¸åï¼ŒReact Nativeä¸åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œå› æ­¤åœ¨è¯•å›¾è·å–æ—¶åŒºåç§»é‡å’Œè€ƒè™‘å¤ä»¤æ—¶æ—¶æ—¶ä¼šå˜å¾—å¾ˆæ£˜æ‰‹ã€‚</p><p id="5bba" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æœ€è¿‘ï¼Œæˆ‘çš„ä»»åŠ¡æ˜¯å°†æ‰€æœ‰åç«¯ç”Ÿæˆçš„æ—¶é—´æˆ³ä»é»˜è®¤çš„UTCè½¬æ¢ä¸ºç”¨æˆ·çš„è®¾å¤‡æ—¶åŒºã€‚è¿™æ˜¯æˆ‘ä¸€è·¯ä¸Šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•è§£å†³æˆ‘çš„ç¥¨çš„è¿‡ç¨‹ã€‚</p><h1 id="2c02" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">æµç¨‹å›¾</h1><p id="6eec" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">è¿™æ˜¯æˆ‘æƒ³è¦çš„æµç¨‹:</p><ol class=""><li id="7f4f" class="mb mc jd kc b kd ke kh ki kl md kp me kt mf kx mg mh mi mj bi translated">ä»¥å°æ—¶ä¸ºå•ä½è·å–ç”¨æˆ·UTCæ—¶é—´åç§»é‡ã€‚</li><li id="921e" class="mb mc jd kc b kd mk kh ml kl mm kp mn kt mo kx mg mh mi mj bi translated">å°†åç«¯æ—¶é—´æˆ³å’Œåç§»é‡å‘é€åˆ°ä¸€ä¸ªè½¬æ¢å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è½¬æ¢åçš„+æ ¼å¼å­—ç¬¦ä¸²è¿”å›åˆ°å‰ç«¯ã€‚</li></ol><p id="7f2d" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc je">æ­¥éª¤2ä¸­çš„å‡½æ•°å°†å¦‚ä¸‹å·¥ä½œ:</strong></p><h2 id="0cc8" class="mp kz jd bd la mq mr dn le ms mt dp li kl mu mv lm kp mw mx lq kt my mz lu na bi translated"><strong class="ak">T3ã€‘params:T5ã€‘</strong></h2><ul class=""><li id="a5c9" class="mb mc jd kc b kd lw kh lx kl nc kp nd kt ne kx nf mh mi mj bi translated"><em class="ng">å­—ç¬¦ä¸²:æ—¥æœŸå­—ç¬¦ä¸²</em></li><li id="5876" class="mb mc jd kc b kd mk kh ml kl mm kp mn kt mo kx nf mh mi mj bi translated"><em class="ng"> Int: offset </em></li></ul><p id="5a7a" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc je"> a) </strong>è§£ææ—¥æœŸå­—ç¬¦ä¸²â€˜datestringâ€™ã€‚<br/> <strong class="kc je"> b) </strong>å°†æ•°æ®è½¬æ¢æˆJSæ—¥æœŸå¯¹è±¡ã€‚<br/> <strong class="kc je"> c) </strong>ä½¿ç”¨JS `Date `å†…ç½®å‡½æ•°` getHours()`æ–¹æ³•è·å–dateå¯¹è±¡çš„å½“å‰å°æ—¶æ•°ã€‚<br/> <strong class="kc je"> d) </strong>ä½¿ç”¨JS `Date 'å†…ç½®å‡½æ•°' setHours()'åœ¨Dateå¯¹è±¡ä¸Šè®¾ç½®æ–°çš„å°æ—¶ï¼Œå…¶ä¸­æˆ‘ä»¬ä¼ å…¥å½“å‰å°æ—¶ï¼Œå¹¶æ·»åŠ ä¼ å…¥å‡½æ•°çš„åç§»é‡ã€‚<br/> <strong class="kc je"> e) </strong>å°†å­—ç¬¦ä¸²æ ¼å¼åŒ–åˆ°å‰ç«¯ã€‚<br/> <strong class="kc je"> f) </strong>è¿”å›æœ€ç»ˆè½¬æ¢åçš„æ—¶é—´æˆ³ã€‚</p><h2 id="0132" class="mp kz jd bd la mq mr dn le ms mt dp li kl mu mv lm kp mw mx lq kt my mz lu na bi translated"><strong class="ak">è®©æˆ‘ä»¬çœ‹çœ‹ä»£ç ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆ:</strong></h2><p id="7cb7" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="74db" class="mp kz jd nm b gy nq nr l ns nt">const convertedTimeStamp = formatTimeByOffset(utcStringFromBE, offset)</span></pre><p id="bf04" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘æ ¹æ®ä¸Šè¿°æ­¥éª¤æ„å»ºçš„å‡½æ•°å¦‚ä¸‹æ‰€ç¤º:</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="04f4" class="mp kz jd nm b gy nq nr l ns nt">export const formatTimeByOffset = (dateString, offset) =&gt; {<br/>  // Params:<br/>  // How the backend sends me a timestamp<br/>  // dateString: on the form yyyy-mm-dd hh:mm:ss<br/>  // offset: the amount of hours to add.</span><span id="51cb" class="mp kz jd nm b gy nu nr l ns nt">// If we pass anything falsy return empty string<br/>  if (!dateString) return ''<br/>  if (dateString.length === 0) return ''</span><span id="7ac2" class="mp kz jd nm b gy nu nr l ns nt">// Step a: Parse the backend date string</span><span id="abe9" class="mp kz jd nm b gy nu nr l ns nt">// Get Parameters needed to create a new date object<br/>  const year = dateString.slice(0, 4)<br/>  const month = dateString.slice(5, 7)<br/>  const day = dateString.slice(8, 10)<br/>  const hour = dateString.slice(11, 13)<br/>  const minute = dateString.slice(14, 16)<br/>  const second = dateString.slice(17, 19)</span><span id="01ab" class="mp kz jd nm b gy nu nr l ns nt">// Step: bMake a JS date object with the data<br/>  const dateObject = new Date(`${year}-${month}-${day}T${hour}:${minute}:${second}`)</span><span id="dc10" class="mp kz jd nm b gy nu nr l ns nt">// Step c: Get the current hours from the object<br/>  const currentHours = dateObject.getHours()</span><span id="406a" class="mp kz jd nm b gy nu nr l ns nt">// Step d: Add the offset to the date object<br/>  dateObject.setHours(currentHours + offset)</span><span id="c368" class="mp kz jd nm b gy nu nr l ns nt">// Step e: stringify the date object, replace the T with a space and slice off the seconds.<br/>  const newDateString = dateObject<br/>    .toISOString()<br/>    .replace('T', ' ')<br/>    .slice(0, 16)</span><span id="e802" class="mp kz jd nm b gy nu nr l ns nt">// Step f: Return the new formatted date string with the added offset<br/>  return `${newDateString}`<br/>}</span></pre><p id="d26e" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è¿™æ˜¯GitHubä¸Šçš„ä»£ç ã€‚</p><p id="15e1" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">é€šè¿‡ä¸€äº›å¿«é€Ÿæµ‹è¯•ï¼Œéšæœºæ—¶é—´åç§»ä¸­çš„æ—è·¯è¡¨æ˜è¯¥åŠŸèƒ½å·¥ä½œæ­£å¸¸ã€‚è°ƒç”¨å®ƒå¹¶æ‰“å°ç»“æœä¼šç»™å‡ºä»¥ä¸‹å†…å®¹:</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="6daf" class="mp kz jd nm b gy nq nr l ns nt">const convertedToLocalTime = formatTimeByOffset('2001-04-11 10:00:00', 7)</span><span id="4738" class="mp kz jd nm b gy nu nr l ns nt">console.log(convertedToLocalTime)<br/>// --&gt; "2001-04-11 17:00:00"</span></pre><p id="f274" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å‰å®³ï¼ç°åœ¨æˆ‘ä»¬åªéœ€è¦è·å¾—ç”¨æˆ·çš„UTCæ—¶é—´åç§»ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ğŸš€ç†è®ºä¸Šè¿™å¯èƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯éœ€è¦é¢å¤–çš„è€ƒè™‘ã€‚</p></div><div class="ab cl nv nw hr nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ig ih ii ij ik"><h1 id="a511" class="ky kz jd bd la lb oc ld le lf od lh li lj oe ll lm ln of lp lq lr og lt lu lv bi translated">JSæ—¥æœŸ</h1><p id="358e" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">æˆ‘æœ€åˆçš„æƒ³æ³•æ˜¯ç®€å•åœ°ä½¿ç”¨JavaScript Dateï¼Œæ›´å…·ä½“åœ°è¯´æ˜¯getTimeZoneæ–¹æ³•ã€‚è¿™é‡Œçš„æ–‡æ¡£:<a class="ae ja" href="https://www.w3schools.com/jsref/jsref_gettimezoneoffset.asp" rel="noopener ugc nofollow" target="_blank"> JS Date getTimeZone()æ–¹æ³•</a></p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="57ab" class="mp kz jd nm b gy nq nr l ns nt">const now = new Date()<br/>const utcTimeOffset = now.getTimezoneOffset() / 60;</span></pre><p id="38f8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ng">æ³¨æ„:é™¤ä»¥60ï¼Œå› ä¸ºè¯¥æ–¹æ³•è¿”å›ä»¥åˆ†é’Ÿä¸ºå•ä½çš„åç§»é‡ã€‚</em></p><p id="296e" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc je">ä¸å¹¸çš„æ˜¯ï¼Œè¿™å¹¶ä¸æ€»èƒ½ç»™å‡ºæ­£ç¡®çš„æ—¶é—´ï¼</strong></p><p id="e690" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ä¾‹å¦‚ï¼Œå°†æˆ‘çš„ç³»ç»Ÿæ—¶åŒºæ”¹ä¸ºç¾å›½è¥¿æµ·å²¸ï¼Œç»™äº†æˆ‘ä¸€ä¸ªå°æ—¶é”™è¯¯çš„è½¬æ¢æ—¶é—´æˆ³ï¼ä¸ºä»€ä¹ˆï¼ŸğŸ¤”</p><h1 id="85a3" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">å¤ä»¤æ—¶</h1><p id="383a" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">å¦‚æœæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œè¿™å¯èƒ½ä¼šæœ‰æ•ˆï¼Œå› ä¸ºç°åœ¨çš„æµè§ˆå™¨ä¼šè¿”å›DSTè°ƒæ•´çš„åç§»é‡(å¦‚æœæˆ‘é”™äº†ï¼Œè¯·çº æ­£æˆ‘)ã€‚</p><p id="5ba8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬ä¸æ˜¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºä¸€ç§ä¸åŒçš„æ–¹æ³•æ¥ç¡®å®šç”¨æˆ·æ˜¯å¦å—åˆ°å¤ä»¤æ—¶äº‹ä»¶çš„å½±å“ã€‚æ‰‹åŠ¨æ“ä½œå°†ä¼šå¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºå¹¶éæ‰€æœ‰å›½å®¶éƒ½ä½¿ç”¨å¤ä»¤æ—¶ï¼Œè€Œä¸”å½“å¤ä»¤æ—¶ç”Ÿæ•ˆæ—¶ï¼Œä»–ä»¬ä¸ä¼šä½¿ç”¨ç›¸åŒçš„æ—¥æœŸå’Œæ—¶é—´ã€‚é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p id="1b1b" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è®©æˆ‘ä»¬å…ˆææ¸…æ¥šç”¨æˆ·çš„æ—¶åŒºï¼Œå°½ç®¡æˆ‘ä»¬ä¸æ˜¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œè€Œæ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿è¡Œã€‚ä¸€å®šæœ‰åŠæ³•è·å–è®¾å¤‡çš„æ—¶é—´å¹¶åˆ©ç”¨å®ƒä¸ºæˆ‘ä»¬æœåŠ¡ã€‚</p><h1 id="cfc0" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">è·å–ç§»åŠ¨è®¾å¤‡æ—¶åŒº</h1><p id="af18" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">æ¯å½“æˆ‘æƒ³åœ¨react nativeä¸­ä½¿ç”¨åŸç”Ÿæ¨¡å—æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨ç›¸æœºï¼Œæˆ‘å°±ä¼šæ±‚åŠ©äºGithub ä¸Šçš„<a class="ae ja" href="https://github.com/react-native-community" rel="noopener ugc nofollow" target="_blank"> React nativeç¤¾åŒºã€‚</a></p><p id="f196" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¯¹æˆ‘ä»¬æ¥è¯´å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸ªç¤¾åŒºæœ‰ä¸€ä¸ªæœ¬åœ°æ¨¡å—ï¼Œå«åš<a class="ae ja" href="https://github.com/react-native-community/react-native-localize" rel="noopener ugc nofollow" target="_blank">react-native-community/react-native-localize</a>ã€‚</p><p id="b356" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘è¿›å»çœ‹äº†æ–‡æ¡£ï¼Œå‘ç°äº†ä¸‹é¢çš„æ–¹æ³•:<a class="ae ja" href="https://github.com/react-native-community/react-native-localize#gettimezone" rel="noopener ugc nofollow" target="_blank"> getTimeZone() </a>ã€‚</p><h2 id="439c" class="mp kz jd bd la mq mr dn le ms mt dp li kl mu mv lm kp mw mx lq kt my mz lu na bi translated"><strong class="ak">æ˜¯è¿™æ ·æè¿°çš„:</strong></h2><p id="7ee1" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated"><em class="ng">è¿”å›ç”¨æˆ·é¦–é€‰æ—¶åŒº(åŸºäºå…¶è®¾å¤‡è®¾ç½®ï¼Œè€Œéå…¶ä½ç½®)ã€‚</em></p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="797b" class="mp kz jd nm b gy nq nr l ns nt">console.log(RNLocalize.getTimeZone());<br/>// -&gt; "Europe/Paris"</span></pre><p id="7a6f" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¥½çš„ï¼Œå¾ˆå¥½ã€‚æˆ‘åƒå¾€å¸¸ä¸€æ ·å°†è¿™ä¸ªåŒ…å®‰è£…åˆ°æˆ‘çš„é¡¹ç›®ä¸­:</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="d90c" class="mp kz jd nm b gy nq nr l ns nt">yarn add react-native-localize</span><span id="acdc" class="mp kz jd nm b gy nu nr l ns nt">cd ios &amp;&amp; pod install</span><span id="1607" class="mp kz jd nm b gy nu nr l ns nt">cd ..</span><span id="2dda" class="mp kz jd nm b gy nu nr l ns nt">yarn run ios</span></pre><p id="1fcc" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">æˆ‘è¿è¡Œäº†ä¸Šé¢çš„ä¾‹å­:</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="8e2a" class="mp kz jd nm b gy nq nr l ns nt">console.log(RNLocalize.getTimeZone());<br/>// -&gt; "Asia/Shanghai"</span></pre><p id="23b7" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¥½æäº†ã€‚å¦‚æœæƒ…å†µå˜å¾—æ›´ç³Ÿï¼Œæˆ‘å¯ä»¥åšä¸€ä¸ªæŸ¥æ‰¾è¡¨ï¼Œè®°å½•ä¸åŒæ—¶åŒºä½•æ—¶è¿›å…¥å¤ä»¤æ—¶ç­‰ã€‚<strong class="kc je">ä½†æ˜¯ç»è¿‡ä¸€äº›google-fuä¹‹åï¼Œå°±æ²¡æœ‰è¿™ä¸ªå¿…è¦äº†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼•å…¥momentæ—¶åŒºåº“ã€‚</strong></p><h1 id="9368" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">æ—¶åˆ»æ—¶åŒº</h1><p id="41ee" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated"><a class="ae ja" href="https://momentjs.com/timezone/" rel="noopener ugc nofollow" target="_blank">æ—¶åˆ»æ—¶åŒºæ–‡ä»¶</a></p><p id="3c8d" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">moment timezoneåº“å¯ä»¥è·å–ä¸Šé¢ç”Ÿæˆçš„æ—¶åŒºå€¼ï¼Œå¹¶è¿”å›UTCåç§»é‡ã€‚æ•´æ´ï¼</p><p id="1c23" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ng">å®‰è£…:</em></p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="8e8b" class="mp kz jd nm b gy nq nr l ns nt">yarn add moment-timezone</span></pre><p id="4b63" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ç»“åˆè·å–ä¸Šé¢çš„è®¾å¤‡æ—¶åŒºï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒ:</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="eae0" class="mp kz jd nm b gy nq nr l ns nt">import React, {useState, useEffect} from 'react';<br/>import {View, Text} from 'react-native';</span><span id="0624" class="mp kz jd nm b gy nu nr l ns nt">import {formatTimeByOffset} from '../helpers/formatTimeByOffset';<br/>import * as RNLocalize from 'react-native-localize';<br/>import moment from 'moment-timezone';</span><span id="102d" class="mp kz jd nm b gy nu nr l ns nt">function Component() {<br/>  const [timeToDisplay, setTimeToDisplay] = useState('');</span><span id="0446" class="mp kz jd nm b gy nu nr l ns nt">const backEndTimeStamp = '2001-04-11 10:00:00';</span><span id="904f" class="mp kz jd nm b gy nu nr l ns nt">// get device timezone eg. -&gt; "Asia/Shanghai"<br/>  const deviceTimeZone = RNLocalize.getTimeZone();</span><span id="a5eb" class="mp kz jd nm b gy nu nr l ns nt">// Make moment of right now, using the device timezone<br/>  const today = moment().tz(deviceTimeZone);</span><span id="e1c0" class="mp kz jd nm b gy nu nr l ns nt">// Get the UTC offset in hours<br/>  const currentTimeZoneOffsetInHours = today.utcOffset() / 60;</span><span id="bf12" class="mp kz jd nm b gy nu nr l ns nt">useEffect(() =&gt; {<br/>    // Run the function as we coded above.<br/>    const convertedToLocalTime = formatTimeByOffset(<br/>      backEndTimeStamp,<br/>      currentTimeZoneOffsetInHours,<br/>    );</span><span id="cf90" class="mp kz jd nm b gy nu nr l ns nt">// Set the state or whatever<br/>    setTimeToDisplay(convertedToLocalTime);<br/>  }, []);</span><span id="933f" class="mp kz jd nm b gy nu nr l ns nt">return (<br/>    &lt;View<br/>      style={{<br/>        height: '100%',<br/>        width: '100%',<br/>        alignItems: 'center',<br/>        justifyContent: 'center',<br/>      }}&gt;<br/>      &lt;Text style={{fontSize: 22, marginBottom: 20}}&gt;Time-Example&lt;/Text&gt;<br/>      &lt;Text style={{fontSize: 14, marginBottom: 20}}&gt;<br/>        Time passed into the function: {backEndTimeStamp}<br/>      &lt;/Text&gt;<br/>      &lt;Text style={{fontSize: 14, marginBottom: 20}}&gt;<br/>        Converted To local timezone: {timeToDisplay}<br/>      &lt;/Text&gt;<br/>      &lt;Text&gt;Your timezone: {deviceTimeZone}&lt;/Text&gt;<br/>    &lt;/View&gt;<br/>  );<br/>}</span><span id="d955" class="mp kz jd nm b gy nu nr l ns nt">export default Component;</span></pre><p id="b831" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å®é™…è¿è¡Œä¸­çš„ä»£ç ï¼</p><figure class="nh ni nj nk gt ip gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2221574457ee2b81601f1d55d2de1e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*CXnvw2wM58IZlKjBWz7Q-A.png"/></div></figure><p id="e19a" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae ja" href="https://github.com/ugglr/Mini-Tutorials-React-Native/blob/master/examples/src/screens/TimeZoneExample.js" rel="noopener ugc nofollow" target="_blank">è¿™æ˜¯Githubä¸Šçš„ä»£ç </a></p><h1 id="e9cb" class="ky kz jd bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">æˆåŠŸï¼</h1><p id="a5fb" class="pw-post-body-paragraph ka kb jd kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">æˆ‘è®¤ä¸ºæœ‰å¾ˆå¥½çš„æ–¹æ³•ä½¿å®ƒæ›´ç´§å‡‘ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªæ•™ç¨‹ï¼Œæˆ‘å®æ„¿è¯´å¾—å¤šä¸€ç‚¹ä¹Ÿä¸è¦é”™è¿‡ä¸€äº›ç»†èŠ‚ã€‚</p><p id="26a8" class="pw-post-body-paragraph ka kb jd kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">å¦‚æœæ‚¨è§‰å¾—è¿™æœ‰å¸®åŠ©ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼</p></div></div>    
</body>
</html>