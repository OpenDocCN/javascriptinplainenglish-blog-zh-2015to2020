<html>
<head>
<title>How to Transform a Frontend Project Into a Chrome Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将前端项目转换成Chrome扩展</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-transform-a-frontend-project-into-a-chrome-extension-675d0821cc6d?source=collection_archive---------8-----------------------#2020-09-05">https://javascript.plainenglish.io/how-to-transform-a-frontend-project-into-a-chrome-extension-675d0821cc6d?source=collection_archive---------8-----------------------#2020-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="eab1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">花几分钟拓展自己的知识领域。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9f1cf0da0f68719066e388a9456d4260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5nH9L1I-Z1qBpBZvVA76-A.jpeg"/></div></div></figure><p id="9c02" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Chrome扩展可以极大地扩展Chrome的功能，具有巨大的市场和商业价值。作为一个前端程序员，能不能写一个Chrome扩展？</p><p id="e02f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Chrome扩展是用HTML、CSS、JavaScript编写的，我们不需要学习新的开发语言。每个前端开发人员都可以轻松地将他们现有的项目转换为Chrome扩展项目。</p><p id="db85" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">假设我们现在有一个非常简单的前端项目，其中目前只有一个<code class="fe ln lo lp lq b">index.html</code>文件。该文件用于显示当前系统时间:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lt"><img src="../Images/11ca106a35162437ed0fdfab7b3d74ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fWug64dlVqJfnbccaD4ZNQ.gif"/></div></div></figure><p id="9f0f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">好了，让我们开始把这个非常简单的前端项目转化为Chrome扩展。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lu"><img src="../Images/84e8ed4d0926668cd82ef6960d1f6afa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_iGOtnUxlTZ9lHhvznsR3A.png"/></div></div></figure><h1 id="55ab" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">manifest.json</h1><p id="dd15" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">Chrome规定所有的扩展项目在根目录下必须有一个<code class="fe ln lo lp lq b">manifest.json</code>文件，该文件标识一个扩展项目并执行各种配置。</p><p id="7b36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，让我们向项目的根目录添加一个清单文件，并编写以下代码。</p><pre class="kg kh ki kj gt ms lq mt mu aw mv bi"><span id="b7b8" class="mw lw iq lq b gy mx my l mz na">{<br/>  "name": "My Extension",<br/>  "version": "1.0",<br/>  "manifest_version": 2,<br/>  "browser_action": {<br/>    "default_popup": "index.html"<br/>  }<br/>}</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/52c1b01c7609ec11ff8fd7585a585cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBgb6xxy_v71N3K_hqwqmQ.png"/></div></div></figure><p id="56c9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">name</code>字段声明了我们的扩展的名称，如果你将来把它上传到Chrome网络商店，这将是你的扩展的名称。<code class="fe ln lo lp lq b">version</code>是我们项目的版本号。<code class="fe ln lo lp lq b">manifest_version</code>是我们清单文件的版本号，到目前为止这个值总是2。</p><p id="45e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">browser_action</code>字段用于配置我们的扩展的行为。当我们点击Chrome中的扩展时，我们从对应于<code class="fe ln lo lp lq b">default_popup</code>的HTML文件中打开呈现的页面。</p><p id="c4a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面的GIF是这个扩展现在的样子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/aa1d7a6386190cde5940abc8f23c247e.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/1*NFLqhaIF9p97XxUacVIeaQ.gif"/></div></figure><h1 id="0c30" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">安装扩展</h1><p id="958a" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">配置完成后，我们现在准备安装刚刚写入Chrome浏览器的扩展，这样我们就可以测试这个项目了。</p><p id="3a3c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装扩展有三个步骤:</p><ul class=""><li id="f336" class="nd ne iq kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">打开chrome://extensions/</li><li id="c7ab" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">打开<code class="fe ln lo lp lq b">developer mode</code></li><li id="edf3" class="nd ne iq kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">取消加载解包项目</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/f166bf3af59a06f6fc52389fd5b0c701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e68O1bpF3tMVYT9P9f3YPg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/6932be9d6457615a84f737e70b096c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VighKbNtViVV5pdKQVX6yw.gif"/></div></div></figure><h1 id="0274" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">HTML脚本</h1><p id="8f98" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">细心的读者可能已经注意到，HTML中的JavaScript脚本并没有被执行。</p><p id="f107" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们的HTML文件中有这个脚本:</p><pre class="kg kh ki kj gt ms lq mt mu aw mv bi"><span id="7b2b" class="mw lw iq lq b gy mx my l mz na">&lt;script type="text/javascript"&gt;<br/>    let interval = setInterval(() =&gt; {<br/>      document.getElementById("localTime")<br/>        .innerText = new Date().toString()<br/>    }, 1000);<br/>&lt;/script&gt;</span></pre><p id="58fa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是这段代码没有被执行。这是因为Chrome规定来自扩展中HTML文件的JavaScript脚本只能放在单独的文件中，不能嵌入HTML文件中。所以我们需要创建一个额外的<code class="fe ln lo lp lq b">.js</code>文件，并将JavaScript代码放在那里。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/6bf4c68e9b6e461a3edb60d8763ab2fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*usmnktz80Er0KtlGM5fDbw.png"/></div></div></figure><p id="6741" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在HTML文件中，我们可以简单地引用这段代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/31dee8a016fe50745bce953a2d2ad89d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GeViavziLrokBA_hZwqqqA.png"/></div></div></figure><p id="d0dc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此时，我们正在重新加载我们的扩展，我们可以看到JavaScript脚本工作正常。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/716e9605807cd882d26350c2c2da7547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpaCQo-ROcBG4FFweytc-g.png"/></div></div><figcaption class="nw nx gj gh gi ny nz bd b be z dk">Click this to reload extension</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/b417431cf26cb8cae209b74e672b3664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdDdTJCJp8H8ld6hQqnMSg.png"/></div></div><figcaption class="nw nx gj gh gi ny nz bd b be z dk">The script works.</figcaption></figure><h1 id="d8a8" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">图标</h1><p id="49ac" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">接下来，让我们给扩展添加一个好看的图标。</p><p id="aa72" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先我们准备一个图像，然后把它放到项目中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/e9cd211af9ca45e48ec869138c6f35df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*XYGoKrb1w5zdWZLOIEevZg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/c4c434cba761a9840e340af6334ae678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Gd79d62AVsTn53a3LvEug.png"/></div></div></figure><p id="3358" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们需要配置清单文件来声明我们的徽标。具体来说，我们可以这样写:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/0858dd61c63fcfe6aa2560a19eb232d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*36SDXbs6GK6ipY-jQdHpNA.png"/></div></div></figure><p id="99bb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">default_icon</code>字段用于声明图标。现在刷新我们的扩展，你会看到标志已经改变。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/951141c316b34e1f5e679d0e4da5c8c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*sc1zWTAEelkSP-nmk6-hEw.png"/></div></figure><h1 id="f3d3" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">背景脚本</h1><p id="77ef" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">以前的JavaScript脚本的一个缺点是，它们直到用户点击扩展图标时才开始运行。但是很多时候，我们希望用户一启动浏览器脚本就开始执行，那么我们该怎么做呢？</p><p id="5f81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，让我们简单地编写一个新脚本:</p><pre class="kg kh ki kj gt ms lq mt mu aw mv bi"><span id="79df" class="mw lw iq lq b gy mx my l mz na">alert("Hello! -- from background/main.js")</span><span id="6347" class="mw lw iq lq b gy of my l mz na">setTimeout(()=&gt;{<br/>  alert("Hi! -- from background/main.js")<br/>}, 2000)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/007e0860701355a8de317ad60a02baa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoeJY3C_n12DwQbabaLjhA.png"/></div></div></figure><p id="b5b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后配置清单文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/6f1a866fb33a86b2e79da57786e6e9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vac1zUFV0NR7BGROR6mVyg.png"/></div></div></figure><p id="82eb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">background/script</code>字段用于配置脚本在后台运行。这是一个可以配置多个文件在后台运行的阵列。</p><p id="0ab0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，让我们重新加载扩展并测试它是如何工作的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/3641c5ff2c145e4d1cad329776041bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*af1HA-hUKLIQ8LjiP--Alw.gif"/></div></div><figcaption class="nw nx gj gh gi ny nz bd b be z dk">it works.</figcaption></figure><h1 id="0a43" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">内容脚本</h1><p id="f4ab" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">有时我们想要在用户打开网页后执行脚本的扩展。例如，当用户打开Medium.com时，会弹出<code class="fe ln lo lp lq b">“Hello Medium”</code>。当用户打开GitHub.com时，弹出<code class="fe ln lo lp lq b">“Hi, GitHub”</code>。</p><p id="be20" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为此，我们需要使用内容脚本。上下文脚本是仅当用户打开某些网页时才执行的脚本。</p><p id="0b27" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从编写两个简单的脚本文件开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/022c130ccbb1dfbb48569f8a55481543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pi0oZOYGHcU5hve_ZP19EA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/5f0228112523f3a3f02c81dee2ecae46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXRtkk6Z7CPOtFTGTx4Etg.png"/></div></div></figure><p id="f919" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后配置清单文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/dedc03f1cdc28317766ebe7498536a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h8JpQ81kUNQ26QcohSt77w.png"/></div></div></figure><pre class="kg kh ki kj gt ms lq mt mu aw mv bi"><span id="f4d1" class="mw lw iq lq b gy mx my l mz na">"content_scripts": [<br/>    {<br/>      "matches": ["*://medium.com/*"],<br/>      "js": ["content/medium.com.js"]<br/>    }, {<br/>      "matches": ["*://github.com/*"],<br/>      "js": ["content/github.com.js"]<br/>    }<br/>  ]</span></pre><p id="a493" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">"*://medium.com/*”</code>将匹配介质上的任何页面，所以当我们打开任何介质页面时，<code class="fe ln lo lp lq b">“content/medium.com.js”</code>将被执行。</p><p id="9c69" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">"*://github.com/*”</code>将匹配GitHub上的任何页面，所以当我们打开任何GitHub页面时，<code class="fe ln lo lp lq b">“content/github.com.js”</code>将被执行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/5f0228112523f3a3f02c81dee2ecae46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXRtkk6Z7CPOtFTGTx4Etg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/022c130ccbb1dfbb48569f8a55481543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pi0oZOYGHcU5hve_ZP19EA.png"/></div></div></figure><h1 id="8d65" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">结论</h1><p id="61e4" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">好了，这篇文章涵盖了开发Chrome扩展的基础，现在你可以把自己的一个前端项目变成一个Chrome扩展了。</p><p id="3ddf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该项目的源代码可以在GitHub上找到:</p><div class="om on gp gr oo op"><a href="https://github.com/bitfishxyz/ChromeExtensionDemo" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ir gy z fp ou fr fs ov fu fw ip bi translated">bitfishxyz/ChromeExtensionDemo</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">在GitHub上创建一个帐户，为bitfishxyz/ChromeExtensionDemo开发做贡献。</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">github.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd kp op"/></div></div></a></div></div></div>    
</body>
</html>