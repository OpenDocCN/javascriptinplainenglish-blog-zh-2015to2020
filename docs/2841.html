<html>
<head>
<title>Vue Tips — Login, GET Requests and Serve Vue Project via HTTPS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue提示—通过HTTPS登录、获取请求和服务Vue项目</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-tips-login-get-requests-and-serve-vue-project-via-https-c6ad1e08fec2?source=collection_archive---------8-----------------------#2020-07-28">https://javascript.plainenglish.io/vue-tips-login-get-requests-and-serve-vue-project-via-https-c6ad1e08fec2?source=collection_archive---------8-----------------------#2020-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b6bc2519b52da18d1f2cd08c80e11d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Kg1wbuB5bgjtYLwv"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@queirozmm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matheus Queiroz</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d1f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vue.js是一个用于创建前端web应用程序的流行框架。</p><p id="f2a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将了解一些编写更好的Vue.js应用程序的技巧。</p><h1 id="29bc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Axios强制下载GET请求</h1><p id="e861" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">通过将响应数据传递到<code class="fe me mf mg mh b">Blob</code>构造函数中，我们可以使响应总是下载的。</p><p id="dd4b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d1a2" class="mq lc iq mh b gy mr ms l mt mu">axios<br/>  .get(`download-pdf`, {<br/>    responseType: 'arraybuffer'<br/>  })<br/>  .then(response =&gt; {<br/>    const blob = new Blob(<br/>      [response.data], <br/>      { type: 'application/pdf' }<br/>    ),<br/>    const url = window.URL.createObjectURL(blob);<br/>    window.open(url) ;<br/>  })</span></pre><p id="6bef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们向<code class="fe me mf mg mh b">download-pdf</code>端点发出GET请求，下载我们的PDF。</p><p id="ff91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们确保我们指定了<code class="fe me mf mg mh b">responseType</code>是<code class="fe me mf mg mh b">'arraybuffer'</code>来表明它是一个二进制文件。</p><p id="5cf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在<code class="fe me mf mg mh b">then</code>回调中，我们得到了<code class="fe me mf mg mh b">response</code>参数，它在<code class="fe me mf mg mh b">data</code>属性中包含了我们想要的数据。</p><p id="6631" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将它传递给数组中的<code class="fe me mf mg mh b">Blob</code>构造函数。</p><p id="a5c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们指定响应数据的MIME类型。</p><p id="8e0a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们创建URL，让我们用<code class="fe me mf mg mh b">createObjectURL</code>下载文件。</p><p id="a0d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们用<code class="fe me mf mg mh b">url</code>调用<code class="fe me mf mg mh b">window.open</code>来下载文件。</p><p id="c7ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以通过在<code class="fe me mf mg mh b">then</code>回调中做一个小的改变来指定下载文件的文件名。</p><p id="94d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="f012" class="mq lc iq mh b gy mr ms l mt mu">axios<br/>  .get(`download-pdf`, {<br/>    responseType: 'arraybuffer'<br/>  })<br/>  .then(response =&gt; {<br/>    const blob = new Blob(<br/>      [response.data], <br/>      { type: 'application/pdf' }<br/>    ),<br/>    const link = document.createElement('a');<br/>    link.href = window.URL.createObjectURL(blob);<br/>    link.download = "file.pdf";<br/>    link.click();<br/>  })</span></pre><p id="c56e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们没有直接创建一个对象URL，而是先创建一个不可见的链接，并将文件名设置为它的<code class="fe me mf mg mh b">download</code>属性。</p><p id="61d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">click</code>来下载。</p><h1 id="3d48" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">当垂直模型改变时触发事件</h1><p id="b6f9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以在输入中添加一个变更事件监听器来监听输入值的变更。</p><p id="a2ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="94a3" class="mq lc iq mh b gy mr ms l mt mu">&lt;input <br/>  type="radio" <br/>  name="option" <br/>  value=""<br/>  v-model="status" <br/>  v-on:change="onChange"<br/>&gt;</span></pre><p id="32e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">onChange</code>是变更事件处理程序的名称。</p><p id="6574" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以将<code class="fe me mf mg mh b">v-on:</code>简称为<code class="fe me mf mg mh b">@</code>:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="aa84" class="mq lc iq mh b gy mr ms l mt mu">&lt;input <br/>  type="radio" <br/>  name="option" <br/>  value=""<br/>  v-model="status" <br/>  @change="onChange"<br/>&gt;</span></pre><p id="c9e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们可以为我们的模型属性添加一个观察器，而不是附加一个变更事件侦听器。</p><p id="9e48" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="df32" class="mq lc iq mh b gy mr ms l mt mu">new Vue({<br/>  el: "#app",<br/>  data: {   <br/>    status: ''<br/>  },<br/>  watch: {<br/>    status(val, oldVal) {<br/>      console.log(val, oldVal)<br/>    }<br/>  }<br/>});</span></pre><p id="6078" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe me mf mg mh b">watch</code>属性，我们为<code class="fe me mf mg mh b">status</code>变量添加了一个观察器，如名称所示。</p><p id="c099" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">val</code>为当前值，<code class="fe me mf mg mh b">oldVal</code>为旧值。</p><h1 id="49e0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用Vue路由器登录后重定向到请求的页面</h1><p id="6d07" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当重定向到登录页面时，我们可以向查询参数添加一个重定向路径。</p><p id="8b36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="616e" class="mq lc iq mh b gy mr ms l mt mu">onClick() {<br/>  if (!isAuthenticated) {<br/>    this.$router.push({ name: 'login', query: { redirect: '/profile' } });<br/>  }<br/>}</span></pre><p id="e017" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们检查认证凭证。</p><p id="af05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果他们不存在，那么我们调用<code class="fe me mf mg mh b">this.$router.push</code>来重定向到登录页面的路径。</p><p id="b6f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">query</code>属性有登录成功时重定向到的路径。</p><p id="8b9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个带有<code class="fe me mf mg mh b">redirect</code>键和<code class="fe me mf mg mh b">/profile</code>值的查询字符串。</p><p id="fb1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，在我们的登录表单组件中，我们可以编写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ed65" class="mq lc iq mh b gy mr ms l mt mu">submitForm() {<br/>  login(this.credentials)<br/>    .then(() =&gt; this.$router.push(this.$route.query.redirect || '/'))<br/>    .catch(error =&gt; {<br/>       //...<br/>    })<br/>}</span></pre><p id="b3a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">methods</code>地产。</p><p id="ecf0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们称之为<code class="fe me mf mg mh b">login</code>，它返回一个承诺。</p><p id="48ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们可以用回调函数调用<code class="fe me mf mg mh b">then</code>来重定向到查询字符串中的路径。</p><p id="eaad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到了带有<code class="fe me mf mg mh b">this.$route.query.redirect</code>属性的路径。</p><p id="7df1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">this.$router.push</code>进行重定向。</p><p id="ec84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果没有定义，我们重定向到<code class="fe me mf mg mh b">/</code>路线。</p><h1 id="d94d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用HTTPS运行Vue.js开发服务器</h1><p id="2a23" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以通过修改<code class="fe me mf mg mh b">build/dev-server.js</code>中的代码来读取证书和私钥文件，从而运行Vue的开发服务器和HTTPS。</p><p id="5016" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以用它们调用<code class="fe me mf mg mh b">https.createServer</code>来创建HTTPS服务器。</p><p id="f4fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9860" class="mq lc iq mh b gy mr ms l mt mu">const https = require('https');<br/>const fs = require('fs');<br/>const options = {<br/>  key: fs.readFileSync('key.pem'),<br/>  cert: fs.readFileSync('cert.pem'))<br/>};<br/>const server = https.createServer(options, app).listen(port);</span></pre><p id="10fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们读取文件并将它们放入<code class="fe me mf mg mh b">options</code>对象中。</p><p id="54e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将对象传递给<code class="fe me mf mg mh b">https.createServer</code>方法。</p><p id="1967" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">app</code>是快递服务器的app对象。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/31010a9648d94761c1528397f861527f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QLlqGNztduxp-OIt"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@agmakonts?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Adam Grabek</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="3ae4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="b728" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以提供一个开发HTTPS服务器Vue项目。</p><p id="791b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有，我们可以用Axios下载文件。</p><p id="3ed2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以添加观察器来观察可变的变化。</p><h2 id="76bf" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">简单英语的JavaScript</h2><p id="0430" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">喜欢这篇文章吗？如果有，通过<a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">订阅解码，我们的YouTube频道</strong> </a> <strong class="kf ir">获取更多类似内容！</strong></p></div></div>    
</body>
</html>