<html>
<head>
<title>How to add Drag and Drop features to your React app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向React应用程序添加拖放功能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-add-drag-and-drop-feature-to-your-react-app-20cb22fb180?source=collection_archive---------0-----------------------#2019-10-05">https://javascript.plainenglish.io/how-to-add-drag-and-drop-feature-to-your-react-app-20cb22fb180?source=collection_archive---------0-----------------------#2019-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bdfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在在</strong><a class="ae kl" href="http://jauyeung.net/subscribe/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">http://jauyeung.net/subscribe/</strong></a><strong class="jp ir">订阅我的邮件列表。</strong></p><p id="50ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在推特上关注我</strong><a class="ae kl" href="https://twitter.com/AuMayeung" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">https://twitter.com/AuMayeung</strong></a></p><p id="f730" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">拖放是web应用程序中常用的功能。它提供了一种直观的数据操作方式。React是一个用于构建web UI的优秀库，因为它以React组件的形式提供了高质量的拖放库。react-beautiful-dnd是JIRA任务管理系统的创建者Atlassian写的。这是一个拖放库，是最容易集成到应用程序中的库之一。</p><p id="30ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个故事中，我们将构建一个包含拖放功能的待办事项列表。我们有一个主页，在顶部创建一个任务的表单，然后在它下面，将有两个并排的列表，左边的列表显示待办事项，右边的列表显示已完成的项目。也将有一个用户从2个列表中删除任务的方法。Redux存储将用于存储整个待办事项列表。</p><p id="8417" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了开始构建应用程序，我们使用了一种最简单的方法，来自脸书的Create React应用程序。为了使用它，我们运行<code class="fe km kn ko kp b">npx create-react-app todo-app</code>。这将创建包含初始应用程序代码的项目文件夹。</p><p id="5f97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们安装一些我们需要的库。我们需要一个HTTP客户端，react-beautiful-dnd库，Bootstrap，Redux和react路由器。我们需要一个HTTP客户端来发出HTTP请求，Bootstrap使样式变得容易，我们使用React路由器进行客户端路由。我们运行<code class="fe km kn ko kp b">npm i axios bootstrap react-bootstrap formik yup react-beautiful-dnd react-router-dom react-redux</code>来安装库。Axios是我们的HTTP客户端，Formik和Yup是表单验证库，可以与React Bootstrap一起使用，以节省创建表单的工作量。</p><p id="939e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装好我们需要的所有库后，我们就可以开始编写应用程序了。我们把所有东西都放在<code class="fe km kn ko kp b">src</code>文件夹里，除非另有说明。首先，我们创建一个名为<code class="fe km kn ko kp b">actionCreator.js</code>的文件，并添加:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="4ff6" class="ky kz iq kp b gy la lb l lc ld">import { SET_TASKS } from './actions';</span><span id="d44f" class="ky kz iq kp b gy le lb l lc ld">const setTasks = (tasks) =&gt; {<br/>    return {<br/>        type: SET_TASKS,<br/>        payload: tasks<br/>    }<br/>};</span><span id="d0c6" class="ky kz iq kp b gy le lb l lc ld">export { setTasks };</span></pre><p id="68d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们创造了<code class="fe km kn ko kp b">action.js</code>,我们在里面放了:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="8952" class="ky kz iq kp b gy la lb l lc ld">const SET_TASKS = 'SET_TASKS';</span><span id="7076" class="ky kz iq kp b gy le lb l lc ld">export { SET_TASKS };</span></pre><p id="b8fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这两个文件一起创建了我们分派给Redux存储的操作，我们将很快构建这个存储。</p><p id="9951" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">App.js</code>中，我们用以下内容替换现有内容:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="084a" class="ky kz iq kp b gy la lb l lc ld">import React from 'react';<br/>import { Router, Route, Link } from "react-router-dom";<br/>import HomePage from './HomePage';<br/>import { createBrowserHistory as createHistory } from 'history'<br/>import Navbar from 'react-bootstrap/Navbar';<br/>import Nav from 'react-bootstrap/Nav';<br/>import './App.css';<br/>const history = createHistory();</span><span id="994b" class="ky kz iq kp b gy le lb l lc ld">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Router history={history}&gt;<br/>        &lt;Navbar bg="primary" expand="lg" variant="dark" &gt;<br/>          &lt;Navbar.Brand href="#home"&gt;Drag and Drop App&lt;/Navbar.Brand&gt;<br/>          &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>          &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>            &lt;Nav className="mr-auto"&gt;<br/>              &lt;Nav.Link href="/"&gt;Home&lt;/Nav.Link&gt;<br/>            &lt;/Nav&gt;<br/>          &lt;/Navbar.Collapse&gt;<br/>        &lt;/Navbar&gt;<br/>        &lt;Route path="/" exact component={HomePage} /&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="f71c" class="ky kz iq kp b gy le lb l lc ld">export default App;</span></pre><p id="8b3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将在顶部添加导航栏，并让我们在底部显示我们定义的路线。主页应该是唯一的途径。</p><p id="aebd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">HomePage.js</code>中，我们输入:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="98d0" class="ky kz iq kp b gy la lb l lc ld">import React from 'react';<br/>import { useState, useEffect } from 'react';<br/>import './HomePage.css';<br/>import { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';<br/>import { connect } from 'react-redux';<br/>import TaskForm from './TaskForm';<br/>import { editTask, getTasks, deleteTask } from './requests';</span><span id="c822" class="ky kz iq kp b gy le lb l lc ld">function HomePage({ tasks }) {<br/>  const [items, setItems] = useState([]);<br/>  const [todoItems, setTodoItems] = useState([]);<br/>  const [doneItems, setDoneItems] = useState([]);<br/>  const [initialized, setInitialized] = useState(false);</span><span id="77dd" class="ky kz iq kp b gy le lb l lc ld">const onDragEnd = async (evt) =&gt; {<br/>    const { source } = evt;<br/>    let item = {};<br/>    if (source.droppableId == "todoDroppable") {<br/>      item = todoItems[source.index];<br/>      item.done = true;<br/>    }<br/>    else {<br/>      item = doneItems[source.index];<br/>      item.done = false;<br/>    }<br/>    await editTask(item);<br/>    await getTodos();<br/>  };</span><span id="d171" class="ky kz iq kp b gy le lb l lc ld">const setAllItems = (data) =&gt; {<br/>    if (!Array.isArray(data)) {<br/>      return;<br/>    }<br/>    setItems(data);<br/>    setTodoItems(data.filter(i =&gt; !i.done));<br/>    setDoneItems(data.filter(i =&gt; i.done));<br/>  }</span><span id="67ca" class="ky kz iq kp b gy le lb l lc ld">const getTodos = async () =&gt; {<br/>    const response = await getTasks();<br/>    setAllItems(response.data);<br/>    setInitialized(true);<br/>  }</span><span id="cfdb" class="ky kz iq kp b gy le lb l lc ld">const removeTodo = async (task) =&gt; {<br/>    await deleteTask(task.id);<br/>    await getTodos();<br/>  }</span><span id="9829" class="ky kz iq kp b gy le lb l lc ld">useEffect(() =&gt; {<br/>    setAllItems(tasks);<br/>    if (!initialized) {<br/>      getTodos();<br/>    }<br/>  }, [tasks]);</span><span id="9748" class="ky kz iq kp b gy le lb l lc ld">return (<br/>    &lt;div className="App"&gt;<br/>      &lt;div className='col-12'&gt;<br/>        &lt;TaskForm /&gt;<br/>        &lt;br /&gt;<br/>      &lt;/div&gt;<br/>      &lt;div className='col-12'&gt;<br/>        &lt;div className='row list'&gt;<br/>          &lt;DragDropContext onDragEnd={onDragEnd}&gt;<br/>            &lt;Droppable droppableId="todoDroppable"&gt;<br/>              {(provided, snapshot) =&gt; (<br/>                &lt;div<br/>                  className='droppable'<br/>                  ref={provided.innerRef}<br/>                &gt;<br/>                  &amp;nbsp;<br/>                  &lt;h2&gt;To Do&lt;/h2&gt;<br/>                  &lt;div class="list-group"&gt;<br/>                    {todoItems.map((item, index) =&gt; (<br/>                      &lt;Draggable<br/>                        key={item.id}<br/>                        draggableId={item.id}<br/>                        index={index}<br/>                      &gt;<br/>                        {(provided, snapshot) =&gt; (<br/>                          &lt;div<br/>                            className='list-group-item '<br/>                            ref={provided.innerRef}<br/>                            {...provided.draggableProps}<br/>                            {...provided.dragHandleProps}<br/>                          &gt;<br/>                            {item.description}<br/>                            &lt;a onClick={removeTodo.bind(this, item)}&gt;<br/>                              &lt;i class="fa fa-close"&gt;&lt;/i&gt;<br/>                            &lt;/a&gt;<br/>                          &lt;/div&gt;<br/>                        )}<br/>                      &lt;/Draggable&gt;<br/>                    ))}<br/>                  &lt;/div&gt;<br/>                  {provided.placeholder}<br/>                &lt;/div&gt;<br/>              )}<br/>            &lt;/Droppable&gt;<br/>            &lt;Droppable droppableId="doneDroppable"&gt;<br/>              {(provided, snapshot) =&gt; (<br/>                &lt;div<br/>                  className='droppable'<br/>                  ref={provided.innerRef}<br/>                &gt;<br/>                  &amp;nbsp;<br/>                  &lt;h2&gt;Done&lt;/h2&gt;<br/>                  &lt;div class="list-group"&gt;<br/>                    {doneItems.map((item, index) =&gt; (<br/>                      &lt;Draggable<br/>                        key={item.id}<br/>                        draggableId={item.id}<br/>                        index={index}<br/>                      &gt;<br/>                        {(provided, snapshot) =&gt; (<br/>                          &lt;div<br/>                            className='list-group-item'<br/>                            ref={provided.innerRef}<br/>                            {...provided.draggableProps}<br/>                            {...provided.dragHandleProps}<br/>                          &gt;<br/>                            {item.description}<br/>                            &lt;a onClick={removeTodo.bind(this, item)}&gt;<br/>                              &lt;i class="fa fa-close"&gt;&lt;/i&gt;<br/>                            &lt;/a&gt;<br/>                          &lt;/div&gt;<br/>                        )}<br/>                      &lt;/Draggable&gt;<br/>                    ))}<br/>                  &lt;/div&gt;<br/>                  {provided.placeholder}<br/>                &lt;/div&gt;<br/>              )}<br/>            &lt;/Droppable&gt;<br/>          &lt;/DragDropContext&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="9d98" class="ky kz iq kp b gy le lb l lc ld">const mapStateToProps = state =&gt; {<br/>  return {<br/>    tasks: state.tasks,<br/>  }<br/>}</span><span id="7c72" class="ky kz iq kp b gy le lb l lc ld">export default connect(<br/>  mapStateToProps,<br/>  null<br/>)(HomePage);</span></pre><p id="6d09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是拖放逻辑所在的地方。我们有2个<code class="fe km kn ko kp b">Droppable</code>组件，其中有2个列表来存储待办事项和已完成事项。我们唯一需要的拖放处理程序是<code class="fe km kn ko kp b">onDragEnd</code>处理程序。这就是我们根据拖动项目的<code class="fe km kn ko kp b">source</code>更新任务项目的<code class="fe km kn ko kp b">done</code>标志的地方。如果我们从带有<code class="fe km kn ko kp b">todoDroppable</code>的<code class="fe km kn ko kp b">droppableId</code>的<code class="fe km kn ko kp b">Droppable</code>组件拖动，那么我们将<code class="fe km kn ko kp b">done</code>设置为<code class="fe km kn ko kp b">true</code>。否则，我们将<code class="fe km kn ko kp b">done</code>设置为<code class="fe km kn ko kp b">false</code>。完成之后，我们更新任务，然后获取最新的任务，并显示它们。我们还有一个删除任务的函数，叫做<code class="fe km kn ko kp b">removeTodo</code>，我们可以在这里删除一个任务。一旦它被删除，最新的名单将从后端获得。我们有<code class="fe km kn ko kp b">setAllItems</code>功能将任务分配到待办事项和已完成事项列表中。</p><p id="1ef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">useEffect</code>函数中，我们有第二个参数，数组的参数是<code class="fe km kn ko kp b">tasks</code>。这是为了触发被称为<code class="fe km kn ko kp b">tasks</code>变化的<code class="fe km kn ko kp b">useEffect</code>回调。如果你用其他道具替换<code class="fe km kn ko kp b">tasks</code>，同样的事情可以用于处理任何道具的改变。</p><p id="305f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">HomePage.css</code>中，我们输入:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="73e9" class="ky kz iq kp b gy la lb l lc ld">.item {<br/>  padding: 20px;<br/>  border: 1px solid black;<br/>  width: 40vw;<br/>}</span><span id="aa99" class="ky kz iq kp b gy le lb l lc ld">.list {<br/>  margin-left: 0px;<br/>}</span><span id="e7c5" class="ky kz iq kp b gy le lb l lc ld">.list-group-item {<br/>  display: flex;<br/>  justify-content: space-between;<br/>}</span><span id="3dbd" class="ky kz iq kp b gy le lb l lc ld">.list-group-item a {<br/>  cursor: pointer;<br/>}</span><span id="6679" class="ky kz iq kp b gy le lb l lc ld">.droppable {<br/>  min-height: 100px;<br/>  width: 40vw;<br/>  margin-right: 9vw;<br/>}</span></pre><p id="7a71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过给列表增加一些间距来改变列表的风格。</p><p id="1945" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于添加任务，我们有一个专用的<code class="fe km kn ko kp b">TaskForm</code>组件来添加任务。我们创建一个名为<code class="fe km kn ko kp b">TaskForm.js</code>的文件，并添加:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="04f3" class="ky kz iq kp b gy la lb l lc ld">import React from 'react';<br/>import { Formik } from 'formik';<br/>import Form from 'react-bootstrap/Form';<br/>import Col from 'react-bootstrap/Col';<br/>import Button from 'react-bootstrap/Button';<br/>import * as yup from 'yup';<br/>import { addTask, getTasks } from './requests';<br/>import { connect } from 'react-redux';<br/>import { setTasks } from './actionCreators';<br/>import './TaskForm.css';</span><span id="581c" class="ky kz iq kp b gy le lb l lc ld">const schema = yup.object({<br/>    description: yup.string().required('Description is required'),<br/>});</span><span id="27ce" class="ky kz iq kp b gy le lb l lc ld">function ContactForm({ setTasks }) {<br/>    const handleSubmit = async (evt) =&gt; {<br/>        const isValid = await schema.validate(evt);<br/>        if (!isValid) {<br/>            return;<br/>        }<br/>        await addTask(evt);<br/>        const response = await getTasks();<br/>        setTasks(response.data);<br/>    }</span><span id="1404" class="ky kz iq kp b gy le lb l lc ld">return (<br/>        &lt;div className="form"&gt;<br/>            &lt;Formik<br/>                validationSchema={schema}<br/>                onSubmit={handleSubmit}<br/>            &gt;<br/>                {({<br/>                    handleSubmit,<br/>                    handleChange,<br/>                    handleBlur,<br/>                    values,<br/>                    touched,<br/>                    isInvalid,<br/>                    errors,<br/>                }) =&gt; (<br/>                        &lt;Form noValidate onSubmit={handleSubmit}&gt;<br/>                            &lt;Form.Row&gt;<br/>                                &lt;Form.Group as={Col} md="12" controlId="firstName"&gt;<br/>                                    &lt;Form.Label&gt;<br/>                                        &lt;h4&gt;Add Task&lt;/h4&gt;<br/>                                    &lt;/Form.Label&gt;<br/>                                    &lt;Form.Control<br/>                                        type="text"<br/>                                        name="description"<br/>                                        placeholder="Task Description"<br/>                                        value={values.description || ''}<br/>                                        onChange={handleChange}<br/>                                        isInvalid={touched.description &amp;&amp; errors.description}<br/>                                    /&gt;<br/>                                    &lt;Form.Control.Feedback type="invalid"&gt;<br/>                                        {errors.description}<br/>                                    &lt;/Form.Control.Feedback&gt;<br/>                                &lt;/Form.Group&gt;<br/>                            &lt;/Form.Row&gt;<br/>                            &lt;Button type="submit" style={{ 'marginRight': '10px' }}&gt;Save&lt;/Button&gt;<br/>                        &lt;/Form&gt;<br/>                    )}<br/>            &lt;/Formik&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}</span><span id="a79e" class="ky kz iq kp b gy le lb l lc ld">ContactForm.propTypes = {<br/>}</span><span id="dffc" class="ky kz iq kp b gy le lb l lc ld">const mapStateToProps = state =&gt; {<br/>    return {<br/>        tasks: state.tasks,<br/>    }<br/>}</span><span id="1710" class="ky kz iq kp b gy le lb l lc ld">const mapDispatchToProps = dispatch =&gt; ({<br/>    setTasks: tasks =&gt; dispatch(setTasks(tasks))<br/>})</span><span id="dec1" class="ky kz iq kp b gy le lb l lc ld">export default connect(<br/>    mapStateToProps,<br/>    mapDispatchToProps<br/>)(ContactForm);</span></pre><p id="be74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有带表单验证的添加任务表单，用于检查描述是否已填写。一旦它有效，我们就把它提交给后端，然后获取最新的任务，并把它们存储在我们的Redux存储中。这些都在<code class="fe km kn ko kp b">handleSubmit</code>函数中完成。注意，我们只是用Yup库创建了一个<code class="fe km kn ko kp b">schema</code>对象，然后将它传递给<code class="fe km kn ko kp b">Formik</code>组件的<code class="fe km kn ko kp b">validationSchema</code>对象，然后<code class="fe km kn ko kp b">Formik</code>组件提供了<code class="fe km kn ko kp b">handleChange</code>函数、<code class="fe km kn ko kp b">values</code>对象和<code class="fe km kn ko kp b">errors</code>对象，我们可以直接在React Bootstrap表单中使用它们，这样我们就不用自己编写所有的更改处理程序代码了。我们还需要在<code class="fe km kn ko kp b">values</code>属性的末尾添加<code class="fe km kn ko kp b">|| ‘’</code>，以便<code class="fe km kn ko kp b">value</code>属性始终保持定义，防止触发不受控制的输入错误。文件底部的<code class="fe km kn ko kp b">mapStateToProps</code>将商店中的<code class="fe km kn ko kp b">tasks</code>状态映射到我们组件的<code class="fe km kn ko kp b">tasks</code>道具，而<code class="fe km kn ko kp b">mapDispatchToProps</code>将我们的<code class="fe km kn ko kp b">setTasks</code>分派函数映射到<code class="fe km kn ko kp b">TaskForm</code>组件的道具，我们使用该函数来更新带有任务的商店。</p><p id="db0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来在<code class="fe km kn ko kp b">index.js</code>中，我们将现有代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="a727" class="ky kz iq kp b gy la lb l lc ld">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import './index.css';<br/>import App from './App';<br/>import * as serviceWorker from './serviceWorker';<br/>import { tasksReducer } from './reducers';<br/>import { Provider } from 'react-redux'<br/>import { createStore, combineReducers } from 'redux'</span><span id="7185" class="ky kz iq kp b gy le lb l lc ld">const taskskApp = combineReducers({<br/>    tasks: tasksReducer,<br/>})</span><span id="c49d" class="ky kz iq kp b gy le lb l lc ld">const store = createStore(taskskApp);</span><span id="a1bc" class="ky kz iq kp b gy le lb l lc ld">ReactDOM.render(<br/>    &lt;Provider store={store}&gt;<br/>        &lt;App /&gt;<br/>    &lt;/Provider&gt;<br/>    , document.getElementById('root'));</span><span id="6c7f" class="ky kz iq kp b gy le lb l lc ld">// If you want your app to work offline and load faster, you can change<br/>// unregister() to register() below. Note this comes with some pitfalls.<br/>// Learn more about service workers: <a class="ae kl" href="https://bit.ly/CRA-PWA" rel="noopener ugc nofollow" target="_blank">https://bit.ly/CRA-PWA</a><br/>serviceWorker.unregister();</span></pre><p id="fdfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以便我们可以使用我们在应用程序中创建的Redux商店。</p><p id="ffe5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们创建一个名为<code class="fe km kn ko kp b">reducers.js</code>的文件，并添加:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="82e5" class="ky kz iq kp b gy la lb l lc ld">import { SET_TASKS } from './actions';</span><span id="7234" class="ky kz iq kp b gy le lb l lc ld">function tasksReducer(state = {}, action) {<br/>    switch (action.type) {<br/>        case SET_TASKS:<br/>            state = JSON.parse(JSON.stringify(action.payload));<br/>            return state;<br/>        default:<br/>            return state<br/>    }<br/>}</span><span id="74f6" class="ky kz iq kp b gy le lb l lc ld">export { tasksReducer };</span></pre><p id="1b5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以便我们可以将任务存储到存储中。</p><p id="b173" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们创建一个名为<code class="fe km kn ko kp b">requests.js</code>的文件来存储我们发出的HTTP请求的函数代码。我们补充:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="7e33" class="ky kz iq kp b gy la lb l lc ld">const APIURL = '<a class="ae kl" href="http://localhost:3000'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a>;<br/>const axios = require('axios');<br/>export const getTasks = () =&gt; axios.get(`${APIURL}/tasks`);</span><span id="d4ab" class="ky kz iq kp b gy le lb l lc ld">export const addTask = (data) =&gt; axios.post(`${APIURL}/tasks`, data);</span><span id="bf90" class="ky kz iq kp b gy le lb l lc ld">export const editTask = (data) =&gt; axios.put(`${APIURL}/tasks/${data.id}`, data);</span><span id="62a7" class="ky kz iq kp b gy le lb l lc ld">export const deleteTask = (id) =&gt; axios.delete(`${APIURL}/tasks/${id}`);</span></pre><p id="ebd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们对我们的任务进行CRUD操作。用于<code class="fe km kn ko kp b">HomePage</code>和<code class="fe km kn ko kp b">TaskForm</code>组件。</p><p id="4239" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">public/index.html</code>中，我们将现有代码替换为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="f848" class="ky kz iq kp b gy la lb l lc ld">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="c974" class="ky kz iq kp b gy le lb l lc ld">&lt;head&gt;<br/>  &lt;meta charset="utf-8" /&gt;<br/>  &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>  &lt;meta name="theme-color" content="#000000" /&gt;<br/>  &lt;meta name="description" content="Web site created using create-react-app" /&gt;<br/>  &lt;link rel="apple-touch-icon" href="logo192.png" /&gt;<br/>  &lt;!--<br/>      manifest.json provides metadata used when your web app is installed on a<br/>      user's mobile device or desktop. See <a class="ae kl" href="https://developers.google.com/web/fundamentals/web-app-manifest/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/fundamentals/web-app-manifest/</a><br/>    --&gt;<br/>  &lt;link rel="manifest" href="%PUBLIC_URL%/manifest.json" /&gt;<br/>  &lt;!--<br/>      Notice the use of %PUBLIC_URL% in the tags above.<br/>      It will be replaced with the URL of the `public` folder during the build.<br/>      Only files inside the `public` folder can be referenced from the HTML.</span><span id="9f41" class="ky kz iq kp b gy le lb l lc ld">Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will<br/>      work correctly both with client-side routing and a non-root public URL.<br/>      Learn how to configure a non-root public URL by running `npm run build`.<br/>    --&gt;<br/>  &lt;title&gt;React Drag and Drop App&lt;/title&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae kl" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /&gt;<br/>  &lt;link href="<a class="ae kl" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css</a>" rel="stylesheet"<br/>    integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous"&gt;<br/>&lt;/head&gt;</span><span id="c31d" class="ky kz iq kp b gy le lb l lc ld">&lt;body&gt;<br/>  &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;<br/>  &lt;div id="root"&gt;&lt;/div&gt;<br/>  &lt;!--<br/>      This HTML file is a template.<br/>      If you open it directly in the browser, you will see an empty page.</span><span id="619a" class="ky kz iq kp b gy le lb l lc ld">You can add webfonts, meta tags, or analytics to this file.<br/>      The build step will place the bundled scripts into the &lt;body&gt; tag.</span><span id="699d" class="ky kz iq kp b gy le lb l lc ld">To begin the development, run `npm start` or `yarn start`.<br/>      To create a production bundle, use `npm run build` or `yarn build`.<br/>    --&gt;<br/>&lt;/body&gt;</span><span id="1e8e" class="ky kz iq kp b gy le lb l lc ld">&lt;/html&gt;</span></pre><p id="f2dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们添加了Bootstrap CSS和字体Awesome图标，这样我们就得到了在<code class="fe km kn ko kp b">HomePage</code>的<code class="fe km kn ko kp b">i</code>标签中使用的Bootstrap样式和<code class="fe km kn ko kp b">close</code>图标。</p><p id="8eb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要启动后端，我们首先通过运行<code class="fe km kn ko kp b">npm i json-server</code>来安装<code class="fe km kn ko kp b">json-server</code>包。然后转到我们的项目文件夹并运行:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="d3e4" class="ky kz iq kp b gy la lb l lc ld">json-server --watch db.json</span></pre><p id="f6b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe km kn ko kp b">db.json</code>中，将文本更改为:</p><pre class="kq kr ks kt gt ku kp kv kw aw kx bi"><span id="94b3" class="ky kz iq kp b gy la lb l lc ld">{<br/>  "tasks": [<br/>  ]<br/>}</span></pre><p id="6e0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样我们就有了在<code class="fe km kn ko kp b">requests.js</code>中定义的<code class="fe km kn ko kp b">tasks</code>端点可用。</p><figure class="kq kr ks kt gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/5d6c16f42e1f6af32d9270893268c6c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BFzfbvsM8jQhXjzoNlyz_A.png"/></div></div></figure><figure class="kq kr ks kt gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lf"><img src="../Images/47a9d7c0cd2385e8923bed6176a31e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4vPoLeVebb9kejoMUwJHLA.png"/></div></div></figure></div></div>    
</body>
</html>