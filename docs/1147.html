<html>
<head>
<title>Implement a Simple Mobile Authentication Flow With React-Navigation.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React-Navigation实现一个简单的移动认证流程。</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/implement-a-simple-mobile-authentication-flow-with-react-navigation-6715f14daacd?source=collection_archive---------4-----------------------#2020-02-04">https://javascript.plainenglish.io/implement-a-simple-mobile-authentication-flow-with-react-navigation-6715f14daacd?source=collection_archive---------4-----------------------#2020-02-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="c012" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">一个简单的循序渐进的指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/928563cd6118fa323c3fb846d2fbbd21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*youH_J-7OufF1mxNOrVAtA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@mr_williams_photography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Micah Williams</a> on <a class="ae ks" href="https://unsplash.com/@mr_williams_photography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kt ku kv"><p id="e9a4" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated"><strong class="kz io">认证</strong>是每个移动应用程序必须具备的特性。它使应用程序能够向适当用户显示适当的内容。这个博客将帮助你构建一个实现react导航的应用程序来达到同样的目的。</p></blockquote></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/1e321c7154ba406adb5c4350e18129b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/1*vdmmNKxcWhd3GHZLje2ZpQ.gif"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">This is what we are tying to build</figcaption></figure><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="08ab" class="mg mh in mc b gy mi mj l mk ml">**** Application Flow ****</span><span id="0a12" class="mg mh in mc b gy mm mj l mk ml">AppLoading  --Loading<br/>   -- Decide App Screen     Authentication<br/>   --Login Screen<br/>   --Forget Screen<br/>Application<br/>   --Screen One<br/>   --Screen Two</span></pre></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><pre class="mb mc md me aw mf bi"><span id="f1ad" class="mg mh in mc b gy mn mo mp mq mr mj l mk ml">npm install react-navigation --save<br/>npm install react-navigation-stack --save</span></pre></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><blockquote class="kt ku kv"><p id="5c4f" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">您需要一个<strong class="kz io"> createSwitchNavigator(决定加载哪个堆栈)</strong>和两个<strong class="kz io">createStackNavigator(app Stack和Auth Stack) </strong></p><p id="272d" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated"><strong class="kz io"> AppStack </strong>看起来像这样</p></blockquote><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="494a" class="mg mh in mc b gy mi mj l mk ml">const AppStack = createStackNavigator({<br/> [ScreenConstants.APP_FIRST_SCREEN]: {<br/>   screen: AppScreen1,<br/>   navigationOptions: () =&gt; ({<br/>     headerTitle: ‘My First App Screen’,<br/>   }),<br/>  },<br/> [ScreenConstants.APP_SECOND_SCREEN]: {<br/>   screen: AppScreen2,<br/>   navigationOptions: () =&gt; ({<br/>     headerTitle: ‘My Second App Screen’,<br/>   }),<br/> },<br/>});</span></pre><p id="f395" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf ms lh li lj mt ll lm ln mu lp lq lr ls ig bi translated">和<strong class="kz io"> AuthStack </strong>很像</p><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="dd95" class="mg mh in mc b gy mi mj l mk ml">const AuthStack = createStackNavigator({<br/> [ScreenConstants.AUTH_LOGIN_SCREEN]: {<br/>    screen: AuthScreen,<br/>    navigationOptions: () =&gt; ({<br/>      headerTitle: ‘Login Screen’,<br/>    }),<br/> },<br/> [ScreenConstants.AUTH_FORGET_SCREEN]: {<br/>   screen: ForgetPassword,<br/>   navigationOptions: () =&gt; ({<br/>     headerTitle: ‘Forget Password’,<br/>   }),<br/> },<br/>});</span></pre><blockquote class="kt ku kv"><p id="bcb1" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">现在配置我们的<strong class="kz io"> SwitchNavigator。</strong>它的作用是根据我们存储在本地存储器中的一些标志数据，决定应用程序启动时加载哪个屏幕。</p><p id="b1ca" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">登录后，我们必须<strong class="kz io">设置</strong>它，注销后，我们必须<strong class="kz io">重置</strong>它。</p></blockquote><p id="e8cf" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf ms lh li lj mt ll lm ln mu lp lq lr ls ig bi translated">这是我们的<strong class="kz io"> SwitchNavigator </strong></p><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="deab" class="mg mh in mc b gy mi mj l mk ml">createSwitchNavigator({<br/>  [ScreenConstants.LOADING_SCREEN]: ApploadingScreen,<br/>  [ScreenConstants.AUTH_STACK]: AuthStack,<br/>  [ScreenConstants.APP_STACK]: AppStack,<br/>}),</span></pre><blockquote class="kt ku kv"><p id="743a" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">现在<strong class="kz io">应用加载</strong>屏幕负责决定加载哪个<strong class="kz io">堆栈</strong>(即<strong class="kz io"> AppStack </strong>或<strong class="kz io"> AuthStack </strong>)。</p></blockquote><p id="abc0" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf ms lh li lj mt ll lm ln mu lp lq lr ls ig bi translated">这是它看起来的样子</p><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="21f5" class="mg mh in mc b gy mi mj l mk ml">class ApploadingScreen extends React.Component {<br/>   componentDidMount() {<br/>     this._bootstrapAsync();<br/>   }<br/>   _bootstrapAsync = async () =&gt; {<br/>     const userToken = await AsyncStorage.getItem(‘userAuthFlag’);<br/>     this.props.navigation.navigate(<br/>     userToken ? ScreenConstants.APP_STACK :<br/>                 ScreenConstants.AUTH_STACK,<br/>     );<br/>   };<br/>   render() {<br/>     return (<br/>       &lt;SafeAreaView style={styles.safeAreaStyle}&gt;<br/>         &lt;Text&gt;Loading&lt;/Text&gt;<br/>       &lt;/SafeAreaView&gt;<br/>     );<br/>  }<br/>}</span></pre><blockquote class="kt ku kv"><p id="1816" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">现在最后一件事是将<strong class="kz io"> userAuthFlag </strong>设置为某个值，以便应用程序加载屏幕可以决定加载哪个屏幕。</p><p id="f765" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">因此，在<strong class="kz io">登录</strong>屏幕中，我们设置了<strong class="kz io">用户验证标志</strong>，在<strong class="kz io">注销</strong>中，我们重置了该标志。</p><p id="55ef" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">所以在<strong class="kz io">上登录</strong>，做一些类似</p></blockquote><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="f2b9" class="mg mh in mc b gy mi mj l mk ml">AsyncStorage.setItem(AsyncStoreConstant, ‘doneAuth’);//set some flag   <br/>this.props.navigation.navigate(ScreenConstants.APP_STACK);</span></pre><blockquote class="kt ku kv"><p id="1155" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">并在<strong class="kz io">上登出</strong>像</p></blockquote><pre class="kd ke kf kg gt mb mc md me aw mf bi"><span id="ac19" class="mg mh in mc b gy mi mj l mk ml">AsyncStorage.setItem(AsyncStoreConstant, ‘’); // reset the flag<br/>this.props.navigation.navigate(ScreenConstants.AUTH_STACK);</span></pre><blockquote class="kt ku kv"><p id="dc96" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">这里是一个文件中的<strong class="kz io">完整的</strong>代码，以便于理解。只需创建一个新的<strong class="kz io"> react-native </strong>项目，并用下面的代码替换那个<strong class="kz io"> app.js </strong>。</p></blockquote><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mv mw l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Complete Code. Just paste it in your newly created App.js file.</figcaption></figure><blockquote class="kt ku kv"><p id="98f6" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">感谢阅读。</p></blockquote></div></div>    
</body>
</html>