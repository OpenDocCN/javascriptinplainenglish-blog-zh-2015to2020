# Angular 最糟糕的部分

> 原文：<https://javascript.plainenglish.io/the-worst-part-of-angular-1db587453fee?source=collection_archive---------1----------------------->

## 这个框架是如何助长欺骗和破坏文明的基础的

![](img/62bdbee841620cc15236a808fdf346cc.png)

Kinda what I looked like when I uncovered Angular’s fatal flaw. Photo by [Tim Gouw](https://unsplash.com/@punttim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/frustrated?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

# 棱角分明并不都是可怕的

我和 Angular 一起工作过，有好有坏。不得不说，大部分 Angular 都没问题。许多部分实际上非常简洁——我很喜欢它使用反应式编程概念、公开 web 组件支持以及提供良好的依赖注入系统。

一些概念和结构与 Spring 非常相似，以至于我的一些初级后端同事能够找到绕过代码库的方法——这本身就很有价值。

但是，Angular 至少有一点可能会出错。

不，我不是在谈论样板、学习曲线、性能或升级过程。我对 Angular 的不满远比这更根本也更反常。

默认情况下，Angular 未能执行其最重要的合同，导致虚假进入任何 Angular 项目的核心。

在本文中，我将首先解释 Angular 最糟糕部分背后的基本概念。然后我来揭示最糟糕的部分，然后*你*如何在你的下一个角度项目中阻止它。

# 接口和模块

信不信由你，写代码很容易。你可能已经拼凑了一个“一次性脚本”来解决一个快速的问题；作为程序员，我最美好的时光是编写 Python 脚本来解析日志或玩 CSV。如果编写代码很容易，那我们怎么会有“抛弃型代码”这个说法呢？神盾局。

那么，是什么让软件开发变得困难呢？

你可能会说编写高质量的代码很难——你可能是对的。差不多了。你必须更深入一层，定义质量。

质量不是让一台**电脑**高效地做你想做的事情——尽管这有时会是一个挑战。不，写代码让计算机阅读很容易；为**人类**写代码很难。

难的不是**写**，而是**读**。随着项目规模的增加，阅读的复杂性呈指数增长。这是我们这个职业的根本问题；系统培养出程序员的速度比他们进去的速度快。

那么，作为开发人员，我们如何减少阅读量呢？

简单。将系统分成更小的系统，这些系统可以用一个接口来表示，接口是对系统行为的一组期望。如果接口定义良好，开发人员可以**信任**外部系统，而无需阅读该系统接口背后的内部细节。

作为一名开发人员，你可以忽略 4 个不相关的系统(目前)，用它们的接口表示 3 个系统，然后处理你试图修复的一个系统的细节，而不是将 1 个大系统加载到你的工作记忆中。你不需要理解登录系统来重新设计你的用户界面或者修改你的报表。

## 文明的基础

“对接口的信任”是文明的基础。

当你用现金购买食品时，你知道收银员会给你什么:你可以给优惠券，付款，拿收据，期待现金返还或找零，等等。很有可能，在这种互动另一端的人类和你一样复杂，但是对于这种互动，你不必考虑这种复杂性。你可以相信他们作为收银员的行为，而不必知道是什么让他们夜不能寐。同样，同事也是复杂的人，但是你不需要他们的生活故事来一起工作。你只需要在某种程度上信任他们。

购买产品时，一家公司或你需要了解另一家公司的所有内部运作吗？不，你只需要相信另一家公司是诚实的。法律通过定义买家和卖家之间的期望(在惩罚的威胁下)来建立信任。推荐和评论也有帮助，因为它们设定了销售方的行为预期。

贸易依赖于双方的信任。它依赖于两个系统都信任另一个系统会像它们声称的那样运行，这就是“接口信任”。

如果贸易是推动人类从狩猎采集社会到利用专业化的文明的原因，那么贸易的损失将把我们所有人带到狩猎采集社会，前文明时代。因此，这篇文章有了戏剧性的副标题。

界面很重要。在我们开始 Angular 之前，让我介绍一个管理软件界面的重要工具:类型化系统。

# 类型化系统

类型化系统在管理简化大型系统所需的接口方面非常出色。类型化系统有什么帮助？这里有三个 C 来帮助你记住:**沟通、遵从和改变**。

## 沟通

当您将鼠标悬停在变量上并查看其类型时，或者当您点击“.”时看看一个对象上的方法，那是通过渗透进入你大脑的类型系统*和*接口。那些“智能感知”特性欺骗你非常有效地读取接口，这些接口是由类型化系统和模块接口礼貌地提供的。

认识到接口不仅仅是方法和类型。**接口还包括行为和期望**(我看到一些严格的技术工程师忘记了这个事实)，这些可以通过 docstrings 或文档来传达。

## 服从

对于强类型语言的新手来说，一个常见的抱怨是很难编译代码。然而，有经验的工程师庆祝同样的事实，而语言设计师试图故意这样做。这不是一个错误；这是强类型语言的一个特性。

强类型系统将阻止你在运行时犯愚蠢和微妙的错误，在错误变成问题之前抓住它们。它们通过检查您的系统是否正确使用其他接口来做到这一点——至少是它可以检查的接口。

接口的行为方面不能仅仅通过编译器和类型化系统来断言。这就是自动化测试的用武之地，[这是一篇完全不同的文章](https://medium.com/javascript-in-plain-english/testing-react-hooks-be74ec3fc0c4)。

## 变化

有时，外来系统的变化要求您的系统进行额外的改变。这些变化可能很难融入，也可能不难，但是您必须首先发现这些变化是必需的。

如果没有编译器检查接口符合性，您可能无法发现接口是否发生了显著变化。一个类型化的系统在检测和管理变化方面确实很有帮助。

另一方面，有时接口的变化是微妙的——也许函数现在用米代替码——这是类型化系统可能无法捕捉到的。一个明智的界面设计者，如果他/她必须做出细微的界面变化，他/她会把这些变化大张旗鼓地表现出来，这样消费者就不会错过这些细微的变化。在上面提到的单位变更场景中，也许包开发人员更改了函数的名称，以强制使用大断点而不是小断点。然而，在这种情况下，向后兼容更可能是一种合适的方法，既支持这两个单元，又不需要对现有的消费者进行修改。

## 等等，这篇文章不是关于棱角的吗？

我们已经涵盖了必要的概念:接口是软件工程的基础，类型化系统有助于更明确地管理接口。如果这就是你从这篇文章中得到的全部，我会称之为成功。

# 角度分量

Angular 项目，从 2.0 开始，就使用 TypeScript 作为类型系统。如果你想调用你的一个服务，导入一个函数，使用一个类型，那么体验是很棒的:Intellisense 告诉你如何使用它，TypeScript 确保你正确地使用它，并在升级后继续正确地使用它。

*组件除外。*

组件是你在 Angular 中构建 UI 的方式。每个组件都是一个包含的系统，有输入和输出供其他组件交互。这些输入和输出构成了组件到组件的接口。

不幸的是，2 个组件“接触”的唯一方式不是通过 TypeScript，而是由 Angular 编译器管理的部分 HTML 文件。这意味着 Angular 没有智能感知、合规性检查或变更管理。

到目前为止，这是不方便的，但并不可怕。事实上，人们总是在没有类型系统的情况下编写代码:JavaScript 和 Python 都缺乏类型检查，但却非常流行。(JavaScript 有 TypeScript，Python 有一些模块，您可以使用它们来选择类型检查)

Angular 的这一部分之所以糟糕，是因为你的组件*中存在的 TypeScript 会误导你认为接口是准确的*。您可能认为输入是一个数字，但在运行时，它可能是一个字符串。

## 我的经历

这个 Angular app 是由一个单独的团队打造，交给我的。这是一个带有报告的应用程序，你可以运行并可视化结果。每个报告都有一个“报告 id”，它是一个数字。除了在仪表板视图中运行时，相同的组件传递字符串作为报告 id。但是你不能在阅读代码时分辨出来，因为 TypeScript 发誓它是一个而不是另一个。**这个应用程序不是类型一致的，这意味着代码对你撒谎。**

因为这种不匹配在项目早期没有得到解决，所以子组件做了各种“修复”来强制它在可视化和仪表板视图中工作。我试图在早期通过转换为字符串来解决底层问题，但是“报告 id”到“报告对象”`Map`会有致命的失误，因为一些组件通过`string`进行缓存获取，而其他组件通过`number`进行缓存获取。对一些组件的修复不是微不足道的，所以它没有发生。

StackBlitz 上有一个非常快速的[示例应用。看到右上方的“数字”了吗？看到顶栏组件的 TypeScript 注释说它是一个字符串了吗？](https://stackblitz.com/edit/angular-vpwger?file=src/app/top-bar/top-bar.component.html)

撒谎的代码会让你的代码更难阅读。破碎的接口意味着组件之间的壁垒已经下降，这意味着你必须阅读更多的组件。还记得阅读是软件工程中最难的部分吗？**差了 10 倍**。

恭喜你，一个巨大的蠕虫罐正等着被洒进你看到的任何棱角分明的项目的心脏。

除非你今天阻止它。

# 一盎司的预防抵得上一磅的治疗

公共服务公告:你可以防止这种事情发生在你身上。你必须在你的 ts config . JSON:[https://angular.io/guide/template-typecheck](https://angular.io/guide/template-typecheck)中选择加入模板类型检查。

这使得后两个 3 C 成为可能:法规遵从性和变更管理。第一个 C(通信)可以来自 Angular 的 IDE 扩展，也可以选择加入。**在你落入我遇到的谎言陷阱之前早点选择加入。**

事后解决这些问题很难，这无疑是我在 Angular 经历中最糟糕的部分。

## **简单英语的 JavaScript**

你知道我们有三份出版物和一个 YouTube 频道吗？在[**plain English . io**](https://plainenglish.io/)找到所有内容的链接！