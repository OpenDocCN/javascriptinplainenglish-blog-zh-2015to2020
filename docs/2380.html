<html>
<head>
<title>JavaScript Basics — Debugging and Exceptions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript基础—调试和异常</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-basics-debugging-and-exceptions-f3abffbcdd8?source=collection_archive---------10-----------------------#2020-06-18">https://javascript.plainenglish.io/javascript-basics-debugging-and-exceptions-f3abffbcdd8?source=collection_archive---------10-----------------------#2020-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/98e81b996287ef6925b51c4beb27862b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*in71va3fy4PB31Fb"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@quinoal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Quino Al</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="11cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript是世界上最流行的编程语言之一。为了有效地使用它，我们必须了解它的基本知识。</p><p id="c189" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何调试JavaScript程序和错误传播。</p><h1 id="4c22" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">排除故障</h1><p id="d36d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">console.log</code>调试我们的程序。</p><p id="e826" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它记录表达式返回的值。</p><p id="a6e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它可以接受多个参数。</p><p id="b17e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="19b0" class="mq lc iq mh b gy mr ms l mt mu">console.log(foo);</span></pre><p id="3309" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b96d" class="mq lc iq mh b gy mr ms l mt mu">console.log(foo, bar);</span></pre><p id="ebce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它可能需要更多的参数。</p><p id="9edc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有参数的值都将显示在开发人员控制台中。</p><p id="f9d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过记录我们认为会引起问题的表达式来战略性地使用<code class="fe me mf mg mh b">console.log</code>。</p><p id="87aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个替代<code class="fe me mf mg mh b">console.log</code>的方法是使用<code class="fe me mf mg mh b">debugger</code>关键字。</p><p id="f536" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将在浏览器中设置一个断点。</p><p id="d74b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它被到达的<code class="fe me mf mg mh b">debugger</code>语句暂停，我们可以在那时检查变量的值。</p><p id="5fbd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">debugger</code>的实现因浏览器而异。</p><h1 id="3189" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">错误传播</h1><p id="5ef0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">不是所有的错误都能被程序员避免。</p><p id="bee8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一个程序与外界通信，那么它们可能有问题。</p><p id="cc85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们希望优雅地处理这些情况，而不是让程序崩溃。</p><p id="584d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们用<code class="fe me mf mg mh b">prompt</code>函数提示输入一个数字，而用户输入的不是数字。那我们就要防止这种情况。</p><p id="1893" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="161d" class="mq lc iq mh b gy mr ms l mt mu">let result = Number(prompt('How many cats do you have?'));<br/>if (Number.isNaN(result)) {<br/>  console.log('please input a number')<br/>} else {<br/>  console.log(`You have ${result} cats`)<br/>}</span></pre><p id="9767" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果用户没有输入数字，他们会得到<code class="fe me mf mg mh b">'please input a number'</code>。</p><p id="0ac7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">否则，<code class="fe me mf mg mh b">`You have ${result} cats`</code>，其中<code class="fe me mf mg mh b">result</code>是用户输入的。</p><p id="6fd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该检查程序不期望的值，并处理它们。</p><p id="2c37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">许多错误是常见的，我们的代码应该考虑到它们。</p><h1 id="798a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">例外</h1><p id="f34e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">当一个功能不能正常运行时，我们可能想停下来处理这个问题。</p><p id="1629" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是异常处理的作用。</p><p id="0e3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">异常是一种机制，使遇到问题的代码有可能引发或抛出异常。</p><p id="a6c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例外可以是任何值。</p><p id="c18c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">错误对象具有导致错误的调用堆栈。</p><p id="2001" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="1923" class="mq lc iq mh b gy mr ms l mt mu">let result = Number(prompt('How many cats do you have?'));<br/>if (Number.isNaN(result)) {<br/>  throw new Error('invalid number');<br/>} else {<br/>  console.log(`You have ${result} cats`)<br/>}</span></pre><p id="d385" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们会在控制台日志中显示一个错误，并在控制台日志中显示调用堆栈跟踪。</p><p id="0c0a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">throw</code>关键字用于引发异常。</p><p id="d247" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">捕捉一个是用一个<code class="fe me mf mg mh b">try</code>块包装代码，然后是<code class="fe me mf mg mh b">catch</code>。</p><p id="f360" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe me mf mg mh b">catch</code>程序块完成后，或者如果<code class="fe me mf mg mh b">try</code>程序块运行没有问题，那么程序运行<code class="fe me mf mg mh b">try/catch</code>语句下的代码。</p><p id="2022" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ab99" class="mq lc iq mh b gy mr ms l mt mu">const promptCats = () =&gt; {<br/>  let result = Number(prompt('How many cats do you have?'));<br/>  if (Number.isNaN(result)) {<br/>    throw new Error('invalid number');<br/>  } else {<br/>    console.log(`You have ${result} cats`)<br/>  }<br/>}</span><span id="d88d" class="mq lc iq mh b gy mv ms l mt mu">try {<br/>  promptCats();<br/>} catch (err) {<br/>  console.log(err)<br/>}</span></pre><p id="28b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，如果抛出一个错误，我们捕获由<code class="fe me mf mg mh b">promptCats</code>抛出的错误。</p><p id="17df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">Error</code>构造函数来创建我们自己的错误对象。</p><p id="2f8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以获得所有的错误信息，包括堆栈跟踪</p><p id="be68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们需要使用堆栈跟踪来调试问题，它位于<code class="fe me mf mg mh b">stack</code>属性中。</p><p id="85ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它告诉我们问题发生在哪里，哪些函数导致了调用失败。</p><h1 id="fa99" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">清理</h1><p id="1c1d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果需要，我们必须在抛出异常后进行清理。</p><p id="fc22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们使用<code class="fe me mf mg mh b">finally</code>子句并在其中运行代码。</p><p id="2115" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="058a" class="mq lc iq mh b gy mr ms l mt mu">try {<br/>  errorCode();<br/>} catch (ex) {<br/>  //...<br/>} finally {<br/>  //...<br/>}</span></pre><p id="cfd1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有<code class="fe me mf mg mh b">finally</code>来运行任何代码，不管是否抛出异常。</p><p id="5938" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是运行清理代码的一个方便的地方。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/75d6dbcbd9ed3ab1183baf0e1f28b615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4B6vydLTZb_D3ZgS"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@mioitophotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">MIO ITO</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7655" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="a6aa" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">要调试，我们可以使用<code class="fe me mf mg mh b">debugger</code>语句或者<code class="fe me mf mg mh b">console.log</code>。</p><p id="827c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们应该检查代码中的错误情况。</p><p id="0817" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们遇到错误情况，异常对于抛出是有用的。</p><p id="4c4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过使用<code class="fe me mf mg mh b">throw</code>关键字和将代码分别放在<code class="fe me mf mg mh b">try/catch</code>块中来抛出和捕捉异常。</p><p id="b829" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了不管结果如何都运行代码，我们可以使用<code class="fe me mf mg mh b">finally</code>子句。</p></div></div>    
</body>
</html>