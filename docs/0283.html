<html>
<head>
<title>Build your own command-line</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建您自己的命令行</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-your-own-command-line-7311e5892c8b?source=collection_archive---------6-----------------------#2019-09-11">https://javascript.plainenglish.io/building-your-own-command-line-7311e5892c8b?source=collection_archive---------6-----------------------#2019-09-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><blockquote class="jk jl jm"><p id="ac06" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated">接下来的一周，我完成了我的第一个命令行“package app ”,我选择创建一个关于它的帖子，我花了整整一周的时间学习和教自己如何创建一个命令行，因为这对我来说是新的东西。当我开始学习反应时，创建一个类似create-react-app的命令行是我很久以来的一个想法，所以今天我将教你如何创建一个简单的命令行。</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/71bc3af18911c94154fde17688e94018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YUINpIlEWPso7QomgLbrw.jpeg"/></div></div></figure><p id="58ed" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ky ka kb kc kz ke kf kg la ki kj kk kl ig bi translated">我喜欢把这个帖子看做是普鲁顿星球，当我们建立一个命令行时，我们需要知道如何使它变得小而漂亮。你应该看到一些命令行有着惊人的颜色和直观的用户界面，一个例子可能是Netlify，这是一个很大的原因，因为我不再使用“Github Pages”来部署我的应用程序了。在开始之前，我们需要了解一些关于命令行的基本概念，因为如果我们想首先构建一个命令行界面，我们需要了解命令行的含义。</p><h1 id="b249" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">命令行界面</h1><p id="da51" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">“命令行界面”是一种允许用户通过一行文本向某些信息程序给出指令的方法。CLI和Shell之间有所不同，因为Shell是一个信息程序，CLI是一种方法。关于什么是命令行的一个很大的例子可能是<em class="jp"> create-react-app </em>和Netlify，当您编写<em class="jp"> create-react-app </em>来执行某件事情时，这就是命令行的任务，在<em class="jp"> create-react-app </em>的情况下，会创建一个包含一些文件的文件夹。</p><ul class=""><li id="f1c2" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated">好吧，现在我们知道命令行不是信息学程序，而是一种方法。</li><li id="2fad" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated">命令行用行文本向信息程序给出指令。</li><li id="bd25" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated">通过命令行，您可以执行文件或程序。</li></ul><h1 id="948e" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">我们开始吧！</h1><p id="cc83" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">首先，我们需要一些包，因为我们不想手动构建所有东西，有些人花了几个月或几个星期来构建这些包，我们现在没有时间。</p><ul class=""><li id="1326" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated"><strong class="jq io"> esm </strong>:我们需要使用导入，所以esm会为我们配置所有的东西。</li><li id="bcaa" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> figlet </strong>:生成带有一些印刷字体的横幅文本。</li><li id="d636" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> listr </strong>:一些命令行有一个任务列表，您可以在其中查看类似软件包安装的进度。</li><li id="cb55" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> ncp </strong>:我们需要复制粘贴一些文件，由ncp负责。</li><li id="15c6" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> util </strong>:我们使用允诺</li></ul><blockquote class="jk jl jm"><p id="4f91" class="jn jo jp jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ig bi translated">-NPM init<br/>-NPM I ESM fig let listr NCP</p></blockquote><h2 id="7bd1" class="ms lc in bd ld mt mu dn lh mv mw dp ll ky mx my lp kz mz na lt la nb nc lx nd bi translated">包配置</h2><p id="5aa4" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">我们需要做一些配置，如放置bin，并对包说，如果项目将是公共的或否，默认文件夹:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/942fa51628443019c157532856ad2ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*X6AthoqlD4f0OPfk11GIMw.png"/></div></figure><p id="a8e4" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ky ka kb kc kz ke kf kg la ki kj kk kl ig bi translated">不用担心，我会向您解释包内发生了什么，您如何看到我们有我给你的相同依赖关系，文件内唯一的区别是:</p><ul class=""><li id="273b" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated">bin:使用bin，我们对这个包说，我们将编写一些命令来执行一些文件。有些人最初编写cli.js(我们将在其中编写命令属性的文件)。</li><li id="c5e0" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io">发布配置</strong>:这有助于我们确保给定的包没有被标记为“最新的”，没有发布到全局公共注册中心，或者默认情况下一个作用域模块是私有的。</li><li id="713f" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io">文件</strong>:可选文件字段是一个文件模式数组，它描述了当你的包作为一个依赖项被安装时要包含的条目。</li></ul><h2 id="7159" class="ms lc in bd ld mt mu dn lh mv mw dp ll ky mx my lp kz mz na lt la nb nc lx nd bi translated">项目树</h2><p id="cabc" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">我们需要创建一些文件和文件夹，但不要担心，我会给你留下我的项目树:</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="e1bc" class="ms lc in ng b gy nk nl l nm nn">├─bin<br/>├── command-line<br/>├─src<br/>├── cli.js<br/>├─templates<br/>├── template.txt<br/>├─ .gitignore<br/>├─ packpage.json <br/>├─ package-lock</span></pre><h1 id="6762" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">书写说明</h1><p id="ca6d" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">好的，我们需要编写CLI函数并导出它，因为稍后我们将在“命令行”中执行require(别担心，我会一步一步解释):</p><ul class=""><li id="6c01" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated">在cli.js中编写cli函数。该函数接收argv，其中包含用户编写的文本，在本例中，该文本是我们将创建的文件夹的名称。</li></ul><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><ul class=""><li id="f494" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated">所以，在这一部分，我们从cli.js导入cli函数，并像参数一样传递它<br/><strong class="jq io"><em class="jp">" process . argv "</em></strong>。</li><li id="fe20" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> #！/usr/bin/env node </strong>:是shebang行的一个实例:在类Unix平台上的可执行纯文本文件中的第一行<em class="jp">，它告诉系统将该文件传递给哪个解释器来执行</em>。<a class="ae nq" href="https://stackoverflow.com/questions/33509816/what-exactly-does-usr-bin-env-node-do-at-the-beginning-of-node-files" rel="noopener ugc nofollow" target="_blank">更多信息</a>。</li></ul><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><h1 id="69d7" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">首次测试</h1><p id="943b" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">好的，我们有必要的代码来获取我们的命令，但是在运行它之前，我们需要运行<strong class="jq io"> npm链接</strong>，然后运行我们的<strong class="jq io">命令</strong>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="1dae" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ky ka kb kc kz ke kf kg la ki kj kk kl ig bi translated">我知道这个命令行看起来很简单，但是我们会赋予它复杂性。我们需要创建一个命令行来复制文件夹的内容，然后将其粘贴到不同的目录中。</p><h1 id="076e" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">欢迎方法</h1><p id="0d1c" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">不是必须的，但是如果我们希望我们的命令更漂亮，有一个演示信息是很好的。该函数需要写入cli文件中，我们将需要使用figlet，因为该软件包为我们提供了漂亮的横幅:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/84c18e1cbe2d7acc6c0210a61fb28bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/1*oHQrnbLsTYmbJ2sgB4e0zg.gif"/></div></figure><h1 id="7cca" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">复制和粘贴功能</h1><p id="3e8d" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">首先，我们需要从<em class="jp"> util </em>中导入promisify，因为有时我们需要复制并粘贴大量文件，所以这将是一种毫无问题地获取所有这些文件的方法:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="3963" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ky ka kb kc kz ke kf kg la ki kj kk kl ig bi translated">copyTempalteFiles函数的说明:</p><ul class=""><li id="25fb" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated">模板目录:这将是我们拥有模板的方向。</li><li id="f408" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated">targetDir :我们将要粘贴所有模板文件的方向。</li><li id="8a3f" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> clobber </strong>:不要重写文件。</li></ul><p id="362d" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ky ka kb kc kz ke kf kg la ki kj kk kl ig bi translated">我们需要导入<strong class="jq io">路径</strong>，因为这将给我们模板的方向。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><h1 id="fa4f" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">任务列表</h1><p id="b5cc" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">首先我给你简单介绍一下<strong class="jq io"> listr </strong>:这是一个制作任务列表的包，用户可以在其中查看命令的每个状态。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="d259" class="pw-post-body-paragraph jn jo in jq b jr js jt ju jv jw jx jy ky ka kb kc kz ke kf kg la ki kj kk kl ig bi translated">解释:</p><ul class=""><li id="5165" class="me mf in jq b jr js jv jw ky mg kz mh la mi kl mj mk ml mm bi translated"><strong class="jq io">实际路径</strong>:我们使用<em class="jp"> import.meta.url </em>来给出实际路径。</li><li id="1edc" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> templatesDir </strong>:我们使用<em class="jp">“path resolve”</em>为此，<em class="jp"> resolve </em>方法的第一个参数将是获取其路径名的实际路径，第二个参数将是我们的模板文件夹的路径。</li><li id="f705" class="me mf in jq b jr mn jv mo ky mp kz mq la mr kl mj mk ml mm bi translated"><strong class="jq io"> TaskList </strong>:我们需要创建一个异步函数，因为任务需要用await调用，因为有时这个任务会花费很多时间。在函数内部，我们将创建一个const，调用一个类来放置我们的任务。</li></ul><h1 id="288e" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">调用函数</h1><p id="7b42" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">我们将调用我们的两个函数<strong class="jq io"> HelloMessage </strong>和<strong class="jq io"> TaskList。</strong>首先，我们调用HelloMessage方法，因为这将是演示文稿，然后我们将“argv”作为参数传递，因为通过它我们可以获得文件夹的名称(我们将创建的文件夹的名称)。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><h2 id="fde8" class="ms lc in bd ld mt mu dn lh mv mw dp ll ky mx my lp kz mz na lt la nb nc lx nd bi translated">最终代码:</h2><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="no np l"/></div></figure><h1 id="368e" class="lb lc in bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">运行我们的命令🎊</h1><p id="50eb" class="pw-post-body-paragraph jn jo in jq b jr lz jt ju jv ma jx jy ky mb kb kc kz mc kf kg la md kj kk kl ig bi translated">这是我们的踪迹的结束，运行命令并且观看魔术</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ns"><img src="../Images/df47211a1b99613c0a8f73fdedc9799e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tvUjvwO2-5M5YW7TuoP7Ng.gif"/></div></div></figure><blockquote class="nt"><p id="691b" class="nu nv in bd nw nx ny nz oa ob oc kl dk translated">嘿，如果这对你有用，给我一些掌声，在我的网络上关注我！</p></blockquote><p id="9879" class="pw-post-body-paragraph jn jo in jq b jr od jt ju jv oe jx jy ky of kb kc kz og kf kg la oh kj kk kl ig bi translated">推特:@ ToyoJhornan<br/>Github:<a class="ae nq" href="https://github.com/karttofer" rel="noopener ugc nofollow" target="_blank">https://github.com/karttofer</a></p></div></div>    
</body>
</html>