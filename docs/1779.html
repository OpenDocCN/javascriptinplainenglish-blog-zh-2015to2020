<html>
<head>
<title>Subsume JSON and Well-formed JSON.stringify</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">包含JSON和格式良好的JSON.stringify</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/subsume-json-and-well-formed-json-stringify-323f70c9dc36?source=collection_archive---------7-----------------------#2020-04-21">https://javascript.plainenglish.io/subsume-json-and-well-formed-json-stringify-323f70c9dc36?source=collection_archive---------7-----------------------#2020-04-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="70ee" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">JSON的新改进(S2019)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6b424bcba20ddd192d8c6cd0e1e1026f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LeYBjLHr6kmYIoSx-aHdDA.png"/></div></div></figure><p id="75ad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇小文章中，我们将讨论javascript世界中的一些最新提议，这些提议将被包含在ES2019中。这些都是包容JSON和JSON.stringify中的新修改。</p><h2 id="fef4" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">包含JSON</h2><p id="1530" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">根据这一提议(作者为Mark Miller和Mathias Bynens)，JSON成为JSON.parse中ECMAScript的一个句法子集。这一提议处于第4阶段，计划纳入ES2019。</p><p id="d900" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">到目前为止，JSON还不是ECMAScript的子集，JSON字符串可以包含U+2029段落分隔符和未转义的U+2028行分隔符，而ECMAScript字符串则不能。这些差异增加了开发的复杂性，并促进了bug的引入。</p><p id="4f1a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这个新的建议中，ECMAScript字符串可以包含原始的U+2028和U+2029字符，消除了JSON和ECMAScript之间令人困惑的不匹配。</p><p id="0fd8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我放了一个代码的图像，这样就可以很好地看到不同操作系统上的行分隔符:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/bcec28bdca12f207e30da5b04375d3d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*wRCte5Q18GA5IVWJWqBjQQ.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">U+28 line separator character image</figcaption></figure><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="4c36" class="ln lo iq mr b gy mv mw l mx my">// A raw U+2029 character, produced by eval:<br/>const PS = eval('"\u2029"');<br/>//ES2018: SyntaxError<br/>//ES2019: ok!</span></pre><p id="978d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种变化是向后兼容的。当分析包含段落分隔符或无转义行分隔符或的字符串时，可见效果将仅限于消除语法错误完成。</p><h2 id="d372" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">格式良好的JSON.stringify</h2><p id="6cc5" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">该提案(由Richard Gibson撰写)处于第4阶段，是ECMAScript 2019的一部分。</p><p id="c4b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果输入包含任何单独的替代字符(范围为0xd 800–0xdff的JavaScript字符)，则JSON.stringify先前被指定返回格式不正确的Unicode字符串。当我们交换JSON时，根据JSON的RFC，我们必须将其编码为UTF-8。如果我们使用JSON.stringify()，这可能是一个问题，因为它可能返回无法编码为UTF-8的UTF-16序列。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="20ad" class="ln lo iq mr b gy mv mw l mx my">JSON.stringify('\u{D800}')<br/>//'"�"'</span></pre><p id="b472" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个建议改变了JSON.stringify()，以便通过代码单元转义序列来表示它们:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="d2ea" class="ln lo iq mr b gy mv mw l mx my">JSON.stringify('\u{D800}')<br/>//'"\\ud800"'</span></pre><h2 id="e3b6" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">结论</h2><p id="4327" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">这些新的变化可能不像最新提案中引入的其他变化那样引人注目，但它们使语言更加健壮和一致，避免了可能的编程错误。</p><p id="c300" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望它对你有用。非常感谢你阅读我！</p><h2 id="7d88" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated"><strong class="ak">来自JavaScript的简单英语注释</strong></h2><p id="b388" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我们推出了三种新的出版物！通过以下方式表达对我们新出版物的热爱:<a class="ae mz" href="https://medium.com/ai-in-plain-english" rel="noopener"> <strong class="kt ir">通俗易懂的AI</strong></a>、<a class="ae mz" href="https://medium.com/ux-in-plain-english" rel="noopener">、<strong class="kt ir">通俗易懂的UX</strong>、</a>、<a class="ae mz" href="https://medium.com/python-in-plain-english" rel="noopener">、<strong class="kt ir">通俗易懂的Python</strong>、</a>、<strong class="kt ir">、</strong>——谢谢您，继续学习！</p><p id="bddf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们也一直有兴趣帮助推广高质量的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae mz" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir">submissions @ plain English . io</strong></a><strong class="kt ir"/>，使用您的Medium用户名，我们会将您添加为作者。另外，请让我们知道您想加入哪个/哪些出版物。</p></div></div>    
</body>
</html>