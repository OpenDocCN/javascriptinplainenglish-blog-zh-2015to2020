<html>
<head>
<title>Public, private, and role-based routes in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中的公共、私有和基于角色的路由</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/role-based-authorization-role-based-access-control-v-2-in-react-js-cb958e338f4b?source=collection_archive---------0-----------------------#2020-08-11">https://javascript.plainenglish.io/role-based-authorization-role-based-access-control-v-2-in-react-js-cb958e338f4b?source=collection_archive---------0-----------------------#2020-08-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/61551e7691aca825b69ad429fd779b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QlkpHjL9Cn-kiQXap1sweA.jpeg"/></div></div></figure><p id="f319" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">耶，我又想出了一个超级酷的故事，我称之为RBAC-V2，因为这是我第二个关于同一主题的故事，下面列出了第二个版本背后的一些原因。</p><ol class=""><li id="99a9" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">版本1与我介绍这种技术的项目紧密结合。</li><li id="5be7" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">不支持子/嵌套路由。</li><li id="00ca" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">没有在一个地方定义角色的技术。</li><li id="04d3" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">更新路径访问很复杂。</li><li id="bb66" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">必须维护所有角色的公共路线。</li></ol><p id="ac68" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">版本2中的更新:</strong></p><ol class=""><li id="a6f8" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">我想出了一个更通用的方法，以便更好地服务于社区。</li><li id="074e" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">添加了子/嵌套路线支持。</li><li id="cece" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">在一个地方定义角色，以便于维护。</li><li id="687b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">只需添加或删除角色，即可轻松更新路由访问。</li><li id="8e1e" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">如果您跳过该权限，所有人都可以自动访问它。</li></ol><p id="83cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该解决方案与我在版本1中使用的完全相同，因此如果您没有检查版本1，我强烈建议您仔细阅读，这样您可以更好地了解到底发生了什么…</p><div class="lk ll gp gr lm ln"><a href="https://medium.com/@umairkz52/role-based-authorization-role-based-access-control-in-react-js-65c05a372ca8" rel="noopener follow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">基于角色的授权| | react . js中基于角色的访问控制</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">在我最近的项目中，我的任务是实现基于角色的授权/访问控制</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jw ln"/></div></div></a></div><blockquote class="mc md me"><p id="91c1" class="jy jz mf ka b kb kc kd ke kf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku kv ij bi translated"><strong class="ka ir">这个想法是简单地防止应用程序生成不必要的路线，</strong> <strong class="ka ir">而不是检查每个路线上的角色并显示回退用户界面，这将是一个伟大的想法，只生成用户有权访问的路线，所以如果用户手动导航到一个路线，即:(在地址栏中键入)他/她会得到404未找到屏幕，因为路线没有注册。</strong></p></blockquote><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/666101952345625660f0944c24a26cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhJ0FI5M4CPNjRlCXZwekg.jpeg"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk">🙋🏻‍♂️ Stop Stop Stop</figcaption></figure><h1 id="8327" class="ms mt iq bd mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np bi translated">你在说什么？<br/>这真的可能吗？<br/>如果是，那么如何？</h1><p id="34eb" class="pw-post-body-paragraph jy jz iq ka b kb nq kd ke kf nr kh ki kj ns kl km kn nt kp kq kr nu kt ku kv ij bi translated">是的，这是可能的，如果你听说过<a class="ae nv" href="https://reactrouter.com/web/guides/philosophy" rel="noopener ugc nofollow" target="_blank"> react-router 4的理念</a>它支持动态路由，我们可以利用它。</p><blockquote class="mc md me"><p id="48aa" class="jy jz mf ka b kb kc kd ke kf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku kv ij bi translated">当我们说动态路由时，我们指的是在您的应用程序呈现时发生的路由，而不是在运行的应用程序之外的配置或约定中。</p></blockquote></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/163a0955f049e30328bd288f57a12f06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*v_aO-_Rc8O-aV3Rtbb1htw.jpeg"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk">Let’s start</figcaption></figure><p id="19bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤#1 <br/> </strong>因为我们正在寻找基于角色的解决方案，所以让我们先定义角色，角色只是一个普通的javascript对象，具有键值对，<strong class="ka ir">下面是我的演示应用程序的占位符角色，您可以用自己的角色来替换它们</strong>。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/1e739661e5537507ff87d6bf01c74b3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggD1Qo-ESphpwUNtMG8bgw.jpeg"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk">User Roles</figcaption></figure><pre class="mk ml mm mn gt of og oh oi aw oj bi"><span id="6864" class="ok mt iq og b gy ol om l on oo">File: src/config/Roles</span><span id="0174" class="ok mt iq og b gy op om l on oo"><strong class="og ir">export default </strong>{<br/> <strong class="og ir">SUPER_ADMIN</strong>: <strong class="og ir">'SUPER_ADMIN'</strong>,<br/> <strong class="og ir">ADMIN</strong>: <strong class="og ir">'ADMIN'</strong>,<br/> <strong class="og ir">MANAGER</strong>: <strong class="og ir">'MANAGER'</strong>,<br/> <strong class="og ir">CUSTOMER</strong>: <strong class="og ir">'CUSTOMER'</strong>,<br/> <strong class="og ir">GUEST</strong>: <strong class="og ir">'GUEST'<br/></strong>};</span></pre></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="6a8f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤#2 </strong> <br/>定义私有路由配置，r <em class="mf"> oute config对象支持react-router的所有路由组件属性以及一些附加属性，即:</em> <strong class="ka ir"> <em class="mf">【标题、权限、孩子】</em> </strong> <em class="mf">您可以在config对象中添加或删除属性，这意味着它是超级可定制的，支持多达N个嵌套，子路由必须遵循相同的父形状，这意味着config对象对于子路由和父路由都是相同的，没有附加关键字。</em></p><pre class="mk ml mm mn gt of og oh oi aw oj bi"><span id="807f" class="ok mt iq og b gy ol om l on oo">File: src/config/PrivateRoutesConfig</span><span id="ab03" class="ok mt iq og b gy op om l on oo"><strong class="og ir">import </strong>{ Roles } <strong class="og ir">from 'config'<br/><br/></strong><em class="mf">// Components<br/></em><strong class="og ir">import </strong>{<br/> Module1,<br/> Module2,<br/> Module3,<br/> ModuleN,<br/> ModuleNChild1,<br/> ModuleNChild2,<br/> ModuleNChild3,<br/> Dashboard,<br/> Profile,<br/>} <strong class="og ir">from 'components'</strong>;<br/><br/><em class="mf">// </em><strong class="og ir"><em class="mf">TODO:<br/></em></strong><em class="mf">/*<br/>* 1. Make title optional<br/>* 2. Make title multi type support ie: (string, node, react element)<br/>* */<br/><br/></em><strong class="og ir">export default </strong>[<br/> {<br/>  <strong class="og ir">component</strong>: Module1,<br/>  <strong class="og ir">path</strong>: <strong class="og ir">'/'</strong>,<br/>  <strong class="og ir">title</strong>: <strong class="og ir">'Module - 1'</strong>,<br/>  <strong class="og ir">exact</strong>: <strong class="og ir">true</strong>,<br/> },<br/> {<br/>  <strong class="og ir">component</strong>: Module2,<br/>  <strong class="og ir">path</strong>: <strong class="og ir">'/module-2'</strong>,<br/>  <strong class="og ir">title</strong>: <strong class="og ir">'Module - 2'</strong>,<br/> },<br/> {<br/>  <strong class="og ir">component</strong>: Module3,<br/>  <strong class="og ir">path</strong>: <strong class="og ir">'/module-3'</strong>,<br/>  <strong class="og ir">title</strong>: <strong class="og ir">'Module - 3'</strong>,<br/> },<br/> {<br/>  <strong class="og ir">component</strong>: ModuleN,<br/>  <strong class="og ir">path</strong>: <strong class="og ir">'/module-n'</strong>,<br/>  <strong class="og ir">title</strong>: <strong class="og ir">'Module - N'</strong>,<br/>  <strong class="og ir">permission</strong>: [<br/>   Roles.<strong class="og ir">SUPER_ADMIN</strong>,<br/>   Roles.<strong class="og ir">ADMIN</strong>,<br/>   Roles.<strong class="og ir">MANAGER<br/>  </strong>],<br/>  <strong class="og ir">children</strong>: [<br/>   {<br/>    <strong class="og ir">component</strong>: ModuleNChild1,<br/>    <strong class="og ir">path</strong>: <strong class="og ir">'/child-1'</strong>,<br/>    <strong class="og ir">title</strong>: <strong class="og ir">'Child - 1'</strong>,<br/>   },<br/>   {<br/>    <strong class="og ir">component</strong>: ModuleNChild2,<br/>    <strong class="og ir">path</strong>: <strong class="og ir">'/child-2'</strong>,<br/>    <strong class="og ir">title</strong>: <strong class="og ir">'Child - 2'</strong>,<br/>   },<br/>   {<br/>    <strong class="og ir">component</strong>: ModuleNChild3,<br/>    <strong class="og ir">path</strong>: <strong class="og ir">'/child-3'</strong>,<br/>    <strong class="og ir">title</strong>: <strong class="og ir">'Child - 3'</strong>,<br/>    <strong class="og ir">permission</strong>: [<br/>     Roles.<strong class="og ir">SUPER_ADMIN</strong>,<br/>     Roles.<strong class="og ir">ADMIN<br/>    </strong>]<br/>   }<br/>  ]<br/> },<br/> {<br/>  <strong class="og ir">component</strong>: Dashboard,<br/>  <strong class="og ir">path</strong>: <strong class="og ir">'/dashboard'</strong>,<br/>  <strong class="og ir">title</strong>: <strong class="og ir">'Dashboard'</strong>,<br/>  <strong class="og ir">permission</strong>: [<br/>   Roles.<strong class="og ir">SUPER_ADMIN</strong>,<br/>   Roles.<strong class="og ir">ADMIN</strong>,<br/>  ],<br/> },<br/> {<br/>  <strong class="og ir">component</strong>: Profile,<br/>  <strong class="og ir">path</strong>: <strong class="og ir">'/profile'</strong>,<br/>  <strong class="og ir">title</strong>: <strong class="og ir">'Profile'</strong>,<br/>  <strong class="og ir">permission</strong>: [<br/>   Roles.<strong class="og ir">SUPER_ADMIN</strong>,<br/>   Roles.<strong class="og ir">ADMIN</strong>,<br/>   Roles.<strong class="og ir">MANAGER</strong>,<br/>   Roles.<strong class="og ir">CUSTOMER<br/>  </strong>],<br/> },<br/>]</span></pre></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="98e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经完成了配置。</p><p id="7e4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到目前为止我们完成了什么？</p><p id="ff90" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个是<strong class="ka ir">角色</strong>另一个是<strong class="ka ir">私服阵，</strong>对吧？🤔🤔🤔耶斯<br/>🆗所以，是时候进入代码了…</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/7e74d54b5a3737ef525c4926631fa3f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*oXiTFekPWg4p-dzPldW-pg.gif"/></div></figure><p id="0e53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第三步</strong></p><p id="ec1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您的应用程序像我们的演示应用程序一样支持多个角色，让我们用用户角色或多个角色来过滤私有路由</p><pre class="mk ml mm mn gt of og oh oi aw oj bi"><span id="80c3" class="ok mt iq og b gy ol om l on oo">File: src/utils/index</span><span id="6d49" class="ok mt iq og b gy op om l on oo"><strong class="og ir">import </strong>{ <em class="mf">intersection </em>} <strong class="og ir">from 'lodash'</strong>;<br/><br/><strong class="og ir">export function </strong><em class="mf">isArrayWithLength</em>(arr) {<br/> <strong class="og ir">return </strong>(<strong class="og ir"><em class="mf">Array</em></strong>.isArray(arr) &amp;&amp; arr.<strong class="og ir">length</strong>)<br/>}<br/><br/><strong class="og ir">export function </strong><em class="mf">getAllowedRoutes</em>(routes) {<br/> <strong class="og ir">const </strong>roles = <strong class="og ir"><em class="mf">JSON</em></strong>.parse(<strong class="og ir"><em class="mf">localStorage</em></strong>.getItem(<strong class="og ir">'roles'</strong>));<br/> <strong class="og ir">return </strong>routes.filter(({ permission }) =&gt; {<br/>  <strong class="og ir">if</strong>(!permission) <strong class="og ir">return true</strong>;<br/>  <strong class="og ir">else if</strong>(!<em class="mf">isArrayWithLength</em>(permission)) <strong class="og ir">return true</strong>;<br/>  <strong class="og ir">else return </strong><em class="mf">intersection</em>(permission, roles).<strong class="og ir">length</strong>;<br/> });<br/>}</span></pre><p id="0159" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们有了一个实用方法<strong class="ka ir"><em class="mf">getAllowedRoutes</em></strong><em class="mf"/>，我们可以在其中传递Routes数组，它将返回过滤后的routes数组，并将该数组传递给routes映射组件</p><pre class="mk ml mm mn gt of og oh oi aw oj bi"><span id="4e11" class="ok mt iq og b gy ol om l on oo">File: src/routes/<em class="mf">PrivateRoutes</em></span><span id="57fc" class="ok mt iq og b gy op om l on oo"><strong class="og ir">import </strong>React, { <strong class="og ir"><em class="mf">Fragment </em></strong>} <strong class="og ir">from 'react'</strong>;<br/><strong class="og ir">import </strong>{ <em class="mf">Redirect</em>, <em class="mf">useRouteMatch </em>} <strong class="og ir">from 'react-router-dom'</strong>;<br/><strong class="og ir">import </strong>{ getAllowedRoutes, isLoggedIn } <strong class="og ir">from 'utils'</strong>;<br/><strong class="og ir">import </strong>{ PrivateRoutesConfig } <strong class="og ir">from 'config'</strong>;<br/><strong class="og ir">import </strong>{ TopNav } <strong class="og ir">from 'components/common'</strong>;<br/><strong class="og ir">import </strong>MapAllowedRoutes <strong class="og ir">from 'routes/MapAllowedRoutes'</strong>;<br/><br/><strong class="og ir">function </strong><em class="mf">PrivateRoutes</em>() {<br/> <strong class="og ir">const </strong>match = <em class="mf">useRouteMatch</em>(<strong class="og ir">'/app'</strong>);<br/> <strong class="og ir">let </strong>allowedRoutes = [];<br/><br/> <strong class="og ir">if </strong>(isLoggedIn()) {<br/>   allowedRoutes = getAllowedRoutes(PrivateRoutesConfig);<br/> } <strong class="og ir">else </strong>{<br/>   return &lt;<strong class="og ir">Redirect</strong> to="/" /&gt;;<br/> }<br/><br/> <strong class="og ir">return </strong>(<br/>  &lt;<strong class="og ir">Fragment</strong>&gt;<br/>   &lt;<strong class="og ir">TopNav <br/>     routes=</strong>{allowedRoutes} <br/>     <strong class="og ir">path=</strong>{match.<strong class="og ir">path</strong>}<br/>     <strong class="og ir">className="bg-white" <br/>   </strong>/&gt;<br/>   &lt;<strong class="og ir">MapAllowedRoutes <br/>     routes=</strong>{allowedRoutes} <br/>     <strong class="og ir">basePath="/app" <br/>     isAddNotFound <br/>   </strong>/&gt;<br/>  &lt;/<strong class="og ir">Fragment</strong>&gt;<br/> );<br/>}<br/><br/><strong class="og ir">export default </strong><em class="mf">PrivateRoutes</em>;</span></pre><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/246d9eebdb04b344b91559984a4ff01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*ScCh5KRj6zD7-LAu-T4S4Q.jpeg"/></div></figure></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="602c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤#4 <br/> </strong>现在，最后一步是渲染过滤后的路由，我已经为此创建了一个组件，因此相同的组件用于渲染父路由和子路由，该组件需要过滤后的路由数组和基本路径作为属性。</p><pre class="mk ml mm mn gt of og oh oi aw oj bi"><span id="c8ff" class="ok mt iq og b gy ol om l on oo">File: src/routes/MapAllowedRoutes</span><span id="c7de" class="ok mt iq og b gy op om l on oo"><strong class="og ir">import </strong>React, { <em class="mf">memo </em>} <strong class="og ir">from 'react'</strong>;<br/><strong class="og ir">import </strong>{ <strong class="og ir"><em class="mf">Switch</em></strong>, <strong class="og ir"><em class="mf">Route</em></strong>, <em class="mf">useRouteMatch </em>} <strong class="og ir">from 'react-router-dom'</strong>;<br/><strong class="og ir">import </strong>{ NotFound } <strong class="og ir">from 'components/common'</strong>;<br/><br/><em class="mf">/*<br/>* This is the route utility component used for generating<br/>* routes and child routes it only requires routes array and basePath<br/>*/</em></span><span id="1376" class="ok mt iq og b gy op om l on oo"><strong class="og ir">function </strong>MapAllowedRoutes({routes, basePath, isAddNotFound}) {<br/> <strong class="og ir">const </strong>match = <em class="mf">useRouteMatch</em>(basePath);<br/> <strong class="og ir">return </strong>(<br/>  &lt;<strong class="og ir">Switch</strong>&gt;<br/>   {routes.map((route) =&gt; {<br/><em class="mf"><br/>    </em><strong class="og ir">const </strong>{ <br/>     path, <br/>     <strong class="og ir">component</strong>: Component,<br/>     children, <br/>     title,<br/>     permission,<br/>     ...rest <br/>    } = route;</span><span id="a427" class="ok mt iq og b gy op om l on oo">    <strong class="og ir">return </strong>(<br/>     &lt;<strong class="og ir">Route<br/>      </strong>{...rest}<br/>      <strong class="og ir">key=</strong>{path}<br/>      <strong class="og ir">path=</strong>{<strong class="og ir">`</strong>${match.<strong class="og ir">path</strong>}${path}<strong class="og ir">`</strong>}<br/>     &gt;<br/>      &lt;<strong class="og ir">Component children=</strong>{children} /&gt;<br/>     &lt;/<strong class="og ir">Route</strong>&gt;<br/>    )<br/>   })}<br/>    {isAddNotFound &amp;&amp; &lt;<strong class="og ir">Route</strong>&gt;&lt;<strong class="og ir">NotFound </strong>/&gt;&lt;/<strong class="og ir">Route</strong>&gt;}<br/>  &lt;/<strong class="og ir">Switch</strong>&gt;<br/> )<br/>}<br/><br/><strong class="og ir">export default </strong><em class="mf">memo</em>(MapAllowedRoutes);</span></pre><p id="8a9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你见过👀在<em class="mf"> PrivateRoutes </em>中，我们刚刚使用在<strong class="ka ir">步骤#3 </strong>中创建的<strong class="ka ir"><em class="mf">getAllowedRoutes</em></strong>实用程序方法过滤了私有路由，并将过滤后的路由数组传递到路由映射器组件中，路由映射器只是一个可重用组件，用于路由数组上的地图。</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="6b34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们完成了路由。</p><p id="8ad4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我将您的主导航与路线同步，您觉得如何？🤔</p><p id="1f13" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那太棒了。<br/>😍</p><p id="28f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是代码</p><pre class="mk ml mm mn gt of og oh oi aw oj bi"><span id="71af" class="ok mt iq og b gy ol om l on oo">File: src/components/common/TopNav</span><span id="2721" class="ok mt iq og b gy op om l on oo"><strong class="og ir">import </strong>React, { <em class="mf">memo </em>} <strong class="og ir">from 'react'</strong>;<br/><strong class="og ir">import </strong>{ Button } <strong class="og ir">from 'react-bootstrap'</strong>;<br/><strong class="og ir">import </strong>PropTypes <strong class="og ir">from 'prop-types'</strong>;<br/><strong class="og ir">import </strong>{ <strong class="og ir"><em class="mf">Link</em></strong>, <em class="mf">useHistory </em>} <strong class="og ir">from "react-router-dom"</strong>;<br/><strong class="og ir">import </strong>{ isLoggedIn } <strong class="og ir">from 'utils'</strong>;<br/><br/><strong class="og ir">function </strong>TopNav(props) {<br/> <strong class="og ir">let </strong>history = <em class="mf">useHistory</em>();<br/><br/> <strong class="og ir">function </strong>handleLogout() {<br/>  <strong class="og ir"><em class="mf">localStorage</em></strong>.removeItem(<strong class="og ir">'roles'</strong>);<br/>  history.push(<strong class="og ir">'/'</strong>);<br/> }<br/><br/> <strong class="og ir">return </strong>(<br/>  &lt;<strong class="og ir">div className=</strong>{<strong class="og ir">`w3-bar w3-padding w3-card </strong>${props.<strong class="og ir">className</strong>}<strong class="og ir">`</strong>} &gt;<br/>   &lt;<strong class="og ir">div className="w3-display-topleft w3-padding-large w3-xlarge"</strong>&gt;<br/>    RBAC-V2<br/>   &lt;/<strong class="og ir">div</strong>&gt;<br/>   &lt;<strong class="og ir">div className="w3-right"</strong>&gt;<br/>    {props.<strong class="og ir">routes</strong>.map(({ path, title }) =&gt; (<br/>     &lt;<strong class="og ir">Link <br/>       key=</strong>{path} <br/>       <strong class="og ir">className="w3-bar-item" <br/>       to=</strong>{<strong class="og ir">`</strong>${props.<strong class="og ir">prefix</strong>}${path}<strong class="og ir">`</strong>}<br/>     &gt;<br/>       {title}<br/>     &lt;/<strong class="og ir">Link</strong>&gt;<br/>    ))}<br/>    {isLoggedIn() &amp;&amp; &lt;<strong class="og ir">Button onClick=</strong>{handleLogout}&gt;Logout&lt;/<strong class="og ir">Button</strong>&gt; }<br/>   &lt;/<strong class="og ir">div</strong>&gt;<br/>  &lt;/<strong class="og ir">div</strong>&gt;<br/> );<br/>}<br/><br/>TopNav.<strong class="og ir">propTypes </strong>= {<br/> <strong class="og ir">routes</strong>: PropTypes.<strong class="og ir">arrayOf</strong>(<br/>  PropTypes.shape({<br/>   <strong class="og ir">path</strong>: PropTypes.<strong class="og ir">string</strong>.<strong class="og ir">isRequired</strong>,<br/>   <strong class="og ir">title</strong>: PropTypes.<strong class="og ir">string</strong>.<strong class="og ir">isRequired<br/>  </strong>})<br/> ).<strong class="og ir">isRequired</strong>,<br/> <strong class="og ir">prefix</strong>: PropTypes.<strong class="og ir">string</strong>,<br/> <strong class="og ir">className</strong>: PropTypes.<strong class="og ir">string<br/></strong>};<br/><br/>TopNav.<strong class="og ir">defaultProps </strong>={<br/> <strong class="og ir">prefix</strong>: <strong class="og ir">''</strong>,<br/> <strong class="og ir">className</strong>: <strong class="og ir">''<br/></strong>};<br/><br/><strong class="og ir">export default </strong><em class="mf">memo</em>(TopNav);</span></pre><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/b60ae72e92023c77d8047c486d4fbced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*Hy9rlEwUrlpgigRt15lMSA.jpeg"/></div></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/9827c44d956844ced5e1a6866cce6e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzW2ZNXwIkibK4ojn1B-vQ.jpeg"/></div></div></figure><h2 id="a660" class="ok mt iq bd mu ou ov dn my ow ox dp nc kj oy oz ng kn pa pb nk kr pc pd no pe bi translated"><strong class="ak">好处</strong></h2><ol class=""><li id="ed85" class="kw kx iq ka b kb nq kf nr kj pf kn pg kr ph kv lb lc ld le bi translated">仅在父路由呈现时检查一次路由访问</li><li id="7199" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">仅生成用户有权访问的路线</li><li id="f2ae" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">中心角色和专用路由配置文件</li><li id="fe0c" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">易于添加/删除角色</li><li id="cd55" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">易于添加/删除用户角色的路由访问权限</li><li id="ab58" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">路线和导航之间的同步</li><li id="488c" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">单一+多重角色支持</li></ol><h2 id="07f5" class="ok mt iq bd mu ou ov dn my ow ox dp nc kj oy oz ng kn pa pb nk kr pc pd no pe bi translated">结论</h2><p id="a398" class="pw-post-body-paragraph jy jz iq ka b kb nq kd ke kf nr kh ki kj ns kl km kn nt kp kq kr nu kt ku kv ij bi translated">这是一种易于维护且可扩展的方法，用于实现基于角色的路线访问，以及支持多角色和嵌套路线的导航</p><h2 id="78ff" class="ok mt iq bd mu ou ov dn my ow ox dp nc kj oy oz ng kn pa pb nk kr pc pd no pe bi translated">链接</h2><p id="413e" class="pw-post-body-paragraph jy jz iq ka b kb nq kd ke kf nr kh ki kj ns kl km kn nt kp kq kr nu kt ku kv ij bi translated">github:<a class="ae nv" href="https://github.com/umair-khanzada/role-based-access-control" rel="noopener ugc nofollow" target="_blank">https://github.com/umair-khanzada/role-based-access-control</a><br/>演示App:<a class="ae nv" href="https://umair-khanzada.github.io/role-based-access-control/" rel="noopener ugc nofollow" target="_blank">https://umair-khanzada.github.io/role-based-access-control</a></p></div></div>    
</body>
</html>