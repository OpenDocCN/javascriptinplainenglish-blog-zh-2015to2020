<html>
<head>
<title>JavaScript Best Practices for Writing More Robust Code — Checking for Unexpected Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写更健壮代码的JavaScript最佳实践——检查意外值</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-best-practices-for-writing-more-robust-code-checking-for-unexpected-values-97caddab6dcf?source=collection_archive---------9-----------------------#2020-05-08">https://javascript.plainenglish.io/javascript-best-practices-for-writing-more-robust-code-checking-for-unexpected-values-97caddab6dcf?source=collection_archive---------9-----------------------#2020-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/94adcc54febfd9d2f0cd63add9fe993a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eKp9twdIZksMQ-9F"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@zmachacek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Zdeněk Macháček</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9301" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">JavaScript是一种简单易学的编程语言。编写运行并执行某些操作的程序很容易。然而，很难考虑所有的用例并编写健壮的JavaScript代码。</p><p id="1702" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究检查意外值的方法，包括<code class="fe lb lc ld le b">null</code>和<code class="fe lb lc ld le b">NaN</code>。</p><h1 id="38de" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">检查是否为空</h1><p id="940b" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">null</code>也是一个我们可能会意外遇到的值，所以我们也应该检查一下。</p><p id="00da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查<code class="fe lb lc ld le b">null</code>有点棘手，因为当<code class="fe lb lc ld le b">typeof null</code>返回<code class="fe lb lc ld le b">'object'</code>时，我们不能使用<code class="fe lb lc ld le b">typeof</code>操作符来检查<code class="fe lb lc ld le b">null</code>。</p><p id="367d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，我们仍然可以使用<code class="fe lb lc ld le b">===</code>运算符或<code class="fe lb lc ld le b">Object.is</code>方法来检查<code class="fe lb lc ld le b">null</code>。</p><p id="eee1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<code class="fe lb lc ld le b">===</code>操作符来检查<code class="fe lb lc ld le b">null</code>，如下所示:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="0585" class="mq lg iq le b gy mr ms l mt mu">if (foo === null) {<br/>  //...<br/>}</span></pre><p id="6dfe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们只是使用<code class="fe lb lc ld le b">===</code>操作符来检查<code class="fe lb lc ld le b">null</code>，就像我们检查任何其他值一样。</p><p id="39a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">===</code>操作符不进行任何数据类型强制，所以在进行比较之前，它会将值与任何数据类型转换进行比较。</p><p id="f645" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，上面的代码将适用于<code class="fe lb lc ld le b">null</code>比较，因为在进行比较之前，它不会试图将<code class="fe lb lc ld le b">null</code>转换成其他任何东西。</p><p id="e872" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">Object.is</code>是一个静态对象方法，它接受两个参数，这两个参数接受两个要比较的对象。</p><p id="adc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果两个参数都是<code class="fe lb lc ld le b">null</code>，它将返回<code class="fe lb lc ld le b">true</code>，所以我们可以用它来检查某个东西是否是<code class="fe lb lc ld le b">null</code>。</p><p id="e6cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了用<code class="fe lb lc ld le b">Object.is</code>检查<code class="fe lb lc ld le b">null</code>，我们可以编写以下代码:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="4757" class="mq lg iq le b gy mr ms l mt mu">if (Object.is(foo, null)) {<br/>  //...<br/>}</span></pre><p id="e5dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，我们用<code class="fe lb lc ld le b">foo</code>和<code class="fe lb lc ld le b">null</code>调用了<code class="fe lb lc ld le b">Object.is</code>。那么如果<code class="fe lb lc ld le b">foo</code>是<code class="fe lb lc ld le b">null</code>，<code class="fe lb lc ld le b">Object.is</code>会返回<code class="fe lb lc ld le b">true</code>。</p><h1 id="8721" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">检查值是否为NaN</h1><p id="2a43" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated"><code class="fe lb lc ld le b">NaN</code>是一个值，如果我们尝试将非数字转换成数字，或者尝试将0或非数字除以0，就会遇到这个值。</p><p id="f87d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">检查<code class="fe lb lc ld le b">NaN</code>的方法有很多，包括<code class="fe lb lc ld le b">isNaN</code>函数、<code class="fe lb lc ld le b">Number.isNaN</code>方法和<code class="fe lb lc ld le b">Object.is</code>。</p><p id="1e63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">===</code>和<code class="fe lb lc ld le b">==</code>操作符不起作用，因为如果我们使用这些操作符，<code class="fe lb lc ld le b">NaN</code>被认为是不同的。因此<code class="fe lb lc ld le b">NaN === NaN</code>和<code class="fe lb lc ld le b">NaN == NaN</code>都返回<code class="fe lb lc ld le b">false</code>。</p><p id="51d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，对于<code class="fe lb lc ld le b">NaN</code>，仍然有许多选项需要检查。</p><p id="b50d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">全局<code class="fe lb lc ld le b">isNaN</code>函数可用于检查一个值是否为<code class="fe lb lc ld le b">NaN</code>。在使用此函数检查<code class="fe lb lc ld le b">NaN</code>之前完成数据类型强制。</p><p id="4fba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们传入一个东西，如果我们把它转换成一个数字，它就是<code class="fe lb lc ld le b">NaN</code>，那么<code class="fe lb lc ld le b">isNaN</code>将返回<code class="fe lb lc ld le b">true</code>。否则，它将返回<code class="fe lb lc ld le b">false</code>。</p><p id="7b7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果我们有:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="c9b2" class="mq lg iq le b gy mr ms l mt mu">isNaN(NaN);       <br/>isNaN(undefined);<br/>isNaN({});</span></pre><p id="730c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后它们都返回<code class="fe lb lc ld le b">true</code>，因为如果我们试图将它们转换成一个数字，它们都返回<code class="fe lb lc ld le b">NaN</code>。</p><p id="a66f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，如果我们有:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="8971" class="mq lg iq le b gy mr ms l mt mu">isNaN(true);      <br/>isNaN(null);</span></pre><p id="e485" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些将返回<code class="fe lb lc ld le b">true</code>，因为<code class="fe lb lc ld le b">true</code>强制为1，<code class="fe lb lc ld le b">null</code>强制为0，然后与<code class="fe lb lc ld le b">isNaN</code>进行比较，检查是否为<code class="fe lb lc ld le b">NaN</code>。</p><p id="6fae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，以下返回<code class="fe lb lc ld le b">true</code>:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="853e" class="mq lg iq le b gy mr ms l mt mu">isNaN('456ABC');</span></pre><p id="8d17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为<code class="fe lb lc ld le b">parseInt(‘456ABC’);</code>返回<code class="fe lb lc ld le b">456</code>，而<code class="fe lb lc ld le b">Number('456ABC')</code>返回<code class="fe lb lc ld le b">NaN</code>。</p><p id="13e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">Number.isNaN</code>函数检查一个值是否为<code class="fe lb lc ld le b">NaN</code>，但在进行比较之前不会尝试将其转换为数字。这是ES2015的新方法。</p><p id="8c10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以使用它来比较如下值:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="0390" class="mq lg iq le b gy mr ms l mt mu">Number.isNaN(NaN);        <br/>Number.isNaN(Number.NaN); <br/>Number.isNaN('foo' / 0);<br/>Number.isNaN(0 / 0);</span></pre><p id="24d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它们都返回<code class="fe lb lc ld le b">true</code>，因为我们放入参数的所有表达式都被赋值为<code class="fe lb lc ld le b">NaN</code>。</p><p id="7ede" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">任何不是<code class="fe lb lc ld le b">NaN</code>的东西都将返回<code class="fe lb lc ld le b">false</code>，所以像这样的表达式:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="c533" class="mq lg iq le b gy mr ms l mt mu">Number.isNaN('foo');</span></pre><p id="b389" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了参数中的数字，还将返回<code class="fe lb lc ld le b">false</code>。它只检查值是否为<code class="fe lb lc ld le b">NaN</code>，而不尝试先转换一个数字。</p><p id="b9d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以使用<code class="fe lb lc ld le b">Object.is</code>方法来检查一个值是否为<code class="fe lb lc ld le b">NaN</code>。像<code class="fe lb lc ld le b">Number.isNaN</code>一样，在与<code class="fe lb lc ld le b">NaN</code>进行相等比较之前，它不会尝试进行任何数据类型强制。</p><p id="4b08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">Object.is</code>认为<code class="fe lb lc ld le b">NaN</code>等于自身，所以我们可以用它来检查<code class="fe lb lc ld le b">NaN</code>。</p><p id="c716" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以像使用<code class="fe lb lc ld le b">isNaN</code>一样使用它。例如，我们可以写:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="590b" class="mq lg iq le b gy mr ms l mt mu">Object.is(NaN, NaN);<br/>Object.is<!-- -->(Number.NaN, NaN); <br/>Object.is<!-- -->('foo' / 0, NaN);<br/>Object.is<!-- -->(0 / 0, NaN);</span></pre><p id="0967" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将全部返回<code class="fe lb lc ld le b">true</code>。当与<code class="fe lb lc ld le b">NaN</code> will <code class="fe lb lc ld le b">Object.is</code>进行比较时，任何没有被显式评估为<code class="fe lb lc ld le b">NaN</code> will的都将返回<code class="fe lb lc ld le b">false</code>。例如:</p><pre class="mi mj mk ml gt mm le mn mo aw mp bi"><span id="6502" class="mq lg iq le b gy mr ms l mt mu">Number.isNaN('foo');</span></pre><p id="6a52" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">返回<code class="fe lb lc ld le b">false</code>。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/3c96b16d4213101ffeb15fb557265449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X0piVuP4OMO8A4G5"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@ronbinette?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ron Binette</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e95c" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="32ba" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">检查<code class="fe lb lc ld le b">null</code>和<code class="fe lb lc ld le b">NaN</code>各有窍门。除了<code class="fe lb lc ld le b">Object.is</code>之外，我们还可以使用<code class="fe lb lc ld le b">===</code>来检查<code class="fe lb lc ld le b">null</code>。</p><p id="b95f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了检查<code class="fe lb lc ld le b">NaN</code>，我们不能用<code class="fe lb lc ld le b">===</code>来检查<code class="fe lb lc ld le b">NaN</code>，因为<code class="fe lb lc ld le b">NaN === NaN</code>返回<code class="fe lb lc ld le b">false</code>。不过我们可以用<code class="fe lb lc ld le b">Object.is</code>、<code class="fe lb lc ld le b">isNaN</code>或者<code class="fe lb lc ld le b">Number.isNaN</code>来做比较。</p><h2 id="05ad" class="mq lg iq bd lh mw mx dn ll my mz dp lp ko na nb lt ks nc nd lx kw ne nf mb ng bi translated"><strong class="ak">简明英语团队的笔记</strong></h2><p id="a5bf" class="pw-post-body-paragraph kd ke iq kf b kg md ki kj kk me km kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">你知道我们有四种出版物吗？给他们一个follow来表达爱意:<a class="ae kc" href="https://medium.com/javascript-in-plain-english" rel="noopener"><strong class="kf ir">JavaScript in Plain English</strong></a><a class="ae kc" href="https://medium.com/ai-in-plain-english" rel="noopener"><strong class="kf ir">AI in Plain English</strong></a><a class="ae kc" href="https://medium.com/ux-in-plain-english" rel="noopener"><strong class="kf ir">UX in Plain English</strong></a><a class="ae kc" href="https://medium.com/python-in-plain-english" rel="noopener"><strong class="kf ir">Python in Plain English</strong></a><strong class="kf ir"/>—谢谢，继续学习！</p><p id="d48f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们总是有兴趣帮助推广好的内容。如果您有一篇文章想要提交给我们的任何出版物，请发送电子邮件至<a class="ae kc" href="mailto:submissions@plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">submissions @ plain English . io</strong></a><strong class="kf ir"/>，附上您的媒体用户名和您感兴趣的内容，我们将会回复您！</p></div></div>    
</body>
</html>