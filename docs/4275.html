<html>
<head>
<title>Costly Mistakes: Why We Had to Abandon Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代价高昂的错误:为什么我们不得不放弃Firebase</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/costly-mistakes-why-we-had-to-abandoned-firebase-b89930c10d92?source=collection_archive---------0-----------------------#2020-11-30">https://javascript.plainenglish.io/costly-mistakes-why-we-had-to-abandoned-firebase-b89930c10d92?source=collection_archive---------0-----------------------#2020-11-30</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="a011" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">随之而来的是三年的工作。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/b860324a62ad41133488950f06b3a695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtqQSljK0yr773B1Pd8U8g.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@nicholasjio?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Nick Jio</a> on <a class="ae kw" href="https://unsplash.com/s/photos/abandon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5915" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">那一年是2018年。我们快要毕业了。我们有一个伟大的想法，我们认为这将使我们成为亿万富翁(剧透:它没有)。</p><p id="3859" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是有一次一个伟大的头脑说一个伟大的想法本身不算数。你需要执行力。</p><p id="e824" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以需要建造这该死的东西。我们必须尽快完成。但我们是一个只有4名成员的团队。</p><p id="b191" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以我们都开始做研究(主要是谷歌搜索👊)找出最快、最简单的方法来生产我们可以在一夜之间运送给数百万客户的产品。</p><p id="2914" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">答案是<strong class="kz is">火焰基地。我们被许诺了伟大的事情。这对我们来说是完美的解决方案。</strong></p><h2 id="149e" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">促使我们选择Firebase的原因</h2><ul class=""><li id="95e4" class="mm mn ir kz b la mo ld mp lg mq lk mr lo ms ls mt mu mv mw bi translated">不需要后端工程师。我们只需要建立前端。</li><li id="507a" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">免费层相当慷慨。</li><li id="c9f0" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">基本没有准入门槛。</li><li id="bf12" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">非常好用。</li><li id="b747" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">几乎拥有我们需要的一切。</li><li id="e3a4" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">最重要的是，它是由谷歌建造的。</li></ul><p id="a271" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Firebase确实有一些很棒的特性。非常适合初学者。我们经常使用的一些功能有</p><ul class=""><li id="e864" class="mm mn ir kz b la lb ld le lg nc lk nd lo ne ls mt mu mv mw bi translated"><strong class="kz is"> Firestore: </strong>这是一个高度可扩展的实时NoSQL数据库解决方案，可以由任何前端直接使用。</li><li id="dfce" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated"><strong class="kz is">认证:</strong>我们根本不用担心系统的认证部分。Firebase完全掩护了我们。</li><li id="fc70" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">存储:我们使用Firebase存储主要存储我们的图像。</li><li id="52a4" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated"><strong class="kz is">通知:</strong> Firebase提供了一个非常容易实现的通知服务。</li><li id="eb45" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">托管: Firebase让我们托管静态网站变得超级简单。我们的前端React应用程序是使用Firebase托管的。</li><li id="c96a" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated"><strong class="kz is">功能:</strong>它们运行在云上。它们可以对您的数据级别上的任何类型的事件做出响应。我们主要使用这个服务来发送通知。</li></ul><p id="8fe1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以我们在所有的项目中都使用了Firebase。从移动应用程序到web面板。我们确实在很短的时间内取得了良好的进展，甚至为我们自己管理了资金。</p><p id="034b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在我们不得不扩大规模之前，一切都很顺利。我们有一些新的团队成员来帮助我们完成项目。我们的仪表板和管理面板需要更多的定制。事情开始出错。</p><p id="52c8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我解释一下。。。</p><h2 id="ec37" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">不一致的数据</h2><p id="ae8f" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">由于Firebase Firestore本质上是NoSQL，因此可以推送的数据没有限制。</p><p id="f747" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，可能一些开发人员添加了一些额外的字段或忘记对值进行空检查，整个应用程序崩溃了。</p><p id="54b1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">每次我们把一些东西推向生产，我们必须祈祷它不会破坏其他东西。</p><p id="fca2" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">随着越来越多的开发商开始加入，问题也越来越多。每个错误都浪费了我们很多时间。不值得。核心成员不得不夜以继日地工作，仅仅是为了让产品存活下去。</p><p id="a1fb" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">每一部新电影都是一场噩梦。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="1951" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">一致性</h2><p id="585e" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">Firebase在<strong class="kz is"> </strong>字段级别为<strong class="kz is">事务</strong>提供了一些机制。但是很难维持。</p><p id="0e8c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">有人可能会存储一个名为<strong class="kz is">用户标识</strong>的字段，如果其他人通过字段<strong class="kz is">用户标识</strong>推送另一个用户，整个应用程序就会崩溃</p><p id="73f6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因为我们不得不直接从前端操作数据库，许多不好的事情发生在前端。也许用户关闭了他的应用程序或者设备关闭了。很难找到任何问题的确切原因。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj np"><img src="../Images/a1c106ab171fd55e446721177355cb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PwHcbI20Ic-hbf6yKjs3qg.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@matiasmalka?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Matias Malka</a> on <a class="ae kw" href="https://unsplash.com/s/photos/frustration?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="371a" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">加入多个集合</h2><p id="ecc4" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">您无法连接两个集合来获取一些数据。</p><p id="7e1c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">例如，您有一个<strong class="kz is">用户</strong>集合。您还有另一个用于<strong class="kz is">车辆</strong>的集合，您需要用它来存储车主的信息。因此，您必须在车辆集合中保留用户的id。</p><p id="9bba" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在想象一个场景，您需要显示带有车主姓名的车辆列表。</p><p id="a2dc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Firebase的解决方案是</p><ol class=""><li id="c2b4" class="mm mn ir kz b la lb ld le lg nc lk nd lo ne ls nq mu mv mw bi translated">加载车辆列表。</li><li id="4019" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls nq mu mv mw bi translated">从它们中获取用户id。</li><li id="3a95" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls nq mu mv mw bi translated">分别给每个用户打电话以获取他们的详细信息。</li></ol><p id="1a45" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在想象一下，如果你必须用它来显示其他数据。可能需要存储车辆驾驶员信息。</p><p id="0ad8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">你能明白我的意思吗？</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="ab37" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">数据复制</h2><p id="cd95" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">为了避免与连接集合相关的问题，我们通常不得不采取的解决方案是在集合之间复制数据。所以现在如果我们要在创建的时候创建一辆车，我们必须存储关于它的所有者的数据。</p><p id="9d72" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，当我们需要显示数据时，我们只需获得车辆的数据，而不必担心车主并进行第二次呼叫。</p><p id="033b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是这个解决方案也带来了一些其他的问题。现在，无论何时任何用户更新他的信息，我们都必须随时更新数据。所以我们必须跟踪存储用户信息的所有集合。</p><p id="dad7" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">找到最佳点非常困难。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="ea41" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">代码复杂性</h2><p id="bc92" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">因此，随着我们的查询变得复杂，前端代码也变得复杂。此外，我们必须对所有内容进行两次编码。一次用于移动设备，另一次用于web前端。</p><p id="b3b1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">为了更新产品系列，我们不能再依赖单个团队成员了。</p><p id="e68d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们采用了Firebase本身提供的解决方案，即Firebase函数。</p><p id="edd8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">基本上，一些数据更改可以触发Firebase函数。这些函数是使用typescript编写的，托管在Firebase上。</p><p id="fff2" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，作为一个解决方案，每当任何用户更新他们的信息时，我们必须触发一个函数来更新该用户的所有相关字段。</p><p id="cfa1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在最初问题的解决方案变成了问题本身。基本上，现在我们所做的是从3个地方访问和更新数据。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="7bb0" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">效率</h2><p id="1565" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">随着我们的团队越来越大，我们再也无法应付了。我们不得不投入大量的时间和资源来维护数据的完整性，但仍然无法高效地查询我们的数据。</p><p id="2660" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">每个开发人员现在都必须非常小心地做每一件事，以免弄坏东西。强制每个人遵循一些通用规则和命名约定需要一些时间。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="ec8c" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">费用</h2><p id="0978" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">Firebase确实为其所有服务提供了一个免费层。但是在那之后，它变得非常昂贵。之后，成本取决于文档读取的次数。</p><p id="1ef0" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">由于我们必须在各种集合之间保持高度的一致性，账单堆积如山。已经不值得了。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="79f1" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">启示</h2><p id="a4ba" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">所以在面对所有这些问题之后，我们最终决定继续前进。</p><p id="191b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们决定使用Node.js和Postgres重写我们的整个后端。对于主机，我们现在使用AWS。</p><p id="8968" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们仍然使用Firebase进行身份验证和通知。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><h2 id="d971" class="lt lu ir bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">那么Firebase对每个人都不好吗？</h2><p id="b4d2" class="pw-post-body-paragraph kx ky ir kz b la mo js lc ld mp jv lf lg nf li lj lk ng lm ln lo nh lq lr ls ik bi translated">最简单的答案是否定的。仍然有很多你应该考虑使用Firebase的用例。</p><ul class=""><li id="2183" class="mm mn ir kz b la lb ld le lg nc lk nd lo ne ls mt mu mv mw bi translated">首先，这是一项很值得学习的技术。如果你开始你的职业生涯，你应该学习它。这有助于很容易地熟悉数据存储技术。</li><li id="c7cb" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">对于通知和用户认证，它仍然是一个很好的简单的解决方案。</li><li id="3624" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">如果你是一个独立开发者或自由职业者，你需要快速行动，你应该使用Firebase。</li><li id="d07c" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">如果你正在做的项目规模很小或供内部使用，你应该考虑它。</li></ul><p id="a0ce" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是</p><ul class=""><li id="9b78" class="mm mn ir kz b la lb ld le lg nc lk nd lo ne ls mt mu mv mw bi translated">如果你想做点正经事。</li><li id="5cec" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">如果你想让你的项目被很多人使用。</li><li id="89f0" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">如果您的项目需要一些复杂的数据操作。</li><li id="3dec" class="mm mn ir kz b la mx ld my lg mz lk na lo nb ls mt mu mv mw bi translated">如果你想学一些对你长远有帮助的东西。</li></ul><p id="18f4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">那么去Firebase(至少对我们来说)是一个大禁忌。你应该去看看别的东西。</p><p id="463d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天到此为止。编码快乐！</p><p id="7e40" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">通过</strong> <a class="ae kw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> LinkedIn </strong> </a> <strong class="kz is">或我的</strong> <a class="ae kw" href="https://www.mohammadfaisal.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is">个人网站</strong> </a> <strong class="kz is">与我取得联系。</strong></p></div></div>    
</body>
</html>