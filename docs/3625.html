<html>
<head>
<title>3 Reasons to Use Fewer JavaScript Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">少用JavaScript库的3个理由</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/3-reasons-to-use-fewer-javascript-libraries-7226b64868a4?source=collection_archive---------6-----------------------#2020-10-13">https://javascript.plainenglish.io/3-reasons-to-use-fewer-javascript-libraries-7226b64868a4?source=collection_archive---------6-----------------------#2020-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8593" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你的package.json不应该比你的代码长</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4643f9669a289d1d07949a8ad44e7874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ia-dQu-W9WGpJjuEYCVOSA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Dependencies of styled-components, <a class="ae kv" href="https://npm.anvaka.com/#/view/2d/styled-components" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="8343" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有NPM和库，整个现代JavaScript世界会是什么样子？并非没有好的理由，有许多迷因每隔几秒钟就会出现一个新的库或框架。</p><p id="40b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是像我们一样使用这么多的库也有一些缺点。我们在一个巨大的、错综复杂的依赖网络上构建我们的应用程序。你可以在标题图片中看到这一点——它可视化了流行的库<strong class="ky ir"> styled-components </strong>构建在哪些包上。</p><p id="58cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">甚至直接使用这么多的库也会成为一个问题——不仅仅是子依赖关系。</p><p id="a38b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有三个我们不应该使用这么多库的好理由。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a212" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">性能差</h1><p id="66df" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在web开发领域，有一条黄金法则:向用户交付尽可能少的代码:代码越少，页面加载越快。</p><p id="229c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也是至少几乎所有人都认为他们应该遵守的规则——在网站开发期间，我们都喜欢查看Chrome Devtools，看看每个文件有多大——以及向用户发送了什么。</p><p id="df52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是当我们看到我们收录的某个库相当大的时候，往往也只是接受。</p><p id="45f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Moment.js就是一个很好的例子——仅在NPM，该软件包每周就有近1500万次下载。尽管这个库是一个巨大的<strong class="ky ir"> 288.4 kb </strong>的缩小版。</p><p id="dd6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，这个图书馆有它的合理性——但是许多人只是选择了第一个做这项工作的最好的图书馆。</p><p id="f4fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦库被包含进来，它就会被不时地更新——有了NPM，你可以很容易地更新所有的依赖项；如果你不使用NPM，你甚至可以拥有一个最新版本的CDN。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/9c8746a3b0bd89b3e89c3bb0a19f8ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ix2TAGMfYyjuOCkxLYRqA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Size of Moment.js. <a class="ae kv" href="https://bundlephobia.com/result?p=moment@2.25.0" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="7da9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">唯一的问题是代码可能会发生巨大的变化。</p><p id="ec23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Moment.js在最近的版本中变得更大——突然之间，灯塔的分数看起来与以前完全不同。</p><p id="bc80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图中显示了尺寸在最新版本中的变化。</p><p id="4c3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Moment.js的例子中，GitHub官方网站甚至说在使用Moment之前你应该三思。</p><p id="f440" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">毕竟，有许多替代方案，这些方案要小得多，而且在大多数情况下，可能已经足够了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/f391257ce76d3990c4e839df2a2de35e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-axQ0SjMhC2idZEIB7Q9Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: <a class="ae kv" href="https://github.com/you-dont-need/You-Dont-Need-Momentjs/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">GitHub</a></figcaption></figure><p id="f660" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">说到性能，不仅要考虑大小，还要考虑执行本身的性能——不能保证库是优化的，而且由于抽象，它们几乎总是比找到问题的定制解决方案慢。</p><p id="21bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个很好的例子是<strong class="ky ir">风格的组件</strong>。与纯CSS相比，它要慢得多(没有SSR)——但使用起来仍然非常舒适。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0ed3" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">易受伤害的</h1><p id="9cbe" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">与此同时，有许多关于个别NPM套餐的具体丑闻。太有趣了，我写了一篇关于它们的文章。</p><div class="my mz gp gr na nb"><a href="https://medium.com/javascript-in-plain-english/the-biggest-scandals-of-npm-d739c11a2406" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">NPM最大的丑闻</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">JavaScript世界中巨大的依赖树使得开发变得非常愉快。但有时它会压倒…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">medium.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np kp nb"/></div></div></a></div><p id="7948" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我提到的丑闻的一个例子是包<strong class="ky ir">事件流</strong>。</p><p id="0f96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">拥有每周近200万次下载的库的所有者对它失去了兴趣，并放弃了它。他把所有权让给了一个陌生人，这个陌生人通过邮件联系了他。</p><p id="f373" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在新所有者的领导下，对库只有一个提交:他添加了一个新的依赖项。一些人立刻注意到有些不对劲——他们是对的。</p><p id="3ff2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">新的依赖关系包含恶意软件，当使用事件流库时，该恶意软件将在受害者的机器上运行。</p><p id="1b43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">直到今天，甚至不清楚新的所有者是否有意将有害的依赖项添加到库中，或者可能甚至不知道它包含什么。</p><p id="b0b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们应该记住的问题很简单——来自第三方的任何包或库通常可以包含几乎任何类型的代码。毕竟，代码是由犯错误甚至怀有恶意的人编写的。</p><p id="0ac1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别关键的一点是，我们通过NPM安装的几乎每个包都有自己的依赖项——例如，Express.js包含30个包。我们都使用了大量来自第三方的代码，却没有注意到或知道实际发生了什么。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="ab3b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">弃用和错误</h1><p id="6879" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">像所有其他东西一样，包和库也会老化。尤其是如果它们没有得到精心维护的话。</p><p id="fcda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它们会以两种方式变得陈旧/多余</p><ul class=""><li id="dc3a" class="nq nr iq ky b kz la lc ld lf ns lj nt ln nu lr nv nw nx ny bi translated">它们是多余的，因为有原生特征。</li><li id="bd80" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated">代码不再有效。</li></ul><p id="26cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Left Pad是一个很小的JavaScript库，可以用来对字符串执行操作。它从左侧用空白填充字符串，如示例所示:</p><pre class="kg kh ki kj gt oe of og oh aw oi bi"><span id="8054" class="oj ma iq of b gy ok ol l om on">leftPad("foo", 5)<br/>=&gt; "  foo"</span><span id="51b9" class="oj ma iq of b gy oo ol l om on">leftPad("foo", 7)<br/>=&gt; "    foo"</span><span id="03f9" class="oj ma iq of b gy oo ol l om on">leftPad("foooo", 5)<br/>=&gt; "foooo"</span></pre><p id="4939" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能认为任何需要这种功能的JavaScript开发人员都会很快自己实现代码——但事实并非如此。我们都已经变得太习惯于简单地用库解决所有问题。因此，NPM的left-pad每周仍有460万次下载——尽管它现在已经过时了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/cbd465b333aee2111590a951f0b88ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*QcX7JL1xYGchjQCdCwWSsg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://github.com/left-pad/left-pad" rel="noopener ugc nofollow" target="_blank">https://github.com/left-pad/left-pad</a></figcaption></figure><p id="652f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着时间的推移，JavaScript的变化越来越多，新的特性也随之而来。例如，<strong class="ky ir">左键</strong>现在被上面显示的原生函数所取代。</p><p id="3033" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以现在你可以为自己节省额外的代码——使用<strong class="ky ir"> <br/>左键</strong>就不那么悲惨了，因为这个库很小。</p><p id="ace5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是还有更糟糕的情况——如果代码不是多余的，只是不再工作了怎么办？<br/>这可能有两个原因:</p><ul class=""><li id="a413" class="nq nr iq ky b kz la lc ld lf ns lj nt ln nu lr nv nw nx ny bi translated">该代码不再有效，因为它所基于的内容不再受支持。</li><li id="b235" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated">库代码中有一个错误。</li></ul><p id="eceb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，对于javascript代码，这种情况并不经常发生。大多数进化的编程语言仍然是向后兼容的。因此，旧的功能仍然有效，即使它们已经过时。</p><p id="0528" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像Vue、React.js和Angular这样的框架更容易出现这个问题——它们经常发生根本性的变化，突然间它们不再支持以前易于使用的整个概念。</p><p id="6945" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果一个包完全基于此，它可能会有问题。尽管像React.js这样的框架和库并不难使用，但是有一些包可以使这些特性变得更容易。</p><p id="d76b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，在React.js中，使用门户，然后是生命周期方法或使用状态。</p><h2 id="db0c" class="oj ma iq bd mb oq or dn mf os ot dp mj lf ou ov ml lj ow ox mn ln oy oz mp pa bi translated">来自第三方的代码不一定是没有错误的</h2><p id="338c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">一个众所周知的例子是<strong class="ky ir">is-promise</strong>——一个名副其实的包。在NPM，该软件每周有940万次下载。因此是许多大型项目的组成部分。</p><p id="54ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是后来发生在每个程序员身上的事情——一个错误发生了。<br/>对代码进行了修改，修改被接受并发布了——但是它包含了一个错误，这个错误立即导致了所有系统的问题。</p><p id="2252" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中<strong class="ky ir"> firebase-tools </strong>、<strong class="ky ir"> angular-cli、</strong>以及<strong class="ky ir"> create-react-app </strong>都有<strong class="ky ir"> is-promise </strong>作为依赖——所以那天每个只想创建一个新react应用的人都受到了影响。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="e3b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终，来自第三方的NPM包和代码总是只有人。通常甚至只有那些利用空闲时间开发这些库的人——当然，这可能会出错。</p><p id="faad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是当这样的错误发生时，全世界的开发人员都会陷入困境——他们中的大多数人都不知道错误是什么。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1b76" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">总结</h1><p id="41c0" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">坏消息是，特别是当使用更大的包时，比如CLI或框架本身的代码，你不能回避所有的小依赖。然而，好消息是，在NPM可用的大型项目，如firebase、express &amp; create-react-app，有望得到负责任的维护。</p><p id="67e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尤其是过去的事件应该呼吁这一点。</p><p id="47c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使直接使用库，也有一些事情我们可以做得更好。询问Google是否有库x的替代品总是一个好主意——通常你会找到一个更小但仍然满足你需求的库。</p><p id="28ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于贬值的问题，看看NPM或者GitHub的页面是很有用的。在那里你可以看到谁在维护这个项目，以及它是否还在定期更新。一些迫在眉睫的灾难可以通过在那里的讨论及早发现。</p><p id="a242" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，你能在网上找到的一些最流行的库很小——它们只有一两个功能，帮助完成最少的任务。遗憾的是，我们不敢自己编写这样的程序——相反，我们经常依赖于一个库。</p><p id="1dbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我特别的弱点是像<strong class="ky ir"> js-cookie </strong>这样的包，它们使得在浏览器中使用cookie更加容易。尽管这个库很小，但在我的许多项目中，它实际上是完全没有必要的——不依赖于库，你通常会学到全新的东西。</p><p id="f081" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="http://eepurl.com/hacY0v" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">加入我的简讯保持联系</strong> </a></p></div></div>    
</body>
</html>