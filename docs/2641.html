<html>
<head>
<title>Building a live preview in React Native using your existing React components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用现有的React组件在React Native中构建实时预览</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-a-live-preview-in-react-native-using-your-existing-react-components-7fad9762811e?source=collection_archive---------6-----------------------#2020-07-11">https://javascript.plainenglish.io/building-a-live-preview-in-react-native-using-your-existing-react-components-7fad9762811e?source=collection_archive---------6-----------------------#2020-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7dfa2b59f68bc5a423516588308d38da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JuqxMwncqhE4lhsB"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@grohsfabian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Fabian Grohs</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e7a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我发现自己最近转换了一个基于React的网站，该网站为用户提供了他们正在构建的文档的实时预览，同时允许他们在打印之前轻松地更改文档的内容和样式。</p><p id="6f63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预览效果真的很好，因为你可以快速地以你喜欢的方式设计文档，并将预览转换为PDF，然后将文档发送给你需要的人，这比在Word中做这种工作有了很大的改进。</p><p id="5a84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着React网站向React原生应用的转换，我希望保留预览版，如果可能的话，重用预览版中使用的相同组件，而不是将大量模板移植到React原生应用。</p><p id="864a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种方法虽然有点棘手，但可以让应用程序利用网页版上使用的所有模板，以及随着时间的推移添加的任何其他模板。</p><p id="ae0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我的用例来说，这非常好，这意味着我可以编写一组组件来布局一个文档，并在web、app和print上呈现它，这使得支持多个平台变得更加容易。</p><h2 id="07bd" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">示例反应组分</h2><p id="9302" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">为了说明这个过程，我将创建一个示例React组件。该组件将在React网站中使用，以布局用户提供的一些信息，我们希望在React本机应用程序中重用这些信息。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">This component simply returns the name and activity passed in and renders children (for things like inputs)</figcaption></figure><p id="69ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该组件应该以某种形式存在于可以导入React网站的组件库中，这一点很重要，如果该组件存储在本地，那么React和React Native在找到要导入的文件时会有问题。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Rendering the component in React, passing in a form as a child so it will render the form inside the layout</figcaption></figure><h1 id="b67b" class="mf lc iq bd ld mg mh mi lg mj mk ml lj mm mn mo lm mp mq mr lp ms mt mu ls mv bi translated">在React Native中渲染React</h1><p id="7a9f" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">来自<code class="fe mw mx my mz b">react-native-webview</code>的<code class="fe mw mx my mz b">Webview</code>组件可以呈现一个通过props传递给它的HTML字符串，所以我们将使用它来显示组件，但是我们不能只是传递给它组件，并希望它能理解我们需要先将其转换成HTML。</p><p id="f722" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mw mx my mz b">react-dom/server</code>模块有一个名为<code class="fe mw mx my mz b">renderToString</code>的函数，它接受一个React组件并返回一个HTML字符串，但由于我们正在使用的组件旨在在网页中呈现一个子树，它缺少它被标记为使用的CSS定义。</p><figure class="lz ma mb mc gt jr"><div class="bz fp l di"><div class="md me l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">You’ll need to install react-native-webview and react-dom in order to use this example</figcaption></figure><p id="c9dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以将从<code class="fe mw mx my mz b">renderToString</code>函数返回的HTML封装在一个HTML框架中，该框架添加标记以导入CSS框架，并添加<code class="fe mw mx my mz b">originWhitelist</code>属性以允许<code class="fe mw mx my mz b">Webview</code>下载这些标记正在使用的资源。</p><p id="48a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最终结果是在一个<code class="fe mw mx my mz b">Webview</code>中实时预览组件的输出，这个组件可以用React本地组件(如<code class="fe mw mx my mz b">TextInput</code>)来控制。</p><h1 id="58d3" class="mf lc iq bd ld mg mh mi lg mj mk ml lj mm mn mo lm mp mq mr lp ms mt mu ls mv bi translated">警告</h1><p id="2588" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">值得指出的是，我所做的用例不需要实时更新，所以我无法验证这种技术的性能是否适用于需要即时更新的应用程序。</p><p id="3358" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，如果您正在处理连接的组件，那么这种方法不太可能起作用，但是如果您重构组件以分离状态和结构，那么您应该能够使用这种方法。</p></div></div>    
</body>
</html>