<html>
<head>
<title>How to Download CSV and JSON files in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中下载CSV和JSON文件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-download-csv-and-json-files-in-react-2741613a510?source=collection_archive---------7-----------------------#2018-10-30">https://javascript.plainenglish.io/how-to-download-csv-and-json-files-in-react-2741613a510?source=collection_archive---------7-----------------------#2018-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/69c49551730a31ebaf0f87929bbec686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4euWYiU8xEoCGeQI.png"/></div></div></figure><p id="a072" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">本文原载于</em> <a class="ae kx" href="https://theroadtoenterprise.com/blog/how-to-download-csv-and-json-files-in-react" rel="noopener ugc nofollow" target="_blank"> <em class="kw">企业之路</em> </a> <em class="kw">博客。在那里阅读，获得最佳阅读体验。</em></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="23b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有些网站让用户下载CSV或JSON数据作为文件。这种功能非常有用，因为用户可以下载数据进行进一步处理或共享。在本文中，您将了解如何添加允许用户在React中导出表格并以JSON和CSV格式下载的功能。</p><p id="a57b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kx" href="https://github.com/ThomasFindlay/csv-json-files-download-in-react" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到完整的代码示例。</p><h1 id="07ab" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">项目设置</h1><p id="bf0a" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">首先，让我们使用<a class="ae kx" href="https://vitejs.dev" rel="noopener ugc nofollow" target="_blank"> Vite </a>创建一个新的React项目。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="2929" class="mr lg iq mn b gy ms mt l mu mv">npm init vite@latest csv-json-files-download -- --template react</span></pre><p id="8ae5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建项目后，通过运行<code class="fe mw mx my mn b">npm install</code>将<em class="kw"> cd </em>放入其中以安装依赖项，然后使用<code class="fe mw mx my mn b">npm run dev</code>启动开发服务器。</p><p id="1b39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要修改<strong class="ka ir"> App.jsx </strong>和<strong class="ka ir"> App.css </strong>文件。</p><p id="1572" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> src/App.jsx </strong></p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="0570" class="mr lg iq mn b gy ms mt l mu mv">import React from 'react'<br/><br/>function App() {<br/>  return (<br/>    &lt;div className='App'&gt;<br/>      &lt;h1&gt;How to download CSV and JSON files in React&lt;/h1&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}<br/><br/>export default App</span></pre><p id="34aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> src/App.css </strong></p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="793b" class="mr lg iq mn b gy ms mt l mu mv">.App {<br/>  max-width: 40rem;<br/>  margin: 2rem auto;<br/>}</span></pre><p id="db26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这对于初始设置来说已经足够了。让我们从添加导出到JSON的功能开始。</p><h1 id="c744" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">导出到JSON</h1><p id="cc03" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">让我们首先创建一个包含用户数据的文件，该文件将用于下载文件和呈现表格。</p><p id="5a64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> src/users.json </strong></p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="f505" class="mr lg iq mn b gy ms mt l mu mv">{<br/>  "users": [<br/>    {<br/>      "id": 1,<br/>      "name": "Caitlyn",<br/>      "surname": "Kerluke",<br/>      "age": 24<br/>    },<br/>    {<br/>      "id": 2,<br/>      "name": "Rowan ",<br/>      "surname": "Nikolaus",<br/>      "age": 45<br/>    },<br/>    {<br/>      "id": 3,<br/>      "name": "Kassandra",<br/>      "surname": "Haley",<br/>      "age": 32<br/>    },<br/>    {<br/>      "id": 4,<br/>      "name": "Rusty",<br/>      "surname": "Arne",<br/>      "age": 58<br/>    }<br/>  ]<br/>}</span></pre><p id="5af6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们需要更新<code class="fe mw mx my mn b">App</code>组件，以利用<code class="fe mw mx my mn b">users</code>数据并将其显示在表格中。除此之外，我们将添加一个按钮来触发下载。下面你可以看到<code class="fe mw mx my mn b">App.jsx</code>组件的代码。除了组件。我们有两个功能:<code class="fe mw mx my mn b">exportToJson</code>和<code class="fe mw mx my mn b">downloadFile</code>。前者用适当的参数调用后者。<code class="fe mw mx my mn b">downloadFile</code>函数接受一个对象作为参数，并期望三个属性:</p><ul class=""><li id="f2aa" class="mz na iq ka b kb kc kf kg kj nb kn nc kr nd kv ne nf ng nh bi translated"><em class="kw">数据</em></li><li id="1f59" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated"><em class="kw">文件名</em></li><li id="fb43" class="mz na iq ka b kb ni kf nj kj nk kn nl kr nm kv ne nf ng nh bi translated"><em class="kw">文件类型</em></li></ul><p id="1985" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mw mx my mn b">data</code>和<code class="fe mw mx my mn b">fileType</code>用于创建下载的<code class="fe mw mx my mn b">blob</code>。之后，我们创建一个锚元素，并在其上调度一个<code class="fe mw mx my mn b">click</code>事件。</p><p id="edf1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> src/App.jsx </strong></p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="1355" class="mr lg iq mn b gy ms mt l mu mv">import React from 'react'<br/>import './App.css'<br/>import usersData from './users.json'<br/><br/>const downloadFile = ({ data, fileName, fileType }) =&gt; {<br/>  // Create a blob with the data we want to download as a file<br/>  const blob = new Blob([data], { type: fileType })<br/>  // Create an anchor element and dispatch a click event on it<br/>  // to trigger a download<br/>  const a = document.createElement('a')<br/>  a.download = fileName<br/>  a.href = window.URL.createObjectURL(blob)<br/>  const clickEvt = new MouseEvent('click', {<br/>    view: window,<br/>    bubbles: true,<br/>    cancelable: true,<br/>  })<br/>  a.dispatchEvent(clickEvt)<br/>  a.remove()<br/>}<br/><br/>const exportToJson = e =&gt; {<br/>  e.preventDefault()<br/>  downloadFile({<br/>    data: JSON.stringify(usersData.users),<br/>    fileName: 'users.json',<br/>    fileType: 'text/json',<br/>  })<br/>}<br/><br/>function App() {<br/>  return (<br/>    &lt;div className='App'&gt;<br/>      &lt;h1&gt;How to download CSV and JSON files in React&lt;/h1&gt;<br/><br/>      &lt;table className='usersTable'&gt;<br/>        &lt;thead&gt;<br/>          &lt;tr&gt;<br/>            &lt;th&gt;ID&lt;/th&gt;<br/>            &lt;th&gt;Name&lt;/th&gt;<br/>            &lt;th&gt;Surname&lt;/th&gt;<br/>            &lt;th&gt;Age&lt;/th&gt;<br/>          &lt;/tr&gt;<br/>        &lt;/thead&gt;<br/>        &lt;tbody&gt;<br/>          {usersData.users.map(user =&gt; {<br/>            const { id, name, surname, age } = user<br/>            return (<br/>              &lt;tr key={id}&gt;<br/>                &lt;td&gt;{id}&lt;/td&gt;<br/>                &lt;td&gt;{name}&lt;/td&gt;<br/>                &lt;td&gt;{surname}&lt;/td&gt;<br/>                &lt;td&gt;{age}&lt;/td&gt;<br/>              &lt;/tr&gt;<br/>            )<br/>          })}<br/>        &lt;/tbody&gt;<br/>      &lt;/table&gt;<br/>      &lt;div className='actionBtns'&gt;<br/>        &lt;button type='button' onClick={exportToJson}&gt;<br/>          Export to JSON<br/>        &lt;/button&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}<br/><br/>export default App</span></pre><p id="795b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以添加一些样式，这样桌子看起来会更好一些。</p><p id="2342" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> src/App.css </strong></p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="d9ca" class="mr lg iq mn b gy ms mt l mu mv">.App {<br/>  max-width: 40rem;<br/>  margin: 2rem auto;<br/>}<br/><br/>.usersTable th,<br/>.usersTable td {<br/>  padding: 0.4rem 0.6rem;<br/>  text-align: left;<br/>}<br/><br/>.actionBtns {<br/>  margin-top: 1rem;<br/>}<br/><br/>.actionBtns button + button {<br/>  margin-left: 1rem;<br/>}</span></pre><p id="8098" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很好，现在您应该能够通过点击<code class="fe mw mx my mn b">Export to JSON</code>按钮将<code class="fe mw mx my mn b">users</code>数据下载为JSON文件。接下来，我们将添加<code class="fe mw mx my mn b">Export to CSV</code>功能。</p><h1 id="0fa4" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">导出到CSV</h1><p id="92f5" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们需要另一个按钮，将用于导出数据到一个CSV文件。除此之外，我们还需要一个处理程序。<code class="fe mw mx my mn b">usersData</code>是JSON格式的，所以我们需要将其转换成CSV格式，然后再将其传递给<code class="fe mw mx my mn b">downloadFile</code>函数。</p><p id="abe8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> src/App.jsx </strong></p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="b177" class="mr lg iq mn b gy ms mt l mu mv">import React from 'react'<br/>import './App.css'<br/>import usersData from './users.json'<br/><br/>const downloadFile = ({ data, fileName, fileType }) =&gt; {<br/>  const blob = new Blob([data], { type: fileType })<br/><br/>  const a = document.createElement('a')<br/>  a.download = fileName<br/>  a.href = window.URL.createObjectURL(blob)<br/>  const clickEvt = new MouseEvent('click', {<br/>    view: window,<br/>    bubbles: true,<br/>    cancelable: true,<br/>  })<br/>  a.dispatchEvent(clickEvt)<br/>  a.remove()<br/>}<br/><br/>const exportToJson = e =&gt; {<br/>  e.preventDefault()<br/>  downloadFile({<br/>    data: JSON.stringify(usersData.users),<br/>    fileName: 'users.json',<br/>    fileType: 'text/json',<br/>  })<br/>}<br/><br/>const exportToCsv = e =&gt; {<br/>  e.preventDefault()<br/><br/>  // Headers for each column<br/>  let headers = ['Id,Name,Surname,Age']<br/><br/>  // Convert users data to a csv<br/>  let usersCsv = usersData.users.reduce((acc, user) =&gt; {<br/>    const { id, name, surname, age } = user<br/>    acc.push([id, name, surname, age].join(','))<br/>    return acc<br/>  }, [])<br/><br/>  downloadFile({<br/>    data: [...headers, ...usersCsv].join('\n'),<br/>    fileName: 'users.csv',<br/>    fileType: 'text/csv',<br/>  })<br/>}<br/><br/>function App() {<br/>  return (<br/>    &lt;div className='App'&gt;<br/>      &lt;h1&gt;How to download CSV and JSON files in React&lt;/h1&gt;<br/><br/>      &lt;table className='usersTable'&gt;<br/>        &lt;thead&gt;<br/>          &lt;tr&gt;<br/>            &lt;th&gt;ID&lt;/th&gt;<br/>            &lt;th&gt;Name&lt;/th&gt;<br/>            &lt;th&gt;Surname&lt;/th&gt;<br/>            &lt;th&gt;Age&lt;/th&gt;<br/>          &lt;/tr&gt;<br/>        &lt;/thead&gt;<br/>        &lt;tbody&gt;<br/>          {usersData.users.map(user =&gt; {<br/>            const { id, name, surname, age } = user<br/>            return (<br/>              &lt;tr key={id}&gt;<br/>                &lt;td&gt;{id}&lt;/td&gt;<br/>                &lt;td&gt;{name}&lt;/td&gt;<br/>                &lt;td&gt;{surname}&lt;/td&gt;<br/>                &lt;td&gt;{age}&lt;/td&gt;<br/>              &lt;/tr&gt;<br/>            )<br/>          })}<br/>        &lt;/tbody&gt;<br/>      &lt;/table&gt;<br/>      &lt;div className='actionBtns'&gt;<br/>        &lt;button type='button' onClick={exportToJson}&gt;<br/>          Export to JSON<br/>        &lt;/button&gt;<br/>        &lt;button type='button' onClick={exportToCsv}&gt;<br/>          Export to CSV<br/>        &lt;/button&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}<br/><br/>export default App</span></pre><h1 id="1cc2" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">包裹</h1><p id="5066" class="pw-post-body-paragraph jy jz iq ka b kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们找到了。我希望你喜欢这篇文章。现在，您应该已经很好地掌握了如何在自己的项目中添加下载文件功能的知识。请记住，即使我使用React来演示下载示例，您也可以在其他框架中使用下载逻辑，如Vue、Svelte或Angular。</p><p id="cf89" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">想了解最新信息并学习更多编程技巧吗？请务必在<a class="ae kx" href="https://twitter.com/thomasfindlay94" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，并订阅<a class="ae kx" href="https://theroadtoenterprise.com/blog/subscribe" rel="noopener ugc nofollow" target="_blank">时事通讯</a>！</p><p id="8714" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">更多内容请看</em><a class="ae kx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="kw">plain English . io</em></strong></a></p></div></div>    
</body>
</html>