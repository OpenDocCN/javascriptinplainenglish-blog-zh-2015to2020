# 即使是虫子也是上帝的造物

> 原文：<https://javascript.plainenglish.io/even-bugs-are-gods-creatures-3824c002330d?source=collection_archive---------7----------------------->

## 它们可以让你成为更聪明的程序员

![](img/27c3bb1672db1cc76e0af853d5eb7388.png)

A software bug — Photo by [Neenu Vimalkumar](https://unsplash.com/@dreamquest12610?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) and [Markus Spiske](https://unsplash.com/@markusspiske?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/software-bug?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

这个故事的标题是当我们中的任何人由于一个无法解决的软件缺陷而处于神经崩溃的边缘时，我们在同事之间交换的一个笑话。或者，在周五下午 5 点 30 分，一位客户给我们发来了一份发现异常的清单，正好在最后有用的时刻破坏了我们的周末。或者更好的是，当有人给我们发一条 WhatsApp 信息，比如“不起作用”，句号。

我们程序员不喜欢(软件)bug，但现实是它们占据了我们至少一半的时间，是我们工作中必不可少的一部分。此外，它们可能是我们成长并成为专业程序员的最有效的工具。诀窍是以正确的方式处理它们，并从中获得最大收益。在我看来，正确的方法是夏洛克·福尔摩斯的方法。

> 理想的推理者一旦看到一个事实的所有方面，就会从中不仅推断出导致这一事实的所有一连串事件，而且推断出由此产生的结果。
> 
> ― **阿瑟·柯南·道尔，福尔摩斯探案集**

# 科学的方法

![](img/d75be073d1e171af99fc2815344f2ce7.png)

Scientific approach — Photo by [Shane Aldendorff](https://unsplash.com/@pluyar?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/magnifying-glass?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

这是什么意思？每一个结果都必须有一个原因:当处理一个软件缺陷时，如果你能看到症状，你就能找到发现和消除其原因的方法。

然而，要想成功，你必须采用一种理性的方法，避免因匆忙或懒惰而陷入错误，从而降低你解决问题的能力。

# 你不能做什么

## **在不知道原因之前，不要试图去纠正结果。**

慢下来深呼吸。数到 10。如果你在不知道发生了什么的情况下吐出代码，你有 100%的机会造成损害(尤其是在周五晚上)。

## **除非无法消除原因，否则不要回避或隐藏缺陷。**

问题是否存在于一段错综复杂的代码中，而你没有时间或意愿去解开它？当然，在紧急情况下，如果可以，您可以删除或禁用受影响的组件或功能。但是不要忘记，这不是一个解决方案，原因仍然存在，等待着造成新的损害。

## 不要说服自己这个问题不存在。

是真的。有时，用户报告的问题并不存在，但是，通常情况下，他们可能描述不准确，而不是疯狂。他们不太可能说出完全不存在的东西。

## 不要放弃，立即寻求帮助。

试着自己解决问题，不要寻求帮助，只要你能:你可能会学到更多。如果你怀疑你发现了什么，请寻求帮助。

## **记住:不是电脑故障。**

不要试图说服自己这是一个短暂的电脑故障。除了著名的[奔腾 FDIV bug](https://en.wikipedia.org/wiki/Pentium_FDIV_bug) (1994)，这样的事情不会发生，除非你非常非常(不)幸运。

# 你需要做的是

在调查问题的原因时，您可以做几件事情，根据问题的性质，这些事情可以以各种组合的方式应用。

## **重现问题并测量。**

首先你要能重现问题。每个程序员都知道情况并非总是如此，有时这可能是最难的部分。如果您无法重现问题，您必须依靠您的想象力以及从用户和系统中收集的任何其他信息。

如果你能重现它，你就已经成功了一半。在这种情况下，当系统处于错误状态时，尽可能收集所有信息，特别是:来自上下文、应用程序变量、控制台日志等的数据。线索就在那里。

## **寻找踪迹。**

如果您的应用程序编写得很好，它应该将重要事件跟踪到某个日志文件或表中(如果没有，请抓住机会向它添加跟踪)。请记住，操作系统、数据库管理器和其他系统组件(例如浏览器、邮件程序)确实会写日志:您可以在其中找到关于错误的有用信息。

## **遵循因果链。**

尝试从结果追溯到原因，跟踪调用堆栈(函数链)以及这些函数相互传递的参数和数据，找出故障的原始点。在有用的地方插入更多的跟踪。如果适用，利用调试器是至关重要的。

## **设身处地为电脑着想。**

试着理解什么样的电脑操作能产生你观察到的(错误的)效果；最初正确的数据是如何变成有缺陷的；可能发生的不想要的事件序列是什么，等等。用大脑“模拟”用编程语言写下的指令的能力是一种真正的天赋。

## **使用正确的工具。**

学会充分利用你所拥有的工具:调试器、跟踪器、在线代码沙箱、监控和剖析工具等。

# 新手 bug 修复的一个例子

![](img/48af830b7667215e2851596ad5801288.png)

Photo by [__ drz __](https://unsplash.com/@__drz__?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/baby-with-glasses?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

因为我主要是所谓的全栈开发方面的专家，所以我想给你一个具体的例子，用科学的方法来修复那个领域的 bug。我将展示一个非常普通的案例，你们中最有经验的人会发现这是微不足道的，但确实有许多程序员以一种无序和不确定的方式处理它。

# 症状

假设我们有一个在线发票表单，其中填充了从后端服务器读取的数据。不幸的是，标题中的公司名称没有显示出来。让我们从症状到原因，确定所有可能的故障点。

# 该方法

## 1.**公司名称真的不见了吗？**

即使我们看不到它，名字也可能在那里。发生这种情况有几种可能性:

*   文本具有使其不可见样式(*显示:无、*、*可见性:隐藏*、*不透明度:0* 等)。 *)*
*   文本容器的高度或宽度为零
*   另一个 HTML 元素隐藏了它，因为它与同一个屏幕区域重叠
*   文本是白底白字

有些可能性不大，但我向你保证，所有这些可能性在现实世界中至少发生过一次。为了验证所有这些，我们只需要浏览器开发工具(HTML 和 CSS inspector)。

检查之后，字段的值实际上丢失了吗？如果是，让我们进行下一项检查。

## **2。在问题发生之前是否有任何运行时错误？**

我们可以使用控制台日志来验证它是否报告了任何未捕获的错误。但是，不要忘记，许多程序使用“try/catch”*块，这可能隐藏一些缺陷。使用类似“捕捉到异常时暂停”(Chrome)的选项来显示这些错误。*

*没有发现相关异常？调查仍在继续。*

## ***3。哪个组件应该将值(公司名称)放入 HTML 元素？***

*根据所使用的框架，有许多方法可以将一个值放入动态 HTML 页面。让我们考虑两个最常见的:*

*a)使用 javascript 或 jQuery 设置值，通过 HTML 元素的 *ID* 或*类来识别 HTML 元素。*因此，一个可能的原因是程序用来识别字段的方法。例如，请记住 jQuery 表达式，如*

```
*$('#myfield').val(companyName)*
```

*如果不存在具有 *id="myfield"* 的元素，则不会抛出异常，它只是将新值应用于具有零元素的集合，即它什么也不做。*

*b)值被绑定到 javascript 变量，使用 React、Vue 等平台提供的常规语法。在这种情况下，一个可能的原因是用于绑定的“名称”。请记住，名称只有小写/大写字母不同的变量是不同的变量(这是一个微不足道但经常发生的错误)。*

*没有这样的错误？目标元素是否被正确识别或绑定？让我们继续追踪这条线索。*

## ***4。期望值来自服务器吗？***

*检查后端服务器是否确实返回了预期的数据。所有的 HTTP 请求都可以用浏览器的调试器来检查(在 Chrome 中，在开发者工具的*网络*面板中):寻找应该在 HTTP 响应中返回数据的调用。*

*公司名称在那里吗？JavaScript 代码没有收到它的一些可能原因:*

1.  *程序没有将 HTTP 响应传输到适当的变量。例如，JSON.parse 在解码 JSON 响应时丢失或失败。*
2.  *该程序没有等待异步 Ajax 请求的完成，因此它假装在服务器调用仍在运行时编写动态 HTML。*
3.  *程序会将该值传递给一个不同名称的变量。*
4.  *程序确实把值转移到了正确的变量上，但是后来在某个地方改变了。*

*或者，公司名称不在 HTTP 响应中？*

*在这种情况下，问题出在后端服务器上。因此，我们应该首先检查传递给 HTTP 调用的 GET 参数或 POST 有效负载，然后继续分析后端代码，它可以无限变化，所以我避免讨论它。*

# *结论*

*识别和纠正故障原因的能力是一流程序员最重要的才能之一。这种才能是随着经验培养和提高的。这就是为什么我说软件错误有很大的教育价值。*

*也就是说，不要降低你编写的软件的质量，让它有更多的错误，这样你就可以加快你的训练。*

*我不是有意煽动犯罪！*