<html>
<head>
<title>Rise of the Reducer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">减速器的上升</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/rise-of-the-reducer-pattern-cb38e9f32ce8?source=collection_archive---------5-----------------------#2019-12-28">https://javascript.plainenglish.io/rise-of-the-reducer-pattern-cb38e9f32ce8?source=collection_archive---------5-----------------------#2019-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1191" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">近年来，我观察到在软件架构中使用<em class="kl">缩减器</em>的强烈趋势。虽然这不是一个新的模式，但是它最近在<a class="ae km" href="https://react-redux.js.org/" rel="noopener ugc nofollow" target="_blank"> React / Redux </a>和其他平台上的突出表现为软件质量提供了值得讨论的好处。</p><p id="9060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将介绍reducer函数在状态管理中的作用，并讨论它提供的一些主要好处。最后，我将讨论我在以Reducer为中心的架构中看到的一些权衡。</p><p id="fc55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将把对模型视图更新(MVU)的讨论留到以后的文章中，以便将这篇文章限制在使用reducer函数进行状态管理的思想上。</p><h1 id="b099" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">减速器101</h1><p id="d408" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">让我们来看一个来自<a class="ae km" href="https://ngrx.io/" rel="noopener ugc nofollow" target="_blank"> Angular NgRx </a>应用的减速器示例:</p><p id="fbef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个来自F# <a class="ae km" href="https://github.com/elmish/Elmish.WPF" rel="noopener ugc nofollow" target="_blank">埃尔米什。WPF </a>应用:</p><p id="0129" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这两个例子都展示了各种风格的reducers，但是都接受一个起始状态和一个动作，并返回该状态的一个新版本。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/7bc62a952006634b52c0d8e50ba7a385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*USdSPDMUZ2VS-oZf"/></div></div></figure><p id="6ed5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本质上，这就是减速器的作用。</p><p id="2e8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们将探索它的强大之处以及它有助于解决的问题。</p><h1 id="8e34" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">第一次与减肥者见面</h1><p id="bf36" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">几年前，我在<a class="ae km" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular </a>做一些非常繁重的单页面应用程序(SPA)开发。我构建了一个有角度的单页应用程序。然后又是一个。另一个。</p><p id="b4d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我喜欢这个框架(现在仍然如此)，但是很快我开始注意到在同时处理多个异步操作时很难管理复杂性。</p><p id="4ddd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是Angular社区中的许多人以前都遇到过的问题，在这种情况下，很少会出现状态管理错误，操作顺序和网络延迟会带来很大程度的复杂性。</p><p id="0dc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Angular社区用一些基于reducer的状态管理库来应对挑战，比如<a class="ae km" href="https://ngrx.io/" rel="noopener ugc nofollow" target="_blank"> NgRx </a>。这个库基于通常与React相关的流行的Redux状态管理库。</p><p id="f45d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，Redux通常与React相关联，因为两者都由脸书管理，但是Redux实际上并不是React的<em class="kl">部分。简而言之，Redux是一个强大的基于<em class="kl"> reducer的</em>JavaScript应用程序状态管理库。它通常通过React-Redux库集成到React中，但是Redux本身并没有React特有的特性。</em></p><p id="493f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据我现在对reducer的了解，一旦状态管理达到一定的复杂性阈值，Angular社区转向使用基于reducer的状态管理系统<em class="kl">是正确的。</em></p><h1 id="c199" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">减速器的电源</h1><p id="1421" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">让我们来看看<em class="kl">为什么</em>减速器对软件质量这么好。</p><h2 id="4268" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">纯状态转换</h2><p id="1e51" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">还原器不是依赖于保存不断变化的状态值的存储库类，而是<em class="kl">纯函数</em>，接受一个动作和先前的状态，并基于这些输入输出一个新的状态。</p><p id="30b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">术语“纯函数”意味着该函数可以用相同的输入被永远调用，并且总是返回相同的输出，而不会对其他任何东西产生副作用。</p><p id="fb89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一概念对于理解减压器功能的质量优势极其重要。</p><p id="029b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为对于给定的特定输入，reducer完全是关于可重复的状态转换，所以测试起来非常容易。</p><h2 id="95cd" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">中央集权的国家管理</h2><p id="5aa6" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">reducers的一个有趣的方面是，它把所有的应用程序状态放在一个集中的地方。</p><p id="2821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这使得查看应用程序的整个状态更加容易，但更重要的是，它将对应用程序状态的任何操作都移到了一个中心位置。这消除了关于应用程序的哪些部分正在修改您的状态的疑问。</p><p id="72ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种改进非常重要，因为状态管理中不一致的行为会导致数量惊人的错误。</p><h2 id="8bc8" class="mc ko iq bd kp md me dn kt mf mg dp kx jy mh mi lb kc mj mk lf kg ml mm lj mn bi translated">调试功能</h2><p id="dffa" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">最重要的是，如果出现了bug，您需要知道的只是reducer函数的输入，以便能够重新创建和解决问题。</p><p id="ec4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过记录reducer函数之前和之后的状态，在不确定哪个操作导致无效状态的情况下，调试速度会大大加快。</p><p id="4a45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，我并不提倡特定的基于reducer的库或技术，而是更一般的模式。</p><h1 id="22eb" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">减速器缺点</h1><p id="5927" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">如果你已经在技术世界呆了一段时间，你就会知道任何决定都有利弊。我不能在不讨论与减速器相关的常见陷阱和缺点的情况下提倡减速器。</p><p id="f851" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们来看看这些潜在的缺点:</p><ul class=""><li id="dba6" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated"><strong class="jp ir">学习曲线</strong>——reducer有一点不同，有一个温和的学习曲线——特别是当开始一个新项目而没有模式可供模仿的时候。</li><li id="2f20" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir">锅炉板代码</strong>——我看过的许多基于reducer的框架至少有一点我称之为<em class="kl">锅炉板代码</em>。除了框架需要之外，这些代码几乎没有存在的理由。如果不查看具体的实现，很难深入了解这一点，所以只需知道您可能需要编写一些重复的代码来将reducers集成到现有的框架中。</li><li id="e5c2" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir">复杂性</strong> —考虑到reducers的复杂性和开销，它们对于小型应用程序或不太依赖状态操作的应用程序来说不一定有意义。就像你不需要一辆移动的卡车去杂货店一样，减速器在小型应用中并不总是有意义的。</li><li id="f5cf" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><strong class="jp ir">大型reducer</strong>—如果你的reducer发展到有很多潜在状态操作的程度，它会变成一个相当大的方法。对此有答案，比如为复杂的转换提取方法(这是我推荐的)。</li><li id="1d1d" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">此外，根据您使用的reducer框架的风格，您可以拥有多个reducer或嵌套reducer。这使事情变得有点复杂，但也保持了方法的小型和可管理性。</li></ul><h1 id="039e" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">结束语</h1><p id="3540" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">总的来说，我对近几年向减肥药的转变感到高兴。它们的构造和设计使得虫子很难隐藏。</p><p id="3fac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我看到的主要缺点是最初的温和学习曲线，与基于reducer的框架相关的锅炉板代码的增加，以及复杂性的增加。</p><p id="22a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一个编程社区，我们将继续创新——尤其是围绕JavaScript框架。我很有信心，在接下来的5年里，我们将会看到框架围绕更多这些常见问题创新解决方案，进一步减少reducers的缺点。</p><p id="fe5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在以后的文章中，我会谈到reducer在模型视图更新(MVU)框架中的作用，敬请关注。</p><p id="12e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同时，如果你想更多地使用reducers，JavaScript开发人员可以从查看<a class="ae km" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>开始。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="1210" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">原载于2019年12月28日</em><a class="ae km" href="https://killalldefects.com/2019/12/28/rise-of-the-reducer-pattern/" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://killalldefects.com</em></a><em class="kl">。</em></p></div></div>    
</body>
</html>